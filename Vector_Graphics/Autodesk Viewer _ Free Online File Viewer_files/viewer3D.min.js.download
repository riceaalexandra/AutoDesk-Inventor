/*!
 * LMV v7.58.0
 *
 * Copyright 2021 Autodesk, Inc.
 * All rights reserved.
 *
 * This computer source code and related instructions and comments are the
 * unpublished confidential and proprietary information of Autodesk, Inc.
 * and are protected under Federal copyright and state trade secret law.
 * They may not be disclosed to, copied or used by any third party without
 * the prior written consent of Autodesk, Inc.
 *
 * Autodesk Forge Viewer Usage Limitations:
 *
 * The Autodesk Forge Viewer JavaScript must be delivered from an
 * Autodesk-hosted URL.
 */
var LMV;(()=>{var e,t,n={32263:e=>{e.exports="#if NUM_CUTPLANES > 0\nuniform vec4 cutplanes[NUM_CUTPLANES];\nvoid checkCutPlanes(vec3 worldPosition) {\n    for (int i=0; i<NUM_CUTPLANES; i++) {\n        if (dot(vec4(worldPosition, 1.0), cutplanes[i]) > 0.0) {\n            discard;\n        }\n    }\n}\n#endif\n"},16006:e=>{e.exports="uniform float point_size;"},25334:e=>{e.exports="\nuniform sampler2D tDepth;\nuniform vec4 projInfo;\nuniform float isOrtho;\nuniform mat4 worldMatrix_mainPass;\nvec3 reconstructCSPosition(vec2 fragCoords, float z) {\n    return vec3((fragCoords * projInfo.xy + projInfo.zw) * mix(z, -1.0, isOrtho), z);\n}\nvec3 reconstructWorldPosition(vec2 fragCoords, vec2 screenUv) {\n    float zCam = texture2D(tDepth, screenUv).z;\n    vec3 csPos = reconstructCSPosition(fragCoords, zCam);\n    return (worldMatrix_mainPass * vec4(csPos, 1.0)).xyz;\n}\n"},7246:e=>{e.exports="\nuniform float envRotationSin;\nuniform float envRotationCos;\nvec3 adjustLookupVector(in vec3 lookup) {\n    return vec3(\n            envRotationCos * lookup.x - envRotationSin * lookup.z,\n            lookup.y,\n            envRotationSin * lookup.x + envRotationCos * lookup.z);\n}\nvec3 RGBMDecode(in vec4 vRGBM, in float exposure) {\n    vec3 ret = vRGBM.rgb * (vRGBM.a * 16.0);\n    ret *= ret;\n    ret *= exposure;\n    return ret;\n}\nvec3 GammaDecode(in vec4 vRGBA, in float exposure) {\n    return vRGBA.xyz * vRGBA.xyz * exposure;\n}\nvec3 sampleIrradianceMap(vec3 dirWorld, samplerCube irrMap, float exposure) {\n    vec4 cubeColor4 = textureCube(irrMap, adjustLookupVector(dirWorld));\n#ifdef IRR_GAMMA\n    vec3 indirectDiffuse = GammaDecode(cubeColor4, exposure);\n#elif defined(IRR_RGBM)\n    vec3 indirectDiffuse = RGBMDecode(cubeColor4, exposure);\n#else\n    vec3 indirectDiffuse = cubeColor4.xyz;\n#ifdef GAMMA_INPUT\n    indirectDiffuse.xyz *= indirectDiffuse.xyz;\n#endif\n#endif\n    return indirectDiffuse;\n}\n"},53833:e=>{e.exports="#ifdef HATCH_PATTERN\ngl_FragColor = calculateHatchPattern(hatchParams, gl_FragCoord.xy, gl_FragColor, hatchTintColor, hatchTintIntensity);\n#endif\n#ifdef MRT_NORMALS\noutNormal = vec4(geomNormal.x, geomNormal.y, depth, gl_FragColor.a < 1.0 ? 0.0 : 1.0);\n#endif\n#include <id_frag>\n"},72448:e=>{e.exports="float averageOfFloat3(in vec3 value) { \n    const float oneThird = 1.0 / 3.0; \n    return dot(value, vec3(oneThird, oneThird, oneThird)); \n} \n"},52698:e=>{e.exports="#ifdef HATCH_PATTERN\nuniform vec2 hatchParams;\nuniform vec3 hatchTintColor;\nuniform float hatchTintIntensity;\nfloat curveGaussian(float r, float invWidth) {\n    float amt = clamp(r * invWidth, 0.0, 1.0);\n    float exponent = amt * 3.5;\n    return exp(-exponent*exponent);\n}\nvec4 calculateHatchPattern(vec2 hatchParams, vec2 coord, vec4 fragColor, vec3 hatchTintColor, float hatchTintIntensity ) {\n    float hatchSlope = hatchParams.x;\n    float hatchPeriod = hatchParams.y;\n    if (abs(hatchSlope) <= 1.0) {\n        float hatchPhase = coord.y - hatchSlope * coord.x;\n        float dist = abs(mod((hatchPhase), (hatchPeriod)));\n        if (dist < 1.0) {\n            fragColor = vec4(0.0,0.0,0.0,1.0);\n        } else {\n            fragColor.xyz = mix(fragColor.xyz, hatchTintColor, hatchTintIntensity);\n        }\n    } else {\n        float hatchPhase = - coord.y / hatchSlope + coord.x;\n        float dist = abs(mod((hatchPhase), (hatchPeriod)));\n        if (dist < 1.0) {\n            fragColor = vec4(0.0,0.0,0.0,1.0);\n        } else {\n            fragColor.xyz = mix(fragColor.xyz, hatchTintColor, hatchTintIntensity);\n        }\n    }\n    return fragColor;\n}\n#endif\n"},68643:e=>{e.exports="vec3 rgb2hsv(vec3 color)\n{\n    float delta;\n    float colorMax, colorMin;\n    float h,s,v;\n    vec3 hsv;\n    colorMax = max(color.r,color.g);\n    colorMax = max(colorMax,color.b);\n    colorMin = min(color.r,color.g);\n    colorMin = min(colorMin,color.b);\n    v = colorMax;\n    if(colorMax != 0.0)\n    {\n        s = (colorMax - colorMin)/colorMax;\n    }\n    else\n    {\n        s = 0.0;\n    }\n    if(s != 0.0)\n    {\n        delta = colorMax-colorMin;\n        if (color.r == colorMax)\n        {\n            h = (color.g-color.b)/delta;\n        }\n        else if (color.g == colorMax)\n        {\n            h = 2.0 + (color.b-color.r) / delta;\n        }\n        else\n        {\n            h = 4.0 + (color.r-color.g)/delta;\n        }\n        h /= 6.0;\n        if( h < 0.0)\n        {\n            h +=1.0;\n        }\n    }\n    else\n    {\n        h = 0.0;\n    }\n    hsv = vec3(h,s,v);\n    return hsv;\n}\nvec3 hsv2rgb(vec3 hsv)\n{\n    vec3 color;\n    float f,p,q,t;\n    float h,s,v;\n    float i,hi;\n    {\n        h = hsv.x*6.0;\n        s = hsv.y;\n        v = hsv.z;\n        i = floor(h);\n        f = h-i;\n        p = v * (1.0 - s);\n        q = v * (1.0 - (s * f));\n        t = v * (1.0 - (s * (1.0 - f)));\n        float r,g,b;\n        if (i == 0.0)\n        {\n            r = v;\n            g = t;\n            b = p;\n        }\n        else if (i == 1.0)\n        {\n            r = q;\n            g = v;\n            b = p;\n        }\n        else if (i == 2.0)\n        {\n            r = p;\n            g = v;\n            b = t;\n        }\n        else if (i == 3.0)\n        {\n            r = p;\n            g = q;\n            b = v;\n        }\n        else if (i == 4.0)\n        {\n            r = t;\n            g = p;\n            b = v;\n        }\n        else\n        {\n            r = v;\n            g = p;\n            b = q;\n        }\n        color = vec3(r,g,b);\n    }\n    return color;\n}"},74610:e=>{e.exports="#if defined(MRT_NORMALS) || defined(MRT_ID_BUFFER)\n    varying highp float depth;\n#endif\n#if defined(MRT_ID_BUFFER) || defined(ID_COLOR)\n    #ifdef USE_VERTEX_ID\n        varying vec3 vId;\n    #elif defined(LINE_2D_SHADER)\n        varying vec4 dbId;\n    #else\n        uniform vec3 dbId;\n    #endif\n#endif\n#if defined(MRT_ID_BUFFER) || defined(MODEL_COLOR)\n    uniform vec3 modelId;\n#endif\n#ifdef _LMVWEBGL2_\n    #if defined(MRT_NORMALS)\n        layout(location = 1) out vec4 outNormal;\n        #if defined(MRT_ID_BUFFER)\n            layout(location = 2) out vec4 outId;\n            #if defined(MODEL_COLOR)\n                layout(location = 3) out vec4 outModelId;\n            #endif\n        #endif\n    #elif defined(MRT_ID_BUFFER)\n        layout(location = 1) out vec4 outId;\n        #if defined(MODEL_COLOR)\n            layout(location = 2) out vec4 outModelId;\n        #endif\n    #endif\n#else\n    #define gl_FragColor gl_FragData[0]\n    #if defined(MRT_NORMALS)\n        #define outNormal gl_FragData[1]\n        #if defined(MRT_ID_BUFFER)\n            #define outId gl_FragData[2]\n            #if defined(MODEL_COLOR)\n                #define outModelId gl_FragData[3]\n            #endif\n        #endif\n    #elif defined(MRT_ID_BUFFER)\n        #define outId gl_FragData[1]\n        #if defined(MODEL_COLOR)\n            #define outModelId gl_FragData[2]\n        #endif\n    #endif\n#endif"},7959:e=>{e.exports="#ifdef USE_VERTEX_ID\nattribute vec3 id;\nvarying   vec3 vId;\n#endif\n"},46223:e=>{e.exports="\n#if defined(USE_VERTEX_ID) && (defined(MRT_ID_BUFFER) || defined(ID_COLOR))\n    vec3 dbId = vId;\n#endif\n#ifdef MRT_ID_BUFFER\n    #ifndef ENABLE_ID_DISCARD\n        const float writeId = 1.0;\n    #endif\n    outId = vec4(dbId.rgb, writeId);\n    #ifdef MODEL_COLOR\n        outModelId = vec4(modelId.rgb, writeId);\n    #endif\n#elif defined(ID_COLOR)\n    #ifdef ENABLE_ID_DISCARD\n        if (writeId==0.0) {\n            discard;\n        }\n    #endif\n    gl_FragColor = vec4(dbId.rgb, 1.0);\n#elif defined(MODEL_COLOR)\n    #ifdef ENABLE_ID_DISCARD\n        if (writeId==0.0) {\n            discard;\n        }\n    #endif\n    gl_FragColor = vec4(modelId.rgb, 1.0);\n#endif\n"},61539:e=>{e.exports="\n#ifdef USE_VERTEX_ID\nvId = id;\n#endif\n"},58121:e=>{e.exports="\n#ifdef USE_INSTANCING\nattribute vec3 instOffset;\nattribute vec4 instRotation;\nattribute vec3 instScaling;\nvec3 applyQuaternion(vec3 p, vec4 q) {\n    return p + 2.0 * cross(q.xyz, cross(q.xyz, p) + q.w * p);\n}\nvec3 getInstancePos(vec3 pos) {\n    return instOffset + applyQuaternion(instScaling * pos, instRotation);\n}\nvec3 getInstanceNormal(vec3 normal) {\n    return applyQuaternion(normal/instScaling, instRotation);\n}\n#else\nvec3 getInstancePos(vec3 pos)       { return pos;    }\nvec3 getInstanceNormal(vec3 normal) { return normal; }\n#endif\n"},81456:e=>{e.exports="\n#define LINE_2D_SHADER 1\n#define TAU     6.28318530718\n#define PI      3.14159265358979\n#define HALF_PI 1.57079632679\n#define PI_0_5  HALF_PI\n#define PI_1_5  4.71238898038\n#define ENABLE_ID_DISCARD\n#define VBB_GT_TRIANGLE_INDEXED  0.0\n#define VBB_GT_LINE_SEGMENT      1.0\n#define VBB_GT_ARC_CIRCULAR      2.0\n#define VBB_GT_ARC_ELLIPTICAL    3.0\n#define VBB_GT_TEX_QUAD          4.0\n#define VBB_GT_ONE_TRIANGLE      5.0\n#define VBB_GT_MSDF_TRIANGLE_INDEXED 6.0\n#define VBB_INSTANCED_FLAG   0.0\n#define VBB_SEG_START_RIGHT  0.0\n#define VBB_SEG_START_LEFT   1.0\n#define VBB_SEG_END_RIGHT    2.0\n#define VBB_SEG_END_LEFT     3.0\n#define LTSCALE 0.25\nvarying vec4 fsColor;\nvarying vec2 fsOffsetDirection;\nvarying vec4 fsMultipurpose;\nvarying float fsHalfWidth;\nvarying vec2 fsVpTC;\nvarying float fsGhosting;\n#ifdef LOADING_ANIMATION\nvarying float loadingProgress;\n#endif\n"},14227:e=>{e.exports="#if defined(USE_SURFACE_NORMAL_MAP) || defined( USE_LAYERED_NORMAL_MAP ) || defined( USE_TILING_NORMAL )\nvoid heightMapTransform(\n    sampler2D bumpTexture,\n    vec2 uv,\n    mat3 transform,\n    vec2 bumpScale,\n    inout vec3 T,\n    inout vec3 B,\n    inout vec3 N\n) {\n    vec2 st = (transform * vec3(uv, 1.0)).xy;\n    mat3 mtxTangent = mat3(T, B, N);\n    T = normalize(mtxTangent * (transform * vec3(1.0, 0.0, 0.0)));\n    B = normalize(mtxTangent * (transform * vec3(0.0, 1.0, 0.0)));\n    const float oneThird = 1.0 / 3.0;\n    vec3 avg = vec3(oneThird, oneThird, oneThird);\n    vec2 offset = fwidth(st);\n    float h0 = dot(texture2D(bumpTexture, st).xyz, avg);\n    float hx = dot(texture2D(bumpTexture, st + vec2(offset.x, 0.0)).xyz, avg);\n    float hy = dot(texture2D(bumpTexture, st + vec2(0.0, offset.y)).xyz, avg);\n    vec2 diff = vec2(h0 - hx, h0 - hy) / offset;\n    N = normalize(\n        N + (\n            diff.x * T * bumpScale.x +\n            diff.y * B * bumpScale.y\n        )\n    );\n}\nvoid normalMapTransform(\n    sampler2D bumpTexture,\n    vec2 uv,\n    mat3 transform,\n    vec2 bumpScale,\n    inout vec3 T,\n    inout vec3 B,\n    inout vec3 N\n) {\n    vec2 st = (transform * vec3(uv, 1.0)).xy;\n    vec3 mapN =  2.0 * texture2D(bumpTexture, st).xyz - 1.0;\n    mapN.xy *= bumpScale.x;\n    mapN.z *= bumpScale.y;\n    vec3 v = vec3(mapN.y, -mapN.x, 0.0);\n    float c = -mapN.z;\n    mat3 skewV = mat3(\n        0.0, v.z, -v.y,\n        -v.z, 0.0, v.x,\n        v.y, -v.x, 0.0\n    );\n    mat3 rot = mat3(1.0) + skewV + skewV*skewV * 1.0/(1.0-c);\n    N *= rot;\n    T *= rot;\n    B *= rot;\n}\n#endif\n"},52035:e=>{e.exports="vec3 orderedDithering(vec3 col) {\n    const vec4 m0 = vec4( 1.0, 13.0,  4.0, 16.0);\n    const vec4 m1 = vec4( 9.0,  5.0, 12.0,  8.0);\n    const vec4 m2 = vec4( 3.0, 15.0,  2.0, 14.0);\n    const vec4 m3 = vec4(11.0,  7.0, 10.0,  6.0);\n#ifdef _LMVWEBGL2_\n    int i = int(gl_FragCoord.x) & 3;\n    int j = int(gl_FragCoord.y) & 3;\n#else\n    int i = int(mod(float(gl_FragCoord.x), 4.0));\n    int j = int(mod(float(gl_FragCoord.y), 4.0));\n#endif\n    vec4 biasRow;\n    if      (i==0) biasRow = m0;\n    else if (i==1) biasRow = m1;\n    else if (i==2) biasRow = m2;\n    else           biasRow = m3;\n    float bias;\n    if      (j==0) bias = biasRow.x;\n    else if (j==1) bias = biasRow.y;\n    else if (j==2) bias = biasRow.z;\n    else           bias = biasRow.w;\n    return col + bias * (1.0 / (17.0 * 256.0));\n}\n"},23300:e=>{e.exports="\nvec4 packDepth( const in float depth ) {\n    vec4 enc = vec4(1.0, 255.0, 65025.0, 160581375.0) * depth;\n    enc = fract(enc);\n    enc -= enc.yzww * vec4(1.0/255.0,1.0/255.0,1.0/255.0,0.0);\n    return enc;\n}\nfloat unpackDepth( const in vec4 rgba_depth ) {\n    return dot( rgba_depth, vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/160581375.0) );\n}\n"},15931:e=>{e.exports="\n#define kPI 3.14159265358979\nvec2 encodeNormal (vec3 n) {\n    return (vec2(atan(n.y,n.x)/kPI, n.z)+1.0)*0.5;\n}\nvec3 decodeNormal (vec2 enc) {\n    vec2 ang = enc * 2.0 - 1.0;\n    vec2 scth = vec2(sin(ang.x * kPI), cos(ang.x * kPI));\n    vec2 scphi = vec2(sqrt(1.0 - ang.y * ang.y), ang.y);\n    return vec3(scth.y * scphi.x, scth.x * scphi.x, scphi.y);\n}\n"},26649:e=>{e.exports="gl_PointSize = point_size;"},58998:e=>{e.exports="\nvec3 TransmitAdjust(vec3 transmission, vec3 f0) \n{ \n   vec3 limit = max(1.0 - f0, 0.00001); \n   return clamp(transmission, vec3(0.0, 0.0, 0.0), limit) / limit; \n} \nfloat ColorToIlluminance(in vec3 color) \n{ \n   const vec3 rgb2grey = vec3(0.299, 0.587, 0.114); \n   float illuminance = dot(rgb2grey, color); \n   return illuminance; \n} \nvoid applyPrismGlazingOpacity(\n    inout vec4 color,\n    vec3 transmissionF,\n    float transmissionAlpha,\n    float NdotV,\n    float glazingIlluminace) \n{\n    const float third = 1.0/3.0; \n    float transSurface = exp(-(transmissionAlpha + (transmissionAlpha < 0.0025 ? 0.0 : 0.25)) * NdotV * PI); \n    float opacity = 1.0- dot((1.0 - transmissionF), vec3(third,third,third)) * transSurface * glazingIlluminace; \n    opacity = clamp(opacity, 0.01, 0.99);\n    color.a *= opacity;\n} \n"},72438:e=>{e.exports="void applyPrismTransparency(\n    inout vec4 color,\n    vec3 transparentColor,\n    float transparentIor\n) {\n    float fsLevel = max(max(color.r, color.g), color.b);\n    color = vec4(color.rgb/fsLevel, fsLevel);\n    float transLevel = min(min(transparentColor.r, transparentColor.g), transparentColor.b);\n    transLevel = min( (1.0 - surface_roughness), transLevel );\n    float transAlpha = (1.0 - transLevel) * 0.4 + surface_roughness * 0.55;\n    vec3 tr_g_color = sqrt(transparentColor);\n    vec4 transColor = vec4(0.5 * vec3(tr_g_color), transAlpha);\n    float strength = 1.0 - (1.0 - fsLevel) * (1.0 - fsLevel);\n    color = mix(transColor, color, strength);\n    color.a = max(color.a, 0.05);\n    if (transparentIor == 1.0 && tr_g_color == vec3(1.0)) {\n        color.a = 0.0;\n    }\n}"},65355:e=>{e.exports="#if defined( PRISMWOOD )\n#define ONE 0.00390625\nfloat GetIndexedValue(vec4 array, int index)\n{\n    if (index == 0)\n        return array[0];\n    else if (index == 1)\n        return array[1];\n    else if (index == 2)\n        return array[2];\n    else if (index == 3)\n        return array[3];\n    else\n        return 0.0;\n}\nint GetIndexedValue(ivec2 array, int index)\n{\n    if (index == 0)\n        return array[0];\n    else if (index == 1)\n        return array[1];\n    else\n        return 0;\n}\n#if defined( USE_WOOD_CURLY_DISTORTION_MAP )\nfloat SampleCurlyPattern(vec2 uv)\n{\n    vec2 uv_wood_curly_distortion_map = (wood_curly_distortion_map_texMatrix * vec3(uv, 1.0)).xy;\n    WOOD_CURLY_DISTORTION_CLAMP_TEST;\n    vec3 curlyDistortion = texture2D(wood_curly_distortion_map, uv_wood_curly_distortion_map).xyz;\n    if(wood_curly_distortion_map_invert) curlyDistortion = vec3(1.0) - curlyDistortion;\n    return curlyDistortion.r;\n}\nvec3 DistortCurly(vec3 p)\n{\n    if (!wood_curly_distortion_enable) return p;\n    float r = length(p.xy);\n    if (r < 0.00001) return p;\n    const float INV_ANGLE_INTERVAL = 1.27323954;\n    const float NUM_INTERVAL = 8.0;\n    float theta = atan(p.y, p.x);\n    if (theta < 0.0)\n        theta += PI2;\n    float intIdx = theta * INV_ANGLE_INTERVAL;\n    int idx0 = int(mod(floor(intIdx), NUM_INTERVAL));\n    int idx1 = int(mod(ceil(intIdx), NUM_INTERVAL));\n    const vec4 HASH_TABLE1 = vec4(0.450572,0.114598, 0.886043, 0.315119);\n    const vec4 HASH_TABLE2 = vec4(0.216133,0.306264, 0.685616, 0.317907);\n    float offset0 = idx0 < 4 ? GetIndexedValue(HASH_TABLE1, idx0) : GetIndexedValue(HASH_TABLE2, idx0-4);\n    float offset1 = idx1 < 4 ? GetIndexedValue(HASH_TABLE1, idx1) : GetIndexedValue(HASH_TABLE2, idx1-4);\n    const float maxOffset = 100.0;\n    offset0 = (offset0 - 0.5) * maxOffset;\n    offset1 = (offset1 - 0.5) * maxOffset;\n    vec2 uv0 = vec2(p.z + offset0, r);\n    float shiftWeight0 =  SampleCurlyPattern(uv0);\n    vec2 uv1 = vec2(p.z + offset1, r);\n    float shiftWeight1 =  SampleCurlyPattern(uv1);\n    float interpWeight = fract(intIdx);\n    float shiftWeight = mix(shiftWeight0, shiftWeight1, interpWeight);\n    const float INV_MIN_RADIUS = 2.0;\n    float shiftWeightAdjust = smoothstep(0.0, 1.0, r * INV_MIN_RADIUS);\n    r -= wood_curly_distortion_scale * (shiftWeight * shiftWeightAdjust);\n    float thetaNew = atan(p.y, p.x);\n    vec3 pNew = p;\n    pNew.x = r * cos(thetaNew);\n    pNew.y = r * sin(thetaNew);\n    return pNew;\n}\n#endif\nvec3 un2sn(vec3 range)\n{\n    return range * 2.0 - 1.0;\n}\nfloat inoise(vec3 p)\n{\n    vec3 modp = mod(floor(p), 256.0);\n    modp.xy = modp.xy * ONE;\n    vec4 AA = texture2D(perm2DMap, vec2(modp.x, modp.y), 0.0) * 255.0;\n    AA = AA + modp.z;\n    AA = mod(floor(AA), 256.0);\n    AA *= ONE;\n    vec3 gradx1 = un2sn(texture2D(permGradMap,vec2(AA.x,0.0),0.0).xyz);\n    vec3 grady1 = un2sn(texture2D(permGradMap,vec2(AA.y,0.0),0.0).xyz);\n    vec3 gradz1 = un2sn(texture2D(permGradMap,vec2(AA.z,0.0),0.0).xyz);\n    vec3 gradw1 = un2sn(texture2D(permGradMap,vec2(AA.w,0.0),0.0).xyz);\n    vec3 gradx2 = un2sn(texture2D(permGradMap,vec2(AA.x + ONE,0.0),0.0).xyz);\n    vec3 grady2 = un2sn(texture2D(permGradMap,vec2(AA.y + ONE,0.0),0.0).xyz);\n    vec3 gradz2 = un2sn(texture2D(permGradMap,vec2(AA.z + ONE,0.0),0.0).xyz);\n    vec3 gradw2 = un2sn(texture2D(permGradMap,vec2(AA.w + ONE,0.0),0.0).xyz);\n    p -= floor(p);\n    vec3 fadep = p * p * p * (p * (p * 6.0 - 15.0) + 10.0);\n    return mix( mix( mix( dot(gradx1, p ),\n                          dot(gradz1, p + vec3(-1.0, 0.0, 0.0)), fadep.x),\n                     mix( dot(grady1, p + vec3(0.0, -1.0, 0.0)),\n                          dot(gradw1, p + vec3(-1.0, -1.0, 0.0)), fadep.x), fadep.y),\n                mix( mix( dot(gradx2, p + vec3(0.0, 0.0, -1.0)),\n                          dot(gradz2, p + vec3(-1.0, 0.0, -1.0)), fadep.x),\n                     mix( dot(grady2, p + vec3(0.0, -1.0, -1.0)),\n                          dot(gradw2, p + vec3(-1.0, -1.0, -1.0)), fadep.x), fadep.y), fadep.z);\n}\nfloat inoise(float p)\n{\n    float modp = mod(floor(p), 256.0);\n    modp = (modp + 256.0) * ONE;\n    float permx = texture2D(permutationMap, vec2(modp, 0.0), 0.0).r;\n    float gradx = texture2D(gradientMap, vec2(permx, 0.0), 0.0).r*2.0-1.0;\n    float permy = texture2D(permutationMap, vec2(modp + ONE, 0.0), 0.0).r;\n    float grady = texture2D(gradientMap, vec2(permy, 0.0), 0.0).r*2.0-1.0;\n    p -= floor(p);\n    float fadep = p * p * p * (p * (p * 6.0 - 15.0) + 10.0);\n    return mix(gradx * p, grady * (p - 1.0), fadep);\n}\nfloat multiband_inoise(vec3 p, int bands, vec4 w, vec4 f)\n{\n    float noise = 0.0;\n    for(int i = 0; i < 4; ++i)\n    {\n        if (i >= bands) break;\n        noise += GetIndexedValue(w, i) * inoise(p * GetIndexedValue(f, i));\n    }\n    return noise;\n}\nfloat multiband_inoise(float p, int bands, vec4 w, vec4 f)\n{\n    float noise = 0.0;\n    for(int i = 0; i < 4; ++i)\n    {\n        if (i >= bands) break;\n        noise += GetIndexedValue(w, i) * inoise(p * GetIndexedValue(f, i));\n    }\n    return noise;\n}\nvec3 Distort3DCosineRadialDir(vec3 p)\n{\n    float radius = length(p.xy);\n    if (radius < 0.00001) return p;\n    vec2 theta = p.xy / radius;\n    float radiusShift = 0.0;\n    for (int i = 0; i < 4; ++i)\n    {\n        if (i >= wood_fiber_cosine_bands) break;\n        radiusShift += GetIndexedValue(wood_fiber_cosine_weights, i) * cos(p.z * RECIPROCAL_PI2 * GetIndexedValue(wood_fiber_cosine_frequencies, i));\n    }\n    const float MIN_RADIUS = 1.5;\n    float weight = clamp(radius / MIN_RADIUS, 0.0, 1.0);\n    if(weight >= 0.5)\n        weight = weight * weight * (3.0 - (weight + weight));\n    p.xy += theta * radiusShift * weight;\n    return p;\n}\nvec3 Distort3DPerlin(vec3 p)\n{\n    vec3 pAniso = vec3(p.xy, p.z * wood_fiber_perlin_scale_z);\n    p.xy += multiband_inoise(pAniso, wood_fiber_perlin_bands, wood_fiber_perlin_weights, wood_fiber_perlin_frequencies);\n    return p;\n}\nvec3 Distort(vec3 p)\n{\n    if(wood_fiber_cosine_enable)\n        p = Distort3DCosineRadialDir(p);\n    if(wood_fiber_perlin_enable)\n        p = Distort3DPerlin(p);\n    return p;\n}\nfloat DistortRadiusLength(float radiusLength)\n{\n    radiusLength += multiband_inoise(radiusLength, wood_growth_perlin_bands, wood_growth_perlin_weights, wood_growth_perlin_frequencies);\n    if (radiusLength < 0.0) radiusLength = 0.0;\n    return radiusLength;\n}\nfloat ComputeEarlyWoodRatio(float radiusLength)\n{\n    float fraction = mod(radiusLength, wood_ring_thickness) / wood_ring_thickness;\n    if (fraction <= wood_ring_fraction.y)\n       return 1.0;\n    else if(fraction <= wood_ring_fraction.x)\n       return (1.0 - (fraction - wood_ring_fraction.y) / wood_fall_rise.x);\n    else if(fraction <= wood_ring_fraction.w)\n       return 0.0;\n    else\n       return ((fraction - wood_ring_fraction.w) / wood_fall_rise.y);\n}\nvec3 DistortEarlyColor(vec3 earlyColor, float radiusLength)\n{\n    float expValue = 1.0 + multiband_inoise(radiusLength,wood_earlycolor_perlin_bands,wood_earlycolor_perlin_weights,wood_earlycolor_perlin_frequencies);\n    earlyColor = pow(abs(earlyColor), vec3(expValue));\n    return earlyColor;\n}\nvec3 DistortLateColor(vec3 lateColor, float radiusLength)\n{\n    float expValue = 1.0 + multiband_inoise(radiusLength,wood_latecolor_perlin_bands,wood_latecolor_perlin_weights,wood_latecolor_perlin_frequencies);\n    lateColor = pow(abs(lateColor), vec3(expValue));\n    return lateColor;\n}\nvec3 DistortDiffuseColor(vec3 diffAlbedo, vec3 p)\n{\n    p.z *= wood_diffuse_perlin_scale_z;\n    float expValue = 1.0 + multiband_inoise(p, wood_diffuse_perlin_bands, wood_diffuse_perlin_weights, wood_diffuse_perlin_frequencies);\n    diffAlbedo = pow(abs(diffAlbedo), vec3(expValue));\n    return diffAlbedo;\n}\nfloat LayerRoughnessVar(float roughness, float earlyWoodRatio)\n{\n    return earlyWoodRatio * wood_groove_roughness + (1.0 - earlyWoodRatio) * roughness;\n}\nfloat hashword(vec2 k)\n{\n    k = mod(k, vec2(256.0)) * ONE;\n    float a = texture2D(permutationMap, vec2(k.x, 0.0)).x + k.y ;\n    a = texture2D(permutationMap, vec2(a, 0.0)).x ;\n    return a*255.0;\n}\nfloat wyvillsq(float rsq)\n{\n    if (rsq >= 1.0) return 0.0;\n    float tmp = 1.0 - rsq;\n    return tmp*tmp*tmp;\n}\nfloat Weight2DNeighborImpulses(vec3 p, float woodWeight)\n{\n    if(woodWeight <= 0.0) return 0.0;\n    float poreRadius = wood_pore_radius * woodWeight;\n    vec2 left = floor((p.xy - poreRadius) / wood_pore_cell_dim);\n    vec2 right = floor((p.xy + poreRadius) / wood_pore_cell_dim);\n    float weight = 0.0;\n    float invRsq = 1.0 / (poreRadius * poreRadius);\n    const float norm =  1.0 / 15.0;\n    for (int j = 0; j <= 4; j++)\n    {\n        if (j > int(right.y - left.y)) continue;\n        for (int i = 0; i <= 4; i++)\n        {\n            if (i > int(right.x - left.x)) continue;\n            vec2 pij = vec2(float(i) + left.x,float(j) + left.y);\n            float hRNum = hashword(pij);\n            float impPosX = mod(hRNum, 16.0) * norm;\n            float impPosY = floor(hRNum / 16.0) * norm;\n            impPosX = (pij.x + impPosX)* wood_pore_cell_dim;\n            impPosY = (pij.y + impPosY)* wood_pore_cell_dim;\n            float dsq = (p.x - impPosX) * (p.x - impPosX) + (p.y - impPosY) * (p.y - impPosY);\n            weight += wyvillsq(dsq * invRsq);\n        }\n    }\n    return weight;\n}\nfloat Weight3DRayImpulses(vec3 p)\n{\n    int segIdx = int(floor(p.z / wood_ray_seg_length_z));\n    float factor = p.z / wood_ray_seg_length_z - float(segIdx);\n    int segIdx1 = segIdx - 1;\n    if ( factor > 0.5 )\n        segIdx1 = segIdx + 1;\n    float theta = atan(p.y, p.x);\n    float sliceIdx = floor(((theta + PI) * RECIPROCAL_PI2) * wood_ray_num_slices);\n    if ( sliceIdx == wood_ray_num_slices)\n        sliceIdx-=1.0;\n    ivec2 arrSegs = ivec2(segIdx, segIdx1);\n    float weight = 0.0;\n    const float norm =  1.0 / 15.0;\n    float radialOffset = 5.0;\n    float radialLength = length(p.xy);\n    for (int seg = 0; seg < 2; seg++)\n    {\n        float hRNum = hashword(vec2(sliceIdx, GetIndexedValue(arrSegs, seg)));\n        float rn1 = mod(hRNum,16.0) * norm;\n        if (radialLength < radialOffset * rn1)\n            continue;\n        float rayTheta = rn1;\n        rayTheta = ( ( sliceIdx + rayTheta ) / wood_ray_num_slices ) * ( 2.0 * PI ) - PI;\n        float rayPosZ = (hRNum/16.0)* norm;\n        rayPosZ = ( float(GetIndexedValue(arrSegs, seg)) + rayPosZ ) * wood_ray_seg_length_z;\n        vec3 pt1 = vec3(0.0);\n        vec3 pt2 = vec3(cos(rayTheta), sin(rayTheta), 0.0);\n        vec3 p1 = p;\n        p1.z -= rayPosZ;\n        p1.z /=  wood_ray_ellipse_z2x;\n        vec3 v1 = pt2 - pt1;\n        vec3 v2 = pt1 - p1;\n        v2 = cross(v1, v2);\n        float dist = length(v2) / length(v1);\n        float invRsq = 1.0 / ( wood_ray_ellipse_radius_x * wood_ray_ellipse_radius_x);\n        weight += wyvillsq( (dist * dist) * invRsq );\n    }\n    return weight;\n}\nvec3 DarkenColorWithPores(vec3 p, vec3 diffColor, float woodWeight)\n{\n    float poresWeight = Weight2DNeighborImpulses(p, woodWeight);\n    float a = wood_pore_color_power - 1.0;\n    float b = 1.0;\n    float y = a * poresWeight + b;\n    return pow(abs(diffColor), vec3(y));\n}\nvec3 DarkenColorWithRays(vec3 p, vec3 diffColor)\n{\n    float raysWeight = Weight3DRayImpulses(p);\n    float a = wood_ray_color_power - 1.0;\n    float b = 1.0;\n    float y = a * raysWeight + b;\n    return pow(abs(diffColor), vec3(y));\n}\nfloat ComputeWoodWeight(float earlyWoodRatio)\n{\n    float woodWeight = 0.0;\n    if (wood_pore_type == 0)\n        woodWeight = 1.0;\n    else if (wood_pore_type == 1)\n        woodWeight = earlyWoodRatio;\n    else if (wood_pore_type == 2)\n        woodWeight = 1.0 - earlyWoodRatio;\n    else\n        woodWeight = -1.0;\n    return woodWeight;\n}\n#if defined( PRISMWOODBUMP )\nfloat ComputeEarlyWoodRatioAA(float radiusLength, float invUnitExt)\n{\n    float transPixels = min(wood_fall_rise.x, wood_fall_rise.y) * wood_ring_thickness * invUnitExt;\n    float samplesf = clamp(4.0 / transPixels, 1.0, 4.0);\n    int samples = int(samplesf);\n    float inverseSamples = 1.0 / float(samples);\n    vec2 rdelta = vec2(dFdx(radiusLength), dFdy(radiusLength)) * inverseSamples;\n    float earlywoodRatio = 0.0;\n    for (int i = 0; i < 4; ++i)\n    {\n        if (i >= samples) break;\n        for (int j = 0; j < 4; ++j)\n        {\n            if (j >= samples) break;\n            float r = radiusLength + dot(vec2(i, j), rdelta);\n            earlywoodRatio += ComputeEarlyWoodRatio(r);\n        }\n    }\n    return earlywoodRatio * (inverseSamples * inverseSamples);\n}\nfloat LatewoodDepthVariation(float invUnitExt)\n{\n    float transPixels = min(wood_fall_rise.x, wood_fall_rise.y) * wood_ring_thickness * invUnitExt;\n    return clamp(transPixels * 0.5, 0.0, 1.0);\n}\nfloat LatewoodHeightVariation(float earlyWoodRatio, float latewoodBumpDepth,\n                              float depthVar)\n{\n    return ( 1.0 - earlyWoodRatio ) * latewoodBumpDepth * depthVar;\n}\nfloat PoreDepthVariation(float woodWeight, float invUnitExt)\n{\n    float porePixels = woodWeight * wood_pore_radius * invUnitExt;\n    return clamp(porePixels, 0.0, 1.0);\n}\nfloat PoreHeightVariation(float earlyWoodRatio, float poresWeight, float poreDepth,\n                          float depthVar)\n{\n    return poresWeight * (-1.0 * poreDepth) * depthVar;\n}\nvoid ComputeTangents(vec3 normal, out vec3 u, out vec3 v)\n{\n    float scale = normal.z < 0.0 ? -1.0 : 1.0;\n    vec3 temp = scale * normal;\n    float e    = temp.z;\n    float h    = 1.0/(1.0 + e);\n    float hvx  = h   *  temp.y;\n    float hvxy = hvx * -temp.x;\n    u = vec3(e + hvx * temp.y, hvxy,                -temp.x);\n    v = vec3(hvxy,             e + h * temp.x * temp.x, -temp.y);\n    u *= scale;\n    v *= scale;\n}\nvec3 WoodBumpHeight(float heightLeft, float heightRight, float heightBack, float heightFront)\n{\n    const float epsilon = 0.001;\n    float heightDeltaX = heightRight - heightLeft;\n    vec3 Tu = vec3(2.0 * epsilon, 0.0, heightDeltaX);\n    float heightDeltaY = heightFront - heightBack;\n    vec3 Tv = vec3(0.0, 2.0 * epsilon, heightDeltaY);\n    return cross(Tu, Tv);\n}\nvec3 SelectNormal(vec3 N, vec3 bumpN, vec3 V)\n{\n    float bumpNdotV = dot(bumpN, V);\n    if(bumpNdotV > 0.0)\n        return bumpN;\n    else return N;\n}\nfloat MinInverseUnitExtent(vec3 p)\n{\n    return 1.0 / max(max(length(dFdx(p.xy)), length(dFdy(p.xy))), 0.000001);\n}\nfloat HeightVariation(vec3 pos)\n{\n    vec3 p = Distort(pos);\n    float radiusLength = length(p.xy);\n    if (wood_growth_perlin_enable)\n        radiusLength = DistortRadiusLength(radiusLength);\n    float invUnitExt = MinInverseUnitExtent(p);\n    float earlyWoodRatio = ComputeEarlyWoodRatioAA(radiusLength, invUnitExt);\n    float woodWeight = ComputeWoodWeight(earlyWoodRatio);\n    float poresWeight = Weight2DNeighborImpulses(p, woodWeight);\n    float depthVar = PoreDepthVariation(woodWeight, invUnitExt);\n    float poreHeightVariation = -1.0 * poresWeight * wood_pore_depth * depthVar;\n    float latewoodHeightVariation = 0.0;\n    if (wood_use_latewood_bump)\n    {\n        float latewoodDepthVar = LatewoodDepthVariation(invUnitExt);\n        latewoodHeightVariation = (1.0 - earlyWoodRatio) * wood_latewood_bump_depth * latewoodDepthVar;\n    }\n    float sumHeightVariation = poreHeightVariation + latewoodHeightVariation;\n    return sumHeightVariation;\n}\n#endif\nvec3 NoiseWood(vec3 p, inout float roughness)\n{\n    p = Distort(p);\n    float radiusLength = length(p.xy);\n    if(wood_growth_perlin_enable)\n        radiusLength = DistortRadiusLength(radiusLength);\n#if defined( PRISMWOODBUMP )\n    float invUnitExt = MinInverseUnitExtent( p );\n    float earlyWoodRatio = ComputeEarlyWoodRatioAA(radiusLength, invUnitExt);\n#else\n    float earlyWoodRatio = ComputeEarlyWoodRatio(radiusLength);\n#endif\n    vec3 earlyColor = wood_early_color;\n    if (wood_earlycolor_perlin_enable)\n        earlyColor = DistortEarlyColor(earlyColor, radiusLength);\n    vec3 lateColor;\n    if (wood_use_manual_late_color)\n        lateColor = wood_manual_late_color;\n    else\n        lateColor = pow(abs(earlyColor), vec3(wood_late_color_power));\n    if(wood_latecolor_perlin_enable)\n        lateColor = DistortLateColor(lateColor, radiusLength);\n    vec3 diffAlbedo = earlyWoodRatio * earlyColor + (1.0 - earlyWoodRatio) * lateColor;\n    if(wood_diffuse_perlin_enable)\n        diffAlbedo = DistortDiffuseColor(diffAlbedo, p);\n    if (wood_use_pores)\n    {\n        float woodWeight = ComputeWoodWeight(earlyWoodRatio);\n        diffAlbedo = DarkenColorWithPores(p, diffAlbedo, woodWeight);\n    }\n    if (wood_use_rays)\n        diffAlbedo = DarkenColorWithRays(p, diffAlbedo);\n    if(wood_use_groove_roughness)\n        roughness = LayerRoughnessVar(roughness, earlyWoodRatio);\n    return clamp(diffAlbedo, vec3(0.0), vec3(1.0));\n}\n#if defined(PRISMWOODBUMP)\nvoid getFinalWoodContext(\n    inout vec3 N, vec3 V, inout vec3 Tu, inout vec3 Tv, vec3 p,\n    vec3 geoNormal, vec3 tNormal, mat3 normalMatrix\n) {\n    vec3 offsetTuLeft = p - 0.001 * Tu;\n    vec3 offsetTuRight = p + 0.001 * Tu;\n    vec3 offsetTvLeft = p - 0.001 * Tv;\n    vec3 offsetTvRight = p + 0.001 * Tv;\n    float heightVariationTuLeft = HeightVariation(offsetTuLeft);\n    float heightVariationTuRight = HeightVariation(offsetTuRight);\n    float heightVariationTvLeft = HeightVariation(offsetTvLeft);\n    float heightVariationTvRight = HeightVariation(offsetTvRight);\n    vec3 bumpHeight = WoodBumpHeight(heightVariationTuLeft, heightVariationTuRight, heightVariationTvLeft, heightVariationTvRight);\n    vec3 newNormal = normalize(bumpHeight.x * Tu + bumpHeight.y * Tv + bumpHeight.z * vtNormal);\n    vec3 newNormalView = normalize(vNormalMatrix * newNormal);\n    vec3 selectedNormal = SelectNormal(geoNormal, newNormalView, V);\n    ComputeTangents(selectedNormal, Tu, Tv);\n    Tu = normalize(Tu);\n    Tv = normalize(Tv);\n    N = faceforward(selectedNormal, -V, selectedNormal);\n}\n#endif\n#endif\n"},4949:e=>{e.exports="\nuniform float shadowESMConstant;\nuniform float shadowMapRangeMin;\nuniform float shadowMapRangeSize;\n"},65080:e=>{e.exports="\n#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap;\nuniform vec2      shadowMapSize;\nuniform float     shadowDarkness;\nuniform float     shadowBias;\nuniform vec3      shadowLightDir;\nvarying vec4 vShadowCoord;\n#include <shadowmap_decl_common>\nfloat getShadowValue() {\n    float fDepth;\n    vec3 shadowColor = vec3( 1.0 );\n    vec3 shadowCoord = vShadowCoord.xyz / vShadowCoord.w;\n    shadowCoord.xyz = 0.5 * (shadowCoord.xyz + vec3(1.0, 1.0, 1.0));\n    bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n    bool inFrustum = all( inFrustumVec );\n    float shadowValue = 1.0;\n    if (inFrustum) {\n        shadowCoord.z = min(0.999, shadowCoord.z);\n        shadowCoord.z -= shadowBias;\n#ifdef USE_HARD_SHADOWS\n        vec4 rgbaDepth = texture2D( shadowMap, shadowCoord.xy );\n        float fDepth = rgbaDepth.r;\n        if ( fDepth < shadowCoord.z ) {\n            shadowValue = 1.0 - shadowDarkness;\n        }\n#else\n        vec4 rgbaDepth = texture2D( shadowMap, shadowCoord.xy );\n        float shadowMapValue = rgbaDepth.r;\n        shadowValue = exp(-shadowESMConstant * shadowCoord.z) * shadowMapValue;\n        shadowValue = min(shadowValue, 1.0);\n        shadowValue = mix(1.0 - shadowDarkness, 1.0, shadowValue);\n#endif\n    }\n    return shadowValue;\n}\n#else\nfloat getShadowValue() { return 1.0; }\n#endif\nvec3 applyEnvShadow(vec3 colorWithoutShadow, vec3 worldNormal) {\n#if defined(USE_SHADOWMAP)\n    float dp  = dot(shadowLightDir, worldNormal);\n    float dpValue = (dp + 1.0) / 2.0;\n    dpValue = min(1.0, dpValue * 1.5);\n    float sv = getShadowValue();\n    vec3 result = colorWithoutShadow * min(sv, dpValue);\n    return result;\n#else\n    return colorWithoutShadow;\n#endif\n}\n"},11458:e=>{e.exports="\n#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord;\nuniform mat4 shadowMatrix;\n#endif\n"},36238:e=>{e.exports="\n#ifdef USE_SHADOWMAP\n{\n    vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n    vShadowCoord = shadowMatrix * worldPosition;\n}\n#endif\n"},94005:e=>{e.exports="uniform vec4 themingColor;\n"},25759:e=>{e.exports="gl_FragColor.rgb = mix(gl_FragColor.rgb, themingColor.rgb, themingColor.a);\n"},73985:e=>{e.exports="\nfloat luminance_post(vec3 rgb) {\n    return dot(rgb, vec3(0.299, 0.587, 0.114));\n}\nfloat luminance_pre(vec3 rgb) {\n    return dot(rgb, vec3(0.212671, 0.715160, 0.072169));\n}\nvec3 xyz2rgb(vec3 xyz) {\n    vec3 R = vec3( 3.240479, -1.537150, -0.498535);\n    vec3 G = vec3(-0.969256,  1.875992,  0.041556);\n    vec3 B = vec3( 0.055648, -0.204043,  1.057311);\n    vec3 rgb;\n    rgb.b = dot(xyz, B);\n    rgb.g = dot(xyz, G);\n    rgb.r = dot(xyz, R);\n    return rgb;\n}\nvec3 rgb2xyz(vec3 rgb) {\n    vec3 X = vec3(0.412453, 0.35758, 0.180423);\n    vec3 Y = vec3(0.212671, 0.71516, 0.0721688);\n    vec3 Z = vec3(0.0193338, 0.119194, 0.950227);\n    vec3 xyz;\n    xyz.x = dot(rgb, X);\n    xyz.y = dot(rgb, Y);\n    xyz.z = dot(rgb, Z);\n    return xyz;\n}\nvec3 xyz2xyY(vec3 xyz) {\n    float sum = xyz.x + xyz.y + xyz.z;\n    sum = 1.0 / sum;\n    vec3 xyY;\n    xyY.z = xyz.y;\n    xyY.x = xyz.x * sum;\n    xyY.y = xyz.y * sum;\n    return xyY;\n}\nvec3 xyY2xyz(vec3 xyY) {\n    float x = xyY.x;\n    float y = xyY.y;\n    float Y = xyY.z;\n    vec3 xyz;\n    xyz.y = Y;\n    xyz.x = x * (Y / y);\n    xyz.z = (1.0 - x - y) * (Y / y);\n    return xyz;\n}\nfloat toneMapCanon_T(float x)\n{\n    float xpow = pow(x, 1.60525727);\n    float tmp = ((1.05542877*4.68037409)*xpow) / (4.68037409*xpow + 1.0);\n    return clamp(tmp, 0.0, 1.0);\n}\nconst float Shift = 1.0 / 0.18;\nfloat toneMapCanonFilmic_NoGamma(float x) {\n    x *= Shift;\n    const float A = 0.2;\n    const float B = 0.34;\n    const float C = 0.002;\n    const float D = 1.68;\n    const float E = 0.0005;\n    const float F = 0.252;\n    const float scale = 1.0/0.833837;\n    return (((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F) * scale;\n}\nvec3 toneMapCanonFilmic_WithGamma(vec3 x) {\n    x *= Shift;\n    const float A = 0.27;\n    const float B = 0.29;\n    const float C = 0.052;\n    const float D = 0.2;\n    const float F = 0.18;\n    const float scale = 1.0/0.897105;\n    return (((x*(A*x+C*B))/(x*(A*x+B)+D*F))) * scale;\n}\nvec3 toneMapCanonOGS_WithGamma_WithColorPerserving(vec3 x) {\n    vec3 outColor = x.rgb;\n    outColor = min(outColor, vec3(3.0));\n    float inLum = luminance_pre(outColor);\n    if (inLum > 0.0) {\n        float outLum = toneMapCanon_T(inLum);\n        outColor = outColor * (outLum / inLum);\n        outColor = clamp(outColor, vec3(0.0), vec3(1.0));\n    }\n    float gamma = 1.0/2.2;\n    outColor = pow(outColor, vec3(gamma));\n    return outColor;\n}\n"},13458:e=>{e.exports="\n#ifdef WIDE_LINES\nattribute vec3 prev;\nattribute vec3 next;\nattribute float side;\nuniform vec2 view_size;\nvec2 to2d(vec4 i) {\n  return i.xy / i.w;\n}\n#endif\n"},16017:e=>{e.exports="\n#ifdef WIDE_LINES\nvec4 mvpPosition = projectionMatrix * mvPosition; \nmat3 vectorMatrix = mat3(modelViewMatrix);\nvec2 _pos = to2d(mvpPosition) * view_size;\nvec2 _prev = to2d(projectionMatrix * vec4(mvPosition.xyz + vectorMatrix * (prev * 0.01), 1.0)) * view_size;\nvec2 _next = to2d(projectionMatrix * vec4(mvPosition.xyz - vectorMatrix * (next * 0.01), 1.0)) * view_size;\nvec2 dir1 = _pos - _next;\nvec2 dir2 = _prev - _pos;\ndir2 = (length(dir2) > 0.0000001) ? normalize(dir2) : vec2(0.0, 0.0);\ndir1 = (length(dir1) > 0.0000001) ? normalize(dir1) : dir2;\nvec2 dir_sharp = normalize(dir1 + dir2);\nvec2 dir = normalize(dir1 + dir_sharp);\nvec2 offset = vec2(-dir.y, dir.x);\nfloat len = 1.0 / cross(vec3(offset, 0), vec3(dir1, 0)).z;\noffset *= len;\noffset /= view_size;\noffset *= side;\noffset *= mvpPosition.w;\nmvpPosition.xy += offset;\ngl_Position = mvpPosition;\n#endif\n"},2867:e=>{e.exports="varying vec3 vColor;\nvarying vec2 vUv;\nuniform samplerCube envMap;\nuniform vec3 uCamDir;\nuniform vec3 uCamUp;\nuniform vec2 uResolution;\nuniform float uHalfFovTan;\nuniform float opacity;\nuniform bool envMapBackground;\n#ifdef USE_BACKGROUND_TEXTURE\nuniform sampler2D backgroundTexture;\n#endif\n#include <env_sample>\nconst int bloomRange = 4;\n#include <ordered_dither>\nuniform float envMapExposure;\n#if TONEMAP_OUTPUT > 0\nuniform float exposureBias;\n#include <tonemap>\n#endif\nvec3 rayDir(in vec2 vUv) {\n    vec3 A = (uResolution.x/uResolution.y)*normalize(cross(uCamDir,uCamUp)) * (uHalfFovTan * 2.0);\n    vec3 B = normalize(uCamUp) * (uHalfFovTan * 2.0);\n    vec3 C = normalize(uCamDir);\n    vec3 ray = normalize( C + (2.0*vUv.x-1.0)*A + (2.0*vUv.y-1.0)*B );\n    return ray;\n}\nvec3 getColor(in vec3 rd) {\n    return RGBMDecode(textureCube(envMap, adjustLookupVector(rd)), envMapExposure);\n}\nvoid main() {\n    vec3 rd = rayDir(vUv);\n    vec3 outColor;\n    float alpha = opacity;\n#ifdef USE_BACKGROUND_TEXTURE\n    vec4 texel = texture2D(backgroundTexture, vUv);\n    outColor = texel.rgb;\n    alpha *= texel.a;\n#else\n    if (envMapBackground) {\n        outColor = getColor(rd);\n#if TONEMAP_OUTPUT == 1\n        outColor = toneMapCanonOGS_WithGamma_WithColorPerserving(exposureBias * outColor);\n#elif TONEMAP_OUTPUT == 2\n        outColor = toneMapCanonFilmic_WithGamma(exposureBias * outColor);\n#endif\n    }\n    else {\n        outColor = vColor;\n    }\n#endif\n    gl_FragColor = vec4(orderedDithering(outColor), alpha);\n}\n"},59047:e=>{e.exports="uniform vec3 color1;\nuniform vec3 color2;\nvarying vec2 vUv;\nvarying vec3 vColor;\nvoid main() {\n    if (uv.y == 0.0)\n        vColor = color2;\n    else\n        vColor = color1;\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n"},48544:e=>{e.exports="uniform vec3 diffuse;\nuniform float opacity;\n#if defined(DEPTH_OCCLUSION) && DEPTH_OCCLUSION == 1\nuniform sampler2D tDepthTest;\nuniform vec2 tDepthResolution;\nvarying float vDepthPositionZ;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#if NUM_CUTPLANES > 0\nvarying highp vec3 vWorldPosition;\n#endif\n#if defined( PARTICLE_UV )\nvarying highp vec4 vUVp;\n#endif\n#include <cutplanes>\n#include <id_decl_frag>\n#include <theming_decl_frag>\nvoid main() {\n#if NUM_CUTPLANES > 0\n    checkCutPlanes(vWorldPosition);\n#endif\n    vec3 outgoingLight = vec3( 0.0 );\n    vec4 diffuseColor = vec4( diffuse, opacity );\n#if defined( USE_MAP ) && defined ( PARTICLE_FRAGMENT )\n    #if defined( PARTICLE_UV )\n        vec2 uv3 = mix( vUVp.xy, vUVp.zw, gl_PointCoord );\n        diffuseColor = texture2D( map, uv3);\n    #else\n    \tdiffuseColor = texture2D( map, gl_PointCoord );\n    #endif\n#else\n    #include <map_fragment>\n#endif\n#include <color_fragment>\n#include <alphamap_fragment>\n#include <alphatest_fragment>\n#include <specularmap_fragment>\n    outgoingLight = diffuseColor.rgb;\n#if !defined ( PARTICLE_FRAGMENT )\n    #include <lightmap_fragment>\n    #include <envmap_fragment>\n#endif\n#include <linear_to_gamma_fragment>\n    gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n    vec3 geomNormal = vec3(0.0,0.0,0.0);\n    float depth = 0.0;\n#include <theming_frag>\n#if defined(DEPTH_OCCLUSION) && DEPTH_OCCLUSION == 1\n    vec2 depthUV = gl_FragCoord.xy * tDepthResolution;\n    float depthVal = texture2D(tDepthTest, depthUV).z;\n    if(depthVal > vDepthPositionZ && depthVal != 0.) {\n        discard;\n    }\n#endif\n#include <final_frag>\n}\n"},75101:e=>{e.exports="#include <id_decl_vert>\n#include <decl_point_size>\n#include <common>\n#include <map_pars_vertex>\n#include <lightmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <wide_lines_decl>\n#include <pack_normals>\n#ifdef USE_INSTANCING\n    #include <instancing_decl_vert>\n#endif\n#if defined( PARTICLE_UV )\nattribute vec4 uvp;\nvarying highp vec4 vUVp;\n#endif\n#if defined (PARTICLE_FLAGS)\nattribute float pointScale;\n#endif\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#if defined(DEPTH_OCCLUSION) && DEPTH_OCCLUSION == 1\nvarying float vDepthPositionZ;\n#endif\nvoid main() {\n#ifdef USE_INSTANCING\n    vec3 instancePosition = getInstancePos(position);\n    #define position instancePosition\n#endif\n#if defined(USE_ENVMAP) && (defined(UNPACK_NORMALS) || defined(USE_INSTANCE))\n    vec3 correctNormal;\n    #ifdef UNPACK_NORMALS\n        correctNormal = decodeNormal(normal);\n    #else\n        correctNormal = normal;\n    #endif\n    #ifdef USE_INSTANCING\n        correctNormal = getInstanceNormal(correctNormal);\n    #endif\n    #define normal correctNormal\n#endif\n#include <map_vertex>\n#include <lightmap_vertex>\n#include <color_vertex>\n#ifdef USE_ENVMAP\n#include <defaultnormal_vertex>\n#endif\n#include <default_vertex>\n#include <wide_lines_vert>\n#include <worldpos_vertex>\n#if NUM_CUTPLANES > 0\n    vec4 _worldPosition = modelMatrix * vec4( position, 1.0 );\n    vWorldPosition = _worldPosition.xyz;\n#endif\n#if defined(DEPTH_OCCLUSION) && DEPTH_OCCLUSION == 1\n    vec4 _vDepthPosition = modelViewMatrix * vec4( position, 1.0 );\n    vDepthPositionZ = _vDepthPosition.z;\n#endif\n#if defined( PARTICLE_UV )\n    vUVp = uvp;\n#endif\n#include <envmap_vertex>\n#include <id_vert>\n#include <point_size>\n#if defined (PARTICLE_FLAGS) \n    gl_PointSize *= clamp(pointScale, 0.0, 2.0);\n#endif\n}\n"},20505:e=>{e.exports="uniform sampler2D tDiffuse;\nuniform sampler2D tAO;\nuniform int useAO;\nuniform float aoOpacity;\nuniform sampler2D tOverlay;\nuniform int useOverlay;\nuniform int useOverlayAlpha;\nuniform vec2 resolution;\nuniform vec4 objIDv4;\nuniform sampler2D tID;\nuniform vec4 edgeObjIDv4;\n#if defined(USE_MODEL_ID)\n#if defined(HIGHLIGHT_MODEL_ID_COUNT)\nuniform vec2 modelIDsv2v[HIGHLIGHT_MODEL_ID_COUNT];\n#else\nuniform vec2 modelIDv2;\n#endif\nuniform sampler2D tID2;\nuniform vec2 edgeModelIDv2;\n#endif\nuniform float highlightIntensity;\nuniform vec3 selectionColor;\nuniform float highlightFullModel;\nuniform vec3 highlightColor;\n#ifdef IS_2D\nuniform float expand2dSelection;\n#endif\nuniform sampler2D tCrossFadeTex0;\nuniform sampler2D tCrossFadeTex1;\nuniform float     crossFadeOpacity0;\nuniform float     crossFadeOpacity1;\nvarying vec2 vUv;\n#ifdef SPATIAL_FILTER\n#include <depth_texture>\n#endif\n#include <tonemap>\n#ifdef USE_IDBUFFER_SELECTION\nbool isSelection(vec2 vUv, float I, float J) {\n    vec4 idAtPixel = texture2D(tID, vUv+resolution*vec2(I,J));\n    if (idAtPixel.rgb == vec3(0.0))\n        return false;\n#if defined(USE_MODEL_ID)\n    vec4 modelAtPixel = texture2D(tID2, vUv+resolution*vec2(I,J));\n    idAtPixel.a = modelAtPixel.b;\n    vec4 idDelta = abs(idAtPixel.rgba - edgeObjIDv4.rgba);\n    vec2 modelDelta = abs(modelAtPixel.rg - edgeModelIDv2.rg);\n#else\n    vec4 idDelta = vec4(abs(idAtPixel.rgb - edgeObjIDv4.rgb), 0.0);\n    vec2 modelDelta = vec2(0.0, 0.0);\n#endif\n    if (max(max(modelDelta.r, modelDelta.g), max(max(idDelta.r, idDelta.g), max(idDelta.b, idDelta.a))) < 1e-3) {\n        return true;\n    } else {\n        return false;\n    }\n}\n#else\nbool isSelected(vec3 C) {\n    float minS = min(selectionColor.r, min(selectionColor.g, selectionColor.b));\n    float maxS = max(selectionColor.r, max(selectionColor.g, selectionColor.b));\n    float satS = maxS - minS;\n    float minC = min(C.r, min(C.g, C.b));\n    float maxC = max(C.r, max(C.g, C.b));\n    float satC = maxC - minC;\n    if (satC < .01 || satS < .01)\n        return false;\n    vec3 S = (selectionColor - minS) / satS;\n    vec3 H = (C - minC) / satC;\n    vec3 D = H - S;\n    float eps = .15;\n    return (abs(D.r) + abs(D.g) + abs(D.b) < eps)\n        || (maxC >= (1.0 - eps) && D.r >= -eps && D.g >= -eps && D.b >= -eps);\n}\n#define IS_SELECTION(C) isSelected((C).rgb)\n#endif\nvec4 overlayEdgeDetect(vec2 vUv) {\n#ifdef IS_2D\n#define MAX_ALPHA(c)\n#define SUM_ALPHA(c, w) sumAlpha += c.a * w; sumWeight += w;\n#else\n#define MAX_ALPHA(c) maxAlpha = max(maxAlpha, c.a);\n#define SUM_ALPHA(c, w) \n#endif\n#ifdef USE_IDBUFFER_SELECTION\n#define CHECK_EDGE_ALPHA(I, J, W)     { vec4 c = texture2D( tOverlay, vUv+resolution*vec2((I),(J)) ); MAX_ALPHA(c) if (c.a > 0.0 && isSelection(vUv, I, J)) { hasEdge++; SUM_ALPHA(c, W) selectionPixel = c; } }\n#else\n#define CHECK_EDGE_ALPHA(I, J, W)     { vec4 c = texture2D( tOverlay, vUv+resolution*vec2((I),(J)) ); MAX_ALPHA(c) if (c.a > 0.0 && IS_SELECTION(c)) { hasEdge++; SUM_ALPHA(c, W) selectionPixel = c; } }\n#endif\n#ifndef IS_2D\n#define CHECK_EDGE_SELECTION(I, J) { vec4 c = texture2D( tOverlay, vUv+resolution*vec2((I),(J)) ); MAX_ALPHA(c) if (c.a <= 0.0) hasEdge++; }\n#endif\n    int hasEdge = 0;\n    vec4 center = texture2D(tOverlay, vUv);\n    vec4 selectionPixel = vec4(0.0);\n#ifdef IS_2D\n    float sumAlpha = 0.0, sumWeight = 0.0;\n#else\n    float maxAlpha = 0.0;\n    bool paintOutline = false;\n#endif\n    if (center.a <= 0.0) {\n        CHECK_EDGE_ALPHA(-1.0,-1.0, 1.0);\n        CHECK_EDGE_ALPHA( 0.0,-1.0, 2.0);\n        CHECK_EDGE_ALPHA( 1.0,-1.0, 1.0);\n        CHECK_EDGE_ALPHA(-1.0, 0.0, 2.0);\n        CHECK_EDGE_ALPHA( 1.0, 0.0, 2.0);\n        CHECK_EDGE_ALPHA(-1.0, 1.0, 1.0);\n        CHECK_EDGE_ALPHA( 0.0, 1.0, 2.0);\n        CHECK_EDGE_ALPHA( 1.0, 1.0, 1.0);\n        if (hasEdge != 0) {\n#ifdef IS_2D\n            center.a = -clamp(expand2dSelection - 1.0 + sumAlpha / sumWeight, 0.0, 1.0);\n            center.rgb = center.a < 0.0 ? selectionPixel.rgb : center.rgb;\n#else\n            center = selectionPixel;\n            paintOutline = true;\n#endif\n        }\n    }\n#ifdef USE_IDBUFFER_SELECTION\n    else if (center.a > 0.0 && isSelection(vUv, 0.0, 0.0)) {\n#else\n    else if (center.a > 0.0 && IS_SELECTION(center)) {\n#endif\n#ifdef IS_2D\n        center.a = -clamp(center.a + expand2dSelection, 0.0, 1.0);\n#else\n        CHECK_EDGE_SELECTION(-1.0,-1.0);\n        CHECK_EDGE_SELECTION( 0.0,-1.0);\n        CHECK_EDGE_SELECTION( 1.0,-1.0);\n        CHECK_EDGE_SELECTION(-1.0, 0.0);\n        CHECK_EDGE_SELECTION( 1.0, 0.0);\n        CHECK_EDGE_SELECTION(-1.0, 1.0);\n        CHECK_EDGE_SELECTION( 0.0, 1.0);\n        CHECK_EDGE_SELECTION( 1.0, 1.0);\n        if (hasEdge != 0)\n            paintOutline = true;\n        else\n            center.a = -center.a;\n#endif\n    }\n#ifndef IS_2D\n    if (paintOutline) {\n        float maxComponent = max(center.r, max(center.g, center.b));\n        center.rgb /= maxComponent;\n        center.rgb = sqrt(center.rgb);\n        center.a = 0.5 + 0.5 * maxAlpha * 0.125 * float(hasEdge);\n    }\n#endif\n    return center;\n}\n#ifdef SPATIAL_FILTER\nSPATIAL_FILTER\n#endif\nvec4 sampleColor() {\n    return texture2D( tDiffuse, vUv );\n}\nfloat sampleAO() {\n    return (useAO != 0) ? sqrt(texture2D(tAO, vUv).r) : 1.0;\n}\nvec3 applyCrossFade(vec3 srcColor, sampler2D fadeTex, float opacity, vec2 vUv) {\n    vec4 blendCol = texture2D(fadeTex, vUv);\n    return mix(srcColor.rgb, blendCol.rgb, blendCol.a * opacity);\n}\nvoid applyHighlighting(inout vec3 rgb, float filterValue) {\n#ifdef IS_2D\n    rgb = mix(rgb, vec3(1.0,1.0,0.0), filterValue * highlightIntensity * 0.25);\n#else\n    rgb += highlightColor * filterValue * highlightIntensity * 0.20;\n#endif\n}\n#ifdef USE_MODEL_ID\nfloat getModelIdDelta(vec2 a, vec2 b) {\n    vec2 delta = abs(a-b);\n    return max(delta.r, delta.g);\n}\nfloat getModelIdDelta(vec2 modelAtPixel) {\n    \n#ifdef HIGHLIGHT_MODEL_ID_COUNT\n    float delta = 1.0;\n    for (int i=0; i<HIGHLIGHT_MODEL_ID_COUNT; i++) {\n        delta = min(delta, getModelIdDelta(modelAtPixel, modelIDsv2v[i]));\n    }\n    return delta;\n#else\n    return getModelIdDelta(modelAtPixel, modelIDv2.rg);\n#endif\n}\n#endif\nvoid main() {\n    vec4 texel = sampleColor();\n    float ao = sampleAO();\n    #ifdef NUM_CROSSFADE_TARGETS\n        #if (NUM_CROSSFADE_TARGETS > 1)\n            #if (TARGET_FADE_MODE == 0)\n                texel.rgb = applyCrossFade(texel.rgb, tCrossFadeTex0, crossFadeOpacity0, vUv);\n                texel.rgb = applyCrossFade(texel.rgb, tCrossFadeTex1, crossFadeOpacity1, vUv);\n            #else\n                vec4 t0 = texture2D(tCrossFadeTex0, vUv);\n                vec4 t1 = texture2D(tCrossFadeTex1, vUv);\n                vec4 mixed = mix(t0, t1, crossFadeOpacity1);\n                texel.rgb = mix(texel.rgb, mixed.rgb, mixed.a);\n                float aoGamma = 1.0 + 3.0 * (1.0 - 2.0 * abs(crossFadeOpacity1 - 0.5));\n                if (aoGamma == 0.0)\n                    aoGamma = 1.0;\n                ao = pow(ao, 1.0 / aoGamma);\n            #endif\n        #else\n            vec4 mixed = texture2D(tCrossFadeTex0, vUv);\n            texel.rgb = mix(texel.rgb, mixed.rgb, mixed.a);\n        #endif\n    #else\n    #endif\n    ao = 1.0 - (1.0 - ao) * aoOpacity;\n    texel.rgb *= ao;\n    if (useOverlay != 0) {\n        vec4 overlay = overlayEdgeDetect(vUv);\n        if (overlay.a < 0.0) {\n            overlay.a = -overlay.a;\n#ifdef IS_2D\n            overlay.a *= 0.6;\n#else\n            if (overlay.a >= 0.99) {\n                overlay.a = 0.75;\n                texel.rgb = vec3(luminance_post(texel.rgb));\n            }\n#endif\n        }\n#ifdef IS_2D\n        texel.rgb = texel.rgb * (1.0 - overlay.a) + overlay.rgb;\n#else\n        texel.rgb = texel.rgb * (1.0 - overlay.a) + sqrt(overlay.rgb * overlay.a);\n#endif\n        if (useOverlayAlpha != 0) {\n            texel.a += overlay.a * (1.0 - texel.a);\n        }\n    }\n    if (objIDv4 != vec4(0.0)) {\n    vec4 idAtPixel = texture2D(tID, vUv);\n    #ifdef SPATIAL_FILTER\n        vec3 worldPos = reconstructWorldPosition(gl_FragCoord.xy, vUv);\n        float filterValue = (spatialFilter(worldPos) ? 1.0 : 0.0);\n        if (idAtPixel != vec4(1,1,1,1)) {\n            applyHighlighting(texel.rgb, filterValue);\n        }\n    #else\n        #if defined(USE_MODEL_ID)\n            vec4 modelAtPixel = texture2D(tID2, vUv);\n            idAtPixel.a = modelAtPixel.b;\n            vec4 idDelta = abs(idAtPixel.rgba - objIDv4.rgba) * (1.0 - highlightFullModel);\n            float modelDelta = getModelIdDelta(modelAtPixel.rg);\n        #else\n            vec4 idDelta = vec4(abs(idAtPixel.rgb - objIDv4.rgb), 0.0);\n            float modelDelta = 0.0;\n        #endif\n            if (max(modelDelta, max(max(idDelta.r, idDelta.g), max(idDelta.b, idDelta.a))) < 1e-3) {\n                applyHighlighting(texel.rgb, 1.0);\n            }\n    #endif\n    }\n    gl_FragColor = texel;\n}\n"},40518:e=>{e.exports="\n#include <depth_texture>\nuniform sampler2D tDiffuse;\nuniform sampler2D tID;\nuniform vec2 resolution;\nuniform float cameraNear;\nuniform float cameraFar;\nuniform sampler2D tFill;\nuniform sampler2D tPaper;\nuniform int style;\nuniform int idEdges;\nuniform int normalEdges;\nuniform int depthEdges;\nuniform float brightness;\nuniform float contrast;\nuniform int grayscale;\nuniform int preserveColor;\nuniform int outlineNoise;\nuniform float levels;\nuniform float repeats;\nuniform float rotation;\nuniform float outlineRadius;\nuniform sampler2D tGraphite1;\nuniform sampler2D tGraphite2;\nuniform sampler2D tGraphite3;\nuniform sampler2D tGraphite4;\nuniform sampler2D tGraphite5;\nuniform sampler2D tGraphite6;\nuniform sampler2D tGraphite7;\nuniform sampler2D tGraphite8;\nvarying vec2 vUv;\nvec4 recoverNZ(vec4 nrmz) {\n    float z = sqrt(1.0 - dot(nrmz.xy, nrmz.xy));\n    nrmz.w = -(nrmz.z + cameraNear) / (cameraFar - cameraNear);\n    nrmz.z = z;\n    return nrmz;\n}\n#include <tonemap>\n#include <hsv>\nvec3 quantize(vec3 c) {\n    float L = max(c.r, max(c.g, c.b));\n    c *= floor(L * (levels-1.0) + 0.5) / (L * (levels-1.0));\n    return c;\n}\nvec3 quantizeRGB(vec3 c) {\n    c *= c;\n    c *= floor(c * levels * 0.9999) / (levels-1.0);\n    return sqrt(c);\n}\nvec3 clampHue(vec3 c, float hues, float sats, float vals) {\n    vec3 hsv = rgb2hsv(c);\n    hsv.x = floor(hsv.x * hues + 0.5) / hues;\n    hsv.y = floor(hsv.y * sats + 0.5) / sats;\n    hsv.z = floor(hsv.z * vals + 0.5) / vals;\n    vec3 col = hsv2rgb(hsv);\n    return col;\n}\nvec3 reconstructCSFaceNormal(vec3 C) {\n    return normalize(cross(dFdy(C), dFdx(C)));\n}\nvec3 getPosition(ivec2 ssP, float depth) {\n    vec3 P;\n    P = reconstructCSPosition(vec2(ssP) + vec2(0.5), depth);\n    return P;\n}\nint isObjectEdge() {\n    vec2 uv = vUv;\n    if (outlineNoise == 1) {\n        vec4 noise = texture2D(tGraphite7, vUv);\n        uv = vUv + 0.02 * (noise.xy - vec2(0.25));\n    }\n    vec4 MM = texture2D(tID, uv);\n    vec4 LL = texture2D(tID, uv + vec2(-outlineRadius, -outlineRadius) * resolution);\n    if (MM != LL) return 1;\n    vec4 LM = texture2D(tID, uv + vec2( 0.0, -outlineRadius) * resolution);\n    if (MM != LM) return 1;\n    vec4 LR = texture2D(tID, uv + vec2( outlineRadius, -outlineRadius) * resolution);\n    if (MM != LR) return 1;\n    vec4 ML = texture2D(tID, uv + vec2(-outlineRadius,  0.0) * resolution);\n    if (MM != ML) return 1;\n    vec4 MR = texture2D(tID, uv + vec2( outlineRadius,  0.0) * resolution);\n    if (MM != MR) return 1;\n    vec4 UL = texture2D(tID, uv + vec2(-outlineRadius,  outlineRadius) * resolution);\n    if (MM != UL) return 1;\n    vec4 UM = texture2D(tID, uv + vec2( 0.0,  outlineRadius) * resolution);\n    if (MM != UM) return 1;\n    vec4 UR = texture2D(tID, uv + vec2( outlineRadius,  outlineRadius) * resolution);\n    if (MM != UR) return 1;\n    return (MM.x + MM.y + MM.z + MM.w) >= 4.0 ? 0 : -1;\n}\nfloat normalDiff(vec3 n1, vec3 n2) {\n    float d = dot(n1.xyz, n2.xyz);\n    return acos(clamp(d, -1.0, 1.0));\n}\nint isNormalDepthEdge() {\n    ivec2 ssC = ivec2(gl_FragCoord.xy);\n    vec2 uv = vUv;\n    if (outlineNoise == 1) {\n        vec4 noise = texture2D(tGraphite7, vUv);\n        uv = vUv + 0.02 * (noise.xy - vec2(0.25));\n    }\n    vec4 MM = texture2D(tDepth, uv);\n    vec4 LL = texture2D(tDepth, uv + vec2(-outlineRadius, -outlineRadius) * resolution);\n    vec4 LM = texture2D(tDepth, uv + vec2( 0.0, -outlineRadius) * resolution);\n    vec4 LR = texture2D(tDepth, uv + vec2( outlineRadius, -outlineRadius) * resolution);\n \n    vec4 ML = texture2D(tDepth, uv + vec2(-outlineRadius,  0.0) * resolution);\n    vec4 MR = texture2D(tDepth, uv + vec2( outlineRadius,  0.0) * resolution);\n    vec4 UL = texture2D(tDepth, uv + vec2(-outlineRadius, outlineRadius) * resolution);\n    vec4 UM = texture2D(tDepth, uv + vec2( 0.0,  outlineRadius) * resolution);\n    vec4 UR = texture2D(tDepth, uv + vec2( outlineRadius,  outlineRadius) * resolution);\n    LL = recoverNZ(LL);\n    LM = recoverNZ(LM);\n    LR = recoverNZ(LR);\n    ML = recoverNZ(ML);\n    MM = recoverNZ(MM);\n    MR = recoverNZ(MR);\n    UL = recoverNZ(UL);\n    UM = recoverNZ(UM);\n    UR = recoverNZ(UR);\n    float dd = 0.0;\n    if ( depthEdges == 1 ) {\n        float G = (abs(UL.w - MM.w) + 2.0 * abs(UM.w - MM.w) + abs(UR.w - MM.w) + 2.0 * abs(ML.w - MM.w) + 2.0 * abs(MR.w - MM.w) + abs(LL.w - MM.w) + 2.0 * abs(LM.w - MM.w) + abs(LR.w - MM.w));\n        dd = abs(dFdx(G)) + abs(dFdy(G));\n    }\n    float Gn = 0.0;\n    if ( normalEdges == 1 ) {\n        float pLL = normalDiff(LL.xyz, MM.xyz);\n        float pLM = normalDiff(LM.xyz, MM.xyz);\n        float pLR = normalDiff(LR.xyz, MM.xyz);\n        float pML = normalDiff(ML.xyz, MM.xyz);\n        float pMM = normalDiff(MM.xyz, MM.xyz);\n        float pMR = normalDiff(MR.xyz, MM.xyz);\n        float pUL = normalDiff(UL.xyz, MM.xyz);\n        float pUM = normalDiff(UM.xyz, MM.xyz);\n        float pUR = normalDiff(UR.xyz, MM.xyz);\n        Gn = (abs(pUL - pMM) + 2.0 * abs(pUM - pMM) + abs(pUR - pMM) + 2.0 * abs(pML - pMM) + 2.0 * abs(pMR - pMM) + abs(pLL - pMM) + 2.0 * abs(pLM - pMM) + abs(pLR - pMM));\n    }\n    \n    return (dd > 0.004 || Gn > 2.0) ? 1 : 0;\n}\nvec3 computeGraphite( vec3 color, vec2 loc ) {\n    float lum = 0.299 * color.r + 0.587 * color.g + 0.114 * color.b;\n    float offset;\n    vec3 col1, col2;\n    if ( lum > 6.0/7.0 ) {\n        col1 = texture2D(tGraphite1, loc ).xyz;\n        col2 = texture2D(tGraphite2, loc ).xyz;\n        offset = 6.0/7.0;\n    } else if ( lum > 5.0/7.0 ) {\n        col1 = texture2D(tGraphite2, loc ).xyz;\n        col2 = texture2D(tGraphite3, loc ).xyz;\n        offset = 5.0/7.0;\n    } else if ( lum > 4.0/7.0 ) {\n        col1 = texture2D(tGraphite3, loc ).xyz;\n        col2 = texture2D(tGraphite4, loc ).xyz;\n        offset = 4.0/7.0;\n    } else if ( lum > 3.0/7.0 ) {\n        col1 = texture2D(tGraphite4, loc ).xyz;\n        col2 = texture2D(tGraphite5, loc ).xyz;\n        offset = 3.0/7.0;\n    } else if ( lum > 2.0/7.0 ) {\n        col1 = texture2D(tGraphite5, loc ).xyz;\n        col2 = texture2D(tGraphite6, loc ).xyz;\n        offset = 2.0/7.0;\n    } else if ( lum > 1.0/7.0 ) {\n        col1 = texture2D(tGraphite6, loc ).xyz;\n        col2 = texture2D(tGraphite7, loc ).xyz;\n        offset = 1.0/7.0;\n    } else {\n        col1 = texture2D(tGraphite7, loc ).xyz;\n        col2 = texture2D(tGraphite8, loc ).xyz;\n        offset = 0.0;\n    }\n    if ( col1.r == 0.0 && col2.r == 0.0 ) {\n        return vec3(lum,lum,lum);\n    }\n    float t = (lum-offset)*7.0;\n    return (col1 * t + col2 * (1.0 - t));\n}\nvec3 colorWithAdjustments() {\n    vec3 sceneRGB = texture2D(tDiffuse, vUv).xyz;\n    if ( brightness != 0.0 || contrast != 0.0) {\n        if ( brightness < 0.0 )\n        {\n            sceneRGB = sceneRGB * (1.0 + brightness);\n        }\n        else\n        {\n            sceneRGB = sceneRGB + ((1.0 - sceneRGB) * brightness);\n        }\n        float slant = tan(( clamp(contrast,-1.0,1.0) + 1.0) * 3.141592/4.001);\n        sceneRGB = (sceneRGB - 0.5) * slant + 0.5;\n        if ( preserveColor == 1 )\n        {\n            float maxval = max( sceneRGB.r, sceneRGB.g );\n            maxval = max( maxval, sceneRGB.b );\n            if ( maxval > 1.0 )\n            {\n                sceneRGB /= maxval;\n            }\n        }\n        sceneRGB = clamp(sceneRGB,0.0,1.0);\n    }\n    if ( grayscale == 1 ) {\n        sceneRGB.rgb = vec3(luminance_post(sceneRGB.rgb));\n    }\n    return sceneRGB;\n}\nvoid main() {\n    int foundEdge = 0;\n    foundEdge = ( idEdges == 1 && isObjectEdge() == 1 ) ? 1 : 0;\n    if ( foundEdge == 0 && (normalEdges == 1 || depthEdges == 1) ) {\n        foundEdge = isNormalDepthEdge();\n    }\n    vec2 loc = vec2((vUv.x-0.5)*(resolution.y/resolution.x),vUv.y-0.5)*repeats;\n    if ( style > 2 && rotation != 0.0 ) {\n        float rot = 3.14159*rotation;\n        float sinr = sin(rot);\n        float cosr = cos(rot);\n        loc = vec2(loc.x*cosr + -loc.y*sinr, loc.x*sinr + loc.y*cosr);\n    }\n    loc += vec2(0.5,0.5);\n    vec3 color;\n    if ( style == 2 ) {\n        if ( foundEdge == 1 ) {\n            gl_FragColor = vec4(0.0,0.0,0.0,1.0);\n        } else {\n            gl_FragColor = vec4(quantize(colorWithAdjustments()),1.0);\n        }\n    } else if ( style == 3 ) {\n        color = colorWithAdjustments();\n        vec3 graphColor = computeGraphite( color, loc );\n        if ( foundEdge == 1 ) {\n            gl_FragColor = vec4(0.16,0.16,0.16,1.0) + vec4(0.18 * graphColor,0.0);\n        } else {\n            gl_FragColor = vec4(graphColor,1.0);\n        }\n        return;\n    } else if ( style == 4 ) {\n        float fill = texture2D(tFill, loc ).r;\n        float paperStrength = 0.3;\n        vec3 paper = texture2D(tPaper, loc ).rgb;\n        paper = paperStrength * paper + (1.0-paperStrength)*vec3(1.0,1.0,1.0);\n        if ( foundEdge == 1 ) {\n            gl_FragColor = 0.75 * vec4(paper * fill, 1.0);\n        } else {\n            fill = pow(fill,1.6);\n            gl_FragColor = vec4(colorWithAdjustments() * (1.0 - fill) + paper * fill, 1.0);\n        }\n    } else {\n        if ( foundEdge == 1 ) {\n            gl_FragColor = vec4(0.0,0.0,0.0,1.0);\n        } else {\n            gl_FragColor = vec4(colorWithAdjustments(),1.0);\n        }\n        return;        \n    }\n}\n"},67086:e=>{e.exports="uniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\n    gl_FragColor = texture2D(tDiffuse, vUv);\n}\n"},6750:e=>{e.exports="\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#include <cutplanes>\nuniform vec4 color;\n#include <id_decl_frag>\nvoid main() {\n#if NUM_CUTPLANES > 0\n    checkCutPlanes(vWorldPosition);\n#endif\n    gl_FragColor = color;\n#ifdef MRT_NORMALS\noutNormal = vec4(0.0);\n#endif\n#ifdef MRT_ID_BUFFER\n    outId = vec4(0.0);\n    #ifdef MODEL_COLOR\n        outModelId = vec4(0.0);\n    #endif\n#elif defined(ID_COLOR)\n    gl_FragColor = vec4(0.0);\n#elif defined(MODEL_COLOR)\n    gl_FragColor = vec4(0.0);\n#endif\n}"},79282:e=>{e.exports="\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#include <instancing_decl_vert>\nvoid main() {\n    vec3 instPos = getInstancePos(position);\n#if NUM_CUTPLANES > 0\n    vec4 worldPosition = modelMatrix * vec4( instPos, 1.0 );\n    vWorldPosition = worldPosition.xyz;\n#endif\n    vec4 mvPosition = modelViewMatrix * vec4( instPos, 1.0 );\n    vec4 p_Position = projectionMatrix * mvPosition;\n    gl_Position = p_Position;\n}"},49510:e=>{e.exports="#define FXAA_EDGE_SHARPNESS (8.0)\n#define FXAA_EDGE_THRESHOLD (0.125)\n#define FXAA_EDGE_THRESHOLD_MIN (0.05)\n#define FXAA_RCP_FRAME_OPT (0.50)\n#define FXAA_RCP_FRAME_OPT2 (2.0)\nuniform sampler2D tDiffuse;\nuniform highp vec2 uResolution;\nvarying vec2 vPos;\nvarying vec4 vPosPos;\nfloat FxaaLuma(vec3 rgb) {\n    return dot(rgb, vec3(0.299, 0.587, 0.114));\n}\nvoid main() {\n    float lumaNw = FxaaLuma(texture2D(tDiffuse, vPosPos.xy).rgb);\n    float lumaSw = FxaaLuma(texture2D(tDiffuse, vPosPos.xw).rgb);\n    float lumaNe = FxaaLuma(texture2D(tDiffuse, vPosPos.zy).rgb) + 1.0/384.0;\n    float lumaSe = FxaaLuma(texture2D(tDiffuse, vPosPos.zw).rgb);\n    vec4 rgbaM = texture2D(tDiffuse, vPos.xy);    \n    float lumaM = FxaaLuma(rgbaM.rgb);\n    float lumaMax = max(max(lumaNe, lumaSe), max(lumaNw, lumaSw));\n    float lumaMin = min(min(lumaNe, lumaSe), min(lumaNw, lumaSw));\n    float lumaMaxSubMinM = max(lumaMax, lumaM) - min(lumaMin, lumaM);\n    float lumaMaxScaledClamped = max(FXAA_EDGE_THRESHOLD_MIN, lumaMax * FXAA_EDGE_THRESHOLD);\n    if (lumaMaxSubMinM < lumaMaxScaledClamped) {\n        gl_FragColor = rgbaM;\n        return;\n    }\n    float dirSwMinusNe = lumaSw - lumaNe;\n    float dirSeMinusNw = lumaSe - lumaNw;\n    vec2 dir1 = normalize(vec2(dirSwMinusNe + dirSeMinusNw, dirSwMinusNe - dirSeMinusNw));\n    vec3 rgbN1 = texture2D(tDiffuse, vPos.xy - dir1 * FXAA_RCP_FRAME_OPT*uResolution).rgb;\n    vec3 rgbP1 = texture2D(tDiffuse, vPos.xy + dir1 * FXAA_RCP_FRAME_OPT*uResolution).rgb;\n    float dirAbsMinTimesC = min(abs(dir1.x), abs(dir1.y)) * FXAA_EDGE_SHARPNESS;\n    vec2 dir2 = clamp(dir1.xy / dirAbsMinTimesC, -2.0, 2.0);\n    vec3 rgbN2 = texture2D(tDiffuse, vPos.xy - dir2 * FXAA_RCP_FRAME_OPT2*uResolution).rgb;\n    vec3 rgbP2 = texture2D(tDiffuse, vPos.xy + dir2 * FXAA_RCP_FRAME_OPT2*uResolution).rgb;\n    vec3 rgbA = rgbN1 + rgbP1;\n    vec3 rgbB = ((rgbN2 + rgbP2) * 0.25) + (rgbA * 0.25);\n    float lumaB = FxaaLuma(rgbB);\n    float alpha = rgbaM.a;\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        gl_FragColor = vec4(rgbA * 0.5, rgbaM.a);\n    else\n        gl_FragColor = vec4(rgbB, rgbaM.a);\n}\n"},63332:e=>{e.exports="uniform vec2 uResolution;\nvarying vec2 vPos;\nvarying vec4 vPosPos;\nvoid main() {\n    vPos = uv;\n    vPosPos.xy = uv + vec2(-0.5, -0.5) * uResolution;\n    vPosPos.zw = uv + vec2( 0.5,  0.5) * uResolution;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n"},93285:e=>{e.exports="uniform sampler2D tDiffuse;\nuniform vec4 uColor;\nvarying vec2 vUv;\n#ifdef HORIZONTAL\n#define GET_UV(X) vec2(vUv.x + KERNEL_SCALE_H*(X), vUv.y)\n#else\n#define GET_UV(Y) vec2(vUv.x, vUv.y + KERNEL_SCALE_V*(Y))\n#endif\n#define PI 3.14159265358979\n#define SIGMA ((KERNEL_RADIUS+KERNEL_RADIUS+1.0) / 6.0)\n#define SIGMASQ2 (2.0 * SIGMA * SIGMA)\n#define GAUSSIAN(X) ( (1.0 / sqrt(PI * SIGMASQ2)) * exp(-(X)*(X)/SIGMASQ2) )\nvoid main() {\n    vec4 texColSum = vec4(0.0);\n    float gaussSum = 0.0;\n    for (float x=-KERNEL_RADIUS; x<=KERNEL_RADIUS; x+=1.0) {\n        float gauss = GAUSSIAN(x);\n        vec4 texCol = texture2D(tDiffuse, GET_UV(x));\n#ifdef HAS_ALPHA\n        texCol.rgb *= texCol.a;\n#endif\n        texColSum += texCol * gauss;\n        gaussSum += gauss;\n    }\n#ifdef HAS_ALPHA\n    texColSum.rgb /= (texColSum.a == 0.0 ? 0.0001 : texColSum.a);\n#endif\n#ifdef HORIZONTAL\n    gl_FragColor = texColSum/gaussSum;\n#else\n    gl_FragColor = texColSum/gaussSum * uColor;\n#endif\n}\n"},3911:e=>{e.exports="varying vec2 vUv;\nvoid main() {\n#if defined(HORIZONTAL) && defined(FLIP_UV)\n    vUv = vec2(uv.x, 1.0-uv.y);\n#else\n    vUv = vec2(uv.x, uv.y);\n#endif\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},24687:e=>{e.exports="uniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\n    vec4 texel = texture2D( tDiffuse, vUv );\n    gl_FragColor = texel;\n}\n"},24009:e=>{e.exports="#define NUM_SAMPLES 29.0\n#define NUM_SPIRAL_TURNS 7.0\nuniform sampler2D tDepth;\nuniform vec3 worldSize;\nvarying vec2 vUv;\n#ifdef PRESET_2\n#define SAMPLE_RADIUS 0.3\n#define AO_GAMMA 1.0\n#define AO_INTENSITY 1.0\n#else\n#define SAMPLE_RADIUS 0.2\n#define AO_GAMMA 3.0\n#define AO_INTENSITY 0.8\n#endif\n#include <pack_depth>\n#define PI 3.14159265358979\nfloat rand(vec2 co) {\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\nfloat getRandomAngle(vec2 pos) {\n    return rand(pos) * (2.0 * PI);\n}\nvec2 tapLocation(float sampleNumber, float spinAngle, out float ssR){\n    float alpha = float(sampleNumber + 0.5) * (1.0 / NUM_SAMPLES);\n    float angle = alpha * (NUM_SPIRAL_TURNS * PI * 2.0) + spinAngle;\n    ssR = alpha;\n    return vec2(cos(angle), sin(angle));\n}\nvec2 sampleAO(vec2 unitDirection, float radius) {\n    vec2 sampleOffset = unitDirection * radius;\n    float idepth = unpackDepth(texture2D(tDepth, vUv + sampleOffset));\n    float depth = 1.0 - idepth;\n    if (depth < 1e-6) {\n        if (radius == 0.0)\n            return vec2(1.0, 1.0);\n        else\n            return vec2(0.0, 1.0);\n    }\n    vec3 dir = vec3(sampleOffset.x, depth, sampleOffset.y) * worldSize;\n    float distance2 = dot(dir,dir);\n    float idistance = 1.0 / sqrt(distance2);\n    vec3 ndir = dir * idistance;\n#ifdef PRESET_2\n    float importance = ndir.y * idistance;\n#else\n    float importance = ndir.y / distance2;\n#endif\n    vec2 ret;\n    ret.x = (idepth == 0.0) ? 0.0 : importance;\n    ret.y = importance;\n    return ret;\n}\nvoid main() {\n    vec2 sum = vec2(0.0);\n    float angle = getRandomAngle(vUv);\n    for (float i = 0.0; i<NUM_SAMPLES; i+= 1.0) {\n        float ssR;\n        vec2 uv = tapLocation(i, angle, ssR);\n        sum += sampleAO(uv, ssR * SAMPLE_RADIUS);\n    }\n    float ao = sum.x / sum.y;\n    gl_FragColor = packDepth(AO_INTENSITY * clamp(pow(ao, AO_GAMMA), 0.0, 0.9999));\n}\n"},8242:e=>{e.exports="uniform sampler2D tDepth;\nvarying vec2 vUv;\n#ifdef HORIZONTAL\n#define GET_UV(X) vec2(vUv.x + KERNEL_SCALE*(X), vUv.y)\n#else\n#define GET_UV(Y) vec2(vUv.x, vUv.y + KERNEL_SCALE*(Y))\n#endif\n#include <pack_depth>\n#define PI 3.14159265358979\n#define SIGMA ((2.0 * KERNEL_RADIUS+1.0) / 6.0)\n#define SIGMASQ2 (2.0 * SIGMA * SIGMA)\n#ifdef BOX\n#define KERNEL_VAL(X) 1.0\n#else\n#define KERNEL_VAL(X) ( (1.0 / sqrt(PI * SIGMASQ2)) * exp(-(X)*(X)/SIGMASQ2) )\n#endif\nvoid main() {\n    float depthVal = 0.0;\n    float sum = 0.0;\n    for (float x=-KERNEL_RADIUS; x<=KERNEL_RADIUS; x+=1.0) {\n        depthVal += unpackDepth(texture2D(tDepth, GET_UV(x))) * KERNEL_VAL(x);\n        sum += KERNEL_VAL(x);\n    }\n    gl_FragColor = packDepth(depthVal/sum);\n}\n"},14810:e=>{e.exports="uniform sampler2D tDepth;\nuniform vec4 uShadowColor;\nvarying vec2 vUv;\n#include <pack_depth>\nvoid main() {\n    float depthVal = unpackDepth(texture2D(tDepth, vUv));\n    gl_FragColor = vec4(uShadowColor.rgb, uShadowColor.a * depthVal);\n}\n"},57165:e=>{e.exports="#include <pack_depth>\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#include <cutplanes>\nvoid main() {\n#if NUM_CUTPLANES > 0\n    checkCutPlanes(vWorldPosition);\n#endif\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\n    depth = 1.0 - depth;\n    gl_FragColor = packDepth(depth);\n}\n"},40520:e=>{e.exports="#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );;\n#if NUM_CUTPLANES > 0\n    vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n    vWorldPosition = worldPosition.xyz;\n#endif\n}\n"},13518:e=>{e.exports="#include <common>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <id_decl_frag>\n#include <theming_decl_frag>\n#define ENABLE_ID_DISCARD\nuniform float opacity;\nuniform vec4 selectionColor;\n#if NUM_CUTPLANES>0\nvarying highp vec3 vWorldPosition;\n#endif\n#ifdef VIEWPORT_CLIPPING\nuniform highp vec4 viewportBounds;\nvarying vec4 vPosition;\n#endif\n#include <cutplanes>\nvoid main(){\n    #if NUM_CUTPLANES>0\n        checkCutPlanes(vWorldPosition);\n    #endif\n    \n    #ifdef VIEWPORT_CLIPPING\n    \n    if (vPosition.x < viewportBounds.x || vPosition.x > viewportBounds.z || vPosition.y < viewportBounds.y || vPosition.y > viewportBounds.w) {\n        discard;\n    }\n    #endif\n    \n    float depth = 0.;\n    vec3 geomNormal = vec3(0.);\n    vec3 outgoingLight = vec3(0.);\n    vec4 diffuseColor = vec4(opacity);\n    \n    #include <map_fragment>\n    #include <alphamap_fragment>\n    #include <alphatest_fragment>\n    \n    outgoingLight = diffuseColor.rgb;\n    \n    #include <linear_to_gamma_fragment>\n    \n    gl_FragColor = vec4(outgoingLight, diffuseColor.a);\n    float writeId = 1.0;\n    #ifdef GHOSTED \n        writeId = 0.;\n        gl_FragColor.a *= 0.1;\n    #endif\n    \n    #include <theming_frag>\n    gl_FragColor.rgb = mix(gl_FragColor.rgb, selectionColor.rgb, selectionColor.a);\n    #include <final_frag>\n}\n"},34722:e=>{e.exports="#include <common>\n#include <map_pars_vertex>\n#if NUM_CUTPLANES>0\nvarying vec3 vWorldPosition;\n#endif\n#ifdef VIEWPORT_CLIPPING\nuniform mat4 modelLocalMatrix;\nvarying vec4 vPosition;\n#endif\nvoid main(){\n    vUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n    \n    #if NUM_CUTPLANES>0\n        vWorldPosition = (modelMatrix * vec4(position,1.)).xyz;\n    #endif\n    \n    #ifdef VIEWPORT_CLIPPING\n        vPosition = modelLocalMatrix * vec4(position.xy,0.,1.);\n    #endif\n    \n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position.xy,0.,1.);\n}\n"},18350:e=>{e.exports="\r\n\r\n\r\n#include <line_decl_common>\r\n#include <id_decl_frag>\r\n\r\nuniform highp float pixelsPerUnit;\r\nuniform highp float aaRange;\r\n\r\nuniform float opacity;\r\nuniform highp float viewportId;\r\nuniform highp float swap;\r\nuniform highp float grayscale;\r\n\r\n#ifdef HAS_RASTER_QUADS\r\nuniform sampler2D tRaster;\r\n#endif\r\n\r\n#ifdef HAS_LINESTYLES\r\nuniform sampler2D tLineStyle;\r\nuniform vec2 vLineStyleTexSize;\r\n#endif\r\n\r\n#ifdef VIEWPORT_CLIPPING\r\nuniform highp vec4 viewportBounds;\r\nvarying highp vec2 vPosition;\r\n#endif\r\n\r\n#ifdef IMAGE_UV_TEXTURE\r\nvarying highp vec2 vuv;\r\nuniform sampler2D tRaster;\r\n#endif\r\n\r\n\r\nfloat curveGaussian(float r, float invWidth) {\r\n    float amt = clamp(r * invWidth, 0.0, 1.0);\r\n\r\n    float exponent = amt * 2.0;\r\n\r\n    return exp(-exponent*exponent);\r\n\r\n\r\n\r\n}\r\n\r\n#ifdef HAS_LINESTYLES\r\nfloat getLinePatternPixel(int i, int j) {\r\n\r\n    return texture2D(tLineStyle, (vec2(i, j) + 0.5) / vLineStyleTexSize).x * 255.0;\r\n}\r\n\r\nfloat getPatternLength(int whichPattern) {\r\n    float p1 = getLinePatternPixel(0, whichPattern);\r\n    float p2 = getLinePatternPixel(1, whichPattern);\r\n    return (p2 * 256.0 + p1);\r\n}\r\n#endif\r\n\r\n\r\nvoid fillLineSegment() {\r\n\r\n    float radius = abs(fsHalfWidth);\r\n    float parametricDistance = fsMultipurpose.x;\r\n    float segmentLength      = fsMultipurpose.y;\r\n    float totalDistance      = fsMultipurpose.z;\r\n\r\n#ifdef LOADING_ANIMATION\r\n    float distFromStart = parametricDistance / segmentLength;\r\n    if (loadingProgress < 1.0 && distFromStart > loadingProgress) {\r\n        discard;\r\n    }\r\n#endif\r\n\r\n\r\n#ifdef HAS_LINESTYLES\r\n    int whichPattern         = int(fsMultipurpose.w);\r\n\r\n    if (whichPattern > 0) {\r\n        const float TEX_TO_UNIT = 1.0 / 96.0;\r\n\r\n        float patternScale;\r\n\r\n\r\n\r\n        if (fsHalfWidth < 0.0) {\r\n            patternScale = LTSCALE;\r\n        } else {\r\n            patternScale = LTSCALE * TEX_TO_UNIT * pixelsPerUnit;\r\n        }\r\n\r\n        float patLen = patternScale * getPatternLength(whichPattern);\r\n        float phase = mod((totalDistance + parametricDistance) * pixelsPerUnit, patLen);\r\n\r\n        bool onPixel = true;\r\n        float radiusPixels = radius * pixelsPerUnit;\r\n\r\n        for (int i=2; i<MAX_LINESTYLE_LENGTH; i+=2) {\r\n\r\n            float on = getLinePatternPixel(i, whichPattern);\r\n            if (on == 1.0) on = 0.0;\r\n            on *= patternScale;\r\n\r\n            onPixel = true;\r\n            phase -= on;\r\n            if (phase < 0.0) {\r\n                break;\r\n            }\r\n            else if (phase <= radiusPixels) {\r\n                onPixel = false;\r\n                break;\r\n            }\r\n\r\n            float off = getLinePatternPixel(i+1, whichPattern);\r\n            if (off <= 1.0) off = 0.0;\r\n            off *= patternScale;\r\n\r\n            onPixel = false;\r\n            phase -= off;\r\n            if (phase < -radiusPixels)\r\n                discard;\r\n            if (phase <= 0.0)\r\n                break;\r\n        }\r\n\r\n\r\n\r\n\r\n        if (!onPixel && (abs(phase) <= radiusPixels)) {\r\n            segmentLength = 0.0;\r\n            parametricDistance = phase / pixelsPerUnit;\r\n        }\r\n    }\r\n#endif\r\n\r\n\r\n\r\n\r\n    float dist;\r\n    float offsetLength2 = dot(fsOffsetDirection, fsOffsetDirection);\r\n\r\n\r\n\r\n\r\n    float ltz = max(0.0, sign(-parametricDistance));\r\n    float gtsl = max(0.0, sign(parametricDistance - segmentLength));\r\n    float d = (ltz + gtsl) * (parametricDistance - gtsl * segmentLength);\r\n    dist = sqrt(max(0.0, offsetLength2 + d*d));\r\n\r\n\r\n\r\n\r\n    float range =  dist - radius;\r\n\r\n    if (range > aaRange) {\r\n        discard;\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n    gl_FragColor = fsColor;\r\n    gl_FragColor.a *= curveGaussian(range+aaRange, pixelsPerUnit);\r\n}\r\n\r\n#ifdef HAS_CIRCLES\r\nvoid fillCircularArc() {\r\n\r\n    float dist   = length(fsOffsetDirection);\r\n    vec2 angles  = fsMultipurpose.xz;\r\n    float radius = abs(fsMultipurpose.y);\r\n    float range  =  abs(dist - radius);\r\n    range -= fsHalfWidth;\r\n\r\n\r\n\r\n    if (range > aaRange) {\r\n        discard;\r\n    }\r\n\r\n    vec2 direction = fsOffsetDirection;\r\n    float angle = atan(direction.y, direction.x);\r\n\r\n\r\n\r\n\r\n    if (angles.x > angles.y) {\r\n\r\n        if (angle > angles.x && angle < PI) {\r\n                angle -= TAU;\r\n        }\r\n        angles.x -= TAU;\r\n\r\n\r\n\r\n        if (angle < angles.x ) {\r\n            angle += TAU;\r\n        }\r\n    }\r\n    else if (angle < 0.0)\r\n        angle += TAU;\r\n\r\n#ifdef LOADING_ANIMATION\r\n    if ((angle - angles.x) / (angles.y - angles.x) > loadingProgress) {\r\n        discard;\r\n    }\r\n#endif\r\n\r\n\r\n    if (angle > angles.x && angle < angles.y) {\r\n        gl_FragColor = fsColor;\r\n        gl_FragColor.a *= curveGaussian(range+aaRange, pixelsPerUnit);\r\n    }\r\n    else {\r\n        discard;\r\n    }\r\n\r\n}\r\n#endif\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n#ifdef HAS_ELLIPTICALS\r\n\r\n\r\n\r\n\r\n\r\n\r\nfloat EllipticalApprox(\r\n        const int iters,\r\n        inout float t0, inout float t1,\r\n        const vec2 y,   out   vec2 x,\r\n        const vec2 e,   const vec2 ey, const vec2 esqr\r\n        ) {\r\n    vec2 r;\r\n    for (int i = 0; i < 10; ++i) {\r\n        if(i >= iters) break;\r\n\r\n        float t = mix(t0, t1, 0.5);\r\n        r = ey / (vec2(t) + esqr);\r\n\r\n        vec2 rsq = r * r;\r\n        float f = rsq.x + rsq.y - 1.0;\r\n\r\n        if(f > 0.0) { t0 = t; } else { t1 = t; }\r\n    }\r\n\r\n    x = e * r;\r\n    return distance(x, y);\r\n}\r\n\r\nfloat DistancePointEllipseSpecial (vec2 e, vec2 y, out vec2 x, float width, float aaRange) {\r\n    float dist;\r\n\r\n\r\n    vec2 esqr = e * e;\r\n    vec2 ey   = e * y;\r\n    float t0 = -esqr[1] + ey[1];\r\n    float t1 = -esqr[1] + length(ey);\r\n\r\n\r\n\r\n    dist = EllipticalApprox(6, t0, t1, y, x, e, ey, esqr);\r\n\r\n\r\n    if (dist > max(2.0 * (width + aaRange), e[0] * 0.05))\r\n        return dist;\r\n\r\n\r\n    dist = EllipticalApprox(6, t0, t1, y, x, e, ey, esqr);\r\n\r\n\r\n\r\n\r\n    float ecc = 1.0 +  0.1 * e[0] / e[1];\r\n\r\n    if (dist > max(ecc * (width + aaRange), e[0] * 0.001))\r\n        return dist;\r\n    if (dist < (width - aaRange) / ecc)\r\n        return dist;\r\n\r\n\r\n\r\n\r\n    dist = EllipticalApprox(10, t0, t1, y, x, e, ey, esqr);\r\n    return dist;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\nfloat DistancePointEllipse(vec2 e, vec2 y, out vec2 locX, float width, float aaRange) {\r\n    vec2 locE, locY;\r\n\r\n\r\n\r\n\r\n    float diff = sign(e[0] - e[1]);\r\n    vec2 swizzle = vec2(max(diff, 0.0), -min(diff, 0.0));\r\n    locE.x = dot(e, swizzle.xy);\r\n    locE.y = dot(e, swizzle.yx);\r\n    locY.x = dot(y, swizzle.xy);\r\n    locY.y = dot(y, swizzle.yx);\r\n\r\n\r\n    vec2 refl = sign(locY);\r\n    locY *= refl;\r\n\r\n    vec2 x;\r\n    float distance = DistancePointEllipseSpecial(locE, locY, x, width, aaRange);\r\n\r\n    x *= refl;\r\n\r\n    locX.x = dot(x, swizzle.xy);\r\n    locX.y = dot(x, swizzle.yx);\r\n\r\n    return distance;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\nvoid fillEllipticalArc() {\r\n    vec2 angles = fsMultipurpose.xz;\r\n    vec2 radii  = abs(fsMultipurpose.yw);\r\n    vec2 dir    = fsOffsetDirection;\r\n\r\n\r\n\r\n\r\n    vec2 pos;\r\n    float range = DistancePointEllipse(radii, dir, pos, fsHalfWidth, aaRange);\r\n    range -= fsHalfWidth;\r\n\r\n    if (range > aaRange)\r\n        discard;\r\n\r\n    float ar = radii[0] / radii[1];\r\n\r\n\r\n\r\n\r\n    float angle = atan(ar * pos.y, pos.x);\r\n\r\n\r\n\r\n\r\n    if (angles.x > angles.y) {\r\n\r\n        if (angle > angles.x && angle < PI) {\r\n            angle -= TAU;\r\n        }\r\n        angles.x -= TAU;\r\n\r\n\r\n\r\n        if (angle < angles.x ) {\r\n            angle += TAU;\r\n        }\r\n    }\r\n    else if (angle < 0.0)\r\n        angle += TAU;\r\n\r\n#ifdef LOADING_ANIMATION\r\n    if ((angle - angles.x) / (angles.y - angles.x) > loadingProgress) {\r\n        discard;\r\n    }\r\n#endif\r\n\r\n\r\n    if (angle > angles.x && angle < angles.y) {\r\n        gl_FragColor = fsColor;\r\n        gl_FragColor.a *= curveGaussian(range+aaRange, pixelsPerUnit);\r\n    }\r\n    else {\r\n        discard;\r\n    }\r\n}\r\n#endif\r\n\r\n#ifdef HAS_RASTER_QUADS\r\n    void fillTexQuad() {\r\n        gl_FragColor = texture2D(tRaster, fsMultipurpose.xy);\r\n        #ifdef LOADING_ANIMATION\r\n            gl_FragColor.a *= loadingProgress;\r\n        #endif\r\n    }\r\n#endif\r\n\r\nvoid fillTriangle() {\r\n#ifdef IMAGE_UV_TEXTURE\r\n    gl_FragColor = texture2D(tRaster, fract(vuv));\r\n#else\r\n    gl_FragColor = fsColor;\r\n#endif\r\n\r\n#ifdef LOADING_ANIMATION\r\n    gl_FragColor.a *= loadingProgress;\r\n#endif\r\n}\r\n\r\n#if NUM_CUTPLANES > 0\r\nvarying highp vec3 vWorldPosition;\r\n#endif\r\n\r\n#ifdef MSDF_TEXTURE_FONT\r\nvarying highp vec2 vuv;\r\nvarying float isMSDFQuards;\r\nuniform sampler2D tRaster;\r\nfloat median(float r, float g, float b) {\r\n  return max(min(r, g), min(max(r, g), b));\r\n}\r\n\r\n#endif\r\n\r\n#include <cutplanes>\r\n\r\nvoid main() {\r\n\r\n\r\n\r\n\r\n\r\n    if (fsColor == vec4(0.0)) {\r\n        discard;\r\n    }\r\n\r\n\r\n#ifdef VIEWPORT_CLIPPING\r\n    if(vPosition.x < viewportBounds.x || vPosition.x > viewportBounds.z || vPosition.y < viewportBounds.y || vPosition.y > viewportBounds.w) {\r\n        discard;\r\n    }\r\n#endif\r\n\r\n#ifdef MSDF_TEXTURE_FONT\r\n    vec4 msdfColor = texture2D(tRaster, vuv);\r\n    float dist = median(msdfColor.r, msdfColor.g, msdfColor.b);\r\n\r\n\r\n    float delta = mix(0.25, 0.5, 1.0 - fwidth(dist));\r\n\r\n    float sigDist = dist - delta;\r\n    float msdfAlpha = clamp(sigDist/fwidth(sigDist) + delta, 0.0, 1.0);\r\n\r\n    msdfAlpha = smoothstep(0., 1., msdfAlpha);\r\n    gl_FragColor.a =  mix(msdfAlpha, 1., 1.-isMSDFQuards);\r\n    if (gl_FragColor.a < 0.0001) discard;\r\n\r\n#endif\r\n\r\n\r\n    if (fsHalfWidth == 0.0) {\r\n#ifdef HAS_RASTER_QUADS\r\n        if (fsMultipurpose.z != 0.0)\r\n            fillTexQuad();\r\n        else\r\n#endif\r\n            fillTriangle();\r\n    }\r\n    else if (fsMultipurpose.y < 0.0) {\r\n#ifdef HAS_CIRCLES\r\n#ifdef HAS_ELLIPTICALS\r\n        if (abs(fsMultipurpose.y) == fsMultipurpose.w)\r\n#endif\r\n            fillCircularArc();\r\n#endif\r\n#ifdef HAS_ELLIPTICALS\r\n#ifdef HAS_CIRCLES\r\n        else\r\n#endif\r\n            fillEllipticalArc();\r\n#endif\r\n    }\r\n    else\r\n        fillLineSegment();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    float writeId = 1.0;\r\n    \r\n    gl_FragColor.a *= opacity;\r\n\r\n    if (gl_FragColor.a == 0.0) {\r\n        discard;\r\n    }\r\n\r\n\r\n\r\n\r\n    if (fsGhosting != 0.0 || \r\n            ((viewportId != 0.0) && (abs(fsVpTC.x * 255.0 + fsVpTC.y) >= 0.5 && abs(fsVpTC.x * 255.0 + fsVpTC.y - viewportId) >= 0.5))) {\r\n\r\n        writeId = 0.0;\r\n\r\n\r\n\r\n        gl_FragColor.a *= ((swap == 1.0) ? 0.21 : 0.1);\r\n    }\r\n\r\n#ifndef SELECTION_RENDERER\r\n\r\n    if (grayscale != 0.0) {\r\n        const vec3 rgb2grey = vec3(0.299, 0.587, 0.114);\r\n        float gray = dot(gl_FragColor.rgb, rgb2grey);\r\n        gl_FragColor.rgb = vec3(gray);\r\n    }\r\n#endif\r\n\r\n#if NUM_CUTPLANES > 0\r\n    checkCutPlanes(vWorldPosition);\r\n#endif\r\n\r\n#ifdef MRT_NORMALS\r\n\r\n    outNormal = vec4(0.0, 0.0, 0.0, 1.0);\r\n#endif\r\n\r\n#ifdef NO_ID_OUTPUT\r\n\r\n    writeId = 0.0;\r\n#endif\r\n\r\n#include <id_frag>\r\n}\r\n"},71519:e=>{e.exports="\r\n\r\n#include <line_decl_common>\r\n\r\nattribute vec2 fields1;\r\nattribute vec4 fields2;\r\nattribute vec4 flags4b;\r\nattribute vec4 layerVp4b;\r\n\r\n#ifdef HAS_ELLIPTICALS\r\nattribute vec3 extraParams;\r\n#endif\r\n\r\n#ifdef USE_INSTANCING\r\nattribute vec4 instFlags4b;\r\n#endif\r\n\r\n#ifdef MSDF_TEXTURE_FONT\r\nvarying highp vec2 vuv;\r\nvarying float isMSDFQuards;\r\n#endif\r\n\r\n#ifdef IMAGE_UV_TEXTURE\r\nvarying highp vec2 vuv;\r\n#endif\r\n\r\n#ifdef VIEWPORT_CLIPPING\r\nvarying vec2 vPosition;\r\n#endif\r\n\r\nuniform mat4 mvpMatrix;\r\n\r\nuniform float pixelsPerUnit;\r\nuniform float aaRange;\r\nuniform float viewportId;\r\nuniform float swap;\r\n\r\n\r\n\r\n\r\n\r\n#ifdef HAS_LAYERS\r\nuniform sampler2D tLayerMask;\r\n#endif\r\n\r\n#ifdef SELECTION_RENDERER\r\nuniform sampler2D tSelectionTexture;\r\nuniform vec2 vSelTexSize;\r\n#endif\r\n\r\n#ifdef SELECTION_RENDERER\r\nuniform vec4 selectionColor;\r\n#endif\r\n\r\n#ifdef LOADING_ANIMATION\r\nuniform float meshAnimTime;\r\n#endif\r\n\r\n#if NUM_CUTPLANES > 0\r\nvarying vec3 vWorldPosition;\r\n#endif\r\n\r\nvarying vec4 dbId;\r\n\r\n#ifdef UNPACK_POSITIONS\r\nuniform sampler2D tIdColor;\r\nuniform vec2 vIdColorTexSize;\r\nuniform vec4 unpackXform;\r\nattribute vec2 uvIdColor;\r\nfloat unpackLineWeight(float w) {\r\n    if (w > 0.5) {\r\n        return - (w - 0.5) * 1024.0;\r\n    } else {\r\n        return w * max(unpackXform.x, unpackXform.y) * 2.0;\r\n    }\r\n}\r\nvec4 getVertexColor() {\r\n    float u = (uvIdColor.x + 0.5) / vIdColorTexSize.x;\r\n    return texture2D(tIdColor, vec2(u, 0.5));\r\n}\r\nvec4 getDbId() {\r\n    float u = (uvIdColor.y + 0.5) / vIdColorTexSize.x;\r\n    vec4 normDbId = texture2D(tIdColor, vec2(u, 0.5));\r\n    return normDbId * 255.0;\r\n}\r\n#else\r\nattribute vec4 color4b;\r\nattribute vec4 dbId4b;\r\nvec4 unpackXform;\r\nfloat unpackLineWeight(float w) {\r\n    return w;\r\n}\r\nvec4 getVertexColor() {\r\n    return color4b;\r\n}\r\nvec4 getDbId() {\r\n    return dbId4b;\r\n}\r\n#endif\r\n\r\n\r\nvec2 centralVertex;\r\nvec2 offsetPosition;\r\n\r\nvec2 cos_sin(const float angle) { return vec2(cos(angle), sin(angle)); }\r\n\r\nvoid min_max(inout vec2 minPt, inout vec2 maxPt, const vec2 p) {\r\n    minPt = min(minPt, p);\r\n    maxPt = max(maxPt, p);\r\n}\r\n\r\n#if defined(USE_INSTANCING)\r\nfloat getVertexId() { return instFlags4b.x; }\r\n#else\r\nfloat getVertexId() { return flags4b.x; }\r\n#endif\r\n\r\nbool isStartVertex() { return (getVertexId() < VBB_SEG_END_RIGHT); }\r\nbool isLeftVertex()  { float id = getVertexId(); return ((id == VBB_SEG_END_LEFT || id == VBB_SEG_START_LEFT)); }\r\n\r\nstruct SegmentData { float angle, distAlong, distTotal, lineWidthHalf, lineType; };\r\nvoid decodeSegmentData(out SegmentData seg) {\r\n    seg.angle         = fields2.x * TAU - PI;\r\n    seg.distAlong     = fields2.y * max(unpackXform.x, unpackXform.y);\r\n    seg.distTotal     = fields2.w;\r\n    seg.lineWidthHalf = unpackLineWeight(fields2.z);\r\n    seg.lineType      = flags4b.z;\r\n}\r\n\r\nvoid strokeLineSegment() {\r\n    SegmentData seg; decodeSegmentData(seg);\r\n\r\n    float isStartCapVertex = isStartVertex() ? -1.0 :  1.0;\r\n    float isLeftSide       = isLeftVertex( ) ?  1.0 : -1.0;\r\n\r\n\r\n    float angleTransverse = seg.angle + isLeftSide * HALF_PI;\r\n    float lwAdjustment = fsHalfWidth + aaRange;\r\n    vec2 transverseOffset = cos_sin(angleTransverse) * lwAdjustment;\r\n    offsetPosition.xy += transverseOffset;\r\n\r\n\r\n\r\n\r\n    float distanceFromStart = max(isStartCapVertex, 0.0) * seg.distAlong;\r\n    vec2 along = distanceFromStart * cos_sin(seg.angle);\r\n    offsetPosition.xy += along;\r\n    centralVertex.xy  += along;\r\n\r\n\r\n    vec2 moveOffset = isStartCapVertex * isLeftSide * vec2(-transverseOffset.y, transverseOffset.x);\r\n    offsetPosition.xy -= moveOffset;\r\n    centralVertex.xy  -= moveOffset;\r\n\r\n\r\n\r\n\r\n    fsMultipurpose.x = (isStartCapVertex * lwAdjustment) + distanceFromStart;\r\n    fsMultipurpose.y = seg.distAlong;\r\n    fsMultipurpose.z = seg.distTotal;\r\n    fsMultipurpose.w = seg.lineType;\r\n\r\n    if (seg.lineWidthHalf < 0.0)\r\n        fsHalfWidth = -fsHalfWidth;\r\n}\r\n\r\n\r\n#ifdef HAS_TRIANGLE_GEOMS\r\nstruct TriangleData { vec2 p0, p1, p2; };\r\nvoid decodeTriangleData(out TriangleData tri) {\r\n\r\n    tri.p1 = vec2(fields2.x, fields2.y) * unpackXform.xy + unpackXform.zw;\r\n    tri.p2 = fields2.zw * unpackXform.xy + unpackXform.zw;\r\n}\r\n\r\nvoid strokeOneTriangle() {\r\n    TriangleData tri; decodeTriangleData(tri);\r\n\r\n\r\n\r\n\r\n\r\n\r\n    fsHalfWidth = 0.0;\r\n    fsMultipurpose.z = 0.0;\r\n\r\n\r\n\r\n\r\n\r\n    float vertexId = getVertexId();\r\n    if (vertexId == VBB_SEG_END_RIGHT)\r\n        offsetPosition.xy = tri.p1;\r\n    else if (vertexId == VBB_SEG_END_LEFT)\r\n        offsetPosition.xy = tri.p2;\r\n}\r\n#endif\r\n\r\n\r\n\r\n\r\n#ifdef HAS_RASTER_QUADS\r\nstruct TexQuadData { float angle; vec2 size; };\r\nvoid decodeTexQuadData(out TexQuadData quad) {\r\n    quad.angle     = fields2.x * TAU;\r\n    quad.size   = fields2.yz * max(unpackXform.x, unpackXform.y);\r\n}\r\n\r\nvoid strokeTexQuad() {\r\n    TexQuadData quad; decodeTexQuadData(quad);\r\n\r\n    vec2 corner = vec2(isLeftVertex() ? -1.0 : 1.0, isStartVertex() ? -1.0 : 1.0);\r\n\r\n    vec2 p      = 0.5 * corner * quad.size;\r\n    vec2 rot    = cos_sin(quad.angle);\r\n    vec2 offset = vec2(p.x * rot.x - p.y * rot.y, p.x * rot.y + p.y * rot.x);\r\n\r\n    offsetPosition.xy += offset;\r\n\r\n    fsMultipurpose.xy = max(vec2(0.0), corner);\r\n\r\n\r\n    fsMultipurpose.z = 1.0;\r\n    fsHalfWidth = 0.0;\r\n}\r\n#endif\r\n\r\n#if defined(HAS_CIRCLES) || defined(HAS_ELLIPTICALS)\r\nstruct ArcData { vec2 c; float start, end, major, minor, tilt; };\r\nvoid decodeArcData(out ArcData arc) {\r\n    arc.c     = fields1.xy * unpackXform.xy + unpackXform.zw;\r\n    arc.start = fields2.x * TAU;\r\n    arc.end   = fields2.y * TAU;\r\n    arc.major = fields2.w * max(unpackXform.x, unpackXform.y);\r\n#if defined(HAS_ELLIPTICALS)\r\n    arc.minor = extraParams.x;\r\n    arc.tilt  = extraParams.y * TAU;\r\n#endif\r\n}\r\n\r\nvoid strokeArc(const ArcData arc) {\r\n\r\n\r\n    float isStart = isStartVertex() ? -1.0 : 1.0;\r\n    float isLeft  = isLeftVertex()  ? -1.0 : 1.0;\r\n\r\n\r\n\r\n\r\n    vec2 minPt;\r\n    vec2 maxPt;\r\n\r\n    vec2 angles = vec2(arc.start, arc.end);\r\n    vec2 endsX = vec2(arc.c.x) + arc.major * cos(angles);\r\n    vec2 endsY = vec2(arc.c.y) + arc.minor * sin(angles);\r\n    minPt = maxPt = vec2(endsX.x, endsY.x);\r\n    min_max(minPt, maxPt, vec2(endsX.y, endsY.y));\r\n\r\n    if (arc.end > arc.start) {\r\n        if (arc.start < PI_0_5 && arc.end > PI_0_5) {\r\n            min_max(minPt, maxPt, vec2(arc.c.x, arc.c.y + arc.minor));\r\n        }\r\n        if (arc.start < PI && arc.end > PI) {\r\n            min_max(minPt, maxPt, vec2(arc.c.x - arc.major, arc.c.y));\r\n        }\r\n        if (arc.start < PI_1_5 && arc.end > PI_1_5) {\r\n            min_max(minPt, maxPt, vec2(arc.c.x, arc.c.y - arc.minor));\r\n        }\r\n    } else {\r\n\r\n        min_max(minPt, maxPt, vec2(arc.c.x + arc.major, arc.c.y));\r\n\r\n\r\n\r\n        if (arc.start < PI_0_5 || arc.end > PI_0_5) {\r\n            min_max(minPt, maxPt, vec2(arc.c.x, arc.c.y + arc.minor));\r\n        }\r\n        if (arc.start < PI || arc.end > PI) {\r\n            min_max(minPt, maxPt, vec2(arc.c.x - arc.major, arc.c.y));\r\n        }\r\n        if (arc.start < PI_1_5 || arc.end > PI_1_5) {\r\n            min_max(minPt, maxPt, vec2(arc.c.x, arc.c.y - arc.minor));\r\n        }\r\n    }\r\n\r\n    minPt -= fsHalfWidth + aaRange;\r\n    maxPt += fsHalfWidth + aaRange;\r\n\r\n    offsetPosition.x = (isStart < 0.0) ? minPt.x : maxPt.x;\r\n    offsetPosition.y = (isLeft < 0.0)  ? minPt.y : maxPt.y;\r\n\r\n\r\n\r\n\r\n\r\n    fsMultipurpose.x = arc.start;\r\n    fsMultipurpose.y = -arc.major;\r\n    fsMultipurpose.z = arc.end;\r\n    fsMultipurpose.w = arc.minor;\r\n}\r\n#endif\r\n\r\n#if defined(HAS_CIRCLES)\r\n\r\nvoid strokeCircularArc() {\r\n    ArcData arc; decodeArcData(arc);\r\n\r\n    float r = arc.major;\r\n    if (r * pixelsPerUnit < 0.125)\r\n        r = 0.25 * aaRange;\r\n    arc.major = arc.minor = r;\r\n\r\n    strokeArc(arc);\r\n}\r\n\r\n#endif\r\n\r\n#if defined(HAS_ELLIPTICALS)\r\nvoid strokeEllipticalArc() {\r\n    ArcData arc; decodeArcData(arc);\r\n    strokeArc(arc);\r\n}\r\n#endif\r\n\r\nstruct CommonAttribs { vec2 pos; vec4 color; vec2 layerTC, vpTC; float lineWidthHalf, geomType, ghosting; };\r\nvoid decodeCommonAttribs(out CommonAttribs attribs) {\r\n    attribs.pos           = fields1.xy * unpackXform.xy + unpackXform.zw;\r\n    attribs.color         = getVertexColor();\r\n    attribs.geomType      = flags4b.y;\r\n    attribs.layerTC       = layerVp4b.xy / 255.0;\r\n    attribs.vpTC          = layerVp4b.zw / 255.0;\r\n    attribs.lineWidthHalf = unpackLineWeight(fields2.z);\r\n    attribs.ghosting      = flags4b.w;\r\n}\r\n\r\nvoid strokeIndexedTriangle() {\r\n\r\n    fsHalfWidth = 0.0;\r\n    fsMultipurpose.z = 0.0;\r\n}\r\n\r\n#ifdef SELECTION_RENDERER\r\nbool isSelected(const CommonAttribs attribs) {\r\n\r\n\r\n    vec3 oid = getDbId().rgb;\r\n\r\n\r\n    float id01 = oid.r + oid.g * 256.0;\r\n    float t = (id01 + 0.5) * (1.0 / 4096.0);\r\n    float flrt = floor(t);\r\n    float texU = t - flrt;\r\n\r\n\r\n    float id23 = oid.b * (65536.0 / 4096.0) + flrt;\r\n    t = (id23 + 0.5) / vSelTexSize.y;\r\n    float texV = fract(t);\r\n\r\n    vec4 selBit = texture2D(tSelectionTexture, vec2(texU, texV));\r\n    return selBit.r == 1.0;\r\n}\r\n#endif\r\n\r\nbool isLayerOff(const CommonAttribs attribs) {\r\n#ifdef HAS_LAYERS\r\n    vec4 layerBit = texture2D(tLayerMask, attribs.layerTC);\r\n    return (layerBit.r == 0.0);\r\n#else\r\n    return false;\r\n#endif\r\n}\r\n\r\nvec4 getColor(const CommonAttribs attribs) {\r\n\r\n    if (isLayerOff(attribs)) { return vec4(0.0); }\r\n\r\n#ifdef SELECTION_RENDERER\r\n    if (isSelected(attribs)) { return selectionColor; }\r\n    return vec4(0.0);\r\n#else\r\n    return attribs.color;\r\n#endif\r\n}\r\n\r\n#ifdef GAMMA_INPUT\r\nvec4 inputToLinear(vec4 c) {\r\n    return vec4(vec3(c*c), c.a);\r\n}\r\n#endif\r\n\r\nvoid main() {\r\n#ifndef UNPACK_POSITIONS\r\n    unpackXform = vec4(1.0, 1.0, 0.0, 0.0);\r\n#endif\r\n\r\n    CommonAttribs attribs; decodeCommonAttribs(attribs);\r\n#ifdef MSDF_TEXTURE_FONT\r\n    vuv = fields2.xy;\r\n    isMSDFQuards = 1.0 - abs(sign(attribs.geomType - VBB_GT_MSDF_TRIANGLE_INDEXED));\r\n#endif\r\n\r\n#ifdef IMAGE_UV_TEXTURE\r\n    vuv = fields2.xy;\r\n#endif\r\n\r\n    fsColor = getColor(attribs);\r\n\r\n    #ifdef GAMMA_INPUT\r\n    fsColor = inputToLinear(fsColor);\r\n    #endif\r\n\r\n\r\n    if (swap != 0.0 ) {\r\n\r\n        if ( fsColor.r == 0.0 && fsColor.g == 0.0 && fsColor.b == 0.0 )\r\n            fsColor.rgb = vec3(1.0,1.0,1.0);\r\n\r\n        else if ( fsColor.r == 1.0 && fsColor.g == 1.0 && fsColor.b == 1.0 )\r\n            fsColor.rgb = vec3(0.0,0.0,0.0);\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    centralVertex = offsetPosition = attribs.pos;\r\n\r\n    float lineWeight = attribs.lineWidthHalf;\r\n    if (lineWeight > 0.0) {\r\n\r\n\r\n        if(lineWeight < 0.5 / pixelsPerUnit) {\r\n            lineWeight = 0.5 / pixelsPerUnit;\r\n        }\r\n    }\r\n    else {\r\n\r\n\r\n        lineWeight = abs(lineWeight) / pixelsPerUnit;\r\n    }\r\n\r\n    fsHalfWidth = lineWeight;\r\n\r\n    dbId = getDbId() / 255.0;\r\n\r\n    fsVpTC     = attribs.vpTC;\r\n    fsGhosting = attribs.ghosting;\r\n\r\n    if      (attribs.geomType == VBB_GT_LINE_SEGMENT)     strokeLineSegment();\r\n#ifdef HAS_CIRCLES\r\n    else if (attribs.geomType == VBB_GT_ARC_CIRCULAR)     strokeCircularArc();\r\n#endif\r\n#ifdef HAS_ELLIPTICALS\r\n    else if (attribs.geomType == VBB_GT_ARC_ELLIPTICAL)   strokeEllipticalArc();\r\n#endif\r\n#ifdef HAS_RASTER_QUADS\r\n    else if (attribs.geomType == VBB_GT_TEX_QUAD)         strokeTexQuad();\r\n#endif\r\n#ifdef HAS_TRIANGLE_GEOMS\r\n    else if (attribs.geomType == VBB_GT_ONE_TRIANGLE)     strokeOneTriangle();\r\n#endif\r\n    else if (attribs.geomType == VBB_GT_TRIANGLE_INDEXED) strokeIndexedTriangle();\r\n\r\n\r\n\r\n    fsOffsetDirection = offsetPosition - centralVertex;\r\n\r\n\r\n    gl_Position = mvpMatrix * modelMatrix * vec4( offsetPosition.xy, 0.0, 1.0 );\r\n\r\n#ifdef LOADING_ANIMATION\r\n\r\n    if (dbId.rgb == vec3(1.0)) {\r\n        loadingProgress = 1.0;\r\n    } else {\r\n        loadingProgress = smoothstep(0.0, 1.0, meshAnimTime);\r\n    }\r\n#endif\r\n\r\n#ifdef IMAGE_UV_TEXTURE\r\n    fsHalfWidth = 0.0;\r\n#endif\r\n\r\n\r\n#if NUM_CUTPLANES > 0\r\n    vec4 worldPosition = modelMatrix * vec4( offsetPosition.xy, 0.0, 1.0 );\r\n    vWorldPosition = worldPosition.xyz;\r\n#endif\r\n\r\n#ifdef VIEWPORT_CLIPPING\r\n    vPosition = offsetPosition.xy;\r\n#endif\r\n}\r\n"},59191:e=>{e.exports="\n#include <line_decl_common>\n#include <id_decl_frag>\nuniform highp float pixelsPerUnit;\nuniform highp float aaRange;\nuniform float opacity;\nuniform highp float viewportId;\nuniform highp float swap;\nuniform highp float grayscale;\n#ifdef HAS_LINESTYLES\nuniform sampler2D tLineStyle;\nuniform vec2 vLineStyleTexSize;\n#endif\n#ifdef VIEWPORT_CLIPPING\nuniform highp vec4 viewportBounds;\nvarying highp vec2 vPosition;\nuniform mat4 mvpMatrix;\nuniform mat4 modelMatrix;\n#endif\nfloat curveGaussian(float r, float width) {\n    float amt = clamp(abs(r / (width * 1.0)), 0.0, 1.0);\n    amt = max(amt - 0.0, 0.0);\n    float exponent = amt * 2.0;\n    return clamp(exp(-exponent*exponent), 0.0, 1.0);\n}\n#ifdef HAS_LINESTYLES\nfloat getLinePatternPixel(int i, int j) {\n    return texture2D(tLineStyle, (vec2(i, j) + 0.5) / vLineStyleTexSize).x * 255.0;\n}\nfloat getPatternLength(int whichPattern) {\n    float p1 = getLinePatternPixel(0, whichPattern);\n    float p2 = getLinePatternPixel(1, whichPattern);\n    return (p2 * 256.0 + p1);\n}\n#endif\nvoid fillLineSegment() {\n    float radius = abs(fsHalfWidth);\n    float parametricDistance = fsMultipurpose.x;\n    float segmentLength      = fsMultipurpose.y;\n    float totalDistance      = fsMultipurpose.z;\n#ifdef LOADING_ANIMATION\n    float distFromStart = parametricDistance / segmentLength;\n    if (loadingProgress < 1.0 && distFromStart > loadingProgress) {\n        discard;\n    }\n#endif\n#ifdef HAS_LINESTYLES\n    int whichPattern         = int(fsMultipurpose.w);\n    if (whichPattern > 0) {\n        const float TEX_TO_UNIT = 1.0 / 96.0;\n        float patternScale;\n        if (fsHalfWidth < 0.0) {\n            patternScale = LTSCALE;\n        } else {\n            patternScale = LTSCALE * TEX_TO_UNIT * pixelsPerUnit;\n        }\n        float patLen = patternScale * getPatternLength(whichPattern);\n        float phase = mod((totalDistance + parametricDistance), patLen);\n        bool onPixel = true;\n        float radiusPixels = radius + aaRange;\n        for (int i=2; i<MAX_LINESTYLE_LENGTH; i+=2) {\n            float on = getLinePatternPixel(i, whichPattern);\n            if (on == 1.0) on = 0.0;\n            on *= patternScale;\n            onPixel = true;\n            phase -= on;\n            if (phase < 0.0) {\n                break;\n            }\n            else if (phase <= radiusPixels) {\n                onPixel = false;\n                break;\n            }\n            float off = getLinePatternPixel(i+1, whichPattern);\n            if (off <= 1.0) off = 0.0;\n            off *= patternScale;\n            onPixel = false;\n            phase -= off;\n            if (phase < -radiusPixels)\n                discard;\n            if (phase <= 0.0)\n                break;\n        }\n        if (!onPixel && (abs(phase) <= radiusPixels)) {\n            segmentLength = 0.0;\n            parametricDistance = phase;\n        }\n    }\n#endif\n    float dist;\n    float offsetLength2 = dot(fsOffsetDirection, fsOffsetDirection);\n    float ltz = max(0.0, sign(-parametricDistance));\n    float gtsl = max(0.0, sign(parametricDistance - segmentLength));\n    float d = (ltz + gtsl) * (parametricDistance - gtsl * segmentLength);\n    dist = sqrt(max(0.0, offsetLength2 + d*d));\n    float range =  dist - radius;\n    if (range > aaRange) {\n        discard;\n    }\n    gl_FragColor = fsColor;\n    if (range > -aaRange)\n        gl_FragColor.a *= curveGaussian(range+aaRange, aaRange * 2.0);\n}\n#ifdef LOADING_ANIMATION\n    void fillTriangle() { gl_FragColor = vec4(fsColor.rgb, fsColor.a * loadingProgress); }\n#else\n    void fillTriangle() { gl_FragColor = fsColor; }\n#endif\n#if NUM_CUTPLANES > 0\nvarying highp vec3 vWorldPosition;\n#endif\n#include <cutplanes>\nfloat getSide(vec2 a, vec2 b, vec2 c) {\n    return sign((b.x - a.x) * (c.y - a.y) - (b.y - a.y) * (c.x - a.x));\n}\nvoid main() {\n    if (fsColor == vec4(0.0)) {\n        discard;\n    }\n#ifdef VIEWPORT_CLIPPING\n    vec2 bottomLeft = (mvpMatrix * modelMatrix * vec4(viewportBounds.xy, 0., 1.)).xy;\n    vec2 bottomRight = (mvpMatrix * modelMatrix * vec4(viewportBounds.zy, 0., 1.)).xy;\n    vec2 topRight = (mvpMatrix * modelMatrix * vec4(viewportBounds.zw, 0., 1.)).xy;\n    vec2 topLeft = (mvpMatrix * modelMatrix * vec4(viewportBounds.xw, 0., 1.)).xy;\n    float side = getSide(topLeft, topRight, bottomLeft);\n    if (side * getSide(topRight, bottomRight, vPosition) < 0.0 ||\n        side * getSide(bottomRight, bottomLeft, vPosition) < 0.0 ||\n        side * getSide(bottomLeft, topLeft, vPosition) < 0.0 ||\n        side * getSide(topLeft, topRight, vPosition) < 0.0) {\n        discard;\n    }\n#endif\n    if (fsHalfWidth == 0.0) {\n        fillTriangle();\n    }\n    else\n        fillLineSegment();\n    float writeId = 1.0;\n    gl_FragColor.a *= opacity;\n    if (gl_FragColor.a == 0.0) {\n        discard;\n    }\n    if (fsGhosting != 0.0 || \n            ((viewportId != 0.0) && (abs(fsVpTC.x * 255.0 + fsVpTC.y) >= 0.5 && abs(fsVpTC.x * 255.0 + fsVpTC.y - viewportId) >= 0.5))) {\n        writeId = 0.0;\n        gl_FragColor.a *= ((swap == 1.0) ? 0.21 : 0.1);\n    }\n#ifndef SELECTION_RENDERER\n    if (grayscale != 0.0) {\n        const vec3 rgb2grey = vec3(0.299, 0.587, 0.114);\n        float gray = dot(gl_FragColor.rgb, rgb2grey);\n        gl_FragColor.rgb = vec3(gray);\n    }\n#endif\n#if NUM_CUTPLANES > 0\n    checkCutPlanes(vWorldPosition);\n#endif\n#ifdef MRT_NORMALS\n    outNormal = vec4(0.0, 0.0, 0.0, 1.0);\n#endif\n#ifdef NO_ID_OUTPUT\n    writeId = 0.0;\n#endif\n#include <id_frag>\n}\n"},84325:e=>{e.exports="\n#include <line_decl_common>\nattribute vec2 fields1;\nattribute vec4 fields2;\nattribute vec4 flags4b;\nattribute vec4 layerVp4b;\n#ifdef USE_INSTANCING\nattribute vec4 instFlags4b;\n#endif\n#ifdef VIEWPORT_CLIPPING\nvarying vec2 vPosition;\n#endif\nuniform mat4 mvpMatrix;\nuniform float pixelsPerUnit;\nuniform float aaRange;\nuniform vec2 size;\nuniform float viewportId;\nuniform float swap;\n#ifdef HAS_LAYERS\nuniform sampler2D tLayerMask;\n#endif\n#ifdef SELECTION_RENDERER\nuniform sampler2D tSelectionTexture;\nuniform vec2 vSelTexSize;\n#endif\n#ifdef SELECTION_RENDERER\nuniform vec4 selectionColor;\n#endif\n#ifdef LOADING_ANIMATION\nuniform float meshAnimTime;\n#endif\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\nvarying vec4 dbId;\n#ifdef UNPACK_POSITIONS\nuniform sampler2D tIdColor;\nuniform vec2 vIdColorTexSize;\nuniform vec4 unpackXform;\nattribute vec2 uvIdColor;\nfloat unpackLineWeight(float w) {\n    if (w > 0.5) {\n        return - (w - 0.5) * 1024.0;\n    } else {\n        return w * max(unpackXform.x, unpackXform.y) * 2.0;\n    }\n}\nvec4 getVertexColor() {\n    float u = (uvIdColor.x + 0.5) / vIdColorTexSize.x;\n    return texture2D(tIdColor, vec2(u, 0.5));\n}\nvec4 getDbId() {\n    float u = (uvIdColor.y + 0.5) / vIdColorTexSize.x;\n    vec4 normDbId = texture2D(tIdColor, vec2(u, 0.5));\n    return normDbId * 255.0;\n}\n#else\nattribute vec4 color4b;\nattribute vec4 dbId4b;\nvec4 unpackXform;\nfloat unpackLineWeight(float w) {\n    return w;\n}\nvec4 getVertexColor() {\n    return color4b;\n}\nvec4 getDbId() {\n    return dbId4b;\n}\n#endif\nvec2 centralVertex;\nvec2 offsetPosition;\nvec2 offsetPosDepth;\nvec2 cos_sin(const float angle) { return vec2(cos(angle), sin(angle)); }\nvoid min_max(inout vec2 minPt, inout vec2 maxPt, const vec2 p) {\n    minPt = min(minPt, p);\n    maxPt = max(maxPt, p);\n}\n#if defined(USE_INSTANCING)\nfloat getVertexId() { return instFlags4b.x; }\n#else\nfloat getVertexId() { return flags4b.x; }\n#endif\nbool isStartVertex() { return (getVertexId() < VBB_SEG_END_RIGHT); }\nbool isLeftVertex()  { float id = getVertexId(); return ((id == VBB_SEG_END_LEFT || id == VBB_SEG_START_LEFT)); }\nstruct SegmentData { float angle, distAlong, distTotal, lineWidthHalf, lineType; };\nvoid decodeSegmentData(out SegmentData seg) {\n    seg.angle         = fields2.x * TAU - PI;\n    seg.distAlong     = fields2.y * max(unpackXform.x, unpackXform.y);\n    seg.distTotal     = fields2.w;\n    seg.lineWidthHalf = unpackLineWeight(fields2.z);\n    seg.lineType      = flags4b.z;\n}\nvoid strokeLineSegment() {\n    SegmentData seg; decodeSegmentData(seg);\n    float isStartCapVertex = isStartVertex() ? -1.0 :  1.0;\n    float isLeftSide       = isLeftVertex( ) ?  1.0 : -1.0;\n    vec4 startPosition = (mvpMatrix * modelMatrix * vec4(centralVertex.xy, 0.0, 1.0));\n    float distanceAlong = seg.distAlong;\n    vec2 along = distanceAlong * cos_sin(seg.angle);\n    vec4 endPosition = (mvpMatrix * modelMatrix * vec4(centralVertex.xy + along, 0.0, 1.0));\n    vec2 screenStart = startPosition.xy * 0.5 * size / startPosition.w;\n    vec2 screenEnd = endPosition.xy * 0.5 * size / endPosition.w;\n    if (isStartCapVertex < 0.0) {\n        offsetPosition = centralVertex = screenStart;\n        offsetPosDepth = startPosition.zw;\n    } else {\n        offsetPosition = centralVertex = screenEnd;\n        offsetPosDepth = endPosition.zw;\n    }\n    vec2 screenDelta = screenEnd - screenStart;\n    float screenAngle = (distanceAlong == 0.0) ? 0.0 : atan(screenDelta.y, screenDelta.x);\n    float angleTransverse = screenAngle - isLeftSide * HALF_PI;\n    float lwAdjustment = fsHalfWidth + aaRange;\n    vec2 transverseOffset = cos_sin(angleTransverse) * lwAdjustment;\n    offsetPosition += transverseOffset;\n    vec2 moveOffset = isStartCapVertex * isLeftSide * vec2(-transverseOffset.y, transverseOffset.x);\n    offsetPosition += moveOffset;\n    centralVertex += moveOffset;\n    float distanceFromStart = max(0.0, isStartCapVertex) * length(screenDelta);\n    fsMultipurpose.x = (isStartCapVertex * lwAdjustment) + distanceFromStart;\n    fsMultipurpose.y = length(screenDelta);\n    fsMultipurpose.z = seg.distTotal;\n    fsMultipurpose.w = seg.lineType;\n    if (seg.lineWidthHalf < 0.0)\n        fsHalfWidth = -fsHalfWidth;\n    fsOffsetDirection = offsetPosition - centralVertex;\n    gl_Position = vec4(2.0 * offsetPosition / size * offsetPosDepth.y, offsetPosDepth.xy);\n}\nstruct CommonAttribs { vec2 pos; vec4 color; vec2 layerTC, vpTC; float lineWidthHalf, geomType, ghosting; };\nvoid decodeCommonAttribs(out CommonAttribs attribs) {\n    attribs.pos           = fields1.xy * unpackXform.xy + unpackXform.zw;\n    attribs.color         = getVertexColor();\n    attribs.geomType      = flags4b.y;\n    attribs.layerTC       = layerVp4b.xy / 255.0;\n    attribs.vpTC          = layerVp4b.zw / 255.0;\n    attribs.lineWidthHalf = unpackLineWeight(fields2.z);\n    attribs.ghosting      = flags4b.w;\n}\nvoid strokeIndexedTriangle() {\n    fsHalfWidth = 0.0;\n    fsMultipurpose.z = 0.0;\n    gl_Position = (mvpMatrix * modelMatrix * vec4(centralVertex.xy, 0.0, 1.0));\n}\n#ifdef SELECTION_RENDERER\nbool isSelected(const CommonAttribs attribs) {\n    vec3 oid = getDbId().rgb;\n    float id01 = oid.r + oid.g * 256.0;\n    float t = (id01 + 0.5) * (1.0 / 4096.0);\n    float flrt = floor(t);\n    float texU = t - flrt;\n    float id23 = oid.b * (65536.0 / 4096.0) + flrt;\n    t = (id23 + 0.5) / vSelTexSize.y;\n    float texV = fract(t);\n    vec4 selBit = texture2D(tSelectionTexture, vec2(texU, texV));\n    return selBit.r == 1.0;\n}\n#endif\nbool isLayerOff(const CommonAttribs attribs) {\n#ifdef HAS_LAYERS\n    vec4 layerBit = texture2D(tLayerMask, attribs.layerTC);\n    return (layerBit.r == 0.0);\n#else\n    return false;\n#endif\n}\nvec4 getColor(const CommonAttribs attribs) {\n    if (isLayerOff(attribs)) { return vec4(0.0); }\n#ifdef SELECTION_RENDERER\n    if (isSelected(attribs)) { return selectionColor; }\n    return vec4(0.0);\n#else\n    return attribs.color;\n#endif\n}\n#ifdef GAMMA_INPUT\nvec4 inputToLinear(vec4 c) {\n    return vec4(vec3(c*c), c.a);\n}\n#endif\nvoid main() {\n#ifndef UNPACK_POSITIONS\n    unpackXform = vec4(1.0, 1.0, 0.0, 0.0);\n#endif\n    CommonAttribs attribs; decodeCommonAttribs(attribs);\n    fsColor = getColor(attribs);\n    #ifdef GAMMA_INPUT\n    fsColor = inputToLinear(fsColor);\n    #endif\n    if (swap != 0.0 ) {\n        if ( fsColor.r == 0.0 && fsColor.g == 0.0 && fsColor.b == 0.0 )\n            fsColor.rgb = vec3(1.0,1.0,1.0);\n        else if ( fsColor.r == 1.0 && fsColor.g == 1.0 && fsColor.b == 1.0 )\n            fsColor.rgb = vec3(0.0,0.0,0.0);\n    }\n    centralVertex = offsetPosition = attribs.pos;\n    float lineWeight = attribs.lineWidthHalf;\n    if (lineWeight > 0.0) {\n        lineWeight = max(0.5, lineWeight * pixelsPerUnit);\n    }\n    else {\n        lineWeight = max(0.5, abs(lineWeight));\n    }\n    fsHalfWidth = lineWeight;\n    dbId = dbId4b / 255.0;\n    fsVpTC     = attribs.vpTC;\n    fsGhosting = attribs.ghosting;\n#ifdef LOADING_ANIMATION\n    if (dbId.rgb == vec3(1.0)) {\n        loadingProgress = 1.0;\n    } else {\n        loadingProgress = smoothstep(0.0, 1.0, meshAnimTime);\n    }\n#endif\n    if      (attribs.geomType == VBB_GT_LINE_SEGMENT)     strokeLineSegment();\n    else strokeIndexedTriangle();\n#if NUM_CUTPLANES > 0\n    vec4 worldPosition = modelMatrix * vec4( offsetPosition.xy, 0.0, 1.0 );\n    vWorldPosition = worldPosition.xyz;\n#endif\n#ifdef VIEWPORT_CLIPPING\n    vPosition = gl_Position.xy;\n#endif\n}\n"},74957:e=>{e.exports="varying highp vec3 vNormal;\nvarying highp float depth;\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#include <cutplanes>\nvoid main() {\n#if NUM_CUTPLANES > 0\n    checkCutPlanes(vWorldPosition);\n#endif\n    vec3 n = vNormal;\n    n = n * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n    n = normalize( n );\n    gl_FragColor = vec4(n.x, n.y, depth, 1.0);\n}\n"},5030:e=>{e.exports="varying vec3 vNormal;\nvarying float depth;\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#include <pack_normals>\n#include <instancing_decl_vert>\nvoid main() {\n#ifdef UNPACK_NORMALS\n    vec3 objectNormal = decodeNormal(normal);\n#else\n    vec3 objectNormal = normal;\n#endif\n#ifdef FLIP_SIDED\n    objectNormal = -objectNormal;\n#endif\n    objectNormal = getInstanceNormal(objectNormal);\n    vec3 instPos = getInstancePos(position);\n    vec3 transformedNormal = normalMatrix * objectNormal;\n    vNormal = normalize( transformedNormal );\n#if NUM_CUTPLANES > 0\n    vec4 worldPosition = modelMatrix * vec4( instPos, 1.0 );\n    vWorldPosition = worldPosition.xyz;\n#endif\n    vec4 mvPosition = modelViewMatrix * vec4( instPos, 1.0 );\n    depth = mvPosition.z;\n    vec4 p_Position = projectionMatrix * mvPosition;\n    gl_Position = p_Position;\n}\n"},83039:e=>{e.exports="uniform vec3 diffuse;\r\nuniform float opacity;\r\n\r\nuniform vec3 emissive;\r\nuniform vec3 specular;\r\nuniform float shininess;\r\n\r\n#include <env_sample>\r\n\r\n#ifdef USE_COLOR\r\nvarying vec3 vColor;\r\n#endif\r\n\r\n#ifdef GAMMA_INPUT\r\nvec3 InputToLinear(vec3 c) {\r\n    return c * c;\r\n}\r\nfloat InputToLinear(float c) {\r\n    return c * c;\r\n}\r\n#else\r\nvec3 InputToLinear(vec3 c) {\r\n    return c;\r\n}\r\nfloat InputToLinear(float c) {\r\n    return c;\r\n}\r\n#endif\r\n\r\n#if defined( USE_MAP ) || defined( USE_SPECULARMAP )\r\nvarying vec2 vUv;\r\n#endif\r\n\r\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\r\nvarying vec2 vUvBump;\r\n#endif\r\n\r\n#if defined( USE_ALPHAMAP )\r\nvarying vec2 vUvAlpha;\r\n#endif\r\n\r\n#ifdef USE_MAP\r\nuniform sampler2D map;\r\n#endif\r\n\r\n#if TONEMAP_OUTPUT > 0\r\nuniform float exposureBias;\r\n#include <tonemap>\r\n#endif\r\n\r\n#if defined(IRR_RGBM) || defined(ENV_RGBM) || defined(ENV_GAMMA) || defined(IRR_GAMMA)\r\nuniform float envMapExposure;\r\n#endif\r\n\r\n#ifdef USE_FOG\r\nuniform vec3 fogColor;\r\nuniform float fogNear;\r\nuniform float fogFar;\r\n#endif\r\n#include <id_decl_frag>\r\n#include <theming_decl_frag>\r\n#include <shadowmap_decl_frag>\r\n\r\n#ifdef USE_ENVMAP\r\n\r\nuniform float reflMipIndex;\r\n\r\nuniform float reflectivity;\r\nuniform samplerCube envMap;\r\n\r\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\r\n\r\nuniform float refractionRatio;\r\n\r\n#endif\r\n\r\nvec3 sampleReflection(vec3 dir, float mipIndex) {\r\n\r\n    vec3 adjDir = adjustLookupVector(dir);\r\n\r\n#ifdef ENV_GAMMA\r\n\r\n#ifdef HAVE_TEXTURE_LOD\r\n    vec4 envTexColor = textureCubeLodEXT( envMap, adjDir, mipIndex );\r\n#else\r\n\r\n\r\n    vec4 envTexColor = textureCube( envMap, adjDir, mipIndex );\r\n#endif\r\n\r\n    return GammaDecode(envTexColor, envMapExposure);\r\n\r\n#elif defined(ENV_RGBM)\r\n\r\n#ifdef HAVE_TEXTURE_LOD\r\n    vec4 envTexColor = textureCubeLodEXT( envMap, adjDir, mipIndex );\r\n#else\r\n\r\n\r\n    vec4 envTexColor = textureCube( envMap, adjDir, mipIndex );\r\n#endif\r\n\r\n    return RGBMDecode(envTexColor, envMapExposure);\r\n\r\n#else\r\n\r\n\r\n\r\n    vec4 envTexColor = textureCube( envMap, adjDir );\r\n    vec3 cubeColor = envTexColor.xyz;\r\n\r\n#ifdef GAMMA_INPUT\r\n    cubeColor *= cubeColor;\r\n#endif\r\n\r\n    return cubeColor;\r\n\r\n#endif\r\n\r\n}\r\n\r\n#endif\r\n\r\n\r\nuniform vec3 ambientLightColor;\r\n\r\n#if MAX_DIR_LIGHTS > 0\r\n\r\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\r\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\r\n\r\n#endif\r\n\r\n#if MAX_POINT_LIGHTS > 0\r\n\r\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\r\n\r\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\r\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\r\n\r\n#endif\r\n\r\n#if MAX_SPOT_LIGHTS > 0\r\n\r\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\r\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\r\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\r\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\r\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\r\n\r\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\r\n\r\n#endif\r\n\r\n#ifdef USE_IRRADIANCEMAP\r\nuniform samplerCube irradianceMap;\r\n#endif\r\n\r\n#if MAX_SPOT_LIGHTS > 0 || NUM_CUTPLANES > 0\r\nvarying highp vec3 vWorldPosition;\r\n#endif\r\n\r\nvarying highp vec3 vViewPosition;\r\n#ifndef FLAT_SHADED\r\nvarying highp vec3 vNormal;\r\n#endif\r\n\r\n#ifdef USE_BUMPMAP\r\n\r\nuniform sampler2D bumpMap;\r\nuniform float bumpScale;\r\n\r\n\r\n\r\n\r\n\r\n\r\nvec2 dHdxy_fwd() {\r\n\r\n    vec2 dSTdx = dFdx( vUvBump );\r\n    vec2 dSTdy = dFdy( vUvBump );\r\n\r\n    float Hll = bumpScale * GET_BUMPMAP(vUvBump).x;\r\n    float dBx = bumpScale * GET_BUMPMAP(vUvBump + dSTdx).x - Hll;\r\n    float dBy = bumpScale * GET_BUMPMAP(vUvBump + dSTdy).x - Hll;\r\n\r\n    return vec2( dBx, dBy );\r\n\r\n}\r\n\r\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\r\n\r\n    vec3 vSigmaX = dFdx( surf_pos );\r\n    vec3 vSigmaY = dFdy( surf_pos );\r\n    vec3 vN = surf_norm;\r\n\r\n    vec3 R1 = cross( vSigmaY, vN );\r\n    vec3 R2 = cross( vN, vSigmaX );\r\n\r\n    float fDet = dot( vSigmaX, R1 );\r\n\r\n    vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\r\n    return normalize( abs( fDet ) * surf_norm - vGrad );\r\n\r\n}\r\n\r\n#endif\r\n\r\n\r\n#ifdef USE_NORMALMAP\r\n\r\nuniform sampler2D normalMap;\r\nuniform vec2 normalScale;\r\n\r\n\r\n\r\n\r\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\r\n\r\n    vec3 q0 = dFdx( eye_pos.xyz );\r\n    vec3 q1 = dFdy( eye_pos.xyz );\r\n    vec2 st0 = dFdx( vUvBump.st );\r\n    vec2 st1 = dFdy( vUvBump.st );\r\n\r\n    vec3 S = normalize(  q0 * st1.t - q1 * st0.t );\r\n    vec3 T = normalize( -q0 * st1.s + q1 * st0.s );\r\n    vec3 N = normalize( surf_norm );\r\n\r\n    vec3 mapN = GET_NORMALMAP(vUvBump).xyz * 2.0 - 1.0;\r\n    mapN.xy = normalScale * mapN.xy;\r\n    mat3 tsn = mat3( S, T, N );\r\n    return normalize( tsn * mapN );\r\n\r\n}\r\n\r\n#endif\r\n\r\n\r\n#ifdef USE_SPECULARMAP\r\nuniform sampler2D specularMap;\r\n#endif\r\n\r\n#ifdef USE_ALPHAMAP\r\nuniform sampler2D alphaMap;\r\n#endif\r\n\r\n#include <hatch_pattern>\r\n\r\nvec3 Schlick_v3(vec3 v, float cosHV) {\r\n    float facing = max(1.0 - cosHV, 0.0);\r\n    return v + (1.0 - v) * pow(facing, 5.0);\r\n}\r\n\r\nfloat Schlick_f(float v, float cosHV) {\r\n    float facing = max(1.0 - cosHV, 0.0);\r\n    return v + ( 1.0 - v ) * pow(facing, 5.0);\r\n}\r\n\r\n#include <cutplanes>\r\n\r\nvoid main() {\r\n\r\n#if NUM_CUTPLANES > 0\r\n    checkCutPlanes(vWorldPosition);\r\n#endif\r\n\r\n    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );\r\n\r\n#ifdef USE_MAP\r\n    vec4 texelColor = GET_MAP(vUv);\r\n#ifdef MAP_INVERT\r\n    texelColor.xyz = 1.0-texelColor.xyz;\r\n#endif\r\n#ifdef GAMMA_INPUT\r\n    texelColor.xyz *= texelColor.xyz;\r\n#endif\r\n    gl_FragColor = gl_FragColor * texelColor;\r\n#endif\r\n\r\n#ifdef USE_ALPHAMAP\r\n    vec4 texelAlpha = GET_ALPHAMAP(vUvAlpha);\r\n    gl_FragColor.a *= texelAlpha.r;\r\n#endif\r\n\r\n#ifdef ALPHATEST\r\n    if ( gl_FragColor.a < ALPHATEST ) discard;\r\n#endif\r\n\r\n    float specularStrength;\r\n\r\n#ifdef USE_SPECULARMAP\r\n    vec4 texelSpecular = GET_SPECULARMAP(vUv);\r\n    specularStrength = texelSpecular.r;\r\n#else\r\n    specularStrength = 1.0;\r\n#endif\r\n\r\n#ifndef FLAT_SHADED\r\n    vec3 normal = normalize( vNormal );\r\n#ifdef DOUBLE_SIDED\r\n\r\n#endif\r\n#else\r\n    vec3 fdx = dFdx( vViewPosition );\r\n    vec3 fdy = dFdy( vViewPosition );\r\n    vec3 normal = normalize( cross( fdx, fdy ) );\r\n#endif\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    vec3 viewDirection;\r\n    if (projectionMatrix[3][3] == 0.0) {\r\n        viewDirection = normalize( vViewPosition );\r\n    } else {\r\n        viewDirection = vec3(0.0, 0.0, 1.0);\r\n    }\r\n    normal = faceforward(normal, -viewDirection, normal);\r\n\r\n    vec3 geomNormal = normal;\r\n\r\n#ifdef USE_NORMALMAP\r\n    normal = perturbNormal2Arb( -vViewPosition, normal );\r\n#elif defined( USE_BUMPMAP )\r\n    normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\r\n#endif\r\n\r\n    vec3 totalDiffuse = vec3( 0.0 );\r\n    vec3 totalSpecular = vec3( 0.0 );\r\n\r\n\r\n\r\n    float shininessB = shininess * 4.0;\r\n\r\n#if MAX_POINT_LIGHTS > 0\r\n\r\n    vec3 pointDiffuse  = vec3( 0.0 );\r\n    vec3 pointSpecular = vec3( 0.0 );\r\n\r\n    for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\r\n\r\n        vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\r\n        vec3 lVector = lPosition.xyz + vViewPosition.xyz;\r\n\r\n        float lDistance = 1.0;\r\n        if ( pointLightDistance[ i ] > 0.0 )\r\n            lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\r\n\r\n        lVector = normalize( lVector );\r\n\r\n\r\n\r\n        float dotProduct = dot( normal, lVector );\r\n\r\n        float pointDiffuseWeight = max( dotProduct, 0.0 );\r\n\r\n\r\n        pointDiffuse  += InputToLinear(diffuse) * InputToLinear(pointLightColor[ i ]) * pointDiffuseWeight * lDistance;\r\n\r\n\r\n\r\n        vec3 pointHalfVector = normalize( lVector + viewDirection );\r\n        float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\r\n\r\n        float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininessB ), 0.0 );\r\n        float specularNormalization = shininessB * 0.125 + 0.25;\r\n        vec3 schlick = Schlick_v3(InputToLinear(specular), dot( lVector, pointHalfVector ) );\r\n        pointSpecular += schlick * InputToLinear(pointLightColor[ i ]) * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization ;\r\n\r\n    }\r\n\r\n    totalDiffuse += pointDiffuse;\r\n    totalSpecular += pointSpecular;\r\n\r\n#endif\r\n\r\n#if MAX_SPOT_LIGHTS > 0\r\n\r\n    vec3 spotDiffuse  = vec3( 0.0 );\r\n    vec3 spotSpecular = vec3( 0.0 );\r\n\r\n    for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\r\n\r\n        vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\r\n        vec3 lVector = lPosition.xyz + vViewPosition.xyz;\r\n\r\n        float lDistance = 1.0;\r\n        if ( spotLightDistance[ i ] > 0.0 )\r\n            lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\r\n\r\n        lVector = normalize( lVector );\r\n\r\n        float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\r\n\r\n        if ( spotEffect > spotLightAngleCos[ i ] ) {\r\n\r\n            spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\r\n\r\n\r\n\r\n            float dotProduct = dot( normal, lVector );\r\n\r\n            float spotDiffuseWeight = max( dotProduct, 0.0 );\r\n\r\n            spotDiffuse += InputToLinear(diffuse) * InputToLinear(spotLightColor[ i ]) * spotDiffuseWeight * lDistance * spotEffect;\r\n\r\n\r\n\r\n            vec3 spotHalfVector = normalize( lVector + viewDirection );\r\n            float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\r\n            float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininessB ), 0.0 );\r\n\r\n            float specularNormalization = shininessB * 0.125 + 0.25;\r\n            vec3 schlick = Schlick_v3(InputToLinear(specular), dot( lVector, spotHalfVector ) );\r\n            spotSpecular += schlick * InputToLinear(spotLightColor[ i ]) * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\r\n        }\r\n\r\n    }\r\n\r\n    totalDiffuse += spotDiffuse;\r\n    totalSpecular += spotSpecular;\r\n\r\n#endif\r\n\r\n#if MAX_DIR_LIGHTS > 0\r\n\r\n    vec3 dirDiffuse  = vec3( 0.0 );\r\n    vec3 dirSpecular = vec3( 0.0 );\r\n\r\n    for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\r\n\r\n        vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\r\n        vec3 dirVector = normalize( lDirection.xyz );\r\n\r\n\r\n\r\n        float dotProduct = dot( normal, dirVector );\r\n\r\n        float dirDiffuseWeight = max( dotProduct, 0.0 );\r\n\r\n        dirDiffuse  += InputToLinear(diffuse) * InputToLinear(directionalLightColor[ i ]) * dirDiffuseWeight;\r\n\r\n\r\n\r\n        vec3 dirHalfVector = normalize( dirVector + viewDirection );\r\n        float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\r\n        float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininessB ), 0.0 );\r\n\r\n        float specularNormalization = shininessB * 0.125 + 0.25;\r\n        vec3 schlick = Schlick_v3(InputToLinear(specular), dot( dirVector, dirHalfVector ));\r\n\r\n        dirSpecular += schlick * InputToLinear(directionalLightColor[ i ]) * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\r\n\r\n    }\r\n\r\n    totalDiffuse += dirDiffuse;\r\n    totalSpecular += dirSpecular;\r\n\r\n#endif\r\n\r\n\r\n\r\n#ifdef USE_IRRADIANCEMAP\r\n    vec3 worldNormal = mat3(viewMatrixInverse) * normal;\r\n    vec3 indirectDiffuse = sampleIrradianceMap(worldNormal, irradianceMap, envMapExposure);\r\n\r\n    indirectDiffuse = applyEnvShadow(indirectDiffuse, worldNormal);\r\n\r\n    totalDiffuse += InputToLinear(diffuse) * indirectDiffuse;\r\n#endif\r\n\r\n\r\n#ifdef METAL\r\n    gl_FragColor.xyz = gl_FragColor.xyz * ( InputToLinear(emissive) + totalDiffuse + ambientLightColor * InputToLinear(diffuse) + totalSpecular );\r\n#else\r\n    gl_FragColor.xyz = gl_FragColor.xyz * ( InputToLinear(emissive) + totalDiffuse + ambientLightColor * InputToLinear(diffuse) ) + totalSpecular;\r\n#endif\r\n\r\n\r\n\r\n#ifdef USE_COLOR\r\n    gl_FragColor = gl_FragColor * vec4( vColor, 1.0 );\r\n#endif\r\n\r\n\r\n#if defined(USE_ENVMAP)\r\n\r\n    vec3 reflectVec;\r\n\r\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\r\n\r\n#ifdef ENVMAP_MODE_REFLECTION\r\n    reflectVec = reflect( -viewDirection, normal );\r\n#else \r\n    reflectVec = refract( -viewDirection, normal, refractionRatio );\r\n#endif\r\n\r\n#else\r\n\r\n    reflectVec = reflect( -viewDirection, normal );\r\n\r\n#endif\r\n\r\n    reflectVec = mat3(viewMatrixInverse) * reflectVec;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    float reflectScale = 1.0;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    vec3 cubeColor = sampleReflection(reflectVec, reflMipIndex);\r\n\r\n    cubeColor *= reflectScale;\r\n\r\n    float facing = dot( viewDirection, normal );\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    if (facing < -1e-2  || reflectivity == 0.0)\r\n        facing = 1.0;\r\n    else\r\n        facing = max(1e-6, facing);\r\n\r\n#ifdef USE_BUMPMAP\r\n\r\n\r\n\r\n    facing = min(1.0, facing + bumpScale * 7.0);\r\n\r\n#endif\r\n\r\n    vec3 schlickRefl;\r\n\r\n#ifdef METAL\r\n\r\n\r\n    schlickRefl = InputToLinear(specular);\r\n\r\n#else\r\n\r\n\r\n    schlickRefl = Schlick_v3(InputToLinear(specular), facing);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    gl_FragColor.a = mix(gl_FragColor.a, Schlick_f(gl_FragColor.a, facing), reflectivity);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    float invSchlick = pow(1.0 - facing * 0.5, 5.0);\r\n\r\n\r\n    float norm_factor = (28.0 / 23.0) * (1.0 - invSchlick) * (1.0 - invSchlick);\r\n\r\n    gl_FragColor.xyz *= norm_factor * (1.0 - InputToLinear(specular));\r\n\r\n#endif\r\n\r\n\r\n    gl_FragColor.xyz += cubeColor.xyz * specularStrength * schlickRefl.xyz;\r\n\r\n#ifdef CLEARCOAT\r\n\r\n    vec3 reflectVecClearcoat = reflect( -viewDirection, geomNormal );\r\n    reflectVecClearcoat = mat3(viewMatrixInverse) * reflectVecClearcoat;\r\n\r\n    vec3 cubeColorClearcoat = sampleReflection(reflectVecClearcoat, 0.0);\r\n\r\n\r\n    float schlickClearcoat = Schlick_f(InputToLinear(reflectivity), facing);\r\n\r\n\r\n\r\n    gl_FragColor.xyz = mix(gl_FragColor.xyz, cubeColorClearcoat * schlickClearcoat, 0.5);\r\n\r\n#endif\r\n\r\n\r\n\r\n\r\n#endif\r\n\r\n#if TONEMAP_OUTPUT == 1\r\n    gl_FragColor.xyz = toneMapCanonOGS_WithGamma_WithColorPerserving(exposureBias * gl_FragColor.xyz);\r\n#elif TONEMAP_OUTPUT == 2\r\n    gl_FragColor.xyz = toneMapCanonFilmic_WithGamma( exposureBias * gl_FragColor.xyz );\r\n#endif\r\n\r\n\r\n\r\n#ifdef USE_FOG\r\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\r\n    float fogFactor = smoothstep( fogNear, fogFar, depth );\r\n    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\r\n#endif\r\n#include <theming_frag>\r\n#include <final_frag>\r\n\r\n}\r\n"},4352:e=>{e.exports="varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\nvarying vec3 vNormal;\n#endif\n#if defined( USE_MAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\nuniform mat3 texMatrix;\n#endif\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvarying vec2 vUvBump;\nuniform mat3 texMatrixBump;\n#endif\n#if defined( USE_ALPHAMAP )\nvarying vec2 vUvAlpha;\nuniform mat3 texMatrixAlpha;\n#endif\n#if defined( USE_ENVMAP )\n#if ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nuniform float refractionRatio;\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif\n#ifdef MRT_NORMALS\nvarying float depth;\n#endif\n#include <pack_normals>\n#include <instancing_decl_vert>\n#include <id_decl_vert>\n#include <wide_lines_decl>\n#include <shadowmap_decl_vert>\nvoid main() {\n#if defined( USE_MAP ) || defined( USE_SPECULARMAP )\n    vUv = (texMatrix * vec3(uv, 1.0)).xy;\n#endif\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n    vUvBump = (texMatrixBump * vec3(uv, 1.0)).xy;\n#endif\n#if defined( USE_ALPHAMAP )\n    vUvAlpha = (texMatrixAlpha * vec3(uv, 1.0)).xy;\n#endif\n#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\n    vColor = color * color;\n#else\n    vColor = color;\n#endif\n#endif\n#ifdef UNPACK_NORMALS\n    vec3 objectNormal = decodeNormal(normal);\n#else\n    vec3 objectNormal = normal;\n#endif\n#ifdef FLIP_SIDED\n    objectNormal = -objectNormal;\n#endif\n    objectNormal = getInstanceNormal(objectNormal);\n    vec3 instPos = getInstancePos(position);\n    vec3 transformedNormal = normalMatrix * objectNormal;\n#ifndef FLAT_SHADED\n    vNormal = normalize( transformedNormal );\n#endif\n    vec4 mvPosition = modelViewMatrix * vec4( instPos, 1.0 );\n    gl_Position = projectionMatrix * mvPosition;\n#include <wide_lines_vert>\n    vViewPosition = -mvPosition.xyz;\n#if MAX_SPOT_LIGHTS > 0 || NUM_CUTPLANES > 0\n    vec4 worldPosition = modelMatrix * vec4( instPos, 1.0 );\n    vWorldPosition = worldPosition.xyz;\n#endif\n#ifdef MRT_NORMALS\n    depth = mvPosition.z;\n#endif\n#include <shadowmap_vert>\n#include <id_vert>\n}\n"},50410:e=>{e.exports="\n#define EDGE_SHARPNESS     (3.0)\n#define SCALE               (2)\n#define R                   (4)\n#define VALUE_TYPE        float\n#define VALUE_COMPONENTS   r\n#define VALUE_IS_KEY       0\n#define KEY_COMPONENTS     gb\n#if __VERSION__ >= 330\nconst float gaussian[R + 1] =\nfloat[](0.153170, 0.144893, 0.122649, 0.092902, 0.062970);\n#endif\nuniform sampler2D   tDiffuse;\nuniform vec2 size;\nuniform vec2 resolution;\nuniform vec2       axis;\nuniform float radius;\n#define  result         gl_FragColor.VALUE_COMPONENTS\n#define  keyPassThrough gl_FragColor.KEY_COMPONENTS\nfloat unpackKey(vec2 p) {\n    return p.x + p.y * (1.0 / 255.0);\n}\nvarying vec2 vUv;\nvoid main() {\n#   if __VERSION__ < 330\n    float gaussian[R + 1];\n#       if R == 3\n    gaussian[0] = 0.153170; gaussian[1] = 0.144893; gaussian[2] = 0.122649; gaussian[3] = 0.092902;\n#       elif R == 4\n    gaussian[0] = 0.153170; gaussian[1] = 0.144893; gaussian[2] = 0.122649; gaussian[3] = 0.092902; gaussian[4] = 0.062970;\n#       elif R == 6\n    gaussian[0] = 0.111220; gaussian[1] = 0.107798; gaussian[2] = 0.098151; gaussian[3] = 0.083953; gaussian[4] = 0.067458; gaussian[5] = 0.050920; gaussian[6] = 0.036108;\n#       endif\n#   endif\n    ivec2 axisi = ivec2(axis);\n    ivec2 ssC = ivec2(gl_FragCoord.xy);\n    vec4 temp = texture2D(tDiffuse, vUv);\n    gl_FragColor.gb = temp.KEY_COMPONENTS;\n    gl_FragColor.a = temp.a;\n    VALUE_TYPE sum = temp.VALUE_COMPONENTS;\n    if (temp.a == 0.0) {\n        result = sum;\n        return;\n    }\n    float key = unpackKey(keyPassThrough);\n    float BASE = gaussian[0];\n    float totalWeight = BASE;\n    sum *= totalWeight;\n    float scale = 1.5 / radius;\n    int r = -4; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[4];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    r = -3; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[3];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    r = -2; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[2];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    r=-1; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[1];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    r = 1; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[1];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    r = 2; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[2];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    r = 3; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[3];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    r = 4; {\n        vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\n        temp = texture2D(tDiffuse, ssUV);\n        float      tapKey = unpackKey(temp.KEY_COMPONENTS);\n        VALUE_TYPE value  = temp.VALUE_COMPONENTS;\n        float weight = 0.3 + gaussian[4];\n        float dz = tapKey - key;\n        weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz) * scale);\n        sum += value * weight;\n        totalWeight += weight;\n    }\n    const float epsilon = 0.0001;\n    result = sum / (totalWeight + epsilon);\n}\n"},6890:e=>{e.exports="\n#include <depth_texture>\n#define USE_MIPMAP 1\nuniform float cameraNear;\nuniform float cameraFar;\nuniform vec2 size;\nuniform vec2 resolution;\nuniform float lumInfluence;\nvarying vec2 vUv;\n#define NUM_SAMPLES (17)\n#define LOG_MAX_OFFSET (3)\n#define MAX_MIP_LEVEL (5)\n#define NUM_SPIRAL_TURNS (5)\n#define MIN_RADIUS (3.0)\n#define TAU 6.28318530718\nuniform float           projScale;\n#ifdef USE_MIPMAP\nuniform sampler2D tDepth_mip1;\nuniform sampler2D tDepth_mip2;\nuniform sampler2D tDepth_mip3;\nuniform sampler2D tDepth_mip4;\nuniform sampler2D tDepth_mip5;\n#endif\nuniform float radius;\nuniform float bias;\nuniform float intensity;\nvec2 tapLocation(int sampleNumber, float spinAngle, out float ssR){\n    float alpha = float(float(sampleNumber) + 0.5) * (1.0 / float(NUM_SAMPLES));\n    float angle = alpha * (float(NUM_SPIRAL_TURNS) * TAU) + spinAngle;\n    ssR = alpha;\n    return vec2(cos(angle), sin(angle));\n}\nfloat CSZToKey(float z) {\n    return clamp( (z+cameraNear) / (cameraNear-cameraFar), 0.0, 1.0);\n}\nvoid packKey(float key, out vec2 p) {\n    float temp = floor(key * 255.0);\n    p.x = temp * (1.0 / 255.0);\n    p.y = key * 255.0 - temp;\n}\n#include <pack_depth>\nfloat unpackDepthNearFar( const in vec4 rgba_depth ) {\n    float depth = unpackDepth( rgba_depth );\n    if (depth == 0.0)\n        return -cameraFar * 1.0e10;\n    return depth * (cameraNear - cameraFar) - cameraNear;\n}\nvec3 reconstructCSFaceNormal(vec3 C) {\n    return normalize(cross(dFdy(C), dFdx(C)));\n}\nvec3 reconstructNonUnitCSFaceNormal(vec3 C) {\n    return cross(dFdy(C), dFdx(C));\n}\nvec3 getPosition(ivec2 ssP, float depth) {\n    vec3 P;\n    P = reconstructCSPosition(vec2(ssP) + vec2(0.5), depth);\n    return P;\n}\nvec3 getOffsetPosition(ivec2 ssC, vec2 unitOffset, float ssR) {\n    ivec2 ssP = ivec2(ssR * unitOffset) + ssC;\n    vec3 P;\n#ifdef _LMVWEBGL2_\n#ifdef USE_MIPMAP\n    int mipLevel = clamp(int(floor(log2(ssR))) - LOG_MAX_OFFSET, 0, MAX_MIP_LEVEL);\n    if (mipLevel == 0) {\n        P.z = texelFetch(tDepth, ssP, 0).z;\n        if (P.z == 0.0) P.z = -cameraFar * 1.0e10;\n    }\n    else if (mipLevel == 1) {\n        ivec2 mipP = clamp(ssP >> mipLevel, ivec2(0), textureSize(tDepth_mip1, 0) - ivec2(1));\n        P.z = unpackDepthNearFar(texelFetch(tDepth_mip1, mipP, 0));\n    } else if (mipLevel == 2) {\n        ivec2 mipP = clamp(ssP >> mipLevel, ivec2(0), textureSize(tDepth_mip2, 0) - ivec2(1));\n        P.z = unpackDepthNearFar(texelFetch(tDepth_mip2, mipP, 0));\n    } else if (mipLevel == 3) {\n        ivec2 mipP = clamp(ssP >> mipLevel, ivec2(0), textureSize(tDepth_mip3, 0) - ivec2(1));\n        P.z = unpackDepthNearFar(texelFetch(tDepth_mip3, mipP, 0));\n    } else if (mipLevel == 4) {\n        ivec2 mipP = clamp(ssP >> mipLevel, ivec2(0), textureSize(tDepth_mip4, 0) - ivec2(1));\n        P.z = unpackDepthNearFar(texelFetch(tDepth_mip4, mipP, 0));\n    } else if (mipLevel == 5) {\n        ivec2 mipP = clamp(ssP >> mipLevel, ivec2(0), textureSize(tDepth_mip5, 0) - ivec2(1));\n        P.z = unpackDepthNearFar(texelFetch(tDepth_mip5, mipP, 0));\n    }\n#else\n    P.z = texelFetch(tDepth, ssP, 0).z;\n    if (P.z == 0.0) P.z = -cameraFar * 1.0e10;\n#endif\n#else\n    vec2 screenUV = (vec2(ssP) + vec2(0.5)) * resolution;\n#ifdef USE_MIPMAP\n    int mipLevel = int(max(0.0, min(floor(log2(ssR)) - float(LOG_MAX_OFFSET), float(MAX_MIP_LEVEL))));\n    if (mipLevel == 0) {\n        P.z = texture2D(tDepth, screenUV).z;\n        if (P.z == 0.0) P.z = -cameraFar * 1.0e10;\n    }\n    else if (mipLevel == 1)\n        P.z = unpackDepthNearFar(texture2D(tDepth_mip1, screenUV));\n    else if (mipLevel == 2)\n        P.z = unpackDepthNearFar(texture2D(tDepth_mip2, screenUV));\n    else if (mipLevel == 3)\n        P.z = unpackDepthNearFar(texture2D(tDepth_mip3, screenUV));\n    else if (mipLevel == 4)\n        P.z = unpackDepthNearFar(texture2D(tDepth_mip4, screenUV));\n    else if (mipLevel == 5)\n        P.z = unpackDepthNearFar(texture2D(tDepth_mip5, screenUV));\n#else\n    P.z = texture2D(tDepth, screenUV).z;\n    if (P.z == 0.0) P.z = -cameraFar * 1.0e10;\n#endif\n#endif\n    P = reconstructCSPosition(vec2(ssP) + vec2(0.5), P.z);\n    return P;\n}\nfloat sampleAO(in ivec2 ssC, in vec3 C, in vec3 n_C, in float ssDiskRadius, in int tapIndex, in float randomPatternRotationAngle) {\n    float ssR;\n    vec2 unitOffset = tapLocation(tapIndex, randomPatternRotationAngle, ssR);\n    ssR = max(0.75, ssR * ssDiskRadius);\n    vec3 Q = getOffsetPosition(ssC, unitOffset, ssR);\n    vec3 v = Q - C;\n    float vv = dot(v, v);\n    float vn = dot(v, n_C);\n    const float epsilon = 0.001;\n    float angAdjust = mix(1.0, max(0.0, 1.5 * n_C.z), 0.35);\n#define HIGH_QUALITY\n#ifdef HIGH_QUALITY\n    float f = max(1.0 - vv / (radius * radius), 0.0); return angAdjust * f * max((vn - bias) / sqrt(epsilon + vv), 0.0);\n#else\n    float f = max(radius * radius - vv, 0.0); return angAdjust * f * f * f * max((vn - bias) / (epsilon + vv), 0.0);\n#endif\n}\nconst bool useNoise = true;\nfloat getRandomAngle(vec2 pos) {\n    float dt= dot(pos ,vec2(12.9898,78.233));\n    return TAU * fract(sin(mod(dt,3.14)) * 43758.5453);\n}\nvoid main() {\n    ivec2 ssC = ivec2(gl_FragCoord.xy);\n    vec4 nrmz = texture2D(tDepth, vUv);\n    if (nrmz.z == 0.0) {\n        gl_FragColor.r = 1.0;\n        gl_FragColor.a = 0.0;\n        packKey(1.0, gl_FragColor.gb);\n        return;\n    }\n    vec3 C = getPosition(ssC, nrmz.z);\n    packKey(CSZToKey(C.z), gl_FragColor.gb);\n    float ssDiskRadius = -projScale * radius / mix(C.z, -1.0, isOrtho);\n    float A;\n    if (ssDiskRadius <= MIN_RADIUS) {\n        A = 1.0;\n    } else {\n        float sum = 0.0;\n        float randomPatternRotationAngle = getRandomAngle(vUv);\n        vec3 n_C = vec3(nrmz.x, nrmz.y, sqrt(1.0 - dot(nrmz.xy, nrmz.xy)));\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 0, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 1, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 2, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 3, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 4, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 5, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 6, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 7, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 8, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 9, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 10, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 11, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 12, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 13, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 14, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 15, randomPatternRotationAngle);\n        sum += sampleAO(ssC, C, n_C, ssDiskRadius, 16, randomPatternRotationAngle);\n        float intensityDivR6 = intensity / pow(radius, 6.0);\n#ifdef HIGH_QUALITY\n        A = pow(max(0.0, 1.0 - sqrt(sum * (3.0 / float(NUM_SAMPLES)))), intensity);\n#else\n        A = max(0.0, 1.0 - sum * intensityDivR6 * (5.0 / float(NUM_SAMPLES)));\n        A = (pow(A, 0.2) + 1.2 * A*A*A*A) / 2.2;\n#endif\n        if (abs(dFdx(C.z)) < 0.02) {\n            A -= dFdx(A) * (mod(float(ssC.x), 2.0) - 0.5);\n        }\n        if (abs(dFdy(C.z)) < 0.02) {\n            A -= dFdy(A) * (mod(float(ssC.y), 2.0) - 0.5);\n        }\n        A = mix(1.0, A, clamp(ssDiskRadius - MIN_RADIUS,0.0,1.0));\n    }\n    gl_FragColor.r = A;\n    gl_FragColor.a = 1.0;\n}\n"},3819:e=>{e.exports="uniform sampler2D tDiffuse;\nuniform vec2 resolution;\nvoid main() {\n    vec2 ssP = vec2(gl_FragCoord.xy);\n    ssP = ssP * 2.0 + mod(ssP, 2.0);\n    ssP = (ssP + 0.5) * resolution * 0.5;\n    gl_FragColor = texture2D(tDiffuse, ssP);\n}\n"},92003:e=>{e.exports="uniform sampler2D tDiffuse;\nuniform vec2 resolution;\nuniform float cameraNear;\nuniform float cameraInvNearFar;\n#include <pack_depth>\nvoid main() {\n    vec2 ssP = vec2(gl_FragCoord.xy);\n    ssP = ssP * 2.0 + mod(ssP, 2.0);\n    ssP = (ssP + 0.5) * resolution * 0.5;\n    float depth = texture2D(tDiffuse, ssP).z;\n    if (depth != 0.0)\n        depth = (depth + cameraNear) * cameraInvNearFar;\n    gl_FragColor = packDepth(depth);\n}\n"},66209:e=>{e.exports="varying vec2 vUv;\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n"},11342:e=>{e.exports="\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n"},18214:e=>{e.exports="#include <shadowmap_decl_common>\nvarying float depth;\n#ifdef USE_SURFACE_CUTOUT_MAP\n#include <float3_average>\n#if defined( USE_SURFACE_CUTOUT_MAP )\n    uniform sampler2D surface_cutout_map;\n    uniform mat3 surface_cutout_map_texMatrix;\n    uniform bool surface_cutout_map_invert;\n#endif\nvarying vec2 vUv;\n#else\n#ifdef USE_MAP\nvarying vec2 vUv;\nuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\nvarying vec2 vUvAlpha;\nuniform sampler2D alphaMap;\n#endif\n#endif\nuniform float shadowMinOpacity;\nvoid applyCutoutMaps() {\n    float opacity = 1.0;\n#ifdef USE_SURFACE_CUTOUT_MAP\n    #if defined( USE_SURFACE_CUTOUT_MAP )\n        vec2 uv_surface_cutout_map = (surface_cutout_map_texMatrix * vec3(uv, 1.0)).xy;\n        SURFACE_CUTOUT_CLAMP_TEST;\n        vec3 opacity_v3 = texture2D(surface_cutout_map, uv_surface_cutout_map).xyz;\n        if(surface_cutout_map_invert) opacity_v3 = vec3(1.0) - opacity_v3;\n        opacity = average(opacity_v3);\n    #else\n        opacity = surface_cutout;\n    #endif\n#else\n#ifdef USE_MAP\n    opacity *= GET_MAP(vUv).a;\n#endif\n#ifdef USE_ALPHAMAP\n    opacity *= GET_ALPHAMAP(vUvAlpha).r;\n#endif\n#endif\n#if defined(USE_SURFACE_CUTOUT_MAP) || defined(USE_MAP) || defined(USE_ALPHAMAP)\n    if (opacity < shadowMinOpacity) discard;\n#endif\n}\nvoid main() {\n    float normalizedLinearDepth = (depth - shadowMapRangeMin) / shadowMapRangeSize;\n    float val = exp(shadowESMConstant * normalizedLinearDepth);\n#ifdef USE_HARD_SHADOWS\n    val = normalizedLinearDepth;\n#endif\n    applyCutoutMaps();\n    gl_FragColor = vec4(val, 0, 0, 1);\n}\n"},83159:e=>{e.exports="#include <shadowmap_decl_frag>\nvoid main() {\n    float shadowIntensity = 0.5 * (1.0 - getShadowValue());\n    gl_FragColor = vec4(0.0, 0.0, 0.0, shadowIntensity);\n}\n"},2680:e=>{e.exports="#include <shadowmap_decl_vert>\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n#include <shadowmap_vert>\n}\n"},47065:e=>{e.exports="#include <shadowmap_decl_common>\nvarying float depth;\n#ifdef USE_SURFACE_CUTOUT_MAP\nvarying vec2 vUv;\n#else\n#ifdef USE_MAP\nvarying vec2 vUv;\nuniform mat3 texMatrix;\n#endif\n#ifdef USE_ALPHAMAP\nvarying vec2 vUvAlpha;\nuniform mat3 texMatrixAlpha;\n#endif\n#endif\nvoid passCutoutUVCoords() {\n#ifdef USE_SURFACE_CUTOUT_MAP\n    vUv = uv;\n#else\n#ifdef USE_MAP\n    vUv = (texMatrix * vec3(uv, 1.0)).xy;\n#endif\n#ifdef USE_ALPHAMAP\n    vUvAlpha = (texMatrixAlpha * vec3(uv, 1.0)).xy;\n#endif\n#endif\n}\nvoid main() {\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n    vec4 p_Position = projectionMatrix * mvPosition;\n    gl_Position = p_Position;\n    depth = -mvPosition.z;\n    passCutoutUVCoords();\n}\n"},70125:e=>{e.exports="#include <id_decl_frag>\nuniform sampler2D sheetMap;\nuniform sampler2D idMap;\nuniform vec2 resolution;\nuniform vec3 modelIDv2;\nuniform float alphaTest;\nvoid main() {\n    vec2 uv = vec2(gl_FragCoord.x * resolution.x, gl_FragCoord.y * resolution.y);\n    vec4 c = texture2D(sheetMap, uv);\n    if (c.a <= alphaTest)\n        discard;\n    \n    gl_FragColor = c;\n    vec4 dbId = texture2D(idMap, uv);\n#ifdef MRT_NORMALS\n    outNormal = vec4(0.0, 0.0, 0.0, 1.0);\n#endif\n#ifdef MRT_ID_BUFFER\n    outId = vec4(dbId.rgb, 1.0);\n    #ifdef MODEL_COLOR\n    outModelId = vec4(modelIDv2.rgb, 1.0);\n    #endif\n#elif defined(ID_COLOR)\n    gl_FragColor = vec4(dbId.rgb, 1.0);\n#elif defined(MODEL_COLOR)\n    gl_FragColor = vec4(modelIDv2.rgb, 1.0);\n#endif\n}\n"},70057:e=>{e.exports="void main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}"},52072:e=>{e.exports=function(){"use strict";var e=function(){for(var e=3,t=document.createElement("b"),n=t.all||[];t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i><![endif]--\x3e",n[0];);return e>4?e:document.documentMode}(),t=navigator.platform.toLowerCase().indexOf("mac")+1,n=function(e){if(!(this instanceof n))return new n(e);var a=this,s={rows_in_block:50,blocks_in_cluster:4,tag:null,show_no_data_row:!0,no_data_class:"clusterize-no-data",no_data_text:"No data",keep_parity:!0,callbacks:{}};a.options={};for(var l,c=["rows_in_block","blocks_in_cluster","show_no_data_row","no_data_class","no_data_text","keep_parity","tag","callbacks"],u=0;l=c[u];u++)a.options[l]=void 0!==e[l]&&null!=e[l]?e[l]:s[l];var h,d=["scroll","content"];for(u=0;h=d[u];u++)if(a[h+"_elem"]=e[h+"Id"]?document.getElementById(e[h+"Id"]):e[h+"Elem"],!a[h+"_elem"])throw new Error("Error! Could not find "+h+" element");a.content_elem.hasAttribute("tabindex")||a.content_elem.setAttribute("tabindex",0);var p=o(e.rows)?e.rows:a.fetchMarkup(),f={},m=a.scroll_elem.scrollTop;a.insertToDOM(p,f),a.scroll_elem.scrollTop=m;var g=!1,v=0,y=!1,b=function(){t&&(y||(a.content_elem.style.pointerEvents="none"),y=!0,clearTimeout(v),v=setTimeout((function(){a.content_elem.style.pointerEvents="auto",y=!1}),50)),g!=(g=a.getClusterNum())&&a.insertToDOM(p,f),a.options.callbacks.scrollingProgress&&a.options.callbacks.scrollingProgress(a.getScrollProgress())},_=0,x=function(){clearTimeout(_),_=setTimeout(a.refresh,100)};i("scroll",a.scroll_elem,b),i("resize",window,x),a.destroy=function(e){r("scroll",a.scroll_elem,b),r("resize",window,x),a.html((e?a.generateEmptyRow():p).join(""))},a.refresh=function(e){(a.getRowsHeight(p)||e)&&a.update(p)},a.update=function(e){p=o(e)?e:[];var t=a.scroll_elem.scrollTop;p.length*a.options.item_height<t&&(a.scroll_elem.scrollTop=0,g=0),a.insertToDOM(p,f),a.scroll_elem.scrollTop=t},a.clear=function(){a.update([])},a.getRowsAmount=function(){return p.length},a.getScrollProgress=function(){return this.options.scroll_top/(p.length*this.options.item_height)*100||0};var E=function(e,t){var n=o(t)?t:[];n.length&&(p="append"==e?p.concat(n):n.concat(p),a.insertToDOM(p,f))};a.append=function(e){E("append",e)},a.prepend=function(e){E("prepend",e)}};function i(e,t,n){return t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)}function r(e,t,n){return t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent("on"+e,n)}function o(e){return"[object Array]"===Object.prototype.toString.call(e)}function a(e,t){return window.getComputedStyle?window.getComputedStyle(t)[e]:t.currentStyle[e]}return n.prototype={constructor:n,fetchMarkup:function(){for(var e=[],t=this.getChildNodes(this.content_elem);t.length;)e.push(t.shift().outerHTML);return e},exploreEnvironment:function(t,n){var i=this.options;i.content_tag=this.content_elem.tagName.toLowerCase(),t.length&&(e&&e<=9&&!i.tag&&(i.tag=t[0].match(/<([^>\s/]*)/)[1].toLowerCase()),this.content_elem.children.length<=1&&(n.data=this.html(t[0]+t[0]+t[0])),i.tag||(i.tag=this.content_elem.children[0].tagName.toLowerCase()),this.getRowsHeight(t))},getRowsHeight:function(e){var t=this.options,n=t.item_height;if(t.cluster_height=0,e.length){var i=this.content_elem.children;if(i.length){var r=i[Math.floor(i.length/2)];if(t.item_height=r.offsetHeight,"tr"==t.tag&&"collapse"!=a("borderCollapse",this.content_elem)&&(t.item_height+=parseInt(a("borderSpacing",this.content_elem),10)||0),"tr"!=t.tag){var o=parseInt(a("marginTop",r),10)||0,s=parseInt(a("marginBottom",r),10)||0;t.item_height+=Math.max(o,s)}return t.block_height=t.item_height*t.rows_in_block,t.rows_in_cluster=t.blocks_in_cluster*t.rows_in_block,t.cluster_height=t.blocks_in_cluster*t.block_height,n!=t.item_height}}},getClusterNum:function(){return this.options.scroll_top=this.scroll_elem.scrollTop,Math.floor(this.options.scroll_top/(this.options.cluster_height-this.options.block_height))||0},generateEmptyRow:function(){var e=this.options;if(!e.tag||!e.show_no_data_row)return[];var t,n=document.createElement(e.tag),i=document.createTextNode(e.no_data_text);return n.className=e.no_data_class,"tr"==e.tag&&((t=document.createElement("td")).colSpan=100,t.appendChild(i)),n.appendChild(t||i),[n.outerHTML]},generate:function(e,t){var n=this.options,i=e.length;if(i<n.rows_in_block)return{top_offset:0,bottom_offset:0,rows_above:0,rows:i?e:this.generateEmptyRow()};var r=Math.max((n.rows_in_cluster-n.rows_in_block)*t,0),o=r+n.rows_in_cluster,a=Math.max(r*n.item_height,0),s=Math.max((i-o)*n.item_height,0),l=[],c=r;a<1&&c++;for(var u=r;u<o;u++)e[u]&&l.push(e[u]);return{top_offset:a,bottom_offset:s,rows_above:c,rows:l}},renderExtraTag:function(e,t){var n=document.createElement(this.options.tag),i="clusterize-";return n.className=[i+"extra-row",i+e].join(" "),t&&(n.style.height=t+"px"),n.outerHTML},insertToDOM:function(e,t){this.options.cluster_height||this.exploreEnvironment(e,t);var n=this.generate(e,this.getClusterNum()),i=n.rows.join(""),r=this.checkChanges("data",i,t),o=this.checkChanges("top",n.top_offset,t),a=this.checkChanges("bottom",n.bottom_offset,t),s=this.options.callbacks,l=[];r||o?(n.top_offset&&(this.options.keep_parity&&l.push(this.renderExtraTag("keep-parity")),l.push(this.renderExtraTag("top-space",n.top_offset))),l.push(i),n.bottom_offset&&l.push(this.renderExtraTag("bottom-space",n.bottom_offset)),s.clusterWillChange&&s.clusterWillChange(),this.html(l.join("")),"ol"==this.options.content_tag&&this.content_elem.setAttribute("start",n.rows_above),this.content_elem.style["counter-increment"]="clusterize-counter "+(n.rows_above-1),s.clusterChanged&&s.clusterChanged()):a&&(this.content_elem.lastChild.style.height=n.bottom_offset+"px")},html:function(t){var n=this.content_elem;if(e&&e<=9&&"tr"==this.options.tag){var i,r=document.createElement("div");for(r.innerHTML="<table><tbody>"+t+"</tbody></table>";i=n.lastChild;)n.removeChild(i);for(var o=this.getChildNodes(r.firstChild.firstChild);o.length;)n.appendChild(o.shift())}else n.innerHTML=t},getChildNodes:function(e){for(var t=e.children,n=[],i=0,r=t.length;i<r;i++)n.push(t[i]);return n},checkChanges:function(e,t,n){var i=t!=n[e];return n[e]=t,i}},n}()},13099:e=>{e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},96077:(e,t,n)=>{var i=n(70111);e.exports=function(e){if(!i(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e}},51223:(e,t,n)=>{var i=n(5112),r=n(70030),o=n(3070),a=i("unscopables"),s=Array.prototype;null==s[a]&&o.f(s,a,{configurable:!0,value:r(null)}),e.exports=function(e){s[a][e]=!0}},31530:(e,t,n)=>{"use strict";var i=n(28710).charAt;e.exports=function(e,t,n){return t+(n?i(e,t).length:1)}},25787:e=>{e.exports=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e}},19670:(e,t,n)=>{var i=n(70111);e.exports=function(e){if(!i(e))throw TypeError(String(e)+" is not an object");return e}},24019:e=>{e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},90260:(e,t,n)=>{"use strict";var i,r=n(24019),o=n(19781),a=n(17854),s=n(70111),l=n(86656),c=n(70648),u=n(68880),h=n(31320),d=n(3070).f,p=n(79518),f=n(27674),m=n(5112),g=n(69711),v=a.Int8Array,y=v&&v.prototype,b=a.Uint8ClampedArray,_=b&&b.prototype,x=v&&p(v),E=y&&p(y),w=Object.prototype,S=w.isPrototypeOf,A=m("toStringTag"),M=g("TYPED_ARRAY_TAG"),T=r&&!!f&&"Opera"!==c(a.opera),C=!1,P={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},L=function(e){return s(e)&&l(P,c(e))};for(i in P)a[i]||(T=!1);if((!T||"function"!=typeof x||x===Function.prototype)&&(x=function(){throw TypeError("Incorrect invocation")},T))for(i in P)a[i]&&f(a[i],x);if((!T||!E||E===w)&&(E=x.prototype,T))for(i in P)a[i]&&f(a[i].prototype,E);if(T&&p(_)!==E&&f(_,E),o&&!l(E,A))for(i in C=!0,d(E,A,{get:function(){return s(this)?this[M]:void 0}}),P)a[i]&&u(a[i],M,i);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:T,TYPED_ARRAY_TAG:C&&M,aTypedArray:function(e){if(L(e))return e;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(e){if(f){if(S.call(x,e))return e}else for(var t in P)if(l(P,i)){var n=a[t];if(n&&(e===n||S.call(n,e)))return e}throw TypeError("Target is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n){if(o){if(n)for(var i in P){var r=a[i];r&&l(r.prototype,e)&&delete r.prototype[e]}E[e]&&!n||h(E,e,n?t:T&&y[e]||t)}},exportTypedArrayStaticMethod:function(e,t,n){var i,r;if(o){if(f){if(n)for(i in P)(r=a[i])&&l(r,e)&&delete r[e];if(x[e]&&!n)return;try{return h(x,e,n?t:T&&v[e]||t)}catch(e){}}for(i in P)!(r=a[i])||r[e]&&!n||h(r,e,t)}},isView:function(e){var t=c(e);return"DataView"===t||l(P,t)},isTypedArray:L,TypedArray:x,TypedArrayPrototype:E}},13331:(e,t,n)=>{"use strict";var i=n(17854),r=n(19781),o=n(24019),a=n(68880),s=n(12248),l=n(47293),c=n(25787),u=n(99958),h=n(17466),d=n(57067),p=n(11179),f=n(79518),m=n(27674),g=n(8006).f,v=n(3070).f,y=n(21285),b=n(58003),_=n(29909),x=_.get,E=_.set,w="ArrayBuffer",S="DataView",A="Wrong index",M=i.ArrayBuffer,T=M,C=i.DataView,P=C&&C.prototype,L=Object.prototype,R=i.RangeError,D=p.pack,I=p.unpack,O=function(e){return[255&e]},N=function(e){return[255&e,e>>8&255]},k=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},F=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},U=function(e){return D(e,23,4)},B=function(e){return D(e,52,8)},V=function(e,t){v(e.prototype,t,{get:function(){return x(this)[t]}})},G=function(e,t,n,i){var r=d(n),o=x(e);if(r+t>o.byteLength)throw R(A);var a=x(o.buffer).bytes,s=r+o.byteOffset,l=a.slice(s,s+t);return i?l:l.reverse()},z=function(e,t,n,i,r,o){var a=d(n),s=x(e);if(a+t>s.byteLength)throw R(A);for(var l=x(s.buffer).bytes,c=a+s.byteOffset,u=i(+r),h=0;h<t;h++)l[c+h]=u[o?h:t-h-1]};if(o){if(!l((function(){M(1)}))||!l((function(){new M(-1)}))||l((function(){return new M,new M(1.5),new M(NaN),M.name!=w}))){for(var H,W=(T=function(e){return c(this,T),new M(d(e))}).prototype=M.prototype,j=g(M),q=0;j.length>q;)(H=j[q++])in T||a(T,H,M[H]);W.constructor=T}m&&f(P)!==L&&m(P,L);var X=new C(new T(2)),Y=P.setInt8;X.setInt8(0,2147483648),X.setInt8(1,2147483649),!X.getInt8(0)&&X.getInt8(1)||s(P,{setInt8:function(e,t){Y.call(this,e,t<<24>>24)},setUint8:function(e,t){Y.call(this,e,t<<24>>24)}},{unsafe:!0})}else T=function(e){c(this,T,w);var t=d(e);E(this,{bytes:y.call(new Array(t),0),byteLength:t}),r||(this.byteLength=t)},C=function(e,t,n){c(this,C,S),c(e,T,S);var i=x(e).byteLength,o=u(t);if(o<0||o>i)throw R("Wrong offset");if(o+(n=void 0===n?i-o:h(n))>i)throw R("Wrong length");E(this,{buffer:e,byteLength:n,byteOffset:o}),r||(this.buffer=e,this.byteLength=n,this.byteOffset=o)},r&&(V(T,"byteLength"),V(C,"buffer"),V(C,"byteLength"),V(C,"byteOffset")),s(C.prototype,{getInt8:function(e){return G(this,1,e)[0]<<24>>24},getUint8:function(e){return G(this,1,e)[0]},getInt16:function(e){var t=G(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=G(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return F(G(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return F(G(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return I(G(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return I(G(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){z(this,1,e,O,t)},setUint8:function(e,t){z(this,1,e,O,t)},setInt16:function(e,t){z(this,2,e,N,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){z(this,2,e,N,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){z(this,4,e,k,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){z(this,4,e,k,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){z(this,4,e,U,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){z(this,8,e,B,t,arguments.length>2?arguments[2]:void 0)}});b(T,w),b(C,S),e.exports={ArrayBuffer:T,DataView:C}},1048:(e,t,n)=>{"use strict";var i=n(47908),r=n(51400),o=n(17466),a=Math.min;e.exports=[].copyWithin||function(e,t){var n=i(this),s=o(n.length),l=r(e,s),c=r(t,s),u=arguments.length>2?arguments[2]:void 0,h=a((void 0===u?s:r(u,s))-c,s-l),d=1;for(c<l&&l<c+h&&(d=-1,c+=h-1,l+=h-1);h-- >0;)c in n?n[l]=n[c]:delete n[l],l+=d,c+=d;return n}},21285:(e,t,n)=>{"use strict";var i=n(47908),r=n(51400),o=n(17466);e.exports=function(e){for(var t=i(this),n=o(t.length),a=arguments.length,s=r(a>1?arguments[1]:void 0,n),l=a>2?arguments[2]:void 0,c=void 0===l?n:r(l,n);c>s;)t[s++]=e;return t}},18533:(e,t,n)=>{"use strict";var i=n(42092).forEach,r=n(9341),o=n(29207),a=r("forEach"),s=o("forEach");e.exports=a&&s?[].forEach:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}},48457:(e,t,n)=>{"use strict";var i=n(49974),r=n(47908),o=n(53411),a=n(97659),s=n(17466),l=n(86135),c=n(71246);e.exports=function(e){var t,n,u,h,d,p,f=r(e),m="function"==typeof this?this:Array,g=arguments.length,v=g>1?arguments[1]:void 0,y=void 0!==v,b=c(f),_=0;if(y&&(v=i(v,g>2?arguments[2]:void 0,2)),null==b||m==Array&&a(b))for(n=new m(t=s(f.length));t>_;_++)p=y?v(f[_],_):f[_],l(n,_,p);else for(d=(h=b.call(f)).next,n=new m;!(u=d.call(h)).done;_++)p=y?o(h,v,[u.value,_],!0):u.value,l(n,_,p);return n.length=_,n}},41318:(e,t,n)=>{var i=n(45656),r=n(17466),o=n(51400),a=function(e){return function(t,n,a){var s,l=i(t),c=r(l.length),u=o(a,c);if(e&&n!=n){for(;c>u;)if((s=l[u++])!=s)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},42092:(e,t,n)=>{var i=n(49974),r=n(68361),o=n(47908),a=n(17466),s=n(65417),l=[].push,c=function(e){var t=1==e,n=2==e,c=3==e,u=4==e,h=6==e,d=5==e||h;return function(p,f,m,g){for(var v,y,b=o(p),_=r(b),x=i(f,m,3),E=a(_.length),w=0,S=g||s,A=t?S(p,E):n?S(p,0):void 0;E>w;w++)if((d||w in _)&&(y=x(v=_[w],w,b),e))if(t)A[w]=y;else if(y)switch(e){case 3:return!0;case 5:return v;case 6:return w;case 2:l.call(A,v)}else if(u)return!1;return h?-1:c||u?u:A}};e.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6)}},86583:(e,t,n)=>{"use strict";var i=n(45656),r=n(99958),o=n(17466),a=n(9341),s=n(29207),l=Math.min,c=[].lastIndexOf,u=!!c&&1/[1].lastIndexOf(1,-0)<0,h=a("lastIndexOf"),d=s("indexOf",{ACCESSORS:!0,1:0}),p=u||!h||!d;e.exports=p?function(e){if(u)return c.apply(this,arguments)||0;var t=i(this),n=o(t.length),a=n-1;for(arguments.length>1&&(a=l(a,r(arguments[1]))),a<0&&(a=n+a);a>=0;a--)if(a in t&&t[a]===e)return a||0;return-1}:c},81194:(e,t,n)=>{var i=n(47293),r=n(5112),o=n(7392),a=r("species");e.exports=function(e){return o>=51||!i((function(){var t=[];return(t.constructor={})[a]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},9341:(e,t,n)=>{"use strict";var i=n(47293);e.exports=function(e,t){var n=[][e];return!!n&&i((function(){n.call(null,t||function(){throw 1},1)}))}},29207:(e,t,n)=>{var i=n(19781),r=n(47293),o=n(86656),a=Object.defineProperty,s={},l=function(e){throw e};e.exports=function(e,t){if(o(s,e))return s[e];t||(t={});var n=[][e],c=!!o(t,"ACCESSORS")&&t.ACCESSORS,u=o(t,0)?t[0]:l,h=o(t,1)?t[1]:void 0;return s[e]=!!n&&!r((function(){if(c&&!i)return!0;var e={length:-1};c?a(e,1,{enumerable:!0,get:l}):e[1]=1,n.call(e,u,h)}))}},53671:(e,t,n)=>{var i=n(13099),r=n(47908),o=n(68361),a=n(17466),s=function(e){return function(t,n,s,l){i(n);var c=r(t),u=o(c),h=a(c.length),d=e?h-1:0,p=e?-1:1;if(s<2)for(;;){if(d in u){l=u[d],d+=p;break}if(d+=p,e?d<0:h<=d)throw TypeError("Reduce of empty array with no initial value")}for(;e?d>=0:h>d;d+=p)d in u&&(l=n(l,u[d],d,c));return l}};e.exports={left:s(!1),right:s(!0)}},65417:(e,t,n)=>{var i=n(70111),r=n(43157),o=n(5112)("species");e.exports=function(e,t){var n;return r(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!r(n.prototype)?i(n)&&null===(n=n[o])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)}},53411:(e,t,n)=>{var i=n(19670);e.exports=function(e,t,n,r){try{return r?t(i(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&i(o.call(e)),t}}},17072:(e,t,n)=>{var i=n(5112)("iterator"),r=!1;try{var o=0,a={next:function(){return{done:!!o++}},return:function(){r=!0}};a[i]=function(){return this},Array.from(a,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!r)return!1;var n=!1;try{var o={};o[i]=function(){return{next:function(){return{done:n=!0}}}},e(o)}catch(e){}return n}},84326:e=>{var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},70648:(e,t,n)=>{var i=n(51694),r=n(84326),o=n(5112)("toStringTag"),a="Arguments"==r(function(){return arguments}());e.exports=i?r:function(e){var t,n,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?n:a?r(t):"Object"==(i=r(t))&&"function"==typeof t.callee?"Arguments":i}},31501:(e,t,n)=>{"use strict";var i=n(19670),r=n(13099);e.exports=function(){for(var e=i(this),t=r(e.add),n=0,o=arguments.length;n<o;n++)t.call(e,arguments[n]);return e}},34092:(e,t,n)=>{"use strict";var i=n(19670),r=n(13099);e.exports=function(){for(var e,t=i(this),n=r(t.delete),o=!0,a=0,s=arguments.length;a<s;a++)e=n.call(t,arguments[a]),o=o&&e;return!!o}},27296:(e,t,n)=>{"use strict";var i=n(13099),r=n(49974),o=n(20408);e.exports=function(e){var t,n,a,s,l=arguments.length,c=l>1?arguments[1]:void 0;return i(this),(t=void 0!==c)&&i(c),null==e?new this:(n=[],t?(a=0,s=r(c,l>2?arguments[2]:void 0,2),o(e,(function(e){n.push(s(e,a++))}))):o(e,n.push,n),new this(n))}},82044:e=>{"use strict";e.exports=function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}},95631:(e,t,n)=>{"use strict";var i=n(3070).f,r=n(70030),o=n(12248),a=n(49974),s=n(25787),l=n(20408),c=n(70654),u=n(96340),h=n(19781),d=n(62423).fastKey,p=n(29909),f=p.set,m=p.getterFor;e.exports={getConstructor:function(e,t,n,c){var u=e((function(e,i){s(e,u,t),f(e,{type:t,index:r(null),first:void 0,last:void 0,size:0}),h||(e.size=0),null!=i&&l(i,e[c],e,n)})),p=m(t),g=function(e,t,n){var i,r,o=p(e),a=v(e,t);return a?a.value=n:(o.last=a={index:r=d(t,!0),key:t,value:n,previous:i=o.last,next:void 0,removed:!1},o.first||(o.first=a),i&&(i.next=a),h?o.size++:e.size++,"F"!==r&&(o.index[r]=a)),e},v=function(e,t){var n,i=p(e),r=d(t);if("F"!==r)return i.index[r];for(n=i.first;n;n=n.next)if(n.key==t)return n};return o(u.prototype,{clear:function(){for(var e=p(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,h?e.size=0:this.size=0},delete:function(e){var t=this,n=p(t),i=v(t,e);if(i){var r=i.next,o=i.previous;delete n.index[i.index],i.removed=!0,o&&(o.next=r),r&&(r.previous=o),n.first==i&&(n.first=r),n.last==i&&(n.last=o),h?n.size--:t.size--}return!!i},forEach:function(e){for(var t,n=p(this),i=a(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:n.first;)for(i(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!v(this,e)}}),o(u.prototype,n?{get:function(e){var t=v(this,e);return t&&t.value},set:function(e,t){return g(this,0===e?0:e,t)}}:{add:function(e){return g(this,e=0===e?0:e,e)}}),h&&i(u.prototype,"size",{get:function(){return p(this).size}}),u},setStrong:function(e,t,n){var i=t+" Iterator",r=m(t),o=m(i);c(e,t,(function(e,t){f(this,{type:i,target:e,state:r(e),kind:t,last:void 0})}),(function(){for(var e=o(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),u(t)}}},29320:(e,t,n)=>{"use strict";var i=n(12248),r=n(62423).getWeakData,o=n(19670),a=n(70111),s=n(25787),l=n(20408),c=n(42092),u=n(86656),h=n(29909),d=h.set,p=h.getterFor,f=c.find,m=c.findIndex,g=0,v=function(e){return e.frozen||(e.frozen=new y)},y=function(){this.entries=[]},b=function(e,t){return f(e.entries,(function(e){return e[0]===t}))};y.prototype={get:function(e){var t=b(this,e);if(t)return t[1]},has:function(e){return!!b(this,e)},set:function(e,t){var n=b(this,e);n?n[1]=t:this.entries.push([e,t])},delete:function(e){var t=m(this.entries,(function(t){return t[0]===e}));return~t&&this.entries.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,c){var h=e((function(e,i){s(e,h,t),d(e,{type:t,id:g++,frozen:void 0}),null!=i&&l(i,e[c],e,n)})),f=p(t),m=function(e,t,n){var i=f(e),a=r(o(t),!0);return!0===a?v(i).set(t,n):a[i.id]=n,e};return i(h.prototype,{delete:function(e){var t=f(this);if(!a(e))return!1;var n=r(e);return!0===n?v(t).delete(e):n&&u(n,t.id)&&delete n[t.id]},has:function(e){var t=f(this);if(!a(e))return!1;var n=r(e);return!0===n?v(t).has(e):n&&u(n,t.id)}}),i(h.prototype,n?{get:function(e){var t=f(this);if(a(e)){var n=r(e);return!0===n?v(t).get(e):n?n[t.id]:void 0}},set:function(e,t){return m(this,e,t)}}:{add:function(e){return m(this,e,!0)}}),h}}},77710:(e,t,n)=>{"use strict";var i=n(82109),r=n(17854),o=n(54705),a=n(31320),s=n(62423),l=n(20408),c=n(25787),u=n(70111),h=n(47293),d=n(17072),p=n(58003),f=n(79587);e.exports=function(e,t,n){var m=-1!==e.indexOf("Map"),g=-1!==e.indexOf("Weak"),v=m?"set":"add",y=r[e],b=y&&y.prototype,_=y,x={},E=function(e){var t=b[e];a(b,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(g&&!u(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return g&&!u(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(g&&!u(e))&&t.call(this,0===e?0:e)}:function(e,n){return t.call(this,0===e?0:e,n),this})};if(o(e,"function"!=typeof y||!(g||b.forEach&&!h((function(){(new y).entries().next()})))))_=n.getConstructor(t,e,m,v),s.REQUIRED=!0;else if(o(e,!0)){var w=new _,S=w[v](g?{}:-0,1)!=w,A=h((function(){w.has(1)})),M=d((function(e){new y(e)})),T=!g&&h((function(){for(var e=new y,t=5;t--;)e[v](t,t);return!e.has(-0)}));M||((_=t((function(t,n){c(t,_,e);var i=f(new y,t,_);return null!=n&&l(n,i[v],i,m),i}))).prototype=b,b.constructor=_),(A||T)&&(E("delete"),E("has"),m&&E("get")),(T||S)&&E(v),g&&b.clear&&delete b.clear}return x[e]=_,i({global:!0,forced:_!=y},x),p(_,e),g||n.setStrong(_,e,m),_}},10313:(e,t,n)=>{var i=n(51532),r=n(4129),o=n(70030),a=n(70111),s=function(){this.object=null,this.symbol=null,this.primitives=null,this.objectsByIndex=o(null)};s.prototype.get=function(e,t){return this[e]||(this[e]=t())},s.prototype.next=function(e,t,n){var o=n?this.objectsByIndex[e]||(this.objectsByIndex[e]=new r):this.primitives||(this.primitives=new i),a=o.get(t);return a||o.set(t,a=new s),a};var l=new s;e.exports=function(){var e,t,n=l,i=arguments.length;for(e=0;e<i;e++)a(t=arguments[e])&&(n=n.next(e,t,!0));if(this===Object&&n===l)throw TypeError("Composite keys must contain a non-primitive component");for(e=0;e<i;e++)a(t=arguments[e])||(n=n.next(e,t,!1));return n}},99920:(e,t,n)=>{var i=n(86656),r=n(53887),o=n(31236),a=n(3070);e.exports=function(e,t){for(var n=r(t),s=a.f,l=o.f,c=0;c<n.length;c++){var u=n[c];i(e,u)||s(e,u,l(t,u))}}},84964:(e,t,n)=>{var i=n(5112)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[i]=!1,"/./"[e](t)}catch(e){}}return!1}},49920:(e,t,n)=>{var i=n(47293);e.exports=!i((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},14230:(e,t,n)=>{var i=n(84488),r=/"/g;e.exports=function(e,t,n,o){var a=String(i(e)),s="<"+t;return""!==n&&(s+=" "+n+'="'+String(o).replace(r,"&quot;")+'"'),s+">"+a+"</"+t+">"}},24994:(e,t,n)=>{"use strict";var i=n(13383).IteratorPrototype,r=n(70030),o=n(79114),a=n(58003),s=n(97497),l=function(){return this};e.exports=function(e,t,n){var c=t+" Iterator";return e.prototype=r(i,{next:o(1,n)}),a(e,c,!1,!0),s[c]=l,e}},68880:(e,t,n)=>{var i=n(19781),r=n(3070),o=n(79114);e.exports=i?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},79114:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},86135:(e,t,n)=>{"use strict";var i=n(57593),r=n(3070),o=n(79114);e.exports=function(e,t,n){var a=i(t);a in e?r.f(e,a,o(0,n)):e[a]=n}},38709:(e,t,n)=>{"use strict";var i=n(19670),r=n(57593);e.exports=function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return r(i(this),"number"!==e)}},70654:(e,t,n)=>{"use strict";var i=n(82109),r=n(24994),o=n(79518),a=n(27674),s=n(58003),l=n(68880),c=n(31320),u=n(5112),h=n(31913),d=n(97497),p=n(13383),f=p.IteratorPrototype,m=p.BUGGY_SAFARI_ITERATORS,g=u("iterator"),v="keys",y="values",b="entries",_=function(){return this};e.exports=function(e,t,n,u,p,x,E){r(n,t,u);var w,S,A,M=function(e){if(e===p&&R)return R;if(!m&&e in P)return P[e];switch(e){case v:case y:case b:return function(){return new n(this,e)}}return function(){return new n(this)}},T=t+" Iterator",C=!1,P=e.prototype,L=P[g]||P["@@iterator"]||p&&P[p],R=!m&&L||M(p),D="Array"==t&&P.entries||L;if(D&&(w=o(D.call(new e)),f!==Object.prototype&&w.next&&(h||o(w)===f||(a?a(w,f):"function"!=typeof w[g]&&l(w,g,_)),s(w,T,!0,!0),h&&(d[T]=_))),p==y&&L&&L.name!==y&&(C=!0,R=function(){return L.call(this)}),h&&!E||P[g]===R||l(P,g,R),d[t]=R,p)if(S={values:M(y),keys:x?R:M(v),entries:M(b)},E)for(A in S)(m||C||!(A in P))&&c(P,A,S[A]);else i({target:t,proto:!0,forced:m||C},S);return S}},97235:(e,t,n)=>{var i=n(40857),r=n(86656),o=n(6061),a=n(3070).f;e.exports=function(e){var t=i.Symbol||(i.Symbol={});r(t,e)||a(t,e,{value:o.f(e)})}},19781:(e,t,n)=>{var i=n(47293);e.exports=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},80317:(e,t,n)=>{var i=n(17854),r=n(70111),o=i.document,a=r(o)&&r(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},48324:e=>{e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},6833:(e,t,n)=>{var i=n(88113);e.exports=/(iphone|ipod|ipad).*applewebkit/i.test(i)},88113:(e,t,n)=>{var i=n(35005);e.exports=i("navigator","userAgent")||""},7392:(e,t,n)=>{var i,r,o=n(17854),a=n(88113),s=o.process,l=s&&s.versions,c=l&&l.v8;c?r=(i=c.split("."))[0]+i[1]:a&&(!(i=a.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=a.match(/Chrome\/(\d+)/))&&(r=i[1]),e.exports=r&&+r},80748:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},82109:(e,t,n)=>{var i=n(17854),r=n(31236).f,o=n(68880),a=n(31320),s=n(83505),l=n(99920),c=n(54705);e.exports=function(e,t){var n,u,h,d,p,f=e.target,m=e.global,g=e.stat;if(n=m?i:g?i[f]||s(f,{}):(i[f]||{}).prototype)for(u in t){if(d=t[u],h=e.noTargetGet?(p=r(n,u))&&p.value:n[u],!c(m?u:f+(g?".":"#")+u,e.forced)&&void 0!==h){if(typeof d==typeof h)continue;l(d,h)}(e.sham||h&&h.sham)&&o(d,"sham",!0),a(n,u,d,e)}}},47293:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},27007:(e,t,n)=>{"use strict";n(74916);var i=n(31320),r=n(47293),o=n(5112),a=n(22261),s=n(68880),l=o("species"),c=!r((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),u="$0"==="a".replace(/./,"$0"),h=o("replace"),d=!!/./[h]&&""===/./[h]("a","$0"),p=!r((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));e.exports=function(e,t,n,h){var f=o(e),m=!r((function(){var t={};return t[f]=function(){return 7},7!=""[e](t)})),g=m&&!r((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[l]=function(){return n},n.flags="",n[f]=/./[f]),n.exec=function(){return t=!0,null},n[f](""),!t}));if(!m||!g||"replace"===e&&(!c||!u||d)||"split"===e&&!p){var v=/./[f],y=n(f,""[e],(function(e,t,n,i,r){return t.exec===a?m&&!r?{done:!0,value:v.call(t,n,i)}:{done:!0,value:e.call(n,t,i)}:{done:!1}}),{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:d}),b=y[0],_=y[1];i(String.prototype,e,b),i(RegExp.prototype,f,2==t?function(e,t){return _.call(e,this,t)}:function(e){return _.call(e,this)})}h&&s(RegExp.prototype[f],"sham",!0)}},6790:(e,t,n)=>{"use strict";var i=n(43157),r=n(17466),o=n(49974),a=function(e,t,n,s,l,c,u,h){for(var d,p=l,f=0,m=!!u&&o(u,h,3);f<s;){if(f in n){if(d=m?m(n[f],f,t):n[f],c>0&&i(d))p=a(e,t,d,r(d.length),p,c-1)-1;else{if(p>=9007199254740991)throw TypeError("Exceed the acceptable array length");e[p]=d}p++}f++}return p};e.exports=a},76677:(e,t,n)=>{var i=n(47293);e.exports=!i((function(){return Object.isExtensible(Object.preventExtensions({}))}))},49974:(e,t,n)=>{var i=n(13099);e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)}}return function(){return e.apply(t,arguments)}}},27065:(e,t,n)=>{"use strict";var i=n(13099),r=n(70111),o=[].slice,a={},s=function(e,t,n){if(!(t in a)){for(var i=[],r=0;r<t;r++)i[r]="a["+r+"]";a[t]=Function("C,a","return new C("+i.join(",")+")")}return a[t](e,n)};e.exports=Function.bind||function(e){var t=i(this),n=o.call(arguments,1),a=function(){var i=n.concat(o.call(arguments));return this instanceof a?s(t,i.length,i):t.apply(e,i)};return r(t.prototype)&&(a.prototype=t.prototype),a}},35005:(e,t,n)=>{var i=n(40857),r=n(17854),o=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?o(i[e])||o(r[e]):i[e]&&i[e][t]||r[e]&&r[e][t]}},71246:(e,t,n)=>{var i=n(70648),r=n(97497),o=n(5112)("iterator");e.exports=function(e){if(null!=e)return e[o]||e["@@iterator"]||r[i(e)]}},18554:(e,t,n)=>{var i=n(19670),r=n(71246);e.exports=function(e){var t=r(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return i(t.call(e))}},54647:(e,t,n)=>{var i=n(31913),r=n(18554);e.exports=i?r:function(e){return Map.prototype.entries.call(e)}},96767:(e,t,n)=>{var i=n(31913),r=n(18554);e.exports=i?r:function(e){return Set.prototype.values.call(e)}},17854:(e,t,n)=>{var i=function(e){return e&&e.Math==Math&&e};e.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof n.g&&n.g)||Function("return this")()},86656:e=>{var t={}.hasOwnProperty;e.exports=function(e,n){return t.call(e,n)}},3501:e=>{e.exports={}},842:(e,t,n)=>{var i=n(17854);e.exports=function(e,t){var n=i.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}},60490:(e,t,n)=>{var i=n(35005);e.exports=i("document","documentElement")},64664:(e,t,n)=>{var i=n(19781),r=n(47293),o=n(80317);e.exports=!i&&!r((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},11179:e=>{var t=1/0,n=Math.abs,i=Math.pow,r=Math.floor,o=Math.log,a=Math.LN2;e.exports={pack:function(e,s,l){var c,u,h,d=new Array(l),p=8*l-s-1,f=(1<<p)-1,m=f>>1,g=23===s?i(2,-24)-i(2,-77):0,v=e<0||0===e&&1/e<0?1:0,y=0;for((e=n(e))!=e||e===t?(u=e!=e?1:0,c=f):(c=r(o(e)/a),e*(h=i(2,-c))<1&&(c--,h*=2),(e+=c+m>=1?g/h:g*i(2,1-m))*h>=2&&(c++,h/=2),c+m>=f?(u=0,c=f):c+m>=1?(u=(e*h-1)*i(2,s),c+=m):(u=e*i(2,m-1)*i(2,s),c=0));s>=8;d[y++]=255&u,u/=256,s-=8);for(c=c<<s|u,p+=s;p>0;d[y++]=255&c,c/=256,p-=8);return d[--y]|=128*v,d},unpack:function(e,n){var r,o=e.length,a=8*o-n-1,s=(1<<a)-1,l=s>>1,c=a-7,u=o-1,h=e[u--],d=127&h;for(h>>=7;c>0;d=256*d+e[u],u--,c-=8);for(r=d&(1<<-c)-1,d>>=-c,c+=n;c>0;r=256*r+e[u],u--,c-=8);if(0===d)d=1-l;else{if(d===s)return r?NaN:h?-1/0:t;r+=i(2,n),d-=l}return(h?-1:1)*r*i(2,d-n)}}},68361:(e,t,n)=>{var i=n(47293),r=n(84326),o="".split;e.exports=i((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==r(e)?o.call(e,""):Object(e)}:Object},79587:(e,t,n)=>{var i=n(70111),r=n(27674);e.exports=function(e,t,n){var o,a;return r&&"function"==typeof(o=t.constructor)&&o!==n&&i(a=o.prototype)&&a!==n.prototype&&r(e,a),e}},42788:(e,t,n)=>{var i=n(5465),r=Function.toString;"function"!=typeof i.inspectSource&&(i.inspectSource=function(e){return r.call(e)}),e.exports=i.inspectSource},62423:(e,t,n)=>{var i=n(3501),r=n(70111),o=n(86656),a=n(3070).f,s=n(69711),l=n(76677),c=s("meta"),u=0,h=Object.isExtensible||function(){return!0},d=function(e){a(e,c,{value:{objectID:"O"+ ++u,weakData:{}}})},p=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!r(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,c)){if(!h(e))return"F";if(!t)return"E";d(e)}return e[c].objectID},getWeakData:function(e,t){if(!o(e,c)){if(!h(e))return!0;if(!t)return!1;d(e)}return e[c].weakData},onFreeze:function(e){return l&&p.REQUIRED&&h(e)&&!o(e,c)&&d(e),e}};i[c]=!0},29909:(e,t,n)=>{var i,r,o,a=n(68536),s=n(17854),l=n(70111),c=n(68880),u=n(86656),h=n(6200),d=n(3501),p=s.WeakMap;if(a){var f=new p,m=f.get,g=f.has,v=f.set;i=function(e,t){return v.call(f,e,t),t},r=function(e){return m.call(f,e)||{}},o=function(e){return g.call(f,e)}}else{var y=h("state");d[y]=!0,i=function(e,t){return c(e,y,t),t},r=function(e){return u(e,y)?e[y]:{}},o=function(e){return u(e,y)}}e.exports={set:i,get:r,has:o,enforce:function(e){return o(e)?r(e):i(e,{})},getterFor:function(e){return function(t){var n;if(!l(t)||(n=r(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}}},97659:(e,t,n)=>{var i=n(5112),r=n(97497),o=i("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||a[o]===e)}},43157:(e,t,n)=>{var i=n(84326);e.exports=Array.isArray||function(e){return"Array"==i(e)}},54705:(e,t,n)=>{var i=n(47293),r=/#|\.prototype\./,o=function(e,t){var n=s[a(e)];return n==c||n!=l&&("function"==typeof t?i(t):!!t)},a=o.normalize=function(e){return String(e).replace(r,".").toLowerCase()},s=o.data={},l=o.NATIVE="N",c=o.POLYFILL="P";e.exports=o},18730:(e,t,n)=>{var i=n(70111),r=Math.floor;e.exports=function(e){return!i(e)&&isFinite(e)&&r(e)===e}},70111:e=>{e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},31913:e=>{e.exports=!1},47850:(e,t,n)=>{var i=n(70111),r=n(84326),o=n(5112)("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==r(e))}},20408:(e,t,n)=>{var i=n(19670),r=n(97659),o=n(17466),a=n(49974),s=n(71246),l=n(53411),c=function(e,t){this.stopped=e,this.result=t};(e.exports=function(e,t,n,u,h){var d,p,f,m,g,v,y,b=a(t,n,u?2:1);if(h)d=e;else{if("function"!=typeof(p=s(e)))throw TypeError("Target is not iterable");if(r(p)){for(f=0,m=o(e.length);m>f;f++)if((g=u?b(i(y=e[f])[0],y[1]):b(e[f]))&&g instanceof c)return g;return new c(!1)}d=p.call(e)}for(v=d.next;!(y=v.call(d)).done;)if("object"==typeof(g=l(d,b,y.value,u))&&g&&g instanceof c)return g;return new c(!1)}).stop=function(e){return new c(!0,e)}},13383:(e,t,n)=>{"use strict";var i,r,o,a=n(79518),s=n(68880),l=n(86656),c=n(5112),u=n(31913),h=c("iterator"),d=!1;[].keys&&("next"in(o=[].keys())?(r=a(a(o)))!==Object.prototype&&(i=r):d=!0),null==i&&(i={}),u||l(i,h)||s(i,h,(function(){return this})),e.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:d}},97497:e=>{e.exports={}},66736:e=>{var t=Math.expm1,n=Math.exp;e.exports=!t||t(10)>22025.465794806718||t(10)<22025.465794806718||-2e-17!=t(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:n(e)-1}:t},26130:(e,t,n)=>{var i=n(64310),r=Math.abs,o=Math.pow,a=o(2,-52),s=o(2,-23),l=o(2,127)*(2-s),c=o(2,-126);e.exports=Math.fround||function(e){var t,n,o=r(e),u=i(e);return o<c?u*(o/c/s+1/a-1/a)*c*s:(n=(t=(1+s/a)*o)-(t-o))>l||n!=n?u*(1/0):u*n}},26513:e=>{var t=Math.log;e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:t(1+e)}},47103:e=>{e.exports=Math.scale||function(e,t,n,i,r){return 0===arguments.length||e!=e||t!=t||n!=n||i!=i||r!=r?NaN:e===1/0||e===-1/0?e:(e-t)*(r-i)/(n-t)+i}},64310:e=>{e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},95948:(e,t,n)=>{var i,r,o,a,s,l,c,u,h=n(17854),d=n(31236).f,p=n(84326),f=n(20261).set,m=n(6833),g=h.MutationObserver||h.WebKitMutationObserver,v=h.process,y=h.Promise,b="process"==p(v),_=d(h,"queueMicrotask"),x=_&&_.value;x||(i=function(){var e,t;for(b&&(e=v.domain)&&e.exit();r;){t=r.fn,r=r.next;try{t()}catch(e){throw r?a():o=void 0,e}}o=void 0,e&&e.enter()},b?a=function(){v.nextTick(i)}:g&&!m?(s=!0,l=document.createTextNode(""),new g(i).observe(l,{characterData:!0}),a=function(){l.data=s=!s}):y&&y.resolve?(c=y.resolve(void 0),u=c.then,a=function(){u.call(c,i)}):a=function(){f.call(h,i)}),e.exports=x||function(e){var t={fn:e,next:void 0};o&&(o.next=t),r||(r=t,a()),o=t}},13366:(e,t,n)=>{var i=n(17854);e.exports=i.Promise},30133:(e,t,n)=>{var i=n(47293);e.exports=!!Object.getOwnPropertySymbols&&!i((function(){return!String(Symbol())}))},590:(e,t,n)=>{var i=n(47293),r=n(5112),o=n(31913),a=r("iterator");e.exports=!i((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,i){t.delete("b"),n+=i+e})),o&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[a]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://").host||"#%D0%B1"!==new URL("http://a#").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host}))},68536:(e,t,n)=>{var i=n(17854),r=n(42788),o=i.WeakMap;e.exports="function"==typeof o&&/native code/.test(r(o))},78523:(e,t,n)=>{"use strict";var i=n(13099),r=function(e){var t,n;this.promise=new e((function(e,i){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=i})),this.resolve=i(t),this.reject=i(n)};e.exports.f=function(e){return new r(e)}},3929:(e,t,n)=>{var i=n(47850);e.exports=function(e){if(i(e))throw TypeError("The method doesn't accept regular expressions");return e}},77023:(e,t,n)=>{var i=n(17854).isFinite;e.exports=Number.isFinite||function(e){return"number"==typeof e&&i(e)}},2814:(e,t,n)=>{var i=n(17854),r=n(53111).trim,o=n(81361),a=i.parseFloat,s=1/a(o+"-0")!=-1/0;e.exports=s?function(e){var t=r(String(e)),n=a(t);return 0===n&&"-"==t.charAt(0)?-0:n}:a},83009:(e,t,n)=>{var i=n(17854),r=n(53111).trim,o=n(81361),a=i.parseInt,s=/^[+-]?0[Xx]/,l=8!==a(o+"08")||22!==a(o+"0x16");e.exports=l?function(e,t){var n=r(String(e));return a(n,t>>>0||(s.test(n)?16:10))}:a},21574:(e,t,n)=>{"use strict";var i=n(19781),r=n(47293),o=n(81956),a=n(25181),s=n(55296),l=n(47908),c=n(68361),u=Object.assign,h=Object.defineProperty;e.exports=!u||r((function(){if(i&&1!==u({b:1},u(h({},"a",{enumerable:!0,get:function(){h(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=u({},e)[n]||o(u({},t)).join("")!=r}))?function(e,t){for(var n=l(e),r=arguments.length,u=1,h=a.f,d=s.f;r>u;)for(var p,f=c(arguments[u++]),m=h?o(f).concat(h(f)):o(f),g=m.length,v=0;g>v;)p=m[v++],i&&!d.call(f,p)||(n[p]=f[p]);return n}:u},70030:(e,t,n)=>{var i,r=n(19670),o=n(36048),a=n(80748),s=n(3501),l=n(60490),c=n(80317),u=n(6200),h=u("IE_PROTO"),d=function(){},p=function(e){return"<script>"+e+"</"+"script>"},f=function(){try{i=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;f=i?function(e){e.write(p("")),e.close();var t=e.parentWindow.Object;return e=null,t}(i):((t=c("iframe")).style.display="none",l.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(p("document.F=Object")),e.close(),e.F);for(var n=a.length;n--;)delete f.prototype[a[n]];return f()};s[h]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(d.prototype=r(e),n=new d,d.prototype=null,n[h]=e):n=f(),void 0===t?n:o(n,t)}},36048:(e,t,n)=>{var i=n(19781),r=n(3070),o=n(19670),a=n(81956);e.exports=i?Object.defineProperties:function(e,t){o(e);for(var n,i=a(t),s=i.length,l=0;s>l;)r.f(e,n=i[l++],t[n]);return e}},3070:(e,t,n)=>{var i=n(19781),r=n(64664),o=n(19670),a=n(57593),s=Object.defineProperty;t.f=i?s:function(e,t,n){if(o(e),t=a(t,!0),o(n),r)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},31236:(e,t,n)=>{var i=n(19781),r=n(55296),o=n(79114),a=n(45656),s=n(57593),l=n(86656),c=n(64664),u=Object.getOwnPropertyDescriptor;t.f=i?u:function(e,t){if(e=a(e),t=s(t,!0),c)try{return u(e,t)}catch(e){}if(l(e,t))return o(!r.f.call(e,t),e[t])}},1156:(e,t,n)=>{var i=n(45656),r=n(8006).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return r(e)}catch(e){return a.slice()}}(e):r(i(e))}},8006:(e,t,n)=>{var i=n(16324),r=n(80748).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,r)}},25181:(e,t)=>{t.f=Object.getOwnPropertySymbols},79518:(e,t,n)=>{var i=n(86656),r=n(47908),o=n(6200),a=n(49920),s=o("IE_PROTO"),l=Object.prototype;e.exports=a?Object.getPrototypeOf:function(e){return e=r(e),i(e,s)?e[s]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?l:null}},16324:(e,t,n)=>{var i=n(86656),r=n(45656),o=n(41318).indexOf,a=n(3501);e.exports=function(e,t){var n,s=r(e),l=0,c=[];for(n in s)!i(a,n)&&i(s,n)&&c.push(n);for(;t.length>l;)i(s,n=t[l++])&&(~o(c,n)||c.push(n));return c}},81956:(e,t,n)=>{var i=n(16324),r=n(80748);e.exports=Object.keys||function(e){return i(e,r)}},55296:(e,t)=>{"use strict";var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,r=i&&!n.call({1:2},1);t.f=r?function(e){var t=i(this,e);return!!t&&t.enumerable}:n},69026:(e,t,n)=>{"use strict";var i=n(31913),r=n(17854),o=n(47293);e.exports=i||!o((function(){var e=Math.random();__defineSetter__.call(null,e,(function(){})),delete r[e]}))},27674:(e,t,n)=>{var i=n(19670),r=n(96077);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(e){}return function(n,o){return i(n),r(o),t?e.call(n,o):n.__proto__=o,n}}():void 0)},44699:(e,t,n)=>{var i=n(19781),r=n(81956),o=n(45656),a=n(55296).f,s=function(e){return function(t){for(var n,s=o(t),l=r(s),c=l.length,u=0,h=[];c>u;)n=l[u++],i&&!a.call(s,n)||h.push(e?[n,s[n]]:s[n]);return h}};e.exports={entries:s(!0),values:s(!1)}},90288:(e,t,n)=>{"use strict";var i=n(51694),r=n(70648);e.exports=i?{}.toString:function(){return"[object "+r(this)+"]"}},53887:(e,t,n)=>{var i=n(35005),r=n(8006),o=n(25181),a=n(19670);e.exports=i("Reflect","ownKeys")||function(e){var t=r.f(a(e)),n=o.f;return n?t.concat(n(e)):t}},40857:(e,t,n)=>{var i=n(17854);e.exports=i},12534:e=>{e.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},69478:(e,t,n)=>{var i=n(19670),r=n(70111),o=n(78523);e.exports=function(e,t){if(i(e),r(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},12248:(e,t,n)=>{var i=n(31320);e.exports=function(e,t,n){for(var r in t)i(e,r,t[r],n);return e}},31320:(e,t,n)=>{var i=n(17854),r=n(68880),o=n(86656),a=n(83505),s=n(42788),l=n(29909),c=l.get,u=l.enforce,h=String(String).split("String");(e.exports=function(e,t,n,s){var l=!!s&&!!s.unsafe,c=!!s&&!!s.enumerable,d=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof t||o(n,"name")||r(n,"name",t),u(n).source=h.join("string"==typeof t?t:"")),e!==i?(l?!d&&e[t]&&(c=!0):delete e[t],c?e[t]=n:r(e,t,n)):c?e[t]=n:a(t,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&c(this).source||s(this)}))},38845:(e,t,n)=>{var i=n(51532),r=n(4129),o=n(72309)("metadata"),a=o.store||(o.store=new r),s=function(e,t,n){var r=a.get(e);if(!r){if(!n)return;a.set(e,r=new i)}var o=r.get(t);if(!o){if(!n)return;r.set(t,o=new i)}return o};e.exports={store:a,getMap:s,has:function(e,t,n){var i=s(t,n,!1);return void 0!==i&&i.has(e)},get:function(e,t,n){var i=s(t,n,!1);return void 0===i?void 0:i.get(e)},set:function(e,t,n,i){s(n,i,!0).set(e,t)},keys:function(e,t){var n=s(e,t,!1),i=[];return n&&n.forEach((function(e,t){i.push(t)})),i},toKey:function(e){return void 0===e||"symbol"==typeof e?e:String(e)}}},97651:(e,t,n)=>{var i=n(84326),r=n(22261);e.exports=function(e,t){var n=e.exec;if("function"==typeof n){var o=n.call(e,t);if("object"!=typeof o)throw TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==i(e))throw TypeError("RegExp#exec called on incompatible receiver");return r.call(e,t)}},22261:(e,t,n)=>{"use strict";var i,r,o=n(67066),a=n(52999),s=RegExp.prototype.exec,l=String.prototype.replace,c=s,u=(i=/a/,r=/b*/g,s.call(i,"a"),s.call(r,"a"),0!==i.lastIndex||0!==r.lastIndex),h=a.UNSUPPORTED_Y||a.BROKEN_CARET,d=void 0!==/()??/.exec("")[1];(u||d||h)&&(c=function(e){var t,n,i,r,a=this,c=h&&a.sticky,p=o.call(a),f=a.source,m=0,g=e;return c&&(-1===(p=p.replace("y","")).indexOf("g")&&(p+="g"),g=String(e).slice(a.lastIndex),a.lastIndex>0&&(!a.multiline||a.multiline&&"\n"!==e[a.lastIndex-1])&&(f="(?: "+f+")",g=" "+g,m++),n=new RegExp("^(?:"+f+")",p)),d&&(n=new RegExp("^"+f+"$(?!\\s)",p)),u&&(t=a.lastIndex),i=s.call(c?n:a,g),c?i?(i.input=i.input.slice(m),i[0]=i[0].slice(m),i.index=a.lastIndex,a.lastIndex+=i[0].length):a.lastIndex=0:u&&i&&(a.lastIndex=a.global?i.index+i[0].length:t),d&&i&&i.length>1&&l.call(i[0],n,(function(){for(r=1;r<arguments.length-2;r++)void 0===arguments[r]&&(i[r]=void 0)})),i}),e.exports=c},67066:(e,t,n)=>{"use strict";var i=n(19670);e.exports=function(){var e=i(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},52999:(e,t,n)=>{"use strict";var i=n(47293);function r(e,t){return RegExp(e,t)}t.UNSUPPORTED_Y=i((function(){var e=r("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=i((function(){var e=r("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},84488:e=>{e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},46465:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},81150:e=>{e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},83505:(e,t,n)=>{var i=n(17854),r=n(68880);e.exports=function(e,t){try{r(i,e,t)}catch(n){i[e]=t}return t}},96340:(e,t,n)=>{"use strict";var i=n(35005),r=n(3070),o=n(5112),a=n(19781),s=o("species");e.exports=function(e){var t=i(e),n=r.f;a&&t&&!t[s]&&n(t,s,{configurable:!0,get:function(){return this}})}},58003:(e,t,n)=>{var i=n(3070).f,r=n(86656),o=n(5112)("toStringTag");e.exports=function(e,t,n){e&&!r(e=n?e:e.prototype,o)&&i(e,o,{configurable:!0,value:t})}},6200:(e,t,n)=>{var i=n(72309),r=n(69711),o=i("keys");e.exports=function(e){return o[e]||(o[e]=r(e))}},5465:(e,t,n)=>{var i=n(17854),r=n(83505),o="__core-js_shared__",a=i[o]||r(o,{});e.exports=a},72309:(e,t,n)=>{var i=n(31913),r=n(5465);(e.exports=function(e,t){return r[e]||(r[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.5",mode:i?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},36707:(e,t,n)=>{var i=n(19670),r=n(13099),o=n(5112)("species");e.exports=function(e,t){var n,a=i(e).constructor;return void 0===a||null==(n=i(a)[o])?t:r(n)}},43429:(e,t,n)=>{var i=n(47293);e.exports=function(e){return i((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))}},28710:(e,t,n)=>{var i=n(99958),r=n(84488),o=function(e){return function(t,n){var o,a,s=String(r(t)),l=i(n),c=s.length;return l<0||l>=c?e?"":void 0:(o=s.charCodeAt(l))<55296||o>56319||l+1===c||(a=s.charCodeAt(l+1))<56320||a>57343?e?s.charAt(l):o:e?s.slice(l,l+2):a-56320+(o-55296<<10)+65536}};e.exports={codeAt:o(!1),charAt:o(!0)}},54986:(e,t,n)=>{var i=n(88113);e.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(i)},76650:(e,t,n)=>{var i=n(17466),r=n(38415),o=n(84488),a=Math.ceil,s=function(e){return function(t,n,s){var l,c,u=String(o(t)),h=u.length,d=void 0===s?" ":String(s),p=i(n);return p<=h||""==d?u:(l=p-h,(c=r.call(d,a(l/d.length))).length>l&&(c=c.slice(0,l)),e?u+c:c+u)}};e.exports={start:s(!1),end:s(!0)}},33197:e=>{"use strict";var t=2147483647,n=/[^\0-\u007E]/,i=/[.\u3002\uFF0E\uFF61]/g,r="Overflow: input needs wider integers to process",o=Math.floor,a=String.fromCharCode,s=function(e){return e+22+75*(e<26)},l=function(e,t,n){var i=0;for(e=n?o(e/700):e>>1,e+=o(e/t);e>455;i+=36)e=o(e/35);return o(i+36*e/(e+38))},c=function(e){var n=[];e=function(e){for(var t=[],n=0,i=e.length;n<i;){var r=e.charCodeAt(n++);if(r>=55296&&r<=56319&&n<i){var o=e.charCodeAt(n++);56320==(64512&o)?t.push(((1023&r)<<10)+(1023&o)+65536):(t.push(r),n--)}else t.push(r)}return t}(e);var i,c,u=e.length,h=128,d=0,p=72;for(i=0;i<e.length;i++)(c=e[i])<128&&n.push(a(c));var f=n.length,m=f;for(f&&n.push("-");m<u;){var g=t;for(i=0;i<e.length;i++)(c=e[i])>=h&&c<g&&(g=c);var v=m+1;if(g-h>o((t-d)/v))throw RangeError(r);for(d+=(g-h)*v,h=g,i=0;i<e.length;i++){if((c=e[i])<h&&++d>t)throw RangeError(r);if(c==h){for(var y=d,b=36;;b+=36){var _=b<=p?1:b>=p+26?26:b-p;if(y<_)break;var x=y-_,E=36-_;n.push(a(s(_+x%E))),y=o(x/E)}n.push(a(s(y))),p=l(d,v,m==f),d=0,++m}}++d,++h}return n.join("")};e.exports=function(e){var t,r,o=[],a=e.toLowerCase().replace(i,".").split(".");for(t=0;t<a.length;t++)r=a[t],o.push(n.test(r)?"xn--"+c(r):r);return o.join(".")}},38415:(e,t,n)=>{"use strict";var i=n(99958),r=n(84488);e.exports="".repeat||function(e){var t=String(r(this)),n="",o=i(e);if(o<0||o==1/0)throw RangeError("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(n+=t);return n}},76091:(e,t,n)=>{var i=n(47293),r=n(81361);e.exports=function(e){return i((function(){return!!r[e]()||""!=""[e]()||r[e].name!==e}))}},53111:(e,t,n)=>{var i=n(84488),r="["+n(81361)+"]",o=RegExp("^"+r+r+"*"),a=RegExp(r+r+"*$"),s=function(e){return function(t){var n=String(i(t));return 1&e&&(n=n.replace(o,"")),2&e&&(n=n.replace(a,"")),n}};e.exports={start:s(1),end:s(2),trim:s(3)}},20261:(e,t,n)=>{var i,r,o,a=n(17854),s=n(47293),l=n(84326),c=n(49974),u=n(60490),h=n(80317),d=n(6833),p=a.location,f=a.setImmediate,m=a.clearImmediate,g=a.process,v=a.MessageChannel,y=a.Dispatch,b=0,_={},x="onreadystatechange",E=function(e){if(_.hasOwnProperty(e)){var t=_[e];delete _[e],t()}},w=function(e){return function(){E(e)}},S=function(e){E(e.data)},A=function(e){a.postMessage(e+"",p.protocol+"//"+p.host)};f&&m||(f=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return _[++b]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},i(b),b},m=function(e){delete _[e]},"process"==l(g)?i=function(e){g.nextTick(w(e))}:y&&y.now?i=function(e){y.now(w(e))}:v&&!d?(o=(r=new v).port2,r.port1.onmessage=S,i=c(o.postMessage,o,1)):!a.addEventListener||"function"!=typeof postMessage||a.importScripts||s(A)||"file:"===p.protocol?i=x in h("script")?function(e){u.appendChild(h("script")).onreadystatechange=function(){u.removeChild(this),E(e)}}:function(e){setTimeout(w(e),0)}:(i=A,a.addEventListener("message",S,!1))),e.exports={set:f,clear:m}},50863:(e,t,n)=>{var i=n(84326);e.exports=function(e){if("number"!=typeof e&&"Number"!=i(e))throw TypeError("Incorrect invocation");return+e}},51400:(e,t,n)=>{var i=n(99958),r=Math.max,o=Math.min;e.exports=function(e,t){var n=i(e);return n<0?r(n+t,0):o(n,t)}},57067:(e,t,n)=>{var i=n(99958),r=n(17466);e.exports=function(e){if(void 0===e)return 0;var t=i(e),n=r(t);if(t!==n)throw RangeError("Wrong length or index");return n}},45656:(e,t,n)=>{var i=n(68361),r=n(84488);e.exports=function(e){return i(r(e))}},99958:e=>{var t=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:t)(e)}},17466:(e,t,n)=>{var i=n(99958),r=Math.min;e.exports=function(e){return e>0?r(i(e),9007199254740991):0}},47908:(e,t,n)=>{var i=n(84488);e.exports=function(e){return Object(i(e))}},84590:(e,t,n)=>{var i=n(73002);e.exports=function(e,t){var n=i(e);if(n%t)throw RangeError("Wrong offset");return n}},73002:(e,t,n)=>{var i=n(99958);e.exports=function(e){var t=i(e);if(t<0)throw RangeError("The argument can't be less than 0");return t}},57593:(e,t,n)=>{var i=n(70111);e.exports=function(e,t){if(!i(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!i(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},51694:(e,t,n)=>{var i={};i[n(5112)("toStringTag")]="z",e.exports="[object z]"===String(i)},19843:(e,t,n)=>{"use strict";var i=n(82109),r=n(17854),o=n(19781),a=n(63832),s=n(90260),l=n(13331),c=n(25787),u=n(79114),h=n(68880),d=n(17466),p=n(57067),f=n(84590),m=n(57593),g=n(86656),v=n(70648),y=n(70111),b=n(70030),_=n(27674),x=n(8006).f,E=n(97321),w=n(42092).forEach,S=n(96340),A=n(3070),M=n(31236),T=n(29909),C=n(79587),P=T.get,L=T.set,R=A.f,D=M.f,I=Math.round,O=r.RangeError,N=l.ArrayBuffer,k=l.DataView,F=s.NATIVE_ARRAY_BUFFER_VIEWS,U=s.TYPED_ARRAY_TAG,B=s.TypedArray,V=s.TypedArrayPrototype,G=s.aTypedArrayConstructor,z=s.isTypedArray,H="BYTES_PER_ELEMENT",W="Wrong length",j=function(e,t){for(var n=0,i=t.length,r=new(G(e))(i);i>n;)r[n]=t[n++];return r},q=function(e,t){R(e,t,{get:function(){return P(this)[t]}})},X=function(e){var t;return e instanceof N||"ArrayBuffer"==(t=v(e))||"SharedArrayBuffer"==t},Y=function(e,t){return z(e)&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},K=function(e,t){return Y(e,t=m(t,!0))?u(2,e[t]):D(e,t)},Z=function(e,t,n){return!(Y(e,t=m(t,!0))&&y(n)&&g(n,"value"))||g(n,"get")||g(n,"set")||n.configurable||g(n,"writable")&&!n.writable||g(n,"enumerable")&&!n.enumerable?R(e,t,n):(e[t]=n.value,e)};o?(F||(M.f=K,A.f=Z,q(V,"buffer"),q(V,"byteOffset"),q(V,"byteLength"),q(V,"length")),i({target:"Object",stat:!0,forced:!F},{getOwnPropertyDescriptor:K,defineProperty:Z}),e.exports=function(e,t,n){var o=e.match(/\d+$/)[0]/8,s=e+(n?"Clamped":"")+"Array",l="get"+e,u="set"+e,m=r[s],g=m,v=g&&g.prototype,A={},M=function(e,t){R(e,t,{get:function(){return function(e,t){var n=P(e);return n.view[l](t*o+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,i){var r=P(e);n&&(i=(i=I(i))<0?0:i>255?255:255&i),r.view[u](t*o+r.byteOffset,i,!0)}(this,t,e)},enumerable:!0})};F?a&&(g=t((function(e,t,n,i){return c(e,g,s),C(y(t)?X(t)?void 0!==i?new m(t,f(n,o),i):void 0!==n?new m(t,f(n,o)):new m(t):z(t)?j(g,t):E.call(g,t):new m(p(t)),e,g)})),_&&_(g,B),w(x(m),(function(e){e in g||h(g,e,m[e])})),g.prototype=v):(g=t((function(e,t,n,i){c(e,g,s);var r,a,l,u=0,h=0;if(y(t)){if(!X(t))return z(t)?j(g,t):E.call(g,t);r=t,h=f(n,o);var m=t.byteLength;if(void 0===i){if(m%o)throw O(W);if((a=m-h)<0)throw O(W)}else if((a=d(i)*o)+h>m)throw O(W);l=a/o}else l=p(t),r=new N(a=l*o);for(L(e,{buffer:r,byteOffset:h,byteLength:a,length:l,view:new k(r)});u<l;)M(e,u++)})),_&&_(g,B),v=g.prototype=b(V)),v.constructor!==g&&h(v,"constructor",g),U&&h(v,U,s),A[s]=g,i({global:!0,forced:g!=m,sham:!F},A),H in g||h(g,H,o),H in v||h(v,H,o),S(s)}):e.exports=function(){}},63832:(e,t,n)=>{var i=n(17854),r=n(47293),o=n(17072),a=n(90260).NATIVE_ARRAY_BUFFER_VIEWS,s=i.ArrayBuffer,l=i.Int8Array;e.exports=!a||!r((function(){l(1)}))||!r((function(){new l(-1)}))||!o((function(e){new l,new l(null),new l(1.5),new l(e)}),!0)||r((function(){return 1!==new l(new s(2),1,void 0).length}))},97321:(e,t,n)=>{var i=n(47908),r=n(17466),o=n(71246),a=n(97659),s=n(49974),l=n(90260).aTypedArrayConstructor;e.exports=function(e){var t,n,c,u,h,d,p=i(e),f=arguments.length,m=f>1?arguments[1]:void 0,g=void 0!==m,v=o(p);if(null!=v&&!a(v))for(d=(h=v.call(p)).next,p=[];!(u=d.call(h)).done;)p.push(u.value);for(g&&f>2&&(m=s(m,arguments[2],2)),n=r(p.length),c=new(l(this))(n),t=0;n>t;t++)c[t]=g?m(p[t],t):p[t];return c}},69711:e=>{var t=0,n=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++t+n).toString(36)}},43307:(e,t,n)=>{var i=n(30133);e.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},6061:(e,t,n)=>{var i=n(5112);t.f=i},5112:(e,t,n)=>{var i=n(17854),r=n(72309),o=n(86656),a=n(69711),s=n(30133),l=n(43307),c=r("wks"),u=i.Symbol,h=l?u:u&&u.withoutSetter||a;e.exports=function(e){return o(c,e)||(s&&o(u,e)?c[e]=u[e]:c[e]=h("Symbol."+e)),c[e]}},81361:e=>{e.exports="\t\n\v\f\r \u2028\u2029\ufeff"},18264:(e,t,n)=>{"use strict";var i=n(82109),r=n(17854),o=n(13331),a=n(96340),s="ArrayBuffer",l=o.ArrayBuffer;i({global:!0,forced:r.ArrayBuffer!==l},{ArrayBuffer:l}),a(s)},92222:(e,t,n)=>{"use strict";var i=n(82109),r=n(47293),o=n(43157),a=n(70111),s=n(47908),l=n(17466),c=n(86135),u=n(65417),h=n(81194),d=n(5112),p=n(7392),f=d("isConcatSpreadable"),m=9007199254740991,g="Maximum allowed index exceeded",v=p>=51||!r((function(){var e=[];return e[f]=!1,e.concat()[0]!==e})),y=h("concat"),b=function(e){if(!a(e))return!1;var t=e[f];return void 0!==t?!!t:o(e)};i({target:"Array",proto:!0,forced:!v||!y},{concat:function(e){var t,n,i,r,o,a=s(this),h=u(a,0),d=0;for(t=-1,i=arguments.length;t<i;t++)if(b(o=-1===t?a:arguments[t])){if(d+(r=l(o.length))>m)throw TypeError(g);for(n=0;n<r;n++,d++)n in o&&c(h,d,o[n])}else{if(d>=m)throw TypeError(g);c(h,d++,o)}return h.length=d,h}})},50545:(e,t,n)=>{var i=n(82109),r=n(1048),o=n(51223);i({target:"Array",proto:!0},{copyWithin:r}),o("copyWithin")},26541:(e,t,n)=>{"use strict";var i=n(82109),r=n(42092).every,o=n(9341),a=n(29207),s=o("every"),l=a("every");i({target:"Array",proto:!0,forced:!s||!l},{every:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},43290:(e,t,n)=>{var i=n(82109),r=n(21285),o=n(51223);i({target:"Array",proto:!0},{fill:r}),o("fill")},57327:(e,t,n)=>{"use strict";var i=n(82109),r=n(42092).filter,o=n(81194),a=n(29207),s=o("filter"),l=a("filter");i({target:"Array",proto:!0,forced:!s||!l},{filter:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},34553:(e,t,n)=>{"use strict";var i=n(82109),r=n(42092).findIndex,o=n(51223),a=n(29207),s="findIndex",l=!0,c=a(s);s in[]&&Array(1).findIndex((function(){l=!1})),i({target:"Array",proto:!0,forced:l||!c},{findIndex:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),o(s)},69826:(e,t,n)=>{"use strict";var i=n(82109),r=n(42092).find,o=n(51223),a=n(29207),s="find",l=!0,c=a(s);s in[]&&Array(1).find((function(){l=!1})),i({target:"Array",proto:!0,forced:l||!c},{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),o(s)},86535:(e,t,n)=>{"use strict";var i=n(82109),r=n(6790),o=n(47908),a=n(17466),s=n(13099),l=n(65417);i({target:"Array",proto:!0},{flatMap:function(e){var t,n=o(this),i=a(n.length);return s(e),(t=l(n,0)).length=r(t,n,n,i,0,1,e,arguments.length>1?arguments[1]:void 0),t}})},84944:(e,t,n)=>{"use strict";var i=n(82109),r=n(6790),o=n(47908),a=n(17466),s=n(99958),l=n(65417);i({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=o(this),n=a(t.length),i=l(t,0);return i.length=r(i,t,t,n,0,void 0===e?1:s(e)),i}})},89554:(e,t,n)=>{"use strict";var i=n(82109),r=n(18533);i({target:"Array",proto:!0,forced:[].forEach!=r},{forEach:r})},91038:(e,t,n)=>{var i=n(82109),r=n(48457);i({target:"Array",stat:!0,forced:!n(17072)((function(e){Array.from(e)}))},{from:r})},26699:(e,t,n)=>{"use strict";var i=n(82109),r=n(41318).includes,o=n(51223);i({target:"Array",proto:!0,forced:!n(29207)("indexOf",{ACCESSORS:!0,1:0})},{includes:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),o("includes")},82772:(e,t,n)=>{"use strict";var i=n(82109),r=n(41318).indexOf,o=n(9341),a=n(29207),s=[].indexOf,l=!!s&&1/[1].indexOf(1,-0)<0,c=o("indexOf"),u=a("indexOf",{ACCESSORS:!0,1:0});i({target:"Array",proto:!0,forced:l||!c||!u},{indexOf:function(e){return l?s.apply(this,arguments)||0:r(this,e,arguments.length>1?arguments[1]:void 0)}})},66992:(e,t,n)=>{"use strict";var i=n(45656),r=n(51223),o=n(97497),a=n(29909),s=n(70654),l="Array Iterator",c=a.set,u=a.getterFor(l);e.exports=s(Array,"Array",(function(e,t){c(this,{type:l,target:i(e),index:0,kind:t})}),(function(){var e=u(this),t=e.target,n=e.kind,i=e.index++;return!t||i>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:i,done:!1}:"values"==n?{value:t[i],done:!1}:{value:[i,t[i]],done:!1}}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},69600:(e,t,n)=>{"use strict";var i=n(82109),r=n(68361),o=n(45656),a=n(9341),s=[].join,l=r!=Object,c=a("join",",");i({target:"Array",proto:!0,forced:l||!c},{join:function(e){return s.call(o(this),void 0===e?",":e)}})},94986:(e,t,n)=>{var i=n(82109),r=n(86583);i({target:"Array",proto:!0,forced:r!==[].lastIndexOf},{lastIndexOf:r})},21249:(e,t,n)=>{"use strict";var i=n(82109),r=n(42092).map,o=n(81194),a=n(29207),s=o("map"),l=a("map");i({target:"Array",proto:!0,forced:!s||!l},{map:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},26572:(e,t,n)=>{"use strict";var i=n(82109),r=n(47293),o=n(86135);i({target:"Array",stat:!0,forced:r((function(){function e(){}return!(Array.of.call(e)instanceof e)}))},{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);t>e;)o(n,e,arguments[e++]);return n.length=t,n}})},96644:(e,t,n)=>{"use strict";var i=n(82109),r=n(53671).right,o=n(9341),a=n(29207),s=o("reduceRight"),l=a("reduce",{1:0});i({target:"Array",proto:!0,forced:!s||!l},{reduceRight:function(e){return r(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},85827:(e,t,n)=>{"use strict";var i=n(82109),r=n(53671).left,o=n(9341),a=n(29207),s=o("reduce"),l=a("reduce",{1:0});i({target:"Array",proto:!0,forced:!s||!l},{reduce:function(e){return r(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},47042:(e,t,n)=>{"use strict";var i=n(82109),r=n(70111),o=n(43157),a=n(51400),s=n(17466),l=n(45656),c=n(86135),u=n(5112),h=n(81194),d=n(29207),p=h("slice"),f=d("slice",{ACCESSORS:!0,0:0,1:2}),m=u("species"),g=[].slice,v=Math.max;i({target:"Array",proto:!0,forced:!p||!f},{slice:function(e,t){var n,i,u,h=l(this),d=s(h.length),p=a(e,d),f=a(void 0===t?d:t,d);if(o(h)&&("function"!=typeof(n=h.constructor)||n!==Array&&!o(n.prototype)?r(n)&&null===(n=n[m])&&(n=void 0):n=void 0,n===Array||void 0===n))return g.call(h,p,f);for(i=new(void 0===n?Array:n)(v(f-p,0)),u=0;p<f;p++,u++)p in h&&c(i,u,h[p]);return i.length=u,i}})},5212:(e,t,n)=>{"use strict";var i=n(82109),r=n(42092).some,o=n(9341),a=n(29207),s=o("some"),l=a("some");i({target:"Array",proto:!0,forced:!s||!l},{some:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},2707:(e,t,n)=>{"use strict";var i=n(82109),r=n(13099),o=n(47908),a=n(47293),s=n(9341),l=[],c=l.sort,u=a((function(){l.sort(void 0)})),h=a((function(){l.sort(null)})),d=s("sort");i({target:"Array",proto:!0,forced:u||!h||!d},{sort:function(e){return void 0===e?c.call(o(this)):c.call(o(this),r(e))}})},38706:(e,t,n)=>{n(96340)("Array")},40561:(e,t,n)=>{"use strict";var i=n(82109),r=n(51400),o=n(99958),a=n(17466),s=n(47908),l=n(65417),c=n(86135),u=n(81194),h=n(29207),d=u("splice"),p=h("splice",{ACCESSORS:!0,0:0,1:2}),f=Math.max,m=Math.min,g=9007199254740991,v="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!d||!p},{splice:function(e,t){var n,i,u,h,d,p,y=s(this),b=a(y.length),_=r(e,b),x=arguments.length;if(0===x?n=i=0:1===x?(n=0,i=b-_):(n=x-2,i=m(f(o(t),0),b-_)),b+n-i>g)throw TypeError(v);for(u=l(y,i),h=0;h<i;h++)(d=_+h)in y&&c(u,h,y[d]);if(u.length=i,n<i){for(h=_;h<b-i;h++)p=h+n,(d=h+i)in y?y[p]=y[d]:delete y[p];for(h=b;h>b-i+n;h--)delete y[h-1]}else if(n>i)for(h=b-i;h>_;h--)p=h+n-1,(d=h+i-1)in y?y[p]=y[d]:delete y[p];for(h=0;h<n;h++)y[h+_]=arguments[h+2];return y.length=b-i+n,u}})},99244:(e,t,n)=>{n(51223)("flatMap")},33792:(e,t,n)=>{n(51223)("flat")},96078:(e,t,n)=>{var i=n(68880),r=n(38709),o=n(5112)("toPrimitive"),a=Date.prototype;o in a||i(a,o,r)},4855:(e,t,n)=>{"use strict";var i=n(70111),r=n(3070),o=n(79518),a=n(5112)("hasInstance"),s=Function.prototype;a in s||r.f(s,a,{value:function(e){if("function"!=typeof this||!i(e))return!1;if(!i(this.prototype))return e instanceof this;for(;e=o(e);)if(this.prototype===e)return!0;return!1}})},68309:(e,t,n)=>{var i=n(19781),r=n(3070).f,o=Function.prototype,a=o.toString,s=/^\s*function ([^ (]*)/,l="name";i&&!(l in o)&&r(o,l,{configurable:!0,get:function(){try{return a.call(this).match(s)[1]}catch(e){return""}}})},35837:(e,t,n)=>{n(82109)({global:!0},{globalThis:n(17854)})},73706:(e,t,n)=>{var i=n(17854);n(58003)(i.JSON,"JSON",!0)},51532:(e,t,n)=>{"use strict";var i=n(77710),r=n(95631);e.exports=i("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),r)},99752:(e,t,n)=>{var i=n(82109),r=n(26513),o=Math.acosh,a=Math.log,s=Math.sqrt,l=Math.LN2;i({target:"Math",stat:!0,forced:!o||710!=Math.floor(o(Number.MAX_VALUE))||o(1/0)!=1/0},{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?a(e)+l:r(e-1+s(e-1)*s(e+1))}})},82376:(e,t,n)=>{var i=n(82109),r=Math.asinh,o=Math.log,a=Math.sqrt;i({target:"Math",stat:!0,forced:!(r&&1/r(0)>0)},{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):o(t+a(t*t+1)):t}})},73181:(e,t,n)=>{var i=n(82109),r=Math.atanh,o=Math.log;i({target:"Math",stat:!0,forced:!(r&&1/r(-0)<0)},{atanh:function(e){return 0==(e=+e)?e:o((1+e)/(1-e))/2}})},23484:(e,t,n)=>{var i=n(82109),r=n(64310),o=Math.abs,a=Math.pow;i({target:"Math",stat:!0},{cbrt:function(e){return r(e=+e)*a(o(e),1/3)}})},2388:(e,t,n)=>{var i=n(82109),r=Math.floor,o=Math.log,a=Math.LOG2E;i({target:"Math",stat:!0},{clz32:function(e){return(e>>>=0)?31-r(o(e+.5)*a):32}})},88621:(e,t,n)=>{var i=n(82109),r=n(66736),o=Math.cosh,a=Math.abs,s=Math.E;i({target:"Math",stat:!0,forced:!o||o(710)===1/0},{cosh:function(e){var t=r(a(e)-1)+1;return(t+1/(t*s*s))*(s/2)}})},60403:(e,t,n)=>{var i=n(82109),r=n(66736);i({target:"Math",stat:!0,forced:r!=Math.expm1},{expm1:r})},84755:(e,t,n)=>{n(82109)({target:"Math",stat:!0},{fround:n(26130)})},25438:(e,t,n)=>{var i=n(82109),r=Math.hypot,o=Math.abs,a=Math.sqrt;i({target:"Math",stat:!0,forced:!!r&&r(1/0,NaN)!==1/0},{hypot:function(e,t){for(var n,i,r=0,s=0,l=arguments.length,c=0;s<l;)c<(n=o(arguments[s++]))?(r=r*(i=c/n)*i+1,c=n):r+=n>0?(i=n/c)*i:n;return c===1/0?1/0:c*a(r)}})},90332:(e,t,n)=>{var i=n(82109),r=n(47293),o=Math.imul;i({target:"Math",stat:!0,forced:r((function(){return-5!=o(4294967295,5)||2!=o.length}))},{imul:function(e,t){var n=65535,i=+e,r=+t,o=n&i,a=n&r;return 0|o*a+((n&i>>>16)*a+o*(n&r>>>16)<<16>>>0)}})},40658:(e,t,n)=>{var i=n(82109),r=Math.log,o=Math.LOG10E;i({target:"Math",stat:!0},{log10:function(e){return r(e)*o}})},40197:(e,t,n)=>{n(82109)({target:"Math",stat:!0},{log1p:n(26513)})},44914:(e,t,n)=>{var i=n(82109),r=Math.log,o=Math.LN2;i({target:"Math",stat:!0},{log2:function(e){return r(e)/o}})},52420:(e,t,n)=>{n(82109)({target:"Math",stat:!0},{sign:n(64310)})},60160:(e,t,n)=>{var i=n(82109),r=n(47293),o=n(66736),a=Math.abs,s=Math.exp,l=Math.E;i({target:"Math",stat:!0,forced:r((function(){return-2e-17!=Math.sinh(-2e-17)}))},{sinh:function(e){return a(e=+e)<1?(o(e)-o(-e))/2:(s(e-1)-s(-e-1))*(l/2)}})},60970:(e,t,n)=>{var i=n(82109),r=n(66736),o=Math.exp;i({target:"Math",stat:!0},{tanh:function(e){var t=r(e=+e),n=r(-e);return t==1/0?1:n==1/0?-1:(t-n)/(o(e)+o(-e))}})},10408:(e,t,n)=>{n(58003)(Math,"Math",!0)},73689:(e,t,n)=>{var i=n(82109),r=Math.ceil,o=Math.floor;i({target:"Math",stat:!0},{trunc:function(e){return(e>0?o:r)(e)}})},9653:(e,t,n)=>{"use strict";var i=n(19781),r=n(17854),o=n(54705),a=n(31320),s=n(86656),l=n(84326),c=n(79587),u=n(57593),h=n(47293),d=n(70030),p=n(8006).f,f=n(31236).f,m=n(3070).f,g=n(53111).trim,v="Number",y=r.Number,b=y.prototype,_=l(d(b))==v,x=function(e){var t,n,i,r,o,a,s,l,c=u(e,!1);if("string"==typeof c&&c.length>2)if(43===(t=(c=g(c)).charCodeAt(0))||45===t){if(88===(n=c.charCodeAt(2))||120===n)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:i=2,r=49;break;case 79:case 111:i=8,r=55;break;default:return+c}for(a=(o=c.slice(2)).length,s=0;s<a;s++)if((l=o.charCodeAt(s))<48||l>r)return NaN;return parseInt(o,i)}return+c};if(o(v,!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var E,w=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof w&&(_?h((function(){b.valueOf.call(n)})):l(n)!=v)?c(new y(x(t)),n,w):x(t)},S=i?p(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),A=0;S.length>A;A++)s(y,E=S[A])&&!s(w,E)&&m(w,E,f(y,E));w.prototype=b,b.constructor=w,a(r,v,w)}},93299:(e,t,n)=>{n(82109)({target:"Number",stat:!0},{EPSILON:Math.pow(2,-52)})},35192:(e,t,n)=>{n(82109)({target:"Number",stat:!0},{isFinite:n(77023)})},33161:(e,t,n)=>{n(82109)({target:"Number",stat:!0},{isInteger:n(18730)})},44048:(e,t,n)=>{n(82109)({target:"Number",stat:!0},{isNaN:function(e){return e!=e}})},78285:(e,t,n)=>{var i=n(82109),r=n(18730),o=Math.abs;i({target:"Number",stat:!0},{isSafeInteger:function(e){return r(e)&&o(e)<=9007199254740991}})},44363:(e,t,n)=>{n(82109)({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991})},55994:(e,t,n)=>{n(82109)({target:"Number",stat:!0},{MIN_SAFE_INTEGER:-9007199254740991})},61874:(e,t,n)=>{var i=n(82109),r=n(2814);i({target:"Number",stat:!0,forced:Number.parseFloat!=r},{parseFloat:r})},9494:(e,t,n)=>{var i=n(82109),r=n(83009);i({target:"Number",stat:!0,forced:Number.parseInt!=r},{parseInt:r})},56977:(e,t,n)=>{"use strict";var i=n(82109),r=n(99958),o=n(50863),a=n(38415),s=n(47293),l=1..toFixed,c=Math.floor,u=function(e,t,n){return 0===t?n:t%2==1?u(e,t-1,n*e):u(e*e,t/2,n)};i({target:"Number",proto:!0,forced:l&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!s((function(){l.call({})}))},{toFixed:function(e){var t,n,i,s,l=o(this),h=r(e),d=[0,0,0,0,0,0],p="",f="0",m=function(e,t){for(var n=-1,i=t;++n<6;)i+=e*d[n],d[n]=i%1e7,i=c(i/1e7)},g=function(e){for(var t=6,n=0;--t>=0;)n+=d[t],d[t]=c(n/e),n=n%e*1e7},v=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==d[e]){var n=String(d[e]);t=""===t?n:t+a.call("0",7-n.length)+n}return t};if(h<0||h>20)throw RangeError("Incorrect fraction digits");if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(p="-",l=-l),l>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(l*u(2,69,1))-69)<0?l*u(2,-t,1):l/u(2,t,1),n*=4503599627370496,(t=52-t)>0){for(m(0,n),i=h;i>=7;)m(1e7,0),i-=7;for(m(u(10,i,1),0),i=t-1;i>=23;)g(1<<23),i-=23;g(1<<i),m(1,1),g(2),f=v()}else m(0,n),m(1<<-t,0),f=v()+a.call("0",h);return f=h>0?p+((s=f.length)<=h?"0."+a.call("0",h-s)+f:f.slice(0,s-h)+"."+f.slice(s-h)):p+f}})},19601:(e,t,n)=>{var i=n(82109),r=n(21574);i({target:"Object",stat:!0,forced:Object.assign!==r},{assign:r})},59595:(e,t,n)=>{"use strict";var i=n(82109),r=n(19781),o=n(69026),a=n(47908),s=n(13099),l=n(3070);r&&i({target:"Object",proto:!0,forced:o},{__defineGetter__:function(e,t){l.f(a(this),e,{get:s(t),enumerable:!0,configurable:!0})}})},35500:(e,t,n)=>{"use strict";var i=n(82109),r=n(19781),o=n(69026),a=n(47908),s=n(13099),l=n(3070);r&&i({target:"Object",proto:!0,forced:o},{__defineSetter__:function(e,t){l.f(a(this),e,{set:s(t),enumerable:!0,configurable:!0})}})},69720:(e,t,n)=>{var i=n(82109),r=n(44699).entries;i({target:"Object",stat:!0},{entries:function(e){return r(e)}})},43371:(e,t,n)=>{var i=n(82109),r=n(76677),o=n(47293),a=n(70111),s=n(62423).onFreeze,l=Object.freeze;i({target:"Object",stat:!0,forced:o((function(){l(1)})),sham:!r},{freeze:function(e){return l&&a(e)?l(s(e)):e}})},38559:(e,t,n)=>{var i=n(82109),r=n(20408),o=n(86135);i({target:"Object",stat:!0},{fromEntries:function(e){var t={};return r(e,(function(e,n){o(t,e,n)}),void 0,!0),t}})},38880:(e,t,n)=>{var i=n(82109),r=n(47293),o=n(45656),a=n(31236).f,s=n(19781),l=r((function(){a(1)}));i({target:"Object",stat:!0,forced:!s||l,sham:!s},{getOwnPropertyDescriptor:function(e,t){return a(o(e),t)}})},49337:(e,t,n)=>{var i=n(82109),r=n(19781),o=n(53887),a=n(45656),s=n(31236),l=n(86135);i({target:"Object",stat:!0,sham:!r},{getOwnPropertyDescriptors:function(e){for(var t,n,i=a(e),r=s.f,c=o(i),u={},h=0;c.length>h;)void 0!==(n=r(i,t=c[h++]))&&l(u,t,n);return u}})},36210:(e,t,n)=>{var i=n(82109),r=n(47293),o=n(1156).f;i({target:"Object",stat:!0,forced:r((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:o})},30489:(e,t,n)=>{var i=n(82109),r=n(47293),o=n(47908),a=n(79518),s=n(49920);i({target:"Object",stat:!0,forced:r((function(){a(1)})),sham:!s},{getPrototypeOf:function(e){return a(o(e))}})},41825:(e,t,n)=>{var i=n(82109),r=n(47293),o=n(70111),a=Object.isExtensible;i({target:"Object",stat:!0,forced:r((function(){a(1)}))},{isExtensible:function(e){return!!o(e)&&(!a||a(e))}})},98410:(e,t,n)=>{var i=n(82109),r=n(47293),o=n(70111),a=Object.isFrozen;i({target:"Object",stat:!0,forced:r((function(){a(1)}))},{isFrozen:function(e){return!o(e)||!!a&&a(e)}})},72200:(e,t,n)=>{var i=n(82109),r=n(47293),o=n(70111),a=Object.isSealed;i({target:"Object",stat:!0,forced:r((function(){a(1)}))},{isSealed:function(e){return!o(e)||!!a&&a(e)}})},43304:(e,t,n)=>{n(82109)({target:"Object",stat:!0},{is:n(81150)})},47941:(e,t,n)=>{var i=n(82109),r=n(47908),o=n(81956);i({target:"Object",stat:!0,forced:n(47293)((function(){o(1)}))},{keys:function(e){return o(r(e))}})},94869:(e,t,n)=>{"use strict";var i=n(82109),r=n(19781),o=n(69026),a=n(47908),s=n(57593),l=n(79518),c=n(31236).f;r&&i({target:"Object",proto:!0,forced:o},{__lookupGetter__:function(e){var t,n=a(this),i=s(e,!0);do{if(t=c(n,i))return t.get}while(n=l(n))}})},33952:(e,t,n)=>{"use strict";var i=n(82109),r=n(19781),o=n(69026),a=n(47908),s=n(57593),l=n(79518),c=n(31236).f;r&&i({target:"Object",proto:!0,forced:o},{__lookupSetter__:function(e){var t,n=a(this),i=s(e,!0);do{if(t=c(n,i))return t.set}while(n=l(n))}})},57227:(e,t,n)=>{var i=n(82109),r=n(70111),o=n(62423).onFreeze,a=n(76677),s=n(47293),l=Object.preventExtensions;i({target:"Object",stat:!0,forced:s((function(){l(1)})),sham:!a},{preventExtensions:function(e){return l&&r(e)?l(o(e)):e}})},60514:(e,t,n)=>{var i=n(82109),r=n(70111),o=n(62423).onFreeze,a=n(76677),s=n(47293),l=Object.seal;i({target:"Object",stat:!0,forced:s((function(){l(1)})),sham:!a},{seal:function(e){return l&&r(e)?l(o(e)):e}})},68304:(e,t,n)=>{n(82109)({target:"Object",stat:!0},{setPrototypeOf:n(27674)})},41539:(e,t,n)=>{var i=n(51694),r=n(31320),o=n(90288);i||r(Object.prototype,"toString",o,{unsafe:!0})},26833:(e,t,n)=>{var i=n(82109),r=n(44699).values;i({target:"Object",stat:!0},{values:function(e){return r(e)}})},54678:(e,t,n)=>{var i=n(82109),r=n(2814);i({global:!0,forced:parseFloat!=r},{parseFloat:r})},91058:(e,t,n)=>{var i=n(82109),r=n(83009);i({global:!0,forced:parseInt!=r},{parseInt:r})},17922:(e,t,n)=>{"use strict";var i=n(82109),r=n(13099),o=n(78523),a=n(12534),s=n(20408);i({target:"Promise",stat:!0},{allSettled:function(e){var t=this,n=o.f(t),i=n.resolve,l=n.reject,c=a((function(){var n=r(t.resolve),o=[],a=0,l=1;s(e,(function(e){var r=a++,s=!1;o.push(void 0),l++,n.call(t,e).then((function(e){s||(s=!0,o[r]={status:"fulfilled",value:e},--l||i(o))}),(function(e){s||(s=!0,o[r]={status:"rejected",reason:e},--l||i(o))}))})),--l||i(o)}));return c.error&&l(c.value),n.promise}})},17727:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(13366),a=n(47293),s=n(35005),l=n(36707),c=n(69478),u=n(31320);i({target:"Promise",proto:!0,real:!0,forced:!!o&&a((function(){o.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=l(this,s("Promise")),n="function"==typeof e;return this.then(n?function(n){return c(t,e()).then((function(){return n}))}:e,n?function(n){return c(t,e()).then((function(){throw n}))}:e)}}),r||"function"!=typeof o||o.prototype.finally||u(o.prototype,"finally",s("Promise").prototype.finally)},88674:(e,t,n)=>{"use strict";var i,r,o,a,s=n(82109),l=n(31913),c=n(17854),u=n(35005),h=n(13366),d=n(31320),p=n(12248),f=n(58003),m=n(96340),g=n(70111),v=n(13099),y=n(25787),b=n(84326),_=n(42788),x=n(20408),E=n(17072),w=n(36707),S=n(20261).set,A=n(95948),M=n(69478),T=n(842),C=n(78523),P=n(12534),L=n(29909),R=n(54705),D=n(5112),I=n(7392),O=D("species"),N="Promise",k=L.get,F=L.set,U=L.getterFor(N),B=h,V=c.TypeError,G=c.document,z=c.process,H=u("fetch"),W=C.f,j=W,q="process"==b(z),X=!!(G&&G.createEvent&&c.dispatchEvent),Y="unhandledrejection",K=R(N,(function(){if(!(_(B)!==String(B))){if(66===I)return!0;if(!q&&"function"!=typeof PromiseRejectionEvent)return!0}if(l&&!B.prototype.finally)return!0;if(I>=51&&/native code/.test(B))return!1;var e=B.resolve(1),t=function(e){e((function(){}),(function(){}))};return(e.constructor={})[O]=t,!(e.then((function(){}))instanceof t)})),Z=K||!E((function(e){B.all(e).catch((function(){}))})),J=function(e){var t;return!(!g(e)||"function"!=typeof(t=e.then))&&t},Q=function(e,t,n){if(!t.notified){t.notified=!0;var i=t.reactions;A((function(){for(var r=t.value,o=1==t.state,a=0;i.length>a;){var s,l,c,u=i[a++],h=o?u.ok:u.fail,d=u.resolve,p=u.reject,f=u.domain;try{h?(o||(2===t.rejection&&ne(e,t),t.rejection=1),!0===h?s=r:(f&&f.enter(),s=h(r),f&&(f.exit(),c=!0)),s===u.promise?p(V("Promise-chain cycle")):(l=J(s))?l.call(s,d,p):d(s)):p(r)}catch(e){f&&!c&&f.exit(),p(e)}}t.reactions=[],t.notified=!1,n&&!t.rejection&&ee(e,t)}))}},$=function(e,t,n){var i,r;X?((i=G.createEvent("Event")).promise=t,i.reason=n,i.initEvent(e,!1,!0),c.dispatchEvent(i)):i={promise:t,reason:n},(r=c["on"+e])?r(i):e===Y&&T("Unhandled promise rejection",n)},ee=function(e,t){S.call(c,(function(){var n,i=t.value;if(te(t)&&(n=P((function(){q?z.emit("unhandledRejection",i,e):$(Y,e,i)})),t.rejection=q||te(t)?2:1,n.error))throw n.value}))},te=function(e){return 1!==e.rejection&&!e.parent},ne=function(e,t){S.call(c,(function(){q?z.emit("rejectionHandled",e):$("rejectionhandled",e,t.value)}))},ie=function(e,t,n,i){return function(r){e(t,n,r,i)}},re=function(e,t,n,i){t.done||(t.done=!0,i&&(t=i),t.value=n,t.state=2,Q(e,t,!0))},oe=function(e,t,n,i){if(!t.done){t.done=!0,i&&(t=i);try{if(e===n)throw V("Promise can't be resolved itself");var r=J(n);r?A((function(){var i={done:!1};try{r.call(n,ie(oe,e,i,t),ie(re,e,i,t))}catch(n){re(e,i,n,t)}})):(t.value=n,t.state=1,Q(e,t,!1))}catch(n){re(e,{done:!1},n,t)}}};K&&(B=function(e){y(this,B,N),v(e),i.call(this);var t=k(this);try{e(ie(oe,this,t),ie(re,this,t))}catch(e){re(this,t,e)}},(i=function(e){F(this,{type:N,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=p(B.prototype,{then:function(e,t){var n=U(this),i=W(w(this,B));return i.ok="function"!=typeof e||e,i.fail="function"==typeof t&&t,i.domain=q?z.domain:void 0,n.parent=!0,n.reactions.push(i),0!=n.state&&Q(this,n,!1),i.promise},catch:function(e){return this.then(void 0,e)}}),r=function(){var e=new i,t=k(e);this.promise=e,this.resolve=ie(oe,e,t),this.reject=ie(re,e,t)},C.f=W=function(e){return e===B||e===o?new r(e):j(e)},l||"function"!=typeof h||(a=h.prototype.then,d(h.prototype,"then",(function(e,t){var n=this;return new B((function(e,t){a.call(n,e,t)})).then(e,t)}),{unsafe:!0}),"function"==typeof H&&s({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return M(B,H.apply(c,arguments))}}))),s({global:!0,wrap:!0,forced:K},{Promise:B}),f(B,N,!1,!0),m(N),o=u(N),s({target:N,stat:!0,forced:K},{reject:function(e){var t=W(this);return t.reject.call(void 0,e),t.promise}}),s({target:N,stat:!0,forced:l||K},{resolve:function(e){return M(l&&this===o?B:this,e)}}),s({target:N,stat:!0,forced:Z},{all:function(e){var t=this,n=W(t),i=n.resolve,r=n.reject,o=P((function(){var n=v(t.resolve),o=[],a=0,s=1;x(e,(function(e){var l=a++,c=!1;o.push(void 0),s++,n.call(t,e).then((function(e){c||(c=!0,o[l]=e,--s||i(o))}),r)})),--s||i(o)}));return o.error&&r(o.value),n.promise},race:function(e){var t=this,n=W(t),i=n.reject,r=P((function(){var r=v(t.resolve);x(e,(function(e){r.call(t,e).then(n.resolve,i)}))}));return r.error&&i(r.value),n.promise}})},36535:(e,t,n)=>{var i=n(82109),r=n(35005),o=n(13099),a=n(19670),s=n(47293),l=r("Reflect","apply"),c=Function.apply;i({target:"Reflect",stat:!0,forced:!s((function(){l((function(){}))}))},{apply:function(e,t,n){return o(e),a(n),l?l(e,t,n):c.call(e,t,n)}})},12419:(e,t,n)=>{var i=n(82109),r=n(35005),o=n(13099),a=n(19670),s=n(70111),l=n(70030),c=n(27065),u=n(47293),h=r("Reflect","construct"),d=u((function(){function e(){}return!(h((function(){}),[],e)instanceof e)})),p=!u((function(){h((function(){}))})),f=d||p;i({target:"Reflect",stat:!0,forced:f,sham:f},{construct:function(e,t){o(e),a(t);var n=arguments.length<3?e:o(arguments[2]);if(p&&!d)return h(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var i=[null];return i.push.apply(i,t),new(c.apply(e,i))}var r=n.prototype,u=l(s(r)?r:Object.prototype),f=Function.apply.call(e,u,t);return s(f)?f:u}})},69596:(e,t,n)=>{var i=n(82109),r=n(19781),o=n(19670),a=n(57593),s=n(3070);i({target:"Reflect",stat:!0,forced:n(47293)((function(){Reflect.defineProperty(s.f({},1,{value:1}),1,{value:2})})),sham:!r},{defineProperty:function(e,t,n){o(e);var i=a(t,!0);o(n);try{return s.f(e,i,n),!0}catch(e){return!1}}})},52586:(e,t,n)=>{var i=n(82109),r=n(19670),o=n(31236).f;i({target:"Reflect",stat:!0},{deleteProperty:function(e,t){var n=o(r(e),t);return!(n&&!n.configurable)&&delete e[t]}})},95683:(e,t,n)=>{var i=n(82109),r=n(19781),o=n(19670),a=n(31236);i({target:"Reflect",stat:!0,sham:!r},{getOwnPropertyDescriptor:function(e,t){return a.f(o(e),t)}})},39361:(e,t,n)=>{var i=n(82109),r=n(19670),o=n(79518);i({target:"Reflect",stat:!0,sham:!n(49920)},{getPrototypeOf:function(e){return o(r(e))}})},74819:(e,t,n)=>{var i=n(82109),r=n(70111),o=n(19670),a=n(86656),s=n(31236),l=n(79518);i({target:"Reflect",stat:!0},{get:function e(t,n){var i,c,u=arguments.length<3?t:arguments[2];return o(t)===u?t[n]:(i=s.f(t,n))?a(i,"value")?i.value:void 0===i.get?void 0:i.get.call(u):r(c=l(t))?e(c,n,u):void 0}})},51037:(e,t,n)=>{n(82109)({target:"Reflect",stat:!0},{has:function(e,t){return t in e}})},5898:(e,t,n)=>{var i=n(82109),r=n(19670),o=Object.isExtensible;i({target:"Reflect",stat:!0},{isExtensible:function(e){return r(e),!o||o(e)}})},67556:(e,t,n)=>{n(82109)({target:"Reflect",stat:!0},{ownKeys:n(53887)})},14361:(e,t,n)=>{var i=n(82109),r=n(35005),o=n(19670);i({target:"Reflect",stat:!0,sham:!n(76677)},{preventExtensions:function(e){o(e);try{var t=r("Object","preventExtensions");return t&&t(e),!0}catch(e){return!1}}})},39532:(e,t,n)=>{var i=n(82109),r=n(19670),o=n(96077),a=n(27674);a&&i({target:"Reflect",stat:!0},{setPrototypeOf:function(e,t){r(e),o(t);try{return a(e,t),!0}catch(e){return!1}}})},83593:(e,t,n)=>{var i=n(82109),r=n(19670),o=n(70111),a=n(86656),s=n(47293),l=n(3070),c=n(31236),u=n(79518),h=n(79114);i({target:"Reflect",stat:!0,forced:s((function(){var e=l.f({},"a",{configurable:!0});return!1!==Reflect.set(u(e),"a",1,e)}))},{set:function e(t,n,i){var s,d,p=arguments.length<4?t:arguments[3],f=c.f(r(t),n);if(!f){if(o(d=u(t)))return e(d,n,i,p);f=h(0)}if(a(f,"value")){if(!1===f.writable||!o(p))return!1;if(s=c.f(p,n)){if(s.get||s.set||!1===s.writable)return!1;s.value=i,l.f(p,n,s)}else l.f(p,n,h(0,i));return!0}return void 0!==f.set&&(f.set.call(p,i),!0)}})},24603:(e,t,n)=>{var i=n(19781),r=n(17854),o=n(54705),a=n(79587),s=n(3070).f,l=n(8006).f,c=n(47850),u=n(67066),h=n(52999),d=n(31320),p=n(47293),f=n(29909).set,m=n(96340),g=n(5112)("match"),v=r.RegExp,y=v.prototype,b=/a/g,_=/a/g,x=new v(b)!==b,E=h.UNSUPPORTED_Y;if(i&&o("RegExp",!x||E||p((function(){return _[g]=!1,v(b)!=b||v(_)==_||"/a/i"!=v(b,"i")})))){for(var w=function(e,t){var n,i=this instanceof w,r=c(e),o=void 0===t;if(!i&&r&&e.constructor===w&&o)return e;x?r&&!o&&(e=e.source):e instanceof w&&(o&&(t=u.call(e)),e=e.source),E&&(n=!!t&&t.indexOf("y")>-1)&&(t=t.replace(/y/g,""));var s=a(x?new v(e,t):v(e,t),i?this:y,w);return E&&n&&f(s,{sticky:n}),s},S=function(e){e in w||s(w,e,{configurable:!0,get:function(){return v[e]},set:function(t){v[e]=t}})},A=l(v),M=0;A.length>M;)S(A[M++]);y.constructor=w,w.prototype=y,d(r,"RegExp",w)}m("RegExp")},74916:(e,t,n)=>{"use strict";var i=n(82109),r=n(22261);i({target:"RegExp",proto:!0,forced:/./.exec!==r},{exec:r})},92087:(e,t,n)=>{var i=n(19781),r=n(3070),o=n(67066),a=n(52999).UNSUPPORTED_Y;i&&("g"!=/./g.flags||a)&&r.f(RegExp.prototype,"flags",{configurable:!0,get:o})},39714:(e,t,n)=>{"use strict";var i=n(31320),r=n(19670),o=n(47293),a=n(67066),s="toString",l=RegExp.prototype,c=l.toString,u=o((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),h=c.name!=s;(u||h)&&i(RegExp.prototype,s,(function(){var e=r(this),t=String(e.source),n=e.flags;return"/"+t+"/"+String(void 0===n&&e instanceof RegExp&&!("flags"in l)?a.call(e):n)}),{unsafe:!0})},70189:(e,t,n)=>{"use strict";var i=n(77710),r=n(95631);e.exports=i("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),r)},15218:(e,t,n)=>{"use strict";var i=n(82109),r=n(14230);i({target:"String",proto:!0,forced:n(43429)("anchor")},{anchor:function(e){return r(this,"a","name",e)}})},74475:(e,t,n)=>{"use strict";var i=n(82109),r=n(14230);i({target:"String",proto:!0,forced:n(43429)("big")},{big:function(){return r(this,"big","","")}})},57929:(e,t,n)=>{"use strict";var i=n(82109),r=n(14230);i({target:"String",proto:!0,forced:n(43429)("blink")},{blink:function(){return r(this,"blink","","")}})},50915:(e,t,n)=>{"use strict";var i=n(82109),r=n(14230);i({target:"String",proto:!0,forced:n(43429)("bold")},{bold:function(){return r(this,"b","","")}})},79841:(e,t,n)=>{"use strict";var i=n(82109),r=n(28710).codeAt;i({target:"String",proto:!0},{codePointAt:function(e){return r(this,e)}})},27852:(e,t,n)=>{"use strict";var i,r=n(82109),o=n(31236).f,a=n(17466),s=n(3929),l=n(84488),c=n(84964),u=n(31913),h="".endsWith,d=Math.min,p=c("endsWith");r({target:"String",proto:!0,forced:!!(u||p||(i=o(String.prototype,"endsWith"),!i||i.writable))&&!p},{endsWith:function(e){var t=String(l(this));s(e);var n=arguments.length>1?arguments[1]:void 0,i=a(t.length),r=void 0===n?i:d(a(n),i),o=String(e);return h?h.call(t,o,r):t.slice(r-o.length,r)===o}})},29253:(e,t,n)=>{"use strict";var i=n(82109),r=n(14230);i({target:"String",proto:!0,forced:n(43429)("fixed")},{fixed:function(){return r(this,"tt","","")}})},42125:(e,t,n)=>{"use strict";var i=n(82109),r=n(14230);i({target:"String",proto:!0,forced:n(43429)("fontcolor")},{fontcolor:function(e){return r(this,"font","color",e)}})},78830:(e,t,n)=>{"use strict";var i=n(82109),r=n(14230);i({target:"String",proto:!0,forced:n(43429)("fontsize")},{fontsize:function(e){return r(this,"font","size",e)}})},94953:(e,t,n)=>{var i=n(82109),r=n(51400),o=String.fromCharCode,a=String.fromCodePoint;i({target:"String",stat:!0,forced:!!a&&1!=a.length},{fromCodePoint:function(e){for(var t,n=[],i=arguments.length,a=0;i>a;){if(t=+arguments[a++],r(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?o(t):o(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},32023:(e,t,n)=>{"use strict";var i=n(82109),r=n(3929),o=n(84488);i({target:"String",proto:!0,forced:!n(84964)("includes")},{includes:function(e){return!!~String(o(this)).indexOf(r(e),arguments.length>1?arguments[1]:void 0)}})},58734:(e,t,n)=>{"use strict";var i=n(82109),r=n(14230);i({target:"String",proto:!0,forced:n(43429)("italics")},{italics:function(){return r(this,"i","","")}})},78783:(e,t,n)=>{"use strict";var i=n(28710).charAt,r=n(29909),o=n(70654),a="String Iterator",s=r.set,l=r.getterFor(a);o(String,"String",(function(e){s(this,{type:a,string:String(e),index:0})}),(function(){var e,t=l(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=i(n,r),t.index+=e.length,{value:e,done:!1})}))},29254:(e,t,n)=>{"use strict";var i=n(82109),r=n(14230);i({target:"String",proto:!0,forced:n(43429)("link")},{link:function(e){return r(this,"a","href",e)}})},76373:(e,t,n)=>{"use strict";var i=n(82109),r=n(24994),o=n(84488),a=n(17466),s=n(13099),l=n(19670),c=n(84326),u=n(47850),h=n(67066),d=n(68880),p=n(47293),f=n(5112),m=n(36707),g=n(31530),v=n(29909),y=n(31913),b=f("matchAll"),_="RegExp String",x="RegExp String Iterator",E=v.set,w=v.getterFor(x),S=RegExp.prototype,A=S.exec,M="".matchAll,T=!!M&&!p((function(){"a".matchAll(/./)})),C=r((function(e,t,n,i){E(this,{type:x,regexp:e,string:t,global:n,unicode:i,done:!1})}),_,(function(){var e=w(this);if(e.done)return{value:void 0,done:!0};var t=e.regexp,n=e.string,i=function(e,t){var n,i=e.exec;if("function"==typeof i){if("object"!=typeof(n=i.call(e,t)))throw TypeError("Incorrect exec result");return n}return A.call(e,t)}(t,n);return null===i?{value:void 0,done:e.done=!0}:e.global?(""==String(i[0])&&(t.lastIndex=g(n,a(t.lastIndex),e.unicode)),{value:i,done:!1}):(e.done=!0,{value:i,done:!1})})),P=function(e){var t,n,i,r,o,s,c=l(this),u=String(e);return t=m(c,RegExp),void 0===(n=c.flags)&&c instanceof RegExp&&!("flags"in S)&&(n=h.call(c)),i=void 0===n?"":String(n),r=new t(t===RegExp?c.source:c,i),o=!!~i.indexOf("g"),s=!!~i.indexOf("u"),r.lastIndex=a(c.lastIndex),new C(r,u,o,s)};i({target:"String",proto:!0,forced:T},{matchAll:function(e){var t,n,i,r=o(this);if(null!=e){if(u(e)&&!~String(o("flags"in S?e.flags:h.call(e))).indexOf("g"))throw TypeError("`.matchAll` does not allow non-global regexes");if(T)return M.apply(r,arguments);if(void 0===(n=e[b])&&y&&"RegExp"==c(e)&&(n=P),null!=n)return s(n).call(e,r)}else if(T)return M.apply(r,arguments);return t=String(r),i=new RegExp(e,"g"),y?P.call(i,t):i[b](t)}}),y||b in S||d(S,b,P)},4723:(e,t,n)=>{"use strict";var i=n(27007),r=n(19670),o=n(17466),a=n(84488),s=n(31530),l=n(97651);i("match",1,(function(e,t,n){return[function(t){var n=a(this),i=null==t?void 0:t[e];return void 0!==i?i.call(t,n):new RegExp(t)[e](String(n))},function(e){var i=n(t,e,this);if(i.done)return i.value;var a=r(e),c=String(this);if(!a.global)return l(a,c);var u=a.unicode;a.lastIndex=0;for(var h,d=[],p=0;null!==(h=l(a,c));){var f=String(h[0]);d[p]=f,""===f&&(a.lastIndex=s(c,o(a.lastIndex),u)),p++}return 0===p?null:d}]}))},66528:(e,t,n)=>{"use strict";var i=n(82109),r=n(76650).end;i({target:"String",proto:!0,forced:n(54986)},{padEnd:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},83112:(e,t,n)=>{"use strict";var i=n(82109),r=n(76650).start;i({target:"String",proto:!0,forced:n(54986)},{padStart:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},38992:(e,t,n)=>{var i=n(82109),r=n(45656),o=n(17466);i({target:"String",stat:!0},{raw:function(e){for(var t=r(e.raw),n=o(t.length),i=arguments.length,a=[],s=0;n>s;)a.push(String(t[s++])),s<i&&a.push(String(arguments[s]));return a.join("")}})},82481:(e,t,n)=>{n(82109)({target:"String",proto:!0},{repeat:n(38415)})},15306:(e,t,n)=>{"use strict";var i=n(27007),r=n(19670),o=n(47908),a=n(17466),s=n(99958),l=n(84488),c=n(31530),u=n(97651),h=Math.max,d=Math.min,p=Math.floor,f=/\$([$&'`]|\d\d?|<[^>]*>)/g,m=/\$([$&'`]|\d\d?)/g;i("replace",2,(function(e,t,n,i){var g=i.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,v=i.REPLACE_KEEPS_$0,y=g?"$":"$0";return[function(n,i){var r=l(this),o=null==n?void 0:n[e];return void 0!==o?o.call(n,r,i):t.call(String(r),n,i)},function(e,i){if(!g&&v||"string"==typeof i&&-1===i.indexOf(y)){var o=n(t,e,this,i);if(o.done)return o.value}var l=r(e),p=String(this),f="function"==typeof i;f||(i=String(i));var m=l.global;if(m){var _=l.unicode;l.lastIndex=0}for(var x=[];;){var E=u(l,p);if(null===E)break;if(x.push(E),!m)break;""===String(E[0])&&(l.lastIndex=c(p,a(l.lastIndex),_))}for(var w,S="",A=0,M=0;M<x.length;M++){E=x[M];for(var T=String(E[0]),C=h(d(s(E.index),p.length),0),P=[],L=1;L<E.length;L++)P.push(void 0===(w=E[L])?w:String(w));var R=E.groups;if(f){var D=[T].concat(P,C,p);void 0!==R&&D.push(R);var I=String(i.apply(void 0,D))}else I=b(T,p,C,P,R,i);C>=A&&(S+=p.slice(A,C)+I,A=C+T.length)}return S+p.slice(A)}];function b(e,n,i,r,a,s){var l=i+e.length,c=r.length,u=m;return void 0!==a&&(a=o(a),u=f),t.call(s,u,(function(t,o){var s;switch(o.charAt(0)){case"$":return"$";case"&":return e;case"`":return n.slice(0,i);case"'":return n.slice(l);case"<":s=a[o.slice(1,-1)];break;default:var u=+o;if(0===u)return t;if(u>c){var h=p(u/10);return 0===h?t:h<=c?void 0===r[h-1]?o.charAt(1):r[h-1]+o.charAt(1):t}s=r[u-1]}return void 0===s?"":s}))}}))},64765:(e,t,n)=>{"use strict";var i=n(27007),r=n(19670),o=n(84488),a=n(81150),s=n(97651);i("search",1,(function(e,t,n){return[function(t){var n=o(this),i=null==t?void 0:t[e];return void 0!==i?i.call(t,n):new RegExp(t)[e](String(n))},function(e){var i=n(t,e,this);if(i.done)return i.value;var o=r(e),l=String(this),c=o.lastIndex;a(c,0)||(o.lastIndex=0);var u=s(o,l);return a(o.lastIndex,c)||(o.lastIndex=c),null===u?-1:u.index}]}))},37268:(e,t,n)=>{"use strict";var i=n(82109),r=n(14230);i({target:"String",proto:!0,forced:n(43429)("small")},{small:function(){return r(this,"small","","")}})},23123:(e,t,n)=>{"use strict";var i=n(27007),r=n(47850),o=n(19670),a=n(84488),s=n(36707),l=n(31530),c=n(17466),u=n(97651),h=n(22261),d=n(47293),p=[].push,f=Math.min,m=4294967295,g=!d((function(){return!RegExp(m,"y")}));i("split",2,(function(e,t,n){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var i=String(a(this)),o=void 0===n?m:n>>>0;if(0===o)return[];if(void 0===e)return[i];if(!r(e))return t.call(i,e,o);for(var s,l,c,u=[],d=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,g=new RegExp(e.source,d+"g");(s=h.call(g,i))&&!((l=g.lastIndex)>f&&(u.push(i.slice(f,s.index)),s.length>1&&s.index<i.length&&p.apply(u,s.slice(1)),c=s[0].length,f=l,u.length>=o));)g.lastIndex===s.index&&g.lastIndex++;return f===i.length?!c&&g.test("")||u.push(""):u.push(i.slice(f)),u.length>o?u.slice(0,o):u}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t,[function(t,n){var r=a(this),o=null==t?void 0:t[e];return void 0!==o?o.call(t,r,n):i.call(String(r),t,n)},function(e,r){var a=n(i,e,this,r,i!==t);if(a.done)return a.value;var h=o(e),d=String(this),p=s(h,RegExp),v=h.unicode,y=(h.ignoreCase?"i":"")+(h.multiline?"m":"")+(h.unicode?"u":"")+(g?"y":"g"),b=new p(g?h:"^(?:"+h.source+")",y),_=void 0===r?m:r>>>0;if(0===_)return[];if(0===d.length)return null===u(b,d)?[d]:[];for(var x=0,E=0,w=[];E<d.length;){b.lastIndex=g?E:0;var S,A=u(b,g?d:d.slice(E));if(null===A||(S=f(c(b.lastIndex+(g?0:E)),d.length))===x)E=l(d,E,v);else{if(w.push(d.slice(x,E)),w.length===_)return w;for(var M=1;M<=A.length-1;M++)if(w.push(A[M]),w.length===_)return w;E=x=S}}return w.push(d.slice(x)),w}]}),!g)},23157:(e,t,n)=>{"use strict";var i,r=n(82109),o=n(31236).f,a=n(17466),s=n(3929),l=n(84488),c=n(84964),u=n(31913),h="".startsWith,d=Math.min,p=c("startsWith");r({target:"String",proto:!0,forced:!!(u||p||(i=o(String.prototype,"startsWith"),!i||i.writable))&&!p},{startsWith:function(e){var t=String(l(this));s(e);var n=a(d(arguments.length>1?arguments[1]:void 0,t.length)),i=String(e);return h?h.call(t,i,n):t.slice(n,n+i.length)===i}})},7397:(e,t,n)=>{"use strict";var i=n(82109),r=n(14230);i({target:"String",proto:!0,forced:n(43429)("strike")},{strike:function(){return r(this,"strike","","")}})},60086:(e,t,n)=>{"use strict";var i=n(82109),r=n(14230);i({target:"String",proto:!0,forced:n(43429)("sub")},{sub:function(){return r(this,"sub","","")}})},80623:(e,t,n)=>{"use strict";var i=n(82109),r=n(14230);i({target:"String",proto:!0,forced:n(43429)("sup")},{sup:function(){return r(this,"sup","","")}})},48702:(e,t,n)=>{"use strict";var i=n(82109),r=n(53111).end,o=n(76091)("trimEnd"),a=o?function(){return r(this)}:"".trimEnd;i({target:"String",proto:!0,forced:o},{trimEnd:a,trimRight:a})},55674:(e,t,n)=>{"use strict";var i=n(82109),r=n(53111).start,o=n(76091)("trimStart"),a=o?function(){return r(this)}:"".trimStart;i({target:"String",proto:!0,forced:o},{trimStart:a,trimLeft:a})},73210:(e,t,n)=>{"use strict";var i=n(82109),r=n(53111).trim;i({target:"String",proto:!0,forced:n(76091)("trim")},{trim:function(){return r(this)}})},72443:(e,t,n)=>{n(97235)("asyncIterator")},41817:(e,t,n)=>{"use strict";var i=n(82109),r=n(19781),o=n(17854),a=n(86656),s=n(70111),l=n(3070).f,c=n(99920),u=o.Symbol;if(r&&"function"==typeof u&&(!("description"in u.prototype)||void 0!==u().description)){var h={},d=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof d?new u(e):void 0===e?u():u(e);return""===e&&(h[t]=!0),t};c(d,u);var p=d.prototype=u.prototype;p.constructor=d;var f=p.toString,m="Symbol(test)"==String(u("test")),g=/^Symbol\((.*)\)[^)]+$/;l(p,"description",{configurable:!0,get:function(){var e=s(this)?this.valueOf():this,t=f.call(e);if(a(h,e))return"";var n=m?t.slice(7,-1):t.replace(g,"$1");return""===n?void 0:n}}),i({global:!0,forced:!0},{Symbol:d})}},92401:(e,t,n)=>{n(97235)("hasInstance")},8722:(e,t,n)=>{n(97235)("isConcatSpreadable")},32165:(e,t,n)=>{n(97235)("iterator")},82526:(e,t,n)=>{"use strict";var i=n(82109),r=n(17854),o=n(35005),a=n(31913),s=n(19781),l=n(30133),c=n(43307),u=n(47293),h=n(86656),d=n(43157),p=n(70111),f=n(19670),m=n(47908),g=n(45656),v=n(57593),y=n(79114),b=n(70030),_=n(81956),x=n(8006),E=n(1156),w=n(25181),S=n(31236),A=n(3070),M=n(55296),T=n(68880),C=n(31320),P=n(72309),L=n(6200),R=n(3501),D=n(69711),I=n(5112),O=n(6061),N=n(97235),k=n(58003),F=n(29909),U=n(42092).forEach,B=L("hidden"),V="Symbol",G=I("toPrimitive"),z=F.set,H=F.getterFor(V),W=Object.prototype,j=r.Symbol,q=o("JSON","stringify"),X=S.f,Y=A.f,K=E.f,Z=M.f,J=P("symbols"),Q=P("op-symbols"),$=P("string-to-symbol-registry"),ee=P("symbol-to-string-registry"),te=P("wks"),ne=r.QObject,ie=!ne||!ne.prototype||!ne.prototype.findChild,re=s&&u((function(){return 7!=b(Y({},"a",{get:function(){return Y(this,"a",{value:7}).a}})).a}))?function(e,t,n){var i=X(W,t);i&&delete W[t],Y(e,t,n),i&&e!==W&&Y(W,t,i)}:Y,oe=function(e,t){var n=J[e]=b(j.prototype);return z(n,{type:V,tag:e,description:t}),s||(n.description=t),n},ae=c?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof j},se=function(e,t,n){e===W&&se(Q,t,n),f(e);var i=v(t,!0);return f(n),h(J,i)?(n.enumerable?(h(e,B)&&e[B][i]&&(e[B][i]=!1),n=b(n,{enumerable:y(0,!1)})):(h(e,B)||Y(e,B,y(1,{})),e[B][i]=!0),re(e,i,n)):Y(e,i,n)},le=function(e,t){f(e);var n=g(t),i=_(n).concat(de(n));return U(i,(function(t){s&&!ce.call(n,t)||se(e,t,n[t])})),e},ce=function(e){var t=v(e,!0),n=Z.call(this,t);return!(this===W&&h(J,t)&&!h(Q,t))&&(!(n||!h(this,t)||!h(J,t)||h(this,B)&&this[B][t])||n)},ue=function(e,t){var n=g(e),i=v(t,!0);if(n!==W||!h(J,i)||h(Q,i)){var r=X(n,i);return!r||!h(J,i)||h(n,B)&&n[B][i]||(r.enumerable=!0),r}},he=function(e){var t=K(g(e)),n=[];return U(t,(function(e){h(J,e)||h(R,e)||n.push(e)})),n},de=function(e){var t=e===W,n=K(t?Q:g(e)),i=[];return U(n,(function(e){!h(J,e)||t&&!h(W,e)||i.push(J[e])})),i};(l||(C((j=function(){if(this instanceof j)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=D(e),n=function(e){this===W&&n.call(Q,e),h(this,B)&&h(this[B],t)&&(this[B][t]=!1),re(this,t,y(1,e))};return s&&ie&&re(W,t,{configurable:!0,set:n}),oe(t,e)}).prototype,"toString",(function(){return H(this).tag})),C(j,"withoutSetter",(function(e){return oe(D(e),e)})),M.f=ce,A.f=se,S.f=ue,x.f=E.f=he,w.f=de,O.f=function(e){return oe(I(e),e)},s&&(Y(j.prototype,"description",{configurable:!0,get:function(){return H(this).description}}),a||C(W,"propertyIsEnumerable",ce,{unsafe:!0}))),i({global:!0,wrap:!0,forced:!l,sham:!l},{Symbol:j}),U(_(te),(function(e){N(e)})),i({target:V,stat:!0,forced:!l},{for:function(e){var t=String(e);if(h($,t))return $[t];var n=j(t);return $[t]=n,ee[n]=t,n},keyFor:function(e){if(!ae(e))throw TypeError(e+" is not a symbol");if(h(ee,e))return ee[e]},useSetter:function(){ie=!0},useSimple:function(){ie=!1}}),i({target:"Object",stat:!0,forced:!l,sham:!s},{create:function(e,t){return void 0===t?b(e):le(b(e),t)},defineProperty:se,defineProperties:le,getOwnPropertyDescriptor:ue}),i({target:"Object",stat:!0,forced:!l},{getOwnPropertyNames:he,getOwnPropertySymbols:de}),i({target:"Object",stat:!0,forced:u((function(){w.f(1)}))},{getOwnPropertySymbols:function(e){return w.f(m(e))}}),q)&&i({target:"JSON",stat:!0,forced:!l||u((function(){var e=j();return"[null]"!=q([e])||"{}"!=q({a:e})||"{}"!=q(Object(e))}))},{stringify:function(e,t,n){for(var i,r=[e],o=1;arguments.length>o;)r.push(arguments[o++]);if(i=t,(p(t)||void 0!==e)&&!ae(e))return d(t)||(t=function(e,t){if("function"==typeof i&&(t=i.call(this,e,t)),!ae(t))return t}),r[1]=t,q.apply(null,r)}});j.prototype[G]||T(j.prototype,G,j.prototype.valueOf),k(j,V),R[B]=!0},69007:(e,t,n)=>{n(97235)("match")},83510:(e,t,n)=>{n(97235)("replace")},41840:(e,t,n)=>{n(97235)("search")},6982:(e,t,n)=>{n(97235)("species")},32159:(e,t,n)=>{n(97235)("split")},96649:(e,t,n)=>{n(97235)("toPrimitive")},39341:(e,t,n)=>{n(97235)("toStringTag")},60543:(e,t,n)=>{n(97235)("unscopables")},92990:(e,t,n)=>{"use strict";var i=n(90260),r=n(1048),o=i.aTypedArray;(0,i.exportTypedArrayMethod)("copyWithin",(function(e,t){return r.call(o(this),e,t,arguments.length>2?arguments[2]:void 0)}))},18927:(e,t,n)=>{"use strict";var i=n(90260),r=n(42092).every,o=i.aTypedArray;(0,i.exportTypedArrayMethod)("every",(function(e){return r(o(this),e,arguments.length>1?arguments[1]:void 0)}))},33105:(e,t,n)=>{"use strict";var i=n(90260),r=n(21285),o=i.aTypedArray;(0,i.exportTypedArrayMethod)("fill",(function(e){return r.apply(o(this),arguments)}))},35035:(e,t,n)=>{"use strict";var i=n(90260),r=n(42092).filter,o=n(36707),a=i.aTypedArray,s=i.aTypedArrayConstructor;(0,i.exportTypedArrayMethod)("filter",(function(e){for(var t=r(a(this),e,arguments.length>1?arguments[1]:void 0),n=o(this,this.constructor),i=0,l=t.length,c=new(s(n))(l);l>i;)c[i]=t[i++];return c}))},7174:(e,t,n)=>{"use strict";var i=n(90260),r=n(42092).findIndex,o=i.aTypedArray;(0,i.exportTypedArrayMethod)("findIndex",(function(e){return r(o(this),e,arguments.length>1?arguments[1]:void 0)}))},74345:(e,t,n)=>{"use strict";var i=n(90260),r=n(42092).find,o=i.aTypedArray;(0,i.exportTypedArrayMethod)("find",(function(e){return r(o(this),e,arguments.length>1?arguments[1]:void 0)}))},44197:(e,t,n)=>{n(19843)("Float32",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},76495:(e,t,n)=>{n(19843)("Float64",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},32846:(e,t,n)=>{"use strict";var i=n(90260),r=n(42092).forEach,o=i.aTypedArray;(0,i.exportTypedArrayMethod)("forEach",(function(e){r(o(this),e,arguments.length>1?arguments[1]:void 0)}))},98145:(e,t,n)=>{"use strict";var i=n(63832);(0,n(90260).exportTypedArrayStaticMethod)("from",n(97321),i)},44731:(e,t,n)=>{"use strict";var i=n(90260),r=n(41318).includes,o=i.aTypedArray;(0,i.exportTypedArrayMethod)("includes",(function(e){return r(o(this),e,arguments.length>1?arguments[1]:void 0)}))},77209:(e,t,n)=>{"use strict";var i=n(90260),r=n(41318).indexOf,o=i.aTypedArray;(0,i.exportTypedArrayMethod)("indexOf",(function(e){return r(o(this),e,arguments.length>1?arguments[1]:void 0)}))},35109:(e,t,n)=>{n(19843)("Int16",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},65125:(e,t,n)=>{n(19843)("Int32",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},87145:(e,t,n)=>{n(19843)("Int8",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},96319:(e,t,n)=>{"use strict";var i=n(17854),r=n(90260),o=n(66992),a=n(5112)("iterator"),s=i.Uint8Array,l=o.values,c=o.keys,u=o.entries,h=r.aTypedArray,d=r.exportTypedArrayMethod,p=s&&s.prototype[a],f=!!p&&("values"==p.name||null==p.name),m=function(){return l.call(h(this))};d("entries",(function(){return u.call(h(this))})),d("keys",(function(){return c.call(h(this))})),d("values",m,!f),d(a,m,!f)},58867:(e,t,n)=>{"use strict";var i=n(90260),r=i.aTypedArray,o=i.exportTypedArrayMethod,a=[].join;o("join",(function(e){return a.apply(r(this),arguments)}))},37789:(e,t,n)=>{"use strict";var i=n(90260),r=n(86583),o=i.aTypedArray;(0,i.exportTypedArrayMethod)("lastIndexOf",(function(e){return r.apply(o(this),arguments)}))},33739:(e,t,n)=>{"use strict";var i=n(90260),r=n(42092).map,o=n(36707),a=i.aTypedArray,s=i.aTypedArrayConstructor;(0,i.exportTypedArrayMethod)("map",(function(e){return r(a(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(s(o(e,e.constructor)))(t)}))}))},95206:(e,t,n)=>{"use strict";var i=n(90260),r=n(63832),o=i.aTypedArrayConstructor;(0,i.exportTypedArrayStaticMethod)("of",(function(){for(var e=0,t=arguments.length,n=new(o(this))(t);t>e;)n[e]=arguments[e++];return n}),r)},14483:(e,t,n)=>{"use strict";var i=n(90260),r=n(53671).right,o=i.aTypedArray;(0,i.exportTypedArrayMethod)("reduceRight",(function(e){return r(o(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)}))},29368:(e,t,n)=>{"use strict";var i=n(90260),r=n(53671).left,o=i.aTypedArray;(0,i.exportTypedArrayMethod)("reduce",(function(e){return r(o(this),e,arguments.length,arguments.length>1?arguments[1]:void 0)}))},12056:(e,t,n)=>{"use strict";var i=n(90260),r=i.aTypedArray,o=i.exportTypedArrayMethod,a=Math.floor;o("reverse",(function(){for(var e,t=this,n=r(t).length,i=a(n/2),o=0;o<i;)e=t[o],t[o++]=t[--n],t[n]=e;return t}))},3462:(e,t,n)=>{"use strict";var i=n(90260),r=n(17466),o=n(84590),a=n(47908),s=n(47293),l=i.aTypedArray;(0,i.exportTypedArrayMethod)("set",(function(e){l(this);var t=o(arguments.length>1?arguments[1]:void 0,1),n=this.length,i=a(e),s=r(i.length),c=0;if(s+t>n)throw RangeError("Wrong length");for(;c<s;)this[t+c]=i[c++]}),s((function(){new Int8Array(1).set({})})))},30678:(e,t,n)=>{"use strict";var i=n(90260),r=n(36707),o=n(47293),a=i.aTypedArray,s=i.aTypedArrayConstructor,l=i.exportTypedArrayMethod,c=[].slice;l("slice",(function(e,t){for(var n=c.call(a(this),e,t),i=r(this,this.constructor),o=0,l=n.length,u=new(s(i))(l);l>o;)u[o]=n[o++];return u}),o((function(){new Int8Array(1).slice()})))},27462:(e,t,n)=>{"use strict";var i=n(90260),r=n(42092).some,o=i.aTypedArray;(0,i.exportTypedArrayMethod)("some",(function(e){return r(o(this),e,arguments.length>1?arguments[1]:void 0)}))},33824:(e,t,n)=>{"use strict";var i=n(90260),r=i.aTypedArray,o=i.exportTypedArrayMethod,a=[].sort;o("sort",(function(e){return a.call(r(this),e)}))},55021:(e,t,n)=>{"use strict";var i=n(90260),r=n(17466),o=n(51400),a=n(36707),s=i.aTypedArray;(0,i.exportTypedArrayMethod)("subarray",(function(e,t){var n=s(this),i=n.length,l=o(e,i);return new(a(n,n.constructor))(n.buffer,n.byteOffset+l*n.BYTES_PER_ELEMENT,r((void 0===t?i:o(t,i))-l))}))},12974:(e,t,n)=>{"use strict";var i=n(17854),r=n(90260),o=n(47293),a=i.Int8Array,s=r.aTypedArray,l=r.exportTypedArrayMethod,c=[].toLocaleString,u=[].slice,h=!!a&&o((function(){c.call(new a(1))}));l("toLocaleString",(function(){return c.apply(h?u.call(s(this)):s(this),arguments)}),o((function(){return[1,2].toLocaleString()!=new a([1,2]).toLocaleString()}))||!o((function(){a.prototype.toLocaleString.call([1,2])})))},15016:(e,t,n)=>{"use strict";var i=n(90260).exportTypedArrayMethod,r=n(47293),o=n(17854).Uint8Array,a=o&&o.prototype||{},s=[].toString,l=[].join;r((function(){s.call({})}))&&(s=function(){return l.call(this)});var c=a.toString!=s;i("toString",s,c)},8255:(e,t,n)=>{n(19843)("Uint16",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},29135:(e,t,n)=>{n(19843)("Uint32",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},82472:(e,t,n)=>{n(19843)("Uint8",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},49743:(e,t,n)=>{n(19843)("Uint8",(function(e){return function(t,n,i){return e(this,t,n,i)}}),!0)},4129:(e,t,n)=>{"use strict";var i,r=n(17854),o=n(12248),a=n(62423),s=n(77710),l=n(29320),c=n(70111),u=n(29909).enforce,h=n(68536),d=!r.ActiveXObject&&"ActiveXObject"in r,p=Object.isExtensible,f=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},m=e.exports=s("WeakMap",f,l);if(h&&d){i=l.getConstructor(f,"WeakMap",!0),a.REQUIRED=!0;var g=m.prototype,v=g.delete,y=g.has,b=g.get,_=g.set;o(g,{delete:function(e){if(c(e)&&!p(e)){var t=u(this);return t.frozen||(t.frozen=new i),v.call(this,e)||t.frozen.delete(e)}return v.call(this,e)},has:function(e){if(c(e)&&!p(e)){var t=u(this);return t.frozen||(t.frozen=new i),y.call(this,e)||t.frozen.has(e)}return y.call(this,e)},get:function(e){if(c(e)&&!p(e)){var t=u(this);return t.frozen||(t.frozen=new i),y.call(this,e)?b.call(this,e):t.frozen.get(e)}return b.call(this,e)},set:function(e,t){if(c(e)&&!p(e)){var n=u(this);n.frozen||(n.frozen=new i),y.call(this,e)?_.call(this,e,t):n.frozen.set(e,t)}else _.call(this,e,t);return this}})}},38478:(e,t,n)=>{"use strict";n(77710)("WeakSet",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(29320))},8628:(e,t,n)=>{"use strict";var i=n(82109),r=n(19781),o=n(79518),a=n(27674),s=n(70030),l=n(3070),c=n(79114),u=n(20408),h=n(68880),d=n(29909),p=d.set,f=d.getterFor("AggregateError"),m=function(e,t){var n=this;if(!(n instanceof m))return new m(e,t);a&&(n=a(new Error(t),o(n)));var i=[];return u(e,i.push,i),r?p(n,{errors:i,type:"AggregateError"}):n.errors=i,void 0!==t&&h(n,"message",String(t)),n};m.prototype=s(Error.prototype,{constructor:c(5,m),message:c(5,""),name:c(5,"AggregateError")}),r&&l.f(m.prototype,"errors",{get:function(){return f(this).errors},configurable:!0}),i({global:!0},{AggregateError:m})},83475:(e,t,n)=>{"use strict";var i=n(19781),r=n(51223),o=n(47908),a=n(17466),s=n(3070).f;i&&!("lastIndex"in[])&&(s(Array.prototype,"lastIndex",{configurable:!0,get:function(){var e=o(this),t=a(e.length);return 0==t?0:t-1}}),r("lastIndex"))},46273:(e,t,n)=>{"use strict";var i=n(19781),r=n(51223),o=n(47908),a=n(17466),s=n(3070).f;i&&!("lastItem"in[])&&(s(Array.prototype,"lastItem",{configurable:!0,get:function(){var e=o(this),t=a(e.length);return 0==t?void 0:e[t-1]},set:function(e){var t=o(this),n=a(t.length);return t[0==n?0:n-1]=e}}),r("lastItem"))},51568:(e,t,n)=>{var i=n(82109),r=n(10313),o=n(35005),a=n(70030),s=function(){var e=o("Object","freeze");return e?e(a(null)):a(null)};i({global:!0},{compositeKey:function(){return r.apply(Object,arguments).get("object",s)}})},26349:(e,t,n)=>{var i=n(82109),r=n(10313),o=n(35005);i({global:!0},{compositeSymbol:function(){return 1===arguments.length&&"string"==typeof arguments[0]?o("Symbol").for(arguments[0]):r.apply(null,arguments).get("symbol",o("Symbol"))}})},65743:(e,t,n)=>{n(35837)},10072:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(34092);i({target:"Map",proto:!0,real:!0,forced:r},{deleteAll:function(){return o.apply(this,arguments)}})},99137:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(19670),a=n(49974),s=n(54647),l=n(20408);i({target:"Map",proto:!0,real:!0,forced:r},{every:function(e){var t=o(this),n=s(t),i=a(e,arguments.length>1?arguments[1]:void 0,3);return!l(n,(function(e,n){if(!i(n,e,t))return l.stop()}),void 0,!0,!0).stopped}})},71957:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(35005),a=n(19670),s=n(13099),l=n(49974),c=n(36707),u=n(54647),h=n(20408);i({target:"Map",proto:!0,real:!0,forced:r},{filter:function(e){var t=a(this),n=u(t),i=l(e,arguments.length>1?arguments[1]:void 0,3),r=new(c(t,o("Map"))),d=s(r.set);return h(n,(function(e,n){i(n,e,t)&&d.call(r,e,n)}),void 0,!0,!0),r}})},103:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(19670),a=n(49974),s=n(54647),l=n(20408);i({target:"Map",proto:!0,real:!0,forced:r},{findKey:function(e){var t=o(this),n=s(t),i=a(e,arguments.length>1?arguments[1]:void 0,3);return l(n,(function(e,n){if(i(n,e,t))return l.stop(e)}),void 0,!0,!0).result}})},96306:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(19670),a=n(49974),s=n(54647),l=n(20408);i({target:"Map",proto:!0,real:!0,forced:r},{find:function(e){var t=o(this),n=s(t),i=a(e,arguments.length>1?arguments[1]:void 0,3);return l(n,(function(e,n){if(i(n,e,t))return l.stop(n)}),void 0,!0,!0).result}})},8582:(e,t,n)=>{n(82109)({target:"Map",stat:!0},{from:n(27296)})},90618:(e,t,n)=>{"use strict";var i=n(82109),r=n(20408),o=n(13099);i({target:"Map",stat:!0},{groupBy:function(e,t){var n=new this;o(t);var i=o(n.has),a=o(n.get),s=o(n.set);return r(e,(function(e){var r=t(e);i.call(n,r)?a.call(n,r).push(e):s.call(n,r,[e])})),n}})},74592:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(19670),a=n(54647),s=n(46465),l=n(20408);i({target:"Map",proto:!0,real:!0,forced:r},{includes:function(e){return l(a(o(this)),(function(t,n){if(s(n,e))return l.stop()}),void 0,!0,!0).stopped}})},88440:(e,t,n)=>{"use strict";var i=n(82109),r=n(20408),o=n(13099);i({target:"Map",stat:!0},{keyBy:function(e,t){var n=new this;o(t);var i=o(n.set);return r(e,(function(e){i.call(n,t(e),e)})),n}})},58276:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(19670),a=n(54647),s=n(20408);i({target:"Map",proto:!0,real:!0,forced:r},{keyOf:function(e){return s(a(o(this)),(function(t,n){if(n===e)return s.stop(t)}),void 0,!0,!0).result}})},35082:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(35005),a=n(19670),s=n(13099),l=n(49974),c=n(36707),u=n(54647),h=n(20408);i({target:"Map",proto:!0,real:!0,forced:r},{mapKeys:function(e){var t=a(this),n=u(t),i=l(e,arguments.length>1?arguments[1]:void 0,3),r=new(c(t,o("Map"))),d=s(r.set);return h(n,(function(e,n){d.call(r,i(n,e,t),n)}),void 0,!0,!0),r}})},12813:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(35005),a=n(19670),s=n(13099),l=n(49974),c=n(36707),u=n(54647),h=n(20408);i({target:"Map",proto:!0,real:!0,forced:r},{mapValues:function(e){var t=a(this),n=u(t),i=l(e,arguments.length>1?arguments[1]:void 0,3),r=new(c(t,o("Map"))),d=s(r.set);return h(n,(function(e,n){d.call(r,e,i(n,e,t))}),void 0,!0,!0),r}})},18222:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(19670),a=n(13099),s=n(20408);i({target:"Map",proto:!0,real:!0,forced:r},{merge:function(e){for(var t=o(this),n=a(t.set),i=0;i<arguments.length;)s(arguments[i++],n,t,!0);return t}})},24838:(e,t,n)=>{n(82109)({target:"Map",stat:!0},{of:n(82044)})},38563:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(19670),a=n(13099),s=n(54647),l=n(20408);i({target:"Map",proto:!0,real:!0,forced:r},{reduce:function(e){var t=o(this),n=s(t),i=arguments.length<2,r=i?void 0:arguments[1];if(a(e),l(n,(function(n,o){i?(i=!1,r=o):r=e(r,o,n,t)}),void 0,!0,!0),i)throw TypeError("Reduce of empty map with no initial value");return r}})},50336:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(19670),a=n(49974),s=n(54647),l=n(20408);i({target:"Map",proto:!0,real:!0,forced:r},{some:function(e){var t=o(this),n=s(t),i=a(e,arguments.length>1?arguments[1]:void 0,3);return l(n,(function(e,n){if(i(n,e,t))return l.stop()}),void 0,!0,!0).stopped}})},7512:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(19670),a=n(13099);i({target:"Map",proto:!0,real:!0,forced:r},{update:function(e,t){var n=o(this),i=arguments.length;a(t);var r=n.has(e);if(!r&&i<3)throw TypeError("Updating absent value");var s=r?n.get(e):a(i>2?arguments[2]:void 0)(e,n);return n.set(e,t(s,e,n)),n}})},46603:(e,t,n)=>{var i=n(82109),r=Math.min,o=Math.max;i({target:"Math",stat:!0},{clamp:function(e,t,n){return r(n,o(t,e))}})},70100:(e,t,n)=>{n(82109)({target:"Math",stat:!0},{DEG_PER_RAD:Math.PI/180})},10490:(e,t,n)=>{var i=n(82109),r=180/Math.PI;i({target:"Math",stat:!0},{degrees:function(e){return e*r}})},13187:(e,t,n)=>{var i=n(82109),r=n(47103),o=n(26130);i({target:"Math",stat:!0},{fscale:function(e,t,n,i,a){return o(r(e,t,n,i,a))}})},60092:(e,t,n)=>{n(82109)({target:"Math",stat:!0},{iaddh:function(e,t,n,i){var r=e>>>0,o=n>>>0;return(t>>>0)+(i>>>0)+((r&o|(r|o)&~(r+o>>>0))>>>31)|0}})},19041:(e,t,n)=>{n(82109)({target:"Math",stat:!0},{imulh:function(e,t){var n=65535,i=+e,r=+t,o=i&n,a=r&n,s=i>>16,l=r>>16,c=(s*a>>>0)+(o*a>>>16);return s*l+(c>>16)+((o*l>>>0)+(c&n)>>16)}})},30666:(e,t,n)=>{n(82109)({target:"Math",stat:!0},{isubh:function(e,t,n,i){var r=e>>>0,o=n>>>0;return(t>>>0)-(i>>>0)-((~r&o|~(r^o)&r-o>>>0)>>>31)|0}})},51638:(e,t,n)=>{n(82109)({target:"Math",stat:!0},{RAD_PER_DEG:180/Math.PI})},62975:(e,t,n)=>{var i=n(82109),r=Math.PI/180;i({target:"Math",stat:!0},{radians:function(e){return e*r}})},15728:(e,t,n)=>{n(82109)({target:"Math",stat:!0},{scale:n(47103)})},46056:(e,t,n)=>{var i=n(82109),r=n(19670),o=n(77023),a=n(24994),s=n(29909),l="Seeded Random",c="Seeded Random Generator",u=s.set,h=s.getterFor(c),d=a((function(e){u(this,{type:c,seed:e%2147483647})}),l,(function(){var e=h(this);return{value:(1073741823&(e.seed=(1103515245*e.seed+12345)%2147483647))/1073741823,done:!1}}));i({target:"Math",stat:!0,forced:!0},{seededPRNG:function(e){var t=r(e).seed;if(!o(t))throw TypeError('Math.seededPRNG() argument should have a "seed" field with a finite value.');return new d(t)}})},44299:(e,t,n)=>{n(82109)({target:"Math",stat:!0},{signbit:function(e){return(e=+e)==e&&0==e?1/e==-1/0:e<0}})},5162:(e,t,n)=>{n(82109)({target:"Math",stat:!0},{umulh:function(e,t){var n=65535,i=+e,r=+t,o=i&n,a=r&n,s=i>>>16,l=r>>>16,c=(s*a>>>0)+(o*a>>>16);return s*l+(c>>>16)+((o*l>>>0)+(c&n)>>>16)}})},50292:(e,t,n)=>{"use strict";var i=n(82109),r=n(99958),o=n(83009),a="Invalid number representation",s=/^[\da-z]+$/;i({target:"Number",stat:!0},{fromString:function(e,t){var n,i,l=1;if("string"!=typeof e)throw TypeError(a);if(!e.length)throw SyntaxError(a);if("-"==e.charAt(0)&&(l=-1,!(e=e.slice(1)).length))throw SyntaxError(a);if((n=void 0===t?10:r(t))<2||n>36)throw RangeError("Invalid radix");if(!s.test(e)||(i=o(e,n)).toString(n)!==e)throw SyntaxError(a);return l*i}})},1025:(e,t,n)=>{"use strict";var i=n(82109),r=n(19781),o=n(96340),a=n(13099),s=n(19670),l=n(70111),c=n(25787),u=n(3070).f,h=n(68880),d=n(12248),p=n(18554),f=n(20408),m=n(842),g=n(5112),v=n(29909),y=g("observable"),b=v.get,_=v.set,x=function(e){return null==e?void 0:a(e)},E=function(e){var t=e.cleanup;if(t){e.cleanup=void 0;try{t()}catch(e){m(e)}}},w=function(e){return void 0===e.observer},S=function(e,t){if(!r){e.closed=!0;var n=t.subscriptionObserver;n&&(n.closed=!0)}t.observer=void 0},A=function(e,t){var n,i=_(this,{cleanup:void 0,observer:s(e),subscriptionObserver:void 0});r||(this.closed=!1);try{(n=x(e.start))&&n.call(e,this)}catch(e){m(e)}if(!w(i)){var o=i.subscriptionObserver=new M(this);try{var l=t(o),c=l;null!=l&&(i.cleanup="function"==typeof l.unsubscribe?function(){c.unsubscribe()}:a(l))}catch(e){return void o.error(e)}w(i)&&E(i)}};A.prototype=d({},{unsubscribe:function(){var e=b(this);w(e)||(S(this,e),E(e))}}),r&&u(A.prototype,"closed",{configurable:!0,get:function(){return w(b(this))}});var M=function(e){_(this,{subscription:e}),r||(this.closed=!1)};M.prototype=d({},{next:function(e){var t=b(b(this).subscription);if(!w(t)){var n=t.observer;try{var i=x(n.next);i&&i.call(n,e)}catch(e){m(e)}}},error:function(e){var t=b(this).subscription,n=b(t);if(!w(n)){var i=n.observer;S(t,n);try{var r=x(i.error);r?r.call(i,e):m(e)}catch(e){m(e)}E(n)}},complete:function(){var e=b(this).subscription,t=b(e);if(!w(t)){var n=t.observer;S(e,t);try{var i=x(n.complete);i&&i.call(n)}catch(e){m(e)}E(t)}}}),r&&u(M.prototype,"closed",{configurable:!0,get:function(){return w(b(b(this).subscription))}});var T=function(e){c(this,T,"Observable"),_(this,{subscriber:a(e)})};d(T.prototype,{subscribe:function(e){var t=arguments.length;return new A("function"==typeof e?{next:e,error:t>1?arguments[1]:void 0,complete:t>2?arguments[2]:void 0}:l(e)?e:{},b(this).subscriber)}}),d(T,{from:function(e){var t="function"==typeof this?this:T,n=x(s(e)[y]);if(n){var i=s(n.call(e));return i.constructor===t?i:new t((function(e){return i.subscribe(e)}))}var r=p(e);return new t((function(e){f(r,(function(t){if(e.next(t),e.closed)return f.stop()}),void 0,!1,!0),e.complete()}))},of:function(){for(var e="function"==typeof this?this:T,t=arguments.length,n=new Array(t),i=0;i<t;)n[i]=arguments[i++];return new e((function(e){for(var i=0;i<t;i++)if(e.next(n[i]),e.closed)return;e.complete()}))}}),h(T.prototype,y,(function(){return this})),i({global:!0},{Observable:T}),o("Observable")},97314:(e,t,n)=>{n(17922)},96290:(e,t,n)=>{"use strict";var i=n(82109),r=n(13099),o=n(35005),a=n(78523),s=n(12534),l=n(20408),c="No one promise resolved";i({target:"Promise",stat:!0},{any:function(e){var t=this,n=a.f(t),i=n.resolve,u=n.reject,h=s((function(){var n=r(t.resolve),a=[],s=0,h=1,d=!1;l(e,(function(e){var r=s++,l=!1;a.push(void 0),h++,n.call(t,e).then((function(e){l||d||(d=!0,i(e))}),(function(e){l||d||(l=!0,a[r]=e,--h||u(new(o("AggregateError"))(a,c)))}))})),--h||u(new(o("AggregateError"))(a,c))}));return h.error&&u(h.value),n.promise}})},77479:(e,t,n)=>{"use strict";var i=n(82109),r=n(78523),o=n(12534);i({target:"Promise",stat:!0},{try:function(e){var t=r.f(this),n=o(e);return(n.error?t.reject:t.resolve)(n.value),t.promise}})},34582:(e,t,n)=>{var i=n(82109),r=n(38845),o=n(19670),a=r.toKey,s=r.set;i({target:"Reflect",stat:!0},{defineMetadata:function(e,t,n){var i=arguments.length<4?void 0:a(arguments[3]);s(e,t,o(n),i)}})},47896:(e,t,n)=>{var i=n(82109),r=n(38845),o=n(19670),a=r.toKey,s=r.getMap,l=r.store;i({target:"Reflect",stat:!0},{deleteMetadata:function(e,t){var n=arguments.length<3?void 0:a(arguments[2]),i=s(o(t),n,!1);if(void 0===i||!i.delete(e))return!1;if(i.size)return!0;var r=l.get(t);return r.delete(n),!!r.size||l.delete(t)}})},98558:(e,t,n)=>{var i=n(82109),r=n(70189),o=n(38845),a=n(19670),s=n(79518),l=n(20408),c=o.keys,u=o.toKey,h=function(e,t){var n=c(e,t),i=s(e);if(null===i)return n;var o,a,u=h(i,t);return u.length?n.length?(o=new r(n.concat(u)),l(o,(a=[]).push,a),a):u:n};i({target:"Reflect",stat:!0},{getMetadataKeys:function(e){var t=arguments.length<2?void 0:u(arguments[1]);return h(a(e),t)}})},12647:(e,t,n)=>{var i=n(82109),r=n(38845),o=n(19670),a=n(79518),s=r.has,l=r.get,c=r.toKey,u=function(e,t,n){if(s(e,t,n))return l(e,t,n);var i=a(t);return null!==i?u(e,i,n):void 0};i({target:"Reflect",stat:!0},{getMetadata:function(e,t){var n=arguments.length<3?void 0:c(arguments[2]);return u(e,o(t),n)}})},97507:(e,t,n)=>{var i=n(82109),r=n(38845),o=n(19670),a=r.keys,s=r.toKey;i({target:"Reflect",stat:!0},{getOwnMetadataKeys:function(e){var t=arguments.length<2?void 0:s(arguments[1]);return a(o(e),t)}})},84018:(e,t,n)=>{var i=n(82109),r=n(38845),o=n(19670),a=r.get,s=r.toKey;i({target:"Reflect",stat:!0},{getOwnMetadata:function(e,t){var n=arguments.length<3?void 0:s(arguments[2]);return a(e,o(t),n)}})},61605:(e,t,n)=>{var i=n(82109),r=n(38845),o=n(19670),a=n(79518),s=r.has,l=r.toKey,c=function(e,t,n){if(s(e,t,n))return!0;var i=a(t);return null!==i&&c(e,i,n)};i({target:"Reflect",stat:!0},{hasMetadata:function(e,t){var n=arguments.length<3?void 0:l(arguments[2]);return c(e,o(t),n)}})},49076:(e,t,n)=>{var i=n(82109),r=n(38845),o=n(19670),a=r.has,s=r.toKey;i({target:"Reflect",stat:!0},{hasOwnMetadata:function(e,t){var n=arguments.length<3?void 0:s(arguments[2]);return a(e,o(t),n)}})},34999:(e,t,n)=>{var i=n(82109),r=n(38845),o=n(19670),a=r.toKey,s=r.set;i({target:"Reflect",stat:!0},{metadata:function(e,t){return function(n,i){s(e,t,o(n),a(i))}}})},88921:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(31501);i({target:"Set",proto:!0,real:!0,forced:r},{addAll:function(){return o.apply(this,arguments)}})},96248:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(34092);i({target:"Set",proto:!0,real:!0,forced:r},{deleteAll:function(){return o.apply(this,arguments)}})},13599:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(35005),a=n(19670),s=n(13099),l=n(36707),c=n(20408);i({target:"Set",proto:!0,real:!0,forced:r},{difference:function(e){var t=a(this),n=new(l(t,o("Set")))(t),i=s(n.delete);return c(e,(function(e){i.call(n,e)})),n}})},11477:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(19670),a=n(49974),s=n(96767),l=n(20408);i({target:"Set",proto:!0,real:!0,forced:r},{every:function(e){var t=o(this),n=s(t),i=a(e,arguments.length>1?arguments[1]:void 0,3);return!l(n,(function(e){if(!i(e,e,t))return l.stop()}),void 0,!1,!0).stopped}})},64362:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(35005),a=n(19670),s=n(13099),l=n(49974),c=n(36707),u=n(96767),h=n(20408);i({target:"Set",proto:!0,real:!0,forced:r},{filter:function(e){var t=a(this),n=u(t),i=l(e,arguments.length>1?arguments[1]:void 0,3),r=new(c(t,o("Set"))),d=s(r.add);return h(n,(function(e){i(e,e,t)&&d.call(r,e)}),void 0,!1,!0),r}})},15389:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(19670),a=n(49974),s=n(96767),l=n(20408);i({target:"Set",proto:!0,real:!0,forced:r},{find:function(e){var t=o(this),n=s(t),i=a(e,arguments.length>1?arguments[1]:void 0,3);return l(n,(function(e){if(i(e,e,t))return l.stop(e)}),void 0,!1,!0).result}})},46006:(e,t,n)=>{n(82109)({target:"Set",stat:!0},{from:n(27296)})},90401:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(35005),a=n(19670),s=n(13099),l=n(36707),c=n(20408);i({target:"Set",proto:!0,real:!0,forced:r},{intersection:function(e){var t=a(this),n=new(l(t,o("Set"))),i=s(t.has),r=s(n.add);return c(e,(function(e){i.call(t,e)&&r.call(n,e)})),n}})},45164:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(19670),a=n(13099),s=n(20408);i({target:"Set",proto:!0,real:!0,forced:r},{isDisjointFrom:function(e){var t=o(this),n=a(t.has);return!s(e,(function(e){if(!0===n.call(t,e))return s.stop()})).stopped}})},91238:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(35005),a=n(19670),s=n(13099),l=n(18554),c=n(20408);i({target:"Set",proto:!0,real:!0,forced:r},{isSubsetOf:function(e){var t=l(this),n=a(e),i=n.has;return"function"!=typeof i&&(n=new(o("Set"))(e),i=s(n.has)),!c(t,(function(e){if(!1===i.call(n,e))return c.stop()}),void 0,!1,!0).stopped}})},54837:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(19670),a=n(13099),s=n(20408);i({target:"Set",proto:!0,real:!0,forced:r},{isSupersetOf:function(e){var t=o(this),n=a(t.has);return!s(e,(function(e){if(!1===n.call(t,e))return s.stop()})).stopped}})},87485:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(19670),a=n(96767),s=n(20408);i({target:"Set",proto:!0,real:!0,forced:r},{join:function(e){var t=o(this),n=a(t),i=void 0===e?",":String(e),r=[];return s(n,r.push,r,!1,!0),r.join(i)}})},56767:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(35005),a=n(19670),s=n(13099),l=n(49974),c=n(36707),u=n(96767),h=n(20408);i({target:"Set",proto:!0,real:!0,forced:r},{map:function(e){var t=a(this),n=u(t),i=l(e,arguments.length>1?arguments[1]:void 0,3),r=new(c(t,o("Set"))),d=s(r.add);return h(n,(function(e){d.call(r,i(e,e,t))}),void 0,!1,!0),r}})},69916:(e,t,n)=>{n(82109)({target:"Set",stat:!0},{of:n(82044)})},76651:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(19670),a=n(13099),s=n(96767),l=n(20408);i({target:"Set",proto:!0,real:!0,forced:r},{reduce:function(e){var t=o(this),n=s(t),i=arguments.length<2,r=i?void 0:arguments[1];if(a(e),l(n,(function(n){i?(i=!1,r=n):r=e(r,n,n,t)}),void 0,!1,!0),i)throw TypeError("Reduce of empty set with no initial value");return r}})},61437:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(19670),a=n(49974),s=n(96767),l=n(20408);i({target:"Set",proto:!0,real:!0,forced:r},{some:function(e){var t=o(this),n=s(t),i=a(e,arguments.length>1?arguments[1]:void 0,3);return l(n,(function(e){if(i(e,e,t))return l.stop()}),void 0,!1,!0).stopped}})},35285:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(35005),a=n(19670),s=n(13099),l=n(36707),c=n(20408);i({target:"Set",proto:!0,real:!0,forced:r},{symmetricDifference:function(e){var t=a(this),n=new(l(t,o("Set")))(t),i=s(n.delete),r=s(n.add);return c(e,(function(e){i.call(n,e)||r.call(n,e)})),n}})},39865:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(35005),a=n(19670),s=n(13099),l=n(36707),c=n(20408);i({target:"Set",proto:!0,real:!0,forced:r},{union:function(e){var t=a(this),n=new(l(t,o("Set")))(t);return c(e,s(n.add),n),n}})},86035:(e,t,n)=>{"use strict";var i=n(82109),r=n(28710).charAt;i({target:"String",proto:!0},{at:function(e){return r(this,e)}})},67501:(e,t,n)=>{"use strict";var i=n(82109),r=n(24994),o=n(84488),a=n(29909),s=n(28710),l=s.codeAt,c=s.charAt,u="String Iterator",h=a.set,d=a.getterFor(u),p=r((function(e){h(this,{type:u,string:e,index:0})}),"String",(function(){var e,t=d(this),n=t.string,i=t.index;return i>=n.length?{value:void 0,done:!0}:(e=c(n,i),t.index+=e.length,{value:{codePoint:l(e,0),position:i},done:!1})}));i({target:"String",proto:!0},{codePoints:function(){return new p(String(o(this)))}})},13728:(e,t,n)=>{n(76373)},27207:(e,t,n)=>{"use strict";var i=n(82109),r=n(84488),o=n(47850),a=n(67066),s=n(5112),l=n(31913),c=s("replace"),u=RegExp.prototype;i({target:"String",proto:!0},{replaceAll:function e(t,n){var i,s,h,d,p,f,m,g,v=r(this);if(null!=t){if((i=o(t))&&!~String(r("flags"in u?t.flags:a.call(t))).indexOf("g"))throw TypeError("`.replaceAll` does not allow non-global regexes");if(void 0!==(s=t[c]))return s.call(t,v,n);if(l&&i)return String(v).replace(t,n)}if(h=String(v),""===(d=String(t)))return e.call(h,/(?:)/g,n);if(p=h.split(d),"function"!=typeof n)return p.join(String(n));for(m=(f=p[0]).length,g=1;g<p.length;g++)f+=String(n(d,m,h)),m+=d.length+p[g].length,f+=p[g];return f}})},21568:(e,t,n)=>{n(97235)("dispose")},48824:(e,t,n)=>{n(97235)("observable")},44130:(e,t,n)=>{n(97235)("patternMatch")},78206:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(34092);i({target:"WeakMap",proto:!0,real:!0,forced:r},{deleteAll:function(){return o.apply(this,arguments)}})},76478:(e,t,n)=>{n(82109)({target:"WeakMap",stat:!0},{from:n(27296)})},79715:(e,t,n)=>{n(82109)({target:"WeakMap",stat:!0},{of:n(82044)})},43561:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(31501);i({target:"WeakSet",proto:!0,real:!0,forced:r},{addAll:function(){return o.apply(this,arguments)}})},32049:(e,t,n)=>{"use strict";var i=n(82109),r=n(31913),o=n(34092);i({target:"WeakSet",proto:!0,real:!0,forced:r},{deleteAll:function(){return o.apply(this,arguments)}})},86020:(e,t,n)=>{n(82109)({target:"WeakSet",stat:!0},{from:n(27296)})},56585:(e,t,n)=>{n(82109)({target:"WeakSet",stat:!0},{of:n(82044)})},54747:(e,t,n)=>{var i=n(17854),r=n(48324),o=n(18533),a=n(68880);for(var s in r){var l=i[s],c=l&&l.prototype;if(c&&c.forEach!==o)try{a(c,"forEach",o)}catch(e){c.forEach=o}}},33948:(e,t,n)=>{var i=n(17854),r=n(48324),o=n(66992),a=n(68880),s=n(5112),l=s("iterator"),c=s("toStringTag"),u=o.values;for(var h in r){var d=i[h],p=d&&d.prototype;if(p){if(p[l]!==u)try{a(p,l,u)}catch(e){p[l]=u}if(p[c]||a(p,c,h),r[h])for(var f in o)if(p[f]!==o[f])try{a(p,f,o[f])}catch(e){p[f]=o[f]}}}},84633:(e,t,n)=>{var i=n(82109),r=n(17854),o=n(20261);i({global:!0,bind:!0,enumerable:!0,forced:!r.setImmediate||!r.clearImmediate},{setImmediate:o.set,clearImmediate:o.clear})},85844:(e,t,n)=>{var i=n(82109),r=n(17854),o=n(95948),a=n(84326),s=r.process,l="process"==a(s);i({global:!0,enumerable:!0,noTargetGet:!0},{queueMicrotask:function(e){var t=l&&s.domain;o(t?t.bind(e):e)}})},41637:(e,t,n)=>{"use strict";n(66992);var i=n(82109),r=n(35005),o=n(590),a=n(31320),s=n(12248),l=n(58003),c=n(24994),u=n(29909),h=n(25787),d=n(86656),p=n(49974),f=n(70648),m=n(19670),g=n(70111),v=n(70030),y=n(79114),b=n(18554),_=n(71246),x=n(5112),E=r("fetch"),w=r("Headers"),S=x("iterator"),A="URLSearchParams",M="URLSearchParamsIterator",T=u.set,C=u.getterFor(A),P=u.getterFor(M),L=/\+/g,R=Array(4),D=function(e){return R[e-1]||(R[e-1]=RegExp("((?:%[\\da-f]{2}){"+e+"})","gi"))},I=function(e){try{return decodeURIComponent(e)}catch(t){return e}},O=function(e){var t=e.replace(L," "),n=4;try{return decodeURIComponent(t)}catch(e){for(;n;)t=t.replace(D(n--),I);return t}},N=/[!'()~]|%20/g,k={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},F=function(e){return k[e]},U=function(e){return encodeURIComponent(e).replace(N,F)},B=function(e,t){if(t)for(var n,i,r=t.split("&"),o=0;o<r.length;)(n=r[o++]).length&&(i=n.split("="),e.push({key:O(i.shift()),value:O(i.join("="))}))},V=function(e){this.entries.length=0,B(this.entries,e)},G=function(e,t){if(e<t)throw TypeError("Not enough arguments")},z=c((function(e,t){T(this,{type:M,iterator:b(C(e).entries),kind:t})}),"Iterator",(function(){var e=P(this),t=e.kind,n=e.iterator.next(),i=n.value;return n.done||(n.value="keys"===t?i.key:"values"===t?i.value:[i.key,i.value]),n})),H=function(){h(this,H,A);var e,t,n,i,r,o,a,s,l,c=arguments.length>0?arguments[0]:void 0,u=this,p=[];if(T(u,{type:A,entries:p,updateURL:function(){},updateSearchParams:V}),void 0!==c)if(g(c))if("function"==typeof(e=_(c)))for(n=(t=e.call(c)).next;!(i=n.call(t)).done;){if((a=(o=(r=b(m(i.value))).next).call(r)).done||(s=o.call(r)).done||!o.call(r).done)throw TypeError("Expected sequence with length 2");p.push({key:a.value+"",value:s.value+""})}else for(l in c)d(c,l)&&p.push({key:l,value:c[l]+""});else B(p,"string"==typeof c?"?"===c.charAt(0)?c.slice(1):c:c+"")},W=H.prototype;s(W,{append:function(e,t){G(arguments.length,2);var n=C(this);n.entries.push({key:e+"",value:t+""}),n.updateURL()},delete:function(e){G(arguments.length,1);for(var t=C(this),n=t.entries,i=e+"",r=0;r<n.length;)n[r].key===i?n.splice(r,1):r++;t.updateURL()},get:function(e){G(arguments.length,1);for(var t=C(this).entries,n=e+"",i=0;i<t.length;i++)if(t[i].key===n)return t[i].value;return null},getAll:function(e){G(arguments.length,1);for(var t=C(this).entries,n=e+"",i=[],r=0;r<t.length;r++)t[r].key===n&&i.push(t[r].value);return i},has:function(e){G(arguments.length,1);for(var t=C(this).entries,n=e+"",i=0;i<t.length;)if(t[i++].key===n)return!0;return!1},set:function(e,t){G(arguments.length,1);for(var n,i=C(this),r=i.entries,o=!1,a=e+"",s=t+"",l=0;l<r.length;l++)(n=r[l]).key===a&&(o?r.splice(l--,1):(o=!0,n.value=s));o||r.push({key:a,value:s}),i.updateURL()},sort:function(){var e,t,n,i=C(this),r=i.entries,o=r.slice();for(r.length=0,n=0;n<o.length;n++){for(e=o[n],t=0;t<n;t++)if(r[t].key>e.key){r.splice(t,0,e);break}t===n&&r.push(e)}i.updateURL()},forEach:function(e){for(var t,n=C(this).entries,i=p(e,arguments.length>1?arguments[1]:void 0,3),r=0;r<n.length;)i((t=n[r++]).value,t.key,this)},keys:function(){return new z(this,"keys")},values:function(){return new z(this,"values")},entries:function(){return new z(this,"entries")}},{enumerable:!0}),a(W,S,W.entries),a(W,"toString",(function(){for(var e,t=C(this).entries,n=[],i=0;i<t.length;)e=t[i++],n.push(U(e.key)+"="+U(e.value));return n.join("&")}),{enumerable:!0}),l(H,A),i({global:!0,forced:!o},{URLSearchParams:H}),o||"function"!=typeof E||"function"!=typeof w||i({global:!0,enumerable:!0,forced:!0},{fetch:function(e){var t,n,i,r=[e];return arguments.length>1&&(g(t=arguments[1])&&(n=t.body,f(n)===A&&((i=t.headers?new w(t.headers):new w).has("content-type")||i.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),t=v(t,{body:y(0,String(n)),headers:y(0,i)}))),r.push(t)),E.apply(this,r)}}),e.exports={URLSearchParams:H,getState:C}},60285:(e,t,n)=>{"use strict";n(78783);var i,r=n(82109),o=n(19781),a=n(590),s=n(17854),l=n(36048),c=n(31320),u=n(25787),h=n(86656),d=n(21574),p=n(48457),f=n(28710).codeAt,m=n(33197),g=n(58003),v=n(41637),y=n(29909),b=s.URL,_=v.URLSearchParams,x=v.getState,E=y.set,w=y.getterFor("URL"),S=Math.floor,A=Math.pow,M="Invalid scheme",T="Invalid host",C="Invalid port",P=/[A-Za-z]/,L=/[\d+-.A-Za-z]/,R=/\d/,D=/^(0x|0X)/,I=/^[0-7]+$/,O=/^\d+$/,N=/^[\dA-Fa-f]+$/,k=/[\u0000\u0009\u000A\u000D #%/:?@[\\]]/,F=/[\u0000\u0009\u000A\u000D #/:?@[\\]]/,U=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,B=/[\u0009\u000A\u000D]/g,V=function(e,t){var n,i,r;if("["==t.charAt(0)){if("]"!=t.charAt(t.length-1))return T;if(!(n=z(t.slice(1,-1))))return T;e.host=n}else if(Z(e)){if(t=m(t),k.test(t))return T;if(null===(n=G(t)))return T;e.host=n}else{if(F.test(t))return T;for(n="",i=p(t),r=0;r<i.length;r++)n+=Y(i[r],W);e.host=n}},G=function(e){var t,n,i,r,o,a,s,l=e.split(".");if(l.length&&""==l[l.length-1]&&l.pop(),(t=l.length)>4)return e;for(n=[],i=0;i<t;i++){if(""==(r=l[i]))return e;if(o=10,r.length>1&&"0"==r.charAt(0)&&(o=D.test(r)?16:8,r=r.slice(8==o?1:2)),""===r)a=0;else{if(!(10==o?O:8==o?I:N).test(r))return e;a=parseInt(r,o)}n.push(a)}for(i=0;i<t;i++)if(a=n[i],i==t-1){if(a>=A(256,5-t))return null}else if(a>255)return null;for(s=n.pop(),i=0;i<n.length;i++)s+=n[i]*A(256,3-i);return s},z=function(e){var t,n,i,r,o,a,s,l=[0,0,0,0,0,0,0,0],c=0,u=null,h=0,d=function(){return e.charAt(h)};if(":"==d()){if(":"!=e.charAt(1))return;h+=2,u=++c}for(;d();){if(8==c)return;if(":"!=d()){for(t=n=0;n<4&&N.test(d());)t=16*t+parseInt(d(),16),h++,n++;if("."==d()){if(0==n)return;if(h-=n,c>6)return;for(i=0;d();){if(r=null,i>0){if(!("."==d()&&i<4))return;h++}if(!R.test(d()))return;for(;R.test(d());){if(o=parseInt(d(),10),null===r)r=o;else{if(0==r)return;r=10*r+o}if(r>255)return;h++}l[c]=256*l[c]+r,2!=++i&&4!=i||c++}if(4!=i)return;break}if(":"==d()){if(h++,!d())return}else if(d())return;l[c++]=t}else{if(null!==u)return;h++,u=++c}}if(null!==u)for(a=c-u,c=7;0!=c&&a>0;)s=l[c],l[c--]=l[u+a-1],l[u+--a]=s;else if(8!=c)return;return l},H=function(e){var t,n,i,r;if("number"==typeof e){for(t=[],n=0;n<4;n++)t.unshift(e%256),e=S(e/256);return t.join(".")}if("object"==typeof e){for(t="",i=function(e){for(var t=null,n=1,i=null,r=0,o=0;o<8;o++)0!==e[o]?(r>n&&(t=i,n=r),i=null,r=0):(null===i&&(i=o),++r);return r>n&&(t=i,n=r),t}(e),n=0;n<8;n++)r&&0===e[n]||(r&&(r=!1),i===n?(t+=n?":":"::",r=!0):(t+=e[n].toString(16),n<7&&(t+=":")));return"["+t+"]"}return e},W={},j=d({},W,{" ":1,'"':1,"<":1,">":1,"`":1}),q=d({},j,{"#":1,"?":1,"{":1,"}":1}),X=d({},q,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Y=function(e,t){var n=f(e,0);return n>32&&n<127&&!h(t,e)?e:encodeURIComponent(e)},K={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Z=function(e){return h(K,e.scheme)},J=function(e){return""!=e.username||""!=e.password},Q=function(e){return!e.host||e.cannotBeABaseURL||"file"==e.scheme},$=function(e,t){var n;return 2==e.length&&P.test(e.charAt(0))&&(":"==(n=e.charAt(1))||!t&&"|"==n)},ee=function(e){var t;return e.length>1&&$(e.slice(0,2))&&(2==e.length||"/"===(t=e.charAt(2))||"\\"===t||"?"===t||"#"===t)},te=function(e){var t=e.path,n=t.length;!n||"file"==e.scheme&&1==n&&$(t[0],!0)||t.pop()},ne=function(e){return"."===e||"%2e"===e.toLowerCase()},ie={},re={},oe={},ae={},se={},le={},ce={},ue={},he={},de={},pe={},fe={},me={},ge={},ve={},ye={},be={},_e={},xe={},Ee={},we={},Se=function(e,t,n,r){var o,a,s,l,c,u=n||ie,d=0,f="",m=!1,g=!1,v=!1;for(n||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,t=t.replace(U,"")),t=t.replace(B,""),o=p(t);d<=o.length;){switch(a=o[d],u){case ie:if(!a||!P.test(a)){if(n)return M;u=oe;continue}f+=a.toLowerCase(),u=re;break;case re:if(a&&(L.test(a)||"+"==a||"-"==a||"."==a))f+=a.toLowerCase();else{if(":"!=a){if(n)return M;f="",u=oe,d=0;continue}if(n&&(Z(e)!=h(K,f)||"file"==f&&(J(e)||null!==e.port)||"file"==e.scheme&&!e.host))return;if(e.scheme=f,n)return void(Z(e)&&K[e.scheme]==e.port&&(e.port=null));f="","file"==e.scheme?u=ge:Z(e)&&r&&r.scheme==e.scheme?u=ae:Z(e)?u=ue:"/"==o[d+1]?(u=se,d++):(e.cannotBeABaseURL=!0,e.path.push(""),u=xe)}break;case oe:if(!r||r.cannotBeABaseURL&&"#"!=a)return M;if(r.cannotBeABaseURL&&"#"==a){e.scheme=r.scheme,e.path=r.path.slice(),e.query=r.query,e.fragment="",e.cannotBeABaseURL=!0,u=we;break}u="file"==r.scheme?ge:le;continue;case ae:if("/"!=a||"/"!=o[d+1]){u=le;continue}u=he,d++;break;case se:if("/"==a){u=de;break}u=_e;continue;case le:if(e.scheme=r.scheme,a==i)e.username=r.username,e.password=r.password,e.host=r.host,e.port=r.port,e.path=r.path.slice(),e.query=r.query;else if("/"==a||"\\"==a&&Z(e))u=ce;else if("?"==a)e.username=r.username,e.password=r.password,e.host=r.host,e.port=r.port,e.path=r.path.slice(),e.query="",u=Ee;else{if("#"!=a){e.username=r.username,e.password=r.password,e.host=r.host,e.port=r.port,e.path=r.path.slice(),e.path.pop(),u=_e;continue}e.username=r.username,e.password=r.password,e.host=r.host,e.port=r.port,e.path=r.path.slice(),e.query=r.query,e.fragment="",u=we}break;case ce:if(!Z(e)||"/"!=a&&"\\"!=a){if("/"!=a){e.username=r.username,e.password=r.password,e.host=r.host,e.port=r.port,u=_e;continue}u=de}else u=he;break;case ue:if(u=he,"/"!=a||"/"!=f.charAt(d+1))continue;d++;break;case he:if("/"!=a&&"\\"!=a){u=de;continue}break;case de:if("@"==a){m&&(f="%40"+f),m=!0,s=p(f);for(var y=0;y<s.length;y++){var b=s[y];if(":"!=b||v){var _=Y(b,X);v?e.password+=_:e.username+=_}else v=!0}f=""}else if(a==i||"/"==a||"?"==a||"#"==a||"\\"==a&&Z(e)){if(m&&""==f)return"Invalid authority";d-=p(f).length+1,f="",u=pe}else f+=a;break;case pe:case fe:if(n&&"file"==e.scheme){u=ye;continue}if(":"!=a||g){if(a==i||"/"==a||"?"==a||"#"==a||"\\"==a&&Z(e)){if(Z(e)&&""==f)return T;if(n&&""==f&&(J(e)||null!==e.port))return;if(l=V(e,f))return l;if(f="",u=be,n)return;continue}"["==a?g=!0:"]"==a&&(g=!1),f+=a}else{if(""==f)return T;if(l=V(e,f))return l;if(f="",u=me,n==fe)return}break;case me:if(!R.test(a)){if(a==i||"/"==a||"?"==a||"#"==a||"\\"==a&&Z(e)||n){if(""!=f){var x=parseInt(f,10);if(x>65535)return C;e.port=Z(e)&&x===K[e.scheme]?null:x,f=""}if(n)return;u=be;continue}return C}f+=a;break;case ge:if(e.scheme="file","/"==a||"\\"==a)u=ve;else{if(!r||"file"!=r.scheme){u=_e;continue}if(a==i)e.host=r.host,e.path=r.path.slice(),e.query=r.query;else if("?"==a)e.host=r.host,e.path=r.path.slice(),e.query="",u=Ee;else{if("#"!=a){ee(o.slice(d).join(""))||(e.host=r.host,e.path=r.path.slice(),te(e)),u=_e;continue}e.host=r.host,e.path=r.path.slice(),e.query=r.query,e.fragment="",u=we}}break;case ve:if("/"==a||"\\"==a){u=ye;break}r&&"file"==r.scheme&&!ee(o.slice(d).join(""))&&($(r.path[0],!0)?e.path.push(r.path[0]):e.host=r.host),u=_e;continue;case ye:if(a==i||"/"==a||"\\"==a||"?"==a||"#"==a){if(!n&&$(f))u=_e;else if(""==f){if(e.host="",n)return;u=be}else{if(l=V(e,f))return l;if("localhost"==e.host&&(e.host=""),n)return;f="",u=be}continue}f+=a;break;case be:if(Z(e)){if(u=_e,"/"!=a&&"\\"!=a)continue}else if(n||"?"!=a)if(n||"#"!=a){if(a!=i&&(u=_e,"/"!=a))continue}else e.fragment="",u=we;else e.query="",u=Ee;break;case _e:if(a==i||"/"==a||"\\"==a&&Z(e)||!n&&("?"==a||"#"==a)){if(".."===(c=(c=f).toLowerCase())||"%2e."===c||".%2e"===c||"%2e%2e"===c?(te(e),"/"==a||"\\"==a&&Z(e)||e.path.push("")):ne(f)?"/"==a||"\\"==a&&Z(e)||e.path.push(""):("file"==e.scheme&&!e.path.length&&$(f)&&(e.host&&(e.host=""),f=f.charAt(0)+":"),e.path.push(f)),f="","file"==e.scheme&&(a==i||"?"==a||"#"==a))for(;e.path.length>1&&""===e.path[0];)e.path.shift();"?"==a?(e.query="",u=Ee):"#"==a&&(e.fragment="",u=we)}else f+=Y(a,q);break;case xe:"?"==a?(e.query="",u=Ee):"#"==a?(e.fragment="",u=we):a!=i&&(e.path[0]+=Y(a,W));break;case Ee:n||"#"!=a?a!=i&&("'"==a&&Z(e)?e.query+="%27":e.query+="#"==a?"%23":Y(a,W)):(e.fragment="",u=we);break;case we:a!=i&&(e.fragment+=Y(a,j))}d++}},Ae=function(e){var t,n,i=u(this,Ae,"URL"),r=arguments.length>1?arguments[1]:void 0,a=String(e),s=E(i,{type:"URL"});if(void 0!==r)if(r instanceof Ae)t=w(r);else if(n=Se(t={},String(r)))throw TypeError(n);if(n=Se(s,a,null,t))throw TypeError(n);var l=s.searchParams=new _,c=x(l);c.updateSearchParams(s.query),c.updateURL=function(){s.query=String(l)||null},o||(i.href=Te.call(i),i.origin=Ce.call(i),i.protocol=Pe.call(i),i.username=Le.call(i),i.password=Re.call(i),i.host=De.call(i),i.hostname=Ie.call(i),i.port=Oe.call(i),i.pathname=Ne.call(i),i.search=ke.call(i),i.searchParams=Fe.call(i),i.hash=Ue.call(i))},Me=Ae.prototype,Te=function(){var e=w(this),t=e.scheme,n=e.username,i=e.password,r=e.host,o=e.port,a=e.path,s=e.query,l=e.fragment,c=t+":";return null!==r?(c+="//",J(e)&&(c+=n+(i?":"+i:"")+"@"),c+=H(r),null!==o&&(c+=":"+o)):"file"==t&&(c+="//"),c+=e.cannotBeABaseURL?a[0]:a.length?"/"+a.join("/"):"",null!==s&&(c+="?"+s),null!==l&&(c+="#"+l),c},Ce=function(){var e=w(this),t=e.scheme,n=e.port;if("blob"==t)try{return new URL(t.path[0]).origin}catch(e){return"null"}return"file"!=t&&Z(e)?t+"://"+H(e.host)+(null!==n?":"+n:""):"null"},Pe=function(){return w(this).scheme+":"},Le=function(){return w(this).username},Re=function(){return w(this).password},De=function(){var e=w(this),t=e.host,n=e.port;return null===t?"":null===n?H(t):H(t)+":"+n},Ie=function(){var e=w(this).host;return null===e?"":H(e)},Oe=function(){var e=w(this).port;return null===e?"":String(e)},Ne=function(){var e=w(this),t=e.path;return e.cannotBeABaseURL?t[0]:t.length?"/"+t.join("/"):""},ke=function(){var e=w(this).query;return e?"?"+e:""},Fe=function(){return w(this).searchParams},Ue=function(){var e=w(this).fragment;return e?"#"+e:""},Be=function(e,t){return{get:e,set:t,configurable:!0,enumerable:!0}};if(o&&l(Me,{href:Be(Te,(function(e){var t=w(this),n=String(e),i=Se(t,n);if(i)throw TypeError(i);x(t.searchParams).updateSearchParams(t.query)})),origin:Be(Ce),protocol:Be(Pe,(function(e){var t=w(this);Se(t,String(e)+":",ie)})),username:Be(Le,(function(e){var t=w(this),n=p(String(e));if(!Q(t)){t.username="";for(var i=0;i<n.length;i++)t.username+=Y(n[i],X)}})),password:Be(Re,(function(e){var t=w(this),n=p(String(e));if(!Q(t)){t.password="";for(var i=0;i<n.length;i++)t.password+=Y(n[i],X)}})),host:Be(De,(function(e){var t=w(this);t.cannotBeABaseURL||Se(t,String(e),pe)})),hostname:Be(Ie,(function(e){var t=w(this);t.cannotBeABaseURL||Se(t,String(e),fe)})),port:Be(Oe,(function(e){var t=w(this);Q(t)||(""==(e=String(e))?t.port=null:Se(t,e,me))})),pathname:Be(Ne,(function(e){var t=w(this);t.cannotBeABaseURL||(t.path=[],Se(t,e+"",be))})),search:Be(ke,(function(e){var t=w(this);""==(e=String(e))?t.query=null:("?"==e.charAt(0)&&(e=e.slice(1)),t.query="",Se(t,e,Ee)),x(t.searchParams).updateSearchParams(t.query)})),searchParams:Be(Fe),hash:Be(Ue,(function(e){var t=w(this);""!=(e=String(e))?("#"==e.charAt(0)&&(e=e.slice(1)),t.fragment="",Se(t,e,we)):t.fragment=null}))}),c(Me,"toJSON",(function(){return Te.call(this)}),{enumerable:!0}),c(Me,"toString",(function(){return Te.call(this)}),{enumerable:!0}),b){var Ve=b.createObjectURL,Ge=b.revokeObjectURL;Ve&&c(Ae,"createObjectURL",(function(e){return Ve.apply(b,arguments)})),Ge&&c(Ae,"revokeObjectURL",(function(e){return Ge.apply(b,arguments)}))}g(Ae,"URL"),r({global:!0,forced:!a,sham:!o},{URL:Ae})},83753:(e,t,n)=>{"use strict";n(82109)({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}})},24414:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(33242),a=n(5076);t.backOff=function(e,t){return void 0===t&&(t={}),i(this,void 0,void 0,(function(){var n;return r(this,(function(i){switch(i.label){case 0:return n=o.getSanitizedOptions(t),[4,new s(e,n).execute()];case 1:return[2,i.sent()]}}))}))};var s=function(){function e(e,t){this.request=e,this.options=t,this.attemptNumber=0}return e.prototype.execute=function(){return i(this,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:if(this.attemptLimitReached)return[3,7];t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.applyDelay()];case 2:return t.sent(),[4,this.request()];case 3:return[2,t.sent()];case 4:return e=t.sent(),this.attemptNumber++,[4,this.options.retry(e,this.attemptNumber)];case 5:if(!t.sent()||this.attemptLimitReached)throw e;return[3,6];case 6:return[3,0];case 7:throw new Error("Something went wrong.")}}))}))},Object.defineProperty(e.prototype,"attemptLimitReached",{get:function(){return this.attemptNumber>=this.options.numOfAttempts},enumerable:!0,configurable:!0}),e.prototype.applyDelay=function(){return i(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,a.DelayFactory(this.options,this.attemptNumber).apply()];case 1:return e.sent(),[2]}}))}))},e}()},79966:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},i(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(n(21617).Delay);t.AlwaysDelay=o},21617:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(16755),r=function(){function e(e){this.options=e,this.attempt=0}return e.prototype.apply=function(){var e=this;return new Promise((function(t){return setTimeout(t,e.jitteredDelay)}))},e.prototype.setAttemptNumber=function(e){this.attempt=e},Object.defineProperty(e.prototype,"jitteredDelay",{get:function(){return i.JitterFactory(this.options)(this.delay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delay",{get:function(){var e=this.options.startingDelay,t=this.options.timeMultiple,n=this.numOfDelayedAttempts,i=e*Math.pow(t,n);return Math.min(i,this.options.maxDelay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt},enumerable:!0,configurable:!0}),e}();t.Delay=r},5076:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(21954),r=n(79966);t.DelayFactory=function(e,t){var n=function(e){if(!e.delayFirstAttempt)return new i.SkipFirstDelay(e);return new r.AlwaysDelay(e)}(e);return n.setAttemptNumber(t),n}},21954:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},i(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.apply=function(){return o(this,void 0,void 0,(function(){return a(this,(function(t){return[2,!!this.isFirstAttempt||e.prototype.apply.call(this)]}))}))},Object.defineProperty(t.prototype,"isFirstAttempt",{get:function(){return 0===this.attempt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt-1},enumerable:!0,configurable:!0}),t}(n(21617).Delay);t.SkipFirstDelay=s},59813:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fullJitter=function(e){var t=Math.random()*e;return Math.round(t)}},16755:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(59813),r=n(20478);t.JitterFactory=function(e){return"full"===e.jitter?i.fullJitter:r.noJitter}},20478:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.noJitter=function(e){return e}},33242:function(e,t){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:function(){return!0},startingDelay:100,timeMultiple:2};t.getSanitizedOptions=function(e){var t=n(n({},i),e);return t.numOfAttempts<1&&(t.numOfAttempts=1),t}},68203:function(e,t){var n="undefined"!=typeof self?self:this,i=function(){function e(){this.fetch=!1,this.DOMException=n.DOMException}return e.prototype=n,new e}();!function(e){!function(t){var n="URLSearchParams"in e,i="Symbol"in e&&"iterator"in Symbol,r="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),o="FormData"in e,a="ArrayBuffer"in e;if(a)var s=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(e){return e&&s.indexOf(Object.prototype.toString.call(e))>-1};function c(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function u(e){return"string"!=typeof e&&(e=String(e)),e}function h(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return i&&(t[Symbol.iterator]=function(){return t}),t}function d(e){this.map={},e instanceof d?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function p(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function f(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function m(e){var t=new FileReader,n=f(t);return t.readAsArrayBuffer(e),n}function g(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function v(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:r&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:o&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():a&&r&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=g(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a&&(ArrayBuffer.prototype.isPrototypeOf(e)||l(e))?this._bodyArrayBuffer=g(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r&&(this.blob=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?p(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(m)}),this.text=function(){var e,t,n,i=p(this);if(i)return i;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=f(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),i=0;i<t.length;i++)n[i]=String.fromCharCode(t[i]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}d.prototype.append=function(e,t){e=c(e),t=u(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},d.prototype.delete=function(e){delete this.map[c(e)]},d.prototype.get=function(e){return e=c(e),this.has(e)?this.map[e]:null},d.prototype.has=function(e){return this.map.hasOwnProperty(c(e))},d.prototype.set=function(e,t){this.map[c(e)]=u(t)},d.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},d.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),h(e)},d.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),h(e)},d.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),h(e)},i&&(d.prototype[Symbol.iterator]=d.prototype.entries);var y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(e,t){var n,i,r=(t=t||{}).body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new d(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new d(t.headers)),this.method=(n=t.method||this.method||"GET",i=n.toUpperCase(),y.indexOf(i)>-1?i:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function _(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),i=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(i),decodeURIComponent(r))}})),t}function x(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new d(t.headers),this.url=t.url||"",this._initBody(e)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},v.call(b.prototype),v.call(x.prototype),x.prototype.clone=function(){return new x(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},x.error=function(){var e=new x(null,{status:0,statusText:""});return e.type="error",e};var E=[301,302,303,307,308];x.redirect=function(e,t){if(-1===E.indexOf(t))throw new RangeError("Invalid status code");return new x(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function w(e,n){return new Promise((function(i,o){var a=new b(e,n);if(a.signal&&a.signal.aborted)return o(new t.DOMException("Aborted","AbortError"));var s=new XMLHttpRequest;function l(){s.abort()}s.onload=function(){var e,t,n={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new d,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),i=n.shift().trim();if(i){var r=n.join(":").trim();t.append(i,r)}})),t)};n.url="responseURL"in s?s.responseURL:n.headers.get("X-Request-URL");var r="response"in s?s.response:s.responseText;i(new x(r,n))},s.onerror=function(){o(new TypeError("Network request failed"))},s.ontimeout=function(){o(new TypeError("Network request failed"))},s.onabort=function(){o(new t.DOMException("Aborted","AbortError"))},s.open(a.method,a.url,!0),"include"===a.credentials?s.withCredentials=!0:"omit"===a.credentials&&(s.withCredentials=!1),"responseType"in s&&r&&(s.responseType="blob"),a.headers.forEach((function(e,t){s.setRequestHeader(t,e)})),a.signal&&(a.signal.addEventListener("abort",l),s.onreadystatechange=function(){4===s.readyState&&a.signal.removeEventListener("abort",l)}),s.send(void 0===a._bodyInit?null:a._bodyInit)}))}w.polyfill=!0,e.fetch||(e.fetch=w,e.Headers=d,e.Request=b,e.Response=x),t.Headers=d,t.Request=b,t.Response=x,t.fetch=w,Object.defineProperty(t,"__esModule",{value:!0})}({})}(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var r=i;(t=r.fetch).default=r.fetch,t.fetch=r.fetch,t.Headers=r.Headers,t.Request=r.Request,t.Response=r.Response,e.exports=t},71224:(e,t,n)=>{"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?Object(arguments[t]):{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){r(e,t,n[t])}))}return e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function l(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?c(e):t}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function d(e,t){return d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d(e,t)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}n.d(t,{Z:()=>j});var f={type:"logger",log:function(e){this.output("log",e)},warn:function(e){this.output("warn",e)},error:function(e){this.output("error",e)},output:function(e,t){console&&console[e]&&console[e].apply(console,t)}},m=new(function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(this,e),this.init(t,n)}return l(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||f,this.options=t,this.debug=t.debug}},{key:"setDebug",value:function(e){this.debug=e}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"log","",!0)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","",!0)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"error","")}},{key:"deprecate",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(e,t,n,i){return i&&!this.debug?null:("string"==typeof e[0]&&(e[0]="".concat(n).concat(this.prefix," ").concat(e[0])),this.logger[t](e))}},{key:"create",value:function(t){return new e(this.logger,o({},{prefix:"".concat(this.prefix,":").concat(t,":")},this.options))}}]),e}()),g=function(){function e(){a(this,e),this.observers={}}return l(e,[{key:"on",value:function(e,t){var n=this;return e.split(" ").forEach((function(e){n.observers[e]=n.observers[e]||[],n.observers[e].push(t)})),this}},{key:"off",value:function(e,t){this.observers[e]&&(t?this.observers[e]=this.observers[e].filter((function(e){return e!==t})):delete this.observers[e])}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(this.observers[e]){var r=[].concat(this.observers[e]);r.forEach((function(e){e.apply(void 0,n)}))}if(this.observers["*"]){var o=[].concat(this.observers["*"]);o.forEach((function(t){t.apply(t,[e].concat(n))}))}}}]),e}();function v(){var e,t,n=new Promise((function(n,i){e=n,t=i}));return n.resolve=e,n.reject=t,n}function y(e){return null==e?"":""+e}function b(e,t,n){e.forEach((function(e){t[e]&&(n[e]=t[e])}))}function _(e,t,n){function i(e){return e&&e.indexOf("###")>-1?e.replace(/###/g,"."):e}function r(){return!e||"string"==typeof e}for(var o="string"!=typeof t?[].concat(t):t.split(".");o.length>1;){if(r())return{};var a=i(o.shift());!e[a]&&n&&(e[a]=new n),e=Object.prototype.hasOwnProperty.call(e,a)?e[a]:{}}return r()?{}:{obj:e,k:i(o.shift())}}function x(e,t,n){var i=_(e,t,Object);i.obj[i.k]=n}function E(e,t){var n=_(e,t),i=n.obj,r=n.k;if(i)return i[r]}function w(e,t,n){var i=E(e,n);return void 0!==i?i:E(t,n)}function S(e,t,n){for(var i in t)"__proto__"!==i&&"constructor"!==i&&(i in e?"string"==typeof e[i]||e[i]instanceof String||"string"==typeof t[i]||t[i]instanceof String?n&&(e[i]=t[i]):S(e[i],t[i],n):e[i]=t[i]);return e}function A(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var M={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function T(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,(function(e){return M[e]})):e}var C="undefined"!=typeof window&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1;function P(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(e){if(e[t])return e[t];for(var i=t.split(n),r=e,o=0;o<i.length;++o){if("string"==typeof r[i[o]]&&o+1<i.length)return;if(void 0===r[i[o]]){for(var a=2,s=i.slice(o,o+a).join(n),l=r[s];void 0===l&&i.length>o+a;)a++,l=r[s=i.slice(o,o+a).join(n)];if(void 0===l)return;if("string"==typeof l)return l;if(s&&"string"==typeof l[s])return l[s];var c=i.slice(o+a).join(n);return c?P(l,c,n):void 0}r=r[i[o]]}return r}}var L=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return a(this,t),n=u(this,h(t).call(this)),C&&g.call(c(n)),n.data=e||{},n.options=i,void 0===n.options.keySeparator&&(n.options.keySeparator="."),void 0===n.options.ignoreJSONStructure&&(n.options.ignoreJSONStructure=!0),n}return p(t,e),l(t,[{key:"addNamespaces",value:function(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}},{key:"removeNamespaces",value:function(e){var t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}},{key:"getResource",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=void 0!==i.keySeparator?i.keySeparator:this.options.keySeparator,o=void 0!==i.ignoreJSONStructure?i.ignoreJSONStructure:this.options.ignoreJSONStructure,a=[e,t];n&&"string"!=typeof n&&(a=a.concat(n)),n&&"string"==typeof n&&(a=a.concat(r?n.split(r):n)),e.indexOf(".")>-1&&(a=e.split("."));var s=E(this.data,a);return s||!o||"string"!=typeof n?s:P(this.data&&this.data[e]&&this.data[e][t],n,r)}},{key:"addResource",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},o=this.options.keySeparator;void 0===o&&(o=".");var a=[e,t];n&&(a=a.concat(o?n.split(o):n)),e.indexOf(".")>-1&&(i=t,t=(a=e.split("."))[1]),this.addNamespaces(t),x(this.data,a,i),r.silent||this.emit("added",e,t,n,i)}},{key:"addResources",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(var r in n)"string"!=typeof n[r]&&"[object Array]"!==Object.prototype.toString.apply(n[r])||this.addResource(e,t,r,n[r],{silent:!0});i.silent||this.emit("added",e,t,n)}},{key:"addResourceBundle",value:function(e,t,n,i,r){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},s=[e,t];e.indexOf(".")>-1&&(i=n,n=t,t=(s=e.split("."))[1]),this.addNamespaces(t);var l=E(this.data,s)||{};i?S(l,n,r):l=o({},l,n),x(this.data,s,l),a.silent||this.emit("added",e,t,n)}},{key:"removeResourceBundle",value:function(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}},{key:"hasResourceBundle",value:function(e,t){return void 0!==this.getResource(e,t)}},{key:"getResourceBundle",value:function(e,t){return t||(t=this.options.defaultNS),"v1"===this.options.compatibilityAPI?o({},{},this.getResource(e,t)):this.getResource(e,t)}},{key:"getDataByLanguage",value:function(e){return this.data[e]}},{key:"toJSON",value:function(){return this.data}}]),t}(g),R={processors:{},addPostProcessor:function(e){this.processors[e.name]=e},handle:function(e,t,n,i,r){var o=this;return e.forEach((function(e){o.processors[e]&&(t=o.processors[e].process(t,n,i,r))})),t}},D={},I=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a(this,t),n=u(this,h(t).call(this)),C&&g.call(c(n)),b(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,c(n)),n.options=i,void 0===n.options.keySeparator&&(n.options.keySeparator="."),n.logger=m.create("translator"),n}return p(t,e),l(t,[{key:"changeLanguage",value:function(e){e&&(this.language=e)}},{key:"exists",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==e)return!1;var n=this.resolve(e,t);return n&&void 0!==n.res}},{key:"extractFromKey",value:function(e,t){var n=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");var i=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,r=t.ns||this.options.defaultNS;if(n&&e.indexOf(n)>-1){var o=e.match(this.interpolator.nestingRegexp);if(o&&o.length>0)return{key:e,namespaces:r};var a=e.split(n);(n!==i||n===i&&this.options.ns.indexOf(a[0])>-1)&&(r=a.shift()),e=a.join(i)}return"string"==typeof r&&(r=[r]),{key:e,namespaces:r}}},{key:"translate",value:function(e,n,r){var a=this;if("object"!==i(n)&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),n||(n={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);var s=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator,l=this.extractFromKey(e[e.length-1],n),c=l.key,u=l.namespaces,h=u[u.length-1],d=n.lng||this.language,p=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(d&&"cimode"===d.toLowerCase()){if(p){var f=n.nsSeparator||this.options.nsSeparator;return h+f+c}return c}var m=this.resolve(e,n),g=m&&m.res,v=m&&m.usedKey||c,y=m&&m.exactUsedKey||c,b=Object.prototype.toString.apply(g),_=["[object Number]","[object Function]","[object RegExp]"],x=void 0!==n.joinArrays?n.joinArrays:this.options.joinArrays,E=!this.i18nFormat||this.i18nFormat.handleAsObject,w="string"!=typeof g&&"boolean"!=typeof g&&"number"!=typeof g;if(E&&g&&w&&_.indexOf(b)<0&&("string"!=typeof x||"[object Array]"!==b)){if(!n.returnObjects&&!this.options.returnObjects)return this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!"),this.options.returnedObjectHandler?this.options.returnedObjectHandler(v,g,o({},n,{ns:u})):"key '".concat(c," (").concat(this.language,")' returned an object instead of string.");if(s){var S="[object Array]"===b,A=S?[]:{},M=S?y:v;for(var T in g)if(Object.prototype.hasOwnProperty.call(g,T)){var C="".concat(M).concat(s).concat(T);A[T]=this.translate(C,o({},n,{joinArrays:!1,ns:u})),A[T]===C&&(A[T]=g[T])}g=A}}else if(E&&"string"==typeof x&&"[object Array]"===b)(g=g.join(x))&&(g=this.extendTranslation(g,e,n,r));else{var P=!1,L=!1,R=void 0!==n.count&&"string"!=typeof n.count,D=t.hasDefaultValue(n),I=R?this.pluralResolver.getSuffix(d,n.count):"",O=n["defaultValue".concat(I)]||n.defaultValue;!this.isValidLookup(g)&&D&&(P=!0,g=O),this.isValidLookup(g)||(L=!0,g=c);var N=n.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey,k=N&&L?void 0:g,F=D&&O!==g&&this.options.updateMissing;if(L||P||F){if(this.logger.log(F?"updateKey":"missingKey",d,h,c,F?O:g),s){var U=this.resolve(c,o({},n,{keySeparator:!1}));U&&U.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var B=[],V=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if("fallback"===this.options.saveMissingTo&&V&&V[0])for(var G=0;G<V.length;G++)B.push(V[G]);else"all"===this.options.saveMissingTo?B=this.languageUtils.toResolveHierarchy(n.lng||this.language):B.push(n.lng||this.language);var z=function(e,t,i){a.options.missingKeyHandler?a.options.missingKeyHandler(e,h,t,F?i:k,F,n):a.backendConnector&&a.backendConnector.saveMissing&&a.backendConnector.saveMissing(e,h,t,F?i:k,F,n),a.emit("missingKey",e,h,t,g)};this.options.saveMissing&&(this.options.saveMissingPlurals&&R?B.forEach((function(e){a.pluralResolver.getSuffixes(e).forEach((function(t){z([e],c+t,n["defaultValue".concat(t)]||O)}))})):z(B,c,O))}g=this.extendTranslation(g,e,n,m,r),L&&g===c&&this.options.appendNamespaceToMissingKey&&(g="".concat(h,":").concat(c)),(L||P)&&this.options.parseMissingKeyHandler&&(g=this.options.parseMissingKeyHandler(g))}return g}},{key:"extendTranslation",value:function(e,t,n,i,r){var a=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,n,i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init(o({},n,{interpolation:o({},this.options.interpolation,n.interpolation)}));var s,l=n.interpolation&&n.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables;if(l){var c=e.match(this.interpolator.nestingRegexp);s=c&&c.length}var u=n.replace&&"string"!=typeof n.replace?n.replace:n;if(this.options.interpolation.defaultVariables&&(u=o({},this.options.interpolation.defaultVariables,u)),e=this.interpolator.interpolate(e,u,n.lng||this.language,n),l){var h=e.match(this.interpolator.nestingRegexp);s<(h&&h.length)&&(n.nest=!1)}!1!==n.nest&&(e=this.interpolator.nest(e,(function(){for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return r&&r[0]===i[0]&&!n.context?(a.logger.warn("It seems you are nesting recursively key: ".concat(i[0]," in key: ").concat(t[0])),null):a.translate.apply(a,i.concat([t]))}),n)),n.interpolation&&this.interpolator.reset()}var d=n.postProcess||this.options.postProcess,p="string"==typeof d?[d]:d;return null!=e&&p&&p.length&&!1!==n.applyPostProcessor&&(e=R.handle(p,e,t,this.options&&this.options.postProcessPassResolved?o({i18nResolved:i},n):n,this)),e}},{key:"resolve",value:function(e){var t,n,i,r,o,a=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof e&&(e=[e]),e.forEach((function(e){if(!a.isValidLookup(t)){var l=a.extractFromKey(e,s),c=l.key;n=c;var u=l.namespaces;a.options.fallbackNS&&(u=u.concat(a.options.fallbackNS));var h=void 0!==s.count&&"string"!=typeof s.count,d=void 0!==s.context&&("string"==typeof s.context||"number"==typeof s.context)&&""!==s.context,p=s.lngs?s.lngs:a.languageUtils.toResolveHierarchy(s.lng||a.language,s.fallbackLng);u.forEach((function(e){a.isValidLookup(t)||(o=e,!D["".concat(p[0],"-").concat(e)]&&a.utils&&a.utils.hasLoadedNamespace&&!a.utils.hasLoadedNamespace(o)&&(D["".concat(p[0],"-").concat(e)]=!0,a.logger.warn('key "'.concat(n,'" for languages "').concat(p.join(", "),'" won\'t get resolved as namespace "').concat(o,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),p.forEach((function(n){if(!a.isValidLookup(t)){r=n;var o,l,u=c,p=[u];if(a.i18nFormat&&a.i18nFormat.addLookupKeys)a.i18nFormat.addLookupKeys(p,c,n,e,s);else h&&(o=a.pluralResolver.getSuffix(n,s.count)),h&&d&&p.push(u+o),d&&p.push(u+="".concat(a.options.contextSeparator).concat(s.context)),h&&p.push(u+=o);for(;l=p.pop();)a.isValidLookup(t)||(i=l,t=a.getResource(n,e,l,s))}})))}))}})),{res:t,usedKey:n,exactUsedKey:i,usedLng:r,usedNS:o}}},{key:"isValidLookup",value:function(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}},{key:"getResource",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,n,i):this.resourceStore.getResource(e,t,n,i)}}],[{key:"hasDefaultValue",value:function(e){var t="defaultValue";for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t===n.substring(0,t.length)&&void 0!==e[n])return!0;return!1}}]),t}(g);function O(e){return e.charAt(0).toUpperCase()+e.slice(1)}var N=function(){function e(t){a(this,e),this.options=t,this.whitelist=this.options.supportedLngs||!1,this.supportedLngs=this.options.supportedLngs||!1,this.logger=m.create("languageUtils")}return l(e,[{key:"getScriptPartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return null;var t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}},{key:"getLanguagePartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return e;var t=e.split("-");return this.formatLanguageCode(t[0])}},{key:"formatLanguageCode",value:function(e){if("string"==typeof e&&e.indexOf("-")>-1){var t=["hans","hant","latn","cyrl","cans","mong","arab"],n=e.split("-");return this.options.lowerCaseLng?n=n.map((function(e){return e.toLowerCase()})):2===n.length?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=O(n[1].toLowerCase()))):3===n.length&&(n[0]=n[0].toLowerCase(),2===n[1].length&&(n[1]=n[1].toUpperCase()),"sgn"!==n[0]&&2===n[2].length&&(n[2]=n[2].toUpperCase()),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=O(n[1].toLowerCase())),t.indexOf(n[2].toLowerCase())>-1&&(n[2]=O(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}},{key:"isWhitelisted",value:function(e){return this.logger.deprecate("languageUtils.isWhitelisted",'function "isWhitelisted" will be renamed to "isSupportedCode" in the next major - please make sure to rename it\'s usage asap.'),this.isSupportedCode(e)}},{key:"isSupportedCode",value:function(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}},{key:"getBestMatchFromCodes",value:function(e){var t,n=this;return e?(e.forEach((function(e){if(!t){var i=n.formatLanguageCode(e);n.options.supportedLngs&&!n.isSupportedCode(i)||(t=i)}})),!t&&this.options.supportedLngs&&e.forEach((function(e){if(!t){var i=n.getLanguagePartFromCode(e);if(n.isSupportedCode(i))return t=i;t=n.options.supportedLngs.find((function(e){if(0===e.indexOf(i))return e}))}})),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t):null}},{key:"getFallbackCodes",value:function(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),"string"==typeof e&&(e=[e]),"[object Array]"===Object.prototype.toString.apply(e))return e;if(!t)return e.default||[];var n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e[this.getLanguagePartFromCode(t)]),n||(n=e.default),n||[]}},{key:"toResolveHierarchy",value:function(e,t){var n=this,i=this.getFallbackCodes(t||this.options.fallbackLng||[],e),r=[],o=function(e){e&&(n.isSupportedCode(e)?r.push(e):n.logger.warn("rejecting language code not found in supportedLngs: ".concat(e)))};return"string"==typeof e&&e.indexOf("-")>-1?("languageOnly"!==this.options.load&&o(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&o(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&o(this.getLanguagePartFromCode(e))):"string"==typeof e&&o(this.formatLanguageCode(e)),i.forEach((function(e){r.indexOf(e)<0&&o(n.formatLanguageCode(e))})),r}}]),e}(),k=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],F={1:function(e){return Number(e>1)},2:function(e){return Number(1!=e)},3:function(e){return 0},4:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},5:function(e){return Number(0==e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5)},6:function(e){return Number(1==e?0:e>=2&&e<=4?1:2)},7:function(e){return Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},8:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)},9:function(e){return Number(e>=2)},10:function(e){return Number(1==e?0:2==e?1:e<7?2:e<11?3:4)},11:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&e<20?2:3)},12:function(e){return Number(e%10!=1||e%100==11)},13:function(e){return Number(0!==e)},14:function(e){return Number(1==e?0:2==e?1:3==e?2:3)},15:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2)},16:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)},17:function(e){return Number(1==e||e%10==1&&e%100!=11?0:1)},18:function(e){return Number(0==e?0:1==e?1:2)},19:function(e){return Number(1==e?0:0==e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3)},20:function(e){return Number(1==e?0:0==e||e%100>0&&e%100<20?1:2)},21:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)},22:function(e){return Number(1==e?0:2==e?1:(e<0||e>10)&&e%10==0?2:3)}};function U(){var e={};return k.forEach((function(t){t.lngs.forEach((function(n){e[n]={numbers:t.nr,plurals:F[t.fc]}}))})),e}var B=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(this,e),this.languageUtils=t,this.options=n,this.logger=m.create("pluralResolver"),this.rules=U()}return l(e,[{key:"addRule",value:function(e,t){this.rules[e]=t}},{key:"getRule",value:function(e){return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}},{key:"needsPlural",value:function(e){var t=this.getRule(e);return t&&t.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(e,t){return this.getSuffixes(e).map((function(e){return t+e}))}},{key:"getSuffixes",value:function(e){var t=this,n=this.getRule(e);return n?n.numbers.map((function(n){return t.getSuffix(e,n)})):[]}},{key:"getSuffix",value:function(e,t){var n=this,i=this.getRule(e);if(i){var r=i.noAbs?i.plurals(t):i.plurals(Math.abs(t)),o=i.numbers[r];this.options.simplifyPluralSuffix&&2===i.numbers.length&&1===i.numbers[0]&&(2===o?o="plural":1===o&&(o=""));var a=function(){return n.options.prepend&&o.toString()?n.options.prepend+o.toString():o.toString()};return"v1"===this.options.compatibilityJSON?1===o?"":"number"==typeof o?"_plural_".concat(o.toString()):a():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===i.numbers.length&&1===i.numbers[0]?a():this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString()}return this.logger.warn("no plural rule found for: ".concat(e)),""}}]),e}(),V=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.logger=m.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||function(e){return e},this.init(t)}return l(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});var t=e.interpolation;this.escape=void 0!==t.escape?t.escape:T,this.escapeValue=void 0===t.escapeValue||t.escapeValue,this.useRawValueToEscape=void 0!==t.useRawValueToEscape&&t.useRawValueToEscape,this.prefix=t.prefix?A(t.prefix):t.prefixEscaped||"{{",this.suffix=t.suffix?A(t.suffix):t.suffixEscaped||"}}",this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||",",this.unescapePrefix=t.unescapeSuffix?"":t.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":t.unescapeSuffix||"",this.nestingPrefix=t.nestingPrefix?A(t.nestingPrefix):t.nestingPrefixEscaped||A("$t("),this.nestingSuffix=t.nestingSuffix?A(t.nestingSuffix):t.nestingSuffixEscaped||A(")"),this.nestingOptionsSeparator=t.nestingOptionsSeparator?t.nestingOptionsSeparator:t.nestingOptionsSeparator||",",this.maxReplaces=t.maxReplaces?t.maxReplaces:1e3,this.alwaysFormat=void 0!==t.alwaysFormat&&t.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var e="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(e,"g");var t="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(t,"g");var n="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(n,"g")}},{key:"interpolate",value:function(e,t,n,i){var r,a,s,l=this,c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function u(e){return e.replace(/\$/g,"$$$$")}var h=function(e){if(e.indexOf(l.formatSeparator)<0){var r=w(t,c,e);return l.alwaysFormat?l.format(r,void 0,n,o({},i,t,{interpolationkey:e})):r}var a=e.split(l.formatSeparator),s=a.shift().trim(),u=a.join(l.formatSeparator).trim();return l.format(w(t,c,s),u,n,o({},i,t,{interpolationkey:s}))};this.resetRegExp();var d=i&&i.missingInterpolationHandler||this.options.missingInterpolationHandler,p=i&&i.interpolation&&i.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:function(e){return u(e)}},{regex:this.regexp,safeValue:function(e){return l.escapeValue?u(l.escape(e)):u(e)}}].forEach((function(t){for(s=0;r=t.regex.exec(e);){if(void 0===(a=h(r[1].trim())))if("function"==typeof d){var n=d(e,r,i);a="string"==typeof n?n:""}else{if(p){a=r[0];continue}l.logger.warn("missed to pass in variable ".concat(r[1]," for interpolating ").concat(e)),a=""}else"string"==typeof a||l.useRawValueToEscape||(a=y(a));var o=t.safeValue(a);if(e=e.replace(r[0],o),p?(t.regex.lastIndex+=o.length,t.regex.lastIndex-=r[0].length):t.regex.lastIndex=0,++s>=l.maxReplaces)break}})),e}},{key:"nest",value:function(e,t){var n,i,r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=o({},a);function l(e,t){var n=this.nestingOptionsSeparator;if(e.indexOf(n)<0)return e;var i=e.split(new RegExp("".concat(n,"[ ]*{"))),r="{".concat(i[1]);e=i[0],r=(r=this.interpolate(r,s)).replace(/'/g,'"');try{s=JSON.parse(r),t&&(s=o({},t,s))}catch(t){return this.logger.warn("failed parsing options string in nesting for key ".concat(e),t),"".concat(e).concat(n).concat(r)}return delete s.defaultValue,e}for(s.applyPostProcessor=!1,delete s.defaultValue;n=this.nestingRegexp.exec(e);){var c=[],u=!1;if(-1!==n[0].indexOf(this.formatSeparator)&&!/{.*}/.test(n[1])){var h=n[1].split(this.formatSeparator).map((function(e){return e.trim()}));n[1]=h.shift(),c=h,u=!0}if((i=t(l.call(this,n[1].trim(),s),s))&&n[0]===e&&"string"!=typeof i)return i;"string"!=typeof i&&(i=y(i)),i||(this.logger.warn("missed to resolve ".concat(n[1]," for nesting ").concat(e)),i=""),u&&(i=c.reduce((function(e,t){return r.format(e,t,a.lng,o({},a,{interpolationkey:n[1].trim()}))}),i.trim())),e=e.replace(n[0],i),this.regexp.lastIndex=0}return e}}]),e}();var G=function(e){function t(e,n,i){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return a(this,t),r=u(this,h(t).call(this)),C&&g.call(c(r)),r.backend=e,r.store=n,r.services=i,r.languageUtils=i.languageUtils,r.options=o,r.logger=m.create("backendConnector"),r.state={},r.queue=[],r.backend&&r.backend.init&&r.backend.init(i,o.backend,o),r}return p(t,e),l(t,[{key:"queueLoad",value:function(e,t,n,i){var r=this,o=[],a=[],s=[],l=[];return e.forEach((function(e){var i=!0;t.forEach((function(t){var s="".concat(e,"|").concat(t);!n.reload&&r.store.hasResourceBundle(e,t)?r.state[s]=2:r.state[s]<0||(1===r.state[s]?a.indexOf(s)<0&&a.push(s):(r.state[s]=1,i=!1,a.indexOf(s)<0&&a.push(s),o.indexOf(s)<0&&o.push(s),l.indexOf(t)<0&&l.push(t)))})),i||s.push(e)})),(o.length||a.length)&&this.queue.push({pending:a,loaded:{},errors:[],callback:i}),{toLoad:o,pending:a,toLoadLanguages:s,toLoadNamespaces:l}}},{key:"loaded",value:function(e,t,n){var i=e.split("|"),r=i[0],o=i[1];t&&this.emit("failedLoading",r,o,t),n&&this.store.addResourceBundle(r,o,n),this.state[e]=t?-1:2;var a={};this.queue.forEach((function(n){var i,s,l,c,u,h;i=n.loaded,s=o,c=_(i,[r],Object),u=c.obj,h=c.k,u[h]=u[h]||[],l&&(u[h]=u[h].concat(s)),l||u[h].push(s),function(e,t){for(var n=e.indexOf(t);-1!==n;)e.splice(n,1),n=e.indexOf(t)}(n.pending,e),t&&n.errors.push(t),0!==n.pending.length||n.done||(Object.keys(n.loaded).forEach((function(e){a[e]||(a[e]=[]),n.loaded[e].length&&n.loaded[e].forEach((function(t){a[e].indexOf(t)<0&&a[e].push(t)}))})),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())})),this.emit("loaded",a),this.queue=this.queue.filter((function(e){return!e.done}))}},{key:"read",value:function(e,t,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:350,a=arguments.length>5?arguments[5]:void 0;return e.length?this.backend[n](e,t,(function(s,l){s&&l&&r<5?setTimeout((function(){i.read.call(i,e,t,n,r+1,2*o,a)}),o):a(s,l)})):a(null,{})}},{key:"prepareLoading",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();"string"==typeof e&&(e=this.languageUtils.toResolveHierarchy(e)),"string"==typeof t&&(t=[t]);var o=this.queueLoad(e,t,i,r);if(!o.toLoad.length)return o.pending.length||r(),null;o.toLoad.forEach((function(e){n.loadOne(e)}))}},{key:"load",value:function(e,t,n){this.prepareLoading(e,t,{},n)}},{key:"reload",value:function(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}},{key:"loadOne",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=e.split("|"),r=i[0],o=i[1];this.read(r,o,"read",void 0,void 0,(function(i,a){i&&t.logger.warn("".concat(n,"loading namespace ").concat(o," for language ").concat(r," failed"),i),!i&&a&&t.logger.log("".concat(n,"loaded namespace ").concat(o," for language ").concat(r),a),t.loaded(e,i,a)}))}},{key:"saveMissing",value:function(e,t,n,i,r){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t)?this.logger.warn('did not save key "'.concat(n,'" as the namespace "').concat(t,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!"):null!=n&&""!==n&&(this.backend&&this.backend.create&&this.backend.create(e,t,n,i,null,o({},a,{isUpdate:r})),e&&e[0]&&this.store.addResource(e[0],t,n,i))}}]),t}(g);function z(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,whitelist:!1,nonExplicitWhitelist:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(e){var t={};if("object"===i(e[1])&&(t=e[1]),"string"==typeof e[1]&&(t.defaultValue=e[1]),"string"==typeof e[2]&&(t.tDescription=e[2]),"object"===i(e[2])||"object"===i(e[3])){var n=e[3]||e[2];Object.keys(n).forEach((function(e){t[e]=n[e]}))}return t},interpolation:{escapeValue:!0,format:function(e,t,n,i){return e},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!1}}}function H(e){return"string"==typeof e.ns&&(e.ns=[e.ns]),"string"==typeof e.fallbackLng&&(e.fallbackLng=[e.fallbackLng]),"string"==typeof e.fallbackNS&&(e.fallbackNS=[e.fallbackNS]),e.whitelist&&(e.whitelist&&e.whitelist.indexOf("cimode")<0&&(e.whitelist=e.whitelist.concat(["cimode"])),e.supportedLngs=e.whitelist),e.nonExplicitWhitelist&&(e.nonExplicitSupportedLngs=e.nonExplicitWhitelist),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e}function W(){}const j=new(function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;if(a(this,t),e=u(this,h(t).call(this)),C&&g.call(c(e)),e.options=H(n),e.services={},e.logger=m,e.modules={external:[]},i&&!e.isInitialized&&!n.isClone){if(!e.options.initImmediate)return e.init(n,i),u(e,c(e));setTimeout((function(){e.init(n,i)}),0)}return e}return p(t,e),l(t,[{key:"init",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;function i(e){return e?"function"==typeof e?new e:e:null}if("function"==typeof t&&(n=t,t={}),t.whitelist&&!t.supportedLngs&&this.logger.deprecate("whitelist",'option "whitelist" will be renamed to "supportedLngs" in the next major - please make sure to rename this option asap.'),t.nonExplicitWhitelist&&!t.nonExplicitSupportedLngs&&this.logger.deprecate("whitelist",'options "nonExplicitWhitelist" will be renamed to "nonExplicitSupportedLngs" in the next major - please make sure to rename this option asap.'),this.options=o({},z(),this.options,H(t)),this.format=this.options.interpolation.format,n||(n=W),!this.options.isClone){this.modules.logger?m.init(i(this.modules.logger),this.options):m.init(null,this.options);var r=new N(this.options);this.store=new L(this.options.resources,this.options);var a=this.services;a.logger=m,a.resourceStore=this.store,a.languageUtils=r,a.pluralResolver=new B(r,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),a.interpolator=new V(this.options),a.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},a.backendConnector=new G(i(this.modules.backend),a.resourceStore,a,this.options),a.backendConnector.on("*",(function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];e.emit.apply(e,[t].concat(i))})),this.modules.languageDetector&&(a.languageDetector=i(this.modules.languageDetector),a.languageDetector.init(a,this.options.detection,this.options)),this.modules.i18nFormat&&(a.i18nFormat=i(this.modules.i18nFormat),a.i18nFormat.init&&a.i18nFormat.init(this)),this.translator=new I(this.services,this.options),this.translator.on("*",(function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];e.emit.apply(e,[t].concat(i))})),this.modules.external.forEach((function(t){t.init&&t.init(e)}))}if(this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var s=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);s.length>0&&"dev"!==s[0]&&(this.options.lng=s[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");var l=["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"];l.forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments)}}));var c=["addResource","addResources","addResourceBundle","removeResourceBundle"];c.forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments),e}}));var u=v(),h=function(){var t=function(t,i){e.isInitialized&&!e.initializedStoreOnce&&e.logger.warn("init: i18next is already initialized. You should call init just once!"),e.isInitialized=!0,e.options.isClone||e.logger.log("initialized",e.options),e.emit("initialized",e.options),u.resolve(i),n(t,i)};if(e.languages&&"v1"!==e.options.compatibilityAPI&&!e.isInitialized)return t(null,e.t.bind(e));e.changeLanguage(e.options.lng,t)};return this.options.resources||!this.options.initImmediate?h():setTimeout(h,0),u}},{key:"loadResources",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W,i=n,r="string"==typeof e?e:this.language;if("function"==typeof e&&(i=e),!this.options.resources||this.options.partialBundledLanguages){if(r&&"cimode"===r.toLowerCase())return i();var o=[],a=function(e){e&&t.services.languageUtils.toResolveHierarchy(e).forEach((function(e){o.indexOf(e)<0&&o.push(e)}))};if(r)a(r);else{var s=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);s.forEach((function(e){return a(e)}))}this.options.preload&&this.options.preload.forEach((function(e){return a(e)})),this.services.backendConnector.load(o,this.options.ns,i)}else i(null)}},{key:"reloadResources",value:function(e,t,n){var i=v();return e||(e=this.languages),t||(t=this.options.ns),n||(n=W),this.services.backendConnector.reload(e,t,(function(e){i.resolve(),n(e)})),i}},{key:"use",value:function(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&R.addPostProcessor(e),"3rdParty"===e.type&&this.modules.external.push(e),this}},{key:"changeLanguage",value:function(e,t){var n=this;this.isLanguageChangingTo=e;var i=v();this.emit("languageChanging",e);var r=function(r){e||r||!n.services.languageDetector||(r=[]);var o="string"==typeof r?r:n.services.languageUtils.getBestMatchFromCodes(r);o&&(n.language||(n.language=o,n.languages=n.services.languageUtils.toResolveHierarchy(o)),n.translator.language||n.translator.changeLanguage(o),n.services.languageDetector&&n.services.languageDetector.cacheUserLanguage(o)),n.loadResources(o,(function(e){!function(e,r){r?(n.language=r,n.languages=n.services.languageUtils.toResolveHierarchy(r),n.translator.changeLanguage(r),n.isLanguageChangingTo=void 0,n.emit("languageChanged",r),n.logger.log("languageChanged",r)):n.isLanguageChangingTo=void 0,i.resolve((function(){return n.t.apply(n,arguments)})),t&&t(e,(function(){return n.t.apply(n,arguments)}))}(e,o)}))};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(r):r(e):r(this.services.languageDetector.detect()),i}},{key:"getFixedT",value:function(e,t,n){var r=this,a=function e(t,a){var s;if("object"!==i(a)){for(var l=arguments.length,c=new Array(l>2?l-2:0),u=2;u<l;u++)c[u-2]=arguments[u];s=r.options.overloadTranslationOptionHandler([t,a].concat(c))}else s=o({},a);s.lng=s.lng||e.lng,s.lngs=s.lngs||e.lngs,s.ns=s.ns||e.ns;var h=r.options.keySeparator||".",d=n?"".concat(n).concat(h).concat(t):t;return r.t(d,s)};return"string"==typeof e?a.lng=e:a.lngs=e,a.ns=t,a.keyPrefix=n,a}},{key:"t",value:function(){var e;return this.translator&&(e=this.translator).translate.apply(e,arguments)}},{key:"exists",value:function(){var e;return this.translator&&(e=this.translator).exists.apply(e,arguments)}},{key:"setDefaultNamespace",value:function(e){this.options.defaultNS=e}},{key:"hasLoadedNamespace",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var i=this.languages[0],r=!!this.options&&this.options.fallbackLng,o=this.languages[this.languages.length-1];if("cimode"===i.toLowerCase())return!0;var a=function(e,n){var i=t.services.backendConnector.state["".concat(e,"|").concat(n)];return-1===i||2===i};if(n.precheck){var s=n.precheck(this,a);if(void 0!==s)return s}return!!this.hasResourceBundle(i,e)||(!this.services.backendConnector.backend||!(!a(i,e)||r&&!a(o,e)))}},{key:"loadNamespaces",value:function(e,t){var n=this,i=v();return this.options.ns?("string"==typeof e&&(e=[e]),e.forEach((function(e){n.options.ns.indexOf(e)<0&&n.options.ns.push(e)})),this.loadResources((function(e){i.resolve(),t&&t(e)})),i):(t&&t(),Promise.resolve())}},{key:"loadLanguages",value:function(e,t){var n=v();"string"==typeof e&&(e=[e]);var i=this.options.preload||[],r=e.filter((function(e){return i.indexOf(e)<0}));return r.length?(this.options.preload=i.concat(r),this.loadResources((function(e){n.resolve(),t&&t(e)})),n):(t&&t(),Promise.resolve())}},{key:"dir",value:function(e){if(e||(e=this.languages&&this.languages.length>0?this.languages[0]:this.language),!e)return"rtl";return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam"].indexOf(this.services.languageUtils.getLanguagePartFromCode(e))>=0?"rtl":"ltr"}},{key:"createInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return new t(e,n)}},{key:"cloneInstance",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W,r=o({},this.options,n,{isClone:!0}),a=new t(r),s=["store","services","language"];return s.forEach((function(t){a[t]=e[t]})),a.services=o({},this.services),a.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},a.translator=new I(a.services,a.options),a.translator.on("*",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];a.emit.apply(a,[e].concat(n))})),a.init(r,i),a.translator.options=a.options,a.translator.backendConnector.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},a}},{key:"toJSON",value:function(){return{options:this.options,store:this.store,language:this.language,languages:this.languages}}}]),t}(g))},83522:(e,t,n)=>{"use strict";n.r(t);var i=n(61445),r=n(25282),o=n(53974),a=n(32757),s=n(42106),l=n(37169),c=n(55412);function u(e,t){r.Extension.call(this,e,t),this.name="propertiesmanager",this._panel=null,this._onIsolateEvent=this._onIsolateEvent.bind(this),this._onSelectionChangeEvent=this._onSelectionChangeEvent.bind(this),this._onPrefChange=this._onPrefChange.bind(this),this._onContextMenu=this._onContextMenu.bind(this)}u.prototype=Object.create(r.Extension.prototype),u.prototype.constructor=u;var h=u.prototype,d=Autodesk.Viewing.Private;h.load=function(){return this.viewer.addEventListener(l.ISOLATE_EVENT,this._onIsolateEvent),this.viewer.addEventListener(l.AGGREGATE_SELECTION_CHANGED_EVENT,this._onSelectionChangeEvent),this.viewer.prefs.addListeners(c.Prefs.OPEN_PROPERTIES_ON_SELECT,this._onPrefChange),this.viewer.registerContextMenuCallback(this.name,this._onContextMenu),!0},h.unload=function(){this.viewer.removeEventListener(l.ISOLATE_EVENT,this._onIsolateEvent),this.viewer.removeEventListener(l.AGGREGATE_SELECTION_CHANGED_EVENT,this._onSelectionChangeEvent),this.viewer.prefs.removeListeners(c.Prefs.OPEN_PROPERTIES_ON_SELECT,this._onPrefChange),this.viewer.unregisterContextMenuCallback(this.name),this.deactivate(),this.setPanel(null),this._toolbarButton&&(this.viewer.settingsTools.removeControl(this._toolbarButton),this.viewer.settingsTools.propertiesbutton=null,this._toolbarButton=null)},h.onToolbarCreated=function(){this.setDefaultPanel(),this._addToolbarButton()},h.activate=function(){return!!this._panel&&(this._panel.setVisible(!0),!0)},h.deactivate=function(){return this._panel&&this._panel.setVisible(!1),!0},h.isActive=function(){return!!this._panel&&this._panel.isVisible()},h.setPanel=function(e){var t=this;return(e instanceof o.PropertyPanel||!e)&&(this._panel&&(this._panel.setVisible(!1),this.viewer.removePanel(this._panel),this._panel.uninitialize()),this._panel=e,e&&(this.viewer.addPanel(e),e.addVisibilityListener((function(e){e&&t.viewer.onPanelVisible(t._panel),t._toolbarButton.setState(e?s.Button.State.ACTIVE:s.Button.State.INACTIVE)}))),!0)},h.setDefaultPanel=function(){this.setPanel(new a.ViewerPropertyPanel(this.viewer))},h.getPanel=function(){return this._panel},h.getToolbarButton=function(){return this._toolbarButton},h._addToolbarButton=function(){var e=this;if(!this._toolbarButton){var t=this._toolbarButton=new s.Button("toolbar-propertiesTool");t.setToolTip("Properties"),t.setIcon("adsk-icon-properties"),t.onClick=function(){e._panel.setVisible(!e._panel.isVisible()),e._panel.isVisible()&&d.analytics.track("viewer.properties",{action:"View List",from:"Toolbar"})},t.setVisible(!this.viewer.prefs.get("openPropertiesOnSelect")),this.viewer.settingsTools.addControl(t,{index:1}),this.viewer.settingsTools.propertiesbutton=t}},h._onIsolateEvent=function(e){this._panel&&(this.viewer.prefs.get("openPropertiesOnSelect")||e.nodeIdArray[0]===e.model.getRootId())&&this._panel.setVisible(e.nodeIdArray.length>0||this.viewer.impl.selector.hasSelection())},h._onSelectionChangeEvent=function(e){if(this.viewer.prefs.get("openPropertiesOnSelect")){for(var t=!1,n=0;n<e.selections.length;++n)if(e.selections[n].dbIdArray.length>0){t=!0;break}t?this.activate():this.deactivate()}},h._onPrefChange=function(e){this._toolbarButton&&this._toolbarButton.setVisible(!e)},h._onContextMenu=function(e,t){var n=this;if(!this.isActive()&&t.hasSelected){var i={title:"Show Properties",target:function(){n.activate(),d.analytics.track("viewer.properties",{action:"View List",from:"Contextual"})}};e.unshift(i)}};var p=n(49710);function f(e,t){r.Extension.call(this,e,t),this.viewer=e,this.options=t,this.name="viewersettings"}f.prototype=Object.create(r.Extension.prototype),f.prototype.constructor=f;var m=f.prototype;m.activate=function(){this.activeStatus||(this.viewer.showViewer3dOptions(!0),this.viewer.getSettingsPanel(!0).selectTab(p.ViewerSettingTab.Performance),this.activeStatus=!0);return!0},m.deactivate=function(){return this.activeStatus&&(this.viewer.showViewer3dOptions(!1),this.activeStatus=!1),!0};var g=n(75977),v=n(84998);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var x=Autodesk.Viewing.Private;function E(e,t){r.Extension.call(this,e,t),this.viewer=e,this.options=t,this.name="modelstructure",this._modelstructure=null,this._onLoadModel=this._onLoadModel.bind(this),this._onUnloadModel=this._onUnloadModel.bind(this)}E.prototype=Object.create(r.Extension.prototype),E.prototype.constructor=E;var w=E.prototype;w.load=function(){return this.viewer.addEventListener(l.MODEL_ADDED_EVENT,this._onLoadModel),this.viewer.addEventListener(l.MODEL_ROOT_LOADED_EVENT,this._onLoadModel),this.viewer.addEventListener(l.MODEL_UNLOADED_EVENT,this._onUnloadModel),this.viewer.addEventListener(l.MODEL_REMOVED_EVENT,this._onUnloadModel),!0},w.unload=function(){return this.deactivate(),this.setModelStructurePanel(null),this._structureButton&&(this.viewer.settingsTools.removeControl(this._structureButton),this.viewer.settingsTools.structurebutton=null,this._structureButton=null),this.viewer.removeEventListener(l.MODEL_ADDED_EVENT,this._onLoadModel),this.viewer.removeEventListener(l.MODEL_ROOT_LOADED_EVENT,this._onLoadModel),this.viewer.removeEventListener(l.MODEL_UNLOADED_EVENT,this._onUnloadModel),this.viewer.removeEventListener(l.MODEL_REMOVED_EVENT,this._onUnloadModel),!0},w.onToolbarCreated=function(){var e=this,t=new s.Button("toolbar-modelStructureTool");t.setToolTip("Model browser"),t.setIcon("adsk-icon-structure"),t.onClick=function(){!e._modelstructure.isVisible()?e.activate():e.deactivate()};var n=this.viewer.settingsTools;n.addControl(t,{index:0}),n.structurebutton=t,this._structureButton=t,this.restoreDefaultPanel()},w.activate=function(){return!!this._modelstructure&&(this._modelstructure.setVisible(!0),x.analytics.track("viewer.model_browser",{action:"View List"}),!0)},w.deactivate=function(){return this._modelstructure&&this._modelstructure.setVisible(!1),!0},w.isActive=function(){return!!this._modelstructure&&this._modelstructure.isVisible()},w.setModelStructurePanel=function(e){var t=this;if(e===this._modelstructure)return!1;if(this._modelstructure&&(this._modelstructure.setVisible(!1),this.viewer.removePanel(this._modelstructure),this._modelstructure.uninitialize()),this._modelstructure=e,this.viewer.modelstructure=e,!e)return!0;this.viewer.addPanel(this._modelstructure);for(var n=this.viewer.impl.modelQueue().getModels(),i=0;i<n.length;++i)this._modelstructure.addModel(n[i]);return this._modelstructure.addVisibilityListener((function(e){e&&t.viewer.onPanelVisible(t._modelstructure),t._structureButton.setState(e?s.Button.State.ACTIVE:s.Button.State.INACTIVE)})),!0},w.restoreDefaultPanel=function(){var e=this.viewer.config,t={docStructureConfig:e.docStructureConfig,hideSearch:(0,v.isMobileDevice)(),excludeRoot:e.modelBrowserExcludeRoot,startCollapsed:e.modelBrowserStartCollapsed},n=e.defaultModelStructureTitle||"Browser",i=new g.ViewerModelStructurePanel(b(b({},t),(0,g.generateDefaultViewerHandlerOptions)(this.viewer)),n);this.setModelStructurePanel(i)},w._onLoadModel=function(e){this._modelstructure&&this._modelstructure.addModel(e.model)},w._onUnloadModel=function(e){this._modelstructure&&this._modelstructure.unloadModel(e.model)};var S=n(6355),A=n(35010),M=n(49991),T=n(82803),C=n(71224),P=n(51676),L=n(56441),R="dolly",D="freeorbit",I="orbit",O="worldup",N="fittoview";function k(e,t){r.Extension.call(this,e,t),this.name="navtools",this.modes=["pan",R,D,I,"fov",O,N],this.onToolChanged=this.onToolChanged.bind(this),this.onNavigationModeChanged=this.onNavigationModeChanged.bind(this),this.navToolsConfig=t.navToolsConfig||{}}k.prototype=Object.create(r.Extension.prototype),k.prototype.constructor=k;var F=k.prototype;function U(e,t,n){return function(){e.isActive(n)?e.deactivate():e.activate(n)}}F.load=function(){var e=this.viewer,t=new M.FovTool(e);if(e.toolController.registerTool(t),!this.navToolsConfig.isAECCameraControls){var n=new T.WorldUpTool(e.impl,e);e.toolController.registerTool(n)}return this.initFocalLengthOverlay(),e.addEventListener(l.TOOL_CHANGE_EVENT,this.onToolChanged),e.addEventListener(l.NAVIGATION_MODE_CHANGED_EVENT,this.onNavigationModeChanged),!0},F.updateUI=function(e){e!==this.is3d&&(this._destroyUI(),this._createUI(e))},F.onToolbarCreated=function(){var e=!this.viewer.impl.is2d;this._createUI(e)},F.navActionDisplayMode=function(e){return this.viewer.navigation.isActionEnabled(e)?"block":"none"},F._createUI=function(e){var t=this.viewer.getToolbar().getControl(S.TOOLBAR.NAVTOOLSID);if(e){var n=new A.ComboButton("toolbar-orbitTools");n.setToolTip("Orbit"),n.setIcon("adsk-icon-orbit-constrained"),n.setDisplay(this.navActionDisplayMode("orbit")),this.createOrbitSubmenu(n),t.addControl(n),t.orbittoolsbutton=n,n.setState(s.Button.State.ACTIVE),t.returnToDefault=function(){n.setState(s.Button.State.ACTIVE)}}var i=new s.Button("toolbar-panTool");i.setToolTip("Pan"),i.setIcon("adsk-icon-pan"),i.onClick=U(this,0,"pan"),i.setDisplay(this.navActionDisplayMode("pan")),t.addControl(i),t.panbutton=i,e||(t.returnToDefault=function(){i.setState(s.Button.State.ACTIVE)},t.returnToDefault());var r=new s.Button("toolbar-zoomTool");if(r.setToolTip("Zoom"),r.setIcon("adsk-icon-zoom"),r.onClick=U(this,0,R),r.setDisplay(this.navActionDisplayMode("zoom")),t.addControl(r),t.dollybutton=r,this.navToolsConfig.isAECCameraControls)t.addControl(this.createFitViewButton(t));else{var o=new A.ComboButton("toolbar-cameraSubmenuTool");o.setToolTip("Camera interactions"),o.setIcon("adsk-icon-camera"),o.saveAsDefault(),this.createCameraSubmenu(o,e),t.addControl(o),t.camerabutton=o}this.is3d=e},F.createOrbitSubmenu=function(e){var t=this.viewer.getToolbar().getControl(S.TOOLBAR.NAVTOOLSID),n=new s.Button("toolbar-freeOrbitTool");n.setToolTip("Free orbit"),n.setIcon("adsk-icon-orbit-free"),n.onClick=U(this,0,D),e.addControl(n),t.freeorbitbutton=n;var i=new s.Button("toolbar-orbitTool");i.setToolTip("Orbit"),i.setIcon("adsk-icon-orbit-constrained"),i.onClick=U(this,0,I),e.addControl(i),t.orbitbutton=i,e.onClick=i.onClick},F.createFitViewButton=function(e,t){var n=this.viewer,i=new s.Button("toolbar-fitToViewTool");return i.setToolTip("Fit to view"),i.setIcon("adsk-icon-fit-to-view"),i.onClick=function(){n.impl.fitToView(n.impl.selector.getAggregateSelection()),Autodesk.Viewing.Private.analytics.track("viewer.fit_to_view",{from:"UI"});var e=n.getDefaultNavigationToolName();n.setActiveNavigationTool(e),t&&t.restoreDefault()},i.setDisplay(this.navActionDisplayMode("gotoview")),e.fittoviewbutton=i,i},F.createCameraSubmenu=function(e,t){var n=this,i=this.viewer,r=i.getToolbar().getControl(S.TOOLBAR.NAVTOOLSID);if((0,v.isTouchDevice)()){var o=new s.Button("toolbar-homeTool");o.setToolTip("Home"),o.setIcon("adsk-icon-home"),o.onClick=function(){i.navigation.setRequestHomeView(!0);var t=i.getDefaultNavigationToolName();n.activate(t),e.restoreDefault()},o.setDisplay(this.navActionDisplayMode("gotoview")),e.addControl(o),r.homebutton=o}if(e.addControl(this.createFitViewButton(r,e)),t){var a=new s.Button("toolbar-focalLengthTool");a.setToolTip("Focal length"),a.setIcon("adsk-icon-fov"),a.onClick=U(this,0,"fov"),a.setDisplay(this.navActionDisplayMode("fov")),e.addControl(a),r.fovbutton=a}var l=new s.Button("toolbar-rollTool");l.setToolTip("Roll"),l.setIcon("adsk-icon-roll"),l.onClick=U(this,0,O),l.setDisplay(this.navActionDisplayMode("roll")),e.addControl(l),r.rollbutton=l},F.onToolChanged=function(e){if("fov"===e.toolName&&this.showFocalLengthOverlay(e.active),e.active)switch(e.toolName){case"dolly":this.handleAltRelease("dollybutton");break;case"pan":this.handleAltRelease("panbutton");break;case"worldup":this.handleAltRelease("rollbutton");break;case"fov":this.handleAltRelease("fovbutton")}},F.onNavigationModeChanged=function(e){if(this.viewer.getDefaultNavigationToolName()===e.id){var t=this.viewer.getToolbar();if(!t)return;var n=t.getControl(S.TOOLBAR.NAVTOOLSID);if(!n)return;n.returnToDefault&&n.returnToDefault()}},F.handleAltRelease=function(e){var t=this.viewer.getToolbar();if(t){var n=t.getControl(S.TOOLBAR.NAVTOOLSID),i=n&&n[e];i&&i.setState(s.Button.State.ACTIVE)}},F.initFocalLengthOverlay=function(){var e=this.getDocument(),t=this.focallength=e.createElement("div");t.classList.add("message-panel"),t.classList.add("docking-panel"),t.classList.add("focal-length"),t.classList.add("docking-panel-container-solid-color-b");var n=e.createElement("table"),i=e.createElement("tbody");n.appendChild(i),t.appendChild(n),this.viewer.container.appendChild(t);var r=i.insertRow(-1),o=r.insertCell(0);o.classList.add("name"),o.setAttribute("data-i18n","Focal Length"),o.textContent=C.Z.t("Focal Length"),(o=r.insertCell(1)).classList.add("value"),o.textContent="",this.fovCell=o,t.style.visibility="hidden"},F.showFocalLengthOverlay=function(e){var t=this,n=this.viewer,i=0;function r(e){if(e){L.HudMessage.displayMessage(n.container,{msgTitleKey:"Orthographic View Set",messageKey:"The view is set to Orthographic",messageDefaultValue:"The view is set to Orthographic. Changing the focal length will switch to Perspective."})}else L.HudMessage.dismiss()}function o(e){e&&a(),t.focallength&&(t.focallength.style.visibility=e?"visible":"hidden")}function a(){var e=n.getFocalLength();i!==e&&(i=e,t.fovCell.textContent=e.toString()+" mm")}function s(){if(a(),"fov"===n.toolController.getActiveToolName()){var e=n.navigation.getCamera(),t=e&&!e.isPerspective;o(!t),r(t)}}var c=n.navigation.getCamera(),u=c&&!c.isPerspective;o(e&&!u),r(e&&u),e?n.addEventListener(l.CAMERA_CHANGE_EVENT,s):n.removeEventListener(l.CAMERA_CHANGE_EVENT,s)},F.unload=function(){return this._destroyUI(),!0},F._destroyUI=function(){var e=this.viewer,t=e.getToolbar();if(!t)return!0;var n=t.getControl(S.TOOLBAR.NAVTOOLSID);if(!n)return!0;function i(e){e&&(e.subMenu.removeEventListener(P.RadioButtonGroup.Event.ACTIVE_BUTTON_CHANGED,e.subMenuActiveButtonChangedHandler(n)),n.removeControl(e.getId()),e.onClick=null)}function r(e){e&&(n.removeControl(e.getId()),e.onClick=null)}return this.is3d&&(i(n.orbittoolsbutton),n.orbittoolsbutton=null,r(n.orbitbutton),n.orbitbutton=null,r(n.freeorbitbutton),n.freeorbitbutton=null,r(n.fovbutton),n.fovbutton=null),r(n.panbutton),n.panbutton=null,r(n.dollybutton),n.dollybutton=null,i(n.camerabutton),n.camerabutton=null,r(n.rollbutton),n.rollbutton=null,r(n.fittoviewbutton),n.fittoviewbutton=null,this.focallength&&(e.container.removeChild(this.focallength),this.focallength=null),e.removeEventListener(l.TOOL_CHANGE_EVENT,this.onToolChanged),this.onToolChanged=null,e.removeEventListener(l.NAVIGATION_MODE_CHANGED_EVENT,this.onNavigationModeChanged),this.onNavigationModeChanged=null,!0},F.activate=function(e){if(this.isActive(e))return!1;if(e===N)return this.viewer.impl.fitToView(this.viewer.impl.selector.getAggregateSelection()),!0;if(-1!=this.modes.indexOf(e)){var t=this.viewer.getDefaultNavigationToolName();return-1===this.modes.indexOf(t)&&this.viewer.activateDefaultNavigationTools(this.viewer.model.is2d()),this.viewer.setActiveNavigationTool(e),!0}return!1},F.deactivate=function(){return this.viewer.setActiveNavigationTool(),!0},F.isActive=function(e){return this.viewer.getActiveNavigationTool()===e};var B=n(77702);function V(e){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V(e)}function G(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function z(e,t){return z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},z(e,t)}function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=j(e);if(t){var r=j(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return W(this,n)}}function W(e,t){return!t||"object"!==V(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function j(e){return j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},j(e)}var q=Autodesk.Viewing.GlobalManagerMixin,X=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&z(e,t)}(o,e);var t,n,i,r=H(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).names=["explode"],t.viewer=e,t.setGlobalManager(t.viewer.globalManager),t.active=!1,t.activate=function(){t.active=!0},t.deactivate=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&t.setScale(0),t.active=!1},t.isActive=function(){return t.active},t}return t=o,(n=[{key:"setScale",value:function(e){return this.viewer.explode(e)}},{key:"getScale",value:function(){return this.viewer.getExplodeScale()}}])&&G(t.prototype,n),i&&G(t,i),o}(B.ToolInterface);q.call(X.prototype);var Y=n(17167),K=n(98926);function Z(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var J=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ext=t;var n=t.viewer,i=new s.Button("toolbar-explodeTool");i.setIcon("adsk-icon-explode"),i.setToolTip("Explode model"),n.modelTools.addControl(i);var r,o=(0,Y.stringToDOM)('<div class="docking-panel docking-panel-container-solid-color-b explode-submenu" style="display:none"><input class="explode-slider" type="range" min="0" max="1" step="0.01" value="0"/></div>'),a=this.ext.getDocument();(0,v.isIOSDevice)()?(r=a.querySelector("#toolbar-explodeTool").parentNode,o.classList.add("ios")):(0,v.isAndroidDevice)()?(r=a.querySelector("#toolbar-explodeTool").parentNode,o.classList.add("android")):r=i.container,r.appendChild(o);var l=o.querySelector(".explode-slider");l.addEventListener(v.isIE11?"change":"input",(function(){t.setScale(l.value)})),v.isIE11&&(l.style["padding-top"]="0",l.style["padding-bottom"]="0",l.style["margin-top"]="10px"),o.onclick=function(e){e.stopPropagation()};var c=i.container.querySelector(".adsk-control-tooltip");i.onClick=function(){t.isActive()?t.deactivate():(t.activate(),K.logger.track({category:"tool_changed",name:"explode"}))},this._slider=l,this._explodeButton=i,this._explodeSubmenu=o,this._tooltip=c,n.explodeSlider=l,n.explodeSubmenu=o,this._onExplode=this._onExplode.bind(this)}var t,n,i;return t=e,(n=[{key:"activate",value:function(){this._explodeSubmenu.style.display="",this._explodeButton.setState(s.Button.State.ACTIVE),this._tooltip.style.display="none";var e=this.ext.getScale();this._slider.value=e,this.ext.viewer.addEventListener(l.EXPLODE_CHANGE_EVENT,this._onExplode)}},{key:"deactivate",value:function(){this._explodeButton.setState(s.Button.State.INACTIVE),this._hideSlider(this),this.ext.viewer.removeEventListener(l.EXPLODE_CHANGE_EVENT,this._onExplode)}},{key:"destroy",value:function(){var e=this.ext.viewer;this._slider&&(this._explodeButton&&this._explodeButton.removeFromParent(),this._slider=null,this._explodeButton=null,this._explodeSubmenu=null,this._tooltip=null,e.explodeSlider=null,e.explodeSubmenu=null)}},{key:"setUIEnabled",value:function(e){this._explodeButton&&(e?(this._explodeButton.setState(Autodesk.Viewing.UI.Button.State.INACTIVE),this._wasActive&&this.ext.activate()):(this._wasActive=this.ext.isActive(),this._hideSlider(this),this._explodeButton.setState(Autodesk.Viewing.UI.Button.State.DISABLED)))}},{key:"_hideSlider",value:function(){this._slider.parentNode.style.display="none",this._tooltip.style.display=""}},{key:"_onExplode",value:function(e){this._slider.value=e.scale}}])&&Z(t.prototype,n),i&&Z(t,i),e}();function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}function $(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ee(e,t){return ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ee(e,t)}function te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=ie(e);if(t){var r=ie(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ne(this,n)}}function ne(e,t){return!t||"object"!==Q(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ie(e){return ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ie(e)}var re=Autodesk.Viewing.Private,oe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ee(e,t)}(o,e);var t,n,i,r=te(o);function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this,e,t)).viewer=e,n.options=t,n.name="explode",n.tool=null,n.explodeUI=null,n}return t=o,(n=[{key:"load",value:function(){return this.tool=new X(this.viewer),this.viewer.toolController.registerTool(this.tool,this.setActive.bind(this)),!0}},{key:"unload",value:function(){return this.deactivate(),this.explodeUI&&(this.explodeUI.destroy(),this.explodeUI=null),this.viewer.toolController.deregisterTool(this.tool),this.tool=null,!0}},{key:"onToolbarCreated",value:function(e){this.explodeUI=new J(this,e)}},{key:"activate",value:function(){return!!this.isActive()||!!this.explodeUI&&(this.explodeUI.activate(),this.viewer.toolController.activateTool("explode"),!0)}},{key:"deactivate",value:function(){return!this.isActive()||!this.explodeUI||(this.explodeUI.deactivate(),this.viewer.toolController.deactivateTool("explode"),!0)}},{key:"isActive",value:function(){return this.tool.isActive()}},{key:"getScale",value:function(){return this.tool.getScale()}},{key:"setScale",value:function(e){return this.tool.setScale(e)}},{key:"setStrategy",value:function(e){e!==this.getStrategy()&&this.viewer.prefs.set(re.Prefs3D.EXPLODE_STRATEGY,e)}},{key:"getStrategy",value:function(){return this.viewer.prefs.get(re.Prefs3D.EXPLODE_STRATEGY)}},{key:"setUIEnabled",value:function(e){this.explodeUI.setUIEnabled(e),e||this.tool.deactivate(!1)}}])&&$(t.prototype,n),i&&$(t,i),o}(r.Extension);function ae(e,t){r.Extension.call(this,e,t),this.viewer=e,this.options=t,this.name="fullscreen"}ae.prototype=Object.create(r.Extension.prototype),ae.prototype.constructor=ae;var se=ae.prototype;function le(e,t){r.Extension.call(this,e,t),this.viewer=e,this.options=t,this.name="gohome"}se.activate=function(){return this.activeStatus||(this.viewer.nextScreenMode(),this.activeStatus=!0),!0},se.deactivate=function(){return this.activeStatus&&(this.viewer.escapeScreenMode(),this.activeStatus=!1),!0},le.prototype=Object.create(r.Extension.prototype),le.prototype.constructor=le;var ce=le.prototype;ce.activate=function(){return this.viewer.navigation.setRequestHomeView(!0),!0},ce.deactivate=function(){return!1};var ue=n(10831),he=Autodesk.Viewing,de=['<div class="orbit-gizmo noselect">','<div class="outside"></div>','<div class="ring"></div>','<div class="layout-hor">','<div class="edgemark-area"><div class="edgemark"></div></div>',"</div>",'<div class="layout-mid">','<div class="layout-ver">','<div class="edgemark-area"><div class="edgemark"></div></div>',"</div>",'<div class="circle">','<div class="crosshair-area">','<div class="crosshair-v"></div>','<div class="crosshair-h"></div>',"</div>","</div>",'<div class="layout-ver">','<div class="edgemark-area"><div class="edgemark"></div></div>',"</div>","</div>",'<div class="layout-hor">','<div class="edgemark-area"><div class="edgemark"></div></div>',"</div>","</div>"].join("\n");function pe(){var e,t,n,i,r,o=["fusion orbit","fusion orbit constrained"],a=0,s=1,l=2,c=.005,u=.005,h=1,d={},p=(0,v.isTouchDevice)(),f=!1,m={buttons:[],src:void 0,x:0,y:0,dx:0,dy:0,firstMove:!0,mode:void 0},g=this;this.setViewer=function(e){this.viewer=e,this.navapi=e?e.navigation:null,e&&this.setGlobalManager(e.globalManager)};var y=function(e){m.buttons[e.touches?0:e.button]=!0,m.src=e.target.className,m.x=0,m.y=0,m.dx=0,m.dy=0,m.firstMove=!0,m.mode=void 0,"ring"===m.src?m.mode=l:"edgemark-area"===m.src&&("layout-ver"===e.target.parentNode.className?m.mode=a:"layout-hor"===e.target.parentNode.className&&(m.mode=s)),S(),e.stopPropagation()},b=function(e){m.buttons[e.touches?0:e.button]=!1,m.src=void 0},_=function(e){m.buttons[0]&&(x(e),E(),m.firstMove=!1)},x=function(e){var t=e.touches?e.touches[0].pageX:e.pageX,n=e.touches?e.touches[0].pageY:e.pageY;m.firstMove||(m.dx=t-m.x,m.dy=n-m.y),m.x=t,m.y=n},E=function(){switch(m.mode){case l:if(!g.navapi.isActionEnabled("roll"))return;break;case a:case s:if(!g.navapi.isActionEnabled("orbit"))return}var e=r.target.clone().sub(r.position).normalize(),t=e.clone().cross(r.up).normalize(),n=t.clone().cross(e).normalize();if(r.up.copy(n),m.mode===l){var o=new THREE.Vector3(m.x-d.center.x,m.y-d.center.y,0),p=new THREE.Vector3(m.dx,m.dy,0).add(o);o.normalize(),p.normalize();var f=o.clone().cross(p),v=Math.asin(f.z);r.up.applyAxisAngle(e,-v*h)}else{var y,b;m.mode===a?(b=-m.dx*c,i&&(r.up=ue.Navigation.snapToAxis(r.up.clone())),y=r.up):m.mode===s&&(b=-m.dy*u,i?(m.firstMove&&(r.up=ue.Navigation.snapToAxis(r.up.clone())),y=e.clone().cross(r.up).normalize()):y=t,r.up.applyAxisAngle(y,b));var _=g.navapi.getPivotPoint(),x=r.position.clone().sub(_);x.applyAxisAngle(y,b),r.position.addVectors(_,x);var E=r.target.clone().sub(_);E.applyAxisAngle(y,b),r.target.addVectors(_,E)}r.dirty=!0},w=function(e,t){var n=t||e.clone().sub(r.position).normalize();return new THREE.Plane(n,-n.x*e.x-n.y*e.y-n.z*e.z)},S=function(){var e=r.target.clone().sub(r.position).normalize(),t=w(r.position,e).distanceToPoint(r.pivot);r.pivot.copy(e).multiplyScalar(t).add(r.position)},A=function(e){e.touches||0!==e.button||S()},M=function(){f&&g.viewer.setActiveNavigationTool()},T=function(e,t){var n,i=g.viewer.impl.hitTest(e,t);i&&i.intersectPoint?n=i.intersectPoint:n=g.viewer.impl.viewportToRay(g.viewer.impl.clientToViewport(e,t)).intersectPlane(w(r.target));var o=r.position.clone().sub(function(){var e=r.target.clone().sub(r.position).normalize(),t=g.viewer.impl.rayIntersect(new THREE.Ray(r.position,e));return t&&t.intersectPoint?t.intersectPoint:r.target}()).add(n);g.navapi.setRequestTransition(!0,o,n,r.fov)};this.register=function(){(e=(0,Y.stringToDOM)(de)).style.display="none",this.viewer.canvasWrap.insertBefore(e,this.viewer.canvasWrap.firstChild),(t=e.querySelector(".ring")).addEventListener("mousedown",y),Array.prototype.forEach.call(e.querySelectorAll(".edgemark-area"),(function(e){e.addEventListener("mousedown",y),p&&e.addEventListener("touchstart",y)})),this.addWindowEventListener("mouseup",b),this.addWindowEventListener("mousemove",_),(n=e.querySelector(".outside")).addEventListener("mousedown",M);var i=e.querySelector(".circle");i.addEventListener("mousedown",A),p&&(t.addEventListener("touchstart",y),this.addWindowEventListener("touchend",b),this.addWindowEventListener("touchmove",_),n.addEventListener("touchstart",M),i.addEventListener("touchstart",A)),r=this.viewer.impl.camera},this.deregister=function(){this.removeWindowEventListener("mouseup",b),this.removeWindowEventListener("mousemove",_),n.removeEventListener("mousedown",M),p&&(this.removeWindowEventListener("touchend",b),this.removeWindowEventListener("touchmove",_),n.removeEventListener("touchstart",M)),this.viewer.canvasWrap.removeChild(e),e=void 0,t=void 0,n=void 0},this.activate=function(t){e.style.display="",this.handleResize(),i="fusion orbit constrained"===t;var n=this.viewer.toolController.isToolActivated("hyperlink");n&&this.viewer.toolController.deactivateTool("hyperlink"),i?(this.viewer.setDefaultNavigationTool("orbit"),this.viewer.prefs.set("fusionOrbitConstrained",!0)):(this.viewer.setDefaultNavigationTool("freeorbit"),this.viewer.prefs.set("fusionOrbitConstrained",!1)),n&&this.viewer.toolController.activateTool("hyperlink"),this.viewer.navigation.setZoomTowardsPivot(!0)},this.deactivate=function(){e.style.display="none",this.viewer.navigation.setZoomTowardsPivot(this.viewer.prefs.get("zoomTowardsPivot"))},this.getNames=function(){return o},this.getName=function(){return o[0]},this.update=function(){return!1},this.handleSingleClick=function(e){return T(e.canvasX,e.canvasY),!0},this.handleDoubleClick=function(){return!0},this.handleSingleTap=function(e){return T(e.canvasX,e.canvasY),!0},this.handleDoubleTap=function(){return!1},this.handleKeyDown=function(){return!1},this.handleKeyUp=function(){return!1},this.handleWheelInput=function(){return!1},this.handleButtonDown=function(){return!1},this.handleButtonUp=function(){return!1},this.handleMouseMove=function(e){var t=this.viewer.impl.getCanvasBoundingClientRect(),i=(t.width>t.height?new THREE.Vector2(((e.canvasX+.5)/t.width*2-1)*t.width/t.height,-(e.canvasY+.5)/t.height*2+1):new THREE.Vector2((e.canvasX+.5)/t.width*2-1,(-(e.canvasY+.5)/t.height*2+1)*t.height/t.width)).length()>1.2;return f!==i&&(n.style.cursor=i?"":"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAt1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8AAAAzMzP6+vri4uISEhKKioqtra2dnZ2EhIR9fX10dHRkZGQdHR3t7e3Hx8e5ubm1tbWoqKhWVlZKSko4ODgICAjv7+/o6OjMzMyxsbFOTk4pKSkXFxcEBAT29vbW1tZ6enpISEgLCwvhzeX+AAAAGXRSTlMANRO0nHRJHfnskIxQRKh89syDVwTWZjEJxPFEswAAAOFJREFUKM+1j+lygkAQhIflEAJe0Rw9u4CCeKKoSTTX+z9XoMJWWeX+ssrvZ3f19DQ5zOw/0DUMQPlmQ72bE2adBp8/Rp3CQUi3ILx+bxj4fjDs9T1Bmo6bbPPN8aDU4bjJt4nb+de789kSFyxn826jW3ICLNZZKU8nWWbrBTCRVm04U8TpjquRFf1Go0d7l8aYOrUR7FGEFr1S9LGymwthgX2gE/Kl0cHPOtF2xOWZ5QpIC93RflW4InkDoPRXesd5LJIMQPzV7tCMa7f6BvhJL79AVDmYTNQ1NhnxbI/uwB8H5Bjd4zQPBAAAAABJRU5ErkJggg==), auto",f=i),!1},this.handleGesture=function(){return S(),!1},this.handleBlur=function(){return!1},this.handleResize=function(){var n=e.getBoundingClientRect(),i=this.getWindow();d.left=n.left+i.pageXOffset,d.top=n.top+i.pageYOffset,d.width=n.width,d.height=n.height,d.center={},d.center.x=d.left+d.width/2,d.center.y=d.top+d.height/2;var r=.8*(i.innerWidth>i.innerHeight?i.innerHeight:i.innerWidth);e.style.width=e.style.height=r+"px",e.style.top=e.style.left="calc(50% - "+r/2+"px)",t.style.borderWidth=.1*r+"px"}}function fe(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}he.GlobalManagerMixin.call(pe.prototype);var me="fusionfreeorbit",ge="fusionorbit";function ve(e,t){r.Extension.call(this,e,t),this.name=ge,this.modes=[ge,me]}ve.prototype=Object.create(r.Extension.prototype),ve.prototype.constructor=ve;var ye=ve.prototype;ye.load=function(){var e=this.viewer;return this.tool=new pe,this.tool.setViewer(e),e.toolController.registerTool(this.tool),this._onToolChanged=this._onToolChanged.bind(this),!0},ye._updateActiveState=function(e,t){this.activeStatus=e,this.mode=t},ye._onToolChanged=function(e){if("fusion orbit constrained"===e.toolName||"fusion orbit"===e.toolName){var t=this._toolbar.getControl(S.TOOLBAR.NAVTOOLSID),n="fusion orbit"===e.toolName?t.freeorbitbutton:t.orbitbutton,i=e.active?s.Button.State.ACTIVE:s.Button.State.INACTIVE;n.setState(i),this._updateActiveState(!i)}},ye.onToolbarCreated=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var n,i,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,i=this.viewer,(r=t.getControl(S.TOOLBAR.NAVTOOLSID))&&r.orbitbutton){e.next=6;break}return e.next=6,i.loadExtension("Autodesk.DefaultTools.NavTools",i.config);case 6:this._toolbar=t,this.viewer.addEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT,this._onToolChanged),this.classicBehavior={},this.classicBehavior.orbitOnClick=r.orbitbutton.onClick,this.classicBehavior.freeorbitOnClick=r.freeorbitbutton.onClick,this.classicBehavior.returnToDefault=r.returnToDefault,r.freeorbitbutton.onClick=function(){var e=r.freeorbitbutton.getState();e===s.Button.State.INACTIVE?n.activate(me):e===s.Button.State.ACTIVE&&n.deactivate()},r.orbitbutton.onClick=function(){var e=r.orbitbutton.getState();e===s.Button.State.INACTIVE?n.activate(ge):e===s.Button.State.ACTIVE&&n.deactivate()},r.returnToDefault=function(){r.orbittoolsbutton&&r.orbittoolsbutton.setState(s.Button.State.ACTIVE)},r.orbittoolsbutton.setState(s.Button.State.INACTIVE),i.prefs.get("fusionOrbitConstrained")?(r.orbittoolsbutton.onClick=r.orbitbutton.onClick,r.orbittoolsbutton.setIcon(r.orbitbutton.iconClass),i.setDefaultNavigationTool("orbit")):(r.orbittoolsbutton.onClick=r.freeorbitbutton.onClick,r.orbittoolsbutton.setIcon(r.freeorbitbutton.iconClass),i.setDefaultNavigationTool("freeorbit")),i.setActiveNavigationTool(),r.returnToDefault&&r.returnToDefault();case 19:case"end":return e.stop()}}),e,this)})),function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function a(e){fe(o,i,r,a,s,"next",e)}function s(e){fe(o,i,r,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}(),ye.unload=function(){var e=this.viewer;if(e.removeEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT,this._onToolChanged),this.classicBehavior){var t=e.getToolbar().getControl(S.TOOLBAR.NAVTOOLSID);t&&(t.orbitbutton&&(t.orbitbutton.onClick=this.classicBehavior.orbitOnClick),t.freeorbitbutton&&(t.freeorbitbutton.onClick=this.classicBehavior.freeorbitOnClick),t.returnToDefault=this.classicBehavior.returnToDefault,t.orbittoolsbutton&&(t.orbitbutton?t.orbittoolsbutton.onClick=t.orbitbutton.onClick:t.orbittoolsbutton.onClick=null,t.orbittoolsbutton.setIcon("adsk-icon-orbit-constrained"),t.orbittoolsbutton.setState(s.Button.State.ACTIVE))),this.classicBehavior=null}return e.setActiveNavigationTool("orbit"),e.setDefaultNavigationTool("orbit"),e.toolController.deregisterTool(this.tool),this.tool.setViewer(null),this.tool=null,this._toolbar=null,!0},ye.activate=function(e){if(!this.isActive(e)){if(e===me)this.viewer.setActiveNavigationTool("fusion orbit"),this.mode=me;else this.viewer.setActiveNavigationTool("fusion orbit constrained"),this.mode=ge;return this.activeStatus=!0,!0}},ye.deactivate=function(){return this.activeStatus&&(this.viewer.setActiveNavigationTool(),this.activeStatus=!1),!0},i.theExtensionManager.registerExtension("Autodesk.PropertiesManager",u),i.theExtensionManager.registerExtension("Autodesk.ViewerSettings",f),i.theExtensionManager.registerExtension("Autodesk.ModelStructure",E),i.theExtensionManager.registerExtension("Autodesk.DefaultTools.NavTools",k),i.theExtensionManager.registerExtension("Autodesk.Explode",oe),i.theExtensionManager.registerExtension("Autodesk.FullScreen",ae),i.theExtensionManager.registerExtension("Autodesk.GoHome",le),i.theExtensionManager.registerExtension("Autodesk.Viewing.FusionOrbit",ve)},65692:e=>{e.exports={externalExtensions:[{src:"./extensions/Wireframes/Wireframes.js",ids:["Autodesk.Viewing.Wireframes"]},{src:"./extensions/ZoomWindow/ZoomWindow.js",ids:["Autodesk.Viewing.ZoomWindow"]},{src:"./extensions/AEC/LibraryExports.js",ids:["Autodesk.AEC.LevelsExtension","Autodesk.AEC.HyperlinkExtension","Autodesk.AEC.DropMeExtension","Autodesk.AEC.CanvasBookmarkExtension","Autodesk.AEC.Minimap3DExtension","Autodesk.AEC.LocationsExtension","Autodesk.AEC.Hypermodeling","Autodesk.AEC.ViewportsExtension"]},{src:"./extensions/Pushpins/PushPinExtension.js",ids:["Autodesk.BIM360.Extension.PushPin"]},{src:"./extensions/Hyperlink/Hyperlink.js",ids:["Autodesk.Hyperlink"]},{src:"./extensions/Debug/Debug.js",ids:["Autodesk.Debug"]},{src:"./extensions/BimWalk/BimWalk.js",ids:["Autodesk.BimWalk"]},{src:"./extensions/Section/Section.js",ids:["Autodesk.Section"]},{src:"./extensions/CompGeom/index.js",ids:["Autodesk.CompGeom"]},{src:"./extensions/Snapping/index.js",ids:["Autodesk.Snapping"]},{src:"./extensions/Beeline/Beeline.js",ids:["Autodesk.Beeline"]},{src:"./extensions/FirstPerson/FirstPerson.js",ids:["Autodesk.FirstPerson"]},{src:"./extensions/webVR/webVR.js",ids:["Autodesk.Viewing.WebVR"]},{src:"./extensions/WebXR/index.js",ids:["Autodesk.WebXR.Core","Autodesk.WebXR.VR","Autodesk.WebXR.AR"]},{src:"./extensions/CAM360/CAM360.js",ids:["Autodesk.CAM360"]},{src:"./extensions/Collaboration/Collaboration.js",ids:["Autodesk.Viewing.Collaboration"]},{src:"./extensions/FusionSim/FusionSim.js",ids:["Autodesk.Fusion360.Simulation"]},{src:"./extensions/OMV/OMV.js",ids:["Autodesk.OMV"]},{src:"./extensions/SplitScreen/SplitScreen.js",ids:["Autodesk.SplitScreen"]},{src:"./extensions/CrossFadeEffects/CrossFadeEffects.js",ids:["Autodesk.CrossFadeEffects"]},{src:"./extensions/Edit2D/Edit2D.js",ids:["Autodesk.Edit2D"]},{src:"./extensions/Edit3D/Edit3D.js",ids:["Autodesk.Edit3D"]},{src:"./extensions/VisualClusters/VisualClusters.js",ids:["Autodesk.VisualClusters"]},{src:"./extensions/Moldflow/Moldflow.js",ids:["Autodesk.Moldflow"]},{src:"./extensions/PixelCompare/PixelCompare.js",ids:["Autodesk.Viewing.PixelCompare"]},{src:"./extensions/ScalarisSimulation/ScalarisSimulation.js",ids:["Autodesk.Viewing.ScalarisSimulation"]},{src:"./extensions/Measure/Measure.js",ids:["Autodesk.Measure"]},{src:"./extensions/Markup/Markup.js",ids:["Autodesk.Viewing.MarkupsCore","Autodesk.Viewing.MarkupsGui"]},{src:"./extensions/PDF/index.js",ids:["Autodesk.PDF"]},{src:"./extensions/ReCap/index.js",ids:["Autodesk.ReCap"]},{src:"./extensions/Scalaris/index.js",ids:["Autodesk.Scalaris"]},{src:"./extensions/DocumentBrowser/index.js",ids:["Autodesk.DocumentBrowser"]},{src:"./extensions/Geolocation/index.js",ids:["Autodesk.Geolocation"]},{src:"./extensions/Fusion360/AnimationExtension.js",ids:["Autodesk.Fusion360.Animation"]},{src:"./extensions/NPR/index.js",ids:["Autodesk.NPR"]},{src:"./extensions/DOF/DOFExtension.js",ids:["Autodesk.DOF"]},{src:"./extensions/MSDF/index.js",ids:["Autodesk.MSDF"]},{src:"./extensions/MemoryLimited/MemoryLimited.js",ids:["Autodesk.MemoryLimited"]},{src:"./extensions/ViewCubeUi/ViewCubeUi.js",ids:["Autodesk.ViewCubeUi"]},{src:"./extensions/MemoryLimitedDebug/MemoryManager.js",ids:["Autodesk.Viewing.MemoryLimitedDebug"]},{src:"./extensions/BimMarkups/BimMarkups.js",ids:["Autodesk.BIM360.Markups"]},{src:"./extensions/Minimap2D/Minimap2D.js",ids:["Autodesk.BIM360.Minimap"]},{src:"./extensions/GestureDocumentNavigation/GestureDocumentNavigation.js",ids:["Autodesk.BIM360.GestureDocumentNavigation"]},{src:"./extensions/RollCamera/RollCamera.js",ids:["Autodesk.BIM360.RollCamera"]},{src:"./extensions/LayerManager/LayerManager.js",ids:["Autodesk.LayerManager"]},{src:"./extensions/SceneBuilder/sceneBuilder.js",ids:["Autodesk.Viewing.SceneBuilder"]},{src:"./extensions/Popout/index.js",ids:["Autodesk.Viewing.Popout"]},{src:"./extensions/ProfileUi/index.js",ids:["Autodesk.ProfileUi"]},{src:"./extensions/PropertySearch/PropertySearch.js",ids:["Autodesk.PropertySearch"]},{src:"./extensions/StandardSurface/index.js",ids:["Autodesk.StandardSurface"]},{src:"./extensions/MaterialConverterPrism/index.js",ids:["Autodesk.Viewing.MaterialConverterPrism"]},{src:"./extensions/DWF/index.js",ids:["Autodesk.DWF"]},{src:"./extensions/ModelsPanel/index.js",ids:["Autodesk.ModelsPanel"]},{src:"./extensions/ModelAlignment/index.js",ids:["Autodesk.ModelAlignment","Autodesk.SheetAlignment"],dependencies:["Autodesk.Edit3D"]},{src:"./extensions/ModelAlignmentService/ModelAlignmentService.js",ids:["Autodesk.ModelAlignmentService"]},{src:"./extensions/MixpanelProvider/index.js",ids:["Autodesk.Viewing.MixpanelExtension"]},{src:"./extensions/Crop/Crop.js",ids:["Autodesk.Crop"]},{src:"./extensions/DataVisualization/index.js",ids:["Autodesk.DataVisualization"]},{src:"./extensions/ExtensionsPanel/index.js",ids:["Autodesk.ExtensionsPanel"]},{src:"./extensions/StringExtractor/StringExtractor.js",ids:["Autodesk.StringExtractor"]},{src:"./extensions/ModelSheetTransition/ModelSheetTransition.js",ids:["Autodesk.ModelSheetTransition"]},{src:"./extensions/BoxSelection/BoxSelectionExtension.js",ids:["Autodesk.BoxSelection"]},{src:"./extensions/glTF/index.js",ids:["Autodesk.glTF"]},{src:"./extensions/PropertyQuery/index.js",ids:["Autodesk.PropertyQuery"]},{src:"./extensions/VaultPrintUI/index.js",ids:["Autodesk.Vault.Print"]},{src:"./extensions/VaultMarkupsUI/index.js",ids:["Autodesk.Vault.Markups"],dependencies:["Autodesk.BIM360.Markups"]},{src:"./extensions/ThreeJSOverlays/index.js",ids:["Autodesk.ThreeJSOverlays"]},{src:"./extensions/DataExchange/DataExchange.js",ids:["Autodesk.DataExchange"]}],getExtensionEntryKey:function(e){return e.src.split("/")[2]}}},85101:(e,t,n)=>{"use strict";n.r(t);var i=n(61445),r=n(65692),o="min.js";r.externalExtensions.forEach((function(e){var t=(0,r.getExtensionEntryKey)(e),n="extensions/".concat(t,"/").concat(t,".").concat(o),a=e.dependencies;e.ids.forEach((function(e){i.theExtensionManager.registerExternalExtension(e,n,a)}))})),i.theExtensionManager.registerExternalExtension("Autodesk.DiffTool","extensions/DiffTool/DiffTool.".concat(o))},21319:(e,t,n)=>{"use strict";n.r(t),n.d(t,{analytics:()=>c});var i=n(98926),r=n(76967);function o(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.providerMap={},this.instances=[],this.superProps={},this.shouldTrack=!0,this.trackCache=[],this.oneTimers={}}var t,n,a;return t=e,n=[{key:"registerProvider",value:function(e){var t=this;if(e)if(e.name){var n=e.name.toLowerCase();n in this.providerMap?i.logger.warn("Provider with name ".concat(e.name," already registered")):this.providerMap[n]=e;var r=this.createInstance(e.name,e.defaultOptions);this.instances.push(r),this.shouldTrack&&this.init(r),this.trackCache.length>0&&(this.trackCache.forEach((function(e){var n=e.event,i=e.properties;t.track(n,i)})),this.trackCache=[])}else i.logger.error("missing provider name");else i.logger.error("Undefined provider")}},{key:"init",value:function(e){e.initialized||(e.init(),e.register(this.superProps))}},{key:"createInstance",value:function(e,t){var n=e&&e.toLowerCase();if(n in this.providerMap){var o=this.providerMap[n],a=new o(t);if(!(a instanceof r.AnalyticsProviderInterface))throw new Error("not an analytics provider");return o.instanceCount=o.instanceCount||0,a.name="".concat(n,"-").concat(o.instanceCount),o.instanceCount++,a}i.logger.error("Unknown ".concat(e))}},{key:"optIn",value:function(e){var t=this;this.instances.forEach((function(e){return t.init(e)})),this._callMethod("optIn",e),this.shouldTrack=!0}},{key:"optOut",value:function(e){this._callMethod("optOut",e),this.shouldTrack=!1}},{key:"hasOptedOut",value:function(){return this._callMethod("hasOptedOut")}},{key:"getDistinctId",value:function(){return this._callMethod("getDistinctId")}},{key:"track",value:function(e,t,n){if(this.shouldTrack){if(n){var i={event:e,properties:t};try{var r=JSON.stringify(i);if(this.oneTimers[r])return;this.oneTimers[r]=!0}catch(e){}}0===this.instances.length?this.trackCache.push({event:e,properties:t}):this._callMethod("track",e,t)}}},{key:"identify",value:function(e){this._callMethod("identify",e)}},{key:"_callMethod",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t[0],r=t.slice(1,t.length);return this.instances.map((function(e){return{name:e.name,value:e[i].apply(e,o(r))}}))}}],n&&s(t.prototype,n),a&&s(t,a),e}(),c=new l},76967:(e,t,n)=>{"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.r(t),n.d(t,{AnalyticsProviderInterface:()=>o});var o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.options=t}var t,n,o;return t=e,o=[{key:"name",get:function(){return null}},{key:"defaultOptions",get:function(){return{}}}],(n=[{key:"init",value:function(){}},{key:"register",value:function(){}},{key:"optIn",value:function(e){}},{key:"optOut",value:function(e){}},{key:"hasOptedOut",value:function(){}},{key:"getDistinctId",value:function(){}},{key:"track",value:function(e,t){}},{key:"identify",value:function(e){}}])&&r(t.prototype,n),o&&r(t,o),e}()},80382:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Animation:()=>r,interpolateCatmullRom:()=>o});var i=n(80738);function r(e,t,n){this.root=e,this.handler=n.animationHandler,this.data=this.handler.init(t),this.hierarchy=this.handler.parse(e),this.viewer=n.viewer,this.animator=n,this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.isPaused=!0,this.loop=!1,this.delta=.5,this.interpolationType=i.u.LINEAR,this.setStartAndEndKeyTime()}function o(e,t){function n(e,t,n,i,r,o,a){var s=.5*(n-e),l=.5*(i-t);return(2*(t-n)+s+l)*a+(-3*(t-n)-2*s-l)*o+s*r+t}var i,r,o,a,s,l,c,u,h,d=[],p=[];return o=(i=(e.length-1)*t)-(r=Math.floor(i)),d[0]=0===r?r:r-1,d[1]=r,d[2]=r>e.length-2?r:r+1,d[3]=r>e.length-3?r:r+2,l=e[d[0]],c=e[d[1]],u=e[d[2]],h=e[d[3]],s=o*(a=o*o),p[0]=n(l[0],c[0],u[0],h[0],o,a,s),p[1]=n(l[1],c[1],u[1],h[1],o,a,s),p[2]=n(l[2],c[2],u[2],h[2],o,a,s),p}n(35449).GlobalManagerMixin.call(r.prototype),r.prototype.setStartAndEndKeyTime=function(){if(this.data.hierarchy.length>0){var e=this.data.hierarchy[0].keys;this.startKeyTime=e[0].time,this.endKeyTime=e[e.length-1].time}else this.startKeyTime=this.endKeyTime=0},r.prototype.keyTypes=[],r.prototype.defaultKey={},r.prototype.play=function(e){this.currentTime=void 0!==e?e:0,this.isPlaying=!0,this.isPaused=!1,this.reset(),this.handler.play(this)},r.prototype.pause=function(){!0===this.isPaused?this.handler.play(this):this.handler.stop(this),this.isPaused=!this.isPaused},r.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1,this.handler.stop(this)},r.prototype.goto=function(e){this.isPlaying||this.play(),this.isPaused||this.pause();var t=e-this.currentTime;this.update(t)},r.prototype.reset=function(){for(var e=0,t=this.hierarchy.length;e<t;e++){var n=this.hierarchy[e];void 0===n.animationCache&&(n.animationCache={}),void 0===n.animationCache[this.data.name]&&(n.animationCache[this.data.name]={prevKey:this.defaultKey,nextKey:this.defaultKey,originalMatrix:n.matrix});for(var i=n.animationCache[this.data.name],r=0;r<this.keyTypes.length;r++){for(var o=this.keyTypes[r],a=this.data.hierarchy[e].keys[0],s=this.getNextKeyWith(o,e,1);s.time<this.currentTime&&s.index>a.index;)a=s,s=this.getNextKeyWith(o,e,s.index+1);i.prevKey[o]=a,i.nextKey[o]=s}}this.setStartAndEndKeyTime()},r.prototype.getNextKeyWith=function(e,t,n){var r=this.data.hierarchy[t].keys;for(this.interpolationType===i.u.CATMULLROM||this.interpolationType===i.u.CATMULLROM_FORWARD?n=n<r.length-1?n:r.length-1:n%=r.length;n<r.length;n++)if(void 0!==r[n][e])return r[n];return this.data.hierarchy[t].keys[0]},r.prototype.getPrevKeyWith=function(e,t,n){var r=this.data.hierarchy[t].keys;for(n=this.interpolationType===i.u.CATMULLROM||this.interpolationType===i.u.CATMULLROM_FORWARD?n>0?n:0:n>=0?n:n+r.length;n>=0;n--)if(void 0!==r[n][e])return r[n];return this.data.hierarchy[t].keys[r.length-1]},r.prototype.isPlayingOutOfRange=function(){return!1===this.isPaused&&(this.currentTime<this.startKeyTime-this.delta||this.currentTime>this.endKeyTime+this.delta)},r.prototype.resetIfLooped=function(){!0===this.loop&&this.currentTime>this.endKeyTime&&(this.currentTime%=this.endKeyTime,this.reset())}},80738:(e,t,n)=>{"use strict";n.d(t,{u:()=>i});var i={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2}},21550:(e,t,n)=>{"use strict";function i(){this.animations=[]}n.r(t),n.d(t,{KeyFrameAnimator:()=>g}),i.prototype.init=function(e){if(!0===e.initialized)return e;for(var t=0;t<e.hierarchy.length;t++){for(var n=0;n<e.hierarchy[t].keys.length;n++)if(e.hierarchy[t].keys[n].time<0&&(e.hierarchy[t].keys[n].time=0),void 0!==e.hierarchy[t].keys[n].rot&&!(e.hierarchy[t].keys[n].rot instanceof THREE.Quaternion)){var i=e.hierarchy[t].keys[n].rot;Array.isArray(i)||(i=[i._x,i._y,i._z,i._w]),e.hierarchy[t].keys[n].rot=(new THREE.Quaternion).fromArray(i)}for(var r=1;r<e.hierarchy[t].keys.length;r++)e.hierarchy[t].keys[r].time===e.hierarchy[t].keys[r-1].time&&(e.hierarchy[t].keys.splice(r,1),r--);for(var o=0;o<e.hierarchy[t].keys.length;o++)e.hierarchy[t].keys[o].index=o}return e.initialized=!0,e},i.prototype.parse=function(e){var t=[];return function e(t,n){if(n.push(t),t.children&&!(t instanceof THREE.Camera))for(var i=0;i<t.children.length;i++)e(t.children[i],n)}(e,t),t},i.prototype.play=function(e){-1===this.animations.indexOf(e)&&this.animations.push(e)},i.prototype.stop=function(e){var t=this.animations.indexOf(e);-1!==t&&this.animations.splice(t,1)},i.prototype.update=function(e){for(var t=0;t<this.animations.length;t++)this.animations[t].update(e)};var r,o,a,s=n(94981),l=n(16453),c=n(80738),u=n(80382);function h(e,t,n){u.Animation.call(this,e,t,n),this.followCam=!0}function d(e,t,n){var i,r=this;u.Animation.call(this,{},e,n),this.fragPointers=[],this.nodeChildren=[],this.nodeFragments=[];var o=this.viewer.model.getData().instanceTree;o.enumNodeChildren(t,(function(e){r.nodeChildren.push(e)}),!0),o.enumNodeFragments(e.id,(function(e){r.nodeFragments.push(e),(i=r.viewer.getFragmentProxy(r.viewer.model,e))&&(r.fragPointers.push(i),i.setMaterial(r.viewer.matman().cloneMaterial(i.getMaterial(),r.viewer.model)))}),!0),this.nodeId=t,this.epsilon=.1}h.prototype=Object.create(u.Animation.prototype),h.prototype.constructor=h,h.prototype.keyTypes=["pos","up","target","fov","perspective"],h.prototype.defaultKey={pos:0,up:0,target:0,fov:0,perspective:0},h.prototype.setFollowCamera=function(e){this.followCam=e},h.prototype.update=(r=[],o=new l.Vector3,a=new l.Vector3,function(e){if(!1!==this.isPlaying&&(this.currentTime+=e*this.timeScale,this.resetIfLooped(),this.followCam&&!this.isPlayingOutOfRange())){for(var t=0,n=this.hierarchy.length;t<n;t++){for(var i=this.hierarchy[t],s=i.animationCache[this.data.name],l=0;l<this.keyTypes.length;l++){var h=this.keyTypes[l],d=s.prevKey[h],p=s.nextKey[h];if(p.time<=this.currentTime||d.time>=this.currentTime){for(d=this.data.hierarchy[t].keys[0],p=this.getNextKeyWith(h,t,1);p.time<this.currentTime&&p.index>d.index;)d=p,p=this.getNextKeyWith(h,t,p.index+1);s.prevKey[h]=d,s.nextKey[h]=p}var f=d[h],m=p[h];if(p.time!==d.time&&void 0!==f&&void 0!==m){var g,v=(this.currentTime-d.time)/(p.time-d.time);if(v<0&&(v=0),v>1&&(v=1),"pos"===h)g=i.position;else if("up"===h)g=i.up;else if("target"===h)g=i.target;else{if("fov"===h){i.setFov(f+(m-f)*v);continue}if("perspective"===h){(v>.5?m:f)?i.toPerspective():i.toOrthographic();continue}}if(this.interpolationType===c.u.LINEAR)a.x=f[0]+(m[0]-f[0])*v,a.y=f[1]+(m[1]-f[1])*v,a.z=f[2]+(m[2]-f[2])*v,g.copy(a);else{r[0]=this.getPrevKeyWith(h,t,d.index-1)[h],r[1]=f,r[2]=m,r[3]=this.getNextKeyWith(h,t,p.index+1)[h],v=.33*v+.33;var y=(0,u.interpolateCatmullRom)(r,v);if(a.x=y[0],a.y=y[1],a.z=y[2],g.copy(a),this.interpolationType===c.u.CATMULLROM_FORWARD){var b=(0,u.interpolateCatmullRom)(r,1.01*v);o.set(b[0],b[1],b[2]),o.sub(g),o.y=0,o.normalize();var _=Math.atan2(o.x,o.z);i.rotation.set(0,_,0)}}}}i.matrixAutoUpdate=!0,i.matrixWorldNeedsUpdate=!0}i.lookAt(i.target),this.animator.updateFlag|=this.animator.UPDATE_CAMERA}}),d.prototype=Object.create(u.Animation.prototype),d.prototype.constructor=d,d.prototype.keyTypes=["vis","opa"],d.prototype.defaultKey={viz:1,opa:1},d.prototype.getPrevAndNextKeys=function(e,t){for(var n=this.data.hierarchy[e].keys[0],i=this.getNextKeyWith(t,e,1);i.time<this.currentTime&&i.index>n.index;)n=i,i=this.getNextKeyWith(t,e,i.index+1);return{prevKey:n,nextKey:i}},d.prototype.update=function(e){if(!1!==this.isPlaying&&(this.currentTime+=e*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange()))for(var t=0,n=this.hierarchy.length;t<n;t++){var i=this.hierarchy[t].animationCache[this.data.name],r=i.prevKey.vis,o=i.prevKey.vis,a=i.prevKey.opa,s=i.prevKey.opa;if(o.time<=this.currentTime||r.time>=this.currentTime){var l=this.getPrevAndNextKeys(t,"vis");r=l.prevKey,o=l.nextKey,i.prevKey.vis=r,i.nextKey.vis=o}if(s.time<=this.currentTime||a.time>=this.currentTime){var c=this.getPrevAndNextKeys(t,"opa");a=c.prevKey,s=c.nextKey,i.prevKey.opa=a,i.nextKey.opa=s}var u=r.vis,h=o.vis;if(void 0!==u&&void 0!==h&&r.time!==o.time){var d=Math.abs(this.currentTime-o.time)<this.epsilon?h:u;this.viewer.visibilityManager.setNodeOff(this.nodeId,!d,this.viewer.model,this.nodeChildren,this.nodeFragments)}if(u=a.opa,h=s.opa,void 0===u&&1===r.vis&&(u=1),void 0!==u&&void 0!==h&&a.time!==s.time){var p=(this.currentTime-a.time)/(s.time-a.time);p<0&&(p=0),p>1&&(p=1);for(var f=u+(h-u)*p,m=0;m<this.fragPointers.length;++m){var g=this.fragPointers[m].getMaterial();g.transparent=1!==f,g.opacity=f}f>0&&this.viewer.visibilityManager.setNodeOff(this.nodeId,!1,this.viewer.model,this.nodeChildren,this.nodeFragments)}}};var p=n(94370);function f(e,t,n){var i=this;null===e&&(e=function(e,t,n){var r=this.getDocument(),o=i.container=r.createElement("div"),a=e.name;o.id=a,o.style.cursor="pointer",o.style.visibility=n;var s=r.createElement("div");s.id=a+"-txt",s.style.cssText="display: none;position: absolute;z-index: 1;",o.appendChild(s);var c=r.createElement("img"),u=e.custom&&e.custom.att&&1===e.custom.att;c.src=u?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABv1BMVEUAAAAAAAAAAAAAAAABAwEAAAAAAAAjSRkAAAAFDASJqnZhg1IqTyAjSRkpTx8hRxggRRcAAAAhRRcKFwgAAACau4R9mnFmiFUhSBgbOhMZNhIAAAAECQMgQxcAAAAAAAAAAAAHDwXB2q2jw4yfvoivyJ6fuI6mv5eSr4KAoWu2trZpiV3Nzc0wVSUhRxhNT01vb28AAAAgRBcAAAAAAAAAAAAhRxgeQBYAAAAAAAAAAAAfQRbP5MC0zqCqyJKpyJJBYje3z6WxyKOFpXF9nmkrTiG+wb5xkGVcf0xYfEg1WSpNTU0hRhgfQhYfQhZVVVVAQEAXMREcOhQcHBwSJw0AAAAAAAAWLxAVLQ8AAAAAAAAfQhYIEgYAAACbvn+DsGCGsmSUunaItGXc6dStypelxY2ZvX2Ntm2JtGnS48fB17G40aWNuWucxH6ny4mUvnPF27aPuHCEsGHV5czI3Lq52KGvzJqz1JmqyJOqzY6ew4OYwHiGs2OEsWHb29vL4LvM5bnD3q2+3KWkyoaLtWuKtmfOzs7IyMi21pyawXqPuG/g4ODX68fI4rTG4LCu0ZKszJKlx4qZwHuBnXR2iXENcZskAAAAXnRSTlMAEAIBCAsF6BUn+vPu7erjsZyBEwP99/TRk3JgRUQ1IxwO/v79/Pv6+fn09PPq08q7sqWDe2xrY01AMBj+/v7+/v37+fn59fXz8u/c1cbFxLWonZiIcm1lYVdSQT8de/EoFwAAAgVJREFUOMutklVz21AQRiNFlswYs+M6DTdN0kCDZWZmuAKDZFtgiO2YYm6TlOEHV53ptGs5j93Xc+a7e3d36P/W9prdZ/PZ17aPxphz3mR0x91G07wTG8TDo5R3HLGH3S6fGPdSo8Na/to6W2HZBEqwPCNULlu1BkFdQSyKx4qxOMoyDDJSRB/HnTcqWbSbTmVS6V3E57hvXicOBZd1gmfj6Z1kPrmTjrMMfRizumDA+k3UTcRSyWg0mkzFEgLNlU3rIIJcns0KqJjJq0I+U0SqUJlZJv8JugU3J/QnHEwu6MCMqPN1pq+H3sFxCgOC7RyT48Ev6qLUL/gmeJrJ/p0DzSnyxTtAGLMbv9dohv8zSbomSqUpOxB0AdNXsUbnGEEQmJzKq3JrLgCaJAzms5LI1enfVefEamc/YzYQYFB6/1xBUsQex3E9UZHkUvO6X48PwQjLTKEjVRVFqUqd8v6naQsMUCNcL8xTrVJZluXyl1K7OW1+7sL71x15cvVH43O7UGi3mmc8lkCE0ByMbvXazwueycbHxiXPrUdv3hLDGiF8au/d4sO7Novtnj9k0BO45uRGTp98f2JlK/RqYzN8TK8bGTjZLTXgfvDp6rMNA0ZADAOWHI6VTYwE4WAZjz/s3V5yvIxADosIPlh0BNXHSdA8LFIfDgE8WDg5hmmx9h/40fgXth2SDk3yjP4AAAAASUVORK5CYII=":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABvFBMVEUAAAAAAAADAAAAAAAAAAACAAAAAAAAAAC5PznHVE8BAAAAAADbc27NXVeUDQaZDQaRBwAAAAAAAACHBgDuhoHVa2W9RD2QCAKYCAGPBgB0BQAAAAAAAACMBgAAAAADAAD2jonWb2n2jYjYbWfmeXPNzc3RYFqzODKfFA1RUVGKBgCVBwBvb2+WBwCBBgCFBgCWBwCLBgAAAAAAAACMBgCTBwByBQCTBwBbBACEBgAAAAAAAAAoAgBSBADgeHOoOzXmfnnofnjieHPGvr63t7e0tLTidW/ebmnba2XWZWDAT0qRHBfBSkRNTU2aFxGOBgBYTEsAAACNBgBAQEAAAABbBQAcHBxyBQBKBAAAAABfBAAAAAAAAAAsAgAkAgCJBgDZRT3MOTHQPDTVQjrlUkrjUEjRPjbOOjP/bGTvXFTqV0/fTETNOjL5Zl7eS0PzYFjxXlbiT0fUQTn0e3T7aGDWXFXbSEDTRj/PQTrOPjbb29vgamTxY1zoVE3STETTQjvSPzfOzs7IyMj5g3zzaWLXY13XYVrsXlbbU0zg4OD8lZD4gXq0eHXqd3HscWv2b2jrZmDQZWDdWVLkV1C5y9+5AAAAYHRSTlMAAgUBDggMEeDsIBj+8NHJxpxAEP754tDDtIFsYDkvI/78+/j08/DfycfHxbuvr5mTjYN0bWxkWVZTTDUjEfz8+/n59fT08vHw8PDw5NzV0Mq5uLWrm5iLfX1hV0g/ODZEwKduAAACAklEQVQ4y62SVXPbQBzEa1mWZYaY49ihBhtmKjMzw92JLLBsyxxT2mCZvnCVmU59VpO37Ms97G929nb+p05WXUvTE5GJ6aWuY+yFEdoVdAZd9MjCEYi5J0L3FZutSqVZdIYiPWaj/85j2yszAACGVyq7Lo+RIMZtxRaQOZaTwZZSLbrGLR2+aX54twVykpgVpRzgYbVGz5twYMPTV2ZkKZMupDOSzAiwfNazgQesDO9VASemU6lUWuQAgnyNXsEiiBlbEwE2W9CBQpbVAfRraIZoA5ZosII6EpB6MYrVpLxOQejowKsBL9UGSK+zCnnsF4omB7wkBkQHylDZ+rcDROD3hYcYQE0NHQhQ4f8uCQVG/XF9isJKLtI1TYBQQAgdPlqJzYcWMYBYd58/YJACD6UgpsTVA+51AhvKGgt9zQGN1xN4Dajs/vbtmBXf2mIP3/jGqiW9Q0nlGtn8tXBSnwGPWHYP5PcbLMs2JHFn+6p7WQ/ARTie3/rZm9+pZ+rfP/fawi8dhOFgqLlLX87dHOz/1D9ou/vsrcNiNgBrZzbf338yOXZvbDL2xm4ljCdn6j794cpswr/62p+wWy2m/042oQeMxudedK8mSdzGAy4/9vlm/STRtjGRTz9u3nnge2U3+O2h4o9GfXG7lcLKGWZY8ycduG3sQJCk0Tb+w3S0/Qemc4+eJchuZgAAAABJRU5ErkJggg==",c.id=a+"-img",c.style.cssText="display: block;position: absolute;z-index: 1;",o.appendChild(c),t.api.container.appendChild(o),o.addEventListener("click",(function(){s.style.display="none"===s.style.display?"block":"none"}));var h=new l.SphereGeometry(.01),d=new l.MeshPhongMaterial({color:32512,ambient:32512,opacity:.6,transparent:!0}),p=new l.Mesh(h,d);return p.visible=!1,void 0===t.overlayScenes.annotation&&t.createOverlayScene("annotation"),t.addOverlay("annotation",p),p}.call(this,t,n.viewer,"hidden")),u.Animation.call(this,e,t,n),this.id=t.name,this.text="",this.state="hidden",this.epsilon=.1,this.viewer.api.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,(function(t){i.updateText(e.position,i.text)}))}function m(e,t,n){this.viewer=n.viewer,null===e&&(e=this.createPolyline([])),u.Animation.call(this,e,t,n),this.epsilon=.1}function g(e,t){this.animations=[],this.viewer=e,this.setGlobalManager(e.globalManager),this.keys=[],this.isPlaying=!1,this.isPaused=!0,this.updateFlag=0,this.duration=t,this.currentTime=0,this.onPlayCallback=null,this.animationHandler=new i,this.areCameraAnimationsPaused=!1,this.UPDATE_SCENE=1,this.UPDATE_CAMERA=2,this.followCam=!0,this._speedMod=1,this._loops=!1}f.prototype=Object.create(u.Animation.prototype),f.prototype.constructor=f,f.prototype.keyTypes=["pos","text","vis"],f.prototype.defaultKey={pos:0,text:"",vis:1},f.prototype.stop=function(){u.Animation.prototype.stop.call(this),this.container.parentNode.removeChild(this.container),this.viewer.removeOverlay("annotation",this.root),this.root=null},f.prototype.updateText=function(e,t){var n=function(e,t,n){var i=e.clone(),r=new l.Matrix4;return t.updateMatrixWorld(),r.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),{x:((i=(0,p.r)(i,r)).x+1)*n.width/2+n.offsetLeft-12,y:(1-i.y)*n.height/2+n.offsetTop+12}}(e,this.viewer.camera,this.viewer.canvas),i=this.getDocument(),r=i.getElementById(this.id+"-txt");r&&(r.innerHTML=t,r.style.left=n.x+"px",r.style.top=n.y+"px",this.text=t),(r=i.getElementById(this.id+"-img"))&&(r.style.left=n.x+"px",r.style.top=n.y-24+"px")},f.prototype.update=function(){var e=[],t=new l.Vector3,n=new l.Vector3;return function(i){if(!1!==this.isPlaying&&(this.currentTime+=i*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange())){var r=this.getDocument();if(this.isPaused&&this.currentTime<this.startKeyTime)(E=r.getElementById(this.id))&&(E.style.visibility=this.state);else for(var o=0,a=this.hierarchy.length;o<a;o++){for(var s=this.hierarchy[o],l=s.animationCache[this.data.name],h=0;h<this.keyTypes.length;h++){var d=this.keyTypes[h],p=l.prevKey[d],f=l.nextKey[d];if(f.time<=this.currentTime||p.time>=this.currentTime){for(p=this.data.hierarchy[o].keys[0],f=this.getNextKeyWith(d,o,1);f.time<this.currentTime&&f.index>p.index;)p=f,f=this.getNextKeyWith(d,o,f.index+1);l.prevKey[d]=p,l.nextKey[d]=f}var m=p[d],g=f[d];if(f.time!==p.time&&void 0!==m&&void 0!==g){var v=(this.currentTime-p.time)/(f.time-p.time);if(v<0&&(v=0),v>1&&(v=1),"pos"===d){if(this.interpolationType===c.u.LINEAR)n.x=m[0]+(g[0]-m[0])*v,n.y=m[1]+(g[1]-m[1])*v,n.z=m[2]+(g[2]-m[2])*v,s.position.copy(n);else if(this.interpolationType===c.u.CATMULLROM||this.interpolationType===c.u.CATMULLROM_FORWARD){e[0]=this.getPrevKeyWith("pos",o,p.index-1).pos,e[1]=m,e[2]=g,e[3]=this.getNextKeyWith("pos",o,f.index+1).pos,v=.33*v+.33;var y=(0,u.interpolateCatmullRom)(e,v);if(n.x=y[0],n.y=y[1],n.z=y[2],s.position.copy(n),this.interpolationType===c.u.CATMULLROM_FORWARD){var b=(0,u.interpolateCatmullRom)(e,1.01*v);t.set(b[0],b[1],b[2]),t.sub(vector),t.y=0,t.normalize();var _=Math.atan2(t.x,t.z);s.rotation.set(0,_,0)}}}else if("text"===d){var x=Math.abs(this.currentTime-f.time)<this.epsilon?g:m;this.updateText(s.position,x)}else if("vis"===d){var E;if(E=r.getElementById(this.id)){var w=Math.abs(this.currentTime-f.time)<this.epsilon?g:m;E.style.visibility=w?"visible":"hidden"}}}}s.matrixAutoUpdate=!0,s.matrixWorldNeedsUpdate=!0}}}}(),m.prototype=Object.create(u.Animation.prototype),m.prototype.constructor=m,m.prototype.keyTypes=["points","vis"],m.prototype.defaultKey={points:[],vis:1},m.prototype.stop=function(){u.Animation.prototype.stop.call(this),this.viewer.removeOverlay("polyline",this.root),this.root=null},m.prototype.update=function(){function e(e){e.root&&(e.viewer.removeOverlay("polyline",e.root),e.root=null)}return function(t){if(!1!==this.isPlaying&&(this.currentTime+=t*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange()))if(this.isPaused&&this.currentTime<this.startKeyTime)e(this);else for(var n=0,i=this.hierarchy.length;n<i;n++)for(var r=this.hierarchy[n].animationCache[this.data.name],o=0;o<this.keyTypes.length;o++){var a=this.keyTypes[o],s=r.prevKey[a],c=r.nextKey[a];if(c.time<=this.currentTime||s.time>=this.currentTime){for(s=this.data.hierarchy[n].keys[0],c=this.getNextKeyWith(a,n,1);c.time<this.currentTime&&c.index>s.index;)s=c,c=this.getNextKeyWith(a,n,c.index+1);r.prevKey[a]=s,r.nextKey[a]=c}var u=s[a],h=c[a];if(c.time!==s.time&&void 0!==u&&void 0!==h){var d=(this.currentTime-s.time)/(c.time-s.time);if(d<0&&(d=0),d>1&&(d=1),"points"===a){var p=d<.5?u:h;this.viewer.removeOverlay("polyline",this.root),this.root=null;for(var f=[],m=0;m<p.length;m++){var g=p[m].slice();if(0===m)g[0]=u[m][0]+(h[m][0]-u[m][0])*d,g[1]=u[m][1]+(h[m][1]-u[m][1])*d,g[2]=u[m][2]+(h[m][2]-u[m][2])*d;else if(m===p.length-1){var v=u.length-1,y=h.length-1;g[0]=u[v][0]+(h[y][0]-u[v][0])*d,g[1]=u[v][1]+(h[y][1]-u[v][1])*d,g[2]=u[v][2]+(h[y][2]-u[v][2])*d}var b=new l.Vector3(g[0],g[1],g[2]);f.push(b)}this.root=this.createPolyline(f)}else if("vis"===a){var _=Math.abs(this.currentTime-c.time)<this.epsilon?h:u;this.root.visible=_,_||e(this)}}}}}(),m.prototype.createPolyline=function(e){for(var t=new l.Geometry,n=0;n<e.length;n++)t.vertices.push(e[n]);t.computeLineDistances();var i=new l.LineDashedMaterial({color:0,dashSize:1,gapSize:.5,linewidth:1}),r=new l.Line(t,i,l.LineStrip);return void 0===this.viewer.overlayScenes.polyline&&this.viewer.createOverlayScene("polyline"),this.viewer.addOverlay("polyline",r),r},n(35449).GlobalManagerMixin.call(g.prototype),g.prototype.destroy=function(){this.stop(),this.viewer=null,this.keys=null,this.animations=null,this.isPlaying=!1,this.isPaused=!1,this.animationHandler=null},g.prototype.add=function(e){var t=this;if(!(!e.hierarchy||e.hierarchy.length<1||!e.hierarchy[0].keys||e.hierarchy[0].keys.length<2)){var n=null,i=this;if("camera"===e.type?(n=new h(i.viewer.camera,e,i),i.animations.push(n)):"annotation"===e.type?(n=new f(null,e,i),i.animations.push(n)):"polyline"===e.type?(n=new m(null,e,i),i.animations.push(n)):"mesh"===e.type?i.viewer.model.getData().instanceTree.enumNodeFragments(e.id,(function(t){var r=i.viewer.getFragmentProxy(i.viewer.model,t);r&&(n=new s.MeshAnimation(r,e,i),i.animations.push(n))}),!0):"visibility"===e.type&&(n=new d(e,e.id,i),i.animations.push(n)),i.animations.forEach((function(e){return e.setGlobalManager(t.globalManager)})),n){for(var r=0,o=e.hierarchy.length;r<o;r++)for(var a=e.hierarchy[r].keys,l=0;l<a.length;l++)void 0===a[l].xk&&i.keys.push(a[l].time);!function(e){e.sort((function(e,t){return e-t})),function(e,t,n){for(t=e.length;n=--t;)for(;n--;)e[t]!==e[n]||e.splice(n,1)}(e)}(i.keys)}this.updateFlag|=this.UPDATE_SCENE}},g.prototype.update=function(e){e*=this._speedMod,this.animationHandler.update(e);var t=this.updateFlag;return this.isPlaying&&!this.isPaused&&(this.currentTime+=e,this.currentTime=Math.min(this.currentTime,this.duration),this.onPlayCallback&&this.onPlayCallback(this.duration>0?this.currentTime/this.duration*100:0),this.currentTime>=this.duration&&(this._loops?this.play(0,this.onPlayCallback):this.pause()),t|=this.UPDATE_SCENE),this.updateFlag=0,t},g.prototype.play=function(e,t){if(this.onPlayCallback=t,this.currentTime>=this.duration&&this.goto(0),this.isPlaying)this.pause();else{for(var n=0;n<this.animations.length;n++){this.animations[n].play(e)}this.isPlaying=!0,this.isPaused=!1}},g.prototype.setFollowCamera=function(e){this.followCam=e;for(var t=0;t<this.animations.length;t++){var n=this.animations[t];n.setFollowCamera&&n.setFollowCamera(e)}},g.prototype.isFollowingCamera=function(){return this.followCam},g.prototype.setSpeedModifier=function(e){this._speedMod=e},g.prototype.getSpeedModifier=function(){return this._speedMod},g.prototype.setLooping=function(e){this._loops=e},g.prototype.isLooping=function(){return this._loops},g.prototype.pause=function(){for(var e=0;e<this.animations.length;e++){var t=this.animations[e];t.isPaused===this.isPaused&&t.pause()}this.isPaused=!this.isPaused,this.areCameraAnimationsPaused=this.isPaused},g.prototype.pauseCameraAnimations=function(){for(var e=0;e<this.animations.length;e++){var t=this.animations[e];t instanceof h&&t.pause()}this.areCameraAnimationsPaused=!this.areCameraAnimationsPaused},g.prototype.stop=function(){for(var e=0;e<this.animations.length;e++){this.animations[e].stop()}this.isPlaying=!1,this.isPaused=!1},g.prototype.goto=function(e){if(void 0!==e){for(var t=0;t<this.animations.length;t++){this.animations[t].goto(e)}this.isPlaying=!0,this.isPaused=!0,this.currentTime=e,this.updateFlag|=this.UPDATE_SCENE}},g.prototype.next=function(){var e=function(e,t){for(var n=-1,i=0;i<t.length;i++)if(t[i]>e){n=t[i];break}return n<0?t[t.length-1]:n}(this.currentTime,this.keys);this.goto(e)},g.prototype.prev=function(){var e=function(e,t){for(var n=-1,i=t.length-1;i>-1;i--)if(t[i]<e){n=t[i];break}return n<0?t[0]:n}(this.currentTime,this.keys);this.goto(e)}},94981:(e,t,n)=>{"use strict";n.r(t),n.d(t,{MeshAnimation:()=>d});var i,r,o,a,s,l,c=n(16453),u=n(80738),h=n(80382);function d(e,t,n){h.Animation.call(this,e,t,n),this.localMatrix=new c.Matrix4,this.root.getAnimTransform(),this.relativeTransform=!t.custom||!t.custom.transform||"abs"!==t.custom.transform}d.prototype=Object.create(h.Animation.prototype),d.prototype.constructor=d,d.prototype.keyTypes=["pos","rot","scl"],d.prototype.defaultKey={pos:0,rot:0,scl:0},d.prototype.update=(i=[],r=new c.Vector3,o=new c.Vector3,a=new c.Quaternion,s=new c.Matrix4,l=new c.Matrix4,function(e){if(!1!==this.isPlaying&&(this.currentTime+=e*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange()))for(var t=0,n=this.hierarchy.length;t<n;t++){for(var d=this.hierarchy[t],p=d.animationCache[this.data.name],f=0;f<this.keyTypes.length;f++){var m=this.keyTypes[f],g=p.prevKey[m],v=p.nextKey[m];if(v.time<=this.currentTime||g.time>=this.currentTime){for(g=this.data.hierarchy[t].keys[0],v=this.getNextKeyWith(m,t,1);v.time<this.currentTime&&v.index>g.index;)g=v,v=this.getNextKeyWith(m,t,v.index+1);p.prevKey[m]=g,p.nextKey[m]=v}var y=g[m],b=v[m];if(v.time!==g.time&&void 0!==y&&void 0!==b){var _=(this.currentTime-g.time)/(v.time-g.time);if(_<0&&(_=0),_>1&&(_=1),"pos"===m)if(this.interpolationType===u.u.LINEAR)o.x=y[0]+(b[0]-y[0])*_,o.y=y[1]+(b[1]-y[1])*_,o.z=y[2]+(b[2]-y[2])*_,d.position.copy(o);else{i[0]=this.getPrevKeyWith("pos",t,g.index-1).pos,i[1]=y,i[2]=b,i[3]=this.getNextKeyWith("pos",t,v.index+1).pos,_=.33*_+.33;var x=(0,h.interpolateCatmullRom)(i,_);if(o.x=x[0],o.y=x[1],o.z=x[2],d.position.copy(o),this.interpolationType===u.u.CATMULLROM_FORWARD){var E=(0,h.interpolateCatmullRom)(i,1.01*_);r.set(E[0],E[1],E[2]),r.sub(vector),r.y=0,r.normalize();var w=Math.atan2(r.x,r.z);d.rotation.set(0,w,0)}}else"rot"===m?(c.Quaternion.slerp(y,b,a,_),d.quaternion.copy(a)):"scl"===m&&(o.x=y[0]+(b[0]-y[0])*_,o.y=y[1]+(b[1]-y[1])*_,o.z=y[2]+(b[2]-y[2])*_,d.scale.copy(o))}}if(!this.relativeTransform){var S=s.compose(d.position,d.quaternion,d.scale),A=l;d.getOriginalWorldMatrix(A),A.invert(),s.multiplyMatrices(S,A).decompose(d.position,d.quaternion,d.scale)}d.updateAnimTransform()}})},70520:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AggregatedView:()=>I});var i=n(17167),r=n(84998),o=n(7724),a=n(71224);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function u(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function a(e){u(o,i,r,a,s,"next",e)}function s(e){u(o,i,r,a,s,"throw",e)}a(void 0)}))}}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function g(e,t,n){return t&&m(e.prototype,t),n&&m(e,n),e}var v=Autodesk.Viewing,y=v.Private,b=function(){var e;return(e=y.analytics).track.apply(e,arguments)},_={BimWalk:"Autodesk.BimWalk",Bookmarks:"Autodesk.AEC.CanvasBookmarkExtension",Levels:"Autodesk.AEC.LevelsExtension",CrossFade:"Autodesk.CrossFadeEffects",Hyperlinks:"Autodesk.AEC.HyperlinkExtension",Minimap:"Autodesk.AEC.Minimap3DExtension",DropMe:"Autodesk.AEC.DropMeExtension",ZoomWindow:"Autodesk.Viewing.ZoomWindow",FusionOrbit:"Autodesk.Viewing.FusionOrbit",DiffTool:"Autodesk.DiffTool",ModelStructure:"Autodesk.ModelStructure",ModelAlignment:"Autodesk.ModelAlignment",SheetAlignment:"Autodesk.SheetAlignment",ModelSheetTransition:"Autodesk.ModelSheetTransition"},x={ALIGNMENT_SERVICE_FAILED:"alignmentServiceFailure",ENVIRONMENT_CHANGED:"environmentChanged"},E={LocalStorage:function(){return new Autodesk.ModelAlignmentService.AlignmentServiceLS}},w=[_.ModelAlignment,_.SheetAlignment],S=function(e){return e instanceof v.BubbleNode?e.getModelKey():e instanceof v.Model?null===(t=e.getDocumentNode())||void 0===t?void 0:t.getModelKey():"string"==typeof e?e:void console.error("makeKey: Input must be key, model, or BubbleNode");var t},A=function(e){return{model:null,node:e,visible:!1,url:null,loadingPromise:null,error:!1}},M=function(e){return isFinite(e.x)&&isFinite(e.y)&&isFinite(e.z)},T=function(e){var t=e.getUpVector();return t&&(new THREE.Vector3).fromArray(t)},C=function(e){return M(e.position)&&M(e.target)&&M(e.up)&&isFinite(e.orthoScale)},P=function(e,t,n){for(var i=0,r=new THREE.Vector3,o=0;o<e.length;o++){var a=e[o].getBoundingBox();if(n.intersectsBox(a)!==Autodesk.Viewing.Private.FrustumIntersector.OUTSIDE){var s=a.getSize(r).length;a.distanceToPoint(t)>50*s||i++}}return i},L={enabled:!1,diffBubbles:void 0,primaryBubbles:void 0,diffBubbleLabel:void 0,primaryBubbleLabel:void 0,progressCallback:void 0,supportBubbles:void 0,refNames:void 0,customCompute:void 0},R=function(e,t){var n=e.getVisibleModels();n=n.filter((function(e){return t=e.getBoundingBox(),M(t.min)&&M(t.max);var t}));for(var i=e.impl.camera.clone(),r=new Autodesk.Viewing.Private.FrustumIntersector,o=void 0,a=void 0,s=void 0,l=void 0,c=new THREE.Vector3,u=0;u<n.length;u++){var h=n[u];o||(o=T(h));var d=h.getDefaultCamera();if(d&&C(d)){var p=h.getBoundingBox();i.position.copy(d.position),i.target.copy(d.target),i.up.copy(d.up),i.isPerspective=d.isPerspective,i.near=p.distanceToPoint(i.position),i.far=i.near+p.getSize(c).length,i.updateMatrixWorld(),i.updateProjectionMatrix(),r.reset(i);var f=P(n,d.position,r);(!a||f>=s)&&(a=d,s=f,l=h)}}a&&(a.pivot=a.target,a.worldup=o,a.fov=45,t&&t(a,l),e.autocam.setHomeViewFrom(a))},D=function(){function e(t){f(this,e),this.color=t,this.enabled=!0,this.active=!1}return g(e,[{key:"setEnabled",value:function(e,t){t!==this.enabled&&(this.enabled=t,this.active&&!t?(e.clearThemingColors(),this.active=!1):this.update(e))}},{key:"update",value:function(e){if(!this.active&&this.enabled){for(var t=e.myData.fragments.fragId2dbId,n=0;n<t.length;n++){var i=t[n];e.setThemingColor(i,this.color)}this.active=!0}}}]),e}(),I=function(){function e(){f(this,e),this.globalOffset=void 0,this.refPoint=void 0,this.modelItems={},this.resetOnNextModelAdd=!0,this.resetTriggeringBubble=null,this.memTracker=null,this.cameraInitialized=!1,this.is3D=void 0,this.pendingCamera=null,this.extensionLoaded={},this.loadersInProgress={},this.diff=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},L),this.modelIsGhosted={},this.diffCache=[],this.onDiffDone=void 0,this.waitForFirstModel=!1,this.loadPendingPromises={},this.onLoad=[],this.onUnload=[],this.modelThemingStates={},window.LMV_MAIN_VIEW=this,this.pendingAlignmentFetches=[],Autodesk.Viewing.EventDispatcher.prototype.apply(this)}var t,n,c,u,m,E,M,C;return g(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.useConsolidation=void 0===t.useConsolidation||t.useConsolidation,this.initViewerInstance(e,t),this.memTracker=new v.ModelMemoryTracker(this.viewer,t.memoryLimit),this.viewer.impl.showTransparencyWhenMoving(),t.useDynamicGlobalOffset&&(this.dynamicGlobalOffset=new o.DynamicGlobalOffset(this.viewer)),this.options=t,this._registerLmvEventListeners(),this._loadExtensions()}},{key:"initViewerInstance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.viewerClass||(t.headlessViewer?v.Viewer3D:v.GuiViewer3D),i=t.viewerConfig||{};i.disabledExtensions=i.disabledExtensions||{},i.disabledExtensions.hyperlink=!0,t.multiViewerFactory?this.viewer=t.multiViewerFactory.createViewer(e,t.viewerConfig,n):this.viewer=new n(e,t.viewerConfig),this.viewer.start(void 0,void 0,void 0,void 0,t.viewerStartOptions),t.propagateInputEventTypes&&(this.viewer.toolController.propagateInputEventTypes=t.propagateInputEventTypes,this.viewer.canvas.style.outline="none")}},{key:"destroy",value:function(){var e;this.dynamicGlobalOffset=null,this.memTracker=null,this.modelItems=null,null===(e=this.viewer)||void 0===e||e.finish(),this.viewer=null,window.LMV_MAIN_VIEW=null}},{key:"_onError",value:function(){var e;(e=console).error.apply(e,arguments)}},{key:"reset",value:function(){this.hideAll(),this.pendingCamera=null,this.cameraInitialized=!1,this.resetOnNextModelAdd=!0,this._stopActiveTools(),this._unloadDiffTool(!0),this.refPoint=void 0,this.loadersInProgress={}}},{key:"getModel",value:function(e){var t=this._getItem(e);return t&&t.model}},{key:"getModelAndWait",value:function(e){var t=this;return new Promise((function(n){var i=function i(){var r=t.getModel(e);if(r)return t.viewer.removeEventListener(Autodesk.Viewing.MODEL_ADDED_EVENT,i),t.onLoad.splice(t.onLoad.indexOf(i),1),n(r)},r=t.getModel(e);if(r)return n(r);t.viewer.addEventListener(Autodesk.Viewing.MODEL_ADDED_EVENT,i),t.onLoad.push(i)}))}},{key:"isEmpty",value:function(){return!this.getVisibleNodes().length}},{key:"_initForEnvironmentChange",value:function(e,t){if(this.areAllNodes2D()&&e.is3D()){var n;if(this.is3D=t,!t){e=(n=Object.values(this.modelItems).filter((function(e){return e.visible&&e.node&&e.node.is2D()}))[0]).node}this._updateExtensions(e),this._updateRefPoint(e),t?(this.resetOnNextModelAdd=!0,this.resetTriggeringBubble=e):n.model&&(this._resetOnModeSwitch(n.model),this.viewer.impl.setUp2DMode(n.model,!1),this.viewer.getExtension("Autodesk.ViewCubeUi",(function(e){return e.displayViewCube(!1,!1)}))),this.fireEvent({type:x.ENVIRONMENT_CHANGED,is3D:this.is3D})}}},{key:"_needsReset",value:function(e){return!!this.resetOnNextModelAdd&&(!this.resetTriggeringBubble||this.resetTriggeringBubble===e)}},{key:"show",value:function(e,t){this.isEmpty()?this._initForFirstViewable(e):this._initForEnvironmentChange(e,!0);var n,i,r=e.getModelKey(),o=this.getModel(r);o?(this.modelItems[r].visible=!0,this._showModel(o),n=Promise.resolve(o)):((n=null===(i=this.modelItems[r])||void 0===i?void 0:i.loadingPromise)||(n=this.load(e,t)),this.modelItems[r].visible=!0);return this._updateModelTimestamps(),this._consolidateVisibleModels(),n}},{key:"hide",value:function(e){var t=this._getItem(e);t&&(!this.options.unloadUnfinishedModels||t.model&&t.model.isLoadDone()?t.model&&this.viewer.hideModel(t.model.id):this.unload(t.node),t.visible=!1,R(this.viewer,this.options.cameraValidator),this._updateUpVector(),this._cleanupModels(),this._initForEnvironmentChange(t.node,!1))}},{key:"isVisible",value:function(e){var t=this._getItem(e);return t&&t.visible}},{key:"hideAll",value:function(){for(var e in this.modelItems)this.hide(e)}},{key:"getVisibleNodes",value:function(){var e=[];for(var t in this.modelItems){var n=this.modelItems[t];n.visible&&e.push(n.node)}return e}},{key:"areAllNodes2D",value:function(){var e=this.getVisibleNodes();return!!e.length&&e.every((function(e){return!(e instanceof Autodesk.Viewing.BubbleNode)||e.is2D()}))}},{key:"isOtgManifestMissing",value:function(e){if(e.is2D())return!1;var t=e.getOtgGraphicsNode();if(t&&!t.error)return!1;if(t?this._onError("Otg translation failed for viewable '".concat(e.name(),"'. Error:"),t.error):this._onError("Otg node missing for viewable '".concat(e.name(),"'.")),this.onViewerNotification){var n=v.i18n.t("Model translation failed for view '%(viewableName)'",{viewableName:e.name()});this.onViewerNotification("error",n)}return!0}},{key:"load",value:function(e){var t,n,i=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=S(e),a=this.modelItems[o];if(a||(a=A(e),this.modelItems[o]=a),a.model)return Promise.resolve(a.model);if(this.options.disableSvf&&this.isOtgManifestMissing(e))return a.error=!0,Promise.reject("OTG manifest missing");if(a.loadingPromise||a.error)return Promise.reject("Model load was already triggered");if(e.is3D()){if(this.waitForFirstModel)return new Promise((function(e,t){i.loadPendingPromises[o]={resolve:e,reject:t}}));this.options.ignoreGlobalOffset||this.globalOffset||(this.waitForFirstModel=!0)}var s=e.getRootNode(),l=s.getDocument(),c={globalOffset:this.globalOffset,applyRefPoint:!0,applyScaling:this.options.viewerUnits,isAEC:!0,bvhOptions:y.Consolidation.getDefaultBVHOptions(),useConsolidation:!1,loadAsHidden:!0,bubbleNode:e,disablePrecomputedNodeBoxes:!0,preserveView:!0,onFragmentListLoadProgress:function(){return i._updateDiffLoadProgress()},disable3DModelLayers:!0,keepCurrentModels:!0,headlessViewer:this.options.headlessViewer,leafletOptions:{fitPaperSize:!0}},u=this._onModelLoaded.bind(this),h=function(t){return i._onModelLoadFailed(e,t)},d=null===(t=(n=this.options).getCustomLoadOptions)||void 0===t?void 0:t.call(n,e);return d&&Object.assign(c,d),r&&Object.assign(c,r),a.loadingPromise=new Promise((function(t,n){i._applyAlignmentService(e,c).then((function(){return i.viewer.loadDocumentNode(l,e,c)})).then((function(e){u(e),t(e)})).catch((function(e){h(e),n(e)}))})),a.loadingPromise}},{key:"unloadUnderlayRaster",value:function(e){var t=this.viewer.getUnderlayRaster(e);t&&this.viewer.unloadModel(t)}},{key:"unload",value:function(e){this.unloadUnderlayRaster(e),this.viewer.unloadDocumentNode(e);var t=this._getItem(e);t&&(t.loading&&this._onModelLoadEnded(t),t.model&&delete this.loadersInProgress[t.model.id]);var n=S(e);delete this.modelItems[n];var i=this.modelThemingStates[n];i&&(i.active=!1),this.onUnload.forEach((function(t){return t(e)}))}},{key:"unloadAll",value:function(e){for(var t=Object.keys(this.modelItems).slice(),n=0;n<t.length;n++){var i=t[n],r=this.modelItems[i];e&&!e(r)||this.unload(r.node)}}},{key:"setCameraGlobal",value:function(e){this.pendingCamera={position:e.position&&(new THREE.Vector3).copy(e.position),target:e.target&&(new THREE.Vector3).copy(e.target),up:e.up&&(new THREE.Vector3).copy(e.up),fov:e.fov,isPerspective:e.isPerspective,ignoreGlobalOffset:e.ignoreGlobalOffset},this._applyPendingCameraWhenReady()}},{key:"setCamera",value:function(e){this.viewer.impl.setViewFromCamera(e,!0),this.cameraInitialized=!0}},{key:"startBimWalk",value:function(){this.bimWalkStartPending=!0,this._startBimWalkWhenReady()}},{key:"stopBimWalk",value:function(){var e=this.viewer.getExtension(_.BimWalk);e&&e.isActive()&&e.deactivate(),this.bimWalkStartPending=!1}},{key:"isBimWalkActive",value:function(){var e=this.viewer.getExtension("Autodesk.BimWalk");return e&&e.activeStatus||this.bimWalkStartPending}},{key:"switchView",value:function(e,t){return this.reset(),this.setNodes(e,t)}},{key:"setNodes",value:function(e,t){var n=this;e=(e=e||[])instanceof v.BubbleNode?[e]:e,this.fetchAlignmentsForNodes(e);var i=e.filter((function(e){return!n.isVisible(e)})),r={};e.forEach((function(e){r[e.getModelKey()]=!0}));this.getVisibleNodes().filter((function(e){return void 0===r[e.getModelKey()]})).forEach((function(e){n.hide(e)}));var o=i.map((function(e){return n.show(e)}));return this._setDiff(t),Promise.all(o)}},{key:"getFloorSelector",value:function(){return this.levelsExtension&&this.levelsExtension.floorSelector}},{key:"setBookmarks",value:function(e){this.bookmarks=e,this._updateBookmarks()}},{key:"isLoadDone",value:function(){for(var e in this.modelItems){var t=this.modelItems[e],n=t&&t.model,i=!n&&!t.error,r=n&&!n.isLoadDone(),o=n&&n.getPropertyDb()&&!n.getPropertyDb().isLoadDone(),a=y.TextureLoader.requestsInProgress()>0;if(i||r||o||a)return!1}return!0}},{key:"waitForLoadDone",value:function(){var e=this;return new Promise((function(t){e.isLoadDone()&&t();var n=function n(){e.isLoadDone()&&(e.viewer.removeEventListener(v.GEOMETRY_LOADED_EVENT,n),e.viewer.removeEventListener(v.OBJECT_TREE_CREATED_EVENT,n),e.viewer.removeEventListener(v.TEXTURES_LOADED_EVENT,n),e.onUnload.splice(e.onUnload.indexOf(n),1),t())};e.viewer.addEventListener(v.GEOMETRY_LOADED_EVENT,n),e.viewer.addEventListener(v.OBJECT_TREE_CREATED_EVENT,n),e.viewer.addEventListener(v.TEXTURES_LOADED_EVENT,n),e.onUnload.push(n)}))}},{key:"setAlignmentService",value:function(e){var t=this;this.alignmentService=e,w.forEach((function(e){return t._connectModelAlignment(e)}))}},{key:"fetchAlignments",value:(C=h(regeneratorRuntime.mark((function e(t){var n,i,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isUsingAlignmentService()){e.next=2;break}return e.abrupt("return");case 2:return n=function(){var e=h(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getAlignmentService();case 2:return n=e.sent,e.next=5,n.fetchItems(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i=n(),this.pendingAlignmentFetches.push(i),e.next=7,i;case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return C.apply(this,arguments)})},{key:"fetchAlignmentsForNodes",value:function(e){var t=null==e?void 0:e.filter((function(e){return e.is3D()})),n=null==t?void 0:t.map((function(e){return e.getRootNode().urn()}));this.fetchAlignments(n)}},{key:"updateHomeCamera",value:function(){R(this.viewer,this.options.cameraValidator)}},{key:"_setDiff",value:function(t){if(t){Object.assign(this.diff,t,{enabled:!0});var n=t.supportBubbles;if(n)if(n.autoDetect&&e.findDiffSupportModels(t),n.diff&&n.primary)this.load(n.primary),this.load(n.diff);else{var i=t.diffBubbles&&t.diffBubbles[0];i&&i.is2D()&&console.warn("Could not find support models for 2D diff."),this.diff.supportBubbles=null}!t.empty&&t.progressCallback&&this._signalDiffLoadProgress(0,!0),this.diffStartTime=performance.now()}else Object.assign(this.diff,L);this.diffNeedsUpdate=!0,this._updateDiff()}},{key:"_updateUpVector",value:function(){var e;if(this.areAllNodes2D())e=new THREE.Vector3(0,1,0);else{var t=Object.values(this.modelItems).filter((function(e){return e.visible&&e.node&&e.node.is3D()}))[0];e=t&&t.model?T(t.model):new THREE.Vector3(0,0,1)}this.viewer.navigation.setWorldUpVector(e,!1,!0)}},{key:"_showModel",value:function(e){if(!e.is3d()||e.hasGeometry()){this.viewer.showModel(e.id,!0),R(this.viewer,this.options.cameraValidator),this._updateUpVector()}else{var t=e.getDocumentNode().getRootNode().children[0].name();console.warn("Ignored model with empty geometry: ",t)}}},{key:"_resetOnModeSwitch",value:function(e){var t=this;this.viewer.getExtension(_.ZoomWindow)&&this.viewer.unloadExtension(_.ZoomWindow),this.options.headlessViewer||this.viewer.createUI(e,!0);var n=this.viewer.setNavigationLock(!1);this.viewer.activateDefaultNavigationTools(!this.is3D),this.viewer.setNavigationLock(n),this.viewer.navigation.setIs2D(!this.is3D),this._loadExtension(_.ZoomWindow).catch((function(e){return t._onError(e)})),this._startBimWalkWhenReady()}},{key:"_onModelAdded",value:function(e){var t=e.model;if(this.cameraInitialized||this._initCamera(t),!t.getData().underlayRaster){t.is3d()&&this.options.useDynamicGlobalOffset&&(t.setGlobalOffset(this.viewer.impl.camera.globalOffset),this.viewer.impl.onModelTransformChanged(t));var n=e.model.getDocumentNode();if(this._needsReset(n)&&(this.resetTriggeringBubble=null,this.resetOnNextModelAdd=!1,this._resetOnModeSwitch(t)),function(e){var t=e.getData(),n=t.loadOptions.bubbleNode;if(e.is3d()&&t.metadata.stats&&!t.metadata.stats.num_fragments){var i=n.name(),r=n.getRootNode().children[0].name();console.warn('Empty View "'.concat(i,'" in model "').concat(r,'".'))}}(t),n){var i=n.getModelKey();delete this.modelIsGhosted[i],this._updateGhosting()}}}},{key:"_onGeometryLoaded",value:function(e){this._consolidateVisibleModels(),this._updateDiff(),this.loadersInProgress[e.model.id]=100}},{key:"_onExtensionLoaded",value:function(e){var t=e.extensionId;this._startBimWalkWhenReady(),t===_.Levels&&(this.levelsExtension=this.viewer.getExtension(_.Levels)),t===_.Bookmarks&&this._updateBookmarks(),w.includes(t)&&this.alignmentService&&this._connectModelAlignment(t)}},{key:"_registerLmvEventListeners",value:function(){this.viewer.addEventListener(v.GEOMETRY_LOADED_EVENT,this._onGeometryLoaded.bind(this)),this.viewer.addEventListener(v.MODEL_ADDED_EVENT,this._onModelAdded.bind(this)),this.viewer.addEventListener(v.EXTENSION_LOADED_EVENT,this._onExtensionLoaded.bind(this)),this.viewer.addEventListener(v.PROGRESS_UPDATE_EVENT,this._onProgressUpdate.bind(this)),this.viewer.addEventListener(v.MODEL_ROOT_LOADED_EVENT,this._updateDiff.bind(this))}},{key:"_consolidateVisibleModels",value:function(){if(this._cleanupModels(),!(0,r.isMobileDevice)()){var e=(0,i.getParameterByName)("useConsolidation");if("false"!==e&&(!1!==this.options.useConsolidation||"true"===e))for(var t=this.viewer.getVisibleModels(),n=0;n<t.length;n++){var o=t[n];if(this.memTracker.memoryExceeded())return;if(!(o&&o.isLoadDone()))return;if(o.is2d())return;o.isConsolidated()||(this.viewer.impl.consolidateModel(o),this._cleanupModels())}}}},{key:"_cleanupModels",value:function(){var e=this;this._updateModelTimestamps();this.memTracker.cleanup((function(t){var n=t.getDocumentNode(),i=e._getItem(n);i&&i.visible||e.unload(n)}))}},{key:"_updateModelTimestamps",value:function(){var e=this.viewer.getVisibleModels().slice(),t=this._getDiffSupportModels();this.diff.enabled&&t&&(t.diff&&e.push(t.diff),t.primary&&e.push(t.primary)),this.memTracker.updateModelTimestamps(e)}},{key:"_stopActiveTools",value:function(){var e=this.viewer.getExtension("Autodesk.Section");e&&e.isActive()&&e.enableSectionTool(!1),this.stopBimWalk();var t=!this.options.headlessViewer&&this.viewer.getPropertyPanel(!1);t&&t.isVisible()&&t.setVisible(!1)}},{key:"_onModelLoaded",value:function(e){var t=this._getItem(e);t&&(e.is3d()&&(this.options.useDynamicGlobalOffset?e.setGlobalOffset(this.viewer.impl.camera.globalOffset):this.waitForFirstModel&&!this.options.ignoreGlobalOffset&&(this.globalOffset=(new THREE.Vector3).copy(e.myData.globalOffset),this._onGlobalOffsetChanged())),t.model=e,t.visible&&this._showModel(t.model),this._updateModelTimestamps(),this._updateDiffLoadProgress(),this._updateModelTheming(e),this._onModelLoadEnded(t))}},{key:"_onModelLoadFailed",value:function(e,t){this._onError("Failed to load model: ".concat(e.name(),". Error code: ").concat(t));var n=this._getItem(e);n&&(n.error=!0,this._onModelLoadEnded(n))}},{key:"_onModelLoadEnded",value:function(e){var t=this;e.loadingPromise=null;var n=e.node;n.is3D()&&this.waitForFirstModel&&(this.waitForFirstModel=!1,Object.keys(this.loadPendingPromises).forEach((function(e){var n,i=null===(n=t.modelItems[e])||void 0===n?void 0:n.node;if(i){var r=t.loadPendingPromises[e],o=r.resolve,a=r.reject;t.load(i).then((function(e){o(e)})).catch((function(e){a(e)}))}})),this.loadPendingPromises={}),this.onLoad.forEach((function(e){return e(n)}))}},{key:"_initCamera",value:function(e,t){this.viewer.impl.setViewFromFile(e,!t),this.options.cameraValidator&&this.options.cameraValidator(this.viewer.impl.camera,e),this.viewer.impl.controls.recordHomeView(),this.cameraInitialized=!0,this.pendingCamera&&this._applyPendingCameraWhenReady()}},{key:"_getItem",value:function(e){var t=S(e);return this.modelItems[t]}},{key:"_updateRefPoint",value:function(e){if(!this.options.useDynamicGlobalOffset&&((this.isEmpty()||this.areAllNodes2D())&&e.is3D()&&!this.options.ignoreGlobalOffset)){var t=e.getAecModelData();if(t){var n=t&&t.refPointTransformation,i=n?{x:n[9],y:n[10],z:0}:{x:0,y:0,z:0};if(this.isUsingAlignmentService()){var r,o=e.getRootNode().urn(),a=null===(r=this.alignmentService)||void 0===r?void 0:r.getTransform(o);if(void 0===a)return;a&&(i.x=a.elements[12],i.y=a.elements[13])}if(this.refPoint=i,this.options.viewerUnits){var s=Autodesk.Viewing.Private.convertUnits("ft",this.options.viewerUnits,1,1);this.refPoint.x*=s,this.refPoint.y*=s,this.refPoint.z*=s}var l=this.globalOffset&&THREE.Vector3.prototype.distanceToSquared.call(this.refPoint,this.globalOffset);(!this.globalOffset||l>4e6)&&(this.globalOffset=(new THREE.Vector3).copy(this.refPoint),this.unloadAll((function(e){return e.model&&e.model.is3d()})),this._onGlobalOffsetChanged())}}}},{key:"_onGlobalOffsetChanged",value:function(){var e=this.viewer.getExtension(_.Bookmarks);e&&e.resetGlobalOffset(this.globalOffset)}},{key:"_getDefaultExtensions",value:function(){var e=this;return[{name:_.CrossFade,getLoadingCondition:function(){return!v.isMobileDevice()}},{name:_.Levels,getOptions:function(){return e.viewer.config}},{name:_.ModelStructure,getOptions:function(){return e.viewer.config}},{name:_.Hyperlinks,getOptions:function(){return{loadViewableCb:function(t,n){e.onHyperlink?e.onHyperlink(t,n):e.switchView([t])}}}},{name:_.Minimap,getLoadingCondition:function(){return!e.options.disableMinimap},getOptions:function(){return{trackUsage:e._trackMinimapUsage?e._trackMinimapUsage.bind(e):void 0}}},{name:_.Bookmarks,getLoadingCondition:function(){return e.is3D},getOptions:function(){return{globalOffset:e.globalOffset,onBookmark:function(t,n){e.onBookmark?e.onBookmark(t,n):e.switchView([t]),n.isPerspective&&e.startBimWalk()},clusterfck:e.options.clusterfck,clusteringThreshold:110}}},{name:_.DropMe,getLoadingCondition:function(){return!1===e.is3D},getOptions:function(){return{enableGuidance:!0,onDrop:e._handleDropMe.bind(e),getTransformForNode:e._getTransformForNode.bind(e),getMain3DView:e._findMain3DView.bind(e),onHandleViewIn3D:e._handleViewIn3D.bind(e)}}}]}},{key:"_loadExtensions",value:(M=h(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.extensions=this.options.extensions||this._getDefaultExtensions(),t=[],this.extensions.forEach((function(e){e.getLoadingCondition&&!e.getLoadingCondition(n)||(t.push(n._loadExtension(e.name,e.getOptions&&e.getOptions(n),e.onLoadedCB)),n.extensionLoaded[e.name]=!0)})),e.abrupt("return",Promise.all(t));case 4:case"end":return e.stop()}}),e,this)}))),function(){return M.apply(this,arguments)})},{key:"_loadExtension",value:(E=h(regeneratorRuntime.mark((function e(t,n,i){var r,o,a,s,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.options.extensionOptions,o=r&&r[t],a=Object.assign({},n,o),s=this.viewer.loadExtension(t,a),i&&s.then((function(e){i(l,e)})).catch((function(e){i(l,null,e)})),e.abrupt("return",s);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return E.apply(this,arguments)})},{key:"_updateExtensions",value:function(e){var t=this;this.extensions.forEach((function(n){var i,r,o,a,s,l;n.getLoadingCondition&&(i=n.name,r=n.getOptions&&n.getOptions(t),o=n.getLoadingCondition(t,e),a=n.onLoadedCB,s=n.onBeforeUnloadCB,!(l=t.extensionLoaded[i])&&o?t._loadExtension(i,r,a).catch((function(e){return t._onError(e)})):l&&!o&&(s&&s(t),t.viewer.unloadExtension(i)),t.extensionLoaded[i]=o)}))}},{key:"_initForFirstViewable",value:function(e){this.is3D!==e.is3D()&&(this.resetOnNextModelAdd||(this.reset(),this.resetTriggeringBubble=e),this.is3D=e.is3D()),this._updateExtensions(e),this._updateRefPoint(e)}},{key:"_updateBookmarks",value:function(){var e=this.viewer.getExtension(_.Bookmarks);e&&e.resetBookmarks(this.bookmarks)}},{key:"_applyPendingCameraWhenReady",value:function(){if(this.cameraInitialized){var e=this.pendingCamera;this.pendingCamera=null;var t=this.viewer.impl.camera;e.position&&t.position.copy(e.position),e.target&&t.target.copy(e.target),e.up&&t.up.copy(e.up),e.fov&&(t.fov=e.fov),void 0!==e.isPerspective&&(t.isPerspective=e.isPerspective);var n=this.globalOffset||this.viewer.model.getData().globalOffset;!this.is3D||this.options.ignoreGlobalOffset||e.ignoreGlobalOffset||(t.position.sub(n),t.target.sub(n)),this.viewer.impl.syncCamera()}}},{key:"_findMain3DView",value:function(e){var t=e.getMasterViews();if(t[0])return t[0];var n=null==e?void 0:e.getRootNode();if(n){var i=null==n?void 0:n.search(v.BubbleNode.MODEL_NODE),r=i.filter((function(e){return e.name().toLowerCase().startsWith("{3d")}))[0];return r||i[0]}}},{key:"_handleDropMe",value:function(e,t,n,i,r){if(this.onDrop)this.onDrop(e,t,n,i);else if(i){if(this.switchView(i),e&&t){var o={position:e,target:e.clone().add(t),isPerspective:!0,ignoreGlobalOffset:r};this.setCameraGlobal(o)}}else console.warn("DropMe handler: Document does not contain a 3D view to switch to")}},{key:"_handleViewIn3D",value:(m=h(regeneratorRuntime.mark((function e(t,n,i,r){var o,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i&&!this.options.ignoreGlobalOffset&&(o=this.globalOffset||this.viewer.model.getData().globalOffset,t=t.clone().add(o),n=n.clone().add(o)),a={position:t,target:n,isPerspective:!0},this.setCameraGlobal(a),e.next=5,this.viewer.getExtensionAsync(_.BimWalk);case 5:(s=e.sent).activate(),s.disableGravityUntilNextMove(),r&&r();case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i){return m.apply(this,arguments)})},{key:"_startBimWalkWhenReady",value:function(){if(this.bimWalkStartPending){var e=!this.resetOnNextModelAdd,t=this.viewer.getExtension(_.BimWalk),n=this.viewer.getExtension(_.FusionOrbit);e&&t&&n&&(t.activate(),this.bimWalkStartPending=!1)}}},{key:"_unloadDiffTool",value:function(e){this.viewer.getExtension(_.DiffTool)&&(e&&(this.diffCache.length=0),this.viewer.unloadExtension(_.DiffTool))}},{key:"_onProgressUpdate",value:function(e){e.model&&e.state===v.ProgressState.LOADING&&(this.loadersInProgress[e.model.id]=e.percent,this._updateDiffLoadProgress())}},{key:"_getDiffSupportModels",value:function(){if(this.diff.supportBubbles)return{diff:this.getModel(this.diff.supportBubbles.diff),primary:this.getModel(this.diff.supportBubbles.primary)}}},{key:"_diffSupportModelsReady",value:function(){var e=this._getDiffSupportModels(),t=e.diff&&e.diff.isLoadDone(),n=e.primary&&e.primary.isLoadDone();return t&&n}},{key:"_updateGhosting",value:function(){var e={};for(var t in this.diff.enabled&&this.diffBubbles&&(e=this.diffBubbles.forEach((function(t){return e[t.getModelKey()]}))),this.modelItems){var n=this.getModel(t);if(n){var i=this.diff.enabled&&!e[t];i!=!!this.modelIsGhosted[t]&&(n.setAllVisibility(!i),i?this.modelIsGhosted[t]=!0:delete this.modelIsGhosted[t])}}}},{key:"getModels",value:function(e){var t=this;return e.map((function(e){return t.getModel(e)}))}},{key:"setModelTheming",value:function(e){e=e||{};var t=this.modelThemingStates;for(var n in this.modelThemingStates={},e){var i=t[n],r=e[n],o=this.getModel(n);if(i)!i.color.equals(r)&&(i.color.copy(r),i.active=!1);else i=new D(r);this.modelThemingStates[n]=i,o&&this._updateModelTheming(o)}for(var a in t){var s=t[a],l=!e[a],c=this.getModel(a);l&&s.active&&c&&this.viewer.clearThemingColors(c)}}},{key:"_signalDiffLoadProgress",value:function(e,t){if(t||e!==this._lastDiffLoadPercent){var n=v.i18n.t("Loading Model for Change Visualization");this.diff.progressCallback(e,n),this._lastDiffLoadPercent=e}}},{key:"_updateDiffLoadProgress",value:function(){var e=this;if(this.diffNeedsUpdate&&this.diff.enabled&&!this.diff.empty&&this.diff.progressCallback){var t=this.getModels(this.diff.diffBubbles),n=this.getModels(this.diff.primaryBubbles),i=t.concat(n),r=this._getDiffSupportModels();r&&i.push(r.diff,r.primary);var o=i.filter(Boolean).length;if(o<i.length){var a=Math.floor(10*o/i.length);this._signalDiffLoadProgress(a)}else if(this.is3D){var s=i.reduce((function(e,t){return e+t.getData().fragsLoadedNoGeom}),0),l=i.reduce((function(e,t){return e+t.getData().metadata.stats.num_fragments}),0),c=10+Math.floor(90*s/l);this._signalDiffLoadProgress(c)}else{var u=i.reduce((function(t,n){return t+(0|e.loadersInProgress[n.id])}),0),h=100*i.length,d=10+Math.floor(90*u/h);this._signalDiffLoadProgress(d)}}}},{key:"_updateDiff",value:function(){if(this.diffNeedsUpdate){if(this._updateGhosting(),this._updateDiffLoadProgress(),!this.diff.enabled)return this._unloadDiffTool(),void this._updateAllModelTheming();var e=this.getModels(this.diff.diffBubbles),t=this.getModels(this.diff.primaryBubbles);if(this.diff.customCompute){var n,i=t,r=e,o=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=l(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}([this.diff.customCompute].flat());try{for(o.s();!(n=o.n()).done;){var a=s(n.value.init(i,r),2);i=a[0],r=a[1]}}catch(e){o.e(e)}finally{o.f()}}for(var c=0;c<e.length;c++){var u=e[c],h=t[c],d=u instanceof v.Model&&(u.isOTG()||u.isLoadDone()),p=h instanceof v.Model&&(h.isOTG()||h.isLoadDone());if(!d||!p)return;if(!u.getPropertyDb()||!h.getPropertyDb())return}var f=void 0;if(!!this.diff.supportBubbles){if(!this._diffSupportModelsReady())return;f=this._getDiffSupportModels()}var m=performance.now()-this.diffStartTime;console.log("Time for loading diff models: ",m),this._updateAllModelTheming(),this._setDiffModels(e,t,f)}}},{key:"_setDiffModels",value:function(e,t,n){var i=this;if(this.diffNeedsUpdate=!1,t.length){var r=this.viewer.getExtension(_.DiffTool);if(r)r.replaceModels(e,t,n);else{var o={diffModels:e,primaryModels:t,supportModels:n,diffadp:!1,availableDiffModes:["overlay","sidebyside"],diffMode:"overlay",customCompute:this.diff.customCompute,versionA:this.diff.primaryBubbleLabel,versionB:this.diff.diffBubbleLabel,refNames:this.diff.refNames,mimeType:"application/vnd.autodesk.revit",hotReload:!0,diffCache:this.diffCache,useSplitScreenExtension:!0,showDetailsSection:!0,progress:function(e,t){i.diff.progressCallback&&(t!==Autodesk.DiffTool.DIFFTOOL_PROGRESS_STATES.LoadingPropDb?(100===e&&i.onDiffDone&&i.onDiffDone(),i.diff.progressCallback(e,v.i18n.t("Computing change visualization"))):i.diff.progressCallback(e,v.i18n.t("Loading element properties")))},excludeFromDiff:function(e,t){return i.levelsExtension&&!i.levelsExtension.floorSelector.isVisible(e,t)},setNodesOff:function(e){var t=i.levelsExtension;t&&t.floorSelector._floorSelectorFilter.reApplyFilter(e)},hideModeSwitchButton:!0,externalUi:this.diff.externalUi,attachDetachViewerEventHandlers:this.diff.attachDetachViewerEventHandlers,onDiffModeChanged:this.diff.onDiffModeChanged};this._loadExtension(_.DiffTool,o).catch((function(e){return i._onError(e)}))}}else this._unloadDiffTool()}},{key:"_updateModelTheming",value:function(e){var t=S(e),n=this.modelThemingStates[t];if(n){var i=!this.viewer.getExtension(_.DiffTool);n.setEnabled(e,i),n.update(e),this.viewer.impl.invalidate(!0)}}},{key:"_updateAllModelTheming",value:function(){for(var e in this.modelItems){var t=this.getModel(e);t&&this._updateModelTheming(t)}}},{key:"getAlignmentService",value:(u=h(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.alignmentService){e.next=2;break}return e.abrupt("return",this.alignmentService);case 2:if(!this._alignmentServicePromise){e.next=7;break}return e.next=5,this._alignmentServicePromise;case 5:e.next=11;break;case 7:return this._alignmentServicePromise=this._initAlignmentService(),e.next=10,this._alignmentServicePromise;case 10:this._alignmentServicePromise=null;case 11:return e.abrupt("return",this.alignmentService);case 12:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"isUsingAlignmentService",value:function(){return this.options.createModelAlignmentService||this.alignmentService}},{key:"_initAlignmentService",value:(c=h(regeneratorRuntime.mark((function e(){var t,n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.options.createModelAlignmentService){e.next=3;break}return e.abrupt("return");case 3:return n=function(){var e=h(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:n=e.sent,i.setAlignmentService(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.next=6,this.viewer.loadExtension("Autodesk.ModelAlignmentService").then(n);case 6:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"_getTransformForNode",value:(n=h(regeneratorRuntime.mark((function e(t){var n,i,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAlignmentService();case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,Promise.all(this.pendingAlignmentFetches);case 7:return i=t.getRootNode().urn(),r=t.is2D()?t.name():void 0,e.next=11,n.loadTransform(i,r);case 11:return o=e.sent,e.abrupt("return",o);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"_applyAlignmentService",value:(t=h(regeneratorRuntime.mark((function e(t,n){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.is2D()){e.next=2;break}return e.abrupt("return");case 2:if(!this.alignmentServiceFailed){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this._getTransformForNode(t);case 6:if(i=e.sent,this._checkAlignmentService()){e.next=9;break}return e.abrupt("return");case 9:b("viewer.modelalignment.alignment_loaded",{hasAlignmentTransform:Boolean(i)}),i&&(n.applyRefPoint=!1,n.placementTransform=i,n.applyPlacementInModelUnits=!0);case 11:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"_checkAlignmentService",value:function(){if(this.alignmentServiceFailed||!this.alignmentService)return!1;if(this.alignmentService.isWorking())return!0;var e=a.Z.t("Failed to connect to alignment service: Model alignment support is temporarily unavaible. Models with alignment transforms may not appear correctly and alignment editing is disabled.");this.fireEvent({type:x.ALIGNMENT_SERVICE_FAILED,message:e}),y.logger.error("AggregatedView: Disabled alignment due to alignment service connection error."),this.alignmentServiceFailed=!0}},{key:"_connectModelAlignment",value:function(e){var t=this.viewer.getExtension(e);t&&t.setAlignmentService(this.alignmentService)}}],[{key:"findDiffSupportModel",value:function(e){if(!e.is2D())return null;var t=e.data.phaseNames,n=Array.isArray(t)?t[0]:t;return n?e.getMasterView(n):(console.warn("A sheet node must have a phase name. Missing for sheet: ".concat(e.name)),null)}},{key:"findDiffSupportModels",value:function(t){t.supportBubbles.diff=e.findDiffSupportModel(t.diffBubbles[0]),t.supportBubbles.primary=e.findDiffSupportModel(t.primaryBubbles[0])}}]),e}();I.ExtNames=_,I.AlignmentServices=E,I.Events=x},20974:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CameraLS:()=>u});var i=n(35449);function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}var s=function(e){return isFinite(e.x)&&isFinite(e.y)&&isFinite(e.z)},l=function(e){var t=e.isPerspective||isFinite(e.orthoScale);return s(e.position)&&s(e.target)&&s(e.up)&&t},c=function(){function e(){r(this,e),this.cacheObj={}}return a(e,[{key:"setItem",value:function(e,t){this.cacheObj[e]=t}},{key:"getItem",value:function(e){return this.cacheObj[e]}}]),e}(),u=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{useLocalStorage:!0};r(this,e),this.aggregatedView=t,this.options=n,this.key=void 0,this.options.useLocalStorage?this.cache=Autodesk.Viewing.Private.LocalStorage:this.cache=new c,this.unloadCb=this.saveCamera.bind(this),this.addWindowEventListener("beforeunload",this.unloadCb)}return a(e,[{key:"destroy",value:function(){this.unsetKey(),this.removeWindowEventListener("beforeunload",this.unloadCb)}},{key:"setKey",value:function(e){this.key=e}},{key:"unsetKey",value:function(){this.key=void 0}},{key:"saveCamera",value:function(){if(this.aggregatedView.cameraInitialized&&this.key){var e=this.aggregatedView.viewer.impl.camera;if(l(e)){var t=this.aggregatedView.isBimWalkActive(),n=this.aggregatedView.is3D?this.aggregatedView.globalOffset:void 0;this.saveStartCamera(this.key,this.aggregatedView.viewer.impl.camera,t,n)}}}},{key:"saveStartCamera",value:function(e,t,n,i,r){var o=JSON.stringify({offset:i,position:t.position,target:t.target,up:t.up,orthoScale:t.orthoScale,isPerspective:t.isPerspective,fov:t.fov,startBimWalk:n,ignoreGlobalOffset:r});this.cache.setItem(e,o)}},{key:"clearItem",value:function(e){this.cache.setItem(e)}},{key:"loadCamera",value:function(){if(!this.key)return!1;var e=void 0;try{var t=this.cache.getItem(this.key);e=JSON.parse(t)}catch(e){}if(!(e&&e.position&&e.target&&e.up))return!1;var n=function(e){return new THREE.Vector3(parseFloat(e.x),parseFloat(e.y),parseFloat(e.z))},i={position:n(e.position),target:n(e.target),up:n(e.up),isPerspective:Boolean(e.isPerspective),fov:parseFloat(e.fov),ignoreGlobalOffset:Boolean(e.ignoreGlobalOffset)};if(e.orthoScale&&(i.orthoScale=parseFloat(e.orthoScale)),!l(i))return!1;var r=e.offset?n(e.offset):void 0;if(r){if(!s(r))return;i.position.add(r),i.target.add(r)}this.aggregatedView.setCameraGlobal(i),e.startBimWalk&&this.aggregatedView.startBimWalk()}}]),e}();i.GlobalManagerMixin.call(u.prototype)},38202:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Document:()=>p});var i=n(77368),r=n(79659),o=n(58964),a=n(57601),s=n(84998),l=n(98926),c=n(26261),u=n(17167),h=(0,s.getGlobal)(),d=h;function p(e,t,n){this.myPath=t,this.myData=e,e&&(this.docRoot=new i.BubbleNode(e),this.docRoot.setDocument(this)),this.myNumViews={},this.acmSessionId=n;var r=this;this.docRoot.traverse((function(e){if(e.isViewPreset()){var t=e.findParentGeom2Dor3D();if(t){var n=r.myNumViews[t.guid()]||0;r.myNumViews[t.guid()]=n+1}}})),0===this.docRoot.findAllViewables().length&&l.logger.error("Document contains no viewables.")}p.load=function(e,t,n,i){var s,l,d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},f=p.getDocumentPath(e);function m(t){var n=e.split(":");n=n[1];for(var i=(0,u.fromUrlSafeBase64)(n),r=0;r<t.length;r++)if(i.indexOf(t[r])>-1)return!0;return!1}var g=["urn:adsk.wipemea","urn:adsk.wipbimemea"];if(e.startsWith("urn")&&m(g)){var v=o.endpoint.getApiFlavor(),y=(0,o.getEnv)(),b=v===o.endpoint.ENDPOINT_API_DERIVATIVE_SERVICE_V2&&!y.endsWith("EU"),_=y.endsWith("US")&&v===o.endpoint.ENDPOINT_API_D3S,x=v===o.endpoint.ENDPOINT_API_DERIVATIVE_STREAMING&&!v.endsWith("_EU");if(v+="_EU",b)o.endpoint.setEndpointAndApi(null,v);else if(_){y=y.replace("US","EU"),(0,o.setEnv)(y);var E=c.EnvironmentConfigurations[y];o.endpoint.setEndpointAndApi(E.ROOT,v)}else x&&o.endpoint.setEndpointAndApi(null,v)}function w(e){(o.endpoint.isSVF2Backend()||o.endpoint.isOtgBackend())&&(s=s?e.urn+","+s:e.urn);var i=new p(e,f,s);if(i.getRoot().search({type:"geometry"}).length>0)l=i.getGlobalMessages(),t&&t(i,l);else if(n){l=i.getGlobalMessages();var a=r.ErrorCodes.BAD_DATA_NO_VIEWABLE_CONTENT;n(a,"No viewable content",l)}}function S(e,t,i){if(401===e&&void 0===h.LMV_THIRD_PARTY_COOKIE)h.LMV_THIRD_PARTY_COOKIE=!1,(0,c.refreshRequestHeader)(c.token.accessToken),A();else if(n){var o="Error: "+e+" ("+t+")",a=(0,r.getErrorCode)(e);n(a,o,e,t,i)}}function A(){var e=!i||(o.endpoint.isSVF2Backend()||o.endpoint.isOtgBackend())&&!i["x-ads-acm-scopes"];s||e?a.ViewingService.getManifest(o.endpoint.initLoadContext(d),f,w,S):(i.oauth2AccessToken||(i.oauth2AccessToken=c.token.accessToken),a.ViewingService.getACMSession(o.endpoint.getApiEndpoint(),i,(function(e){s=e,d.queryParams=s?"acmsession="+s:"",o.endpoint.setAcmSession(s),a.ViewingService.getManifest(o.endpoint.initLoadContext(d),f,w,S)}),n))}A()},p.getDocumentPath=function(e){if(-1===e.indexOf("urn:")){if(-1!==e.indexOf("://"))return e;var t=e;return"undefined"!=typeof window?(0!==t.indexOf("/")&&(t="/"+t),d.location.protocol+"//"+d.location.host+t):t}return e},p.requestThumbnailWithSecurity=function(e,t){var n={responseType:"blob",skipAssetCallback:!0,size:e.width,guid:e.guid,acmsession:e.acmsession},i="urn:"+e.urn,r=void 0;if(!(0,s.getGlobal)().USE_OTG_DS_PROXY){var l=(0,o.getEnv)();r=c.EnvironmentConfigurations[l].UPSTREAM;var u=(0,c.getUpstreamApiData)(l,o.endpoint.getApiFlavor());n.apiData=u}a.ViewingService.getThumbnail(o.endpoint.initLoadContext({endpoint:r}),i,(function(e){t(null,e)}),(function(){t("error",null)}),n)},p.prototype.getAcmSessionId=function(e){return p.getAcmSessionId(e,this.acmSessionId)},p.getAcmSessionId=function(e,t){if(!e)return"";var n=e.indexOf("urn:adsk.fluent")>=0;return(0,s.getGlobal)().USE_OTG_DS_PROXY||n||!o.endpoint.isSVF2Backend()&&!o.endpoint.isOtgBackend()?t:t.split(",")[1]||""},p.prototype.getFullPath=function(e){if(!e)return e;var t=e;if((0,o.isOffline)())-1==t.indexOf((0,o.getOfflineResourcePrefix)())&&(t=decodeURIComponent((0,o.getOfflineResourcePrefix)())+t.substr(t.indexOf("/")));else if(0===e.indexOf("urn")){if(0===e.indexOf("urn:adsk.fluent")||!o.endpoint.isSVF2Backend()&&!o.endpoint.isOtgBackend())t=o.endpoint.getItemApi(null,e),o.endpoint.ENDPOINT_API_MODEL_DERIVATIVE_V2===o.endpoint.getApiFlavor()&&(t=decodeURIComponent(t));else{var n=(0,o.getEnv)(),i=c.EnvironmentConfigurations[n],r=(0,s.getGlobal)().USE_OTG_DS_PROXY?null:i.UPSTREAM,a=(0,c.getUpstreamApiData)(n,o.endpoint.getApiFlavor());t=o.endpoint.getItemApi(r,e,a)}}else 0===e.indexOf("$file$")&&(t=this.myPath.replace("/bubble.json",e.replace("$file$","")));return t},p.prototype.getThumbnailOptions=function(e,t,n){var i=t||200,r=n||200,o=e.urn||this.myData.urn;return{urn:o,width:i,height:r,guid:e.guid,acmsession:this.getAcmSessionId(o)}},p.prototype.getThumbnailPath=function(e,t,n){var i=this.getThumbnailOptions(e,t,n),r=o.endpoint.getThumbnailApi(null,i.urn)+"?width="+i.width+"&height="+i.height;i.guid&&(r+="&guid="+i.guid),i.acmsession&&(r+="&acmsession="+i.acmsession);var a=o.endpoint.getQueryParams();return a&&(r+="&"+a),r},p.prototype.getLeafletZipParams=function(e,t){for(var n,i,r=t.search({role:"leaflet-zip"},!1),o=0;o<r.length;o++){i={};var a=(n=r[o]._raw()).urn;i.urnZip=this.getFullPath(a),i.centralDirOffset=n.central_dir_offset,i.centralDirLength=n.central_dir_length,i.centralDirEntries=n.central_dir_entries,i.zipMaxLevel=n.max_level-e.levelOffset,i.loadFromZip=!!(i.urnZip&&i.centralDirOffset&&i.centralDirLength&&i.centralDirEntries),i.fileTable={},e.zips||(e.zips=[]),e.zips.push(i)}e.zips.sort((function(e,t){return e.zipMaxLevel-t.zipMaxLevel}))},p.prototype.getLeafletParams=function(e,t,n){e.tileSize=n.tileSize?n.tileSize:512,e.texWidth=n.resolution[0],e.texHeight=n.resolution[1],e.paperWidth=n.paperWidth,e.paperHeight=n.paperHeight,e.paperUnits=n.paperUnits,e.urlPattern=n.urn,e.mime=n.mime,e.isLeaflet=!0,e.levelOffset=function(e){for(var t=1,n=0,i=0;i<20;i++){if((t*=2)>e)return n;n++}return l.logger.log("unexpected leaflet tileSize"),0}(e.tileSize),this.getLeafletZipParams(e,t),e.loadFromZip=e.zips&&e.zips[0].loadFromZip,e.zips&&(0,o.isOffline)()&&(0,s.isMobileDevice)()&&(e.zips=e.zips.slice(0,1),e.maxLevel=e.zips[0].zipMaxLevel)},p.prototype.derivePdfUrnHack=function(e,t){var n=e.parent.children.slice();n.sort((function(e,t){return e._raw().order-t._raw().order}));var r=(n.length<=75?n[n.length-1]:n[74]).search(i.BubbleNode.GEOMETRY_F2D_NODE)[0];if(r){var o=r.urn().indexOf("/"),a=r.urn().slice(0,o),s=e._raw().order,l=0|s%75,c=1+(0|s/75),u=a+"/output/".concat(l,"/").concat(l,".pdf");return t.page=c,t.isPdf=!0,console.log("pdf path",u),u}return null},p.prototype.getViewableUrn=function(e,t){var n,r=this;if(e instanceof i.BubbleNode)n=e;else{var o=this.docRoot.search(e);n=o.length>0?o[0]:new i.BubbleNode(e)}var a=function(){var e=n.search(i.BubbleNode.GEOMETRY_F2D_NODE);if(e.length)return e[0].urn()};if(n.isGeometry()){if(n.is3D())return n.getViewableRootPath();if(n.is2D()){var l=function(){if(n.isRevitPdf()){var e=a();if(e)return e}var o=n.data.totalRasterPixels;"number"!=typeof o&&(o=1/0);var l=o<1<<20,c="true"===(0,u.getParameterByName)("vectorPdf")||(0,s.getGlobal)().LMV_VECTOR_PDF||r.myData&&r.myData.isVectorPDF||!!n.data.isVectorPDF,h="false"===(0,u.getParameterByName)("vectorPdf")||(0,s.getGlobal)().LMV_RASTER_PDF;c?l=!0:h&&(l=!1);var d=n.search(i.BubbleNode.PDF_PAGE_NODE),p=n.search(i.BubbleNode.LEAFLET_NODE);if(l&&p.length>0&&t&&(r.getLeafletParams(t,n,p[0]._raw()),t.tempRasterPath=p[0].urn()),l&&d.length)return t&&(t.isPdf=!0,t.page=d[0].data.page||1),d[0].urn();if(p.length>0&&t){if(c){var f=r.derivePdfUrnHack(n,t);if(f)return f}return r.getLeafletParams(t,n,p[0]._raw()),p[0].urn()}}()||function(){var e=n.search(i.BubbleNode.IMAGE_NODE);if(e.length)return e[0].urn()}()||a();if(l)return l}}else if(n.isViewPreset()){var c=this.getViewGeometry(n,!0);if(c)return this.getViewableUrn(c,t)}return""},p.prototype.getViewablePath=function(e,t){var n=this.getViewableUrn(e,t);return n?this.getFullPath(n):""},p.prototype.downloadAecModelData=function(e){var t=this,n=e?function(t){try{e(t)}catch(e){console.error("Document.downloadAecModelData() onFinished handler crashed",e)}return t}:function(e){return e};if(this.downloadAecModelDataPromise)return this.downloadAecModelDataPromise.then(n),this.downloadAecModelDataPromise;var i=this.docRoot.findViewableParent(),r=i&&i.data.aec_model_data;if(r)return n(r),Promise.resolve(r);var s=this.docRoot.search({role:"Autodesk.AEC.ModelData"})[0];if(!s)return n(),Promise.resolve(null);var l=s.getViewableRootPath(),u=this.getFullPath(l),h={headers:{}},d=this.getAcmSessionId(u);return-1!==u.indexOf(".api.autodesk.com")&&c.token.accessToken&&(h.headers.Authorization="Bearer "+c.token.accessToken),d&&(h.queryParams="acmsession="+d),this.downloadAecModelDataPromise=new Promise((function(e){var t=function(t){s.findViewableParent().data.aec_model_data=t,e(t)};a.ViewingService.getItem(o.endpoint.initLoadContext(h),u,(function(e){return t(e)}),(function(){return t()}),{responseType:"json"})})).then((function(e){return delete t.downloadAecModelDataPromise,e})).then(n),this.downloadAecModelDataPromise},p.getAecModelData=function(e){if(Array.isArray(e)){var t=new Map,n=e.map((function(e){var n=e.getDocument(),i=t.get(n);if(i)return i;var r=n.downloadAecModelData();return t[n]=r,r}));return Promise.all(n)}return e.getDocument().downloadAecModelData()},p.prototype.getRoot=function(){return this.docRoot},p.prototype.getPath=function(){return this.myPath},p.prototype.getViewGeometry=function(e){return e.findParentGeom2Dor3D()},p.prototype.getNumViews=function(e){var t=e.guid;return e instanceof i.BubbleNode&&(t=e.guid()),this.myNumViews[t]||0},p.prototype.getMessages=function(e,t){var n=[];if(!e)return n;for(var i=e;i&&(!t||i.parent);)i._raw().messages&&(n=n.concat(i._raw().messages)),i=i.parent;return n},p.prototype.getGlobalMessages=function(){var e=[],t=0,n=0;this.getRoot().traverse((function(i){var r=i._raw().messages||[];r.filter((function(e){return"error"===e.type})).length>0&&(t+=1),"inprogress"===i._raw().status&&(n+=1),e=e.concat(r)}));var i="translated";i=t>0?"failed":i,i=n>0?"processing":i;for(var r=e.length;r--;e[r].$translation=i);return e}},7724:(e,t,n)=>{"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.r(t),n.d(t,{DynamicGlobalOffset:()=>l});var r=Autodesk.Viewing.Private,o=null,a=null,s=null,l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewer=t,this.enabled=!1,this.onCameraChanged=this.onCameraChanged.bind(this);this.maxDistSq=1e8,this.setActive(!0)}var t,n,l;return t=e,l=[{key:"updateModelMatrix",value:function(e,t,n){o=o||new r.LmvMatrix4(!0),a=a||new r.LmvMatrix4(!0),s=s||new r.LmvMatrix4(!0);var i=e.myData.placementWithOffset?o.copy(e.myData.placementWithOffset).invert():o.identity(),l=t?a.copy(t):a.identity();n&&(l.elements[12]-=n.x,l.elements[13]-=n.y,l.elements[14]-=n.z);var c=s.multiplyMatrices(l,i);e.setModelTransform(c)}}],(n=[{key:"setActive",value:function(e){e!=this.enabled&&(this.enabled=e,e?this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChanged):this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.onCameraChanged))}},{key:"onCameraChanged",value:function(){if(!this.viewer.impl.is2d&&!this.blockEvents){var e=this.viewer.toolController.getTool("orbit");if(!((null==e?void 0:e.isDragging)||this.viewer.impl.camera.position.lengthSq()<this.maxDistSq)){this.blockEvents=!0;var t=this.viewer.impl.camera.getGlobalPosition();this.resetGlobalOffset(t),this.blockEvents=!1}}}},{key:"resetGlobalOffset",value:function(e){var t=this;this.viewer.getVisibleModels().forEach((function(n){n.setGlobalOffset(e),t.viewer.impl.onModelTransformChanged(n)})),this.viewer.impl.camera.setGlobalOffset(e),this.viewer.impl.syncCamera(),this.viewer.autocam&&this.viewer.autocam.onGlobalOffsetChanged(e),this.viewer.autocam.sync(this.viewer.impl.camera)}}])&&i(t.prototype,n),l&&i(t,l),e}()},62546:(e,t,n)=>{"use strict";n.r(t),n.d(t,{EventDispatcher:()=>i});var i=function(){};i.prototype={constructor:i,apply:function(e){e.addEventListener=i.prototype.addEventListener,e.hasEventListener=i.prototype.hasEventListener,e.removeEventListener=i.prototype.removeEventListener,e.clearListeners=i.prototype.clearListeners,e.fireEvent=i.prototype.fireEvent,e.dispatchEvent=i.prototype.fireEvent,e.debugEvents=i.prototype.debugEvents},addEventListener:function(e,t,n){if(e){void 0===this.listeners&&(this.listeners={}),void 0===this.listeners[e]&&(this.listeners[e]=[]);for(var i=n&&n.priority||0,r=this.listeners[e].length,o=this.listeners[e].length-1;o>=0&&i>this.listeners[e][o].priority;o--)r--;this.listeners[e].splice(r,0,{callbackFn:t,once:!!n&&!!n.once,priority:i})}},hasEventListener:function(e,t){if(!e)return!1;if(void 0===this.listeners)return!1;var n=this.listeners[e];if(!n||0===n.length)return!1;for(var i=0,r=n.length;i<r;++i)if(n[i].callbackFn===t)return!0;return!1},removeEventListener:function(e,t){if(e)if(void 0!==this.listeners){var n=this.listeners[e];if(n)for(var i=0,r=n.length;i<r;++i)if(n[i].callbackFn===t){n.splice(i,1);break}}else this.listeners={}},clearListeners:function(){this.listeners=void 0},dispatchEvent:function(e){if(void 0!==this.listeners){if("string"==typeof e&&(e={type:e}),!e.target)try{e.target=this}catch(e){}if(!e.type)throw new Error("event type unknown.");if(this._doDebug&&console.log("Event: "+e.type),Array.isArray(this.listeners[e.type])){for(var t=this.listeners[e.type].slice(),n=[],i=0,r=t.length;i<r;++i)t[i].callbackFn.call(this,e),t[i].once&&n.push(t[i].callbackFn);for(var o=0;o<n.length;++o)this.removeEventListener(e.type,n[o])}}else this.listeners={}},debugEvents:function(e){this._doDebug=e}},i.prototype.fireEvent=i.prototype.dispatchEvent,"undefined"!=typeof Autodesk&&(Autodesk.Viewing.EventDispatcher=i)},37169:e=>{"use strict";var t=e.exports;t.ESCAPE_EVENT="escape",t.PROGRESS_UPDATE_EVENT="progress",t.FULLSCREEN_MODE_EVENT="fullScreenMode",t.NAVIGATION_MODE_CHANGED_EVENT="navmode",t.VIEWER_STATE_RESTORED_EVENT="viewerStateRestored",t.VIEWER_RESIZE_EVENT="viewerResize",t.VIEWER_INITIALIZED="viewerInitialized",t.VIEWER_UNINITIALIZED="viewerUninitialized",t.LOADER_LOAD_FILE_EVENT="loaderLoadFile",t.LOADER_LOAD_ERROR_EVENT="loaderLoadError",t.MODEL_ROOT_LOADED_EVENT="svfLoaded",t.GEOMETRY_LOADED_EVENT="geometryLoaded",t.TEXTURES_LOADED_EVENT="texturesLoaded",t.OBJECT_TREE_CREATED_EVENT="propertyDbLoaded",t.OBJECT_TREE_UNAVAILABLE_EVENT="propertyDbUnavailable",t.OBJECT_TREE_LOAD_PROGRESS_EVENT="propertyDbLoadProgress",t.MODEL_UNLOADED_EVENT="modelUnloaded",t.MODEL_ADDED_EVENT="modelAdded",t.MODEL_REMOVED_EVENT="modelRemoved",t.MODEL_LAYERS_LOADED_EVENT="modelLayersLoaded",t.MODEL_TRANSFORM_CHANGED_EVENT="modelTransformChanged",t.MODEL_PLACEMENT_CHANGED_EVENT="placementTransformChanged",t.MODEL_VIEWPORT_BOUNDS_CHANGED_EVENT="viewportBoundsChanged",t.EXTENSION_PRE_LOADED_EVENT="extensionPreLoaded",t.EXTENSION_LOADED_EVENT="extensionLoaded",t.EXTENSION_PRE_UNLOADED_EVENT="extensionPreUnloaded",t.EXTENSION_UNLOADED_EVENT="extensionUnloaded",t.EXTENSION_PRE_ACTIVATED_EVENT="extensionPreActivated",t.EXTENSION_ACTIVATED_EVENT="extensionActivated",t.EXTENSION_PRE_DEACTIVATED_EVENT="extensionPreDeactivated",t.EXTENSION_DEACTIVATED_EVENT="extensionDeactivated",t.SELECTION_CHANGED_EVENT="selection",t.AGGREGATE_SELECTION_CHANGED_EVENT="aggregateSelection",t.ISOLATE_EVENT="isolate",t.AGGREGATE_ISOLATION_CHANGED_EVENT="aggregateIsolation",t.HIDE_EVENT="hide",t.AGGREGATE_HIDDEN_CHANGED_EVENT="aggregateHidden",t.SHOW_EVENT="show",t.SHOW_PROPERTIES_EVENT="showProperties",t.SHOW_ALL_EVENT="showAll",t.HIDE_ALL_EVENT="hideAll",t.CAMERA_CHANGE_EVENT="cameraChanged",t.EXPLODE_CHANGE_EVENT="explodeChanged",t.FIT_TO_VIEW_EVENT="fitToView",t.AGGREGATE_FIT_TO_VIEW_EVENT="aggregateFitToView",t.CUTPLANES_CHANGE_EVENT="cutplanesChanged",t.TOOL_CHANGE_EVENT="toolChanged",t.RENDER_OPTION_CHANGED_EVENT="renderOptionChanged",t.FINAL_FRAME_RENDERED_CHANGED_EVENT="finalFrameRenderedChanged",t.RENDER_PRESENTED_EVENT="renderPresented",t.LAYER_VISIBILITY_CHANGED_EVENT="layerVisibility",t.PREF_CHANGED_EVENT="PrefChanged",t.PREF_RESET_EVENT="PrefReset",t.RESTORE_DEFAULT_SETTINGS_EVENT="restoreDefaultSettings",t.ANIMATION_READY_EVENT="animationReady",t.CAMERA_TRANSITION_COMPLETED="cameraTransitionCompleted",t.HYPERLINK_EVENT="hyperlink",t.HYPERLINK_NAVIGATE="hyperlink_navigate",t.LOAD_GEOMETRY_EVENT="load_geometry",t.LOAD_MISSING_GEOMETRY="loadMissingGeometry",t.WEBGL_CONTEXT_LOST_EVENT="webglcontextlost",t.WEBGL_CONTEXT_RESTORED_EVENT="webglcontextrestored",t.CANCEL_LEAFLET_SCREENSHOT="cancelLeafletScreenshot",t.SET_VIEW_EVENT="setView",t.RENDER_FIRST_PIXEL="renderFirstPixel",t.PROFILE_CHANGE_EVENT="profileChanged",t.RENDER_SCENE_PART="renderScenePart",t.OBJECT_UNDER_MOUSE_CHANGED="hoverObjectChanged",t.ANIM_ENDED="animEnded",t.TRANSITION_STARTED="transitionStarted",t.TRANSITION_ENDED="transitionEnded"},11294:(e,t,n)=>{"use strict";n.r(t),n.d(t,{EventUtils:()=>c});var i=n(84998);function r(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var a=e.apply(t,n);function s(e){r(a,i,o,s,l,"next",e)}function l(e){r(a,i,o,s,l,"throw",e)}s(void 0)}))}}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=!1,l=!1,c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i,r,c,h;return t=e,n=null,i=[{key:"isRightClick",value:function(e){if(!(e instanceof u(e).MouseEvent))return!1;var t=e.button;return"buttons"in e&&(!l||1&e.buttons?2===t&&1&e.buttons&&(t=0,l=!0):(l=!1,t=0)),t===(s?0:2)}},{key:"isMiddleClick",value:function(e){return e instanceof u(e).MouseEvent&&1===e.button}},{key:"setUseLeftHandedInput",value:function(e){s=e}},{key:"waitUntilTransitionEnded",value:(h=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.navigation.getRequestTransition()||t.navigation.getTransitionActive()){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",new Promise((function(e){setTimeout((function(){t.navigation.getRequestTransition()||t.navigation.getTransitionActive()?t.addEventListener(Autodesk.Viewing.CAMERA_TRANSITION_COMPLETED,e,{once:!0}):e()}))})));case 3:case"end":return e.stop()}}),e)}))),function(e){return h.apply(this,arguments)})},{key:"waitUntilGeometryLoaded",value:(c=o(regeneratorRuntime.mark((function e(t){var n,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=i.length>1&&void 0!==i[1]?i[1]:t.model)||!n.isLoadDone()){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",new Promise((function(e){t.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,(function i(r){n&&n!==r.model||(e(),t.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,i))}))})));case 4:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)})},{key:"waitUntilModelAdded",value:(r=o(regeneratorRuntime.mark((function e(t){var n,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=i.length>1&&void 0!==i[1]?i[1]:t.model)){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",new Promise((function(e){t.addEventListener(Autodesk.Viewing.MODEL_ADDED_EVENT,(function i(r){n&&n!==r.model||(e(),t.removeEventListener(Autodesk.Viewing.MODEL_ADDED_EVENT,i))}))})));case 4:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})}],n&&a(t.prototype,n),i&&a(t,i),e}();function u(e){var t=e.target&&e.target.ownerDocument;return t?t.defaultView||t.parentWindow:(0,i.getGlobal)()}Autodesk.Viewing.isRightClick=c.isRightClick,Autodesk.Viewing.isMiddleClick=c.isMiddleClick},25282:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Extension:()=>o});var i=n(41471),r=n(35449),o=function(e,t){this.viewer=e,r.GlobalManagerMixin.call(this),this.setGlobalManager(e.globalManager),this.options=t||{},this.id="",this.modes=[],this.mode="",this.name="",this.activeStatus=!1};o.prototype.load=function(){return!0},o.prototype.unload=function(){return!0},o.prototype.activate=function(e){return!0},o.prototype.deactivate=function(){return!0},o.prototype.setActive=function(e,t){e?this.activate(t):this.deactivate()},o.prototype.getName=function(){return this.name},o.prototype.getModes=function(){return this.modes},o.prototype.isActive=function(e){return e?this.activeStatus&&this.mode===e:this.activeStatus},o.prototype.getState=function(e){},o.prototype.restoreState=function(e,t){return!0},o.prototype.extendLocalization=function(e){return(0,i.extendLocalization)(e)},o.prototype.getCache=function(){this.viewer.extensionCache||(this.viewer.extensionCache={});var e=this.viewer.extensionCache[this.id];return e||(e=this.viewer.extensionCache[this.id]={}),e},o.prototype.onToolbarCreated=function(e){},"undefined"!=typeof Autodesk&&(Autodesk.Viewing.Extension=o)},61445:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ExtensionMixin:()=>d,theExtensionManager:()=>h});var i=n(98926),r=n(34500),o=n(37169),a=n(21319),s=Autodesk.Viewing;function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var h=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.registeredExtensions=new Map}var t,n,i;return t=e,(n=[{key:"registerExtension",value:function(e,t){if(this.registeredExtensions.has(e)){var n=this.registeredExtensions.get(e);if(n.EXTENSION_CLASS)return!1;n.EXTENSION_CLASS=t}else this.registeredExtensions.set(e,{EXTENSION_CLASS:t});return!0}},{key:"getExtensionClass",value:function(e){return this.registeredExtensions.has(e)?this.registeredExtensions.get(e).EXTENSION_CLASS:null}},{key:"unregisterExtension",value:function(e){return!!this.registeredExtensions.has(e)&&(this.registeredExtensions.delete(e),!0)}},{key:"registerExternalExtension",value:function(e,t,n){return!this.registeredExtensions.has(e)&&(this.registeredExtensions.set(e,{EXTENSION_CLASS:null,externalPathOrCallback:t,dependencies:n}),!0)}},{key:"getExternalPath",value:function(e){return this.registeredExtensions.has(e)?this.registeredExtensions.get(e).externalPathOrCallback:null}},{key:"getRegisteredExtensions",value:function(){return Array.from(this.registeredExtensions).map((function(e){var t=l(e,2),n=t[0],i=t[1];return{id:n,inMemory:!!i.EXTENSION_CLASS,isAsync:!!i.externalPathOrCallback}}))}},{key:"downloadExtension",value:function(e){var t=this;if(!this.registeredExtensions.has(e))return Promise.reject("Extension not found: "+e+". Has it been registered(1)?");var n=this.registeredExtensions.get(e);if(!n.externalPathOrCallback)return Promise.reject("Extension not found: "+e+". Has it been registered(2)?");if(n.downloadPromise)return n.downloadPromise;var i=(n.dependencies||[]).map((function(e){return t.downloadExtension(e)})),o=Promise.all(i);return n.downloadPromise=o.then((function(){return"string"==typeof n.externalPathOrCallback?r.theResourceLoader.loadScript(n.externalPathOrCallback,e):n.externalPathOrCallback()})).then((function(){if(delete n.downloadPromise,!n.EXTENSION_CLASS)throw new Error("Extension not found: "+e+". Has it been registered(3)?");return n.EXTENSION_CLASS})),n.downloadPromise}},{key:"popuplateOptions",value:function(e){this.registeredExtensions.forEach((function(t){t.EXTENSION_CLASS.populateDefaultOptions(e)}))}},{key:"isDownloading",value:function(e){return!!this.registeredExtensions.has(e)&&!!this.registeredExtensions.get(e).downloadPromise}},{key:"isAvailable",value:function(e){return!!this.getExtensionClass(e)}}])&&u(t.prototype,n),i&&u(t,i),e}()),d=function(){};d.prototype={loadExtension:function(e,t){var n=this;return this.loadedExtensions=this.loadedExtensions||{},h.isAvailable(e)?this.loadExtensionLocal(e,t):(this.loadExtensionPromises=this.loadExtensionPromises||{},e in this.loadExtensionPromises||(this.loadExtensionPromises[e]=h.downloadExtension(e).then((function(){if(delete n.loadExtensionPromises[e],n.loadedExtensions){if(n.cancelledExtensions&&e in n.cancelledExtensions)throw delete n.cancelledExtensions[e],new Error("Abort loadExtension('".concat(e,"') - extension has been unloaded"));return n.loadExtensionLocal(e,t)}i.logger.info("Abort loadExtension('".concat(e,"') - teardown in progress"))}))),this.loadExtensionPromises[e])},getExtension:function(e,t){var n=this.loadedExtensions&&e in this.loadedExtensions?this.loadedExtensions[e]:null;return n&&t&&t(n),n},getExtensionAsync:function(e){var t=this,n=this.getExtension(e);return n?Promise.resolve(n):new Promise((function(i){t.addEventListener(o.EXTENSION_LOADED_EVENT,(function t(r){r.extensionId===e&&(this.removeEventListener(o.EXTENSION_LOADED_EVENT,t),n=this.getExtension(e),i(n))}))}))},unloadExtension:function(e){if(this.cancelledExtensions=this.cancelledExtensions||{},h.isDownloading(e))return this.cancelledExtensions[e]=!0,!1;var t=!1,n=this.getExtension(e);return n?(t=n.unload(),i.logger.info("Extension unloaded: "+e),delete this.loadedExtensions[e],a.analytics.track("viewer.extensionManager.extensionUnloaded",{extensionId:e}),this.dispatchEvent({type:o.EXTENSION_UNLOADED_EVENT,extensionId:e})):i.logger.warn("Extension not found: "+e),t},loadExtensionLocal:function(e,t){var n=this,r=h.getExtensionClass(e);if(!r)return Promise.reject("Extension not found : "+e);var l=this.getExtension(e);if(l)return Promise.resolve(l);if(this.loadingExtensions&&e in this.loadingExtensions)return this.loadingExtensions[e];l=function(e){function t(t,n,i){var r=e[t];r?e[t]=function(){n&&n.call.apply(n,[e].concat(Array.prototype.slice.call(arguments)));var t=r.call.apply(r,[e].concat(Array.prototype.slice.call(arguments)));return i&&i.call.apply(i,[e].concat(Array.prototype.slice.call(arguments))),t}:console.warn(t," not implemented in ",e)}return t("load",(function(){this.viewer.dispatchEvent({type:s.EXTENSION_PRE_LOADED_EVENT,extensionId:this.id})})),t("unload",(function(){this.viewer.dispatchEvent({type:s.EXTENSION_PRE_UNLOADED_EVENT,extensionId:this.id})})),t("activate",(function(e){this.viewer.dispatchEvent({type:s.EXTENSION_PRE_ACTIVATED_EVENT,extensionId:this.id,mode:e})}),(function(e){this.viewer.dispatchEvent({type:s.EXTENSION_ACTIVATED_EVENT,extensionId:this.id,mode:e}),a.analytics.track("viewer.extension.activate",{extensionId:this.id,mode:e})})),t("deactivate",(function(){this.viewer.dispatchEvent({type:s.EXTENSION_PRE_DEACTIVATED_EVENT,extensionId:this.id})}),(function(){this.viewer.dispatchEvent({type:s.EXTENSION_DEACTIVATED_EVENT,extensionId:this.id}),a.analytics.track("viewer.extension.deactivate",{extensionId:this.id})})),e}(new r(this,t)),l.id=e;var c=l.load();if(!c)return Promise.reject("Extension failed to .load() : "+e);var u=function(){n.loadedExtensions[e]=l,n.onPostExtensionLoad(l),i.logger.info("Extension loaded: "+e),a.analytics.track("viewer.extensionManager.extensionLoaded",{extensionId:e}),setImmediate((function(){n.getExtension(e)&&n.dispatchEvent({type:o.EXTENSION_LOADED_EVENT,extensionId:e})}))};return c instanceof Promise?(this.loadingExtensions=this.loadingExtensions||{},this.loadingExtensions[e]=c.then((function(){return u(),l})).finally((function(){delete n.loadingExtensions[e]})),this.loadingExtensions[e]):(u(),Promise.resolve(l))},onPostExtensionLoad:function(e){},forEachExtension:function(e){var t=this.loadedExtensions||{};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(t[n])},apply:function(e){var t=d.prototype;e.loadExtension=t.loadExtension,e.getExtension=t.getExtension,e.getExtensionAsync=t.getExtensionAsync,e.unloadExtension=t.unloadExtension,e.loadExtensionLocal=t.loadExtensionLocal,e.forEachExtension=t.forEachExtension,e.onPostExtensionLoad=t.onPostExtensionLoad}}},25637:(e,t,n)=>{"use strict";function i(e){this.viewer=e}n.r(t),n.d(t,{FileLoader:()=>i}),i.prototype.constructor=i,i.prototype.loadFile=function(e,t,n,i){return!1},i.prototype.is3d=function(){return!1}},50411:(e,t,n)=>{"use strict";n.r(t),n.d(t,{FileLoaderManager:()=>r});var i={};var r={registerFileLoader:function(e,t,n){return!i[e]&&(i[e]={loader:n,extensions:t},!0)},getFileLoader:function(e){return i[e]?i[e].loader:null},getFileLoaderForExtension:function(e){for(var t in e=e?e.toLowerCase():"",i){var n=i[t];if(n)for(var r=0;r<n.extensions.length;r++)if(n.extensions[r].toLowerCase()===e)return n.loader}return null},unregisterFileLoader:function(e){return!!i[e]&&(delete i[e],!0)}}},27800:(e,t,n)=>{"use strict";function i(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw o}}}}function a(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.r(t),n.d(t,{GlobalManager:()=>u});var c=Autodesk.Viewing,u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._window={inner:null,registeredEventListeners:new Map},this._document={inner:null,registeredEventListeners:new Map},this._window.inner=c.getGlobal(),this._document.inner=this._window.inner.document,this.addWindowEventListener=d.bind(this._window),this.removeWindowEventListener=p.bind(this._window),this.addDocumentEventListener=d.bind(this._document),this.removeDocumentEventListener=p.bind(this._document)}var t,n,a;return t=e,(n=[{key:"getWindow",value:function(){return this._window.inner}},{key:"getDocument",value:function(){return this._document.inner}},{key:"setWindow",value:function(e){if(e&&e!==this._window.inner){var t,n=o(this._window.registeredEventListeners.entries());try{for(n.s();!(t=n.n()).done;){var a,s=r(t.value,2),l=s[0],c=o(s[1].entries());try{for(c.s();!(a=c.n()).done;){var u,h=r(a.value,2),d=h[0],p=h[1];e.addEventListener.apply(e,[l,d].concat(i(p))),(u=this._window.inner).removeEventListener.apply(u,[l,d].concat(i(p)))}}catch(e){c.e(e)}finally{c.f()}}}catch(e){n.e(e)}finally{n.f()}var f,m=o(this._document.registeredEventListeners.entries());try{for(m.s();!(f=m.n()).done;){var g,v=r(f.value,2),y=v[0],b=o(v[1].entries());try{for(b.s();!(g=b.n()).done;){var _,x,E=r(g.value,2),w=E[0],S=E[1];(_=e.document).addEventListener.apply(_,[y,w].concat(i(S))),(x=this._document.inner).removeEventListener.apply(x,[y,w].concat(i(S)))}}catch(e){b.e(e)}finally{b.f()}}}catch(e){m.e(e)}finally{m.f()}this._window.inner=e,this._document.inner=e.document}}}])&&l(t.prototype,n),a&&l(t,a),e}();function h(e){return!!e.opener}function d(e,t){for(var n,i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];h(this.inner)||(this.registeredEventListeners.has(e)?this.registeredEventListeners.get(e).set(t,r):this.registeredEventListeners.set(e,new Map([[t,r]]))),(n=this.inner).addEventListener.apply(n,[e,t].concat(r))}function p(e,t){var n;h(this.inner)||this.registeredEventListeners.has(e)&&this.registeredEventListeners.get(e).has(t)&&this.registeredEventListeners.get(e).delete(t);for(var i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];(n=this.inner).removeEventListener.apply(n,[e,t].concat(r))}},35449:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GlobalManagerMixin:()=>o});var i=n(27800),r=new i.GlobalManager;function o(){this.globalManager=r,this.setGlobalManager=function(e){this.globalManager=e,this.onSetGlobalManager(this.globalManager)},this.onSetGlobalManager=function(e){},this.getWindow=function(){return this.globalManager.getWindow()},this.getDocument=function(){return this.globalManager.getDocument()},this.setWindow=function(e){return this.globalManager.setWindow(e)},this.addWindowEventListener=function(e,t){for(var n,i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];(n=this.globalManager).addWindowEventListener.apply(n,[e,t].concat(r))},this.removeWindowEventListener=function(e,t){for(var n,i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];(n=this.globalManager).removeWindowEventListener.apply(n,[e,t].concat(r))},this.addDocumentEventListener=function(e,t){for(var n,i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];(n=this.globalManager).addDocumentEventListener.apply(n,[e,t].concat(r))},this.removeDocumentEventListener=function(e,t){for(var n,i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];(n=this.globalManager).removeDocumentEventListener.apply(n,[e,t].concat(r))}}Autodesk.Viewing.GlobalManager=i.GlobalManager,Autodesk.Viewing.GlobalManagerMixin=o},95018:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DefaultLightPreset:()=>r,DefaultLightPreset2d:()=>o,DefaultToneMapMethod:()=>a,BackgroundPresets:()=>s,LightPresets:()=>c,copyLightPreset:()=>h});var i=n(84998),r=1,o=0,a=1,s={"Fusion Grey":[230,230,230,150,150,150],"Sky Blue":[226,244,255,156,172,180],Snow:[181,186,199,181,186,199],Midnight:[41,76,120,1,2,3],White:[255,255,255,255,255,255],AutoCADModel:[30,40,48,30,40,48],"Dark Grey":[51,51,51,51,51,51],"Dark Sky":[51,51,51,51,51,51],"Infinity Pool":[255,255,255,255,255,255],Tranquility:[0,84,166,0,84,166],"Grey Room":[129,129,129,129,129,129],"Photo Booth":[237,237,237,237,237,237],"RaaS SBS":[1,1,1,90,90,90],Plaza:[79,102,130,79,102,130],Field:[202,226,252,202,201,190],Boardwalk:[216,230,248,230,228,220],Custom:[230,230,230,150,150,150]},l=s,c=[{name:"Simple Grey",path:null,tonemap:0,E_bias:0,directLightColor:[1,.84,.67],ambientColor:[.2,.225,.25],lightMultiplier:1,bgColorGradient:l["Fusion Grey"],darkerFade:!1,rotation:0},{name:"Sharp Highlights",path:"SharpHighlights",type:"logluv",tonemap:a,E_bias:-9,directLightColor:[.5,.5,.5],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[.5,-.2,-.06],bgColorGradient:l["Photo Booth"],darkerFade:!0,rotation:0},{name:"Dark Sky",path:"DarkSky",type:"logluv",tonemap:a,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:1,lightDirection:[.1,-.55,-1],bgColorGradient:l["Dark Sky"],darkerFade:!1,rotation:0},{name:"Grey Room",path:"GreyRoom",type:"logluv",tonemap:a,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:l["Grey Room"],darkerFade:!0,rotation:0},{name:"Photo Booth",path:"PhotoBooth",type:"logluv",tonemap:a,E_bias:0,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:l["Photo Booth"],darkerFade:!0,rotation:0},{name:"Tranquility",path:"TranquilityBlue",type:"logluv",tonemap:a,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:l.Tranquility,darkerFade:!1,rotation:0},{name:"Infinity Pool",path:"InfinityPool",type:"logluv",tonemap:a,E_bias:-1,directLightColor:[1,.84,.67],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:l["Infinity Pool"],darkerFade:!1,rotation:0},{name:"Simple White",path:null,tonemap:0,E_bias:0,directLightColor:[1,1,1],ambientColor:[.25,.25,.25],lightMultiplier:1,bgColorGradient:l.White,saoRadius:.06,saoIntensity:.15,darkerFade:!0,rotation:0},{name:"Riverbank",path:"riverbank",type:"logluv",tonemap:a,E_bias:-5.7,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l["Sky Blue"],darkerFade:!1,rotation:0},{name:"Contrast",path:"IDViz",type:"logluv",tonemap:a,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l.Midnight,darkerFade:!1,rotation:0},{name:"Rim Highlights",path:"RimHighlights",type:"logluv",tonemap:a,E_bias:-9,directLightColor:[.5,.5,.5],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[.35,-.35,-.5],bgColorGradient:l["Photo Booth"],darkerFade:!0,rotation:0},{name:"Cool Light",path:"CoolLight",type:"logluv",tonemap:a,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-0,-.15,-.5],bgColorGradient:l["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Warm Light",path:"WarmLight",type:"logluv",tonemap:a,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-0,-.15,-.5],bgColorGradient:l["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Soft Light",path:"SoftLight",type:"logluv",tonemap:a,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-.5,-.5,0],bgColorGradient:l["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Grid Light",path:"GridLight",type:"logluv",tonemap:a,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-.5,-.6,0],bgColorGradient:l["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Plaza",path:"Plaza",type:"logluv",tonemap:a,E_bias:-14,directLightColor:[.9,.9,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-.2,-.18,.72],bgColorGradient:l.Plaza,darkerFade:!1,rotation:0},{name:"Snow Field",path:"SnowField",type:"logluv",tonemap:a,E_bias:-10.461343,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[0,-1,0],bgColorGradient:l.Snow,darkerFade:!1,rotation:0},{name:"Field",path:"field",type:"logluv",tonemap:a,E_bias:-2.9,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l.Field,useIrradianceAsBackground:!0,darkerFade:!0,rotation:0},{name:"Boardwalk",path:"boardwalk",type:"logluv",tonemap:a,E_bias:-7,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l.Boardwalk,useIrradianceAsBackground:!0,darkerFade:!1,rotation:0},{name:"Flat Shading",path:null,tonemap:0,E_bias:0,directLightColor:[0,0,0],ambientColor:[0,0,0],lightMultiplier:0,bgColorGradient:l["Fusion Grey"],darkerFade:!1,rotation:0}],u=[{name:"Harbor",path:"Harbor",type:"logluv",tonemap:a,E_bias:1.9,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l["Sky Blue"],useIrradianceAsBackground:!0,saoIntensity:.5,darkerFade:!1,rotation:0},{name:"Night",path:"Night",type:"logluv",tonemap:1,E_bias:4,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l.Midnight,useIrradianceAsBackground:!1,darkerFade:!1,rotation:0},{name:"Parking",path:"Parking",type:"logluv",tonemap:a,E_bias:2.8,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l["Sky Blue"],useIrradianceAsBackground:!1,saoIntensity:.5,darkerFade:!1,rotation:0},{name:"River Road",path:"RiverRoad",type:"logluv",tonemap:a,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l["Fusion Grey"],useIrradianceAsBackground:!1,saoIntensity:.7,darkerFade:!1,rotation:0},{name:"Crossroads",path:"crossroads",type:"logluv",tonemap:a,E_bias:-5.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l["Sky Blue"],useIrradianceAsBackground:!0,darkerFade:!0,rotation:0},{name:"Seaport",path:"seaport",type:"logluv",tonemap:a,E_bias:-6.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l["Sky Blue"],useIrradianceAsBackground:!0,darkerFade:!1,rotation:0},{name:"Glacier",path:"glacier",type:"logluv",tonemap:a,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l.Midnight,darkerFade:!1,rotation:0},{name:"RaaS Test Env",path:"Reflection",type:"logluv",tonemap:2,E_bias:-1.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:l["RaaS SBS"],darkerFade:!1,rotation:0},{name:"City Night",path:"CityNight",type:"logluv",tonemap:a,E_bias:1.6,directLightColor:[1,1,1],lightMultiplier:.2,bgColorGradient:l.Midnight,useIrradianceAsBackground:!1,darkerFade:!1,rotation:0}];function h(e,t){(0,i.ObjectAssign)(t,e),t.name=e.name+" (copy)"}(0,i.getGlobal)().ENABLE_DEBUG&&Array.prototype.push.apply(c,u)},19255:(e,t,n)=>{"use strict";n.r(t),n.d(t,{LocalStorage:()=>s});var i,r=n(98926),o=(0,n(84998).getGlobal)();function a(){this.isSupported()||(this._data={})}a.prototype.getItem=function(e){return this.isSupported()?o.localStorage.getItem(e):Object.prototype.hasOwnProperty.call(this._data,e)?this._data[e]:null},a.prototype.setItem=function(e,t){if(this.isSupported())try{o.localStorage.setItem(e,t)}catch(e){r.logger.debug("avp.LocalStorage: Failed to setItem()")}else this._data[e]=String(t)},a.prototype.removeItem=function(e){this.isSupported()?o.localStorage.removeItem(e):delete this._data[e]},a.prototype.clear=function(){this.isSupported()?o.localStorage.clear():this._data={}},a.prototype.isSupported=function(){return void 0===i&&(i=function(){if("undefined"==typeof window)return!1;try{var e="lmv_viewer_test_localStorage",t=o.localStorage;return!!t&&(t.setItem(e,"1"),t.removeItem(e),!0)}catch(e){return!1}}()),i},a.prototype.getAllKeys=function(){return i?Object.keys(o.localStorage):Object.keys(this._data)};var s=new a},83161:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Model:()=>d});var i=n(30190),r=n(62546),o=n(57601),a=n(43586),s=n(84998),l=n(282),c=n(93382),u=n(50638),h=n(65522);function d(e){var t;i.RenderModel.call(this),this.myData=e,this.topology=null,this.topologyPromise=null,this.svfUUID=null,this.defaultCameraHash=null,this.getInstanceTree=function(){return this.myData?this.myData.instanceTree:null},this.getBoundingBox=(t=new THREE.Box3,function(e,n){if(!this.myData)return null;if(t.copy(this.myData.modelSpaceBBox||this.myData.bbox),n&&t.copy(this.trimPageShadowGeometry(t)),e)return t;var i=this.getData().placementWithOffset;i&&this.myData.modelSpaceBBox&&t.applyMatrix4(i);var r=this.getModelTransform();return r&&t.applyMatrix4(r),t}),this.getFuzzyBox=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Boolean(e.ignoreTransforms),n=this.getFragmentList();if(!n||this.is2d())return this.getBoundingBox(t);var i=null;if(t){var r=new Array(6),o=this.getData().placementWithOffset,a=o?o.clone().invert():void 0;i=function(e,t){n.getOriginalWorldBounds(e,r),t.min.fromArray(r),t.max.fromArray(r,3),a&&(t.min.applyMatrix4(a),t.max.applyMatrix4(a))}}else i=function(e,t){n.getWorldBounds(e,t)};function s(){var t=new THREE.Box3,r=new THREE.Vector3,o=new THREE.Vector3,a=new THREE.Vector3,s=0;function l(n){if(!e.allowlist||e.allowlist.includes(n)){i(n,t),t.getCenter(r);var l=t.getSize(o).length();a.add(r.multiplyScalar(l)),s+=l}}for(var c=0;c<n.getCount();c++)l(c);return a.multiplyScalar(1/s),a}for(var l=e.center||s(),c=e.quantil||.75,u=new THREE.Box3,h=[],d=new THREE.Vector3,p=0;p<n.getCount();p++)if((!e.allowlist||e.allowlist.includes(p))&&(i(p,u),!u.isEmpty())){var f=u.distanceToPoint(l);0===f&&(f=l.distanceTo(u.getCenter(d))),h.push({fragId:p,distance:f})}h.sort((function(e,t){return e.distance-t.distance}));for(var m=new THREE.Box3,g=0;g<h.length*c;g++){var v=h[g];i(v.fragId,u),m.union(u)}return m},this.is2d=function(){return!(!this.myData||!this.myData.is2d)},this.is3d=function(){return!this.is2d()},this.isOTG=function(){return this.myData&&!!this.myData.isOTG},this.isSVF2=function(){var e=this.getDocumentNode();return!!e&&e.isSVF2()},this.isPdf=function(e){return!(!this.myData||!this.myData.isPdf||e&&this.isRevitPdf())},this.isRevitPdf=function(){var e;return!!(null===(e=this.getDocumentNode())||void 0===e?void 0:e.isRevitPdf())},this.isLeaflet=function(){return!(!this.myData||!this.myData.isLeaflet)},this.isPageCoordinates=function(){var e;return this.is2d()&&(!this.isLeaflet()||(null===(e=this.loader)||void 0===e?void 0:e.isPageCoordinates()))},this.isSceneBuilder=function(){return!(!this.myData||!this.myData.isSceneBuilder)}}r.EventDispatcher.prototype.apply(d.prototype),d.prototype.constructor=d,d.prototype.getData=function(){return this.myData},d.prototype.setUUID=function(e){this.svfUUID=btoa(encodeURI((0,o.pathToURL)(e)))},d.prototype.getDocumentNode=function(){var e,t,n;return null!==(e=null===(t=this.getData())||void 0===t||null===(n=t.loadOptions)||void 0===n?void 0:n.bubbleNode)&&void 0!==e?e:null},d.prototype.getRoot=function(){var e=this.getData();return e&&e.instanceTree?e.instanceTree.root:null},d.prototype.getRootId=function(){var e=this.getData();return e&&e.instanceTree&&e.instanceTree.getRootId()||0},d.prototype.getUnitData=function(e){return console.warn("Model.getUnitData is deprecated and will be removed in a future release, use Autodesk.Viewing.Private.getUnitData() instead."),(0,u.getUnitData)(e)},d.prototype.getUnitScale=function(){return(0,u.convertUnits)(this.getUnitString(),u.ModelUnits.METER,1,1)},d.prototype.getUnitString=function(){var e;if(this.is2d())e=this.getMetadata("page_dimensions","model_units",null)||this.getMetadata("page_dimensions","page_units",null);else{var t=this.getData();e=t&&t.overriddenUnits?t.overriddenUnits:t&&t.scalingUnit?t.scalingUnit:this.getMetadata("distance unit","value",null)}return(0,u.fixUnitString)(e)},d.prototype.getDisplayUnit=function(){var e;if(this.is2d())e=this.getMetadata("page_dimensions","model_units",null)||this.getMetadata("page_dimensions","page_units",null);else{var t=this.getData();e=t&&t.scalingUnit?t.scalingUnit:this.getMetadata("default display unit","value",null)||this.getMetadata("distance unit","value",null)}return(0,u.fixUnitString)(e)},d.prototype.getSourceFileUnits=function(){var e=this.getDocumentNode();return null==e?void 0:e.getSourceFileUnits()},d.prototype.getMetadata=function(e,t,n){var i=this.getData();if(i){var r=i.metadata;if(r){var o=r[e];if(void 0!==o){if(!t)return o;var a=o[t];if(void 0!==a)return a}}}return n},d.prototype.getDefaultCamera=function(){var e=this.getData();if(!e)return null;var t=null,n=e.cameras?e.cameras.length:0;if(0<n){var i=this.getMetadata("default camera","index",null);if(null!==i&&e.cameras[i])t=e.cameras[i];else{for(var r=0;r<n;r++){var o=e.cameras[r];if(o.isPerspective){t=o;break}}t||(t=e.cameras[0])}}var a=this.getModelTransform();if(t&&a){var s=c.UnifiedCamera.copyViewParams(t);return c.UnifiedCamera.transformViewParams(s,a),c.UnifiedCamera.adjustOrthoCamera(s,this.getBoundingBox()),s}return t},d.prototype.isAEC=function(){return!!this.getData().loadOptions.isAEC},d.prototype.hasPageShadow=function(){return this.getData().hasPageShadow},d.prototype.getUpVector=function(){return this.getMetadata("world up vector","XYZ",null)},d.prototype.geomPolyCount=function(){var e=this.getGeometryList();return e?e.geomPolyCount:null},d.prototype.instancePolyCount=function(){var e=this.getGeometryList();return e?e.instancePolyCount:null},d.prototype.isLoadDone=function(e){var t=this.getData(),n=!e||!1!==t.texLoadDone;return!!(t&&t.loadDone&&n)},d.prototype.isObjectTreeCreated=function(){return!!this.getData().instanceTree},d.prototype.getPropertyDb=function(){var e=this.getData();return e&&e.propDbLoader},d.prototype.getProperties=function(e,t,n){var i=this.getPropertyDb();!i||e<=0?n&&n():i.getProperties(e,t,n)},d.prototype.getProperties2=function(e,t,n,i){var r=this.getPropertyDb();!r||e<=0?n&&n():r.getProperties2(e,t,n,i)},d.prototype.getBulkProperties=function(e,t,n,i){Array.isArray(t)&&(t={propFilter:t});var r=(t=t||{}).propFilter||null,o=t.ignoreHidden||!1,a=this.getPropertyDb();a?a.getBulkProperties(e,r,n,i,o):i&&i()},d.prototype.getBulkProperties2=function(e,t,n,i){var r=this.getPropertyDb();r?r.getBulkProperties2(e,t,n,i):i&&i()},d.prototype.getPropertySetAsync=function(e,t){var n=this;return new Promise((function(i,r){n.getPropertySet(e,i,r,t)}))},d.prototype.getPropertySet=function(e,t,n,i){var r=this.getPropertyDb();r||n&&n("Properties failed to load."),r.getPropertySet(e,i,(function(e){t(new h.PropertySet(e))}),n)},d.prototype.getExternalIdMapping=function(e,t){var n=this.getPropertyDb();n?n.getExternalIdMapping(e,t):t&&t()},d.prototype.getLayerToNodeIdMapping=function(e,t){var n=this.getPropertyDb();n?n.getLayerToNodeIdMapping(e,t):t&&t()},d.prototype.getObjectTree=function(e,t){var n=this.getData().instanceTree;if(n)e(n);else{var i=this.getPropertyDb();i?i.getObjectTree(e,t):t&&t()}},d.prototype.isObjectTreeLoaded=function(){var e=this.getPropertyDb();return!!e&&e.isObjectTreeLoaded()},d.prototype.search=function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{searchHidden:!1},o=this.getPropertyDb();o?o.searchProperties(e,i,t,n,r):n&&n()},d.prototype.findProperty=function(e){var t=this.getPropertyDb();return t?t.findProperty(e):Promise.reject("Model doesn't have any properties.")};var p=function(e,t,n,i){var r,o,a,s,l,c,u=!1;a=i[n[n.length-1]].x,r=(s=i[n[n.length-1]].y)>=t;for(var h=0,d=n.length;h<d;++h)l=i[n[h]].x,r!=(o=(c=i[n[h]].y)>=t)&&(c-t)*(a-l)>=(l-e)*(s-c)==o&&(u=!u),r=o,a=l,s=c;return u};d.prototype.pointInPolygon=function(e,t,n,i){for(var r=!1,o=0;o<n.length;o++)p(e,t,n[o],i)&&(r=!r);return r},d.prototype.getPageToModelTransform=function(e){var t=this.getData();if(t.pageToModelTransform)return t.pageToModelTransform;var n=t,i=n.metadata.page_dimensions,r=n.viewports&&n.viewports[e];if(!r)return new THREE.Matrix4;n.viewportTransforms||(n.viewportTransforms=new Array(n.viewports.length));var o=n.viewportTransforms[e];if(o)return o;var s=new a.LmvMatrix4(!0).set(i.logical_width/i.page_width,0,0,i.logical_offset_x,0,i.logical_height/i.page_height,0,i.logical_offset_y,0,0,1,0,0,0,0,1),l=r.transform.slice();!function(e){var t=.001,n=e;if(Math.abs(n[0])<t)if(Math.abs(n[4])>t)for(var i=0;i<4;i++){var r=n[i];n[i]=n[i+4],n[i+4]=r}else for(var o=0;o<4;o++){var a=n[o];n[o]=n[o+8],n[o+8]=a}if(Math.abs(n[5])<t)for(var s=4;s<8;s++){var l=n[s];n[s]=n[s+4],n[s+4]=l}}(l);var c=new a.LmvMatrix4(!0);c.elements.set(l);var u=new a.LmvMatrix4(!0);return u.copy(c).invert(),u.multiply(s),n.viewportTransforms[e]=u,u},d.prototype.pageToModel=function(e,t,n,i){var r=this.getPageToModelTransform(n);function o(e){if(e){var t=(new THREE.Vector3).set(e.x,e.y,0).applyMatrix4(r);e.x=t.x,e.y=t.y,e.z=t.z}}i&&(r=r.clone().invert()),o(e),o(t)},d.prototype.pointInClip=function(e,t){for(var n=this.getData().clips,i=[],r=1;r<n.length;r++)if(r!==t){for(var o=[],a=[],s=n[r].contourCounts,l=n[r].points,c=0,u=[],h=0;h<s.length;h++){for(var d=0;d<s[h];d++)o.push(c),c++;a.push(o),o=[]}for(var p=0;p<l.length;p+=2){var f={x:l[p],y:l[p+1]};u.push(f)}this.pointInPolygon(e.x,e.y,a,u)&&i.push(r)}return i},d.prototype.getClip=function(e){for(var t=this.getData().clips,n=[],i=[],r=t[e].contourCounts,o=t[e].points,a=0,s=[],l=0;l<r.length;l++){for(var c=0;c<r[l];c++)n.push(a),a++;i.push(n),n=[]}for(var u=0;u<o.length;u+=2){var h={x:o[u],y:o[u+1]};s.push(h)}return{contours:i,points:s}},d.prototype.getTopoIndex=function(e){var t=this.getData();if(t&&t.fragments){var n=t.fragments.topoIndexes;if(n)return n[e]}},d.prototype.getTopology=function(e){return this.topology?this.topology[e]:null},d.prototype.hasTopology=function(){return!!this.topology},d.prototype.fetchTopology=function(e){if(this.topology)return Promise.resolve(this.topology);var t=this.getData();if(!t.topologyPath)return Promise.reject({error:"no-topology"});var n=e||((0,s.isMobileDevice)()?20:100);if(t.topologySizeMB>n)return Promise.reject({error:"topology-too-big",limitMB:n,topologyMB:t.topologySizeMB});if(!this.topologyPromise){var i=this;this.topologyPromise=new Promise((function(e,t){i.loader.fetchTopologyFile(i.getData().topologyPath,(function(n){n&&n.topology?(i.topology=n.topology,e(n.topology)):t(n)}))}))}return this.topologyPromise},d.prototype.hasGeometry=function(){var e=this.getData();return!!e&&(!!e.isLeaflet||(!!e.isSceneBuilder||e.fragments.length>0))},d.prototype.getFragmentPointer=function(e){return e?new l.FragmentPointer(this.getFragmentList(),e):null},d.prototype.clone=function(){var e=new d(this.myData);return e.topology=this.topology,e.topologyPromise=this.topologyPromise,e.svfUUID=this.svfUUID,e.defaultCameraHash=this.defaultCameraHash,e.loader=this.loader,e.setInnerAttributes(this.getInnerAttributes()),e},d.prototype.getSeedUrn=function(){var e;return(null===(e=this.loader)||void 0===e?void 0:e.svfUrn)||""},d.prototype.isNodeExists=function(e){var t,n=this.getInstanceTree();n?n.enumNodeChildren(e,(function(e){n.enumNodeFragments(e,(function(){t=!0}))}),!0):this.getFragmentList().fragments.dbId2fragId[e]&&(t=!0);return!!t},d.prototype.getModelKey=function(){var e=this.getDocumentNode();return e?e.getModelKey():this.getData().urn},d.prototype.dispose=function(){var e=this.getInstanceTree();null==e||e.dtor(),this.myData=null,this.topology=null,this.topologyPromise=null}},24032:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ModelLayers:()=>a});var i=n(98926),r=n(37169),o={name:"root",id:"root",isLayer:!1,children:[],childCount:0};function a(e){this.viewer=e,this.matman=e.matman(),this.model=null,this.root=null,this.initialized=!1,this.layerToIndex={},this.indexToLayer=[null],this.nodeToLayer=[]}var s=a.prototype;function l(e){var t=e.getData(),n=o;return t&&t.layersRoot&&(n=t.layersRoot),Promise.resolve(n)}function c(e){if(e.getData().loadOptions.skipPropertyDb)return Promise.resolve(null);var t=e.getPropertyDb();return!t||e.getData().loadOptions.disable3DModelLayers?Promise.resolve(o):t.findLayers()}function u(e,t){var n=e.model,i=e.indexToLayer;if(n.is2d()){if(!n.getData().layerCount)return;var r=[];for(var o in e.layerToIndex)r.push(e.layerToIndex[o]);e.matman.setLayerVisible(r,t,n.id),e.viewer.invalidate(!0)}else{var a=[],s=t?e.viewer.visibilityManager.show:e.viewer.visibilityManager.hide;h(e,(function(e,r){i[r].visible!==t&&(a.push(e),1024===a.length&&(s(a,n),a.length=0))})),a.length>0&&s(a,n)}for(var l=i.length,c=1;c<l;++c){var u=i[c];u&&(u.visible=t)}}function h(e,t){var n=e.nodeToLayer;if(n&&n.length){var i=e.model.getData().instanceTree.nodeAccess;for(var r in i.dbIdToIndex){var o=n[i.dbIdToIndex[r]]||0;0!==o&&t(0|r,o)}}}function d(e,t){return"number"==typeof t?t:e.layerToIndex[t.name||t]||0}function p(e){return!e.layer.isLayer}function f(e){if(!e)return[];var t=[],n=0;m(e,(function(e){t.push(e),e.isLayer&&(n=Math.max(n,0|e.index))}));for(var i=0;i<t.length;++i)t[i].isLayer||(t[i].index=++n);return t}function m(e,t){for(var n=0;n<e.length;++n){var i=e[n];t(i),i.children&&m(i.children,t)}}s.addModel=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.initialized&&(e.is2d()||!t)){var n=function(t){if(t){var n=this.model.getData().instanceTree;t.children=t.children||[];var r=f(t.children);t.childCount=r.length,this.indexToLayer=new Array(t.childCount+1),this.indexToLayer[0]=null;for(var o=0;o<t.childCount;++o){var a=r[o],s=null==a.visible||a.visible;this.layerToIndex[a.name]=a.index,this.indexToLayer[a.index]={layer:a,visible:s}}if(!this.model.is2d()&&0!==t.childCount){this.nodeToLayer=t.childCount<=256?new Uint8Array(n.nodeAccess.getNumNodes()):new Uint16Array(n.nodeAccess.getNumNodes());var l=function(e){if(this.model){var t=this.model.getData().instanceTree;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n))for(var i=this.layerToIndex[n],r=e[n],o=0,a=r.length;o<a;++o){var s=t.nodeAccess.getIndex(r[o]);this.nodeToLayer[s]=i}}}.bind(this),c=function(){i.logger.warn("ModelLayers error: coudn't get layers from property database.")}.bind(this);e.getLayerToNodeIdMapping(l,c)}}}.bind(this),a=function(t){var n,i=this;this.root=t,this.initialized=!0,!this.activateLayerState("Initial")&&(null===(n=this.model)||void 0===n?void 0:n.is2d())&&this.indexToLayer.forEach((function(e){e&&!e.visible&&i.setLayerVisible(e.layer,!1)})),this.viewer.api.dispatchEvent({type:r.MODEL_LAYERS_LOADED_EVENT,model:e,root:t})}.bind(this);this.model=e,(e.is2d()?l(e):c(e)).then((function(e){n(e),a(e)})).catch((function(e){i.logger.warn(e),a(o)}))}},s.removeModel=function(e){this.model===e&&(this.model=null,this.root=null,this.initialized=!1,this.layerToIndex={},this.indexToLayer=[null],this.nodeToLayer=[])},s.getRoot=function(){return this.initialized||i.logger.warn("Autodesk.Viewing.ModelLayers.getRoot couldn't peform action, layers are still being loaded"),this.root},s.showAllLayers=function(){this.initialized?u(this,!0):i.logger.warn("Autodesk.Viewing.ModelLayers.showAllLayers couldn't peform action, layers are still being loaded")},s.hideAllLayers=function(){this.initialized?u(this,!1):i.logger.warn("Autodesk.Viewing.ModelLayers.hideAllLayers couldn't peform action, layers are still being loaded")},s.isLayerVisible=function(e){if(!this.initialized)return i.logger.warn("Autodesk.Viewing.ModelLayers.isLayerVisible couldn't peform action, layers are still being loaded"),!1;var t=d(this,e),n=this.indexToLayer[t];if(p(n)){for(var r=n.layer.children,o=0;o<r.length;++o){var a=r[o].index;if(this.indexToLayer[a].visible)return!0}return!1}return n.visible},s.setLayerVisible=function(e,t){if(this.initialized){for(var n=(e=Array.isArray(e)?e:[e]).map(function(e){return d(this,e)}.bind(this)),r=n.length,o=0;o<r;++o){var a=n[o],s=this.indexToLayer[a];if(p(s))s.layer.children.forEach((function(e){n.push(e.index)}))}var l=this.model,c=this.indexToLayer;if(l.is2d())this.matman.setLayerVisible(n,t,l.id),this.viewer.invalidate(!0);else{var u=c.map((function(e){return!(null!==e&&-1!==n.indexOf(e.layer.index)&&e.visible!==t)})),f=[],m=t?this.viewer.visibilityManager.show:this.viewer.visibilityManager.hide;h(this,(function(e,t){u[t]||(f.push(e),1024===f.length&&(m(f,l),f.length=0))})),f.length>0&&m(f,l)}for(var g=n.length,v=0;v<g;++v){var y=this.indexToLayer[n[v]];y&&(y.visible=t)}}else i.logger.warn("Autodesk.Viewing.ModelLayers.setLayersVisible couldn't peform action, layers are still being loaded")},s.getVisibleLayerIndices=function(){if(!this.initialized)return i.logger.warn("Autodesk.Viewing.ModelLayers.getVisibleLayerIndices couldn't peform action, layers are still being loaded"),[];for(var e=[],t=this.indexToLayer,n=t.length,r=1;r<n;++r){var o=t[r];o&&o.visible&&!p(o)&&e.push(o.layer.index)}return e},s.allLayersVisible=function(){if(!this.initialized)return!0;for(var e=this.indexToLayer,t=e.length,n=1;n<t;++n){var i=e[n];if(i&&!i.visible)return!1}return!0},s.activateLayerState=function(e){if(!this.initialized)return i.logger.warn("Autodesk.Viewing.ModelLayers.activateLayerState couldn't peform action, layers are still being loaded"),!1;if(!this.model||this.model.is3d()||!e)return!1;var t,n=this.model.getData().metadata,r=null==n?void 0:n.layer_states;if(!r)return!1;for(t=0;t<r.length&&r[t].name!==e;t++);if(t>=r.length)return!1;var o=r[t].visible_layers,a={};if(o&&0<o.length)for(var s=0;s<o.length;s++)a[o[s]]=1;var l=[],c=[];for(var u in n.layers){var h=n.layers[u].name;u|=0,1===a[h]?l.push(u):c.push(u)}return this.setLayerVisible(l,!0),this.setLayerVisible(c,!1),!0},s.getLayerStates=function(){function e(e,t){var n=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(t);if(n.length!==i.length)return!1;for(var r=0;r<n.length;++r){var o=n[r];if(e[o]!==t[o])return!1}return!0}if(!this.initialized)return i.logger.warn("Autodesk.Viewing.ModelLayers.getLayerStates couldn't peform action, layers are still being loaded"),null;var t,n=this.model,r=n?n.getData().metadata:null,o=r?r.layers:null,a=r?r.layer_states:null;if(this.model.is3d()||!o||!a)return null;var s={},l={};for(var c in o)if(Object.prototype.hasOwnProperty.call(o,c)){var u=parseInt(c),h=o[c];s[t="string"==typeof h?h:h.name]=!0,this.isLayerVisible(u)&&(l[t]=!0)}for(var d=[],p=0;p<a.length;++p){var f=a[p],m=f.visible_layers,g={};if(!f.hidden){if(m&&0<m.length)for(var v=0;v<m.length;++v)t=m[v],Object.prototype.hasOwnProperty.call(s,t)&&(g[t]=!0);d.push({name:f.name,description:f.description,active:e(l,g)})}}return 0<d.length?d:null}},99248:(e,t,n)=>{"use strict";n.r(t),n.d(t,{estimateMemUsage:()=>c,ModelMemoryTracker:()=>u});function i(e){return e&&e.byteLength||0}function r(e){return i(e.boxes)+i(e.transforms)+i(e.fragId2dbId)+i(e.geomDataIndexes)+i(e.materials)}function o(e){return i(e.geomids)+i(e.materialids)+i(e.vizflags)+(e.boxes!==e.fragments.boxes?i(e.boxes):0)+(e.transforms!==e.fragments.transforms?i(e.transforms):0)}function a(e){return i(e.nodes.nodesRaw?e.nodes.nodesRaw:e.nodes)+i(e.primitives)}var s=!1;function l(e){for(var t,n=Autodesk.Viewing.Private,l=0,c=0;c<e.length;c++){var u=e[c],h=u.getData(),d=u.getConsolidation();if(d&&(l+=d.byteSize),u.isLeaflet())s||(console.warn("Memory tracking not implemented for leaflets."),s=!0);else{if(!h.isOTG)l+=u.getGeometryList().geomMemory;var p=h.fragments;p&&(l+=r(p));var f=u.getFragmentList();f&&(l+=o(f));var m=h.bvh;m&&(l+=a(m));var g=h.instanceTree;g&&(l+=(t=void 0,i((t=g.nodeAccess).children)+i(t.nameSuffixes)+i(t.names)+i(t.nodeBoxes)+i(t.nodes)))}}return isFinite(l)||n.logger.warn("Memory estimate result was not a number"),l}function c(e){var t=e.impl.geomCache(),n=t?t.byteSize:0,i=e.impl.modelQueue(),r=i.getModels(),o=i.getHiddenModels();return n+l(r)+l(o)}function u(e,t){var n=e,i=0,r=t||1048576e3;function o(e){var t;return e.lruTimestamp===i||(null===(t=e.getData())||void 0===t?void 0:t.loadOptions.keepHiddenModel)}this.updateModelTimestamps=function(e){i++;for(var t=0;t<e.length;t++){e[t].lruTimestamp=i}},this.memoryExceeded=function(){return c(n)>=r},this.getMemLimit=function(){return r},this.cleanup=function(e){var t=e||n.impl.unloadModel.bind(n.impl);if(this.memoryExceeded()){for(var i=function(){for(var e=n.impl.modelQueue().getHiddenModels(),t=[],i=0;i<e.length;i++){var r=e[i];o(r)||t.push(r)}return t.sort((function(e,t){return e.lurTimestamp-t.lruTimestamp})),t}(),r=0;r<i.length;r++){var a=i[r];if(a.isConsolidated&&(a.unconsolidate(),!this.memoryExceeded()))return}var s=n.impl.geomCache();for(r=0;r<i.length;r++)if(t(a=i[r]),s&&s.cleanup(),!this.memoryExceeded())return}}}},12032:(e,t,n)=>{"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.r(t),n.d(t,{OverlayManager:()=>r});var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.impl=t}var t,n,r;return t=e,(n=[{key:"dtor",value:function(){this.impl=null}},{key:"addScene",value:function(e){return!!e&&(Object.prototype.hasOwnProperty.call(this.impl.overlayScenes,e)||this.impl.createOverlayScene(e),!0)}},{key:"removeScene",value:function(e){return!!e&&(this.impl.removeOverlayScene(e),!0)}},{key:"clearScene",value:function(e){this.impl.clearOverlay(e)}},{key:"hasScene",value:function(e){return!!e&&Object.prototype.hasOwnProperty.call(this.impl.overlayScenes,e)}},{key:"addMesh",value:function(e,t){return!!(e&&t&&Object.prototype.hasOwnProperty.call(this.impl.overlayScenes,t))&&(e=Array.isArray(e)?e:[e],this.impl.addMultipleOverlays(t,e),!0)}},{key:"removeMesh",value:function(e,t){return!!(e&&t&&Object.prototype.hasOwnProperty.call(this.impl.overlayScenes,t))&&(e=Array.isArray(e)?e:[e],this.impl.removeMultipleOverlays(t,e),!0)}},{key:"hasMesh",value:function(e,t){var n=this.impl.overlayScenes[t];if(!n)return!1;for(var i=n.scene.children,r=0,o=i.length;r<o;++r)if(i[r]===e)return!0;return!1}}])&&i(t.prototype,n),r&&i(t,r),e}()},55412:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Prefs3D:()=>i,Prefs2D:()=>r,Prefs:()=>o,VIEW_TYPES:()=>a});var i={VIEW_CUBE:"viewCube",VIEW_CUBE_COMPASS:"viewCubeCompass",VIEW_TYPE:"viewType",ALWAYS_USE_PIVOT:"alwaysUsePivot",ZOOM_TOWARDS_PIVOT:"zoomTowardsPivot",SELECTION_SETS_PIVOT:"selectionSetsPivot",REVERSE_HORIZONTAL_LOOK_DIRECTION:"reverseHorizontalLookDirection",REVERSE_VERTICAL_LOOK_DIRECTION:"reverseVerticalLookDirection",ORBIT_PAST_WORLD_POLES:"orbitPastWorldPoles",CLICK_TO_SET_COI:"clickToSetCOI",GHOSTING:"ghosting",OPTIMIZE_NAVIGATION:"optimizeNavigation",AMBIENT_SHADOWS:"ambientShadows",ANTIALIASING:"antialiasing",GROUND_SHADOW:"groundShadow",GROUND_REFLECTION:"groundReflection",LINE_RENDERING:"lineRendering",EDGE_RENDERING:"edgeRendering",LIGHT_PRESET:"lightPreset",ENV_MAP_BACKGROUND:"envMapBackground",FIRST_PERSON_TOOL_POPUP:"firstPersonToolPopup",BIM_WALK_TOOL_POPUP:"bimWalkToolPopup",BIM_WALK_NAVIGATOR_TYPE:"bimWalkNavigatorType",BIM_WALK_GRAVITY:"bimWalkGravity",DEFAULT_NAVIGATION_TOOL_3D:"defaultNavigationTool3D",SELECTION_MODE:"selectionMode",ENABLE_CUSTOM_ORBIT_TOOL_CURSOR:"enableCustomOrbitToolCursor",EXPLODE_STRATEGY:"explodeStrategy",FORCE_DOUBLE_SIDED:"forceDoubleSided",DISPLAY_SECTION_HATCHES:"displaySectionHatches"},r={GRAYSCALE:"grayscale",SWAP_BLACK_AND_WHITE:"swapBlackAndWhite",LOADING_ANIMATION:"loadingAnimation",FORCE_PDF_CALIBRATION:"forcePDFCalibration",FORCE_LEAFLET_CALIBRATION:"forceLeafletCalibration",DISABLE_PDF_HIGHLIGHT:"disablePdfHighlight"},o={PROGRESSIVE_RENDERING:"progressiveRendering",OPEN_PROPERTIES_ON_SELECT:"openPropertiesOnSelect",POINT_RENDERING:"pointRendering",BACKGROUND_COLOR_PRESET:"backgroundColorPreset",REVERSE_MOUSE_ZOOM_DIR:"reverseMouseZoomDir",LEFT_HANDED_MOUSE_SETUP:"leftHandedMouseSetup",FUSION_ORBIT:"fusionOrbit",FUSION_ORBIT_CONSTRAINED:"fusionOrbitConstrained",WHEEL_SETS_PIVOT:"wheelSetsPivot",RESTORE_SESSION_MEASUREMENTS:"restoreMeasurements",DISPLAY_UNITS:"displayUnits",DISPLAY_UNITS_PRECISION:"displayUnitsPrecision",KEY_MAP_CMD:"keyMapCmd",ZOOM_DRAG_SPEED:"zoomDragSpeed",ZOOM_SCROLL_SPEED:"zoomScrollSpeed"},a={DEFAULT:0,ORTHOGRAPHIC:1,PERSPECTIVE:2,PERSPECTIVE_ORTHO_FACES:3}},91217:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Preferences:()=>d});var i=n(37169),r=n(98926),o=n(35449),a=n(50041),s=n(19255);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var d=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewer=t;this.options={},this.storageCache={},this.setGlobalManager(t.globalManager),this.setWebStorageKey("Default"),"string"==typeof n&&(this.options={prefix:n}),this.options=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n),this.options.prefix||(this.options.prefix="Autodesk.Viewing.Preferences."),Object.prototype.hasOwnProperty.call(this.options,"localStorage")||(this.options.localStorage=!0),this.defaults={},this.callbacks={},this.tags={},this.useLocalStorage=this.options.localStorage&&s.LocalStorage.isSupported(),t.addEventListener(i.PREF_CHANGED_EVENT,(function(e){var t=r.callbacks[e.name];t&&t.forEach((function(t){var n=t.changed;n&&"function"==typeof n&&n(e.value)}))})),t.addEventListener(i.PREF_RESET_EVENT,(function(e){var t=r.callbacks[e.name];t&&t.forEach((function(t){var n=t.reset;n&&"function"==typeof n&&n(e.value)}))}));return new Proxy(this,{get:function(e,t){return t in e?e[t]:e.storageCache[t]}})}var t,n,o;return t=e,(n=[{key:"setWebStorageKey",value:function(e){this.storageKey=e}},{key:"webStorage",value:function(e,t){if(this.useLocalStorage){if(this.hasTag(e,"no-storage"))return;var n=this.getLocalStoragePrefix()+this.storageKey,i=s.LocalStorage.getItem(n);if(i=JSON.parse(i||"{}"),void 0!==t)t instanceof a.EnumType&&(t=t.toString()),i[e]=t,s.LocalStorage.setItem(n,JSON.stringify(i));else if(void 0!==(t=i[e]))try{"__enum"===(t=JSON.parse(t)).type&&(t=a.EnumType.deSerialize(t))}catch(e){r.logger.log("Preferences: Cannot deserialize value ="+t),t=void 0}return t}}},{key:"getPrefFromLocalStorage",value:function(e){return this.webStorage(e)}},{key:"setPrefInLocalStorage",value:function(e,t){return this.webStorage(e,t)}},{key:"addPref",value:function(e,t){if("string"==typeof e&&"function"!=typeof this.storageCache[e]){t instanceof a.EnumType&&(t=t.clone());var n=this.webStorage(e);this.storageCache[e]=n||t,this.tags[e]={}}else r.logger.log("Preferences: invalid name="+e)}},{key:"load",value:function(e){for(var t in this.defaults=e,this.defaults)Object.prototype.hasOwnProperty.call(this.defaults,t)&&this.addPref(t,this.defaults[t])}},{key:"addTags",value:function(e,t){if(!t||!e)return!1;t=Array.isArray(t)?t:[t];for(var n=0;n<t.length;++n)this.tag(t[n],e);return!0}},{key:"tag",value:function(e,t){if(e){t?Array.isArray(t)||(t=[t]):t=Object.keys(this.defaults);for(var n=0;n<t.length;++n)this.tags[t[n]]&&(this.tags[t[n]][e]=!0)}}},{key:"untag",value:function(e,t){if(e){t?Array.isArray(t)||(t=[t]):t=Object.keys(this.defaults);for(var n=0;n<t.length;++n)this.tags[t[n]]&&(this.tags[t[n]][e]=!1)}}},{key:"hasTag",value:function(e,t){var n=this.tags[e];return!!n&&!0===n[t]}},{key:"add",value:function(e,t,n,o){return!Object.prototype.hasOwnProperty.call(this.defaults,e)||o?(this.setDefault(e,t),this.addPref(e,t),this.addTags(e,n),o&&this.viewer.dispatchEvent({type:i.PREF_CHANGED_EVENT,name:e,value:this.get(e)}),!0):(r.logger.log("Preferences: "+e+" already exists"),!1)}},{key:"setDefault",value:function(e,t){e&&null!=t&&(t instanceof a.EnumType?this.defaults[e]=t.clone():this.defaults[e]=t)}},{key:"remove",value:function(e,t){return!!Object.prototype.hasOwnProperty.call(this.defaults,e)&&(delete this.defaults[e],delete this.tags[e],this.storageCache&&delete this.storageCache[e],t&&this.deleteFromWebStorage(e),!0)}},{key:"deleteFromWebStorage",value:function(e){if(this.useLocalStorage){var t=this.getLocalStoragePrefix()+this.storageKey,n=s.LocalStorage.getItem(t);delete(n=JSON.parse(n||"{}"))[e],s.LocalStorage.setItem(t,JSON.stringify(n))}}},{key:"clearWebStorage",value:function(){var e=this.getLocalStoragePrefix();if(this.useLocalStorage)for(var t in s.LocalStorage.getAllKeys())-1!==t.indexOf(e)&&s.LocalStorage.removeItem(t)}},{key:"reset",value:function(e,t){for(var n in e&&void 0===t&&(t=!0),this.defaults)if(Object.prototype.hasOwnProperty.call(this.defaults,n)){if(e){var r=!!this.tags[n][e];if(t&&!r||!t&&r)continue}this.set(n,this.defaults[n],!1)&&this.viewer.dispatchEvent({type:i.PREF_RESET_EVENT,name:n,value:this.get(n)}),this.deleteFromWebStorage(n)}}},{key:"getLocalStoragePrefix",value:function(){return this.options.prefix}},{key:"get",value:function(e){return this.storageCache[e]instanceof a.EnumType?this.storageCache[e].value:this.storageCache[e]}},{key:"set",value:function(e,t,n){var r,o,s,c=t instanceof a.EnumType?t.value:t;return r=this.get(e),o=c,(s=function(e){return"object"===l(e)?JSON.stringify(e):e})(r)!==s(o)&&(this.storageCache[e]instanceof a.EnumType?this.storageCache[e].value=c:t instanceof a.EnumType?this.storageCache[e]=t.clone():this.storageCache[e]=c,this.webStorage(e,this.storageCache[e]),(void 0===n||n)&&this.viewer.dispatchEvent({type:i.PREF_CHANGED_EVENT,name:e,value:this.get(e)}),!0)}},{key:"dispatchEvent",value:function(e){var t=this.get(e),n=i.PREF_CHANGED_EVENT;this.viewer.dispatchEvent({type:n,name:e,value:t})}},{key:"addListeners",value:function(e,t,n){this.callbacks[e]||(this.callbacks[e]=[]),n||(n=t),this.callbacks[e].push({changed:t,reset:n})}},{key:"removeListeners",value:function(e,t,n){if(void 0!==this.callbacks[e])if(t||n){n||(n=t);for(var i=0;i<this.callbacks[e].length;++i)if(this.callbacks[e][i].changed===t&&this.callbacks[e][i].reset===n){this.callbacks[e].splice(i,1);break}}else delete this.callbacks[e]}},{key:"clearListeners",value:function(){this.callbacks={}}},{key:"setUseLocalStorage",value:function(e){this.useLocalStorage=!!e}}])&&h(t.prototype,n),o&&h(t,o),e}();o.GlobalManagerMixin.call(d.prototype)},41772:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Profile:()=>s});var i=n(55412),r=n(19255);function o(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw o}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function s(e){if(e){var t=Autodesk.Viewing,n=t.ProfileSettings.Default,a=[];if(this.name=Object.prototype.hasOwnProperty.call(e,"name")?e.name:"Custom",this.label=e.label,this.description=e.description,this.storageVersion="2.0",this.persistent=Array.isArray(e.persistent)?e.persistent:n.persistent,this.settings=Object.assign({},n.settings),Object.prototype.hasOwnProperty.call(e,"settings")){var s=e.settings;a=Object.keys(s),this.settings=Object.assign(this.settings,s)}var l=[],c=[];if(Object.prototype.hasOwnProperty.call(e,"extensions")){var u=e.extensions.load,h=e.extensions.unload;l=u?u.slice():l,c=h?h.slice():c}this.extensions={load:l,unload:c},this.apply=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e)return!1;var s=e.getLocalStoragePrefix()+"StorageVersion",l="Autodesk.Viewing.ProfileName",c=function(){return!!e.useLocalStorage&&(!r.LocalStorage.getItem(s)&&!!r.LocalStorage.getItem(l))},u=function(){var t,n={},i=r.LocalStorage.getItem(l),a=e.getLocalStoragePrefix(),s=o(r.LocalStorage.getAllKeys());try{for(s.s();!(t=s.n()).done;){var c=t.value;if(-1!==c.indexOf(a))try{n[c.split(".").pop()]=JSON.parse(r.LocalStorage.getItem(c)),r.LocalStorage.removeItem(c)}catch(e){console.log("Cound't convert preference to new format: ".concat(c))}}}catch(e){s.e(e)}finally{s.f()}r.LocalStorage.setItem(a+i,JSON.stringify(n)),r.LocalStorage.removeItem(l)};c()&&u();var h=e.getLocalStoragePrefix()+"StorageVersion";r.LocalStorage.setItem(h,this.storageVersion);var d=e.getLocalStoragePrefix()+"CurrentProfile";r.LocalStorage.setItem(d,this.name),e.setWebStorageKey(this.name);var p=this.settings,f=[t.ProfileSettings.Default.name,t.ProfileSettings.AEC.name],m=Object.values(i.Prefs3D),g=Object.values(i.Prefs2D);for(var v in p)if(Object.prototype.hasOwnProperty.call(p,v)){var y=p[v],b=-1!==a.indexOf(v)&&-1===f.indexOf(this.name)?["ignore-producer"]:[];-1!==m.indexOf(v)?b.push("3d"):-1!==g.indexOf(v)?b.push("2d"):(b.push("2d"),b.push("3d")),-1===this.persistent.indexOf(v)&&b.push("no-storage");var _=e.webStorage(v),x=e.get(v);if(void 0!==_){_!=x&&(e.add(v,_,b,!0),e.setDefault(v,y));continue}if(void 0!==x){e.addTags(v,b),x!==y&&n&&e.set(v,y);continue}e.add(v,y,b,!0)}return!0}}}},9322:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ProfileManager:()=>a});var i=n(98926),r=n(41772);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.registered={};var t=Autodesk.Viewing.ProfileSettings;this.PROFILE_DEFAULT=new r.Profile(t.Default),this.registerProfile("default",this.PROFILE_DEFAULT),this.PROFILE_AEC=new r.Profile(t.AEC),this.registerProfile("rvt",this.PROFILE_AEC),this.registerProfile("ifc",this.PROFILE_AEC),this.PROFILE_NAVIS=new r.Profile(t.Navis),this.registerProfile("nwc",this.PROFILE_NAVIS),this.registerProfile("nwd",this.PROFILE_NAVIS),this.PROFILE_FLUENT=new r.Profile(t.Fluent),this.registerProfile("fluent",this.PROFILE_FLUENT)}var t,n,a;return t=e,(n=[{key:"registerProfile",value:function(e,t){t?(e=e||"default",this.registered[e]=t instanceof r.Profile?t:new r.Profile(t)):i.logger.log("ProfileManager: missing profileSettings when registering a profile.")}},{key:"unregisterProfile",value:function(e){e?delete this.registered[e]:i.logger.log("ProfileManager: missing fileExt when unregistering a profile.")}},{key:"getProfiles",value:function(){return Object.assign({},this.registered)}},{key:"getProfileOrDefault",value:function(e){if(!e)return i.logger.log("ProfileManager: missing fileExt for getProfile. Returning the default Profile."),this.registered.default;var t=this.registered[e];return t||(i.logger.log("ProfileManager: No profile registered for ".concat(e,". Returning the default Profile.")),this.registered.default)}}])&&o(t.prototype,n),a&&o(t,a),e}()},50041:(e,t,n)=>{"use strict";n.r(t),n.d(t,{EnumType:()=>u,DefaultSettings:()=>d,ProfileSettings:()=>y});var i=n(55412),r=n(98926),o=n(82197),a=n(84998),s=n(95018),l=n(5130);function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var u=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!Array.isArray(t)||0===t.length)throw new Error("Invalid ".concat(t));this.values=new Set(t),this.current=t.includes(n)?n:t[0]}var t,n,i;return t=e,i=[{key:"deSerialize",value:function(t){if("__enum"===t.type)return new e(t.values,t.current)}}],(n=[{key:"clone",value:function(){return e.deSerialize(JSON.parse(this.toString()))}},{key:"toString",value:function(){return JSON.stringify({type:"__enum",values:Array.from(this.values),current:this.current})}},{key:"value",get:function(){return this.current},set:function(e){this.values.has(e)&&(this.current=e)}}])&&c(t.prototype,n),i&&c(t,i),e}(),h={};h[i.Prefs3D.AMBIENT_SHADOWS]=!0,h[i.Prefs3D.ANTIALIASING]=!(0,a.isMobileDevice)(),h[i.Prefs3D.GROUND_SHADOW]=!0,h[i.Prefs3D.GROUND_REFLECTION]=!1,h[i.Prefs3D.GHOSTING]=!0,h[i.Prefs3D.VIEW_CUBE]=!(0,a.isMobileDevice)(),h[i.Prefs3D.VIEW_CUBE_COMPASS]=!1,h[i.Prefs3D.VIEW_TYPE]=i.VIEW_TYPES.DEFAULT,h[i.Prefs3D.LINE_RENDERING]=!0,h[i.Prefs3D.LIGHT_PRESET]=s.DefaultLightPreset,h[i.Prefs3D.EDGE_RENDERING]=!1,h[i.Prefs3D.REVERSE_HORIZONTAL_LOOK_DIRECTION]=!1,h[i.Prefs3D.REVERSE_VERTICAL_LOOK_DIRECTION]=!1,h[i.Prefs3D.ALWAYS_USE_PIVOT]=!1,h[i.Prefs3D.ZOOM_TOWARDS_PIVOT]=!1,h[i.Prefs3D.ORBIT_PAST_WORLD_POLES]=!0,h[i.Prefs3D.CLICK_TO_SET_COI]=!1,h[i.Prefs3D.OPTIMIZE_NAVIGATION]=(0,a.isMobileDevice)(),h[i.Prefs3D.ENV_MAP_BACKGROUND]=!1,h[i.Prefs3D.FIRST_PERSON_TOOL_POPUP]=!0,h[i.Prefs3D.BIM_WALK_TOOL_POPUP]=!0,h[i.Prefs3D.BIM_WALK_NAVIGATOR_TYPE]="default",h[i.Prefs3D.BIM_WALK_GRAVITY]=!0,h[i.Prefs3D.DEFAULT_NAVIGATION_TOOL_3D]="default",h[i.Prefs3D.SELECTION_MODE]=o.SelectionMode.LEAF_OBJECT,h[i.Prefs3D.ENABLE_CUSTOM_ORBIT_TOOL_CURSOR]=!0,h[i.Prefs3D.EXPLODE_STRATEGY]="hierarchy",h[i.Prefs3D.SELECTION_SETS_PIVOT]=!1,h[i.Prefs3D.FORCE_DOUBLE_SIDED]=!1,h[i.Prefs3D.DISPLAY_SECTION_HATCHES]=!0,h[i.Prefs2D.GRAYSCALE]=!1,h[i.Prefs2D.SWAP_BLACK_AND_WHITE]=!1,h[i.Prefs2D.LOADING_ANIMATION]=!0,h[i.Prefs2D.FORCE_PDF_CALIBRATION]=!1,h[i.Prefs2D.FORCE_LEAFLET_CALIBRATION]=!0,h[i.Prefs2D.DISABLE_PDF_HIGHLIGHT]=!1,h[i.Prefs.PROGRESSIVE_RENDERING]=!0,h[i.Prefs.OPEN_PROPERTIES_ON_SELECT]=!1,h[i.Prefs.POINT_RENDERING]=!0,h[i.Prefs.BACKGROUND_COLOR_PRESET]=null,h[i.Prefs.REVERSE_MOUSE_ZOOM_DIR]=!1,h[i.Prefs.LEFT_HANDED_MOUSE_SETUP]=!1,h[i.Prefs.FUSION_ORBIT]=!0,h[i.Prefs.FUSION_ORBIT_CONSTRAINED]=!0,h[i.Prefs.WHEEL_SETS_PIVOT]=!1,h[i.Prefs.RESTORE_SESSION_MEASUREMENTS]=!0,h[i.Prefs.DISPLAY_UNITS]=new u(l.displayUnitsEnum),h[i.Prefs.DISPLAY_UNITS_PRECISION]=new u(l.displayUnitsPrecisionEnum),h[i.Prefs.KEY_MAP_CMD]=!0;var d=h,p={name:"Default",label:"Manufacturing (Default)",description:"Default Viewer settings"};p.settings=h,p.persistent=[i.Prefs3D.ALWAYS_USE_PIVOT,i.Prefs3D.ZOOM_TOWARDS_PIVOT,i.Prefs3D.REVERSE_HORIZONTAL_LOOK_DIRECTION,i.Prefs3D.REVERSE_VERTICAL_LOOK_DIRECTION,i.Prefs3D.ORBIT_PAST_WORLD_POLES,i.Prefs3D.CLICK_TO_SET_COI,i.Prefs3D.GHOSTING,i.Prefs3D.OPTIMIZE_NAVIGATION,i.Prefs3D.AMBIENT_SHADOWS,i.Prefs3D.ANTIALIASING,i.Prefs3D.GROUND_SHADOW,i.Prefs3D.GROUND_REFLECTION,i.Prefs3D.FIRST_PERSON_TOOL_POPUP,i.Prefs3D.BIM_WALK_TOOL_POPUP,i.Prefs3D.BIM_WALK_GRAVITY,i.Prefs3D.VIEW_TYPE,i.Prefs3D.SELECTION_MODE,i.Prefs2D.SWAP_BLACK_AND_WHITE,i.Prefs2D.LOADING_ANIMATION,i.Prefs.OPEN_PROPERTIES_ON_SELECT,i.Prefs.REVERSE_MOUSE_ZOOM_DIR,i.Prefs.LEFT_HANDED_MOUSE_SETUP,i.Prefs.WHEEL_SETS_PIVOT,i.Prefs.KEY_MAP_CMD,i.Prefs.DISPLAY_UNITS,i.Prefs.DISPLAY_UNITS_PRECISION],p.extensions={load:[],unload:[]};var f=v(p);f.name="AEC",f.label="Construction (AEC)",f.description="A common set of preferences designed for the Construction industry",f.settings[i.Prefs.REVERSE_MOUSE_ZOOM_DIR]=!0,f.settings[i.Prefs3D.EDGE_RENDERING]=!(0,a.isMobileDevice)(),f.settings[i.Prefs3D.LIGHT_PRESET]=(0,a.getGlobal)().DefaultLightPresetAec||"Boardwalk",f.settings[i.Prefs3D.ENV_MAP_BACKGROUND]=!0,f.settings[i.Prefs3D.VIEW_CUBE_COMPASS]=!0,f.settings[i.Prefs3D.SELECTION_SETS_PIVOT]=!0,f.extensions={load:[],unload:[]};var m=v(f);m.name="Fluent",m.label="Design Collaboration",m.description="User experience that matches Design Collaboration",m.settings[i.Prefs.WHEEL_SETS_PIVOT]=!0,m.settings[i.Prefs.RESTORE_SESSION_MEASUREMENTS]=!1,m.settings[i.Prefs2D.FORCE_PDF_CALIBRATION]=!0,m.settings[i.Prefs3D.ALWAYS_USE_PIVOT]=!0,m.settings[i.Prefs3D.ENABLE_CUSTOM_ORBIT_TOOL_CURSOR]=!1,m.extensions={load:[],unload:[]},m.persistent.splice(m.persistent.indexOf(i.Prefs3D.VIEW_TYPE),1);var g=v(f);function v(e){e||(r.logger.log("ProfileSettings.clone: missing profileSettings, using DefaultProfileSettings..."),e=p);var t={};return t.settings=Object.assign({},e.settings),t.extensions={},Object.prototype.hasOwnProperty.call(e,"extensions")?(t.extensions.load=Object.prototype.hasOwnProperty.call(e.extensions,"load")?e.extensions.load.slice():[],t.extensions.unload=Object.prototype.hasOwnProperty.call(e.extensions,"unload")?e.extensions.unload.slice():[]):t.extensions={load:[],unload:[]},t.persistent=e.persistent.slice(),t}g.name="Navis",g.label="Navisworks",g.description="Provides a user experience similar to Autodesk Navisworks desktop application",g.settings[i.Prefs3D.BIM_WALK_TOOL_POPUP]=!1,g.settings[i.Prefs3D.BIM_WALK_NAVIGATOR_TYPE]="aec",g.settings[i.Prefs3D.DEFAULT_NAVIGATION_TOOL_3D]="extractor_defined";var y={Default:p,AEC:f,Fluent:m,Navis:g,clone:v}},18588:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ProgressState:()=>i});var i={ROOT_LOADED:0,LOADING:1,RENDERING:2}},65522:(e,t,n)=>{"use strict";n.r(t),n.d(t,{PropertySet:()=>s});var i=n(51137);function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.map=t}var t,n,o;return t=e,(n=[{key:"forEach",value:function(e){if(e)for(var t in this.map)"__selected_dbIds__"!==t&&e(t,this.map[t])}},{key:"getAggregation",value:function(e){if(!e)return null;if("string"==typeof e&&(e=this.map[e]),0===e.length)return null;var t=e[0].type;if(!(0,i.OY)(t))return null;var n={average:0,count:0,max:0,median:0,min:0,mode:[],range:0,sum:0},r=e.map((function(e){return Number(e.displayValue)}));r.sort((function(e,t){return e-t}));var o={},a=0,s=0;r.forEach((function(e){s+=e,Object.prototype.hasOwnProperty.call(o,e)?o[e]++:o[e]=1,a=Math.max(a,o[e]),n.sum+=e})),n.count=r.length,n.average=s/n.count,n.max=r[n.count-1],n.min=r[0];var l=Math.ceil(n.count/2);for(var c in n.median=n.count%2&&n.count>1?(r[l]+r[l-1])/2:r[l-1],o)o[c]===a&&n.mode.push(Number(c));return n.range=n.max-n.min,n.sum=function(e,t){var n=t.displayValue.toString().split(".");if(1===n.length)return e;var i=e.toString().split(".");if(1===i.length)return e;var r=i[1],o=n[1];if(r===o)return e;var a=(o=o.match(/\d+/))&&o[0]&&o[0].length||t.precision||0;return Number(e.toFixed(a))}(n.sum,e[0]),n}},{key:"getValue2PropertiesMap",value:function(e){if(!e)return null;if("string"==typeof e&&(e=this.map[e]),!e||0===e.length)return null;var t={};return e.forEach((function(e){Object.prototype.hasOwnProperty.call(t,e.displayValue)||(t[e.displayValue]=[]),t[e.displayValue].push(e.parentName)})),t}},{key:"getValidIds",value:function(e,t){for(var n=Object.keys(this.map),i=[],r=0;r<n.length;r++){var o=n[r];if(e&&-1!==o.indexOf(e))i.push(o);else if(t){var a=o.split("/");if(a.length>=2&&a[0]===t){i.push(o);continue}}}return i}},{key:"getDbIds",value:function(){return this.map.__selected_dbIds__}},{key:"getVisibleKeys",value:function(){var e=[];return this.forEach((function(t,n){n[0].hidden||e.push(t)})),e}},{key:"getKeysWithCategories",value:function(){var e=[];return this.forEach((function(t,n){var i=!!n[0].hidden;n[0].displayCategory&&!i&&e.push(t)})),e}},{key:"merge",value:function(t){if(!(t instanceof e))return this;var n=t.map;for(var i in n){var o=n[i];if(Object.prototype.hasOwnProperty.call(this.map,i)){var a=this.map[i];if("__selected_dbIds__"!==i)for(var s=0;s<o.length;s++){for(var l=o[s],c=!0,u=0;u<a.length;u++){var h=a[u];l.displayValue!==h.displayValue||l.dbId!==h.dbId||(c=!1)}c&&a.push(l)}else this.map[i]=[].concat(r(a),r(o))}else this.map[i]=o}return this}}])&&a(t.prototype,n),o&&a(t,o),e}()},65663:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ScreenMode:()=>c,ScreenModeDelegate:()=>u,AppScreenModeDelegate:()=>h,ApplicationScreenModeDelegate:()=>d,NullScreenModeDelegate:()=>p,ScreenModeMixin:()=>f});var i=n(84998),r=n(37169),o=n(98926),a=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","MSFullscreenChange"];function s(e,t){for(var n=0;n<a.length;++n)t.addDocumentEventListener(a[n],e,!1)}function l(e,t){for(var n=0;n<a.length;++n)t.removeDocumentEventListener(a[n],e,!1)}var c={kNormal:0,kFullBrowser:1,kFullScreen:2};function u(e){this.viewer=e,this.bindFullscreenEventListener=this.fullscreenEventListener.bind(this),this.getMode()===c.kFullScreen&&s(this.bindFullscreenEventListener,this.viewer.globalManager)}function h(e){u.call(this,e)}u.prototype.uninitialize=function(){l(this.bindFullscreenEventListener,this.viewer.globalManager),this.viewer=null},u.prototype.isModeSupported=function(e){return!0},u.prototype.setMode=function(e){var t=this.getMode();return!(e===t||!this.isModeSupported(e))&&(this.doScreenModeChange(t,e),this.onScreenModeChanged(t,e),!0)},u.prototype.getMode=function(){throw"Implement getMode() in derived class"},u.prototype.getNextMode=function(){var e,t=this.getMode(),n=c;return t===n.kNormal&&this.isModeSupported(n.kFullBrowser)?e=n.kFullBrowser:t===n.kNormal&&this.isModeSupported(n.kFullScreen)||t===n.kFullBrowser&&this.isModeSupported(n.kFullScreen)?e=n.kFullScreen:t===n.kFullBrowser&&this.isModeSupported(n.kNormal)||t===n.kFullScreen&&this.isModeSupported(n.kNormal)?e=n.kNormal:t===n.kFullScreen&&this.isModeSupported(n.kFullBrowser)&&(e=n.kFullBrowser),e},u.prototype.getEscapeMode=function(){return this.getMode()!==c.kNormal?c.kNormal:void 0},u.prototype.fullscreenEventListener=function(){var e=this.viewer.globalManager.getDocument();(0,i.inFullscreen)(e)?this.viewer.resize():(this.doScreenModeChange(c.kFullScreen,c.kNormal),this.onScreenModeChanged(c.kFullScreen,c.kNormal))},u.prototype.doScreenModeChange=function(e,t){throw"Implement doScreenModeChange() in derived class"},u.prototype.onScreenModeChanged=function(e,t){e===c.kFullScreen?l(this.bindFullscreenEventListener,this.viewer.globalManager):t===c.kFullScreen&&s(this.bindFullscreenEventListener,this.viewer.globalManager),this.viewer.resize(),this.viewer.dispatchEvent({type:r.FULLSCREEN_MODE_EVENT,mode:t})},h.prototype=Object.create(u.prototype),h.prototype.constructor=h,h.prototype.isModeSupported=function(e){return e!==c.kFullBrowser},h.prototype.getMode=function(){var e=this.viewer.globalManager.getDocument();return(0,i.inFullscreen)(e)?c.kFullScreen:c.kNormal},h.prototype.doScreenModeChange=function(e,t){var n=this.viewer.container;if(t===c.kNormal){n.classList.remove("viewer-fill-browser");var r=this.viewer.globalManager.getDocument();(0,i.exitFullscreen)(r)}else t===c.kFullScreen&&(n.classList.add("viewer-fill-browser"),(0,i.launchFullscreen)(n))};var d=h;function p(e){u.call(this,e)}function f(){}p.prototype=Object.create(u.prototype),p.prototype.constructor=u,p.prototype.isModeSupported=function(){return!1},p.prototype.getMode=function(){return c.kNormal},f.prototype={setScreenModeDelegate:function(e){this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null),this.screenModeDelegateClass=e||(null===e?p:h)},getScreenModeDelegate:function(){return this.screenModeDelegate||(this.screenModeDelegate=new this.screenModeDelegateClass(this)),this.screenModeDelegate},isScreenModeSupported:function(e){return this.getScreenModeDelegate().isModeSupported(e)},canChangeScreenMode:function(){return this.isScreenModeSupported(Autodesk.Viewing.ScreenMode.kNormal)},setScreenMode:function(e){var t={category:"screen_mode",value:e};return o.logger.track(t),this.getScreenModeDelegate().setMode(e)},getScreenMode:function(){return this.getScreenModeDelegate().getMode()},nextScreenMode:function(){var e=this.getScreenModeDelegate().getNextMode();return void 0!==e&&this.setScreenMode(e)},escapeScreenMode:function(){var e=this.getScreenModeDelegate().getEscapeMode();return void 0!==e&&this.setScreenMode(e)},apply:function(e){var t=f.prototype;e.setScreenModeDelegate=t.setScreenModeDelegate,e.getScreenModeDelegate=t.getScreenModeDelegate,e.isScreenModeSupported=t.isScreenModeSupported,e.canChangeScreenMode=t.canChangeScreenMode,e.setScreenMode=t.setScreenMode,e.getScreenMode=t.getScreenMode,e.nextScreenMode=t.nextScreenMode,e.escapeScreenMode=t.escapeScreenMode}}},66904:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ScreenShot:()=>_});var i=n(92445),r=n(29747),o=n(29003),a=n(84998),s=n(44971),l=n(46759),c=n(27820),u=n(2727),h=n(16453),d=n(37169),p=n(98603);var f=function(e,t,n,d,f){for(var m=f.getMaterials(),g=f.glrenderer(),v=f.renderer(),y=f.modelQueue(),b=[],_=(d=d||{}).models||y.getModels(),x=0;x<_.length;x++){var E=_[x].getIterator();if(E&&E.getGeomScenes)for(var w=E.getGeomScenes(),S=0;S<w.length;S++){var A=w[S];A&&b.push(A)}}var M=d.camera||f.camera;M===f.camera&&(M=M.clone()),M.clientWidth=e,M.clientHeight=t;var T,C,P=new r.FrustumIntersector,L=d.excludeCutPlanes?[]:m.getCutPlanes();P.reset(M,L),P.areaCullThreshold=i.PIXEL_CULLING_THRESHOLD,g.pushViewport(),g.setPixelRatio(1),d.renderContext?T=d.renderContext:(T=new o.RenderContext).init(g,e,t,{offscreen:!0}),f.isSheetRendererNeeded()&&(C=d.sheetRenderer?d.sheetRenderer:new p.Z(f,T,g,m)),m.addOverrideMaterial("normalsMaterial_screenshot",T.getDepthMaterial()),m.addOverrideMaterial("edgeMaterial_screenshot",T.getEdgeMaterial());var R=d.renderConfig||v.getConfig();T.applyConfig(R),T.beginScene(f.scene,M,f.noLights,!0),g.popViewport(),g.setPixelRatio();for(var D=0,I=void 0,O={stop:function(){I&&((0,a.getGlobal)().clearTimeout(I),V())},finished:function(){return!!I}},N=-1,k=[],F=0;F<_.length;F++){var U=_[F];if(U.isLeaflet()){var B=U.getIterator();k.push({iter:B,viewId:B.registerView(),ready:!1})}}var V=function(){k.forEach((function(e){return e.iter.unregisterView(e.viewId)})),k.length=0},G=d.fragOptions,z=G?[]:void 0,H=function(){var e=void 0;if(d.models){e=new h.Box3;for(var t=0;t<_.length;t++){var n=_[t];e.union(n.getBoundingBox())}}else e=f.getVisibleBounds();var i=Object.prototype.hasOwnProperty.call(d,"is2d")?d.is2d:f.is2d,r=T.settings.deviceHeight,o=d.excludeCutPlanes?void 0:m.getCutPlanesRaw(),a=o&&o[0],s=_[0]&&_[0].getBoundingBox();return c.SceneMath.getPixelsPerUnit(M,i,e,r,a,s)}(),W=[],j=null,q=new h.Vector4(0,0,-1,-1e20),X=[],Y=null;return function i(){if(!function(){for(var e=!0,t=0;t<k.length;t++){var n=k[t];n.ready||(n.ready=n.iter.reset(P,M,n.viewId)),e=e&&n.ready}if(e=e||d.dontWaitForLeafletTiles)for(var i=0;i<k.length;i++){var r=k[i],o=r.iter.getScene(r.viewId);b.push(o)}return e}())I=(0,a.getGlobal)().setTimeout(i,0);else{var r=performance.now();g.pushViewport(),g.setPixelRatio(1),g.setViewport(0,0,e,t);var o,h,p=f.getPixelsPerUnit(f.camera,f.getVisibleBounds());if(m.updatePixelScale(H,e,t),d.excludeCutPlanes)!function(){var e=(Y=m.getCutPlanes()).length;if(X.length!==e){X.length=e;for(var t=0;t<e;t++)X[t]=q}v.toggleTwoSided(m.setCutPlanes(X))}();else null===(o=(h=f.api).syncCutPlanes)||void 0===o||o.call(h);d.beforeRender&&d.beforeRender();for(var y=function(){var e=b[D],t=_.find((function(t){var n;return t.id===(null===(n=e.frags)||void 0===n?void 0:n.modelId)}));if(null==t?void 0:t.is2d()){var n=t.getModelToViewerTransform(),i=n?n.getMaxScaleOnAxis():1;if(!f.is2d||1!==i){var o=t.getVisibleBounds(),a=T.settings.deviceWidth,h=T.settings.deviceHeight,p=c.SceneMath.getPixelsPerUnit(M,!0,o,h,null,o);m.updatePixelScaleForModel(t,p,a,h,i)}}if(function(e){if(G&&e instanceof s.RenderBatch){var t=e.frags;e.forEachNoMesh((function(e,n){z[n]=t.vizflags[e];var i=G.isFragOff&&G.isFragOff(e);void 0!==i&&t.setFlagFragment(e,l.MeshFlags.MESH_HIDE,i);var r=G.isFragVisible&&G.isFragVisible(e);void 0!==r&&t.setFlagFragment(e,l.MeshFlags.MESH_VISIBLE,r)}))}}(e),function(e){d.excludeThemingColors&&e instanceof s.RenderBatch&&(e.frags.is2d||(j=e.frags.db2ThemingColor,e.frags.db2ThemingColor=W))}(e),e instanceof s.RenderBatch&&e.applyVisibility(u.RenderFlags.RENDER_NORMAL,P),C&&e.frags.is2d?C.renderScenePart(e,!0,!0,!1,T):(T.renderScenePart(e,!0,!0,!1,!1),(e.frags&&!e.frags.areAllVisible()&&f.showGhosting||G)&&(e instanceof s.RenderBatch&&e.applyVisibility(u.RenderFlags.RENDER_HIDDEN,P),v.setEdgeColor(f.edgeColorGhosted),e.overrideMaterial=f.fadeMaterial,T.renderScenePart(e,!0,!0,!1,!1),v.setEdgeColor(f.edgeColorMain),e.overrideMaterial=null)),function(e){j&&(e.frags.db2ThemingColor=j,j=null)}(e),function(e){if(G&&e instanceof s.RenderBatch){var t=e.frags;e.forEachNoMesh((function(e,n){var i=z[n],r=!!(i&l.MeshFlags.MESH_HIDE),o=!!(i&l.MeshFlags.MESH_VISIBLE);t.setFlagFragment(e,l.MeshFlags.MESH_HIDE,r),t.setFlagFragment(e,l.MeshFlags.MESH_VISIBLE,o)}))}}(e),D++,performance.now()-r>20)return"break"};D<b.length;){if("break"===y())break}if(g.popViewport(),g.setPixelRatio(),m.updatePixelScale(p,v.settings.deviceWidth,v.settings.deviceHeight),d.excludeCutPlanes&&v.toggleTwoSided(m.setCutPlanes(Y)),d.afterRender&&d.afterRender(),D===b.length?function(){V();var e=T.getColorTarget();if((R.aoEnabled||R.antialias)&&(R.aoEnabled&&T.computeSSAO(),e=T.getNamedTarget("overlay"),T.getBlendPass().uniforms.tOverlay.value=null,T.setOffscreenTarget(e),T.presentBuffer()),d.returnAsTarget)n(T,e,M,C);else{var t;d.sheetRenderer||(null===(t=C)||void 0===t||t.destroy(),C=null),T.targetToCanvas(e).canvas.toBlob((function(e){var t=(0,a.getGlobal)().URL.createObjectURL(e);n&&n(t)}))}}():I=(0,a.getGlobal)().setTimeout(i,0),d.onProgress){var x=Math.floor(100*D/b.length);x!==N&&(N=x,d.onProgress(x))}}}(),O},m=function(e,t,n,i,r){var o=r.fullPage,s=r.bounds,l=r.getCropBounds,c=r.margin,u=r.overlayRenderer,d=r.overlayRendererExtraOptions;o&&(s=e.impl.getVisibleBounds());var p=e.impl.getCanvasBoundingClientRect().width,m=e.navigation.getCamera();s&&(m=b(e,s,c));var y=g(e,m);try{if(o){var _=y.getSize(new h.Vector3),x=p/Math.max(_.x,_.y);t=Math.floor(t*x),n=Math.floor(n*x)}var E=function(r){if(o){var c=t/p;y.min.x*=c,y.min.y*=c,y.max.x*=c,y.max.y*=c,v(r,y,i)}else if(l){var u=l(e,m,s);v(r,u,i)}else r.toBlob((function(e){var r=(0,a.getGlobal)().URL.createObjectURL(e);i(r,t,n)}))},w=e.impl.selector.getSelection();return e.clearSelection(),f(t,n,(function(i,r,o){if(e.impl.selector.setSelection(w),u){u(e,{width:t,height:n,ctx:i,target:r,screenshotCamera:o,onRenderDone:E},d)}else{var a=i.targetToCanvas(r).canvas;E(a)}}),{returnAsTarget:!0,camera:m},e.impl)}catch(e){console.error("getScreenShot error: "+e),i(null)}},g=function(e,t){var n=e.impl.getVisibleBounds(void 0,void 0,void 0,!0),i=e.worldToClient(n.min,t),r=e.worldToClient(n.max,t);return(new h.Box3).setFromPoints([i,r])},v=function(e,t,n){var i=(0,a.getGlobal)().document.createElement("canvas"),r=i.getContext("2d"),o=t.getSize(new h.Vector3),s=Math.min(Math.floor(o.x),e.width),l=Math.min(Math.floor(o.y),e.height);i.width=s,i.height=l;var c=Math.max(Math.floor(t.min.x),0),u=Math.max(Math.floor(t.min.y),0),d=s,p=l;r.drawImage(e,c,u,d,p,0,0,s,l),i.toBlob((function(e){var t=(0,a.getGlobal)().URL.createObjectURL(e);n(t,s,l)}),"image/png")},y=function(e,t,n,i){var r=(0,a.getGlobal)().document.createElement("canvas"),o=r.getContext("2d"),s=new Image;r.width=t,r.height=n,s.src=e,s.onload=function(){o.drawImage(s,0,0,t,n);var e=r.toDataURL("image/png");i(e)}},b=function(e,t,n){n=n||e.navigation.FIT_TO_VIEW_HORIZONTAL_MARGIN;var i={horizontal:e.navigation.FIT_TO_VIEW_HORIZONTAL_MARGIN,vertical:e.navigation.FIT_TO_VIEW_VERTICAL_MARGIN};e.navigation.FIT_TO_VIEW_HORIZONTAL_MARGIN=n,e.navigation.FIT_TO_VIEW_VERTICAL_MARGIN=n;var r=e.getState({viewport:!0});e.navigation.fitBounds(!0,t,!1,!0);var o=e.navigation.getCamera().clone();return e.restoreState(r,void 0,!0),e.navigation.FIT_TO_VIEW_HORIZONTAL_MARGIN=i.horizontal,e.navigation.FIT_TO_VIEW_VERTICAL_MARGIN=i.vertical,e.impl.updateNearFarValues(o,t),o},_={getScreenShotLegacy:function(e,t,n,i,r){var o=e.impl,s=o.renderer(),l=s.settings.logicalWidth,c=s.settings.logicalHeight,u=o.progressiveRender,p=o.glrenderer().getPixelRatio();t&&n||(t=l,n=c),o.progressiveRender=!1,o.resize(t/p,n/p,!0),o.tick(performance.now());var f=new h.WebGLRenderTarget(t,n,{minFilter:h.LinearFilter,magFilter:h.LinearFilter,format:h.RGBFormat,type:h.UnsignedByteType}),m=s.getOffscreenTarget();function g(){var e=s.targetToCanvas(f||s.getColorTarget());function t(){o.progressiveRender=u,o.resize(l,c,!0),e.canvas.toBlob((function(e){var t=(0,a.getGlobal)().URL.createObjectURL(e);i?i(t):(0,a.getGlobal)().open(t)}),"image/png")}f&&(f.dispose(),f=void 0,o.glrenderer().setRenderTarget(null)),r?r(e.ctx,t):t()}if(s.setOffscreenTarget(f),s.presentBuffer(),s.setOffscreenTarget(m),e.model.isLeaflet()){var v=!1,y=function(){v=!0,o.progressiveRender=u,o.resize(l,c,!0)};e.addEventListener(d.CANCEL_LEAFLET_SCREENSHOT,y,{once:!0}),o.invalidate(!0),e.model.getIterator().callWhenRefined((function(){v||(e.removeEventListener(d.CANCEL_LEAFLET_SCREENSHOT,y),g())}))}else g();f&&f.dispose()},getScreenShot:f,getScreenShotWithBounds:m,getScreenShotAtScreenSize:function(e,t,n){var i=e.impl.getCanvasBoundingClientRect(),r=Math.floor(i.width),o=Math.floor(i.height);m(e,r,o,(function(e,n,i){e?y(e,n,i,(function(e){t(e,n,i)})):t(null)}),n)},getSceneClientBounds:g,cropImage:v,blobToImage:y,makeBoundsSquare:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e.getSize(new h.Vector3),i=Math.max(n.x,n.y,t);e.expandByVector(new h.Vector3((i-n.x)/2,(i-n.y)/2,0))},getCameraWithFitBounds:b}},76079:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Thumbnails:()=>l});var i=n(19255),r=n(58964),o=n(57601),a=n(84998),s=n(26261);var l={getUrlForBubbleNode:function(e,t){if(!e)return Promise.reject(new Error("Missing instance of BubbleNode"));var n=e.findParentGeom2Dor3D();if(!n)return Promise.reject(new Error("No thumbnail available."));var l=(t=t||{}).size||200;return e.getRootNode().data.isVectorPDF||n.data.isVectorPDF?new Promise((function(t){var n=e.data,r=e.getRootNode().data.getPDF(),o=l,s=l,c="".concat(n.guid,"/thumbnail/").concat(o,"x").concat(s);!function(e,t,n,r,o,s){var l=i.LocalStorage.getItem(o);l?s(l):e.getPage(t).then((function(e){var t=(0,a.getGlobal)().document.createElement("canvas");t.width=n,t.height=r;var l=t.getContext("2d"),c={scale:1},u=e.getViewport(c),h=Math.min(t.width/u.width,t.height/u.height);e.render({canvasContext:l,viewport:e.getViewport({scale:h})}).promise.then((function(){e.cleanup(),t.toBlob((function(e){var t=new FileReader;t.readAsDataURL(e),t.onloadend=function(){i.LocalStorage.setItem(o,t.result),s(t.result)}}),"image/png")}))}))}(r,n.page,o,s,c,t)})):new Promise((function(t,n){var i=e.getRootNode(),c={urn:i.urn(),width:l,height:l,guid:encodeURIComponent(e.guid()),acmsession:r.endpoint.getAcmSession()},u={responseType:"blob",skipAssetCallback:!0,size:l,guid:c.guid,acmsession:c.acmSession},h="urn:"+c.urn;e.data.thumbnailUrn&&(h=i.getDocument().getFullPath(e.data.thumbnailUrn));var d=void 0;if(!(0,a.getGlobal)().USE_OTG_DS_PROXY){var p=(0,r.getEnv)();d=s.EnvironmentConfigurations[p].UPSTREAM;var f=(0,s.getUpstreamApiData)(p,r.endpoint.getApiFlavor());u.apiData=f}o.ViewingService.getThumbnail((0,r.initLoadContext)({endpoint:d}),h,(function(e){var n=new FileReader;n.onload=function(e){var n=e.target.result;t(n)},n.readAsDataURL(e)}),(function(){n(new Error("Thumbnail is unavailable."))}),u)}))}}},24327:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Viewer3D:()=>he,waitForCompleteLoad:()=>de});var i=n(16453),r=n(84998),o=n(98926),a=n(41772),s=n(55412),l=n(50041),c=n(5130),u=n(9322),h=n(17167),d=n(79659),p=n(62546),f=n(11294),m=n(65663),g=n(61445),v=n(3260),y=n(10831),b=n(49083),_=n(25406),x=n(26099),E=n(33317),w=n(71224),S=n(37169),A=n(50411),M=n(8283),T=n(59823),C=n(80401),P=n(79757),L=n(20313),R=n(77368),D=n(87289),I=n(9487),O=n(35449);function N(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function F(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var U=416,B=1e3,V=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewer=t,this.setGlobalManager(this.viewer.globalManager),this.domElement=null,this._step=this._step.bind(this)}var t,n,i;return t=e,n=[{key:"createDom",value:function(e){var t=this,n=this.getDocument();this.domElement=n.createElement("div"),this.domElement.className="forge-spinner",this._initTransform="translate(-50%, -50%) scale(".concat(.5,")"),this.domElement.style.transform=this._initTransform.slice();var i=this._createSvgElement("svg");i.setAttribute("width","242"),i.setAttribute("height","242"),i.setAttribute("viewBox","0 0 ".concat(72," ").concat(72)),i.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.domElement.appendChild(i);var r=this._createWheelPointData(10,72,6.75);this._createMask(r);var o=this._createSvgElement("polygon");o.setAttribute("mask","url(#mask)"),i.appendChild(o),this._addPoints(r.outerPoints,o),this._createSegments(r);var a=n.createElement("img");return a.src=Autodesk.Viewing.Private.getResourceUrl("res/ui/forge-logo.png"),this._onResize=this._onResize.bind(this),a.onload=function(){t._onResize(),t._initResize=!0,t.viewer.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,t._onResize)},this.domElement.appendChild(a),e&&e.appendChild(this.domElement),this.domElement.style.display="none",this.domElement}},{key:"_createSvgElement",value:function(e){return this.getDocument().createElementNS("http://www.w3.org/2000/svg",e)}},{key:"_getSvg",value:function(){return null==this?void 0:this.domElement.getElementsByTagNameNS("http://www.w3.org/2000/svg","svg")[0]}},{key:"_createMask",value:function(e){var t=this._getSvg(),n=this._createSvgElement("defs"),i=this._createSvgElement("mask");i.id="mask",n.appendChild(i),t.appendChild(n);var r=this._createSvgElement("polygon");r.style.opacity=.15,r.style.fill="#FFF",i.appendChild(r),this._addPoints(e.outerPoints,r);var o=this._createSvgElement("polygon");i.appendChild(o),this._addPoints(e.innerPoints,o)}},{key:"_step",value:function(e){this.startTime||(this.startTime=e);var t=(e-this.startTime)%B;this._setSegmentOpacities(t);var n=this.getWindow();this._animId=n.requestAnimationFrame(this._step)}},{key:"_stop",value:function(){this._animId&&(this.getWindow().cancelAnimationFrame(this._animId),this._animId=null)}},{key:"_setSegmentOpacities",value:function(e){var t=this;this.segments.forEach((function(n,i){var r=Math.abs(i-t.segments.length)-1;n.style.opacity=t._getSegmentOpacity(r,e)}))}},{key:"_getSegmentOpacity",value:function(e,t){var n=e*(B/this.segments.length);return n+U>B&&t<U?-1*((t+B-n)/U-1):t<n||t>n+U?0:Math.abs((t-n)/U-1)}},{key:"_getSegments",value:function(){return Array.from(this.domElement.querySelectorAll(".segment"))}},{key:"_addPoints",value:function(e,t){var n,i=N(e);try{for(i.s();!(n=i.n()).done;){var r=n.value,o=this._getSvg().createSVGPoint();o.x=r[0],o.y=r[1],t.points.appendItem(o)}}catch(e){i.e(e)}finally{i.f()}}},{key:"_createWheelPointData",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,i=t/2,r=t/2,o=t/2,a={outerPoints:[],innerPoints:[]},s=1;s<=e;s++)a.outerPoints.push([r+i*Math.cos(2*s*Math.PI/e),o+i*Math.sin(2*s*Math.PI/e)]),a.innerPoints.push([r+(i-n)*Math.cos(2*s*Math.PI/e),o+(i-n)*Math.sin(2*s*Math.PI/e)]);return a}},{key:"_createSegments",value:function(e){for(var t=this,n=e.outerPoints,i=e.innerPoints,r=this._getSvg(),o=function(e,n){var i=t._createSvgElement("polygon");G(i,"segment"),G(i,n),t._addPoints(e,i),r.appendChild(i)},a=n.length-1;a>=0;--a){var s=n[a],l=n[a-1],c=i[a],u=i[a-1];0===a&&(l=n[n.length-1],u=i[n.length-1]),o([s,l,c],"light-blue"),o([c,u,l],"dark-blue")}}},{key:"_fadeOut",value:function(){var e=this,t=1,n=setInterval((function(){var i;(null===(i=e.domElement)||void 0===i?void 0:i.style)?(t<=.1&&(clearInterval(n),e.domElement.style.display="none"),e.domElement.style.opacity=t,t-=.1*t):clearInterval(n)}),1)}},{key:"show",value:function(){this.domElement&&(this.domElement.style.display="block",this.domElement.style.opacity=1,this.segments=this._getSegments(),this._step(1))}},{key:"hide",value:function(){var e=this;if(this.domElement){this._hide=function(t){e._stop(),t.model.is3d()?e._fadeOut():(e.domElement.style.opacity=0,e.domElement.style.display="none")};var t=this.viewer.impl.modelQueue().getModels();0===t.length?this.viewer.addEventListener(Autodesk.Viewing.MODEL_ADDED_EVENT,this._hide,{once:!0}):this._hide({model:t[0]})}}},{key:"destroy",value:function(){var e;this._stop(),(null===(e=this.domElement)||void 0===e?void 0:e.parentElement)&&this.domElement.parentElement.removeChild(this.domElement),this.domElement=null,this.viewer.removeEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this._onResize)}},{key:"_onResize",value:function(){var e,t;if(this._initResize)this._initResize=!1;else{var n=this.domElement;if(n&&"none"!=n.style.display){var i=n.parentElement;if(i){var r=i.getBoundingClientRect(),o=n.getBoundingClientRect(),a=Math.max(o.width/r.width,(o.height+350)/r.height),s=null===(e=this.domElement)||void 0===e||null===(t=e.style)||void 0===t?void 0:t.transform;if(s)if(a>.8){var l=/[-+]?scale\(\d*\.\d+|\d+\)/,c=l.exec(s);if(c.length>0){var u=c[0].split("scale(")[1],h=Number((u/a).toFixed(4)),d=s.replace(l,"scale(".concat(h));d!=this.domElement.style.transform&&h<=.5&&h>.2&&(this.domElement.style.transform=d)}}else this.domElement.style.transform!=this._initTransform&&(this.domElement.style.transform=this._initTransform)}}}}}],n&&F(t.prototype,n),i&&F(t,i),e}();function G(e,t){if(e.classList)e.classList.add(t);else{var n=e.getAttribute("class")||"";n=n.split(" ").includes(t)?n:"".concat(n," ").concat(t),e.setAttribute("class",n)}}function z(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}O.GlobalManagerMixin.call(V.prototype);var H=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.domElement=null}var t,n,i;return t=e,(n=[{key:"createDom",value:function(e){var t=this.getDocument(),n=t.createElement("div");n.className="spinner",e&&e.appendChild(n);for(var i=1;i<=3;i++){var r=t.createElement("div");r.className="bounce"+i,n.appendChild(r)}return this.domElement=n,this.hide(),n}},{key:"show",value:function(){this.domElement&&(this.domElement.style.display="block")}},{key:"hide",value:function(){this.domElement&&(this.domElement.style.display="None")}},{key:"destroy",value:function(){this.domElement=null}}])&&z(t.prototype,n),i&&z(t,i),e}();O.GlobalManagerMixin.call(H.prototype);var W=n(27820),j=n(66904);const q=Object.freeze({pdf:"Autodesk.PDF",scalaris:"Autodesk.Scalaris",dwf:"Autodesk.DWF",dwfx:"Autodesk.DWF",rcp:"Autodesk.ReCap",gltf:"Autodesk.glTF",glb:"Autodesk.glTF"});var X=n(12032),Y=n(27800),K=n(95018),Z=n(44669),J=n(21319),Q=n(58964);function $(e,t,n,i){var r={url:e,lmvFileExtension:t,returnValue:n};if(i){r.isOtg=i.isOtg()&&Q.endpoint.isOtgBackend(),r.isSVF2=i.isSVF2()&&Q.endpoint.isSVF2Backend(),r.geometrySize=i.data.size||0,r.viewable_type=i.is2D()?"2d":"3d";var o=i.findViewableParent();try{var a=o&&o.name(),s=a&&a.lastIndexOf("."),l=s>=0&&a.substring(s+1);l&&(r.seedFileExt=l.toLowerCase())}catch(e){}}return r}function ee(e){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(e)}function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ne(e,t){return ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ne(e,t)}function ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=oe(e);if(t){var r=oe(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return re(this,n)}}function re(e,t){return!t||"object"!==ee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oe(e){return oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},oe(e)}var ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ne(e,t)}(n,e);var t=ie(n);function n(e,i){var r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),o=t.call(this,e,i);var a=(te(r={},s.Prefs3D.VIEW_CUBE,(function(t){e.getExtension("Autodesk.ViewCubeUi",(function(e){e.displayViewCube(t)}))})),te(r,s.Prefs3D.ALWAYS_USE_PIVOT,e.setUsePivotAlways.bind(e)),te(r,s.Prefs3D.ORBIT_PAST_WORLD_POLES,e.setOrbitPastWorldPoles.bind(e)),te(r,s.Prefs3D.ZOOM_TOWARDS_PIVOT,e.setZoomTowardsPivot.bind(e)),te(r,s.Prefs.REVERSE_MOUSE_ZOOM_DIR,e.setReverseZoomDirection.bind(e)),te(r,s.Prefs.LEFT_HANDED_MOUSE_SETUP,e.setUseLeftHandedInput.bind(e)),te(r,s.Prefs3D.CLICK_TO_SET_COI,e.setClickToSetCOI.bind(e)),te(r,s.Prefs.ZOOM_DRAG_SPEED,(function(t){var n,i=e.toolController.getTool("dolly");null==i||null===(n=i.setDollyDragScale)||void 0===n||n.call(i,t)})),te(r,s.Prefs.ZOOM_SCROLL_SPEED,(function(t){var n,i=e.toolController.getTool("dolly");null==i||null===(n=i.setDollyScrollScale)||void 0===n||n.call(i,t)})),te(r,s.Prefs3D.ANTIALIASING,(function(t){return e.setQualityLevel(o.get("ambientShadows"),t)})),te(r,s.Prefs3D.AMBIENT_SHADOWS,(function(t){return e.setQualityLevel(t,e.prefs.get("antialiasing"))})),te(r,s.Prefs3D.GROUND_SHADOW,e.setGroundShadow.bind(e)),te(r,s.Prefs3D.GROUND_REFLECTION,e.setGroundReflection.bind(e)),te(r,s.Prefs2D.SWAP_BLACK_AND_WHITE,e.setSwapBlackAndWhite.bind(e)),te(r,s.Prefs3D.OPTIMIZE_NAVIGATION,e.setOptimizeNavigation.bind(e)),te(r,s.Prefs.PROGRESSIVE_RENDERING,e.setProgressiveRendering.bind(e)),te(r,s.Prefs.GHOSTING,e.setGhosting.bind(e)),te(r,s.Prefs3D.LINE_RENDERING,(function(t){return e.hideLines(!t)})),te(r,s.Prefs.POINT_RENDERING,(function(t){return e.hidePoints(!t)})),te(r,s.Prefs3D.EDGE_RENDERING,e.setDisplayEdges.bind(e)),te(r,s.Prefs3D.ENV_MAP_BACKGROUND,e.setEnvMapBackground.bind(e)),te(r,s.Prefs3D.LIGHT_PRESET,e.setLightPreset.bind(e)),r);return Object.keys(a).forEach((function(e){o.addListeners(e,a[e])})),o}return n}(n(91217).Preferences);function se(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}var le=Autodesk.Viewing;var ce=0,ue=["markups-svg","pushpin-container"];function he(e,t){if(this.setGlobalManager(new Y.GlobalManager),e){if(this.clientContainer=e,this.container=this.getDocument().createElement("div"),this.container.classList.add("adsk-viewing-viewer"),this.container.style.height="100%",this.container.style.width="100%",this.container.style.overflow="hidden",this.container.classList.add((0,r.isTouchDevice)()?"touch":"notouch"),this.clientContainer.appendChild(this.container),this.config=t||{},this.contextMenu=null,this.contextMenuCallbacks={},this.started=!1,this.theme=this.config.theme||"dark-theme",this.container.classList.add(this.theme),this.containerLayerOrder=this.config.containerLayerOrder||ue,(0,r.isChrome)()&&this.container.classList.add("quality-text"),"CANVAS"===this.container.nodeName)throw"Viewer must be initialized on a div [temporary]";if(this.canvasWrap=this.getDocument().createElement("div"),this.canvasWrap.classList.add("canvas-wrap"),this.canvas=this.getDocument().createElement("canvas"),this.canvas.tabIndex=0,this.canvas.setAttribute("data-viewer-canvas","true"),this.canvasWrap.appendChild(this.canvas),this.container.appendChild(this.canvasWrap),!(0,r.isPhoneFormFactor)()&&!le.Private.DISABLE_FORGE_LOGO&&!le.Private.DISABLE_FORGE_CANVAS_LOGO){var n=this.getDocument();this._forgeLogo=n.createElement("div"),this._forgeLogo.classList.add("forge-logo-canvas");var i=n.createElement("img");i.src=Autodesk.Viewing.Private.getResourceUrl("res/ui/forge-logo-canvas.png"),this._forgeLogo.appendChild(i),this._forgeLogo.style.display="none",this.container.appendChild(this._forgeLogo)}this.canvas.viewer=this}var o=t&&t.localStoragePrefix||"Autodesk.Viewing.Private.GuiViewer3D.SavedSettings.";o.endsWith(".")||(o+=".");var a={prefix:o,localStorage:!(0,r.isNodeJS)()};this._displayEdges=null,this._setDoubleSided=null,this.prefs=new ae(this,a),this.profile=null,this.profileManager=new u.ProfileManager,this._hotkeyManager=new v.HotkeyManager,this.extensionCache=null,this.running=!1,this._pushedTool="",this._defaultNavigationTool="",this.id=ce++,this.impl=new L.Viewer3DImpl(this.canvas,this),this.overlays=new X.OverlayManager(this.impl),this._loadingSpinner=le.Private.DISABLE_FORGE_LOGO?new H:new V(this),this._loadingSpinner.setGlobalManager(this.globalManager),this.trackADPTimer=[]}function de(e,t){return new Promise((function(n,i){var r=0;function o(t){2===r&&n({viewer:e,model:t})}e.addEventListener(S.GEOMETRY_LOADED_EVENT,(function n(a){a.model.getData().loadOptions.bubbleNode===t.bubbleNode&&(e.removeEventListener(S.GEOMETRY_LOADED_EVENT,n),r++,t.skipPropertyDb?o(a.model):a.model.getProperties(1,(function(){return o(a.model)}),(function(e){return i(e)})))})),e.addEventListener(S.TEXTURES_LOADED_EVENT,(function n(i){i.model.getData().loadOptions.bubbleNode===t.bubbleNode&&(e.removeEventListener(S.TEXTURES_LOADED_EVENT,n),r++,o(i.model))}))}))}p.EventDispatcher.prototype.apply(he.prototype),m.ScreenModeMixin.prototype.apply(he.prototype),g.ExtensionMixin.prototype.apply(he.prototype),O.GlobalManagerMixin.call(he.prototype),he.prototype.constructor=he,Object.defineProperty(he.prototype,"model",{get:function(){var e;return null===(e=this.impl)||void 0===e?void 0:e.model},set:function(){throw"Do not set viewer.model"}}),he.ViewerCount=0,he.kDefaultCanvasConfig={click:{onObject:["selectOnly"],offObject:["deselectAll"]},clickAlt:{onObject:["setCOI"],offObject:["setCOI"]},clickCtrl:{onObject:["selectToggle"]},clickShift:{onObject:["selectToggle"]},disableSpinner:!1,disableMouseWheel:!1,disableTwoFingerSwipe:!1},Object.defineProperty(he.prototype,"scene",{get:function(){return this.impl.scene},set:function(){throw"Do not set viewer.scene"}}),Object.defineProperty(he.prototype,"sceneAfter",{get:function(){return this.impl.sceneAfter},set:function(){throw"Do not set viewer.sceneAfter"}}),he.createHeadlessViewer=function(){var e=new he;return e.impl.initialize(),e.impl.setLightPreset(0),e},he.prototype.start=function(e,t,n,i,r){if(this.started)return 0;this.started=!0;var o=this,a=o.initialize(r);return 0!==a?(i&&setTimeout((function(){i(a)}),1),a):(setTimeout((function(){o.setUp(o.config)}),1),e&&this.loadModel(e,t,n,i),0)},he.prototype.startWithDocumentNode=function(e,t,n){var i=this;return new Promise((function(r,o){if(i.started)return 0;i.started=!0;var a=i.initialize();0===a?(setTimeout((function(){i.setUp(i.config)}),1),i.loadDocumentNode(e,t,n).then(r).catch(o)):setTimeout((function(){o(a)}),1)}))},he.prototype.registerUniversalHotkeys=function(){var e,t,n,i=this;e=function(){return i.navigation.setRequestFitToView(!0),J.analytics.track("viewer.fit_to_view",{from:"Keyboard"}),!0},i._hotkeyManager.pushHotkeys("Autodesk.FitToView",[{keycodes:[I.KeyCode.f],onPress:e}]),e=function(){return i.navigation.setRequestHomeView(!0),!0},i._hotkeyManager.pushHotkeys("Autodesk.Home",[{keycodes:[I.KeyCode.h],onPress:e},{keycodes:[I.KeyCode.HOME],onPress:e}]),t=function(){return i.objectContextMenu&&i.objectContextMenu.hide()||i.dispatchEvent({type:S.ESCAPE_EVENT}),!0},i._hotkeyManager.pushHotkeys("Autodesk.Escape",[{keycodes:[I.KeyCode.ESCAPE],onRelease:t}]),e=function(){return n=i.getActiveNavigationTool(),i.setActiveNavigationTool("pan")},t=function(){return i.setActiveNavigationTool(n)};var r=[{keycodes:[I.KeyCode.SHIFT],onPress:e,onRelease:t},{keycodes:[I.KeyCode.SPACE],onPress:e,onRelease:t}];i._hotkeyManager.pushHotkeys("Autodesk.Pan",r,{tryUntilSuccess:!0})},he.prototype.createControls=function(){var e=this,t=this,n=t.impl;return t.navigation=new y.Navigation(n.camera),t.__initAutoCam(n),t.utilities=new _.ViewingUtilities(n,t.autocam,t.navigation),t.clickHandler=new x.DefaultHandler(n,t.navigation,t.utilities),t.toolController=new b.ToolController(n,t,t.autocam,t.utilities,t.clickHandler),t.toolController.registerTool(new E.GestureHandler(t)),t.toolController.registerTool(t._hotkeyManager),t.toolController.activateTool(t._hotkeyManager.getName()),t.registerUniversalHotkeys(),t.toolController.registerTool(new C.OrbitDollyPanTool(n,t,this.config.navToolsConfig),(function(t){t||e.setActiveNavigationTool()})),t.toolController.setModalityMap({section:{explode:!1,pan:!1,dolly:!1},explode:{section:!1,pan:!1,dolly:!1},measure:{"box-selection":!1},calibration:{"box-selection":!1},orbit:{},dolly:{},pan:{},fov:{},bimwalk:{},"box-selection":{measure:!1,calibration:!1}}),t.toolController},he.prototype.initialize=function(e){this.setScreenModeDelegate(this.config?this.config.screenModeDelegate:void 0);var t=this.getDimensions();if(this.canvas.width=t.width,this.canvas.height=t.height,(0,r.isIOSDevice)()&&this.getWindow().devicePixelRatio&&(this.canvas.width/=this.getWindow().devicePixelRatio,this.canvas.height/=this.getWindow().devicePixelRatio),this.impl.initialize(e),!this.impl.glrenderer()){var n=function(){if(le.getGlobal().WebGLRenderingContext){for(var e=le.getGlobal().document.createElement("canvas"),t=["webgl","experimental-webgl","moz-webgl","webkit-3d"],n=!1,i=0;i<4;i++)try{if((n=e.getContext(t[i]))&&"function"==typeof n.getParameter)return 1}catch(e){}return 0}return-1}();if(n<=0)return-1===n?d.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED:d.ErrorCodes.BROWSER_WEBGL_DISABLED}var i,o=this;(0,r.isIOSDevice)()?this.onResizeCallback=function(){clearTimeout(i),i=setTimeout(o.resize.bind(o),500)}:this.onResizeCallback=function(){var e=o.impl.camera.clientWidth,t=o.impl.camera.clientHeight,n=o.container.clientWidth,i=o.container.clientHeight;e===n&&t===i||o.resize()};this.addWindowEventListener("resize",this.onResizeCallback,!1),this.onScrollCallback=function(){o.impl.canvasBoundingclientRectDirty=!0},this.addWindowEventListener("scroll",this.onScrollCallback),this.initContextMenu(),this.localize(),this.impl.controls=this.createControls(),this.initializePrefListeners(),this.setDefaultNavigationTool("orbit"),this.impl.controls&&this.impl.controls.setAutocam(this.autocam);var a=this.config&&this.config.canvasConfig?this.config.canvasConfig:he.kDefaultCanvasConfig;this.setCanvasClickBehavior(a),a.disableSpinner||(this.loadSpinner=this._loadingSpinner.createDom(this.container)),this.viewerState=new T.ViewerState(this),this.config&&Object.prototype.hasOwnProperty.call(this.config,"startOnInitialize")&&!this.config.startOnInitialize||this.run();var s=le.getGlobal();return s.NOP_VIEWER||(s.NOP_VIEWER=this),s.NOP_VIEWERS=s.NOP_VIEWERS||[],s.NOP_VIEWERS.push(this),this.addEventListener(S.MODEL_ADDED_EVENT,(function(e){o.onModelAdded(e.model,e.preserveTools)})),this.addEventListener(S.GEOMETRY_LOADED_EVENT,(function(e){var t,n;e.model.is2d()&&!e.model.isLeaflet()&&o.navigation.setMinimumLineWidth(null===(t=e.model.loader)||void 0===t||null===(n=t.svf)||void 0===n?void 0:n.minLineWidth);var i=e.model.getGeometryList().geoms;e.model.hasEdges=!1;for(var r=0;r<i.length;r++){var a=i[r];if(a&&(a.isLines||a.iblines)){e.model.hasEdges=!0;break}}})),this.dispatchEvent(S.VIEWER_INITIALIZED),this.trackADPSettingsOptions(),this.trackADPExtensionsLoaded(),he.ViewerCount++,0},he.prototype.setUp=function(e){if(this.config=e||{},this.config.extensions=this.config.extensions||[],Array.isArray(this.config.extensions))for(var t=this.config.extensions,n=0;n<t.length;++n)this.loadExtension(t[n],this.config);this.loadExtension("Autodesk.Viewing.MixpanelExtension"),"true"===(0,h.getParameterByName)("lmv_viewer_debug")&&this.loadExtension("Autodesk.Debug",this.config);var i=this.config.canvasConfig||he.kDefaultCanvasConfig;this.setCanvasClickBehavior(i),this._onAggregatedSelectionChanged=this._onAggregatedSelectionChanged.bind(this),this.addEventListener(S.AGGREGATE_SELECTION_CHANGED_EVENT,this._onAggregatedSelectionChanged)},he.prototype.tearDown=function(){if(this.clearSelection(),this.removeEventListener(S.AGGREGATE_SELECTION_CHANGED_EVENT,this._onAggregatedSelectionChanged),this.loadedExtensions){for(var e in this.loadedExtensions)try{this.unloadExtension(e)}catch(t){o.logger.error("Failed to unload extension: "+e,t,(0,d.errorCodeString)(d.ErrorCodes.VIEWER_INTERNAL_ERROR)),o.logger.track({category:"error_unload_extension",extensionId:e,error_message:t.message,call_stack:t.stack})}this.loadedExtensions=null}for(this.toolController&&(this.toolController.enableMouseButtons(!1),this.toolController.deactivateTool("gestures")),o.logger.reportRuntimeStats(!0),this._loadingSpinner.show(),this.liveReviewClient&&(this.liveReviewClient.destroy(),this.liveReviewClient=null);this.trackADPTimer.length>0;)clearTimeout(this.trackADPTimer.pop());this.impl.unloadCurrentModel(),this.impl.setCutPlaneSet("__set_view",void 0)},he.prototype._onAggregatedSelectionChanged=function(){if(this.navigation.getSelectionSetsPivot()){var e=this.impl.selector.getAggregateSelection();if(e.length){var t=this.impl.get3DBounds(e);this.utilities.setPivotPoint(t.getCenter(new i.Vector3),!0,!0),this.utilities.pivotActive(this.navigation.getPivotSetFlag(),!0)}}},he.prototype.run=function(){this.running||(this.resize(),this.running=!0,this.impl.run())},he.prototype.localize=function(){w.Z.localize()},he.prototype.__initAutoCam=function(e){var t=this,n=e.camera;n.pivot||(n.pivot=new i.Vector3(0,0,0)),n.target||(n.target=new i.Vector3(0,0,0)),n.worldup||(n.worldup=n.up.clone()),t.autocamCamera=n.clone(),t.autocamCamera.target=n.target.clone(),t.autocamCamera.pivot=n.pivot.clone(),t.autocamCamera.worldup=n.worldup.clone(),t.autocam=new P.Autocam(t.autocamCamera,t.navigation,t.canvas),t.autocam.setGlobalManager(this.globalManager),t.autocam.registerCallbackCameraChanged((function(e){t.autocamCamera.isPerspective!==n.isPerspective&&(t.autocamCamera.isPerspective?t.navigation.toPerspective():t.navigation.toOrthographic()),t.navigation.setVerticalFov(t.autocamCamera.fov,!1),t.navigation.setView(t.autocamCamera.position,t.autocamCamera.target),t.navigation.setPivotPoint(t.autocamCamera.pivot),t.navigation.setCameraUpVector(t.autocamCamera.up),e&&t.navigation.setWorldUpVector(t.autocamCamera.worldup),t.impl.syncCamera(e)})),t.autocam.registerCallbackPivotDisplay((function(e){t.utilities?t.utilities.pivotActive(e,!1):t.impl.controls.pivotActive(e,!1)})),t.autocam.registerCallbackTransitionCompleted((function(){t.fireEvent({type:S.CAMERA_TRANSITION_COMPLETED})})),t.addEventListener("cameraChanged",(function(e){var n=e.camera;t.autocam.sync(n)})),t.autocam.sync(n)},he.prototype.uninitialize=function(){var e;this.removeWindowEventListener("resize",this.onResizeCallback,!1),this.onResizeCallback=null,this.removeWindowEventListener("scroll",this.onScrollCallback),this.onScrollCallback=null,this.canvas?this.canvas.removeEventListener("mousedown",this.onMouseDown):this.container&&this.container.removeEventListener("mousedown",this.onMouseDown),this.onMouseDown=null,this.canvas?this.canvas.removeEventListener("mouseup",this.onMouseUp):this.container&&this.container.removeEventListener("mouseup",this.onMouseUp),this.onMouseUp=null,this.canvas.parentNode.removeChild(this.canvas),this.canvas.viewer=null,L.InitParametersSetting.canvas===this.canvas&&(L.InitParametersSetting.canvas=null),this.canvas=null,this.canvasWrap=null,this.viewerState=null,o.logger.reportRuntimeStats(),o.logger.track({category:"viewer_destroy"},!0),this.toolController&&(this.toolController.uninitialize(),this.toolController=null,this.clickHandler=null,this.utilities=null),this.navigation&&(this.navigation.uninitialize(),this.navigation=null),this.impl&&(this.impl.dtor(),this.impl=null),this.overlays&&(this.overlays.dtor(),this.overlays=null),this.loadSpinner=null,this._loadingSpinner.destroy(),this._loadingSpinner=null,this.prefs&&this.prefs.clearListeners(),this.prefs=null,this.profile=null,this.profileManager=null,this.autocam.dtor(),this.autocam=null,this.autocamCamera=null,this._hotkeyManager.popHotkeys("Autodesk.FitToView"),this._hotkeyManager.popHotkeys("Autodesk.Home"),this._hotkeyManager.popHotkeys("Autodesk.Escape"),this._hotkeyManager.popHotkeys("Autodesk.Pan"),this._hotkeyManager.popHotkeys("Autodesk.Orbit"),this._hotkeyManager=null,he.ViewerCount--,0===he.ViewerCount&&(0,M.clearPropertyWorkerCache)(),this.onDefaultContextMenu&&(this.container.removeEventListener("contextmenu",this.onDefaultContextMenu,!1),this.onDefaultContextMenu=null),this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null),this._displayEdges&&(this.removeEventListener(S.GEOMETRY_LOADED_EVENT,this._displayEdges),this._displayEdges=null),this._setDoubleSided&&(this.removeEventListener(S.MODEL_ADDED_EVENT,this._setDoubleSided),this._setDoubleSided=null),this.extensionCache=null,this.clientContainer=null,this.config=null,this.contextMenu=null,this.contextMenuCallbacks=null,this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.container=null,this._forgeLogo=null,this.dispatchEvent(S.VIEWER_UNINITIALIZED),this.listeners={};var t=le.getGlobal();t.NOP_VIEWER===this&&(t.NOP_VIEWER=null);var n=null===(e=t.NOP_VIEWERS)||void 0===e?void 0:e.indexOf(this);-1!==n&&(t.NOP_VIEWERS.splice(n,1),0===t.NOP_VIEWERS.length&&(t.NOP_VIEWERS=null)),o.logger.log("viewer destroy")},he.prototype.finish=function(){this.tearDown(),this.uninitialize()},he.prototype.setLoadHeuristics=function(e){var t=e.bubbleNode;if(t){var n=t.findViewableParent();if(n){var i=n.name();e.fileExt=i.slice(i.length-3).toLowerCase();void 0===e.isAEC&&-1!==["rvt","nwd","nwc","ifc"].indexOf(e.fileExt)&&(e.isAEC=!0)}}if(e.isAEC){if(void 0===e.useConsolidation){var o=(0,h.getParameterByName)("useConsolidation")||"";e.useConsolidation="true"===o||"false"!==o&&void 0}void 0===e.useConsolidation&&(e.useConsolidation=!(0,r.isMobileDevice)()&&!(0,r.isNodeJS)()),void 0===e.createWireframe&&(e.createWireframe=!(0,r.isMobileDevice)()),void 0===e.disablePrecomputedNodeBoxes&&(e.disablePrecomputedNodeBoxes=!0)}else void 0===e.createWireframe&&(e.createWireframe=!(0,r.isMobileDevice)()&&this.prefs.get("edgeRendering"));e.useConsolidation&&!e.bvhOptions&&(e.bvhOptions={},D.Consolidation.applyBVHDefaults(e.bvhOptions))},he.prototype.trackADPSettingsOptions=function(){var e=this;this.trackADPTimer.push(setTimeout((function(){if(e.prefs){var t={category:"settingOptionsStatus",switchSheetColorWhiteToBlack:e.prefs.get("swapBlackAndWhite"),leftHandedMouseSetup:e.prefs.get("leftHandedMouseSetup"),openPropertiesOnSelect:e.prefs.get("openPropertiesOnSelect"),orbitPastWorldPoles:e.prefs.get("orbitPastWorldPoles"),reverseMouseZoomDirection:e.prefs.get("reverseMouseZoomDir"),fusionStyleOrbit:e.prefs.get("fusionOrbit"),setPivotWithLeftMouseButton:e.prefs.get("clickToSetCOI"),zoomTowardPivot:e.prefs.get("zoomTowardsPivot"),viewCubeActsOnPivot:e.prefs.get("alwaysUsePivot"),showViewCube:e.prefs.get("viewCube"),environmentImageVisible:e.prefs.get("envMapBackground"),displayEdges:e.prefs.get("edgeRendering"),displayPoints:e.prefs.get("pointRendering"),displayLines:e.prefs.get("lineRendering"),ghostHiddenObjects:e.prefs.get("ghosting"),groundReflection:e.prefs.get("groundReflection"),groundShadow:e.prefs.get("groundShadow"),ambientShadows:e.prefs.get("ambientShadows"),antiAliasing:e.prefs.get("antialiasing"),progressiveModelDisplay:e.prefs.get("progressiveRendering"),smoothNavigation:e.prefs.get("optimizeNavigation")};o.logger.track(t)}}),3e4))},he.prototype.trackADPExtensionsLoaded=function(){var e=this,t={category:"loaded_extensions"};this.trackADPTimer.push(setTimeout((function(){if(e.loadedExtensions)for(var n in e.loadedExtensions)t[n]=n;o.logger.track(t)}),3e4))},he.prototype.activateDefaultNavigationTools=function(e){if(!(0,r.isNodeJS)()){var t=e?"pan":"orbit";this.setDefaultNavigationTool(t),this.setActiveNavigationTool(t),this.toolController&&(this.toolController.enableMouseButtons(!0),this.toolController.activateTool("gestures"))}},he.prototype.registerDimensionSpecificHotkeys=function(e){if(this._hotkeyManager)if(e)this._hotkeyManager.popHotkeys("Autodesk.Orbit");else{var t,n=this,i=[{keycodes:[I.KeyCode.ALT],onPress:function(){return t=n.getActiveNavigationTool(),n.setActiveNavigationTool("orbit")},onRelease:function(){return n.setActiveNavigationTool(t)}}];this._hotkeyManager.pushHotkeys("Autodesk.Orbit",i,{tryUntilSuccess:!0})}},he.prototype.onModelAdded=function(e,t){var n,i;e.is2d()&&!e.isLeaflet()&&this.navigation.setMinimumLineWidth(null===(n=e.loader)||void 0===n||null===(i=n.svf)||void 0===i?void 0:i.minLineWidth);1===this.impl.modelQueue().getModels().length&&this.initializeFirstModelPresets(e,t)},he.prototype.initializeFirstModelPresets=function(e,t,n){if(e.is2d()&&this.activateLayerState("Initial"),n||e.getData().loadOptions.preserveView||(this.setActiveNavigationTool(),this.impl.setViewFromFile(e,!0),this.toolController.recordHomeView()),this.registerDimensionSpecificHotkeys(e.is2d()),t||this.activateDefaultNavigationTools(e.is2d()),this.navigation.setIs2D(this.impl.modelQueue().areAll2D()),e.isLeaflet()){var i=e.getData();this.navigation.setConstraints2D(i.bbox,i.maxPixelPerUnit)}else this.navigation.setConstraints2D()},he.prototype.loadModel=function(){var e,t=(e=regeneratorRuntime.mark((function e(t,n,i,a,u){var p,f,m,g,v,y,b,_,x,E,w,M,T;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y=function(e,t,n){p._loadingSpinner.hide(),a&&a(e,t,n)},v=function(e,t){if(p.impl._removeLoadingFile(g),e)return p.dispatchEvent({type:S.LOADER_LOAD_ERROR_EVENT,error:e,loader:g}),void y(e.code,e.msg,e.args);t.getData().underlayRaster=n.underlayRaster&&t.getLeaflet(),n.loadAsHidden?p.impl.modelQueue().addHiddenModel(t):p.impl.addModel(t),t.loader&&t.loader.notifiesFirstPixel&&p._loadingSpinner instanceof H?p.addEventListener(S.RENDER_FIRST_PIXEL,(function(){p._loadingSpinner.hide()}),{once:!0}):p._loadingSpinner.hide(),!(0,r.isNodeJS)()&&p._forgeLogo&&(p._forgeLogo.style.display="block"),i&&i(t)},f=(p=this).impl._reserveLoadingFile(),void 0===(n=n||{}).skipPropertyDb&&(m=(0,h.getParameterByName)("skipPropertyDb")||"",n.skipPropertyDb="true"===m||"false"!==m&&void 0),b=t.toLowerCase().match(/\.([a-z0-9]+)(\?|$)/),_=b?b[1]:null,!(x=this.config&&this.config.loaderExtensions&&this.config.loaderExtensions[_]||_ in q&&q[_])||this.isExtensionLoaded(x)){e.next=19;break}return e.prev=9,e.next=12,this.loadExtension(x,this.config);case 12:e.next=19;break;case 14:return e.prev=14,e.t0=e.catch(9),p.impl._removeLoadingFile(f),a&&a(d.ErrorCodes.VIEWER_INTERNAL_ERROR,e.t0.toString()),e.abrupt("return",!1);case 19:if(E=n&&n.fileLoader?n.fileLoader:A.FileLoaderManager.getFileLoaderForExtension(_)){e.next=25;break}return p.impl._removeLoadingFile(f),o.logger.error("File extension not supported:"+_,(0,d.errorCodeString)(d.ErrorCodes.UNSUPORTED_FILE_EXTENSION)),y(d.ErrorCodes.UNSUPORTED_FILE_EXTENSION,"File extension not supported",0,_),e.abrupt("return",!1);case 25:return this.setLoadHeuristics(n),this.impl.hasModels()||this._loadingSpinner.show(),"function"==typeof E.getExistingInstance&&(g=E.getExistingInstance(t,n,this.config)),g||(g=new E(this.impl,this.config)),p.impl._addLoadingFile(f,g),(w=g.loadFile(t,n,v,u))||p.impl._removeLoadingFile(g),this.fireEvent({type:S.LOADER_LOAD_FILE_EVENT,loader:g}),n.skipPrefs?(void 0===this.prefs.get(s.Prefs.DISPLAY_UNITS)&&this.prefs.set(s.Prefs.DISPLAY_UNITS,new l.EnumType(c.displayUnitsEnum)),void 0===this.prefs.get(s.Prefs.DISPLAY_UNITS_PRECISION)&&this.prefs.set(s.Prefs.DISPLAY_UNITS_PRECISION,new l.EnumType(c.displayUnitsPrecisionEnum))):(0,r.isNodeJS)()||this.profile||(M=this.chooseProfile(n),this.setProfile(M,!1)),T=$(t,_,w,n.bubbleNode),J.analytics.track("viewer.model.load",T),e.abrupt("return",w);case 37:case"end":return e.stop()}}),e,this,[[9,14]])})),function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function a(e){se(o,i,r,a,s,"next",e)}function s(e){se(o,i,r,a,s,"throw",e)}a(void 0)}))});return function(e,n,i,r,o){return t.apply(this,arguments)}}(),he.prototype.isLoadDone=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.geometry,n=void 0===t||t,i=e.propDb,r=void 0===i||i,o=e.textures,a=void 0===o||o,s=e.hidden,l=void 0!==s&&s,c=e.onlyModels,u=void 0===c?void 0:c;if(!u){if(!this.started)return!0;if(this.impl._hasLoadingFile())return!1}if(a&&Autodesk.Viewing.Private.TextureLoader.requestsInProgress()>0)return!1;n=n||a;var h=function(e){return!e||(n?e.isLoadDone():e.modelRootLoaded)&&(!r||!e.getPropertyDb()||e.getPropertyDb().isLoadDone())};if(u)return Array.isArray(u)?u.every(h):h(u);var d=this.impl.modelQueue();return d.getModels().every(h)&&(!l||d.getHiddenModels().every(h))},he.prototype.waitForLoadDone=function(e){var t=this;return new Promise((function(n,i){var r=e||{},o=r.geometry,a=void 0===o||o,s=r.propDb,l=void 0===s||s,c=r.textures,u=void 0===c||c,h=r.hidden,d=void 0!==h&&h,p=r.onlyModels,f=void 0===p?void 0:p,m={geometry:a=a||u,propDb:l,textures:u,hidden:d,onlyModels:f},g=function(){return t.started&&(t.impl._hasLoadingFile()>0||t.impl.modelQueue().getModels().length>0||t.impl.modelQueue().getHiddenModels().length>0)},v=!f&&g();if(v&&t.isLoadDone(m))n();else{var y,b=function(){(v=v||g())&&t.isLoadDone(m)&&(y(),n())},_=function(e){y();var t=new Error("Error loading model");t.loader=e.loader,t.error=e.error,i(t)};y=function(){a&&t.removeEventListener(S.GEOMETRY_LOADED_EVENT,b),l&&(t.removeEventListener(S.OBJECT_TREE_CREATED_EVENT,b),t.removeEventListener(S.OBJECT_TREE_UNAVAILABLE_EVENT,b)),u&&t.removeEventListener(S.TEXTURES_LOADED_EVENT,b),t.removeEventListener(S.LOADER_LOAD_FILE_EVENT,b),t.removeEventListener(S.MODEL_ADDED_EVENT,b),t.removeEventListener(S.MODEL_REMOVED_EVENT,b),t.removeEventListener(S.LOADER_LOAD_ERROR_EVENT,_),t.removeEventListener(S.MODEL_ROOT_LOADED_EVENT,b),t.removeEventListener(S.VIEWER_UNINITIALIZED,n)},a&&t.addEventListener(S.GEOMETRY_LOADED_EVENT,b),l&&(t.addEventListener(S.OBJECT_TREE_CREATED_EVENT,b),t.addEventListener(S.OBJECT_TREE_UNAVAILABLE_EVENT,b)),u&&t.addEventListener(S.TEXTURES_LOADED_EVENT,b),t.addEventListener(S.LOADER_LOAD_FILE_EVENT,b),t.addEventListener(S.MODEL_ADDED_EVENT,b),t.addEventListener(S.MODEL_REMOVED_EVENT,b),t.addEventListener(S.LOADER_LOAD_ERROR_EVENT,_),t.addEventListener(S.MODEL_ROOT_LOADED_EVENT,b,{priority:-1e6}),t.addEventListener(S.VIEWER_UNINITIALIZED,(function(){return i(new Error("Promise reject because viewer finished"))}))}}))},he.prototype.unloadModel=function(e){e||(e=this.model),this.impl.unloadModel(e)},he.prototype.loadDocumentNode=function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t,o=i.leafletOptions||{},a=e.getViewableUrn(r,o),s=r.findPropertyDbPath();a=e.getFullPath(a);var l={sharedPropertyDbPath:s=e.getFullPath(s),acmSessionId:e.getAcmSessionId(a),bubbleNode:r,applyRefPoint:!1,loadOptions:o,page:o.page||1};for(var c in l)Object.prototype.hasOwnProperty.call(i,c)||(i[c]=l[c]);if(!i.keepCurrentModels&&this.impl.hasModels()){var u=this.config;this.tearDown(),this.setUp(u)}var h=r.findParentGeom2Dor3D(),d=h.extensions();Array.isArray(d)&&d.forEach((function(e){n.loadExtension(e,n.config)}));var p=o.isPdf?this.loadExtension("Autodesk.PDF",this.config):Promise.resolve(),f=!i.disableUnderlayRaster&&o.tempRasterPath,m=f?this._loadTempRasterModel(e,i,r):Promise.resolve();return p.then((function(){return m})).then((function(e){return new Promise((function(t,o){f&&e&&e!==n.getUnderlayRaster(r)?o("load canceled"):n.loadModel(a,i,(function(e){i.loadAsHidden||i.preserveView||"view"!==r.type()||n.setView(r,{skipTransition:!0}),t(e)}),(function(e){o(e)}))}))}))},he.prototype.unloadDocumentNode=function(e){var t=this.impl.findModel(e,!0);if(t)return this.impl.unloadModel(t),!0;if(!this.impl.loaders)return!1;for(var n=0;n<this.impl.loaders.length;n++){var i=this.impl.loaders[n];if((i.options&&i.options.bubbleNode)===e)return i.dtor(),this.impl.loaders.splice(n,1),!0}return!1},he.prototype._loadTempRasterModel=function(e,t,n){var i=this;return new Promise((function(r,o){if(t.loadAsHidden)return r();t.underlayRaster=!0,t.loadOptions.fitPaperSize=!0;var a=function(e){var t,i,r=e.getDocumentNode();return r&&(null===(t=r.getDocument())||void 0===t?void 0:t.getPath())===(null===(i=n.getDocument())||void 0===i?void 0:i.getPath())&&r.guid()===n.guid()&&!e.isLeaflet()},s=function e(t){var n=t.model;a(n)&&(2===i.getVisibleModels().length&&i.initializeFirstModelPresets(n,!1,!0),i.removeEventListener(S.MODEL_ADDED_EVENT,e))};i.addEventListener(S.MODEL_ADDED_EVENT,s);var l,c=function e(t){var n=t.model;a(n)&&(n.changePaperVisibility(!0),i.removeEventListener(S.MODEL_REMOVED_EVENT,e),i.removeEventListener(S.MODEL_ADDED_EVENT,s),i.removeEventListener(S.GEOMETRY_LOADED_EVENT,u))};i.addEventListener(S.MODEL_REMOVED_EVENT,c);var u=function e(t){var n=t.model;a(n)&&(n.changePaperVisibility(!0),i.removeEventListener(S.MODEL_REMOVED_EVENT,c),l&&(i.unloadModel(l),l=null),i.removeEventListener(S.GEOMETRY_LOADED_EVENT,e))};i.addEventListener(S.GEOMETRY_LOADED_EVENT,u);var h=e.getFullPath(t.loadOptions.tempRasterPath);i.loadModel(h,t,(function(e){t.loadOptions.fitPaperSize=void 0,t.underlayRaster=void 0,t.hideBackground=!0,l=e,r(e)}),(function(e){if(t.loadOptions.fitPaperSize=void 0,t.underlayRaster=void 0,e===d.ErrorCodes.LOAD_CANCELED)return o("load canceled");r()}))}))},he.prototype.getDimensions=function(){if(this.container){var e={};return this.getScreenMode()===m.ScreenMode.kFullScreen?(e.width=screen.width,e.height=screen.height):e=this.container.getBoundingClientRect(),{width:e.width,height:e.height}}return null},he.prototype.resize=function(){this.container.clientWidth>0&&this.container.clientHeight>0&&this.impl.resize(this.container.clientWidth,this.container.clientHeight)},he.prototype.getHotkeyManager=function(){return this._hotkeyManager},he.prototype.getCamera=function(){return this.impl.camera},he.prototype.getState=function(e){return this.viewerState.getState(e)},he.prototype.restoreState=function(e,t,n){var i=this.viewerState.restoreState(e,t,n);return i&&this.dispatchEvent({type:S.VIEWER_STATE_RESTORED_EVENT,value:i}),i},he.prototype.setView=function(e,t){if(!(e&&e instanceof R.BubbleNode))return!1;var n=e.findParentGeom2Dor3D(),r=n&&this.impl.findModel(n,!0)||this.model;if(!r)return!1;var o=!!t&&t.skipTransition,a=!t||t.useExactCamera;if(e.getViewBox())return this.setViewFromViewBox(e.getViewBox(),e.name(),o),this.dispatchEvent({type:S.SET_VIEW_EVENT,view:e}),!0;var s=this.getCameraFromViewArray(e.data.camera,r);if(!s)return!1;this.impl.setViewFromCamera(s,o,a);var l=e.data.sectionPlane,c=e.data.sectionBox,u=e.data.sectionBoxTransform,h=r.getModelToViewerTransform();if(l){for(var d=[],p=0;p<l.length;p+=4){var f=new i.Plane(new i.Vector3(l[p+0],l[p+1],l[p+2]),l[p+3]);h&&f.applyMatrix4(h),d.push(new i.Vector4(f.normal.x,f.normal.y,f.normal.z,f.constant))}this.impl.setCutPlaneSet("__set_view",d)}else if(c&&u){var m=(new i.Matrix4).fromArray([u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],u[8],u[9],u[10],u[11],u[12],u[13],u[14],u[15]]),g=new i.Vector3(c[0],c[1],c[2]),v=new i.Vector3(c[3],c[4],c[5]),y=new i.Box3(g,v),b=new i.Matrix4;b.copy(h),b.multiply(m);var _=W.SceneMath.box2CutPlanes(y,b);this.impl.setCutPlaneSet("__set_view",_)}else this.impl.setCutPlaneSet("__set_view",void 0);return this.dispatchEvent({type:S.SET_VIEW_EVENT,view:e}),!0},he.prototype.setViewType=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setViewType is not applicable to 2D"):this.prefs.set(s.Prefs3D.VIEW_TYPE,e)},he.prototype.setViewFromArray=function(e){var t=this.getCameraFromViewArray(e);this.impl.setViewFromCamera(t,!1,!0)},he.prototype.getCameraFromViewArray=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.model,n=null==t?void 0:t.getModelToViewerTransform();return R.BubbleNode.readCameraFromArray(e,n)},he.prototype.getViewArrayFromCamera=function(){var e=this.model?this.model.getData().globalOffset:{x:0,y:0,z:0};return this.impl.getViewArrayFromCamera(e)},he.prototype.setViewFromViewBox=function(e,t,n){var i=this.model;if(!i||i.is2d()){if(t&&t.length){var r,a=i.getData().metadata.views;for(r=0;r<a.length&&a[r].name!=t;r++);if(r<a.length){var s=a[r].layer_state;s&&this.activateLayerState(s)}}this.impl.setViewFromViewBox(this.model,e,t,n)}else o.logger.warn("Viewer3D.setViewFromViewBox is not applicable to 3D")},he.prototype.activateLayerState=function(e){this.impl.layers.activateLayerState(e),this.dispatchEvent({type:S.LAYER_VISIBILITY_CHANGED_EVENT})},he.prototype.getLayerStates=function(){return this.impl.layers.getLayerStates()},he.prototype.setViewFromFile=function(e){this.setActiveNavigationTool(),this.impl.setViewFromFile(e||this.model)},he.prototype.getProperties=function(e,t,n){this.model?this.model.getProperties(e,t,n):n&&n(d.ErrorCodes.BAD_DATA,"Properties failed to load since model does not exist")},he.prototype.getObjectTree=function(e,t){this.model?this.model.getObjectTree(e,t):t&&t(d.ErrorCodes.BAD_DATA,"ObjectTree failed to load since model does not exist")},he.prototype.setCanvasClickBehavior=function(e){if(Object.prototype.hasOwnProperty.call(this.impl.controls,"setClickBehavior")&&this.impl.controls.setClickBehavior(e),this.clickHandler&&this.clickHandler.setClickBehavior(e),e&&e.disableMouseWheel&&this.toolController.setMouseWheelInputEnabled(!1),e&&e.disableTwoFingerSwipe){var t=this.toolController.getTool("gestures");t&&t.disableTwoFingerSwipe()}},he.prototype.search=function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{searchHidden:!1};this.searchText=e,this.model?this.model.search(e,t,n,i,r):n&&n(d.ErrorCodes.BAD_DATA,"Search failed since model does not exist")},he.prototype.getHiddenNodes=function(e){return e=e||this.model,this.impl.visibilityManager.getHiddenNodes(e)},he.prototype.getIsolatedNodes=function(e){return(e=e||this.model)&&e.is2d()?(o.logger.warn("Viewer3D.getIsolatedNodes is not yet implemented for 2D"),[]):this.impl.visibilityManager.getIsolatedNodes(e)},he.prototype.isolate=function(e,t){(t=t||this.model)&&this.impl.visibilityManager.isolate(e,t)},he.prototype.setBackgroundColor=function(e,t,n,i,r,o){this.impl.setClearColors(e,t,n,i,r,o)},he.prototype.setBackgroundOpacity=function(e){this.impl.setClearAlpha(e)},he.prototype.toggleSelect=function(e,t,n){(t=t||this.model)&&t.is2d()?o.logger.warn("Viewer3D.toggleSelect is not yet implemented for 2D"):this.impl.selector.toggleSelection(e,t,n)},he.prototype.select=function(e,t,n){"number"==typeof e&&(e=[e]),t=t||this.model,this.impl.selector.setSelection(e,t,n)},he.prototype.clearSelection=function(){this.impl.selector.clearSelection()},he.prototype.getSelectionVisibility=function(){return this.impl.selector.getSelectionVisibility()},he.prototype.getSelectionCount=function(){return this.impl.selector.getSelectionLength()},he.prototype.setSelectionMode=function(e){this.prefs.set(s.Prefs3D.SELECTION_MODE,e)},he.prototype.getSelection=function(){return this.impl.selector.getSelection()},he.prototype.lockSelection=function(e,t,n){n=n||this.model,this.impl.selector.lockSelection(e,t,n)},he.prototype.unlockSelection=function(e,t){this.impl.selector.unlockSelection(e,t)},he.prototype.isSelectionLocked=function(e,t){return this.impl.selector.isNodeSelectionLocked(e,t)},he.prototype.getAggregateSelection=function(e){var t=this.impl.selector.getAggregateSelection();if(e)for(var n=0;n<t.length;n++)for(var i=0;i<t[n].selection.length;i++)e(t[n].model,t[n].selection[i]);return t},he.prototype.setAggregateSelection=function(e){this.impl.selector.setAggregateSelection(e)},he.prototype.getAggregateIsolation=function(){return this.impl.visibilityManager.getAggregateIsolatedNodes()},he.prototype.getAggregateHiddenNodes=function(){return this.impl.visibilityManager.getAggregateHiddenNodes()},he.prototype.hide=function(e,t){t=t||this.model,this.impl.visibilityManager.hide(e,t)},he.prototype.show=function(e,t){t=t||this.model,this.impl.visibilityManager.show(e,t)},he.prototype.showAll=function(){this.impl.visibilityManager.aggregateIsolate([]),this.impl.layers.showAllLayers(),this.fireEvent({type:S.SHOW_ALL_EVENT})},he.prototype.hideAll=function(){var e=this;this.getVisibleModels().forEach((function(t){e.hide(t.getRootId(),t)})),this.fireEvent({type:S.HIDE_ALL_EVENT})},he.prototype.toggleVisibility=function(e,t){this.impl.visibilityManager.toggleVisibility(e,t)},he.prototype.areAllVisible=function(){return this.impl.isWholeModelVisible(this.model)},he.prototype.isNodeVisible=function(e,t){return t=t||this.model,this.impl.isNodeVisible(e,t)},he.prototype.lockVisible=function(e,t,n){n=n||this.model,this.impl.visibilityManager.lockNodeVisible(e,t,n)},he.prototype.toggleLockVisible=function(e,t){this.impl.visibilityManager.toggleVisibleLocked(e,t)},he.prototype.isVisibleLocked=function(e,t){return this.impl.visibilityManager.isNodeVisibleLocked(e,t)},he.prototype.explode=function(e){this.model&&(this.model.is2d()?o.logger.warn("Viewer3D.explode is not applicable to 2D"):this.impl.explode(e)&&o.logger.track({name:"explode_count",aggregate:"count"}))},he.prototype.getExplodeScale=function(){return this.model&&this.model.is2d()?(o.logger.warn("Viewer3D.getExplodeScale is not applicable to 2D"),0):this.impl.getExplodeScale()},he.prototype.lockExplode=function(e,t,n){return(n=n||this.model)&&n.is2d()?(o.logger.warn("Viewer3D.lockExplode is not applicable to 2D"),0):this.impl.lockExplode(e,t,n)},he.prototype.isExplodeLocked=function(e,t){return(t=t||this.model)&&t.is2d()?(o.logger.warn("Viewer3D.isExplodeLocked is not applicable to 2D"),0):this.impl.isExplodeLocked(e,t)},he.prototype.toggleLockExplode=function(e,t){return(t=t||this.model)&&t.is2d()?(o.logger.warn("Viewer3D.toggleLockExplode is not applicable to 2D"),0):this.impl.lockExplode(e,!this.isExplodeLocked(e,t),t)},he.prototype.setQualityLevel=function(e,t){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setQualityLevel is not applicable to 2D"):(this.prefs.set(s.Prefs3D.AMBIENT_SHADOWS,e),this.prefs.set(s.Prefs3D.ANTIALIASING,t))},he.prototype.setGhosting=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setGhosting is not applicable to 2D"):this.prefs.set(s.Prefs3D.GHOSTING,e)},he.prototype.setGroundShadow=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setGroundShadow is not applicable to 2D"):this.prefs.set(s.Prefs3D.GROUND_SHADOW,e)},he.prototype.setGroundReflection=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setGroundReflection is not applicable to 2D"):this.prefs.set(s.Prefs3D.GROUND_REFLECTION,e)},he.prototype.setEnvMapBackground=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setEnvMapBackground is not applicable to 2D"):this.prefs.set(s.Prefs3D.ENV_MAP_BACKGROUND,e)},he.prototype.setFirstPersonToolPopup=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setFirstPersonToolPopup is not applicable to 2D"):this.prefs.set(s.Prefs3D.FIRST_PERSON_TOOL_POPUP,e)},he.prototype.getFirstPersonToolPopup=function(){if(!this.model||!this.model.is2d())return this.prefs.get("firstPersonToolPopup");o.logger.warn("Viewer3D.getFirstPersonToolPopup is not applicable to 2D")},he.prototype.setBimWalkToolPopup=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setBimWalkToolPopup is not applicable to 2D"):this.prefs.set(s.Prefs3D.BIM_WALK_TOOL_POPUP,e)},he.prototype.getBimWalkToolPopup=function(){if(!this.model||!this.model.is2d())return this.prefs.get("bimWalkToolPopup");o.logger.warn("Viewer3D.getBimWalkToolPopup is not applicable to 2D")},he.prototype.setProgressiveRendering=function(e){this.prefs.set(s.Prefs.PROGRESSIVE_RENDERING,e)},he.prototype.setGrayscale=function(e){this.model&&this.model.is3d()?o.logger.warn("Viewer3D.setGrayscale is not applicable to 3D"):this.prefs.set(s.Prefs2D.GRAYSCALE,e)},he.prototype.setSwapBlackAndWhite=function(e){this.model&&this.model.is3d()?o.logger.warn("Viewer3D.setSwapBlackAndWhite is not applicable to 3D"):this.prefs.set(s.Prefs2D.SWAP_BLACK_AND_WHITE,e)},he.prototype.setOptimizeNavigation=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setOptimizeNaviation is not applicable to 2D"):this.prefs.set(s.Prefs3D.OPTIMIZE_NAVIGATION,e)},he.prototype.initializePrefListeners=function(){var e=this;this.prefs.addListeners(s.Prefs.KEY_MAP_CMD,(function(t){e.impl.toggleCmdMapping(t,e.toolController)})),this.prefs.addListeners(s.Prefs3D.ANTIALIASING,(function(t){var n=e.prefs.get(s.Prefs3D.AMBIENT_SHADOWS);e.impl.togglePostProcess(n,t)})),this.prefs.addListeners(s.Prefs3D.AMBIENT_SHADOWS,(function(t){var n=e.prefs.get(s.Prefs3D.ANTIALIASING);e.impl.togglePostProcess(t,n)})),this.prefs.addListeners(s.Prefs3D.GROUND_SHADOW,(function(t){e.impl.toggleGroundShadow(t)})),this.prefs.addListeners(s.Prefs3D.GROUND_REFLECTION,(function(t){e.impl.toggleGroundReflection(t)})),this.prefs.addListeners(s.Prefs3D.ENV_MAP_BACKGROUND,(function(t){e.impl.toggleEnvMapBackground(t)})),this.prefs.addListeners(s.Prefs.PROGRESSIVE_RENDERING,(function(t){e.impl.toggleProgressive(t)})),this.prefs.addListeners(s.Prefs3D.VIEW_TYPE,(function(t){var n=e.prefs.get(s.Prefs3D.VIEW_TYPE),i=e.impl.getModelCamera(e.model);if(i){var r=i.isPerspective;if(!isNaN(r)){var o=r?s.VIEW_TYPES.PERSPECTIVE:s.VIEW_TYPES.ORTHOGRAPHIC;e.prefs.setDefault(s.Prefs3D.VIEW_TYPE,o),n===s.VIEW_TYPES.DEFAULT&&(e.prefs[s.Prefs3D.VIEW_TYPE]=o)}}e.autocam.setViewType(t)})),this.prefs.addListeners(s.Prefs2D.GRAYSCALE,(function(t){e.impl.toggleGrayscale(t)})),this.prefs.addListeners(s.Prefs2D.SWAP_BLACK_AND_WHITE,(function(t){e.impl.toggleSwapBlackAndWhite(t)})),this.prefs.addListeners(s.Prefs3D.OPTIMIZE_NAVIGATION,(function(t){e.impl.setOptimizeNavigation(t)})),this.prefs.addListeners(s.Prefs3D.GHOSTING,(function(t){e.impl.toggleGhosting(t)})),this.prefs.addListeners(s.Prefs3D.LINE_RENDERING,(function(t){e.impl.hideLines(!t)})),this.prefs.addListeners(s.Prefs.POINT_RENDERING,(function(t){e.impl.hidePoints(!t)})),this.prefs.addListeners(s.Prefs3D.EDGE_RENDERING,(function(t){e._displayEdges=function(){e.impl.setDisplayEdges(t)},t||e.model&&e.model.isLoadDone()?e._displayEdges():e.addEventListener(S.GEOMETRY_LOADED_EVENT,e._displayEdges)})),this.prefs.addListeners(s.Prefs3D.LIGHT_PRESET,(function(t){var n=!1;if("string"==typeof t){for(var i=t,r=-1,a=0;a<K.LightPresets.length;a++)if(K.LightPresets[a].name===i){r=a;break}-1===r&&(o.logger.warn("Invalid Prefs3D.LIGHT_PRESET: "+t),o.logger.warn("Setting to default light preset."),n=!0),t=r}e.impl.setLightPreset(t,n)})),this.prefs.addListeners(s.Prefs3D.ALWAYS_USE_PIVOT,(function(t){e.navigation.setUsePivotAlways(t)})),this.prefs.addListeners(s.Prefs.REVERSE_MOUSE_ZOOM_DIR,(function(t){e.navigation.setReverseZoomDirection(t)})),this.prefs.addListeners(s.Prefs3D.REVERSE_HORIZONTAL_LOOK_DIRECTION,(function(t){e.navigation.setReverseHorizontalLookDirection(t)})),this.prefs.addListeners(s.Prefs3D.REVERSE_VERTICAL_LOOK_DIRECTION,(function(t){e.navigation.setReverseVerticalLookDirection(t)})),this.prefs.addListeners(s.Prefs3D.ZOOM_TOWARDS_PIVOT,(function(t){e.navigation.setZoomTowardsPivot(t)})),this.prefs.addListeners(s.Prefs3D.SELECTION_SETS_PIVOT,(function(t){e.navigation.setSelectionSetsPivot(t)})),this.prefs.addListeners(s.Prefs3D.ORBIT_PAST_WORLD_POLES,(function(t){e.navigation.setOrbitPastWorldPoles(t)})),this.prefs.addListeners(s.Prefs.LEFT_HANDED_MOUSE_SETUP,(function(t){e.navigation.setUseLeftHandedInput(t),f.EventUtils.setUseLeftHandedInput(t)})),this.prefs.addListeners(s.Prefs.WHEEL_SETS_PIVOT,(function(t){e.navigation.setWheelSetsPivot(t)})),this.prefs.addListeners(s.Prefs3D.SELECTION_MODE,(function(t){e.impl.selector.setSelectionMode(t)})),this.prefs.addListeners(s.Prefs.BACKGROUND_COLOR_PRESET,(function(t){if(t)try{var n=JSON.parse(t);e.impl.setClearColors(n[0],n[1],n[2],n[3],n[4],n[5])}catch(e){o.logger.warn("Invalid Prefs.BACKGROUND_COLOR_PRESET: "+n)}})),this.prefs.addListeners(s.Prefs3D.EXPLODE_STRATEGY,(function(t){Z.i.setStrategy(t)&&e.impl.refreshExplode()})),this.prefs.addListeners(s.Prefs2D.LOADING_ANIMATION,(function(t){e.impl.onLoadingAnimationChanged(t)}));var t={};this.prefs.addListeners(s.Prefs3D.FORCE_DOUBLE_SIDED,(function(n){function i(e){return"boolean"==typeof n?n:!!n[e.id]}e._setDoubleSided=function(n){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=n.model,a=i(o),s=o.getData();Object.prototype.hasOwnProperty.call(t,o.id)||(t[o.id]=!!s.doubleSided);var l=a||!!s.doubleSided;l!==t[o.id]&&(e.impl.setDoubleSided(l,o,r),t[o.id]=l)};var r=e.impl.modelQueue().getModels();0===r.length?e.addEventListener(S.MODEL_ADDED_EVENT,e._setDoubleSided):(r.forEach((function(t){e._setDoubleSided({model:t},!1)})),e.impl.sceneUpdated())}))},he.prototype.setNavigationLock=function(e){var t=this.navigation.getIsLocked();return t!==e&&(this.navigation.setIsLocked(e),this.dispatchEvent({type:S.NAVIGATION_MODE_CHANGED_EVENT,id:this.getActiveNavigationTool()})),t},he.prototype.getNavigationLock=function(){return this.navigation.getIsLocked()},he.prototype.setNavigationLockSettings=function(e){this.navigation.setLockSettings(e),this.dispatchEvent({type:S.NAVIGATION_MODE_CHANGED_EVENT,id:this.getActiveNavigationTool()})},he.prototype.getNavigationLockSettings=function(){return this.navigation.getLockSettings()},he.prototype.setActiveNavigationTool=function(e){if(e===this._pushedTool||!e&&!this._pushedTool)return!0;if(this._pushedTool){if(!this.impl.controls.deactivateTool(this._pushedTool))return!1;this.impl.controls.setToolActiveName(this.getDefaultNavigationToolName()),this._pushedTool=null}return(!e||e===this.getDefaultNavigationToolName())&&null===this._pushedTool?(this.dispatchEvent({type:S.NAVIGATION_MODE_CHANGED_EVENT,id:this.getDefaultNavigationToolName()}),!0):!!this.impl.controls.activateTool(e)&&(this._pushedTool=e,this.dispatchEvent({type:S.NAVIGATION_MODE_CHANGED_EVENT,id:this._pushedTool}),!0)},he.prototype.getActiveNavigationTool=function(){return this._pushedTool?this._pushedTool:this._defaultNavigationTool},he.prototype.setDefaultNavigationTool=function(e){this._defaultNavigationTool&&this.impl.controls.deactivateTool(this._defaultNavigationTool);var t=this._pushedTool;this._pushedTool=null,t&&this.impl.controls.deactivateTool(t),this.impl.controls.activateTool(e),this._defaultNavigationTool=e,t&&(this.impl.controls.activateTool(t),this._pushedTool=t)},he.prototype.getDefaultNavigationToolName=function(){return this._defaultNavigationTool},he.prototype.getFOV=function(){return this.navigation.getVerticalFov()},he.prototype.setFOV=function(e){this.navigation.setVerticalFov(e,!0)},he.prototype.getFocalLength=function(){return this.navigation.getFocalLength()},he.prototype.setFocalLength=function(e){this.navigation.setFocalLength(e,!0)},he.prototype.hideLines=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.hideLines is not applicable to 2D"):this.prefs.set(s.Prefs3D.LINE_RENDERING,!e)},he.prototype.hidePoints=function(e){this.prefs.set(s.Prefs.POINT_RENDERING,!e)},he.prototype.setDisplayEdges=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setDisplayEdges is not applicable to 2D"):this.prefs.set(s.Prefs3D.EDGE_RENDERING,e)},he.prototype.applyCamera=function(e,t){this.impl.setViewFromCamera(e,!0),t&&this.fitToView()},he.prototype.fitToView=function(e,t,n){var i=[];e&&(e.length>0&&e[0].model?i=e:e.length>0&&i.push({model:t||this.model,selection:e})),this.impl.fitToView(i,n)},he.prototype.setClickConfig=function(e,t,n){var i=this.clickHandler?this.clickHandler.getClickBehavior():this.impl.controls.getClickBehavior();if(e in i){var r=i[e];if(t in r)return r[t]=n,!0}return!1},he.prototype.getClickConfig=function(e,t){var n=this.clickHandler?this.clickHandler.getClickBehavior():this.impl.controls.getClickBehavior();if(e in n){var i=n[e];if(t in i)return i[t]}return null},he.prototype.setClickToSetCOI=function(e,t){!1!==t&&this.prefs.set(s.Prefs3D.CLICK_TO_SET_COI,e);var n=this.getClickConfig("click","onObject");e?-1===n.indexOf("setCOI")&&this.setClickConfig("click","onObject",["setCOI"]):n.indexOf("setCOI")>=0&&this.setClickConfig("click","onObject",["selectOnly"])},he.prototype.setProfile=function(e,t){var n=this;if(!e)return!1;this.profile=e,this.profile.apply(this.prefs,t);var i=this.profile.extensions&&this.profile.extensions.unload||[],r=this.profile.extensions&&this.profile.extensions.load||[];i.forEach((function(e){n.isExtensionLoaded(e)&&n.unloadExtension(e)})),r.forEach((function(e){n.isExtensionLoaded(e)||n.loadExtension(e,n.config)})),this.dispatchEvent({type:Autodesk.Viewing.PROFILE_CHANGE_EVENT,profile:e})},he.prototype.initSettings=function(e){if(!this.profile){var t=new a.Profile(e);this.setProfile(t)}},he.prototype.setLightPreset=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setLightPreset is not applicable to 2D"):this.prefs.set(s.Prefs3D.LIGHT_PRESET,e)},he.prototype.setUsePivotAlways=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setUsePivotAlways is not applicable to 2D"):this.prefs.set(s.Prefs3D.ALWAYS_USE_PIVOT,e)},he.prototype.setReverseZoomDirection=function(e){this.prefs.set(s.Prefs.REVERSE_MOUSE_ZOOM_DIR,e)},he.prototype.setReverseHorizontalLookDirection=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setReverseHorizontalLookDirection is not applicable to 2D"):this.prefs.set(s.Prefs3D.REVERSE_HORIZONTAL_LOOK_DIRECTION,e)},he.prototype.setReverseVerticalLookDirection=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setReverseVerticalLookDirection is not applicable to 2D"):this.prefs.set(s.Prefs3D.REVERSE_VERTICAL_LOOK_DIRECTION,e)},he.prototype.setZoomTowardsPivot=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setZoomTowardsPivot is not applicable to 2D"):this.prefs.set(s.Prefs3D.ZOOM_TOWARDS_PIVOT,e)},he.prototype.setOrbitPastWorldPoles=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setOrbitPastWorldPoles is not applicable to 2D"):this.prefs.set(s.Prefs3D.ORBIT_PAST_WORLD_POLES,e)},he.prototype.setUseLeftHandedInput=function(e){this.prefs.set(s.Prefs.LEFT_HANDED_MOUSE_SETUP,e)},he.prototype.setDisplayUnits=function(e){this.prefs.set(s.Prefs.DISPLAY_UNITS,e)},he.prototype.setDisplayUnitsPrecision=function(e){null==e&&(e=""),this.prefs.set(s.Prefs.DISPLAY_UNITS_PRECISION,e)},he.prototype.setLayerVisible=function(e,t,n){var i=this.impl.layers;null===e?t?i.showAllLayers():i.hideAllLayers():(Array.isArray(e)||(e=[e]),n&&i.hideAllLayers(),this.impl.setLayerVisible(e,t)),this.dispatchEvent({type:S.LAYER_VISIBILITY_CHANGED_EVENT})},he.prototype.isLayerVisible=function(e){return!!(e&&e.isLayer&&this.impl.isLayerVisible(e))},he.prototype.anyLayerHidden=function(){for(var e=this.impl.getLayersRoot(),t=e&&e.children,n=t?t.length:0,i=0;i<n;++i)if(!this.impl.layers.isLayerVisible(t[i]))return!0;return!1},he.prototype.allLayersHidden=function(){for(var e=this.impl.getLayersRoot(),t=e&&e.children,n=t?t.length:0,i=0;i<n;++i)if(this.impl.layers.isLayerVisible(t[i]))return!1;return!0},he.prototype.setGroundShadowColor=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setGroundShadowColor is not applicable to 2D"):this.impl.setGroundShadowColor(e)},he.prototype.setGroundShadowAlpha=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setGroundShadowAlpha is not applicable to 2D"):this.impl.setGroundShadowAlpha(e)},he.prototype.setGroundReflectionColor=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setGroundReflectionColor is not applicable to 2D"):this.impl.setGroundReflectionColor(e)},he.prototype.setGroundReflectionAlpha=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setGroundReflectionAlpha is not applicable to 2D"):this.impl.setGroundReflectionAlpha(e)},he.prototype.getCutPlanes=function(){return this.model&&this.model.is2d()?(o.logger.warn("Viewer3D.getCutPlanes is not applicable to 2D"),[]):this.impl.getCutPlanes()},he.prototype.setCutPlanes=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.getCutPlanes is not applicable to 2D"):this.impl.setCutPlaneSet("__set_view",e)},he.prototype.getScreenShot=function(e,t,n,i){return j.ScreenShot.getScreenShotLegacy(this,e,t,n,i)},he.prototype.setContextMenu=function(e){this.contextMenu&&this.contextMenu.hide(),this.contextMenu=e||null},he.prototype.setDefaultContextMenu=function(){var e=Autodesk.Viewing.Extensions;return!(!e||!e.ViewerObjectContextMenu)&&(this.setContextMenu(new e.ViewerObjectContextMenu(this)),!0)},he.prototype.triggerContextMenu=function(e){return this.config&&this.config.onTriggerContextMenuCallback&&this.config.onTriggerContextMenuCallback(e),!!this.contextMenu&&(this.contextMenu.show(e),!0)},he.prototype.triggerSelectionChanged=function(e){this.config&&this.config.onTriggerSelectionChangedCallback&&this.config.onTriggerSelectionChangedCallback(e)},he.prototype.triggerDoubleTapCallback=function(e){this.config&&this.config.onTriggerDoubleTapCallback&&this.config.onTriggerDoubleTapCallback(e)},he.prototype.triggerSingleTapCallback=function(e){this.config&&this.config.onTriggerSingleTapCallback&&this.config.onTriggerSingleTapCallback(e)},he.prototype.triggerSwipeCallback=function(e){this.config&&this.config.onTriggerSwipeCallback&&this.config.onTriggerSwipeCallback(e)},he.prototype.initContextMenu=function(){(!this.config||!Object.prototype.hasOwnProperty.call(this.config,"disableBrowserContextMenu")||this.config.disableBrowserContextMenu)&&(this.onDefaultContextMenu=function(e){e.preventDefault()},this.container.addEventListener("contextmenu",this.onDefaultContextMenu,!1));var e=this,t=this.canvas||this.container;this.onMouseDown=function(t){f.EventUtils.isRightClick(t)&&(e.startX=t.clientX,e.startY=t.clientY)},t.addEventListener("mousedown",this.onMouseDown),this.onMouseUp=function(t){return f.EventUtils.isRightClick(t)&&t.clientX===e.startX&&t.clientY===e.startY&&e.triggerContextMenu(t),!0},t.addEventListener("mouseup",this.onMouseUp,!1)},he.prototype.registerContextMenuCallback=function(e,t){this.contextMenuCallbacks[e]=t},he.prototype.unregisterContextMenuCallback=function(e){return e in this.contextMenuCallbacks&&(delete this.contextMenuCallbacks[e],!0)},he.prototype.runContextMenuCallbacks=function(e,t){for(var n in this.contextMenuCallbacks)Object.prototype.hasOwnProperty.call(this.contextMenuCallbacks,n)&&this.contextMenuCallbacks[n](e,t)},he.prototype.joinLiveReview=function(e){var t=this;this.loadExtension("Autodesk.Viewing.Collaboration").then((function(n){n.joinLiveReview.call(t,e)}))},he.prototype.leaveLiveReview=function(){var e=this;this.loadExtension("Autodesk.Viewing.Collaboration").then((function(t){t.leaveLiveReview.call(e)}))},he.prototype.setModelUnits=function(e){this.model&&(this.model.getData().overriddenUnits=e)},he.prototype.worldToClient=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.impl.camera;return this.impl.worldToClient(e,t)},he.prototype.clientToWorld=function(e,t,n,i){return this.impl.clientToWorld(e,t,n,i)},he.prototype.modelHasTopology=function(){return!(!this.model||!this.model.hasTopology())},he.prototype.setSelectionColor=function(e,t){this.impl.setSelectionColor(e,t)},he.prototype.set2dSelectionColor=function(e,t){this.impl.set2dSelectionColor(e,t)},he.prototype.setTheme=function(e){for(var t=this.container.classList,n=0;n<t.length;++n){-1!==t[n].indexOf("-theme")&&t.remove(t[n--])}t.add(e)},he.prototype.setThemingColor=function(e,t,n,i){(n=n||this.model).setThemingColor(e,t,i),this.impl.invalidate(!0)},he.prototype.clearThemingColors=function(e){(e=e||this.model).clearThemingColors(),this.impl.invalidate(!0)},he.prototype.transferModel=function(e,t){var n,i=this.impl.findModel(e);if(i){var r=[];this.getAggregateSelection((function(t,n){t.id==e&&r.push(n)}));var o=this.impl.visibilityManager.getIsolatedNodes(i),a=this.impl.visibilityManager.getHiddenNodes(i),s=this.impl.matman().exportModelMaterials(i);this.impl.unloadModel(i,!0),null===(n=i.getFragmentList())||void 0===n||n.dispose(this.impl.glrenderer()),i.isAEC()&&i.is3d()&&t.impl.setLightPresetForAec(),t.impl.setRenderingPrefsFor2D(i.is2d()),t.impl.addModel(i),t.impl.matman().importModelMaterials(s,e),t._loadingSpinner.hide(),i.loader&&i.loader.viewer3DImpl===this.impl&&(i.loader.viewer3DImpl=t.impl),i.getData().loadDone&&t.impl.onLoadComplete(i),t.impl.selector.setSelection(r,i),0!=o.length?t.impl.visibilityManager.isolate(o,i):0!=a.length&&t.impl.visibilityManager.hide(a,i)}},he.prototype.hideModel=function(e){var t=this.impl.modelQueue();return!!(e="number"==typeof e?t.findModel(e):e)&&(this.impl.removeModel(e),t.addHiddenModel(e),!0)},he.prototype.showModel=function(e,t){var n=this.impl.modelQueue();return!!(e="number"==typeof e?n.findHiddenModel(e):e)&&(n.removeHiddenModel(e),this.impl.addModel(e,t),!0)},he.prototype.getVisibleModels=function(){return this.impl.modelQueue().getModels().slice()},he.prototype.getHiddenModels=function(){return this.impl.modelQueue().getHiddenModels().slice()},he.prototype.getAllModels=function(){return this.impl.modelQueue().getAllModels().slice()},he.prototype.getUnderlayRaster=function(e){return this.getAllModels().find((function(t){var n,i,r=t.getDocumentNode();return r&&(null===(n=r.getDocument())||void 0===n?void 0:n.getPath())===(null===(i=e.getDocument())||void 0===i?void 0:i.getPath())&&r.guid()===e.guid()&&t.getData().underlayRaster}))},he.prototype.restoreDefaultSettings=function(){var e=this.model,t=e.is2d()?"2d":"3d";this.prefs.reset(t),this.impl.setupLighting(e),e.isAEC()&&e.is3d()&&this.impl.setLightPresetForAec(),this.impl.setRenderingPrefsFor2D(!e.is3d()),this.fireEvent({type:S.RESTORE_DEFAULT_SETTINGS_EVENT})},he.prototype.disableHighlight=function(e){this.impl.disableHighlight(e)},he.prototype.disableSelection=function(e){e&&this.clearSelection(),this.impl.disableSelection(e)},he.prototype.isHighlightDisabled=function(){return this.impl.selector.highlightDisabled},he.prototype.isHighlightPaused=function(){return this.impl.selector.highlightPaused},he.prototype.isHighlightActive=function(){return!(this.impl.selector.highlightDisabled||this.impl.selector.highlightPaused)},he.prototype.isSelectionDisabled=function(){return this.impl.selector.selectionDisabled},he.prototype.activateExtension=function(e,t){return this.loadedExtensions&&e in this.loadedExtensions?this.loadedExtensions[e].activate(t):(o.logger.warn("Extension is not loaded or doesn't exist"),!1)},he.prototype.deactivateExtension=function(e){return this.loadedExtensions&&e in this.loadedExtensions?this.loadedExtensions[e].deactivate():(o.logger.warn("Extension is not loaded or doesn't exist"),!1)},he.prototype.isExtensionActive=function(e,t){return this.loadedExtensions&&e in this.loadedExtensions?this.loadedExtensions[e].isActive(t):(o.logger.warn("Extension is not loaded or doesn't exist"),!1)},he.prototype.isExtensionLoaded=function(e){return this.loadedExtensions&&e in this.loadedExtensions},he.prototype.getLoadedExtensions=function(){return this.loadedExtensions||[]},he.prototype.getExtensionModes=function(e){return this.loadedExtensions&&e in this.loadedExtensions?this.loadedExtensions[e].getModes():(console.warn("Extension is not loaded or doesn't exist"),[])},he.prototype.reorderElements=function(e){var t=e.getAttribute("layer-order-id"),n=this.containerLayerOrder.indexOf(t),i=null;if(-1!==n)for(var r=n+1;r<this.containerLayerOrder.length&&!i;r++)i=this.container.querySelector('[layer-order-id="'+this.containerLayerOrder[r]+'"]');i?this.container.insertBefore(e,i):this.container.appendChild(e)},he.prototype.appendOrderedElementToViewer=function(e){var t=this.container.querySelector('[layer-order-id="'+e+'"]');if(t)return t;var n=this.getDocument().createElement("div");return n.setAttribute("layer-order-id",e),this.reorderElements(n),n},he.prototype.hitTest=function(e,t,n){return this.impl.hitTest(e,t,n)},he.prototype.refresh=function(e){this.impl.invalidate(e,!1,!e)},he.prototype.chooseProfile=function(e){var t=this.profileManager.PROFILE_DEFAULT;return this.config&&this.config.profileSettings?t=new a.Profile(this.config.profileSettings):e&&e.useFileProfile?t=this.profileManager.getProfileOrDefault(e.fileExt):e.isAEC&&(t=this.profileManager.PROFILE_AEC),t}},20313:(e,t,n)=>{"use strict";n.r(t),n.d(t,{InitParametersSetting:()=>H,createRenderer:()=>W,Viewer3DImpl:()=>j});var i=n(84998),r=n(66904),o=n(18588),a=n(23305),s=n(29003),l=n(9140),c=n(2799),u=n(30093),h=n(95018),d=n(83359),p=n(19115),f=n(98926),m=n(50005),g=n(88771),v=n(31102),y=n(2727),b=n(57658),_=n(5106),x=n(25119),E=n(77416),w=n(24032),S=n(282),A=n(4388),M=n(17167),T=n(97339),C=n(48862),P=n(89812),L=n(16453),R=n(93382),D=n(37169),I=n(10831),O=n(26074),N=n(77368),k=n(27820),F=n(35449),U=n(55412),B=n(98603),V=null,G=(0,i.getGlobal)().ENABLE_DEBUG,z=(0,i.getGlobal)().ENABLE_DEBUG_RCS,H={canvas:null,antialias:!1,alpha:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!0,stencil:!1,depth:!1};function W(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,i.isNodeJS)()){var n=Object.assign({},H,t);n.canvas=e;var r=new g.WebGLRenderer(n);return r.name="MainRenderer",r.context?(r.autoClear=!1,r.sortObjects=!1,r):null}}function j(e,t){var n=this,F=this;this.setGlobalManager(t.globalManager);var H,j,q,X,Y,K,Z,J,Q,$,ee,te,ne,ie=1e3/15,re=1e3/30,oe=1,ae=-1,se=-1,le=-1,ce=null,ue="y",he=null,de=null,pe=null,fe=!1,me=!1,ge=!1,ve={type:D.PROGRESS_UPDATE_EVENT,state:o.ProgressState.LOADING,percent:0},ye=!1,be=!1,_e=!1,xe=0,Ee=0,we=1e3/60,Se=0,Ae=!0,Me=!1,Te=!1,Ce=null,Pe=null;this.edgeColorMain=new L.Vector4(0,0,0,.3),this.edgeColorGhosted=new L.Vector4(0,0,0,.1);(0,i.getGlobal)();var Le,Re,De,Ie=function(e){var t=e.model;n.canvas&&t&&t.getData()&&t.getData().stdSurfMats&&t.getData().stdSurfMats.materials&&n.api.loadExtension("Autodesk.StandardSurface").then((function(e){e&&e.processModel(t)}))},Oe=function(e){return e.model.modelRootLoaded=!0},Ne={},ke="",Fe=!0;function Ue(e){var t,n=null===(t=e.frags)||void 0===t?void 0:t.is2d,i=Le.phase,r=!0,o=i==y.RenderFlags.RENDER_NORMAL,a=Z.settings.idbuffer&&i!=y.RenderFlags.RENDER_HIDDEN,s=i==y.RenderFlags.RENDER_HIDDEN?F.edgeColorGhosted:F.edgeColorMain;Z.setEdgeColor(s),i!=y.RenderFlags.RENDER_HIDDEN||e.ignoreFadeMaterial?i==y.RenderFlags.RENDER_HIGHLIGHTED&&(e.overrideMaterial=F.highlightMaterial):e.overrideMaterial=F.fadeMaterial;var l={type:D.RENDER_SCENE_PART,scene:e,wantColor:r,wantSAO:o,wantID:a,context:Z};F.api.dispatchEvent(l),!F.is2d&&n?F.getSheetRenderer().renderScenePart(e,r,o,a):Z.renderScenePart(e,r,o,a),e.overrideMaterial=null}function Be(e){j&&(F.canvasBoundingclientRectDirty=!0,F.camera.aspect=q/X,F.camera.clientWidth=q,F.camera.clientHeight=X,Z.setSize(q,X),F.controls.handleResize(),te&&te.setSize(q,X),J&&J.setSize(),F.invalidate(!0,!0,!0),j=!1,e||F.api.dispatchEvent({type:D.VIEWER_RESIZE_EVENT,width:q,height:X}))}function Ve(){var e;if((ee.enabled||te)&&!F.is2d&&(e=F.model&&!F.model.isLoadDone()?F.model.getData().bbox:F.getVisibleBounds(!0,!1))){var t=F.camera,n=e.clone(),i=new L.Vector3(1,0,0),r=de.clone();t.worldUpTransform&&(n.applyMatrix4(t.worldUpTransform),i.applyMatrix4(t.worldUpTransform),r.applyMatrix4(t.worldUpTransform)),n.min.y-=.005*(n.max.y-n.min.y),Q&&Q.expandByGroundShadow(n,r);var o=n.getSize(new L.Vector3),a=n.getCenter(new L.Vector3);if(Q||(o.x*=1.25,o.z*=1.25,o.x=o.z=Math.max(o.x,o.z)),t.worldUpTransform){var s=t.worldUpTransform.clone().invert();a.applyMatrix4(s)}if(ee.setTransform(a,o,t.worldup,i),te){var l=(new L.Vector3).subVectors(a,t.worldup.clone().multiplyScalar(o.y/2));te.setTransform(l,t.worldup,o)}Q&&Q.setGroundShadowTransform(a,o,t.worldup,i)}}function Ge(){Q&&(Q.state=b.SHADOWMAP_NEEDS_UPDATE)}e&&(this.interval=setInterval((function(){Ae||Se<60||F.track({name:"fps",value:Number(F.fps().toFixed(2)),aggregate:"last"})}),3e4)),this.api=t,this.canvas=e,this.loader=null,this.canvasBoundingclientRectDirty=!0,this.nearRadius=0,this.defaultLoadingAnimationDuration=300,this.lastTime2dGeometryCreated=0,this.maxModelDistance=0,this.initialize=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(H=new L.Vector3(0,1,0),ne=new a.RenderScene,(K=t.glrenderer||W(e,t.webglInitParams))||(0,i.isNodeJS)()){K&&(this.onWebGLcontextLost=this.onWebGLcontextLost.bind(this),this.onWebGLcontextRestored=this.onWebGLcontextRestored.bind(this),K.addEventListener(g.WebGLRenderer.Events.WEBGL_CONTEXT_LOST,this.onWebGLcontextLost),K.refCount++,t.enableContextRestore&&(K.enableContextRestore=!0,K.addEventListener(g.WebGLRenderer.Events.WEBGL_CONTEXT_RESTORED,this.onWebGLcontextRestored))),(Z=t.renderer||new s.RenderContext).init(K,e?e.clientWidth:0,e?e.clientHeight:0,t),(Y=t.materialManager||new l.MaterialManager(K)).refCount++,this.camera=new R.UnifiedCamera(e?e.clientWidth:512,e?e.clientHeight:512),this.lightsOn=!1,this.lights=[],this.no_lights=[],Ce=(new L.Color).setRGB(1,1,1),Pe=(new L.Color).setRGB(1,1,1),this.cameraChangedEvent={type:D.CAMERA_CHANGE_EVENT,camera:this.camera},he=new L.Vector3(1,1,1),de=(new L.Vector3).copy(he),pe=new L.Vector3(-1,0,1),this.scene=new L.Scene,this.sceneAfter=new L.Scene,this.sceneAfter.sortObjects=!1,this.overlayScenes={},yt(),this.createOverlayScene("selection",this.selectionMaterialBase,this.selectionMaterialTop),this.createOverlayScene("selection_points",null,null),this.selectionMeshes={},this.fadeMaterial=new L.MeshPhongMaterial({color:16777215,opacity:.1,reflectivity:0,transparent:!0,depthWrite:!1}),this.fadeMaterial.packedNormals=!0,Y.addInstancingSupport(this.fadeMaterial),Y.addMaterial("__fadeMaterial__",this.fadeMaterial,!0),this.setSelectionColor(6724095),Y.togglePolygonOffset(!0),Z.setDepthMaterialOffset(Y.getPolygonOffsetOn(),Y.getPolygonOffsetFactor(),Y.getPolygonOffsetUnits()),this.progressiveRender=!0,this.swapBlackAndWhite=!1,this.targetFrameBudget=re,this.frameDisplayRate=5,(0,i.isMobileDevice)()&&(ie*=2,re*=2,this.targetFrameBudget/=2,this.frameDisplayRate/=2),this.interruptBudget=1e10,this.controls={update:function(){this.camera.lookAt(this.camera.target),this.camera.updateProjectionMatrix(),this.camera.dirty=!1},handleResize:function(){},recordHomeView:function(){},uninitialize:function(){},isToolActivated:function(){return!1}},this.selector=new c.MultiModelSelector(this),this.visibilityManager=new u.MultiModelVisibilityManager(this),this.showGhosting=!0,this.showOverlaysWhileMoving=!0,this.skipAOWhenMoving=!1,this.keyFrameAnimator=null,this.zoomBoundsChanged=!0;var n=h.LightPresets[h.DefaultLightPreset].bgColorGradient;this.setClearColors(n[0],n[1],n[2],n[3],n[4],n[5]),(ee=new d.GroundShadow(K)).enabled=!0,Le=new Je,Y.addMaterialNonHDR("groundShadowDepthMaterial",ee.getDepthMaterial()),Y.addOverrideMaterial("normalsMaterial",Z.getDepthMaterial()),Y.addOverrideMaterial("edgeMaterial",Z.getEdgeMaterial()),Z.beginScene(this.scene,this.camera,this.noLights,!0),Z.composeFinalFrame(!0,i.isIE11),this.api.addEventListener(D.MODEL_ROOT_LOADED_EVENT,Ie),this.api.addEventListener(D.MODEL_ROOT_LOADED_EVENT,Oe)}},this.getSheetRenderer=function(){return J||(J=new B.Z(F,Z,K,Y)),J},this.isSheetRendererNeeded=function(){return!F.is2d&&this.get2DModels().length>0},this.get2DModels=function(){return ne.getModels().filter((function(e){return e.is2d()}))},this.get3DModels=function(){return ne.getModels().filter((function(e){return e.is3d()}))},this.renderGroundShadow=function(e){Q?Q.state==b.SHADOWMAP_VALID&&Q.renderGroundShadow(F.camera,e||Z.getColorTarget()):(ee.renderShadow(F.camera,e||Z.getColorTarget()),ee.rendered=!0)};var ze,He,We,je=0,qe=1,Xe=2,Ye=4,Ke=8,Ze=15;function Je(){this.highResTimeStamp=-1,this.screenDrawn=je,this.screenHasChanged=!1,this.frameBudget=0,this.frameRemaining=0,this.phase=y.RenderFlags.RENDER_NORMAL,this.signalProgressByRendering=!1,this.tickCount=0,this.beginFrameAvg=0,this.lastBeginFrameTimeStamp=0,this.RENDERMODE_FULL=0,this.RENDERMODE_PROGRESSIVE=1,this.RENDERMODE_SILENT=2,this.renderType=this.RENDERMODE_FULL,this.INITIAL_GROUND_SHADOW=.2,this.cmdListActive=!1,this.cmdIndex=0,this.continueExecution=!0,this.encounteredAlwaysDo=!1,this.finishedFullRender=!0,this.groundShadowInPost=!1,this.drawOverlay=!1,this.cmdIsOpen=!1,this.allocArraySize=0,this.cmdListLength=0,this.cmdList=[],this.paramList=[],this.CMD_NORMAL_SEQUENCE=0,this.CMD_DO_AFTER=1,this.CMD_ALWAYS_DO=2,this.isActive=function(){return this.cmdListActive},this.setFrame=function(e){this.frameBudget=e},this.beginCommandSet=function(){this.cmdListActive=!0,this.cmdIndex=0,this.cmdListLength=0,this.encounteredAlwaysDo=!1,this.tickCount=0,this.screenDrawn=je,this.screenHasChanged=!1},this.endCommandSet=function(){this.cmdIsOpen&&(this.cmdIsOpen=!1,this.cmdListLength++)},this._internalSetParam=function(e,t){this.paramList[this.cmdIndex][e]=t},this.addCommand=function(e,t){for(this.cmdIsOpen&&this.cmdListLength++,this.cmdIsOpen=!0;this.allocArraySize<=this.cmdListLength;)this.cmdList[this.cmdListLength]={},this.paramList[this.cmdListLength]={},this.allocArraySize++;return this.cmdList[this.cmdListLength]=e,this.paramList[this.cmdListLength].executionLevel=t||this.CMD_NORMAL_SEQUENCE,this.encounteredAlwaysDo=this.encounteredAlwaysDo||t===this.CMD_ALWAYS_DO,this.cmdListLength},this.setParam=function(e,t){this.cmdIsOpen?this.paramList[this.cmdListLength][e]=t:G&&f.logger.error("ERROR: cannot set param when no command is open!")},this.getParam=function(e){return G&&void 0===this.paramList[this.cmdIndex][e]&&f.logger.error("ERROR: parameter "+e+" was never set for this command! Go fix it."),this.paramList[this.cmdIndex][e]},this.executeCommandList=function(){if(Le.cmdListActive){var e;if(this.tickCount>0&&(Le.lastBeginFrameTimeStamp=0),this.frameRemaining=this.frameBudget,G&&this.cmdIsOpen&&f.logger.error("ERROR: should call endCommandSet before executing"),this.continueExecution=!0,z&&(0===this.tickCount&&console.log("==================="),console.log("Running commands for "+(Le.renderType===Le.RENDERMODE_PROGRESSIVE?"progressive":Le.renderType===Le.RENDERMODE_FULL?"full":"silent")+" render, for tick count "+this.tickCount)),this.encounteredAlwaysDo)for(var t=0;t<this.cmdIndex;)this.paramList[t].executionLevel>=Le.CMD_ALWAYS_DO&&(z&&console.log("  ALWAYS DO command "+t+": "+this.cmdList[t].name),this.cmdList[t]()),t++;for(;this.cmdIndex<this.cmdListLength;)(this.continueExecution||this.paramList[this.cmdIndex].executionLevel>=Le.CMD_DO_AFTER)&&(z&&console.log("  command "+this.cmdIndex+": "+this.cmdList[this.cmdIndex].name+" and "+Le.frameRemaining+" frame budget remaining"),this.cmdList[this.cmdIndex]()&&(z&&console.log("  >>> out of tick time with "+Le.frameRemaining),e=this.cmdIndex,this.continueExecution=!1)),this.cmdIndex++;return this.continueExecution?this.cmdListActive=!1:this.cmdIndex=e,this.tickCount++,!this.continueExecution}return Le.lastBeginFrameTimeStamp=0,!0}}function Qe(){if(Le.renderType===Le.RENDERMODE_PROGRESSIVE)if(Le.getParam("GenerateGroundShadow.afterBeauty")){if(Le.frameRemaining=ee.prepareGroundShadow(F.modelQueue(),0,Le.frameRemaining),ee.getStatus()==_.GroundFlags.GROUND_RENDERED){if(Le.getParam("GenerateGroundShadow.signalRedraw"))return F.requestSilentRender(),z&&console.log(" $$$$ SIGNAL FULL GROUND SHADOW REDRAW"),!0;Le.groundShadowInPost=!0}}else 0===Le.tickCount&&ee.prepareGroundShadow(F.modelQueue(),10);else Le.frameRemaining=ee.prepareGroundShadow(F.modelQueue(),0,Le.frameRemaining);return Le.frameRemaining<0&&ee.getStatus()===_.GroundFlags.GROUND_UNFINISHED}function $e(){return ee.getStatus()!==_.GroundFlags.GROUND_UNFINISHED&&F.renderGroundShadow(),!1}function et(){return Le.renderType===Le.RENDERMODE_PROGRESSIVE?Le.getParam("GenerateGroundReflection.afterBeauty")?(Le.frameRemaining=te.prepareGroundReflection(ee,F,!1,0,Le.frameRemaining),te.getStatus()==_.GroundFlags.GROUND_RENDERED&&(Le.screenDrawn|=Ke,Le.groundShadowInPost&&Y.hasTransparentMaterial()&&F.requestDeferredSilentRender())):0===Le.tickCount&&te.prepareGroundReflection(ee,F,!0,10):Le.frameRemaining=te.prepareGroundReflection(ee,F,!1,0,Le.frameRemaining),Le.frameRemaining<0&&te.getStatus()===_.GroundFlags.GROUND_UNFINISHED}function tt(){if(Q.state===b.SHADOWMAP_NEEDS_UPDATE)Le.frameRemaining=Q.startUpdate(ne,Le.frameRemaining,F.camera,de,Y);else if(Q.state==b.SHADOWMAP_INCOMPLETE&&(Le.frameRemaining=Q.continueUpdate(ne,Le.frameRemaining,Y),Q.state==b.SHADOWMAP_VALID))return F.requestSilentRender(),z&&console.log(" $$$$ SIGNAL FULL SHADOW MAP REDRAW"),!0;return Le.frameRemaining<0&&Q.state!==b.SHADOWMAP_VALID}function nt(){Q.state=b.SHADOWMAP_NEEDS_UPDATE}function it(){if(Le.signalProgressByRendering&&F.signalProgress(0,o.ProgressState.RENDERING),Le.renderType===Le.RENDERMODE_PROGRESSIVE){if(Le.lastBeginFrameTimeStamp>0){var e=Le.highResTimeStamp-Le.lastBeginFrameTimeStamp;Le.beginFrameAvg=.75*Le.beginFrameAvg+.25*e}Le.lastBeginFrameTimeStamp=Le.highResTimeStamp,Le.beginFrameAvg<re&&Le.frameBudget<ie?(F.targetFrameBudget+=1,F.targetFrameBudget>ie&&(F.targetFrameBudget=ie)):Le.beginFrameAvg>re&&Le.frameBudget>oe&&(F.targetFrameBudget*=.75+.25*re/Le.beginFrameAvg,F.targetFrameBudget<oe&&(F.targetFrameBudget=oe))}var t=Le.getParam("BeginScene.clear");return Z.beginScene(F.scene,F.camera,F.lightsOn?F.lights:F.no_lights,t),t&&(Le.screenDrawn|=Xe),Le.getParam("BeginScene.signalCameraChanged")&&F.api.dispatchEvent(F.cameraChangedEvent),!1}function rt(){var e;if(Le.phase=Le.getParam("BeginPhase.phase"),z&&console.log("     render phase is now "+Le.phase),null===(e=F.glrenderer().xr)||void 0===e?void 0:e.isPresenting){var t=F.glrenderer().xr.getCamera(F.camera);F.camera.projectionMatrix.copy(t.projectionMatrix),t.matrixWorld.decompose(t.position,t.quaternion,t.scale),F.camera.position.copy(t.position),F.camera.quaternion.copy(t.quaternion),F.camera.scale.copy(t.scale),F.camera.matrix.copy(t.matrix),F.camera.matrixWorld.copy(t.matrixWorld)}return ne.reset(F.camera,Le.phase,Le.getParam("BeginPhase.moved"),Y.getCutPlanes()),!1}function ot(){return ne.isEmpty()||ne.isDone()||(Le.screenDrawn|=qe,Le.frameRemaining=ne.renderSome(Ue,Le.frameRemaining),Le.signalProgressByRendering&&(F.signalProgress(100*ne.getRenderProgress(),o.ProgressState.RENDERING),z&&console.log("  %%% percent done "+100*ne.getRenderProgress()))),!ne.isDone()}function at(){return Le.phase=y.RenderFlags.RENDER_FINISHED,Z.renderScenePart(F.sceneAfter,!0,!0,!0),!1}function st(){return Le.phase=y.RenderFlags.RENDER_FINISHED,!1}function lt(){F.signalProgress(100,o.ProgressState.RENDERING)}function ct(){return F.isOverlayDirty()&&(F.clearOverlayDirtyFlag(),Le.drawOverlay=!0),Le.drawOverlay&&(!ne.isEmpty()&&ne.isDone()||F.showOverlaysWhileMoving?(F.renderOverlays(),Le.screenDrawn|=Ye):(Z.clearAllOverlays(),Le.drawOverlay=!1)),!1}function ut(){Le.screenDrawn|=Ze}function ht(){if(Le.screenDrawn&&(Le.phase===y.RenderFlags.RENDER_FINISHED||Le.tickCount%F.frameDisplayRate==0)){var e=!Le.getParam("PostAndPresent.performAO")||(Le.screenDrawn&(Xe|qe))==Xe;Z.composeFinalFrame(e),Le.screenHasChanged=!0,Le.screenDrawn=je,t=Le.highResTimeStamp,Se++,Ee<=t&&Ee>0&&(we=.8*we+.2*(t-Ee)),F.fpsCallback&&F.fpsCallback(F.fps()),F.api.dispatchEvent({type:D.RENDER_PRESENTED_EVENT})}var t;return!1}function dt(){return G&&!1===Z.getAOEnabled()&&f.logger.error("AO should be on at this point!"),Z.setAOEnabled(!1),!1}function pt(){return G&&!0===Z.getAOEnabled()&&f.logger.error("AO should be off at this point!"),Z.setAOEnabled(!0),!1}function ft(){return F.requestSilentRender(),!1}function mt(){return Le.finishedFullRender=!0,!1}this.tick=function(e){Le.highResTimeStamp=e=e||0,K.updateTimestamp(e);var t=Y.updateMaterials();F.invalidate(t.needsClear,t.needsRender,t.overlayDirty);var n=function(e){if(F.keyFrameAnimator){var t=Ee>0?(e-Ee)/1e3:0,n=F.keyFrameAnimator.update(t);if(n&&(F.sceneUpdated(!0),n&F.keyFrameAnimator.UPDATE_CAMERA))return!0}return!1}(e),i=F.controls.update(e),r=ne&&ne.update(e),o=i||n||$||r;$=!1;var a=j;Be(),fe=fe||o,ge=ge||o;var s=!1,l=Z.overlayUpdate();ge?function(){for(var e in F.selectionMeshes){var t=F.selectionMeshes[e];if(t.model){var n=t.model.getFragmentList();t.geometry===n.getGeometry(t.fragId)&&n.getWorldMatrix(t.fragId,t.matrix)}}}():l&&!ge&&(ge=s=!0),this.isLoadingAnimationEnabled()&&Ee-F.lastTime2dGeometryCreated<=K.getLoadingAnimationDuration()&&(me=!0);var c=F.model&&F.model.loader&&F.model.loader.pagingProxy&&F.model.loader.pagingProxy.getMemoryInfo();Le.signalProgressByRendering=F.model&&F.model.isLoadDone()&&!F.model.isLeaflet()&&!c,ye&&(Ve(),ee.setDirty(),ye=!1,1)&&(fe=!0);var u=fe,h=ne.frameResumePossible();if(fe=fe||!h,_e=_e||be&&!Le.cmdListActive,fe||me||ge||_e)if(Le.drawOverlay=ge||fe||me,fe||me||_e){var d,p=u?x.ResetFlags.RESET_RELOAD:x.ResetFlags.RESET_NORMAL;fe||me?(F.progressiveRender?(Le.renderType=Le.RENDERMODE_PROGRESSIVE,d=F.targetFrameBudget):(Le.renderType=Le.RENDERMODE_FULL,d=F.interruptBudget),fe&&(be=_e=!1)):(Le.renderType=Le.RENDERMODE_SILENT,d=F.targetFrameBudget,fe=!0,p=x.ResetFlags.RESET_REDRAW,be=_e=!1),F.skipCameraUpdate||F.updateCameraMatrices(),Le.setFrame(d),Le.finishedFullRender=!1,Le.beginCommandSet();var f=ee.enabled&&!F.is2d&&!Ae,m=!!te&&!F.is2d&&!Ae,g=o||a,v=o&&F.skipAOWhenMoving&&Z.getAOEnabled();Le.addCommand(it),Le.setParam("BeginScene.signalCameraChanged",g),Le.setParam("BeginScene.clear",fe),v&&Le.addCommand(dt,Le.CMD_ALWAYS_DO),ne&&(Q&&Q.state!==b.SHADOWMAP_VALID&&Le.addCommand(tt),f&&(Le.addCommand(Qe),Le.setParam("GenerateGroundShadow.afterBeauty",!1),Le.setParam("GenerateGroundShadow.signalRedraw",!1)),m?(te.setDirty(),Le.addCommand(et),Le.setParam("GenerateGroundReflection.afterBeauty",!1)):f&&fe&&Le.addCommand($e),ne.hasHighlighted()&&(Le.addCommand(rt),Le.setParam("BeginPhase.phase",y.RenderFlags.RENDER_HIGHLIGHTED),Le.setParam("BeginPhase.moved",p),p=!1,Le.addCommand(ot)),Le.addCommand(rt),Le.setParam("BeginPhase.phase",y.RenderFlags.RENDER_NORMAL),Le.setParam("BeginPhase.moved",p),p=!1,Le.addCommand(ot),!ne.areAllVisible()&&F.showGhosting?(m&&Le.renderType===Le.RENDERMODE_PROGRESSIVE||(Le.addCommand(rt),Le.setParam("BeginPhase.phase",y.RenderFlags.RENDER_HIDDEN),Le.setParam("BeginPhase.moved",p),Le.addCommand(ot)),Le.addCommand(at)):Le.addCommand(at),Le.signalProgressByRendering&&Le.addCommand(lt)),Le.addCommand(ct,Le.renderType===Le.RENDERMODE_PROGRESSIVE?Le.CMD_DO_AFTER:Le.CMD_NORMAL_SEQUENCE),Le.addCommand(ht,Le.renderType===Le.RENDERMODE_PROGRESSIVE?Le.CMD_DO_AFTER:Le.CMD_NORMAL_SEQUENCE),Le.setParam("PostAndPresent.performAO",Z.getAOEnabled()&&!v),Le.renderType===Le.RENDERMODE_PROGRESSIVE&&ne&&(Q&&Q.state!==b.SHADOWMAP_VALID&&(Le.addCommand(nt),Le.addCommand(tt)),f&&(Le.addCommand(Qe),Le.setParam("GenerateGroundShadow.afterBeauty",!0),Le.setParam("GenerateGroundShadow.signalRedraw",!m),Le.signalProgressByRendering&&Le.addCommand(lt)),m&&(Le.groundShadowInPost=!1,Le.addCommand(et),Le.setParam("GenerateGroundReflection.afterBeauty",!0),!ne.areAllVisible()&&F.showGhosting&&(Le.addCommand(rt),Le.setParam("BeginPhase.phase",y.RenderFlags.RENDER_HIDDEN),Le.setParam("BeginPhase.moved",p),Le.addCommand(ot)),Le.addCommand(st),Le.addCommand(ht),Le.setParam("PostAndPresent.performAO",Z.getAOEnabled()&&!v),Le.signalProgressByRendering&&Le.addCommand(lt))),v&&(Le.addCommand(pt,Le.CMD_ALWAYS_DO),Le.addCommand(ft)),Le.addCommand(mt),Le.endCommandSet(),fe=!1,me=!1,ge=!1}else Le.finishedFullRender&&(Le.beginCommandSet(),z&&console.log("=====\nOVERLAY DIRTY"),s?Le.addCommand(ut):Le.addCommand(ct,!0),Le.addCommand(ht,!0),Le.setParam("PostAndPresent.performAO",Z.getAOEnabled()),Le.signalProgressByRendering&&Le.addCommand(lt),Le.endCommandSet(),ge=!1);De=Le.cmdListActive,F.onBeforeRender&&F.onBeforeRender(De),Le.executeCommandList(),De!==Fe&&(F.api.dispatchEvent({type:D.FINAL_FRAME_RENDERED_CHANGED_EVENT,value:{finalFrame:!De}}),Fe=De),Ee=Le.highResTimeStamp},this.setLmvDisplay=function(e){e},this.run=function(){0,setTimeout((function(){var e=F.glrenderer();F._render=function(e){F.tick(e)},e.addAnimationLoop(F._render)}),1)},this.stop=function(){this.glrenderer().removeAnimationLoop(this._render),this._render=null},this.toggleProgressive=function(e){this.progressiveRender=e,fe=!0},this.updateClearColors=function(){var e=this.clearColorTop;if(this.is2d&&this.swapBlackAndWhite){var t=1===e.x&&1===e.y&&1===e.z,n=0===e.x&&0===e.y&&0===e.z;t?e=new L.Color(0,0,0):n&&(e=new L.Color(1,1,1))}Z.setClearColors(e,this.clearColorBottom)},this.toggleSwapBlackAndWhite=function(e){this.swapBlackAndWhite=e,this.updateClearColors(),fe=!0},this.toggleGrayscale=function(e){Y.setGrayscale(e),fe=!0},this.toggleGhosting=function(e){this.showGhosting=e,fe=!0},this.toggleOverlaysWhileMoving=function(e){this.showOverlaysWhileMoving=e},this.togglePostProcess=function(e,t){Z.initPostPipeline(e,t),this.fireRenderOptionChanged(),fe=!0},this.toggleCmdMapping=function(e,t){t.keyMapCmd=e},this.toggleGroundShadow=function(e){ee.enabled!==e&&(ee.enabled=e,ee.clear(),e&&ee.setDirty(),Ve(),this.fireRenderOptionChanged(),this.invalidate(!0,!1,!1))},this.isGroundShadowEnabled=function(){return ee&&ee.enabled},this.setGroundShadowColor=function(e){ee.enabled&&(ee.setColor(e),this.invalidate(!0,!1,!1))},this.setGroundShadowAlpha=function(e){ee.enabled&&(ee.setAlpha(e),this.invalidate(!0,!1,!1))},this.toggleGroundReflection=function(e){e&&te||!e&&!te||(e?((te=new E.GroundReflection(K,this.canvas.clientWidth,this.canvas.clientHeight,{clearPass:Z.getClearPass()})).setClearColors(this.clearColorTop,this.clearColorBottom,(0,i.isMobileDevice)()),te.toggleEnvMapBackground(Me),te.setEnvRotation(Z.getEnvRotation()),Ve()):(te.cleanup(),te=void 0),this.fireRenderOptionChanged(),this.invalidate(!0,!1,!1))},this.setGroundReflectionColor=function(e){te&&(te.setColor(e),this.invalidate(!0,!1,!1))},this.setGroundReflectionAlpha=function(e){te&&(te.setAlpha(e),this.invalidate(!0,!1,!1))},this.toggleEnvMapBackground=function(e){Me=e,Z.toggleEnvMapBackground(e),te&&te.toggleEnvMapBackground(e),this.invalidate(!0,!0,!1)},this.isEnvMapBackground=function(){return Me},this.setOptimizeNavigation=function(e){this.skipAOWhenMoving=e},this.renderOverlays=function(){!function(){for(var e in F.selectionMeshes){var t=F.selectionMeshes[e];t.model&&t.model.isConsolidated()&&t.model.updateRenderProxy(t,t.fragId)}}();var e,t=this.lightsOn;t||this.toggleLights(!0,!0),this.dir_light1&&(e=this.dir_light1.intensity,this.dir_light1.intensity=1),Z.renderOverlays(this.overlayScenes,this.lightsOn?this.lights:this.no_lights),t||this.toggleLights(!1,!0),this.dir_light1&&(this.dir_light1.intensity=e)},this.setLayerVisible=function(e,t){this.layers.setLayerVisible(e,t)},this.isLayerVisible=function(e){return this.layers.isLayerVisible(e)},this.getVisibleLayerIndices=function(){return this.layers.getVisibleLayerIndices()},this.setNearRadius=function(e,t){this.nearRadius!==e&&(this.nearRadius=e,t&&this.invalidate(!0))},this.getNearRadius=function(){return this.nearRadius},this.updateNearFarValues=function(e,t){if(t.isEmpty())f.logger.warn("Calculating near-far values based on empty worldBox (infinity) will result in incorrect values - Better to keep previous values instead.");else{if(We||(ze=new L.Matrix4,He=new L.Matrix4,We=new L.Box3),ze.compose(e.position,e.quaternion,e.scale),He.copy(ze).invert(),We.copy(t),te){var n=new L.Vector3;n.multiplyVectors(We.max,e.worldup);var i=new L.Vector3;i.multiplyVectors(We.min,e.worldup),n.sub(i),n.x>=0?We.min.x-=n.x:We.max.x-=n.x,n.y>=0?We.min.y-=n.y:We.max.y-=n.y,n.z>=0?We.min.z-=n.z:We.max.z-=n.z}Q&&Q.groundShapeBox&&We.union(Q.groundShapeBox),We.applyMatrix4(He);var r=1e-5*(We.max.z-We.min.z),o=.5*(We.max.y-We.min.y),a=-(We.max.z+r)-o,s=-(We.min.z-r)+o;if(e.isPerspective){this.nearRadius>0?(a=Math.max(a,Math.min(this.nearRadius,1e-4*Math.abs(s-a))),s=Math.min(s,1e4*a)):(a=Math.max(a,Math.min(1,1e-4*Math.abs(s-a))),s<0&&(s=1e-4),a=Math.max(a,1e-5*s));var l=Math.sqrt(k.SceneMath.pointToBoxDistance2(e.position,t)),c=Math.max(1,l);a=Math.min(a,c)}if(s=Math.max(s,a),Autodesk.Viewing.isSafari()&&!this.glrenderer().isWebGL2()){var u=s/a;e.isPerspective&&u>2e3&&(a=Math.max(a,1))}e.near=a,e.far=s,e.updateProjectionMatrix(),e.updateMatrixWorld()}},this.getPixelsPerUnit=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.model,i=Z.settings.deviceHeight,r=Y.getCutPlanesRaw(),o=r[0],a=n?n.getBoundingBox():t;return k.SceneMath.getPixelsPerUnit(e,this.is2d,t,i,o,a)},this.updateCameraMatrices=function(){var e,t=this,n=this.camera;n.worldup&&this.setWorldUp(n.worldup);var i=this.getVisibleBounds(!0,ge);(null===(e=this.glrenderer().xr)||void 0===e?void 0:e.isPresenting)?(n.near=.1,n.far=100,n.updateProjectionMatrix(),n.updateMatrixWorld()):this.updateNearFarValues(n,i),this.maxModelDistance&&this._applyMaxModelDistanceToNearFar();var r=this.getPixelsPerUnit(n,i),o=Z.settings.deviceWidth,a=Z.settings.deviceHeight;this.is2d?(Y.updatePixelScale(r,o,a),Y.updateSwapBlackAndWhite(this.swapBlackAndWhite)):Y.updatePixelScale(r,o,a),this.get2DModels().forEach((function(e){var i=e.getModelToViewerTransform(),r=i?i.getMaxScaleOnAxis():1;if(!t.is2d||1!==r){var s=e.getVisibleBounds(),l=k.SceneMath.getPixelsPerUnit(n,!0,s,a,null,s);Y.updatePixelScaleForModel(e,l,o,a,r)}}))},this.initLights=function(){Te||(this.dir_light1=new L.DirectionalLight(Ce,1),this.dir_light1.position.copy(pe),this.amb_light=new L.AmbientLight(Pe),this.lights=[this.dir_light1,this.amb_light],this.camera.add(this.dir_light1),this.camera.add(this.dir_light1.target),Te=!0)};function gt(e){return Y._getMaterialHash(e,"selection2d")}function vt(){if(!(0,i.isMobileDevice)()){var e=ne.getModels().length,t=Z.mrtFlags();if(e>1&&t.mrtIdBuffer<2)Z.setIdTargetCount(2)&&Y.toggleMRTSetting(Z.mrtFlags())}}this.toggleLights=function(e,t){this.amb_light&&(this.lightsOn=e,function(e,t,n,i){var r=h.LightPresets[ae],o=r&&r.ambientColor,a=r&&r.directLightColor;o=o||Pe.toArray(),a=a||Ce.toArray(),n?(i&&e?e.color.setRGB(.5*a[0],.5*a[1],.5*a[2]):e&&e.color.setRGB(o[0],o[1],o[2]),t&&t.color.setRGB(a[0],a[1],a[2])):e&&i&&e.color.setRGB(o[0],o[1],o[2])}(this.amb_light,this.dir_light1,e,t))},this.syncCamera=function(e){this.camera.updateCameraMatrices(),e&&this.setWorldUp(this.api.navigation.getWorldUpVector()),$=!0},this.getModelCamera=function(e){if(e){var t=e.getDefaultCamera();return t||R.UnifiedCamera.getViewParamsFromBox(e.getBoundingBox(),e.is2d(),this.camera.aspect,this.camera.up,this.camera.fov)}},this.setViewFromFile=function(e,t){if(e){var n=this.getModelCamera(e),i=e.getMetadata("navigation hint","value",null),r=this.controls.isToolActivated("freeorbit")||t&&"Freeorbit"===i;this.setViewFromCamera(n,t,r)}},this.adjustOrthoCamera=function(e){var t=this.getVisibleBounds();R.UnifiedCamera.adjustOrthoCamera(e,t)},this.setViewFromCamera=function(e,t,n){this.adjustOrthoCamera(e);var i,r=this.model?this.model.getUpVector():null;i=r?(new L.Vector3).fromArray(r):n?e.up.clone():I.Navigation.snapToAxis(e.up.clone()),n?this.api.prefs&&this.api.prefs.set("fusionOrbitConstrained",i.equals(e.up)):e.up=i;var o=this.api.navigation;if(o){var a=this.camera;if(t)a.up.copy(e.up),a.position.copy(e.position),a.target.copy(e.target),e.isPerspective?a.fov=e.fov:(a.saveFov=e.fov,a.fov=R.UnifiedCamera.ORTHO_FOV),a.isPerspective=e.isPerspective,a.orthoScale=e.orthoScale,a.dirty=!0,o.setWorldUpVector(n?i:a.up),o.setView(a.position,a.target),o.setPivotPoint(a.target),this.syncCamera(!0);else if(a.isPerspective=e.isPerspective,e.isPerspective||(a.saveFov=e.fov,e.fov=R.UnifiedCamera.ORTHO_FOV),n)o.setRequestTransitionWithUp(!0,e.position,e.target,e.fov,e.up,i);else{var s=this.getVisibleBounds();if(!s.containsPoint(e.target)){var l=s.getCenter(new L.Vector3).distanceTo(e.position),c=e.target.clone().sub(e.position).normalize().multiplyScalar(l);e.target.copy(e.position.clone().add(c))}var u=o.computeOrthogonalUp(e.position,e.target);o.setRequestTransitionWithUp(!0,e.position,e.target,e.fov,u,i)}}$=!0},this.getViewArrayFromCamera=function(e){var t,n=e||{x:0,y:0,z:0},i=this.camera,r=this.model.getUpVector();t=r?(new L.Vector3).fromArray(r):I.Navigation.snapToAxis(i.up.clone());var o=this.api.navigation.getPivotPoint();return[i.position.x+n.x,i.position.y+n.y,i.position.z+n.z,o.x+n.x,o.y+n.y,o.z+n.z,t.x,t.y,t.z,i.aspect,L.Math.degToRad(i.fov),i.orthoScale,i.isPerspective?0:1]},this.setViewFromViewBox=function(e,t,n,i){if(e.is2d()){var r={},o=e.getBoundingBox(),a={width:t[2]-t[0],height:t[3]-t[1]};a.aspect=a.width/a.height,a.centerX=t[0]+a.width/2,a.centerY=t[1]+a.height/2;var s=this.camera.aspect;s>a.aspect?r.orthoScale=a.height:r.orthoScale=a.width/s;var l=o.getCenter(new L.Vector3);r.isPerspective=!1,r.position=new L.Vector3(a.centerX,a.centerY,l.z+r.orthoScale),r.target=new L.Vector3(a.centerX,a.centerY,l.z),r.target.y+=1e-6*a.height,r.up=new L.Vector3(0,0,1),this.setViewFromCamera(r,i,!1)}},this.setWorldUp=function(e){if(!H.equals(e)){H.copy(e);var t=Math.abs(e.x);ue="x",Math.abs(e.y)>t&&(ue="y",t=Math.abs(e.y)),Math.abs(e.z)>t&&(ue="z");var n,i,r,o,a=new L.Vector3(0,1,0);F.camera.worldUpTransform=(n=a,i=e,r=(new L.Vector3).crossVectors(i,n).normalize(),o=Math.acos(n.dot(i)),(new L.Matrix4).makeRotationAxis(r,o)),this.sceneUpdated(!1)}},this.setUp2DMode=function(e,t){var n=e.getData();n.layerCount&&Y.initLayersTexture(n.layerCount,n.layersMap,e.id);var i=Y.create2DMaterial(null,{},!0,!1,(function(){F.invalidate(!1,!0,!1)})),r=Y.findMaterial(null,i);if(!t){this.is2d&&Z.exit2DMode(),Z.enter2DMode(r,this.matman().get2dSelectionColor()),this.is2d||this.saveLightPreset(),this.is2d=!0,this.setLightPreset(h.DefaultLightPreset2d),this.setRenderingPrefsFor2D(!0);var o=e.getData();if(o.hidePaper){var a=o.bgColor,s=a>>16&255,l=a>>8&255,c=255&a;this.setClearColors(s,l,c,s,l,c)}}},this.addModel=function(e,t){if(e){var n=!!this.model,i=e.is2d();this.model||e.getData().underlayRaster||(this.model=e,Z.setUnitScale(e.getUnitScale())),this.layers||(this.layers=new w.ModelLayers(this)),e.getData().underlayRaster||this.layers.addModel(e,!0),ne.addModel(e),this.selector.addModel(e),this.visibilityManager.addModel(e),this._setModelPreferences(e),i?this.setUp2DMode(e,n):this.is2d?(this.is2d=void 0,Z.exit2DMode()):le>=0&&(se=le),this.updateClearColors(),this.setupLighting(e),vt(),this.fireRenderOptionChanged(),this.invalidate(!0),this.api.fireEvent({type:D.MODEL_ADDED_EVENT,model:e,preserveTools:t,isOverlay:n})}},this._setModelPreferences=function(e){e.hideLines(!this.api.prefs.get("lineRendering")),e.hidePoints(!this.api.prefs.get("pointRendering")),e.selector.setSelectionMode(this.api.prefs.get(U.Prefs3D.SELECTION_MODE))},this.setupLighting=function(e){e=e||this.model,(0,i.isNodeJS)()||!e||e.is2d()||(this.setLightPresetFromFile(e)||(se>=0?(this.setLightPreset(se,!0,ce),se=-1,ce=null):this.setLightPreset(ae,!1)),this.setAOHeuristics(e))},this.getSvfMaterialId=function(e){return this.model.getFragmentList().getSvfMaterialId(e)},this.getMaterials=function(){return Y},this.setupMesh=function(e,t,n,i){var r={geometry:t,matrix:i,isLine:t.isLines,isWideLine:t.isWideLines,isPoint:t.isPoints,is2d:t.is2d};return n&&(r.material=this.matman().setupMaterial(e,t,n)),e.is2d()&&(r.geometry.creationTime=Ee,this.lastTime2dGeometryCreated=Ee),r},this.init2dSelection=function(e){var t=gt(e);if(!this.overlayScenes[t]){var n,i=Y.initSelectionTexture(e.getData().maxObjectNumber,e.id),r=e.getFragmentList(),o=e.getDoNotCut();if(null==r?void 0:r.viewBounds){var a=r.viewBounds;n=new L.Vector4(a.min.x,a.min.y,a.max.x,a.max.y)}var s=Y.create2DMaterial(e,{doNotCut:o,viewportBounds:n},!1,i,(function(){F.invalidate(!1,!0,!1)})),l=Y.findMaterial(e,s);this.createOverlayScene(t,l)}},this.onLoadComplete=function(e){Ae=!1,this.signalProgress(100,o.ProgressState.LOADING),this.modelVisible(e.id)&&((ee&&ee.enabled||te)&&this.sceneUpdated(!1,!0),this.invalidate(!!te,!0,!1)),e.is2d()&&this.init2dSelection(e);var t=e.getGeometryList();t&&t.printStats(),e.hasGeometry()?Y.hasTransparentMaterial()&&this.requestSilentRender():f.logger.warn("Loaded model has no geometry."),this.handleInitialVisibility(e),this.api.dispatchEvent({type:D.GEOMETRY_LOADED_EVENT,model:e})},this.onTextureLoadComplete=function(e){this.api.dispatchEvent({type:D.TEXTURES_LOADED_EVENT,model:e}),this.requestSilentRender()},this.signalProgress=function(e,t,n){ve.percent===e&&ve.state===t&&n&&ve.model&&ve.model.id===n.id||(ve.percent=e,ve.state=t,n&&(ve.model=n),this.api.dispatchEvent(ve))},this.resize=function(e,t,n){var i,r;(null===(i=this._webglrenderer)||void 0===i||null===(r=i.xr)||void 0===r?void 0:r.isPresenting)?console.warn("Viewer3DImpl: Can't change size while XR device is presenting."):(j=!0,q=e,X=t,n&&Be(!0))},this.unloadModel=function(e,t){(this.removeModel(e)||ne.removeHiddenModel(e))&&(t||(e.dtor(this.glrenderer()),Y.cleanup(e),e.loader&&(e.loader.dtor(),e.loader=null)),e.is2d()&&this.overlayScenes[e.id]&&this.removeOverlayScene(gt(e)),this.api.dispatchEvent({type:D.MODEL_UNLOADED_EVENT,model:e}))},this._reserveLoadingFile=function(){this.loaders||(this.loaders=[]);var e={dtor:function(){}};return this.loaders.push(e),e},this._hasLoadingFile=function(){return this.loaders&&this.loaders.length>0},this._addLoadingFile=function(e,t){if(this.loaders){var n=this.loaders.indexOf(e);n>=0&&(this.loaders[n]=t)}},this._removeLoadingFile=function(e){if(this.loaders){var t=this.loaders.indexOf(e);t>=0&&this.loaders.splice(t,1)}},this.removeModel=function(e){return!!ne.removeModel(e)&&(this.keyFrameAnimator&&(this.keyFrameAnimator.destroy(),this.keyFrameAnimator=null),this.selector.removeModel(e),this.visibilityManager.removeModel(e),this.layers.removeModel(e),e===this.model&&(this.model=null,ne.isEmpty()||(this.model=ne.getModels()[0])),vt(),this.invalidate(!0,!0,!0),this.api.fireEvent({type:D.MODEL_REMOVED_EVENT,model:e}),!0)},this.cancelLoad=function(e){if(this.loaders)for(var t=0;t<this.loaders.length;t++){var n=this.loaders[t];if(n.currentLoadPath===e){n.dtor(),this.loaders.splice(t,1);break}}},this.unloadCurrentModel=function(){this.model&&(this.is2d?(this.is2d=void 0,this.removeOverlayScene(gt(this.model)),Z.exit2DMode()):se=ae,this.model.is3d()&&(le=ae),Z.beginScene(this.scene,this.camera,this.lightsOn?this.lights:this.no_lights,!0),Z.composeFinalFrame(!0)),this.loaders&&(this.loaders.forEach((function(e){e.dtor()})),this.loaders=[]);for(var e=ne.getAllModels(),t=e.length-1;t>=0;t--)this.unloadModel(e[t]);this.model=null};var yt=function(){var e,t,n;F.selectionMaterialBase=new L.MeshPhongMaterial({specular:526344,ambient:0,opacity:1,transparent:!1}),F.selectionMaterialTop=new L.MeshPhongMaterial({specular:526344,ambient:0,opacity:.15,transparent:!0}),F.selectionMaterialTop.packedNormals=!0,F.selectionMaterialBase.packedNormals=!0,e="selection",t=F.selectionMaterialBase,n=F.selectionMaterialTop,t.depthWrite=!1,t.depthTest=!0,t.side=L.DoubleSide,n.depthWrite=!1,n.depthTest=!0,n.side=L.DoubleSide,Y.addInstancingSupport(t),Y.addInstancingSupport(n),F.createOverlayScene(e,t,n),F.highlightMaterial=new L.MeshPhongMaterial({specular:526344,ambient:0,opacity:1,transparent:!1}),F.highlightMaterial.packedNormals=!0,Y.addInstancingSupport(F.highlightMaterial),Y.addMaterial("__highlightMaterial__",F.highlightMaterial,!0)};this.createOverlayScene=function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];t&&Y.addOverrideMaterial(e+"_pre",t),n&&Y.addOverrideMaterial(e+"_post",n);var a=new L.Scene;return a.__lights=this.scene.__lights,this.overlayScenes[e]={scene:a,camera:i,materialName:e,materialPre:t,materialPost:n,needIdTarget:r,needSeparateDepth:o}},this.removeOverlayScene=function(e){if(this.overlayScenes[e]){var t=this.overlayScenes[e];t.materialPre&&Y.removeMaterial(t.materialName+"_pre"),t.materialPost&&Y.removeMaterial(t.materialName+"_post"),delete this.overlayScenes[e],this.invalidate(!1,!1,!0)}},this.addOverlay=function(e,t){this.overlayScenes[e]&&(this.overlayScenes[e].scene.add(t),this.invalidate(!1,!1,!0))},this.addMultipleOverlays=function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&this.addOverlay(e,t[n])},this.removeOverlay=function(e,t){this.overlayScenes[e]&&(this.overlayScenes[e].scene.remove(t),this.invalidate(!1,!1,!0))},this.removeMultipleOverlays=function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&this.removeOverlay(e,t[n])},this.clearOverlay=function(e){if(this.overlayScenes[e]){var t,n,i=this.overlayScenes[e].scene;for(n=i.children.length-1;n>=0;--n)(t=i.children[n])&&i.remove(t);this.invalidate(!1,!1,!0)}},this.setClearColors=function(e,t,n,r,o,a){this.clearColorTop=new L.Vector3(e/255,t/255,n/255),this.clearColorBottom=new L.Vector3(r/255,o/255,a/255),this.updateClearColors(),te&&te.setClearColors(this.clearColorTop,this.clearColorBottom,(0,i.isMobileDevice)()),fe=!0,this.fireRenderOptionChanged()},this.setClearAlpha=function(e){Z.setClearAlpha(e)};var bt=new L.Box3;function _t(e,t,n){t.updateMatrixWorld(!0),t.traverse((function(t){var i=t.geometry,r=t.model&&"number"==typeof t.fragId;if(!r||i.boundingBox)void 0!==i&&t.visible&&(i.boundingBox||i.computeBoundingBox(),bt.copy(i.boundingBox),bt.applyMatrix4(t.matrixWorld),n&&!n(bt)||e.union(bt));else{var o=r&&t.model.getFragmentList();o&&(o.getWorldBounds(t.fragId,bt),n&&!n(bt)||e.union(bt))}}))}var xt,Et=new L.Box3;this.getVisibleBounds=function(e,t,n,i){var r=new L.Box3;return ne.isEmpty()||(_t(r,this.scene,n),r=ne.getVisibleBounds(e,n,i).union(r),t&&(r=function(e){Et.makeEmpty();var t=F.overlayScenes;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&_t(Et,t[n].scene,e);return _t(Et,F.scene,e),_t(Et,F.sceneAfter,e),Et}(n).union(r))),r},this.getFitBounds=function(e){var t;return e||null===this.selector||(t=this.selector.getSelectionBounds()),t&&!t.isEmpty()||(t=this.getVisibleBounds()),t},this.getRenderProxy=function(e,t){var n;return null===(n=e.getFragmentList())||void 0===n?void 0:n.getVizmesh(t)},this.getLayersRoot=function(){return this.layers.getRoot()},this.getFragmentProxy=function(e,t){return new S.FragmentPointer(e.getFragmentList(),t)},this.getRenderProxyCount=function(e){return e.getFragmentList().getCount()},this.getRenderProxyDbIds=function(e,t){return e.getFragmentList().getDbIds(t)},this.isWholeModelVisible=function(){return!ne||ne.areAllVisible()},this.isNodeVisible=function(e,t){return this.visibilityManager.isNodeVisible(t,e)},this.highlightObjectNode=function(e,t,n,i){t=e.reverseMapDbIdFor2D(t),e.is2d()&&(Y.highlightObject2D(t,n,e.id),this.invalidate(!1,!1,!0)),this.renderer().setDbIdForEdgeDetection(n&&!i?t:0,n?e.id:0);var r=this,o=e.getData().instanceTree;if(o&&!e.is2d())if(e.useIdBufferSelection){var a=e.getData().fragments.dbId2fragId[t];r.highlightFragment(e,a,n,i)}else o.enumNodeFragments(t,(function(t){r.highlightFragment(e,t,n,i)}),!1);else{var s=t;if(e.is2d()&&e.getData().fragments&&(s=e.getData().fragments.dbId2fragId[t]),Array.isArray(s))for(var l=0;l<s.length;l++)r.highlightFragment(e,s[l],n,i);else r.highlightFragment(e,s,n,i)}},this.highlightFragment=function(e,t,n,i){if(e.isLeaflet())return e.getIterator().highlightSelection(n,this.highlightMaterial.color),void this.invalidate(!0);var r=this.getRenderProxy(e,t);if(r){var o=!i||r.is2d||r.isPoint||r.themingColor,a=e.id+":"+t;if(o){var s="selection";if(e.is2d()&&(s=gt(e)),r.isPoint&&(s+="_points"),n)if(r.is2d&&Object.prototype.hasOwnProperty.call(this.selectionMeshes,a))++this.selectionMeshes[a]._lmv_highlightCount;else{var l;if(!r||!r.geometry)return;if(r.isPoint){var c=r.material.clone();c.color=this.selectionMaterialBase.color,c.needsUpdate=!0,c.defines&&r.geometry.attributes.pointScale&&(c.defines.PARTICLE_FLAGS=1),l=new L.Mesh(r.geometry,c)}else l=new L.Mesh(r.geometry,r.material);l.matrix.copy(r.matrixWorld),l.matrixAutoUpdate=!1,l.matrixWorldNeedsUpdate=!0,l.frustumCulled=!1,l.model=e,l.fragId=t,l._lmv_highlightCount=1,this.addOverlay(s,l),this.selectionMeshes[a]=l}else if(Object.prototype.hasOwnProperty.call(this.selectionMeshes,a)){var u=this.selectionMeshes[a];--u._lmv_highlightCount<=0&&(this.removeOverlay(s,u),delete this.selectionMeshes[a])}}o&&n||e.setHighlighted(t,n)&&this.invalidate(!0)}},this.explode=function(e){return(e=Number(e))!=xe&&(xe=e,this.refreshExplode(),this.api.dispatchEvent({type:D.EXPLODE_CHANGE_EVENT,scale:e}),!0)},this.refreshExplode=function(){ne.explode(xe),this.sceneUpdated(!0)},this.getExplodeScale=function(){return xe},this.lockExplode=function(e,t,n){var i=(n=n||this.model).getData().instanceTree;if(!i)return!1;var r,o=function(e,n){return i.enumNodeChildren(n,(function(n){e=i.lockNodeExplode(n,t)||e}),!0),e};return(r=Array.isArray(e)?e.reduce(o,!1):o(!1,e))&&xe>0&&(ne.explode(xe),this.sceneUpdated(!0)),r},this.isExplodeLocked=function(e,t){var n=(t=t||this.model).getData().instanceTree;return n&&n.isNodeExplodeLocked(e)},this.setGhostingBrightness=function(e){var t=new L.Color(e?1052688:16777215);function n(e){e.color=t}n(this.fadeMaterial),this.fadeMaterial.variants&&this.fadeMaterial.variants.forEach(n)},this.loadCubeMapFromColors=function(e,t){var n=(0,A.CreateCubeMapFromColors)(e,t);return n.isBgColor=!0,Y.setReflectionMap(n),n},this.loadCubeMap=function(e,t){this._reflectionMapPath=e;return m.TextureLoader.loadCubeMap(e,t,(function(t){e===F._reflectionMapPath&&Y&&(Y.setReflectionMap(t),F.invalidate(!0),t?h.LightPresets[ae].useIrradianceAsBackground||Z.setCubeMap(t):F.loadCubeMapFromColors(F.clearColorTop,F.clearColorBottom))}))},this.loadIrradianceMap=function(e,t){this._irradianceMapPath=e;return m.TextureLoader.loadCubeMap(e,t,(function(t){e===F._irradianceMapPath&&Y&&(Y.setIrradianceMap(t),F.invalidate(!0),h.LightPresets[ae].useIrradianceAsBackground&&Z.setCubeMap(t))}))},this.setCurrentLightPreset=function(e){ae=e},this.setLightPreset=function(e,t,n){if((0,i.isNodeJS)()&&(e=0),this.initLights(),ae!==e||t){if((e<0||h.LightPresets.length<=e)&&(e=h.DefaultLightPreset),ae=e,ne.isEmpty())return se=ae,void(ce=n);var r=h.LightPresets[e],o=r.bgColorGradient;if(o||(o=h.BackgroundPresets.Custom),this.setClearColors(o[0],o[1],o[2],o[3],o[4],o[5]),void 0!==r.useIrradianceAsBackground&&(this.api.prefs.hasTag("envMapBackground","ignore-producer")?f.logger.debug("setLightPreset(): envMapBackground is locked. No changes."):(this.api.prefs.tag("no-storage","envMapBackground"),this.api.setEnvMapBackground(r.useIrradianceAsBackground))),r.path){var a="res/environments/"+r.path,s=(0,M.getResourceUrl)(a+"_mipdrop."+(r.type||"")+".dds"),l=(0,M.getResourceUrl)(a+"_irr."+(r.type||"")+".dds");this.loadIrradianceMap(l,r.E_bias),this.loadCubeMap(s,r.E_bias),Y.setEnvExposure(-r.E_bias),Z.setEnvExposure(-r.E_bias),this.setTonemapExposureBias(r.E_bias),this.setTonemapMethod(r.tonemap),this.setGhostingBrightness(r.darkerFade)}else{var c=this.loadCubeMapFromColors(this.clearColorTop,this.clearColorBottom);Z.setCubeMap(c),Y.setIrradianceMap(null),Y.setEnvExposure(-r.E_bias||0),Z.setEnvExposure(-r.E_bias||0),this.setTonemapExposureBias(r.E_bias||0),this.setTonemapMethod(r.tonemap||0),this.setGhostingBrightness(r.darkerFade),Z.toggleEnvMapBackground(Me),this.invalidate(!0)}var u=T.SAOShader.uniforms.radius.value,d=T.SAOShader.uniforms.intensity.value;Object.prototype.hasOwnProperty.call(r,"saoRadius")&&(u=r.saoRadius),Object.prototype.hasOwnProperty.call(r,"saoIntensity")&&(d=r.saoIntensity),Z.setAOOptions(u,d);var p=1;null!==r.lightMultiplier&&void 0!==r.lightMultiplier&&(p=r.lightMultiplier),de.copy(he),r.lightDirection&&de.fromArray(r.lightDirection).negate(),Q&&Ge(),this.dir_light1&&(this.dir_light1.intensity=p,r.lightDirection?this.dir_light1.position.set(-r.lightDirection[0],-r.lightDirection[1],-r.lightDirection[2]):this.dir_light1.position.copy(pe)),Y.setEnvRotation(r.rotation||0),Z.setEnvRotation(r.rotation||0),te&&te.setEnvRotation(r.rotation||0),this.toggleLights(0!==p),this.invalidate(!0,!1,!0),this.fireRenderOptionChanged(),n&&n()}else n&&n()},this.setLightPresetFromFile=function(e){if(!e||e.is2d())return!1;var t,n=e.getMetadata("renderEnvironmentGroundReflection","value",null);t=this.api.prefs.hasTag(U.Prefs3D.GROUND_REFLECTION,"ignore-producer"),null===n||t||(this.api.prefs.tag("no-storage",U.Prefs3D.GROUND_REFLECTION),this.api.setGroundReflection(n));var r=e.getMetadata("renderEnvironmentGroundShadow","value",null);t=this.api.prefs.hasTag(U.Prefs3D.GROUND_SHADOW,"ignore-producer"),null===r||t||(this.api.prefs.tag("no-storage",U.Prefs3D.GROUND_SHADOW),this.api.setGroundShadow(r));var o=e.getMetadata("renderEnvironmentAmbientShadows","value",null);t=this.api.prefs.hasTag(U.Prefs3D.AMBIENT_SHADOWS,"ignore-producer"),null===o||t||(this.api.prefs.tag("no-storage",U.Prefs3D.AMBIENT_SHADOWS),this.api.setQualityLevel(o,Z.getAntialiasing()));var a=e.getMetadata("renderEnvironmentDisplayLines","value",null);t=this.api.prefs.hasTag(U.Prefs3D.LINE_RENDERING,"ignore-producer"),null===a||t||(this.api.prefs.tag("no-storage",U.Prefs3D.LINE_RENDERING),this.api.hideLines(!a));var s=e.getMetadata("renderEnvironmentDisplayPoints","value",null);t=this.api.prefs.hasTag(U.Prefs.POINT_RENDERING,"ignore-producer"),null===s||t||(this.api.prefs.tag("no-storage",U.Prefs.POINT_RENDERING),this.api.hidePoints(!s));var l=e.getMetadata("renderEnvironmentDisplayEdges","value",null);t=this.api.prefs.hasTag(U.Prefs3D.EDGE_RENDERING,"ignore-producer"),null===l||t||(this.api.prefs.tag("no-storage",U.Prefs3D.EDGE_RENDERING),this.api.setDisplayEdges(!(0,i.isMobileDevice)()&&!!l));var c=e.getMetadata("renderEnvironmentStyle","value",null),u=h.LightPresets.filter((function(e){return e.name===c}))[0];if(t=this.api.prefs.hasTag(U.Prefs3D.LIGHT_PRESET,"ignore-producer"),u&&!t){this.api.prefs.tag("no-storage",U.Prefs3D.LIGHT_PRESET);var d=V;d||(d=V={},h.LightPresets.push(d)),(0,h.copyLightPreset)(u,d),d.name="Custom Model defined";var p=e.getMetadata("renderEnvironmentExposureBias","value",null),f=e.getMetadata("renderEnvironmentExposureBase","value",null);null!==p&&null!==f&&(d.E_bias=p+f);var m=e.getMetadata("renderEnvironmentBackgroundColor","value",null);t=this.api.prefs.hasTag(U.Prefs.BACKGROUND_COLOR_PRESET,"ignore-producer"),m&&!t&&(d.bgColorGradient=[255*m[0],255*m[1],255*m[2],255*m[0],255*m[1],255*m[2]]);var g=e.getMetadata("renderEnvironmentRotation","value",null);null!==g&&(d.rotation=g);var v=h.LightPresets.indexOf(d);this.setLightPreset(v,!0)}var y=e.getMetadata("renderEnvironmentBackgroundFromEnvironment","value",null);return t=this.api.prefs.hasTag(U.Prefs3D.ENV_MAP_BACKGROUND,"ignore-producer"),null===y||t||(this.api.prefs.tag("no-storage",U.Prefs3D.ENV_MAP_BACKGROUND),this.api.setEnvMapBackground(y)),u},this.setLightPresetForAec=function(){for(var e=(0,i.getGlobal)().DefaultLightPresetAec||"Boardwalk",t=-1,n=0;n<h.LightPresets.length;n++)if(h.LightPresets[n].name===e){t=n;break}return t>=0&&(this.api.prefs.hasTag("lightPreset","ignore-producer")?f.logger.debug("setLightPresetForAec(): lightPreset is locked. No changes."):(this.api.prefs.tag("no-storage","lightPreset"),this.setLightPreset(t,!0,function(){this.api.prefs.tag("ignore-producer","envMapBackground")}.bind(this)),this.saveLightPreset())),this.api.prefs.hasTag("edgeRendering","ignore-producer")?f.logger.debug("setLightPresetForAec(): edgeRendering is locked. No changes."):(this.api.prefs.tag("no-storage","edgeRendering"),this.api.setDisplayEdges(!(0,i.isMobileDevice)())),!0},this.setAOHeuristics=function(e){var t=e.getUnitScale(),n=e.getMetadata("renderEnvironmentAmbientShadows","radius",void 0),i=e.getMetadata("renderEnvironmentAmbientShadows","intensity",void 0),r=e.getMetadata("renderEnvironmentAmbientShadows","opacity",void 0);if(void 0!==n||void 0!==i||void 0!==r)Z.setAOOptions(n/t,i,r);else if(e.isAEC()){t>.3?Z.setAOOptions(4/t,1,.625):Z.setAOOptions(.25/t,1,.625)}else{var o=e.getData().bbox.getSize(new L.Vector3).length();Z.setAOOptions(Math.min(10,.05*o))}},this.setTonemapMethod=function(e){e!=Z.getToneMapMethod()&&(Z.setTonemapMethod(e),Y.setTonemapMethod(e),this.fireRenderOptionChanged(),this.invalidate(!0))},this.setTonemapExposureBias=function(e){e!=Z.getExposureBias()&&(Z.setTonemapExposureBias(e),Y.setTonemapExposureBias(e),this.fireRenderOptionChanged(),this.invalidate(!0))},this.setRenderingPrefsFor2D=function(e){if(!(0,i.isNodeJS)()){var t=!e&&!!this.api.prefs.get("envMapBackground");this.toggleEnvMapBackground(t)}},this.dtor=function(){this.stop(),this.api.removeEventListener(D.MODEL_ROOT_LOADED_EVENT,Ie),this.api.removeEventListener(D.MODEL_ROOT_LOADED_EVENT,Oe),this.unloadCurrentModel(),this.controls=null,this.canvas=null,clearInterval(this.interval),this.loader=null,this.selector.dtor(),this.selector=null,this.model=null,this.layers=null,this.visibilityManager=null,Re&&(Re.removeViewer(this.api),Re=null),ne=null,Z=null,Y.refCount--,0===Y.refCount&&Y.dtor(),Y=null,K&&(K.refCount--,0===K.refCount&&(K.domElement=null,K.context=null),K.removeEventListener(g.WebGLRenderer.Events.WEBGL_CONTEXT_LOST,this.onWebGLcontextLost),K.removeEventListener(g.WebGLRenderer.Events.WEBGL_CONTEXT_RESTORED,this.onWebGLcontextRestored),K=null)},this.hideLines=function(e){ne&&!ne.isEmpty()&&(ne.hideLines(e),this.sceneUpdated(!0))},this.hidePoints=function(e){ne&&!ne.isEmpty()&&(ne.hidePoints(e),this.sceneUpdated(!0))},this.setDisplayEdges=function(e){Z.toggleEdges(e);var t=e;e||(t=!(!this.model||!this.model.getData().hasLines)),Y.togglePolygonOffset(t),Z.setDepthMaterialOffset(Y.getPolygonOffsetOn(),Y.getPolygonOffsetFactor(),Y.getPolygonOffsetUnits()),this.invalidate(!0)},this.setDoubleSided=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!(t=t||this.model).is2d()){var i=t.getData();i&&(this.matman().setDoubleSided(e,t),n&&this.sceneUpdated())}},this.getAllCutPlanes=function(){var e=void 0;for(var t in Ne){var n=Ne[t];n&&n.length&&(e=e?t===ke?n.concat(e):e.concat(n):n)}return e},this.updateCutPlanes=function(){var e=this.getAllCutPlanes();this.setCutPlanes(e)},this.setCutPlaneSet=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(Ne[e]=t?t.slice():void 0,n)this.updateCutPlanes();else{var i=this.getAllCutPlanes();this.setCutPlanesInScene(i)}},this.setCutPlaneSetFor2DRendering=function(e){ke=e,this.updateCutPlanes()},this.getCutPlaneSet=function(e){return Ne[e]||[]},this.getCutPlaneSets=function(){var e=[];for(var t in Ne){var n=Ne[t];n&&n.length&&e.push(t)}return e},this.getCutPlanes=function(){return Y.getCutPlanes()},this.setCutPlanesInScene=function(e){Z.toggleTwoSided(Y.setCutPlanes(e)),this.sceneUpdated()},this.setCutPlanes=function(e){this.setCutPlanesInScene(e),this.api.dispatchEvent({type:D.CUTPLANES_CHANGE_EVENT,planes:e})},this.fireRenderOptionChanged=function(){Y.toggleMRTSetting(Z.mrtFlags()),this.api.dispatchEvent({type:D.RENDER_OPTION_CHANGED_EVENT})},this.viewportToRay=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.camera;return n.viewportToRay(e,t)},this.rayIntersect=function(e,t,n,i,r,o){for(var a=this,s=ne.rayIntersect(e.origin,e.direction,t,n,i,r,(function(e){var t=(new L.Vector3).copy(e);t.project(a.camera);var n=[];return Z.idAtPixel(t.x,t.y,n),n}),o),l=[this.scene,this.sceneAfter],c=new L.Vector3,u=0;u<l.length;u++){var h=l[u];if(h.children.length){var d=new L.Raycaster(e.origin,e.direction,this.camera.near,this.camera.far);_t(Et,h),d.params.Line.threshold=Math.min(1,.5*Et.getSize(c).length()*.001);var p=r||[];C.VBIntersector.intersectObject(h,d,p,!0),p.length&&(!s||p[0].distance<s.distance)&&(s=p[0])}}return s?(void 0===s.dbId&&void 0!==s.fragId&&(s.dbId=s.model.getFragmentList().getDbIds(s.fragId),s.model.getData().instanceTree||(s.dbId=s.fragId)),s.intersectPoint=s.point,s):null},this.castRayViewport=function(e,t,n,i,r,o){return xt=xt||new L.Ray,ne?(this.viewportToRay(e,xt),this.rayIntersect(xt,t,n,i,r,o)):{}},this.getCanvasBoundingClientRect=function(){return this.canvasBoundingclientRectDirty&&(this.canvasBoundingclientRectDirty=!1,this.boundingClientRect=this.canvas.getBoundingClientRect()),this.boundingClientRect},this.clientToViewport=function(e,t){var n=this.getCanvasBoundingClientRect();return new L.Vector3((e+.5)/n.width*2-1,-(t+.5)/n.height*2+1,1)},this.viewportToClient=function(e,t){var n=this.getCanvasBoundingClientRect();return new L.Vector3(.5*(e+1)*n.width-.5,-.5*(t-1)*n.height-.5,0)},this.castRay=function(e,t,n,i){return this.castRayViewport(this.clientToViewport(e,t),n,void 0,void 0,void 0,i)},this.intersectGroundViewport=function(e){var t="z";this.is2d||(t=ue);var n=this.model&&this.model.getBoundingBox();return k.SceneMath.intersectGroundViewport(e,this.camera,t,n)},this.intersectGround=function(e,t){return this.intersectGroundViewport(this.clientToViewport(e,t))},this._2dHitTestViewport=function(e,t,n){var i=[0,0],r=Z.idAtPixels(e.x,e.y,t,i);if(r<n)return null;var o=ne.findModel(i[1])||this.model;if(!o)return null;var a=this.intersectGroundViewport(e),s=o.getData().fragments,l=s?s.dbId2fragId[r]:-1;return{intersectPoint:a,dbId:o.remapDbIdFor2D(r),fragId:l,model:o}};var wt=function(e){return function(t){if(!(t&&t.object&&t.object.isLine))return!0;var n=1/F.camera.pixelsPerUnitAtDistance(t.distance),i=e*n;return t.distanceToRay<i}};function St(e,t,n,i){var r=e.getFragmentList().getVizmesh(t);new P.VertexBufferReader(r.geometry).enumGeomsForVisibleLayer(n,i)}function At(e,t,n,i){var r=e.getFragmentList().getVizmesh(t);new P.VertexBufferReader(r.geometry).enumGeomsForObject(n,i)}this.hitTestViewport=function(e,t,n,r,o){var a;if(this.is2d){var s=(0,i.isMobileDevice)()?45:5;a=this._2dHitTestViewport(e,s,1)}else a=this.castRayViewport(e,t,n,r,o);return a},this.hitTest=function(e,t,n,i,r){return F.hitTestViewport(this.clientToViewport(e,t),n,i,r)},this.hitBoxTestViewport=function(e,t,n){var i=[],r=[];Z.idsAtPixelsBox(e.x,e.y,t,n,r);for(var o=0;o<r.length;o++){var a=ne.findModel(r[o][1])||this.model;if(a){var s=a.remapDbIdFor2D(r[o][0]);i.push({dbId:s,model:a})}}return i},this.snappingHitTestViewport=function(e,t){var n,r=(0,i.isMobileDevice)()?45:17;if(this.is2d){if(this.model&&this.model.isLeaflet())n={intersectPoint:this.intersectGroundViewport(e)};else n=this._2dHitTestViewport(e,r,0)}else{var o=[],a=Z.idAtPixels(e.x,e.y,r,o);o[2]&&o[3]&&(e.setX(o[2]),e.setY(o[3]));var s={filter:wt(r)};n=this.castRayViewport(e,t,a>0?[a]:null,void 0,void 0,s)}return n},this.snappingHitTest=function(e,t,n){return this.snappingHitTestViewport(this.clientToViewport(e,t),n)},this.clearHighlight=function(){Z.rolloverObjectId(-1),this.invalidate(!1,!1,!0)},this.rollOverIdChanged=function(){this.api.fireEvent({type:D.OBJECT_UNDER_MOUSE_CHANGED,dbId:Z.getRollOverDbId(),modelId:Z.getRollOverModelId()}),this.invalidate(!1,!1,!0)},this.rolloverObjectViewport=function(e){if(this.model&&!(this.is2d&&this.model&&(this.model.isLeaflet()||this.model.isPdf(!0)&&this.api.prefs.get(U.Prefs2D.DISABLE_PDF_HIGHLIGHT)))){var t=[],n=Z.idAtPixel(e.x,e.y,t);if(this.selector&&this.selector.isNodeSelectionLocked(n,this.model))this.clearHighlight();else{var i=t[1],r=this.findModel(i);(null==r?void 0:r.isLeaflet())?Z.rollOverModelId(i)&&this.rollOverIdChanged():Z.rolloverObjectViewport(e.x,e.y)&&this.rollOverIdChanged()}}},this.rolloverObject=function(e,t){this.selector.highlightPaused||this.selector.highlightDisabled||this.rolloverObjectViewport(this.clientToViewport(e,t))},this.pauseHighlight=function(e){this.selector.highlightPaused=e,e&&this.clearHighlight()},this.disableHighlight=function(e){this.selector.highlightDisabled=e,e&&this.clearHighlight()},this.disableSelection=function(e){this.selector.selectionDisabled=e},this.cancelLeafletScreenshot=function(){F.api.dispatchEvent({type:D.CANCEL_LEAFLET_SCREENSHOT})},this.getScreenShotProgressive=function(e,t,n,i){return r.ScreenShot.getScreenShot(e,t,n,i,this)},this.modelQueue=function(){return ne},this.glrenderer=function(){return K},this.renderer=function(){return Z},this.setGeomCache=function(e){(Re=e).addViewer(F.api)},this.geomCache=function(){return Re||this.setGeomCache(new p.OtgResourceCache),Re},this.shadowMaps=function(){return Q},this.worldUp=function(){return H},this.worldUpName=function(){return ue},this.setUserRenderContext=function(e,t){Z=e||new s.RenderContext,t||(Z.init(K,this.canvas.clientWidth,this.canvas.clientHeight),Z.setClearColors(this.clearColorTop,this.clearColorBottom)),this.invalidate(!0),this.sceneUpdated(!1)},this.setUserGroundShadow=function(e){var t=ee;return ee=e,t},this.invalidate=function(e,t,n){fe=e||fe,me=t||me,ge=n||ge},this.isOverlayDirty=function(){return ge},this.clearOverlayDirtyFlag=function(){ge=!1},this.sceneUpdated=function(e,t){this.invalidate(!t,!1,!t),ne&&e&&(ne.invalidateVisibleBounds(),this.zoomBoundsChanged=!0),ye=!0,Ge()},this.requestSilentRender=function(){be=_e=!0},this.requestDeferredSilentRender=function(){be=!0},this.currentLightPreset=function(){return ae},this.saveLightPreset=function(){se=ae},this.matman=function(){return Y},this.fps=function(){return 1e3/we},this.setFPSTargets=function(e,t,n){ie=1e3/n,oe=1,re=1e3/t,this.targetFrameBudget=(0,i.isMobileDevice)()?re/4:re},this.track=function(e){f.logger.track(e)},this.worldToClient=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.camera,n=new L.Vector4(e.x,e.y,e.z,1);return n.applyMatrix4(t.matrixWorldInverse),n.applyMatrix4(t.projectionMatrix),n.w>0&&(n.x/=n.w,n.y/=n.w,n.z/=n.w),this.viewportToClient(n.x,n.y)},this.clientToWorld=function(e,t,n,i){var r=null,o=this.model,a=o.getData();if(o.is2d()){var s=this.intersectGround(e,t);if(s){s.z=0;var l=a.bbox;(i||a.hidePaper||l.containsPoint(s))&&(r={point:s,model:o})}else i&&(r={point:this.camera.position.clone(),model:o})}else(r=this.hitTest(e,t,n))&&(r.point=r.intersectPoint);return r},this.set2dSelectionColor=function(e,t){this.matman().set2dSelectionColor(e,t),this.invalidate(!1,!1,!0)},this.setSelectionColor=function(e,t){t=t||O.SelectionType.MIXED;var n=new L.Color(e);n.multiplyScalar(.5);var i=function t(i){i.color.set(e),i.emissive.set(n),i.variants&&i.variants.forEach(t)};switch(t){default:case O.SelectionType.MIXED:i(this.selectionMaterialBase),i(this.selectionMaterialTop),Z.setSelectionColor(e),i(this.highlightMaterial),this.invalidate(!0);break;case O.SelectionType.REGULAR:i(this.highlightMaterial),this.invalidate(!0);break;case O.SelectionType.OVERLAYED:i(this.selectionMaterialBase),i(this.selectionMaterialTop),Z.setSelectionColor(e),this.invalidate(!1,!1,!0)}},this.updateViewportId=function(e){Y.updateViewportId(e),this.invalidate(!0)},this.findModel=function(e,t){var n;n="number"==typeof e?function(t){return t.id==e}:e instanceof N.BubbleNode?function(t){return t.getDocumentNode()==e}:e;var i=ne.getModels().find(n);return t&&!i&&(i=ne.getHiddenModels().find(n)),i},this.getFrameRate=function(){return this.frameDisplayRate},this.setFrameRate=function(e){this.frameDisplayRate=e<1?1:e},this.setShadowLightDirection=function(e){de.copy(e),Ge(),this.invalidate(!0,!1,!1),Ve()},this.getShadowLightDirection=function(e){var t=e||new L.Vector3;return t.copy(de),t},this.toggleShadows=function(e){!!Q!=!!e&&(e?Q=new b.ShadowMaps(K):(Q.cleanup(Y),Q=null),Ve(),this.invalidate(!0,!0,!1))},this.showTransparencyWhenMoving=function(e){ne.enableNonResumableFrames=e},this.fitToView=function(e,t){(t=!!t,0===e.length)&&(e=ne.getModels().map((function(e){return{model:e,selection:[]}})));if(0===e.length)return!1;for(var n=0,i=0;i<e.length;++i){var r=e[i].model;if(!r)return!1;r.is2d()&&n++}return!!(n===e.length?this._fitToView2d(e,t):this._fitToView3d(e,t))&&(1===ne.getModels().length&&this.api.dispatchEvent({type:D.FIT_TO_VIEW_EVENT,nodeIdArray:e[0].selection,immediate:t,model:e[0].model}),this.api.dispatchEvent({type:D.AGGREGATE_FIT_TO_VIEW_EVENT,selection:e,immediate:t}),!0)},this._fitToView2d=function(e,t){e.length>1&&f.logger.warn("fitToView() doesn't support multiple 2D models. Using the first one...");var n=e[0].model,i=e[0].selection,r=new L.Box3,o=new P.BoundsCallback(r);if(i&&0!==i.length)this.computeSelectionBounds(i,n,o);else if(this.api.anyLayerHidden())for(var a=n.getData().fragments,s=this.getVisibleLayerIndices(),l=0;l<a.length;l++)St(n,l,s,o);else r=this.getFitBounds(!0);return!r.isEmpty()&&(this.api.navigation.fitBounds(t,r),!0)},this.computeSelectionBounds=function(e,t,n){var i;n||(n=new P.BoundsCallback(new L.Box3));var r=null===(i=t.getData().fragments)||void 0===i?void 0:i.dbId2fragId;if(r){for(var o=0;o<e.length;o++){var a=t.reverseMapDbIdFor2D(e[o]),s=r[a];if(Array.isArray(s))for(var l=0;l<s.length;l++)At(t,s[l],a,n);else"number"==typeof s&&At(t,s,a,n)}n.bounds.applyMatrix4(t.getPlacementTransform())}else n.bounds.copy(t.getBoundingBox());return n.bounds},this.get3DBounds=function(e){for(var t=!1,n=0;n<e.length;++n)if(e[n].selection.length>0){t=!0;break}var i=new L.Box3,r=new L.Box3;if(t)for(var o=0;o<e.length;++o){var a=e[o].selection;if(0!==a.length){var s=e[o].model,l=s.getInstanceTree(),c=s.getFragmentList();if(l)for(var u=0;u<a.length;++u){var h=parseInt(a[u]);l.enumNodeFragments(h,(function(e){c.getWorldBounds(e,r),i.union(r)}),!0)}}}else i.union(this.getVisibleBounds(!1,!1));return i},this.onModelTransformChanged=function(e){if(this.sceneUpdated(),e.isConsolidated())for(var t in F.selectionMeshes){var n=F.selectionMeshes[t];n.model===e&&(n.needsUpdate=!0)}this.invalidate(!0,!0,!0),this.api.fireEvent({type:D.MODEL_TRANSFORM_CHANGED_EVENT,model:e,matrix:e.getModelTransform()})},this.setPlacementTransform=function(e,t){e.setPlacementTransform(t),this.api.fireEvent({type:D.MODEL_PLACEMENT_CHANGED_EVENT,model:e,matrix:e.getPlacementTransform()}),this.onModelTransformChanged(e)},this._fitToView3d=function(e,t){var n=this.get3DBounds(e);return!n.isEmpty()&&(this.api.navigation.fitBounds(t,n),!0)},this.onWebGLcontextLost=function(){K.enableContextRestore&&(this._reconsolidateOnRestore=(0,v.I5)(this.api)),this.stop(),this.api.fireEvent({type:D.WEBGL_CONTEXT_LOST_EVENT})},this.onWebGLcontextRestored=function(){(0,v.p1)(this.api,this._reconsolidateOnRestore),this._reconsolidateOnRestore=null,Z.clearAllOverlays(),ee.setDirty(),te&&te.setDirty(),this.invalidate(!0,!0,!0),this.run(),this.api.fireEvent({type:D.WEBGL_CONTEXT_RESTORED_EVENT})},this.modelVisible=function(e){return!!ne.findModel(e)},this.handleInitialVisibility=function(e){var t=this.api;e.visibilityManager&&e.getObjectTree((function(n){var i=e.getFragmentList();if(!i.areAllVisible()){var r=[];n&&(n.enumNodeChildren(e.getRootId(),(function(e){n.enumNodeFragments(e,(function(e){return i.isFragVisible(e)}),!0)||n.isNodeHidden(e)||n.isNodeOff(e)||r.push(e)}),!0),r.length&&t.hide(r,e))}}))},this.changePaperVisibility=function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(e.is3d())null==r||r();else{var a=e.getFragmentList();if(a){if(e.paperVisibilityAnim&&(e.paperVisibilityAnim.stop(),e.paperVisibilityAnim=null),!i||!o)return e.changePaperVisibility(t),this.invalidate(!0),void(null==r||r());var s=-1,l=void 0!==a.dbIdOpacity[s]?a.dbIdOpacity[s]:t?0:1,c=t?1:0,u=o,h=function(e){e=Autodesk.Viewing.Private.smootherStep(e),a.setObject2DOpacity(s,e),n.invalidate(!0)},d=function(){e.paperVisibilityAnim=null,null==r||r()};e.paperVisibilityAnim=Autodesk.Viewing.Private.fadeValue(l,c,u,h,d)}else null==r||r()}},this._signalNoMeshes=function(){ne.isEmpty()&&(this._geometryAvailable=0)},this._signalMeshAvailable=function(){0===this._geometryAvailable&&(this._geometryAvailable=1,this.api.fireEvent({type:D.RENDER_FIRST_PIXEL}))},this.hasModels=function(){return!ne.isEmpty()},this.onLoadingAnimationChanged=function(e){K.setLoadingAnimationDuration(e?this.defaultLoadingAnimationDuration:-1),this.invalidate(!1,!0,!1)},this.isLoadingAnimationEnabled=function(){return this.api.prefs.get(U.Prefs2D.LOADING_ANIMATION)&&(!this.model||this.model.is2d())},this.setMaxModelDistance=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e5;this.maxModelDistance=e},this._applyMaxModelDistanceToNearFar=function(){var e=this.camera;if(e.far<=e.near+this.maxModelDistance)return null;var t=e.near+this.maxModelDistance,n=this.getVisibleBounds(!0,ge,(function(n){return k.SceneMath.pointToBoxDistance2(e.position,n)<t*t}));this.updateNearFarValues(e,n)},this.consolidateModel=function(e,t){e.consolidate(Y,t,K)},this.setDoNotCut=function(e,t){e.setDoNotCut(Y,t)},this.setViewportBounds=function(e,t){e.setViewportBounds(Y,t),this.invalidate(!0),this.api.fireEvent({type:D.MODEL_VIEWPORT_BOUNDS_CHANGED_EVENT,model:e,bounds:t})}}j.prototype.constructor=j,F.GlobalManagerMixin.call(j.prototype)},59823:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ViewerState:()=>s});var i=n(98926),r=n(95018),o=n(27820);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function s(e){this.getVisibleModel=function(t){for(var n=e.getVisibleModels(),i=0;i<n.length;++i){var r=n[i];if(this.getSeedUrn(r)===t)return r}},this.createObjectSets=function(t){var n=t.objectSet;Array.isArray(n)||(t.objectSet=n=[]);for(var i=e.getVisibleModels(),r=0;r<i.length;r++){var o=i[r],a=this.getSeedUrn(o),s=this.getSelectedNodes(o);n[r]={id:s,idType:"lmv"},i.length>1&&(n[r].seedUrn=a),o.is2d()?(n[r].isolated=this.getVisibleLayers2d(o),n[r].allLayers=this.areAllLayersVisible(o),n[r].hidden=[]):(n[r].isolated=e.getIsolatedNodes(o),n[r].hidden=e.getHiddenNodes(o),n[r].explodeScale=e.getExplodeScale())}},this.getState=function(t){var n=e.navigation,i={};i.seedURN=this.getSeedUrn(),this.createObjectSets(i);var r=i.viewport;r||(r=i.viewport={});var o=n.getCamera().isPerspective;r.name="",r.eye=n.getPosition().toArray(),r.target=n.getTarget().toArray(),r.up=n.getCameraUpVector().toArray(),r.worldUpVector=n.getWorldUpVector().toArray(),r.pivotPoint=n.getPivotPoint().toArray(),r.distanceToOrbit=n.getPivotPlaneDistance(),r.aspectRatio=this.getAspectRatio(),r.projection=o?"perspective":"orthographic",r.isOrthographic=!o,o?r.fieldOfView=n.getVerticalFov():r.orthographicHeight=this.getOrthographicHeight();var a=i.renderOptions;if(a||(a=i.renderOptions={}),a.environment=this.getEnvironmentName(),a.ambientOcclusion={enabled:e.impl.renderer().getAOEnabled(),radius:e.impl.renderer().getAORadius(),intensity:e.impl.renderer().getAOIntensity()},a.toneMap={method:e.impl.renderer().getToneMapMethod(),exposure:e.impl.renderer().getExposureBias(),lightMultiplier:this.getToneMapIntensity()},a.appearance={ghostHidden:e.impl.showGhosting,ambientShadow:e.prefs.get("ambientShadows"),antiAliasing:e.impl.renderer().settings.antialias,progressiveDisplay:e.prefs.get("progressiveRendering"),swapBlackAndWhite:e.prefs.get("swapBlackAndWhite"),displayLines:e.prefs.get("lineRendering"),displayPoints:e.prefs.get("pointRendering")},e.model&&!e.model.is2d())for(var s=i.cutplanes=[],l=e.impl.getCutPlaneSet("__set_view"),c=0;c<l.length;c++)s.push(l[c].toArray());for(var u in e.loadedExtensions){var h=e.loadedExtensions[u];h.getState&&h.getState(i)}return t&&true!==t&&this.applyFilter(i,t),i},this.restoreObjectSet=function(t){var n=t.objectSet;if(Array.isArray(n)&&0!==n.length){for(var i=[],r=[],o=[],a=e.model,s=0;s<n.length;++s){var l=n[s];if("lmv"===l.idType){var c=l.seedUrn;if(!c||(a=this.getVisibleModel(c))){var u=l.id;if(u&&(u=this.toIntArray(u),o.push({model:a,ids:u})),a.is2d()){var h=l.isolated;if(Array.isArray(h)&&h.length>0){e.setLayerVisible(null,!1);for(var d=0;d<h.length;++d)h[d]=parseInt(h[d]);e.impl.setLayerVisible(h,!0)}else l.allLayers||e.setLayerVisible(null,!1)}else{var p=l.isolated||[],f=l.hidden||[];p=this.toIntArray(p),i.push({model:a,ids:p}),0===p.length&&f.length>0&&(f=this.toIntArray(f),r.push({model:a,ids:f}))}if("explodeScale"in l){var m=parseFloat(l.explodeScale);e.explode&&e.explode(m)}}}}o.length>0&&e.impl.selector.setAggregateSelection(o),i.length>0&&e.impl.visibilityManager.aggregateIsolate(i,{hideLoadedModels:!1}),r.length>0&&e.impl.visibilityManager.aggregateHide(r)}},this.restoreState=function(t,n,r){if(!t)return i.logger.warn("restoreState has no viewer state to restore from."),!1;if(!e||!e.model)return i.logger.warn("restoreState has no viewer or model to restore."),!1;n&&true!==n&&(t=JSON.parse(JSON.stringify(t)),this.applyFilter(t,n));var o=e.navigation,a=!e.model.is2d();this.restoreObjectSet(t);var s=t.viewport;if(s){var l=this.getVector3FromArray(s.eye,o.getPosition()),c=this.getVector3FromArray(s.up,o.getCameraUpVector()),u=this.getVector3FromArray(s.target,o.getTarget()),h="fieldOfView"in s?parseFloat(s.fieldOfView):o.getVerticalFov(),d=this.getVector3FromArray(s.worldUpVector,null);if(!d){var p=e.model?e.model.getUpVector():null;d=p?(new THREE.Vector3).fromArray(p):new THREE.Vector3(0,1,0)}var f=this.getVector3FromArray(s.pivotPoint,o.getPivotPoint()),m=o.getCamera().isPerspective;"isOrthographic"in s&&(m=!s.isOrthographic);var g=this.getOrthographicHeight();"orthographicHeight"in s&&(g=Number(s.orthographicHeight));var v={position:l,target:u,up:c,worldup:d,aspect:e.impl.camera.aspect,fov:h,orthoScale:g,isPerspective:m,pivot:f};this.restoreCameraState(v,r)}var y=t.renderOptions;if(y){var b=e.impl.renderer(),_=e.prefs,x=_.get("ambientShadows"),E=_.get("antialiasing"),w=y.ambientOcclusion;if(w){"enabled"in w&&(x=w.enabled);var S="radius"in w?w.radius:null,A="intensity"in w?w.intensity:null;null!==S&&null!==A&&(S===b.getAORadius()&&A===b.getAOIntensity()||(b.setAOOptions(S,A),b.composeFinalFrame()))}if("environment"in y){var M=this.getLightPresetIndex(y.environment);-1!==M&&M!==_.get("lightPreset")&&a&&e.setLightPreset(M)}var T=y.toneMap;if(T){var C=!1,P="exposure"in T?T.exposure:null,L="lightMultiplier"in T?T.lightMultiplier:null;null!==P&&P!==b.getExposureBias()&&(b.setTonemapExposureBias(P),C=!0),null!==L&&e.impl.dir_light1&&L!==this.getToneMapIntensity()&&(e.impl.dir_light1.intensity=Math.pow(2,L),C=!0),C&&e.impl.invalidate(!0)}var R=y.appearance;R&&("antiAliasing"in R&&(E=R.antiAliasing),"progressiveDisplay"in R&&R.progressiveDisplay!==_.get("progressiveRendering")&&e.setProgressiveRendering(R.progressiveDisplay),"swapBlackAndWhite"in R&&R.swapBlackAndWhite!==_.get("swapBlackAndWhite")&&e.setSwapBlackAndWhite(R.swapBlackAndWhite),"ghostHidden"in R&&R.ghostHidden!==_.get("ghosting")&&a&&e.setGhosting(R.ghostHidden),"displayLines"in R&&R.displayLines!==_.get("lineRendering")&&e.hideLines(!R.displayLines),"displayPoints"in R&&R.displayPoints!==_.get("pointRendering")&&e.hidePoints(!R.displayPoints)),a&&x!==_.get("ambientShadows")&&E!==_.get("antialiasing")&&e.setQualityLevel(x,E)}if(Array.isArray(t.cutplanes)&&e.model&&a){for(var D=[],I=0;I<t.cutplanes.length;I++){var O=t.cutplanes[I];Array.isArray(O)&&O.length>=4&&D.push(new THREE.Vector4(O[0],O[1],O[2],O[3]))}!function(t,n){if(e.getExtension("Autodesk.AEC.LevelsExtension")&&void 0===t.floorGuid){var i=n.length;if(3===i||8===i){var r=n[i-2],o=n[i-1];0===r.x&&0===r.y&&-1===r.z&&0===o.x&&0===o.y&&1===o.z&&n.splice(-2,2)}}}(t,D),e.impl.setCutPlaneSet("__set_view",D)}for(var N in e.loadedExtensions){var k=e.loadedExtensions[N];k.restoreState&&k.restoreState(t,r)}return!0},this.getEnvironmentName=function(){var t=r.LightPresets[e.impl.currentLightPreset()];return t?t.name:"none"},this.restoreCameraState=function(t,n){e.impl.adjustOrthoCamera(t);var i=e.navigation;n?(t.isPerspective?i.toPerspective():i.toOrthographic(),i.setCameraUpVector(t.up),i.setWorldUpVector(t.worldup),i.setView(t.position,t.target),i.setPivotPoint(t.pivot),i.setVerticalFov(t.fov,!1),e.impl.syncCamera(!0)):(e.impl.camera.isPerspective=t.isPerspective,i.setRequestTransitionWithUp(!0,t.position,t.target,t.fov,t.up,t.worldup,t.pivot))},this.areEqual=function(e,t,n){function i(e,t){if(t=t||[],(e=e||[]).length!==t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}function r(e,t,n){return t=t||[],(e=e||[]).length===t.length&&(0!==e.length&&(o(e[0],t[0],n)||o(e[1],t[1],n)||o(e[2],t[2],n)))}function o(e,t,n){var i=e?parseFloat(e):null,r=e?parseFloat(t):null,o=a(i),s=a(r);return"number"===o&&"number"===s?Math.abs(e-t)<n:(e=e||null)===(t=t||null)}var s=e,l=t,c=1e-9;if(n&&!0!==n&&(s=this.applyFilter(s,n),l=this.applyFilter(l,n)),s.seedURN!==l.seedURN)return!1;var u=s.objectSet||[],h=l.objectSet||[];if(u.length!==h.length)return!1;var d=u[0]||{},p=h[0]||{};if(!(d.idType===p.idType&&o(d.explodeScale,p.explodeScale,c)&&i(d.id,p.id)&&i(d.isolated,p.isolated)&&i(d.hidden,p.hidden)))return!1;var f=s.viewport||{},m=l.viewport||{};return!!(f.name===m.name&&f.projection===m.projection&&f.isOrthographic===m.isOrthographic&&o(f.distanceToOrbit,m.distanceToOrbit,c)&&o(f.fieldOfView,m.fieldOfView,c)&&o(f.orthographicHeight,m.orthographicHeight,c)&&r(f.eye,m.eye,c)&&r(f.target,m.target,c)&&r(f.up,m.up,c)&&r(f.worldUpVector,m.worldUpVector,c)&&r(f.pivotPoint,m.pivotPoint,c))},this.toIntArray=function(e){var t=[];if(Array.isArray(e))for(var n=0,i=e.length;n<i;++n)t.push(parseInt(e[n]));return t},this.getVector3FromArray=function(e,t){return e instanceof Array&&e.length>2?(e[0]=parseFloat(e[0]),e[1]=parseFloat(e[1]),e[2]=parseFloat(e[2]),(new THREE.Vector3).fromArray(e)):t},this.getSelectedNodes=function(t){return(t=t||e.model).selector?t.selector.getSelection():[]},this.getVisibleLayers2d=function(t){return t&&t!==e.model?(i.logger.warn("[getVisibleLayers2d] multiple models not yet supported."),[]):e.impl.getVisibleLayerIndices()},this.areAllLayersVisible=function(t){return t&&t!==e.model?(i.logger.warn("[areAllLayersVisible] multiple models not yet supported."),!0):e.impl.layers.allLayersVisible()},this.getAspectRatio=function(){var t=e.navigation.getScreenViewport();return t.width/t.height},this.getOrthographicHeight=function(){var t=e.navigation.getCamera();return t.isPerspective?0:Math.abs(2*t.orthographicCamera.top)},this.getSeedUrn=function(t){var n;return(null===(n=t=t||e.model)||void 0===n?void 0:n.getSeedUrn())||""},this.getToneMapIntensity=function(){var t=0;return e.impl.dir_light1&&(t=0!=e.impl.dir_light1.intensity?Math.log(e.impl.dir_light1.intensity)/Math.log(2):-1e-20),t},this.getLightPresetIndex=function(e){for(var t=0;t<r.LightPresets.length;t++)if(r.LightPresets[t].name===e)return t;return-1},this.applyFilter=function(e,t){if(!0!==t)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=t[n];void 0===r?delete e[n]:"boolean"==typeof r?!1===r&&delete e[n]:r instanceof Object?e[n]instanceof Object?this.applyFilter(e[n],t[n]):i.logger.warn("[applyFilter] A - Invalid filter Object for key ["+n+"]"):i.logger.warn("[applyFilter] B - Invalid filter value for key ["+n+"]")}},this.normalizeCoordinates=function(t){var n=t.viewport;if(n){if(n.normalized)return void i.logger.warn("invalid normalization of state.viewport. Ignoring command.");if(n.normalized=!0,l(n,o.SceneMath.getNormalizingMatrix(e.model)),"orthographicHeight"in n){var r=e.model.myData.bbox,a=r.max.y-r.min.y,s=n.orthographicHeight/a;n.orthographicHeight=s}}},this.denormalizeCoordinates=function(t){var n=t.viewport;if(n){if(!n.normalized)return void i.logger.warn("invalid denormalization of state.viewport. Ignoring command.");if(delete n.normalized,l(n,o.SceneMath.getNormalizingMatrix(e.model).clone().invert()),"orthographicHeight"in n){var r=e.model.myData.bbox,a=r.max.y-r.min.y,s=n.orthographicHeight*a;n.orthographicHeight=s}}}}function l(e,t){var n=new THREE.Vector3(e.eye[0],e.eye[1],e.eye[2]),i=new THREE.Vector3(e.pivotPoint[0],e.pivotPoint[1],e.pivotPoint[2]),r=new THREE.Vector3(e.target[0],e.target[1],e.target[2]);n.applyMatrix4(t),i.applyMatrix4(t),r.applyMatrix4(t),e.eye[0]=n.x,e.eye[1]=n.y,e.eye[2]=n.z,e.pivotPoint[0]=i.x,e.pivotPoint[1]=i.y,e.pivotPoint[2]=i.z,e.target[0]=r.x,e.target[1]=r.y,e.target[2]=r.z}s.prototype.constructor=s},77368:(e,t,n)=>{"use strict";n.r(t),n.d(t,{BubbleNode:()=>r});var i=1;var r=function e(t,n){if(this.parent=n,this.id=i++,this.data=t,this.isLeaf="geometry"===t.type&&("3d"===t.role||"2d"===t.role||"lod"===t.role),Array.isArray(t.children)||Array.isArray(t.derivatives)){this.children=[];for(var r=t.children||t.derivatives,o=r.length,a=0;a<o;a++)this.children[a]=new e(r[a],this);this.children.length>1&&this.children.sort((function(e,t){return Object.prototype.hasOwnProperty.call(e.data,"order")&&Object.prototype.hasOwnProperty.call(t.data,"order")?e.data.order-t.data.order:0}));for(var s=0;s<o;s++){var l="application/autodesk-db"==(c=r[s]).mime&&c.urn?0===c.urn.indexOf("urn:adsk.objects:os.object")?c.urn.substr(0,c.urn.lastIndexOf("%2F")+3):c.urn.substr(0,c.urn.lastIndexOf("/")+1):null;l&&(this.sharedPropertyDbPath=l),"lod"===r[s].role&&(this.lodNode=this.children[s])}}var c};r.prototype.constructor=r,r.prototype.setDocument=function(e){this.lmvDocument=e},r.prototype.getDocument=function(){for(var e=this;e.parent;)e=e.parent;return e.lmvDocument},r.prototype.isOtg=function(){return!!this._getOtgManifest()},r.prototype._getOtgManifest=function(){if("undefined"!=typeof DISABLE_OTG&&DISABLE_OTG)return null;var e=this.findViewableParent();return e?e.data.otg_manifest:null},r.prototype.isSVF2=function(){var e,t=this._getOtgManifest();return Boolean("cacheable"===(null==t||null===(e=t.paths)||void 0===e?void 0:e.pharos_type))},r.prototype.getOtgGraphicsNode=function(){if(this.isViewPreset())return this.findParentGeom2Dor3D().getOtgGraphicsNode();var e=this._getOtgManifest();return e&&e.views&&e.views[this.guid()]},r.prototype.getPropertyDbManifest=function(){var e,t=this._getOtgManifest();if(t&&t.pdb_manifest){var n=t.pdb_manifest;e={propertydb:{},isOtg:!0};for(var i=0;i<n.assets.length;i++){var r,o=n.assets[i];r=o.isShared?t.paths.shared_root+n.pdb_shared_rel_path:t.paths.version_root+n.pdb_version_rel_path,e.propertydb[o.tag]=[{path:r+o.uri,isShared:o.isShared}]}this.getOtgGraphicsNode()||(e.needsDbIdRemap=!0)}else{var a=this.findPropertyDbPath();null===a&&(console.warn("Missing property database entry in manifest."),a=""),0===a.indexOf("$file$")&&(console.warn("Bubble local path given for shared property DB files. Assuming that sharedPropertyDbPath is specified correctly by loadDocumentNode()."),a="");var s=this.getDocument();s&&0===a.indexOf("urn")&&(a=s.getFullPath(a)),e={propertydb:{attrs:[{path:a+"objects_attrs.json.gz"}],values:[{path:a+"objects_vals.json.gz"}],avs:[{path:a+"objects_avs.json.gz"}],offsets:[{path:a+"objects_offs.json.gz"}],ids:[{path:a+"objects_ids.json.gz"}]}}}return e},r.prototype.getRootNode=function(){return this.parent?this.parent.getRootNode():this},r.prototype.isForgeManifest=function(){return"manifest"===this.getRootNode().data.type},r.prototype.findPropertyDbPath=function(){var e=this._getOtgManifest(),t=e&&e.pdb_manifest;return t&&t.assets&&t.assets.length?e.paths.version_root+e.pdb_manifest.pdb_version_rel_path:(e&&console.warn("Unexpected: OTG manifest exists, but it has no property database manifest."),this.sharedPropertyDbPath?this.sharedPropertyDbPath:this.parent?this.parent.findPropertyDbPath():null)},r.prototype._raw=function(){return this.data},r.prototype.name=function(){return this.data.name||""},r.prototype.guid=function(){return this.data.guid},r.prototype.type=function(){return this.data.type},r.prototype.extensions=function(){if(this.data.extensions)return Array.isArray(this.data.extensions)?this.data.extensions:[this.data.extensions]},r.prototype.urn=function(e){var t=this.data.urn;if(!e)return t;for(var n=this.parent;!t&&n;)t=n.data.urn,n=n.parent;return t},r.prototype.lineageUrn=function(e){var t=this.getRootNode().urn(),n=r.parseLineageUrnFromEncodedUrn(t);return e&&(n=Autodesk.Viewing.toUrlSafeBase64(n)),n},r.parseLineageUrnFromEncodedUrn=function(e){if(!e)return null;for(var t=e.split("/"),n=null,i=t.length-1;i>=0;i--){var o;try{n=Autodesk.Viewing.fromUrlSafeBase64(t[i])}catch(e){}if(-1!=(null===(o=n)||void 0===o?void 0:o.indexOf("file:")))break;n=null}return r.parseLineageUrnFromDecodedUrn(n)},r.parseLineageUrnFromDecodedUrn=function(e){if(!e)return null;var t=(e=e.replace("fs.file:vf.","dm.lineage:")).indexOf("?version");return e.substring(0,t)},r.prototype.isGeomLeaf=function(){return this.isLeaf},r.prototype.isViewable=function(){return"viewable"===this.data.role||"svf"===this.data.outputType},r.prototype.getLodNode=function(){return this.lodNode},r.prototype.isGeometry=function(){return"geometry"===this.data.type},r.prototype.isViewPreset=function(){return"view"===this.data.type},r.prototype.is2D=function(){return"2d"===this.data.role},r.prototype.is3D=function(){return"3d"===this.data.role},r.prototype.is2DGeom=function(){return this.isGeometry()&&this.is2D()},r.prototype.is3DGeom=function(){return this.isGeometry()&&this.is3D()},r.prototype.useAsDefault=function(){return!0===this.data.useAsDefault},r.prototype.getDefaultGeometry=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];if(e){var i=this.search(r.MASTER_VIEW_NODE);i.length&&(n=i[0].search({type:"geometry"}))}0==n.length&&(n=this.search({type:"geometry"})),t&&n.sort((function(e,t){return t.data.size-e.data.size}));for(var o=0;o<n.length;++o)if(n[o].useAsDefault())return n[o];return n[0]},r.prototype.getPlacementTransform=function(){return console.warn("BubbleNode.getPlacementTransform is deprecated. Sheet placement information is stored in AECModelData.json"),null},r.prototype.getHash=function(){return console.warn("BubbleNode.getHash is deprecated and will be removed in a future release."),null},r.prototype.getViewBox=function(){return this.data.viewbox},r.prototype.isMetadata=function(){if(this.data.role){if(-1!==this.data.role.indexOf("Autodesk.CloudPlatform.DesignDescription"))return!0;if("Autodesk.CloudPlatform.PropertyDatabase"===this.data.role)return!0}return!1},r.prototype.findViewableParent=function(){for(var e=null,t=this;t;)t.isViewable()&&(e=t),t=t.parent;if(!e&&!this.parent&&this.children)for(var n=0;n<this.children.length;n++){var i=this.children[n];if(i.isViewable()){e=i;break}}return e},r.prototype.findParentGeom2Dor3D=function(e){for(var t=this;t&&!t.is2DGeom()&&!t.is3DGeom();)t=t.parent;!t&&this.isViewPreset()&&(t=this.findGeometryFromSiblings()[0],e&&e.fallbackParent&&(t=e.fallbackParent));return t},r.prototype.findGeometryFromSiblings=function(){var e=this.parent;if(!e)return[];for(var t=[],n=0,i=e.children.length;n<i;++n){var r,o=e.children[n];if(o!==this)o.traverse((function(e){if(e.isGeometry()&&(e.is2D()||e.is3D()))return r=e,!0})),r&&t.push(r)}return t},r.prototype.findAllViewables=function(){var e=[];this.isForgeManifest()&&(e=this.search({outputType:"svf"}));var t=this.search({role:"viewable"});return e.concat(t)},r.prototype.getViewableRootPath=function(e){var t=this.getOtgGraphicsNode();if(t&&t.urn&&!t.error)return this._getOtgManifest().paths.version_root+t.urn;if(!this.isGeomLeaf())return this.urn();if(this.is2D()){if(!e){var n=this.search({role:"leaflet"});if(n&&n.length)return n[0].urn()}var i=this.search(r.PDF_PAGE_NODE);if(null==i?void 0:i.length)return i[0].urn()}var o=this.is2D()?"application/autodesk-f2d":"application/autodesk-svf",a=this.search({mime:o});return a&&a.length?a[0].urn():null},r.prototype.getNamedViews=function(){var e=this.search({type:"view"});return e=e.filter((function(e){return!!e.data.name&&!!Array.isArray(e.data.camera)}))},r.prototype.findByGuid=function(e){var t=null;return this.traverse((function(n){if(n.data.guid===e)return t=n,!0})),t},r.prototype.search=function(e){var t=[];return this.traverse((function(n){var i=!0;for(var r in e)if(!Object.prototype.hasOwnProperty.call(n.data,r)||n.data[r]!==e[r]){i=!1;break}i&&t.push(n)})),t},r.prototype.traverse=function(e){if(e(this))return!0;if(this.children)for(var t=0;t<this.children.length;t++)if(this.children[t].traverse(e))return!0;return!1},r.prototype.getShallowCopySource=function(e){if(!this.isViewable())return console.error("getShallowCopySource must be called with a viewable node."),null;e||(e=this.parent.urn());var t=this.urn();return t!==e&&(t?(console.log("Redirecting shallow copied URN ".concat(e," to ").concat(t)),e=t):console.warn("Unexpected: manifest viewable node does not have a urn property.\n".concat(JSON.stringify(this._raw())))),e},r.prototype.getAecModelData=function(){var e=this.findViewableParent();if(!e)return null;if(!e.data.aec_model_data){var t=this.getRootNode().search({role:"Autodesk.AEC.ModelData"})[0];return Boolean(t)&&console.warn("Use Document.getAecModelData(bubbleNode) instead of BubbleNode.getAecModelData(), or make sure Document.downloadAecModelData is loaded before using this API"),null}return e.data.aec_model_data},r.prototype.extractRefPointTransform=function(){var e=this.getAecModelData();return e&&e.refPointTransformation&&r.readMatrixFromArray12(e.refPointTransformation)},r.prototype.extractCamera=function(){if(this.data.camera)return r.readCameraFromArray(this.data.camera);var e=this.isGeometry()&&this.search({type:"view"})[0];return e?e.extractCamera():null},r.prototype.getLevel=function(){var e=this.data.levelNumber;return Array.isArray(e)?e[0]:e},r.prototype.getLevelName=function(){return this.data.levelName||this.getLevel()},r.prototype.isSheet=function(){for(var e=this.parent;e;){if("Sheets"===e.name())return!0;e=e.parent}return!1},r.prototype.isMasterView=function(){for(var e=r.MASTER_VIEW_NODE.name,t=this;t;){if(t.name()===e)return!0;t=t.parent}return!1},r.prototype.getModelName=function(){var e=this.getRootNode().children[0];return null==e?void 0:e.name()},r.prototype.getInputFileType=function(){var e=this.getRootNode().children[0];return null==e?void 0:e.data.inputFileType},r.prototype.isRevitPdf=function(){return!(!this.data.isVectorPDF||"rvt"!==this.getInputFileType())},r.prototype.getModelKey=function(){var e="".concat(this.getViewableRootPath()).concat(this.originModel).concat(this.guid());return decodeURIComponent(e)},r.readCameraFromArray=function(e,t){if(!Array.isArray(e))return null;if(t&&!t.elements){t instanceof THREE.Vector3||(t=(new THREE.Vector3).copy(t));var n=new THREE.Matrix4;n.setPosition(t),t=n}var i={position:new THREE.Vector3(e[0],e[1],e[2]),target:new THREE.Vector3(e[3],e[4],e[5]),up:new THREE.Vector3(e[6],e[7],e[8]),aspect:e[9],fov:THREE.Math.radToDeg(e[10]),orthoScale:e[11],isPerspective:!e[12]};return t&&(i.position.applyMatrix4(t),i.target.applyMatrix4(t),i.up.transformDirection(t)),0===e[10]&&1===e[11]&&1===e[12]&&(i.orthoScale=i.position.distanceTo(i.target)),i},r.readMatrixFromArray12=function(e){return(new THREE.Matrix4).fromArray([e[0],e[1],e[2],0,e[3],e[4],e[5],0,e[6],e[7],e[8],0,e[9],e[10],e[11],1])},r.prototype.getSourceFileUnits=function(){return this.data.units};r.prototype.getMasterViews=function(){var e=this.getRootNode().search({name:"08f99ae5-b8be-4f8d-881b-128675723c10"});return e&&e.length>0&&e[0].children||[]},r.prototype.getMasterView=function(e){return this.getMasterViews().find((function(t){return t.data.phaseNames===e}))},r.prototype.get3DModelNodes=function(){return this.search(r.MODEL_NODE)},r.prototype.getSheetNodes=function(){return this.search(r.SHEET_NODE)},r.MODEL_NODE={role:"3d",type:"geometry"},r.GEOMETRY_SVF_NODE={role:"graphics",mime:"application/autodesk-svf"},r.SHEET_NODE={role:"2d",type:"geometry"},r.LEAFLET_NODE={role:"leaflet"},r.PDF_PAGE_NODE={role:"pdf-page"},r.IMAGE_NODE={role:"image"},r.GEOMETRY_F2D_NODE={role:"graphics",mime:"application/autodesk-f2d"},r.VIEWABLE_NODE={role:"viewable"},r.AEC_MODEL_DATA={role:"Autodesk.AEC.ModelData"},r.MASTER_VIEW_NODE={name:"08f99ae5-b8be-4f8d-881b-128675723c10"}},84998:(e,t,n)=>{"use strict";function i(){return"undefined"!=typeof window&&null!==window?window:"undefined"!=typeof self&&null!==self?self:n.g}n.r(t),n.d(t,{getGlobal:()=>i,isBrowser:()=>a,isNodeJS:()=>s,isIE11:()=>l,isIE11Only:()=>c,launchFullscreen:()=>u,exitFullscreen:()=>h,inFullscreen:()=>d,fullscreenElement:()=>p,isFullscreenAvailable:()=>f,isFullscreenEnabled:()=>m,getAndroidVersion:()=>g,isTouchDevice:()=>v,isIOSDevice:()=>b,isAndroidDevice:()=>x,isMobileDevice:()=>E,isPhoneFormFactor:()=>w,isSafari:()=>S,isFirefox:()=>A,isChrome:()=>M,isMac:()=>T,isWindows:()=>C,ObjectAssign:()=>P,disableDocumentTouchSafari:()=>R,enableDocumentTouchSafari:()=>D,touchStartToClick:()=>I});var r=i(),o=r&&r.document,a="undefined"!=typeof navigator,s=function(){return!a},l=a&&!!navigator.userAgent.match(/Edge|Trident\/7\./),c=a&&!!navigator.userAgent.match(/Trident\/7\./);function u(e,t){e.requestFullscreen?e.requestFullscreen(t):e.mozRequestFullScreen?e.mozRequestFullScreen(t):e.webkitRequestFullscreen?e.webkitRequestFullscreen(t):e.msRequestFullscreen&&e.msRequestFullscreen(t)}function h(e){d(e)&&(e.exitFullscreen?e.exitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.msExitFullscreen&&e.msExitFullscreen())}function d(e){return"webkitIsFullScreen"in e?!!e.webkitIsFullScreen:"fullscreenElement"in e?!!e.fullscreenElement:"mozFullScreenElement"in e?!!e.mozFullScreenElement:"msFullscreenElement"in e?!!e.msFullscreenElement:!!e.querySelector(".viewer-fill-browser")}function p(e){return e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement}function f(e){return e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullscreen||e.msRequestFullscreen}function m(e){return e.fullscreenEnabled||e.webkitFullscreenEnabled||e.mozFullScreenEnabled||e.msFullscreenEnabled}function g(e){var t=(e=e||navigator.userAgent).match(/Android\s([0-9\.]*)/);return!!t&&t[1]}function v(){return"undefined"!=typeof window&&("ontouchstart"in window||navigator.maxTouchPoints>0)}"undefined"!=typeof window&&l&&function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=o.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=r.CustomEvent.prototype,r.CustomEvent=e}(),ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(e,t){if(!t||t>this.byteLength?t=this.byteLength:t<0&&(t=this.byteLength+t)<0&&(t=0),e<0&&(e=this.byteLength+e)<0&&(e=0),t<=e)return new ArrayBuffer;for(var n=t-e,i=new Uint8Array(this,e,n),r=new Uint8Array(n),o=0;o<n;o++)r[o]=i[o];return r.buffer}),Math.log2=Math.log2||function(e){return Math.log(e)/Math.LN2},"undefined"!=typeof window&&(r.BlobBuilder=r.BlobBuilder||r.WebKitBlobBuilder||r.MozBlobBuilder||r.MSBlobBuilder);var y=a&&(/ip(ad|hone|od)/.test(navigator.userAgent.toLowerCase())||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1);function b(){return y}var _=a&&-1!==navigator.userAgent.toLowerCase().indexOf("android");function x(){return _}function E(){return!!a&&(b()||x())}function w(){return E()&&(r.matchMedia("(max-width: 750px)").matches||r.matchMedia("(max-height: 750px)").matches)}function S(){if(!a)return!1;var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("safari")&&-1===e.indexOf("chrome")}function A(){return!!a&&-1!==navigator.userAgent.toLowerCase().indexOf("firefox")}function M(){return!!a&&-1!==navigator.userAgent.toLowerCase().indexOf("chrome")}function T(){return!!a&&-1!==navigator.userAgent.toLowerCase().indexOf("mac os")}function C(){if(!a)return!1;var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("win32")||-1!==e.indexOf("windows")}function P(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function L(e){var t=r.hasOwnProperty("pageXOffset")?r.pageXOffset:o.documentElement.scrollLeft,n=r.hasOwnProperty("pageYOffset")?r.pageYOffset:o.documentElement.scrollTop,i=void 0===e.pageX?e.changedTouches[0].pageX:e.pageX,a=void 0===e.pageY?e.changedTouches[0].pageY:e.pageY,s=o.elementFromPoint(i-t,a-n);return!s||"CANVAS"!==s.nodeName||("true"!==s.getAttribute("data-viewer-canvas")||(e.preventDefault(),!1))}function R(){E()&&S()&&(o.documentElement.addEventListener("touchstart",L,!0),o.documentElement.addEventListener("touchmove",L,!0),o.documentElement.addEventListener("touchcanceled",L,!0),o.documentElement.addEventListener("touchend",L,!0))}function D(){E()&&S()&&(o.documentElement.removeEventListener("touchstart",L,!0),o.documentElement.removeEventListener("touchmove",L,!0),o.documentElement.removeEventListener("touchcanceled",L,!0),o.documentElement.removeEventListener("touchend",L,!0))}function I(e){e.target.className&&(e.target.className.indexOf("fullscreen")>-1||e.target.className.indexOf("webvr")>-1||e.target.className.indexOf("webxr")>-1)||(e.preventDefault(),e.stopPropagation(),e.target.click())}!function(){var e=i();e.performance||(e.performance=Date)}(),Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},String.prototype.repeat=String.prototype.repeat||function(e){if(e<1)return"";for(var t="",n=this.valueOf();e>1;)1&e&&(t+=n),e>>=1,n+=n;return t+n},Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,(function(n,i){return Array.isArray(i)?n.push.apply(n,e.call(i,t-1)):n.push(i),n}),[]):Array.prototype.slice.call(this)}}),Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{enumerable:!1,value:function(e,t,n){t=void 0===t?0:t,n=void 0===n?this.length:n;for(var i=t;i<n;++i)this[i]=e}}),Int32Array.prototype.lastIndexOf=Int32Array.prototype.lastIndexOf||function(e,t){return Array.prototype.lastIndexOf.call(this,e,t)},Array.prototype.find||Object.defineProperty(Array.prototype,"find",{enumerable:!1,value:function(e,t){for(var n=this.length,i=0;i<n;++i){var r=this[i];if(e.call(t,r,i,this))return r}}}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),i=1;i<arguments.length;i++){var r=arguments[i];if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])}return n},writable:!0,configurable:!0}),"undefined"==typeof window||!l&&!b()||HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,n){var i=this;setTimeout((function(){for(var r=atob(i.toDataURL(t,n).split(",")[1]),o=r.length,a=new Uint8Array(o),s=0;s<o;s++)a[s]=r.charCodeAt(s);e(new Blob([a],{type:t||"image/png"}))}))}}),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(e,t){if(t=void 0!==t?t:this.length,"[object Array]"===Object.prototype.toString.call(this))return _slice.call(this,e,t);var n,i,r=[],o=this.length,a=e||0;a=a>=0?a:Math.max(0,o+a);var s="number"==typeof t?Math.min(t,o):o;if(t<0&&(s=o+t),(i=s-a)>0)if(r=new Array(i),this.charAt)for(n=0;n<i;n++)r[n]=this.charAt(a+n);else for(n=0;n<i;n++)r[n]=this[a+n];return r})},26261:(e,t,n)=>{"use strict";n.r(t),n.d(t,{token:()=>f,getWebGLHelpLink:()=>g,EnvironmentConfigurations:()=>U,getUpstreamApiData:()=>B,initializeEnvironmentVariable:()=>V,initializeResourceRoot:()=>G,initializeServiceEndPoints:()=>z,refreshCookie:()=>H,refreshRequestHeader:()=>W,refreshToken:()=>j,initializeAuth:()=>q,initializeLogger:()=>X,Initializer:()=>K,shutdown:()=>Z});var i=n(17167),r=n(98926),o=n(58964),a=n(84998),s=n(58092),l=n(57601),c=n(41471),u=n(21319),h=(0,a.getGlobal)(),d=h,p={accessToken:null,getAccessToken:null,tokenRefreshInterval:null},f=p,m=null;function g(){return m}var v={local:{RTC:["https://rtc-dev.api.autodesk.com:443","https://lmv.autodesk.com:443"]},dev:{RTC:["https://rtc-dev.api.autodesk.com:443","https://lmv.autodesk.com:443"]},stg:{RTC:["https://rtc-stg.api.autodesk.com:443","https://lmv.autodesk.com:443"]},prod:{RTC:["https://rtc.api.autodesk.com:443","https://lmv.autodesk.com:443"]}},y="",b="";if((0,a.getGlobal)().location){var _=(0,a.getGlobal)().location;b=_.protocol+"//"+_.hostname,y=_.protocol+"//"+_.host}var x={local:"",dev:"https://developer-dev.api.autodesk.com",stg:"https://developer-stg.api.autodesk.com",prod:"https://developer.api.autodesk.com"},E="https://us.otgs-dev.autodesk.com",w="https://us.otgs-stg.autodesk.com",S="https://us.otgs.autodesk.com",A="https://eu.otgs-stg.autodesk.com",M="https://eu.otgs.autodesk.com",T="https://cdn-dev.derivative.autodesk.com",C="https://cdn-dev.derivative.autodesk.com/regions/eu",P="https://cdn-stg.derivative.autodesk.com",L="https://cdn-stg.derivative.autodesk.com/regions/eu",R="https://cdn.derivative.autodesk.com",D="https://cdn.derivative.autodesk.com/regions/eu",I="https://cdn-dev.derivative.autodesk.com",O="https://cdn-stg.derivative.autodesk.com",N="https://cdn.derivative.autodesk.com",k="derivativeV2",F="derivativeV2_EU",U=Object.freeze({Local:{ROOT:"",LMV:v.local},Development:{ROOT:x.dev,LMV:v.dev,bubbleManifest:!0},Staging:{ROOT:x.stg,LMV:v.stg,bubbleManifest:!0},Production:{ROOT:x.prod,LMV:v.prod,bubbleManifest:!0},AutodeskDevelopment:{ROOT:x.dev,LMV:v.dev},AutodeskStaging:{ROOT:x.stg,LMV:v.stg},AutodeskProduction:{ROOT:x.prod,LMV:v.prod},AutodeskDevelopment2:{ROOT:I,LMV:v.dev,UPSTREAM:x.dev,UPSTREAM_API_DATA:k},AutodeskStaging2:{ROOT:O,LMV:v.stg,UPSTREAM:x.stg,UPSTREAM_API_DATA:k},AutodeskProduction2:{ROOT:N,LMV:v.prod,UPSTREAM:x.prod,UPSTREAM_API_DATA:k},FluentLocal:{ROOT:y,LMV:y},FluentDev:{ROOT:E,LMV:v.dev,UPSTREAM:x.stg,UPSTREAM_API_DATA:k},FluentStaging:{ROOT:w,LMV:v.stg,UPSTREAM:x.stg,UPSTREAM_API_DATA:k},FluentProduction:{ROOT:S,LMV:v.prod,UPSTREAM:x.prod,UPSTREAM_API_DATA:k},FluentStagingEU:{ROOT:A,LMV:v.stg,UPSTREAM:x.stg,UPSTREAM_API_DATA:F},FluentProductionEU:{ROOT:M,LMV:v.prod,UPSTREAM:x.prod,UPSTREAM_API_DATA:F},MD20DevUS:{ROOT:T,LMV:v.dev,UPSTREAM:x.dev,UPSTREAM_API_DATA:k},MD20DevEU:{ROOT:C,LMV:v.dev,UPSTREAM:x.dev,UPSTREAM_API_DATA:F},MD20StgUS:{ROOT:P,LMV:v.stg,UPSTREAM:x.stg,UPSTREAM_API_DATA:k},MD20StgEU:{ROOT:L,LMV:v.stg,UPSTREAM:x.stg,UPSTREAM_API_DATA:F},MD20ProdUS:{ROOT:R,LMV:v.prod,UPSTREAM:x.prod,UPSTREAM_API_DATA:k},MD20ProdEU:{ROOT:D,LMV:v.prod,UPSTREAM:x.prod,UPSTREAM_API_DATA:F},D3SLocalUS:{ROOT:y,LMV:y,UPSTREAM:y,UPSTREAM_API_DATA:k},D3SLocalEU:{ROOT:y,LMV:y,UPSTREAM:y,UPSTREAM_API_DATA:F},Test:{ROOT:"".concat(b,":").concat(3e3),LMV:v.dev}});function B(e,t){return e.endsWith("EU")?U[e].UPSTREAM_API_DATA:t.endsWith("_EU")?U[e].UPSTREAM_API_DATA+"_EU":U[e].UPSTREAM_API_DATA}function V(e){var t;if(e&&e.env&&(t=e.env),t||(t=(0,i.getParameterByName)("env")),(0,o.setOfflineResourcePrefix)(e&&e.offlineResourcePrefix||""),(0,o.setOffline)(e&&"true"===e.offline),!t)switch(d.location.hostname){case"developer-dev.api.autodesk.com":t="AutodeskDevelopment";break;case"developer-stg.api.autodesk.com":t="AutodeskStaging";break;default:t="AutodeskProduction";break;case"localhost.autodesk.com":case"":case"127.0.0.1":t="Local"}(0,o.setEnv)(t),"undefined"!=typeof window&&r.logger.info("Host name : "+window.location.hostname),r.logger.info("Environment initialized as : "+t)}function G(e){var t,n,r=["viewer3D.js","viewer3D.min.js","viewerCE.js","viewerCE.min.js"];e&&Object.prototype.hasOwnProperty.call(e,"libraryName")&&r.push(e.libraryName);for(var o=!1,a=0;a<r.length;a++){var s=(0,i.getScript)(r[a]),l=(n=s?s.src:"").indexOf(r[a]);if(l>=0){t=n.substr(0,l),(n.indexOf("&v=",l)>0||n.indexOf("?v=",l)>0)&&(o=!0);break}}if(h.LMV_RESOURCE_ROOT=t||h.LMV_RESOURCE_ROOT,o){for(var c=!1,u=["dev","stg","prod"],d=0;d<u.length;++d){var p=x[u[d]];if(-1!==h.LMV_RESOURCE_ROOT.indexOf(p)){c=!0;break}}c&&(h.LMV_RESOURCE_ROOT+=h.LMV_VIEWER_VERSION+"/")}}function z(e){var t=e.endpoint;t||(t=U[(0,o.getEnv)()].ROOT);var n=e.api||t.ENDPOINT_API_DERIVATIVE_SERVICE_V2;if(o.endpoint.setEndpointAndApi(t,n),void 0!==e.escapeOssObjects&&o.endpoint.setEscapeOssObjects(e.escapeOssObjects),!(0,a.isNodeJS)())return G(e),Promise.resolve()}function H(e,t,n){t=t||function(){},l.ViewingService.rawGet(o.endpoint.getApiEndpoint(),null,"/auth/settoken",t,n,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},withCredentials:!0,postData:"access-token="+e})}function W(e){e?o.endpoint.HTTP_REQUEST_HEADERS.Authorization="Bearer "+e:delete o.endpoint.HTTP_REQUEST_HEADERS.Authorization}function j(e,t,n){if(p.accessToken=e,o.endpoint.getUseCookie()){H(e,t,(function(t){r.logger.warn("Failed to set token in cookie. Will use header instead."),o.endpoint.setUseCookie(!1),W(e),n&&n(t)}))}else W(e),t&&t()}function q(e,t){var n,a=t?t.shouldInitializeAuth:void 0;void 0===a&&(a="false"!==(0,i.getParameterByName)("auth").toLowerCase());if(a||W(null),"Local"==(0,o.getEnv)()||!a)return setTimeout(e,0),void o.endpoint.setUseCredentials(void 0!==t.useCredentials&&t.useCredentials);o.endpoint.setUseCredentials(void 0===t.useCredentials||t.useCredentials),o.endpoint.setUseCookie(t.useCookie),p.tokenRefreshInterval&&(clearTimeout(p.tokenRefreshInterval),p.tokenRefreshInterval=null),t&&t.getAccessToken?(p.getAccessToken=t.getAccessToken,n=t.getAccessToken((function i(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3599;if(n=r,p.tokenRefreshInterval?j(n):j(n,e,e),"number"!=typeof o){var a=new Date(o);o=Boolean(+a)&&a.toISOString()===o?(a-Date.now())/1e3:3599}var s=(null==t?void 0:t.tokenExpirationBuffer)||5,l=o-s;l<=0&&(l=o),p.tokenRefreshInterval=setTimeout((function(){t.getAccessToken(i)}),1e3*l)})),"string"==typeof n&&n&&j(n,e)):t&&t.accessToken?j(n=t.accessToken,e):((n=(0,i.getParameterByName)("accessToken"))||r.logger.error("No access token is provided, but authorization requested. This is a problem."),j(n,e))}function X(e){r.logger.initialize(e);var t=(0,i.getParameterByName)("logLevel");t&&r.logger.setLevel(parseInt(t))}function Y(e){e&&"Local"===e.env||o.endpoint.getCdnRedirectUrl()&&l.ViewingService.rawGet(o.endpoint.getCdnRedirectUrl(),null,null,(function(e){e&&e.length&&(o.endpoint.setCdnUrl(e),r.logger.info("CDN_ROOT is: "+e))}),(function(){}),{withCredentials:!1,responseType:"text"})}function K(e,t){if((0,a.isNodeJS)())return V(e),z(e),X(e),Y(e),void q(t,e);e.webGLHelpLink&&(m=e.webGLHelpLink),V(e);var n=z(e);X(e),Y(e),(0,c.initializeLocalization)(e),(0,a.disableDocumentTouchSafari)(),function(e){var t=!(-1!==["Production","fluent"].indexOf("Production"));(e.optOutTrackingByDefault||t)&&(u.analytics.shouldTrack=!1);var n=e.productId?e.productId:"Local"===(0,o.getEnv)()?"Local":"NOT_SET";u.analytics.superProps={productId:n,lmvBuildType:h.LMV_BUILD_TYPE,lmvViewerVersion:h.LMV_VIEWER_VERSION}}(e),(0,s.initWorkerScript)();var i=function(e){return new Promise((function(t){q(t,e)}))}(e);Promise.all([n,i]).then(t)}function Z(){r.logger.shutdown(),Autodesk.Viewing.Private.shutdownPropWorker()}},28400:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var i=n(7913),r=new ArrayBuffer(8),o=new Uint8Array(r),a=new Uint16Array(r),s=new Int32Array(r),l=new Uint32Array(r),c=new Float32Array(r),u=new Float64Array(r);function h(e){this.buffer=e,this.offset=0,this.byteLength=e.length}h.prototype.seek=function(e){this.offset=e},h.prototype.getBytes=function(e){var t=new Uint8Array(this.buffer.buffer,this.offset,e);return this.offset+=e,t},h.prototype.getVarints=function(){var e,t=0,n=0;do{t|=(127&(e=this.buffer[this.offset++]))<<n,n+=7}while(128&e);return t},h.prototype.getUint8=function(){return this.buffer[this.offset++]},h.prototype.getUint16=function(){return o[0]=this.buffer[this.offset++],o[1]=this.buffer[this.offset++],a[0]},h.prototype.getInt16=function(){var e=this.getUint16();return e>32767&&(e|=4294901760),e},h.prototype.getInt32=function(){var e=this.buffer,t=o,n=this.offset;return t[0]=e[n],t[1]=e[n+1],t[2]=e[n+2],t[3]=e[n+3],this.offset+=4,s[0]},h.prototype.getUint32=function(){var e=this.buffer,t=o,n=this.offset;return t[0]=e[n],t[1]=e[n+1],t[2]=e[n+2],t[3]=e[n+3],this.offset+=4,l[0]},h.prototype.getFloat32=function(){var e=this.buffer,t=o,n=this.offset;return t[0]=e[n],t[1]=e[n+1],t[2]=e[n+2],t[3]=e[n+3],this.offset+=4,c[0]},h.prototype.getIndicesArray=function(e,t,n){for(var i=this.buffer,r=new Uint8Array(e,t,2*n),o=this.offset,a=0,s=2*n;a<s;a+=2)r[a]=i[o],r[a+1]=i[o+1],o+=4;this.offset=o},h.prototype.getVector3Array=function(e,t,n,i){var r=this.buffer,o=this.offset,a=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);if(3===i&&0===n){var s=12*t;a.set(r.subarray(o,o+s)),this.offset+=s}else{i*=4;for(var l=4*n,c=0;c<t;c++){for(var u=0;u<12;u++)a[l+u]=r[o++];l+=i}this.offset=o}},h.prototype.getVector2Array=function(e,t,n,i){var r=this.buffer,o=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a=this.offset;i*=4;for(var s=4*n,l=0;l<t;l++){for(var c=0;c<8;c++)o[s+c]=r[a++];s+=i}this.offset=a},h.prototype.getVector4=function(e,t){for(var n=this.buffer,i=o,r=this.offset,a=c,s=0;s<4;s++)i[0]=n[r],i[1]=n[r+1],i[2]=n[r+2],i[3]=n[r+3],e[t+s]=a[0],r+=4;this.offset=r},h.prototype.getFloat64=function(){for(var e=this.buffer,t=o,n=this.offset,i=0;i<8;i++)t[i]=e[n+i];return this.offset+=8,u[0]},h.prototype.getString=function(e){var t=(0,i.Pp)(this.buffer,this.offset,e);return this.offset+=e,t},h.prototype.reset=function(e){this.buffer=e,this.offset=0,this.byteLength=e.length}},51137:(e,t,n)=>{"use strict";n.d(t,{OY:()=>r});var i={Unknown:0,Boolean:1,Integer:2,Double:3,Float:4,BLOB:10,DbKey:11,String:20,LocalizableString:21,DateTime:22,GeoLocation:23,Position:24},r=function(e){return[i.Integer,i.Double,i.Float].includes(e)}},7913:(e,t,n)=>{"use strict";function i(e,t,n){var i,r,o,a,s,l;for(i="",o=n,r=0;r<o;)switch((a=e[t+r++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:i+=String.fromCharCode(a);break;case 12:case 13:s=e[t+r++],i+=String.fromCharCode((31&a)<<6|63&s);break;case 14:s=e[t+r++],l=e[t+r++],i+=String.fromCharCode((15&a)<<12|(63&s)<<6|(63&l)<<0)}return i}function r(e,t,n){var i,r,o,a=n||0;if(r=e.length,t)for(i=0;i<r;i++)(o=e.charCodeAt(i))>=1&&o<=127?t[a++]=o:o>2047?(t[a++]=224|o>>12&15,t[a++]=128|o>>6&63,t[a++]=128|o>>0&63):(t[a++]=192|o>>6&31,t[a++]=128|o>>0&63);else for(i=0;i<r;i++)(o=e.charCodeAt(i))>=1&&o<=127?a++:a+=o>2047?3:2;return a-(n||0)}n.d(t,{MA:()=>i,Ss:()=>r,Pp:()=>o,Up:()=>a});function o(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=e.length),n>1048576?function(e,t,n){var i,r,o,a,s,l,c,u;for(i="",s=[],o=n,l=0,r=0;r<o;){switch((a=e[t+r++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:s.push(String.fromCharCode(a));break;case 12:case 13:c=e[t+r++],s.push(String.fromCharCode((31&a)<<6|63&c));break;case 14:c=e[t+r++],u=e[t+r++],s.push(String.fromCharCode((15&a)<<12|(63&c)<<6|(63&u)<<0))}(++l>=32768||r>=o)&&(i+=s.join(""),s.length=0,l=0)}return i}(e,t,n):i(e,t,n)}function a(e){var t=o(e,0,e.length);return t=t.replace(/\u000e/gi,""),JSON.parse(t)}},42517:(e,t,n)=>{"use strict";n.r(t),n.d(t,{VertexBufferBuilder:()=>o});var i=2*Math.PI,r=[0,1,3,0,3,2];function o(e,t,n,i){var r=t||65536;this.FULL_COUNT=0|(n||32767),this.useInstancing=e,this.useCompactBuffers=i,this.stride=10,this.allocVcount=4*(this.useInstancing?r/4:r),this.vb=new ArrayBuffer(this.stride*this.allocVcount),this.vbf=new Float32Array(this.vb),this.vbi=new Int32Array(this.vb),this.ib=this.useInstancing?null:new Uint16Array(r),this.minLineWidth=Number.MAX_VALUE,this.reset(0)}o.prototype.reset=function(e){this.vcount=e,this.icount=0,this.minx=this.miny=1/0,this.maxx=this.maxy=-1/0,this.dbIds={},this.lastDbId=null,this.colors={},this.numEllipticals=0,this.numCirculars=0,this.numTriangleGeoms=0,this.hasLineStyles=!1,this.changeTracking={},this.stride=10},o.prototype.expandStride=function(){var e=this.stride;if(!(e>=12)){for(var t=this.stride+2,n=new ArrayBuffer(t*this.allocVcount),i=new Uint8Array(this.vb),r=new Uint8Array(n),o=0,a=this.vcount;o<a;o++)for(var s=o*e*4,l=o*t*4,c=0;c<4*e;c++)r[l+c]=i[s+c];this.vb=n,this.vbf=new Float32Array(n),this.vbi=new Int32Array(n),this.stride=t}},o.prototype.addToBounds=function(e,t){e<this.minx&&(this.minx=e),e>this.maxx&&(this.maxx=e),t<this.miny&&(this.miny=t),t>this.maxy&&(this.maxy=t)};var a=new Int32Array(1);function s(e){return a[0]=e,a[0]}o.prototype.trackChanges=function(e,t,n,i,r,o){if(n!==this.lastDbId&&(this.dbIds[s(n)]=1,this.lastDbId=n),o&&(this.hasLineStyles=!0),this.useCompactBuffers){var a=this.changeTracking;l("geomType",e),l("color",t),l("dbId",n),l("layerId",i),l("viewportId",r),l("linePattern",o),this.colors[s(t)]=1}function l(t,n){void 0===a[t]?a[t]=e:a[t]===n&&(a[t+"Varies"]=!0)}},o.prototype.setCommonVertexAttribs=function(e,t,n,i,r,o,a,s){this.trackChanges(n,i,r,o,a,s),t&=255,n&=255,s&=255,o&=65535,a&=65535,this.vbi[e+8]=t|n<<8|s<<16,this.vbi[e+6]=i,this.vbi[e+7]=r,this.vbi[e+9]=o|a<<16},o.prototype.addVertexTriangleGeom=function(e,t,n,i,r,o,a,s,l,c){for(var u=this.vcount,h=this.vbf,d=this.useInstancing?1:4,p=0;p<d;p++){var f=(u+p)*this.stride;h[f]=e,h[f+1]=t,h[f+2]=n,h[f+3]=i,h[f+4]=r,h[f+5]=o,this.setCommonVertexAttribs(f,0+p,5,a,s,l,c,0),this.vcount++}return u},o.prototype.addVertexLine=function(e,t,n,r,o,a,s,l,c,u,h){var d=this.vcount,p=this.vbf;l>=0&&a>0&&r>0&&(this.minLineWidth=Math.min(this.minLineWidth,a));for(var f=this.useInstancing?1:4,m=0;m<f;m++){var g=(d+m)*this.stride;p[g]=e,p[g+1]=t,p[g+2]=(n+Math.PI)/i,p[g+3]=r,p[g+4]=.5*a,p[g+5]=o,this.setCommonVertexAttribs(g,0+m,1,s,l,c,u,h),this.vcount++}return d},o.prototype.addVertexTexQuad=function(e,t,n,r,o,a,s,l,c){for(var u=this.vcount,h=this.vbf,d=this.useInstancing?1:4,p=0;p<d;p++){var f=(u+p)*this.stride;h[f]=e,h[f+1]=t,h[f+2]=o/i,h[f+3]=n,h[f+4]=r,this.setCommonVertexAttribs(f,0+p,4,a,s,l,c,0),this.vcount++}return u},o.prototype.addVertexArc=function(e,t,n,r,o,a,s,l,c,u,h,d){for(var p=this.vcount,f=this.vbf,m=o==a?2:3,g=this.useInstancing?1:4,v=0;v<g;v++){var y=(p+v)*this.stride;f[y]=e,f[y+1]=t,f[y+2]=n/i,f[y+3]=r/i,f[y+4]=.5*l,f[y+5]=o,3===m&&(f[y+10]=a,f[y+11]=s),this.setCommonVertexAttribs(y,0+v,m,c,u,h,d,0),this.vcount++}return p},o.prototype.addVertex=function(e,t,n,i,r,o){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if(!this.useInstancing){var s=this.vcount,l=this.stride*s,c=this.vbf;return c[l]=e,c[l+1]=t,this.setCommonVertexAttribs(l,0,a,n,i,r,o,0),this.vcount++,s}},o.prototype.addVertexPolytriangle=function(e,t,n,i,r,o){this.useInstancing||(this.addVertex(e,t,n,i,r,o),this.addToBounds(e,t))},o.prototype.addVertexMSDFPolytriangle=function(e,t,n,i,r,o,a,s){this.addVertexTexPolytriangle(e,t,n,i,r,o,a,s,6)},o.prototype.addIndices=function(e,t){if(!this.useInstancing){var n=this.ib,i=this.icount;if(i+e.length>=n.length){for(var r=new Uint16Array(2*Math.max(e.length,n.length)),o=0;o<i;++o)r[o]=n[o];this.ib=n=r}for(o=0;o<e.length;++o)n[i+o]=t+e[o];this.icount+=e.length}},o.prototype.finalizeQuad=function(e){this.useInstancing||this.addIndices(r,e)},o.prototype.addSegment=function(e,t,n,i,r,o,a,s,l,c,u){var h=n-e,d=i-t,p=h||d?Math.atan2(d,h):0,f=h||d?Math.sqrt(h*h+d*d):0,m=this.addVertexLine(e,t,p,f,r,o,a,s,l,c,u);this.finalizeQuad(m),this.addToBounds(e,t),this.addToBounds(n,i)},o.prototype.addTriangleGeom=function(e,t,n,i,r,o,a,s,l,c){this.numTriangleGeoms++;var u=this.addVertexTriangleGeom(e,t,n,i,r,o,a,s,l,c);this.finalizeQuad(u),this.addToBounds(e,t),this.addToBounds(n,i),this.addToBounds(r,o)},o.prototype.addArc=function(e,t,n,r,o,a,s,c,u,h,d,p){o==a?this.numCirculars++:(this.numEllipticals++,this.expandStride());var f=l(n,r);if(n=f.start,r=f.end,0==n&&0==r&&(r=i),(_=Math.abs(n-r))>1e-4&&Math.abs(_-i)>1e-4){var m=e+o*Math.cos(n),g=t+a*Math.sin(n);this.addSegment(m,g,m,g,0,c,u,h,d,p);var v=e+o*Math.cos(r),y=t+a*Math.sin(r);this.addSegment(v,y,v,y,0,c,u,h,d,p)}else this.addToBounds(e-o,t-a),this.addToBounds(e+o,t+a);var b=this.addVertexLine(e,t,0,1e-4,0,0,33554431,h,d,p);this.finalizeQuad(b);var _,x=this.addVertexArc(e,t,n,r,o,a,s,c,u,h,d,p);this.finalizeQuad(x)},o.prototype.addTexturedQuad=function(e,t,n,i,r,o,a,s,l){var c=this.addVertexTexQuad(e,t,n,i,r,o,a,s,l);this.finalizeQuad(c);var u=.5*Math.cos(r),h=.5*Math.sin(r),d=Math.abs(n*u)+Math.abs(i*h),p=Math.abs(n*h)+Math.abs(i*u);this.addToBounds(e-d,t-p),this.addToBounds(e+d,t+p)},o.prototype.addVertexImagePolytriangle=function(e,t,n,i,r,o,a,s){return this.addVertexTexPolytriangle(e,t,n,i,r,o,a,s,7)},o.prototype.addVertexTexPolytriangle=function(e,t,n,i,r,o,a,s,l){if(!this.useInstancing){var c=this.vcount,u=this.vbf;this.addVertex(e,t,r,o,a,s,l),u[c*this.stride+2]=n,u[c*this.stride+3]=i,this.addToBounds(e,t)}},o.prototype.isFull=function(e){e=e||3;var t=this.useInstancing?4:1;return this.vcount*t+e>this.FULL_COUNT},o.prototype.makeCompactVertexLayout=function(){var e=Object.keys(this.colors),t=Object.keys(this.dbIds);if(10!==this.stride)return null;var n=e.length+t.length;if(e.length+t.length>65536)return null;var i=new Int32Array(n+1);i[0]=0;for(var r=1,o=0;o<e.length;o++,r++)i[r]=parseInt(e[o]),this.colors[e[o]]=r;for(o=0;o<t.length;o++,r++)i[r]=parseInt(t[o]),this.dbIds[t[o]]=r;var a=new ArrayBuffer(24*this.vcount),s=new Int32Array(a),l=new Uint16Array(a),c=this.maxx-this.minx||1,u=this.maxy-this.miny||1,h=this.minx,d=this.miny,p=Math.max(c,u);function f(e){return 0|Math.round((e-h)/c*65535)}function m(e){return 0|Math.round((e-d)/u*65535)}function g(e){return 0|Math.round(e/p*65535)}function v(e){return 0|65535*e}function y(e){return e<0?32768+32767*Math.min(1,-e/1024):e?0|Math.round(e/p*32767)||1:e}for(o=0;o<this.vcount;o++){var b=this.stride*o,_=6*o,x=2*_;switch(this.vbi[b+8]>>8&255){case 0:l[x]=f(this.vbf[b]),l[x+1]=m(this.vbf[b+1]);break;case 1:l[x]=f(this.vbf[b]),l[x+1]=m(this.vbf[b+1]),l[x+2]=v(this.vbf[b+2]),l[x+3]=g(this.vbf[b+3]),l[x+4]=y(this.vbf[b+4]);break;case 2:l[x]=f(this.vbf[b]),l[x+1]=m(this.vbf[b+1]),l[x+2]=v(this.vbf[b+2]),l[x+3]=v(this.vbf[b+3]),l[x+4]=y(this.vbf[b+4]),l[x+5]=g(this.vbf[b+5]);break;case 3:break;case 4:l[x]=f(this.vbf[b]),l[x+1]=m(this.vbf[b+1]),l[x+2]=v(this.vbf[b+2]),l[x+3]=g(this.vbf[b+3]),l[x+4]=g(this.vbf[b+4]);break;case 5:l[x]=f(this.vbf[b]),l[x+1]=m(this.vbf[b+1]),l[x+2]=f(this.vbf[b+2]),l[x+3]=m(this.vbf[b+3]),l[x+4]=f(this.vbf[b+4]),l[x+5]=m(this.vbf[b+5]);break;default:console.error("Unknown geometry type")}l[x+6]=this.colors[this.vbi[b+6]]||0,l[x+7]=this.dbIds[this.vbi[b+7]]||0,s[_+4]=this.vbi[b+8],s[_+5]=this.vbi[b+9]}var E={};E.vb=new Float32Array(a),E.vbstride=6;var w=this.useInstancing?1:0;return E.vblayout={fields1:{offset:0,itemSize:2,bytesPerItem:2,divisor:w,normalized:!0},fields2:{offset:1,itemSize:4,bytesPerItem:2,divisor:w,normalized:!0},uvIdColor:{offset:3,itemSize:2,bytesPerItem:2,divisor:w,normalized:!1},flags4b:{offset:4,itemSize:4,bytesPerItem:1,divisor:w,normalized:!1},layerVp4b:{offset:5,itemSize:4,bytesPerItem:1,divisor:w,normalized:!1}},E.unpackXform={x:c,y:u,z:h,w:d},E.texData=i,E},o.prototype.makeWideVertexLayout=function(){var e={};e.vb=new Float32Array(this.vb.slice(0,this.vcount*this.stride*4)),e.vbstride=this.stride;var t=this.useInstancing?1:0;return e.vblayout={fields1:{offset:0,itemSize:2,bytesPerItem:4,divisor:t,normalized:!1},fields2:{offset:2,itemSize:4,bytesPerItem:4,divisor:t,normalized:!1},color4b:{offset:6,itemSize:4,bytesPerItem:1,divisor:t,normalized:!0},dbId4b:{offset:7,itemSize:4,bytesPerItem:1,divisor:t,normalized:!1},flags4b:{offset:8,itemSize:4,bytesPerItem:1,divisor:t,normalized:!1},layerVp4b:{offset:9,itemSize:4,bytesPerItem:1,divisor:t,normalized:!1}},e.vblayout.extraParams={offset:this.stride-2,itemSize:2,bytesPerItem:4,divisor:t,normalized:!1},e},o.prototype.toMesh=function(){var e=null;if(this.useCompactBuffers&&(e=this.makeCompactVertexLayout()),e||(e=this.makeWideVertexLayout()),this.useInstancing){e.numInstances=this.vcount;var t=new Int32Array([0,1,2,3]);e.vblayout.instFlags4b={offset:0,itemSize:4,bytesPerItem:1,divisor:0,normalized:!1},e.vblayout.instFlags4b.array=t.buffer;e.indices=new Uint16Array(r)}else e.indices=new Uint16Array(this.ib.buffer.slice(0,2*this.icount));e.dbIds=this.dbIds;var n=this.maxx-this.minx,i=this.maxy-this.miny,o=Math.max(n,i);e.boundingBox={min:{x:this.minx,y:this.miny,z:.001*-o},max:{x:this.maxx,y:this.maxy,z:.001*o}};e.boundingSphere={center:{x:.5*(this.minx+this.maxx),y:.5*(this.miny+this.maxy),z:0},radius:.5*Math.sqrt(n*n+i*i)};return e};var l=function(e,t){function n(){function n(e,t){return Math.abs(e-t)<.001}n(e,0)&&(e=0),n(t,0)&&(t=0),n(e,i)&&(e=i),n(t,i)&&(t=i)}if(n(),e>t)for(;e>i;)e-=i,t-=i;else for(;t>i;)e-=i,t-=i;return n(),e<0&&t>0&&(e+=i),{start:e,end:t}}},89371:(e,t,n)=>{"use strict";n.r(t),n.d(t,{F2D:()=>f,F2dDataType:()=>u,F2dSemanticType:()=>h,F2dShadowRatio:()=>d,restoreSignBitFromLSB:()=>p});var i=n(42517),r=n(22585),o=n(73075),a=function(e,t){t.min.x<e.min.x&&(e.min.x=t.min.x),t.min.y<e.min.y&&(e.min.y=t.min.y),t.min.z<e.min.z&&(e.min.z=t.min.z),t.max.x>e.max.x&&(e.max.x=t.max.x),t.max.y>e.max.y&&(e.max.y=t.max.y),t.max.z>e.max.z&&(e.max.z=t.max.z)},s=n(28400),l=n(98926),c=n(79659),u={dt_object:0,dt_void:1,dt_byte:2,dt_int:3,dt_float:4,dt_double:5,dt_varint:6,dt_point_varint:7,dt_byte_array:32,dt_int_array:33,dt_float_array:34,dt_double_array:35,dt_varint_array:36,dt_point_varint_array:37,dt_arc:38,dt_circle:39,dt_circular_arc:40,dt_string:63,dt_last_data_type:127},h={st_object_member:0,st_fill:1,st_fill_off:2,st_clip_off:3,st_layer:4,st_link:5,st_line_weight:6,st_miter_angle:7,st_miter_length:8,st_line_pattern_ref:9,st_back_color:10,st_color:11,st_markup:12,st_object_id:13,st_markup_id:14,st_reset_rel_offset:15,st_font_ref:16,st_begin_object:32,st_clip:33,st_line_caps:34,st_line_join:35,st_line_pattern_def:36,st_font_def:37,st_viewport:38,st_sheet:42,st_arc:43,st_polyline:44,st_raster:45,st_text:46,st_polytriangle:47,st_dot:48,st_end_object:63,st_last_semantic_type:127},d=.0075;function p(e){return 1&e?-(e>>>1):e>>>1}function f(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(this.metadata=e,this.scaleX=1,this.scaleY=1,this.bbox={min:{x:0,y:0,z:0},max:{x:0,y:0,z:0}},this.is2d=!0,this.layersMap={},this.fontDefs={},this.fontCount=0,this.fontId=0,this.manifestAvailable=!1,this.geomMetricsSum=0,this.objectMemberQueue=[],this.propertydb={attrs:[],avs:[],ids:[],values:[],offsets:[],viewables:[]},e){var a=e.page_dimensions;this.paperWidth=a.page_width,this.paperHeight=a.page_height,this.scaleX=this.paperWidth/a.plot_width,this.scaleY=this.paperHeight/a.plot_height,this.hidePaper=a.hide_paper;var s=this.paperWidth,l=this.paperHeight;this.bbox.max.x=s,this.bbox.max.y=l;var c=e.page_dimensions||{};if(isFinite(c.paper_rotation)&&0!==c.paper_rotation){var u=c.paper_rotation*Math.PI/180,h=Math.cos(u),d=Math.sin(u),p=s*h,f=s*d,m=-l*d,g=l*h;this.bbox.min.x=Math.min(0,p,m,p+m),this.bbox.max.x=Math.max(0,p,m,p+m),this.bbox.min.y=Math.min(0,f,g,f+g),this.bbox.max.y=Math.max(0,f,g,f+g)}isFinite(c.paper_offset_x)&&0!==c.paper_offset_x&&(this.bbox.min.x+=c.paper_offset_x,this.bbox.max.x+=c.paper_offset_x),isFinite(c.paper_offset_y)&&0!==c.paper_offset_y&&(this.bbox.min.y+=c.paper_offset_y,this.bbox.max.y+=c.paper_offset_y);var v=0;for(var y in this.layersMap[0]=v++,e.layers){var b=parseInt(y);this.layersMap[b]=v++}if(this.layerCount=v,this.createLayerGroups(e.layers),e.geom_metrics){var _=Object.keys(e.geom_metrics).map((function(t){return e.geom_metrics[t]}));this.geomMetricsSum=_.reduce((function(e,t){return e+t}))}}this.hidePaper=this.hidePaper||o.modelSpace,this.noShadow=!!o.noShadow,this.hasPageShadow=!1,this.opCount=0,this.excludeTextGeometry=o.excludeTextGeometry,this.extendStringsFetching=o.extendStringsFetching,this.fontFaces=[],this.fontFamilies=[],this.viewports=[{}],this.currentVpId=0,this.viewports[0].geom_metrics=this.currentGeomMetrics={arcs:0,circles:0,circ_arcs:0,viewports:0,clips:0,colors:0,db_ids:0,dots:0,fills:0,layers:0,line_caps:0,line_joins:0,line_patterns:0,line_pat_refs:0,plines:0,pline_points:0,line_weights:0,links:0,miters:0,ptris:0,ptri_indices:0,ptri_points:0,rasters:0,texts:0,strings:[]},this.clips=[0],this.strings=[],this.stringDbIds=[],this.stringBoxes=[],this.extendStringsFetching&&(this.stringCharWidths=[],this.stringAngles=[],this.stringPositions=[],this.stringHeights=[]),this.currentStringNumber=-1,this.currentStringBox=new r.LmvBox3,this.linkBoxes=[],this.currentLinkBox=new r.LmvBox3,this.objectNumber=0,this.currentFakeId=-2,this.imageNumber=0,this.linkNumber=0,this.maxObjectNumber=0,this.objectStack=[],this.objectNameStack=[],this.parseObjState={polyTriangle:{},viewport:{},clip:{},raster:{},text:{},fontDef:{},uknown:{}},this.layer=0,this.bgColor="number"==typeof o.bgColor?o.bgColor:4294967295,this.contrastColor=this.color=this.fillColor=4278190080,this.hidePaper&&(this.contrastColor=4294967040),this.isMobile=o&&!!o.isMobile;var x=o&&!!o.isWebGL2,E=this.isMobile&&(x||this.geomMetricsSum>1e7),w=E&&o&&!!o.supportsInstancing,S=E;if(this.max_vcount=this.isMobile?16383:void 0,this.currentVbb=new i.VertexBufferBuilder(w,void 0,this.max_vcount,S),this.meshes=[],this.numCircles=this.numEllipses=this.numPolylines=this.numLineSegs=0,this.numPolytriangles=this.numTriangles=0,this.error=!1,this.offsetX=0,this.offsetY=0,t){this.manifestAvailable=!0,this.imageId2URI={};for(var A=t.assets,M=0,T=A.length;M<T;++M){var C=A[M],P=C.mime;if(-1!==P.indexOf("image/")){var L=C.id;L=L.substr(0,L.indexOf(".")),this.imageId2URI[L]=n+C.URI}"Autodesk.CloudPlatform.PropertyAttributes"===C.type&&this.propertydb.attrs.push({path:C.URI}),"Autodesk.CloudPlatform.PropertyValues"===C.type&&this.propertydb.values.push({path:C.URI}),"Autodesk.CloudPlatform.PropertyIDs"===C.type&&this.propertydb.ids.push({path:C.URI}),"Autodesk.CloudPlatform.PropertyViewables"===C.type&&this.propertydb.viewables.push({path:C.URI}),"Autodesk.CloudPlatform.PropertyOffsets"===C.type&&-1===C.id.indexOf("rcv")&&this.propertydb.offsets.push({path:C.URI}),"Autodesk.CloudPlatform.PropertyAVs"===C.type&&this.propertydb.avs.push({path:C.URI})}}}f.prototype.load=function(e,t){if(t instanceof Uint8Array||(t=new Uint8Array(t)),this.data=t,this.parse(),this.stringBoxes.length){var n=new Float32Array(this.stringBoxes.length);n.set(this.stringBoxes),this.stringBoxes=n}e.loadDoneCB(!0)},f.prototype.loadFrames=function(e){this.loadContext=e;var t=e.data;if(t)t instanceof Uint8Array||(t=new Uint8Array(t)),this.data=t;else if(e.finalFrame&&(this.data=null,this.stringBoxes.length)){var n=new Float32Array(this.stringBoxes.length);n.set(this.stringBoxes),this.stringBoxes=n}this.parseFrames(e.finalFrame),e.loadDoneCB(!0)},f.prototype.pushMesh=function(e){this.meshes.push(e),e.material={skipEllipticals:!this.currentVbb.numEllipticals,skipCircles:!this.currentVbb.numCirculars,skipTriangleGeoms:!this.currentVbb.numTriangleGeoms,useInstancing:this.currentVbb.useInstancing,unpackPositions:!!e.unpackXform},this.currentImage&&(e.material.image=this.currentImage,e.material.image.name=this.imageNumber++,this.currentImage=null)},f.prototype.flushBuffer=function(e,t){if(this.currentVbb.vcount||t){var n=t;if(n=n||this.currentVbb.isFull(e)){if(this.currentVbb.vcount){var i=this.currentVbb.toMesh();a(this.bbox,i.boundingBox),this.pushMesh(i),this.currentVbb.reset(0)}this.loadContext&&this.loadContext.loadDoneCB(!0,t)}}},f.prototype.tx=function(e){return this.sx(e)},f.prototype.ty=function(e){return this.sy(e)},f.prototype.sx=function(e){return e*this.scaleX},f.prototype.sy=function(e){return e*this.scaleY},f.prototype.invertColor=function(e){var t=e>>16&255,n=e>>8&255,i=255&e;return(e>>24&255)<<24|(t=255-t)<<16|(n=255-n)<<8|(i=255-i)},f.prototype.mapColor=function(e,t){if(!this.hidePaper||0!==this.bgColor)return e;var n=255&e;return n<127||n===(65280&e)>>8&&n===(16711680&e)>>16&&t&&(e&=1442840575),e},f.prototype.parsePointPositions=function(){var e=this.stream.getVarints(),t=this.stream.getVarints();return e=p(e),t=p(t),e+=this.offsetX,t+=this.offsetY,this.offsetX=e,this.offsetY=t,[this.tx(e),this.ty(t)]},f.prototype.parserAssert=function(e,t,n){return e!=t&&(l.logger.warn("Expect "+t+"; actual type is "+e+"; in function "+n),this.error=!0,!0)},f.prototype.unhandledTypeWarning=function(e,t){l.logger.warn("Unhandled semantic type : "+t+" in function "+e)},f.prototype.parseObject=function(){var e=this.stream.getVarints();switch(this.objectStack.push(e),e){case h.st_sheet:this.objectNameStack.push("sheet"),this.objectMemberQueue.unshift("paperColor");break;case h.st_viewport:this.objectNameStack.push("viewport"),this.objectMemberQueue.unshift("units","transform");break;case h.st_clip:this.objectNameStack.push("clip"),this.objectMemberQueue.unshift("contourCounts","points","indices");break;case h.st_polytriangle:this.objectNameStack.push("polyTriangle"),this.objectMemberQueue.unshift("points","indices","colors");break;case h.st_raster:this.objectNameStack.push("raster"),this.objectMemberQueue.unshift("position","width","height","imageId");break;case h.st_text:this.currentStringNumber=this.strings.length,0===this.objectNumber&&(this.objectNumber=this.currentFakeId--),this.currentStringBox.makeEmpty(),this.objectNameStack.push("text"),this.objectMemberQueue.unshift("string","position","height","widthScale","rotation","oblique","charWidths");break;case h.st_font_def:this.objectNameStack.push("fontDef"),this.objectMemberQueue.unshift("name","fullName","flags","spacing","panose");break;case h.st_end_object:if(this.objectStack.pop(),this.objectStack.length){switch(this.objectStack.pop()){case h.st_polytriangle:this.actOnPolyTriangle();break;case h.st_viewport:this.actOnViewport();break;case h.st_clip:this.actOnClip();break;case h.st_raster:this.actOnRaster();break;case h.st_text:this.actOnText();break;case h.st_font_def:this.actOnFontDef()}var t=this.objectNameStack.pop(),n=this.parseObjState[t];for(var i in n)n[i]=null}else this.parserAssert(0,1,"parseEndObject (Stack Empty)");this.objectMemberQueue.length=0;break;default:this.objectNameStack.push("unknown"),this.error=!0,this.unhandledTypeWarning("parseObject",e)}},f.prototype.initSheet=function(e){if(!this.hidePaper&&(this.bgColor=e,this.metadata)){var t=this.paperWidth,n=this.paperHeight,i={x:0,y:0},r={x:t,y:0},o={x:0,y:n},a=this.metadata.page_dimensions||{};if(isFinite(a.paper_rotation)&&0!==a.paper_rotation){var s=a.paper_rotation*Math.PI/180,l=Math.cos(s),c=Math.sin(s);r.y=t*c,r.x=t*l,o.x=-n*c,o.y=n*l}isFinite(a.paper_offset_x)&&0!==a.paper_offset_x&&(i.x=a.paper_offset_x),isFinite(a.paper_offset_y)&&0!==a.paper_offset_y&&(i.y=a.paper_offset_y);var u=this.currentVbb,h=[i.x,i.y,i.x+r.x,i.y+r.y,i.x+r.x+o.x,i.y+r.y+o.y,i.x+o.x,i.y+o.y],p=[e,e,e,e],f=[0,1,2,0,2,3];if(!this.noShadow){var m=t*d,g={x:r.x*m/t,y:r.y*m/t},v={x:o.x*m/n,y:o.y*m/n},y={x:i.x+g.x,y:i.y+g.y},b={x:i.x+r.x,y:i.y+r.y},_=4283782485;h=h.concat([y.x-v.x,y.y-v.y,y.x-v.x+r.x,y.y-v.y+r.y,y.x+r.x,y.y+r.y,y.x,y.y,b.x,b.y,b.x+g.x,b.y+g.y,b.x+g.x-v.x+o.x,b.y+g.y-v.y+o.y,b.x-v.x+o.x,b.y-v.y+o.y]),p=p.concat([_,_,_,_,_,_,_,_]),f=f.concat([4,5,6,4,6,7,8,9,10,8,10,11]),this.hasPageShadow=!0}this.addPolyTriangle(h,p,f,4294967295,-1,0,!1),u.addSegment(i.x,i.y,i.x+r.x,i.y+r.y,0,1e-6,4278190080,-1,0,this.currentVpId),u.addSegment(i.x+r.x,i.y+r.y,i.x+r.x+o.x,i.y+r.y+o.y,0,1e-6,4278190080,-1,0,this.currentVpId),u.addSegment(i.x+r.x+o.x,i.y+r.y+o.y,i.x+o.x,i.y+o.y,0,1e-6,4278190080,-1,0,this.currentVpId),u.addSegment(i.x+o.x,i.y+o.y,i.x,i.y,0,1e-6,4278190080,-1,0,this.currentVpId)}},f.prototype.setObjectMember=function(e){if(!this.objectMemberQueue.length)return l.logger.warn("Unexpected object member. "+e+" on object "+this.objectNameStack[this.objectNameStack.length-1]),!1;var t=this.objectMemberQueue.shift(),n=this.objectNameStack[this.objectNameStack.length-1];return"sheet"==n&&"paperColor"==t?(this.initSheet(e),!0):!!n&&(this.parseObjState[n][t]=e,!0)},f.prototype.parseString=function(){var e=this.stream,t=e.getVarints(),n=e.getVarints(),i=e.getString(n);if(t===h.st_object_member){if(this.setObjectMember(i))return}else l.logger.info("Unexpected opcode semantic type for string.");return i},f.prototype.actOnFontDef=function(){var e=this.parseObjState.fontDef;this.fontDefs[++this.fontCount]=e,this.fontId=this.fontCount},f.prototype.parsePoint=function(){var e=this.stream.getVarints(),t=this.parsePointPositions();if(e===h.st_object_member){if(this.setObjectMember(t))return}else l.logger.info("Unexpected opcode semantic type for point.");return t},f.prototype.parsePointsArray=function(){var e=this.stream,t=e.getVarints(),n=e.getVarints();if(n){n/=2;for(var i,r=[],o=0;o<n;++o)i=this.parsePointPositions(),r.push(i[0]),r.push(i[1]);switch(t){case h.st_polyline:return void this.actOnPolylinePointsArray(r);case h.st_dot:return void this.actOnDot(r);case h.st_object_member:if(this.setObjectMember(r))return;break;default:l.logger.info("Unexpected opcode semantic type for points array.")}return r}},f.prototype.parseIntArray=function(){for(var e=this.stream,t=e.getVarints(),n=e.getVarints(),i=[],r=0;r<n;++r)i.push(e.getUint32());if(t===h.st_object_member){if(this.setObjectMember(i))return}else this.unhandledTypeWarning("parseIntArray",t);return i},f.prototype.parseDoubleArray=function(){for(var e=this.stream,t=e.getVarints(),n=e.getVarints(),i=[],r=0;r<n;++r)i.push(e.getFloat64());if(t===h.st_object_member){if(this.setObjectMember(i))return}else this.unhandledTypeWarning("parseDoubleArray",t);return i},f.prototype.parseByteArray=function(){for(var e=this.stream,t=e.getVarints(),n=e.getVarints(),i=[],r=0;r<n;++r)i.push(e.getUint8());if(t===h.st_object_member){if(this.setObjectMember(i))return}else this.unhandledTypeWarning("parseByteArray",t);return i},f.prototype.parseVarintArray=function(){for(var e=this.stream,t=e.getVarints(),n=[],i=e.getVarints(),r=0;r<i;++r)n.push(e.getVarints());if(t===h.st_object_member){if(this.setObjectMember(n))return}else this.unhandledTypeWarning("parseVarIntArray",t);return n},f.prototype.parseInt=function(){var e=this.stream,t=e.getVarints(),n=e.getUint32();switch(t){case h.st_color:this.color=this.mapColor(n,!1),this.currentGeomMetrics.colors++;break;case h.st_fill:this.fill=!0,this.fillColor=this.mapColor(n,!0),this.currentGeomMetrics.fills++;break;case h.st_object_member:if(this.setObjectMember(n))return;default:this.unhandledTypeWarning("parseInt",t)}return n},f.prototype.parseVoid=function(){var e=this.stream.getVarints();if(e===h.st_fill_off)this.fill=!1,this.currentGeomMetrics.fills++;else this.unhandledTypeWarning("parseVoid",e)},f.prototype.parseVarint=function(){var e=this.stream,t=e.getVarints(),n=e.getVarints();switch(t){case h.st_line_weight:this.lineWeight=this.tx(n),this.currentGeomMetrics.line_weights++;break;case h.st_line_caps:this.currentGeomMetrics.line_caps++;break;case h.st_line_join:this.currentGeomMetrics.line_joins++;break;case h.st_object_id:case h.st_markup_id:this.objectNumber=n,this.maxObjectNumber=Math.max(this.maxObjectNumber,n),this.currentGeomMetrics.db_ids++;break;case h.st_link:this.linkNumber&&(this.linkBoxes[this.linkNumber]=this.currentLinkBox.clone(),this.currentLinkBox.makeEmpty()),this.linkNumber=n;break;case h.st_layer:this.currentGeomMetrics.layers++,this.layer=this.layersMap[n];break;case h.st_font_ref:this.fontId=n;break;case h.st_object_member:if(this.setObjectMember(n))return}return n},f.prototype.parseFloat=function(){var e=this.stream,t=e.getVarints(),n=e.getFloat32();switch(t){case h.st_miter_angle:case h.st_miter_length:break;case h.st_object_member:if(this.setObjectMember(n))return}return n},f.prototype.parseCircularArc=function(){var e=this.stream,t=e.getVarints();if(!this.parserAssert(t,h.st_arc,"parseCircularArc")){var n=this.parsePointPositions(),i=e.getVarints(),r=e.getFloat32(),o=e.getFloat32();this.actOnCircularArc(n[0],n[1],r,o,this.sx(i))}},f.prototype.parseCircle=function(){var e=this.stream,t=e.getVarints();if(!this.parserAssert(t,h.st_arc,"parseCircle")){var n=this.parsePointPositions(),i=e.getVarints();this.actOnCompleteCircle(n[0],n[1],this.sx(i))}},f.prototype.parseArc=function(){var e=this.stream,t=e.getVarints();if(!this.parserAssert(t,h.st_arc,"parseArc")){var n=this.parsePointPositions(),i=e.getVarints(),r=e.getVarints(),o=e.getFloat32(),a=e.getFloat32(),s=e.getFloat32();this.actOnArc(n[0],n[1],a,s,this.sx(i),this.sy(r),o)}},f.prototype.parseDataType=function(){var e=this.stream.getVarints();switch(e){case u.dt_void:this.parseVoid();break;case u.dt_int:this.parseInt();break;case u.dt_object:this.parseObject();break;case u.dt_varint:this.parseVarint();break;case u.dt_point_varint:this.parsePoint();break;case u.dt_float:this.parseFloat();break;case u.dt_point_varint_array:this.parsePointsArray();break;case u.dt_circular_arc:this.parseCircularArc();break;case u.dt_circle:this.parseCircle();break;case u.dt_arc:this.parseArc();break;case u.dt_int_array:this.parseIntArray();break;case u.dt_varint_array:this.parseVarintArray();break;case u.dt_byte_array:this.parseByteArray();break;case u.dt_string:this.parseString();break;case u.dt_double_array:this.parseDoubleArray();break;default:this.error=!0,l.logger.info("Data type not supported yet: "+e)}},f.prototype.readHeader=function(){var e=this.stream=new s.A(this.data),t=e.getString(3);if("F2D"!==t)return l.logger.error("Invalid F2D header : "+t,(0,c.errorCodeString)(c.ErrorCodes.BAD_DATA)),!1;var n=e.getString(2);if("01"!==n)return l.logger.error("Only support f2d major version 1; actual version is : "+n,(0,c.errorCodeString)(c.ErrorCodes.BAD_DATA)),!1;if("."!==e.getString(1))return l.logger.error("Invalid version delimiter.",(0,c.errorCodeString)(c.ErrorCodes.BAD_DATA)),!1;e.getString(2);return!0},f.prototype.parse=function(){if(this.readHeader()){for(var e=this.stream;e.offset<e.byteLength&&(this.parseDataType(),!this.error);)this.opCount++;this.linkNumber&&(this.linkBoxes[this.linkNumber]=this.currentLinkBox.clone(),this.currentLinkBox.makeEmpty()),this.flushBuffer(0,!0),this.currentVbb=null,this.stream=null,this.data=null,l.logger.info("F2d parse: data types count : "+this.opCount)}},f.prototype.parseFrames=function(e){if(this.data)for(var t=this.stream=new s.A(this.data);t.offset<t.byteLength&&(this.parseDataType(),!this.error);)this.opCount++;else e||l.logger.warn("Unexpected F2D parse state: If there is no data, we only expect a flush command, but flush was false.");e&&this.flushBuffer(0,!0),this.stream=null,this.data=null},f.prototype.actOnPolylinePointsArray=function(e){this.flushBuffer();for(var t=e.length/2,n=0,i=e[0],r=e[1],o=1;o<t;++o){var a=e[2*o],s=e[2*o+1];this.currentVbb.addSegment(i,r,a,s,n,this.lineWeight,this.color,this.objectNumber,this.layer,this.currentVpId),n+=Math.sqrt((a-i)*(a-i)+(s-r)*(s-r)),i=a,r=s}this.numPolylines++,this.numLineSegs+=t-1,this.currentGeomMetrics.plines++,this.currentGeomMetrics.pline_points+=t-1},f.prototype.actOnDot=function(e){this.currentGeomMetrics.dots++;var t=e[0],n=e[1];this.actOnCompleteCircle(t,n,this.sx(1),!0)},f.prototype.actOnCompleteCircle=function(e,t,n,i){this.flushBuffer(),this.numCircles++,i||this.currentGeomMetrics.circles++,this.fill?this.currentVbb.addSegment(e,t,e,t,0,2*n,this.color,this.objectNumber,this.layer,this.currentVpId,!0,!1,!0):this.currentVbb.addArc(e,t,0,2*Math.PI,n,n,0,this.lineWeight,this.color,this.objectNumber,this.layer,this.currentVpId)},f.prototype.actOnCircularArc=function(e,t,n,i,r){this.numCircles++,this.currentGeomMetrics.circ_arcs++,this.flushBuffer(),this.currentVbb.addArc(e,t,n,i,r,r,0,this.lineWeight,this.color,this.objectNumber,this.layer,this.currentVpId)},f.prototype.actOnArc=function(e,t,n,i,r,o,a){this.numEllipses++,this.currentGeomMetrics.arcs++,this.flushBuffer(),this.currentVbb.addArc(e,t,n,i,r,o,a,this.lineWeight,this.color,this.objectNumber,this.layer,this.currentVpId)},f.prototype.actOnRaster=function(){if(this.manifestAvailable){this.flushBuffer(4,!0);var e=this.parseObjState.raster,t=e.position,n=e.imageId,i=this.imageId2URI[n],r=this.sx(e.width),o=this.sy(e.height),a=t[0]+.5*r,s=t[1]-.5*o;this.currentVbb.addTexturedQuad(a,s,r,o,0,4278255615,this.objectNumber,this.layer,this.currentVpId),this.currentImage={dataURI:i},this.flushBuffer(0,!0),this.currentGeomMetrics.rasters++}},f.prototype.actOnClip=function(){var e=this.parseObjState.clip;this.parseObjState.clip={},this.clips.push(e),this.currentGeomMetrics.clips++},f.prototype.actOnText=function(){this.strings[this.currentStringNumber]=this.parseObjState.text.string,this.currentGeomMetrics.texts++,this.currentGeomMetrics.strings.push(this.parseObjState.text.string),this.stringDbIds[this.currentStringNumber]=this.objectNumber,this.stringBoxes.push(this.currentStringBox.min.x,this.currentStringBox.min.y,this.currentStringBox.max.x,this.currentStringBox.max.y),this.extendStringsFetching&&(this.stringCharWidths.push(this.parseObjState.text.charWidths),this.stringAngles.push(this.parseObjState.text.rotation),this.stringPositions.push(this.parseObjState.text.position),this.stringHeights.push(this.parseObjState.text.height)),this.currentStringBox.makeEmpty(),this.currentStringNumber=-1,this.objectNumber<-1&&(this.objectNumber=0)};var m=new o.LmvVector3;f.prototype.addPolyTriangle=function(e,t,n,i,r,o,a){var s=this,c=null,u=-1;function d(e,t){if(e>t){var n=e;e=t,t=n}if(c[e]){var i=c[e],r=i.lastIndexOf(t);-1==r?i.push(t):i[r]=-1}else c[e]=[t]}function p(n,a){if(n>a){var h=n;n=a,a=h}var d=c[n];d&&(-1!=d.indexOf(a)&&(s.flushBuffer(4),s.currentVbb.addSegment(e[2*n],e[2*n+1],e[2*a],e[2*a+1],0,u,s.mapColor(t?t[n]:i,!0),r,o,s.currentVpId),t&&t[n]!=t[a]&&l.logger.warn("Gouraud triangle encountered. Will have incorrect antialiasing.")))}if(this.objectStack[this.objectStack.length-1]==h.st_text&&(u=-.5),a){c=new Array(e.length/2);for(var f=0,g=n.length;f<g;f+=3){var v=n[f],y=n[f+1],b=n[f+2];d(v,y),d(y,b),d(b,v)}}if(-1!==this.currentStringNumber||this.linkNumber){var _=e.length/2;for(f=0;f<_;++f)m.set(e[2*f],e[2*f+1],0),-1!==this.currentStringNumber&&this.currentStringBox.expandByPoint(m),this.linkNumber&&this.currentLinkBox.expandByPoint(m)}if(this.currentVbb.useInstancing)for(_=n.length,f=0;f<_;f+=3){v=n[f],y=n[f+1],b=n[f+2];this.flushBuffer(4),this.currentVbb.addTriangleGeom(e[2*v],e[2*v+1],e[2*y],e[2*y+1],e[2*b],e[2*b+1],this.mapColor(t?t[v]:i,!0),r,o,this.currentVpId),a&&(p(v,y),p(y,b),p(b,v))}else{_=e.length/2;this.flushBuffer(_);var x=this.currentVbb,E=x.vcount;for(f=0;f<_;++f){var w=e[2*f],S=e[2*f+1];x.addVertexPolytriangle(w,S,this.mapColor(t?t[f]:i,!0),r,o,this.currentVpId)}x.addIndices(n,E),a&&function(){for(var n=0,a=c.length;n<a;n++){var h=c[n];if(h)for(var d=0;d<h.length;d++){var p=h[d];-1!=p&&(s.flushBuffer(4),s.currentVbb.addSegment(e[2*n],e[2*n+1],e[2*p],e[2*p+1],0,u,s.mapColor(t?t[n]:i,!0),r,o,s.currentVpId),t&&t[n]!=t[p]&&l.logger.warn("Gouraud triangle encountered. Will have incorrect antialiasing."))}}}()}},f.prototype.actOnPolyTriangle=function(){var e=this.parseObjState.polyTriangle;this.parseObjState.polyTriangle={};var t=e.points,n=e.indices,i=e.colors;if(t&&n){if(this.objectStack[this.objectStack.length-1]==h.st_text){if(this.excludeTextGeometry)return}else this.currentGeomMetrics.ptris++,this.currentGeomMetrics.ptri_points+=t.length/2,this.currentGeomMetrics.ptri_indices+=n.length;this.numPolytriangles++,this.numTriangles+=n.length/3,this.addPolyTriangle(t,i,n,this.color,this.objectNumber,this.layer,!0)}else l.logger.warn("Malformed polytriangle.")},f.prototype.actOnViewport=function(){var e=this.parseObjState.viewport;this.parseObjState.viewport={},e.geom_metrics=this.currentGeomMetrics={arcs:0,circles:0,circ_arcs:0,viewports:0,clips:0,colors:0,db_ids:0,dots:0,fills:0,layers:0,line_caps:0,line_joins:0,line_patterns:0,line_pat_refs:0,plines:0,pline_points:0,line_weights:0,links:0,miters:0,ptris:0,ptri_indices:0,ptri_points:0,rasters:0,texts:0,strings:[]},this.viewports.push(e),this.currentVpId=this.viewports.length-1},f.prototype.createLayerGroups=function(e){var t=this.layersRoot={name:"root",id:"root",childrenByName:{},isLayer:!1},n=0,i=0;for(var r in e){var o=parseInt(r),a=e[r],s="string"==typeof a?a:a.name;s||(s=r);var l=s.split("|"),c=t;if(l.length>1)for(var u=0;u<l.length-1;++u){var h=l[u],d=c.childrenByName[h];d||(d={name:h,id:"group-"+n++,childrenByName:{},isLayer:!1},c.childrenByName[h]=d),c=d}c.childrenByName[s]={name:s,index:o,id:i++,childrenByName:{},isLayer:!0}}!function e(t){var n=Object.keys(t.childrenByName).map((function(e){return t.childrenByName[e]}));if(delete t.childrenByName,n.length){t.children=n,t.childCount=0;for(var i=0;i<n.length;++i)t.childCount+=e(n[i]);n.sort((function(e,t){return e.isLayer&&!t.isLayer?-1:!e.isLayer&&t.isLayer?1:e.name.localeCompare(t.name,void 0,{sensitivity:"base",numeric:!0})}))}return t.isLayer?1:t.childCount}(this.layersRoot)}},4100:e=>{for(var t=new Array(256),n=0;n<256;n++){var i=n.toString(16);1===i.length&&(i="0"+i),t[n]=i}var r=new Array(20);var o=new Array(10);function a(e){for(var n=10===e.length?r:[],i=0;i<e.length;i++){var o=e.charCodeAt(i);n[2*i]=t[255&o],n[2*i+1]=t[o>>8&255]}return n.join("")}function s(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:0}e.exports={getHexStringPacked:function(e,t,n){for(var i=20===n?o:[],r=0;r<n;r+=2){var a=e[t+r],s=e[t+r+1];i[r/2]=s<<8|a}return String.fromCharCode.apply(null,i)},unpackHexString:a,hexToBin:function(e,t,n){for(var i=10===e.length?a(e):e,r=n,o=0;o<i.length;o+=2){var l=s(i.charCodeAt(o)),c=s(i.charCodeAt(o+1));t[r++]=l<<4|c}}}},86620:(e,t,n)=>{"use strict";n.r(t),n.d(t,{serializeLmvBufferGeom:()=>N,readLmvBufferGeom:()=>U});var i=n(84998),r=n(28400),o=n(22585),a=0,s=1,l=2,c=3,u=4,h=5,d=0,p=1,f=2,m=3,g=4,v=5,y=6,b=7,_=8,x=9,E=10,w=1,S=2,A=3,M={position:l,normal:c,index:a,indexlines:s,color:h},T={};T[l]="position",T[c]="normal",T[a]="index",T[s]="indexlines",T[h]="color",T[u]="uv";var C={};function P(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);for(n=0;n<t.length;n++){if((r=t[n])[0]>r[1]){var i=r[0];r[0]=r[1],r[1]=i}}t.sort((function(e,t){return e[0]-t[0]}));var r=t[0],o=0;e[o]=r[0],e[o+1]=r[1]-r[0],o+=2;for(n=1;n<t.length;n++,o+=2)r=t[n],e[o]=r[0]-t[n-1][0],e[o+1]=r[1]-r[0]}function L(e){if(e.length){e[1]+=e[0],e[2]+=e[0];for(var t=3;t<e.length;t+=3)e[t]+=e[t-3],e[t+1]+=e[t],e[t+2]+=e[t]}}function R(e){if(e.length){e[1]+=e[0];for(var t=2;t<e.length;t+=2)e[t]+=e[t-2],e[t+1]+=e[t]}}function D(e){var t=T[e];return t||(console.error("Unknown vertex attribute"),u)}function I(){}function O(e){this.buffer=e,this.readOffset=0,this.meshFlag=0,this.numBuffers=0,this.numAttributes=0,this.bufferOffsets=[],this.attributes=[],this.buffers=[]}function N(e){var t=new I,n=[];if(!e.vb)return console.error("Unexpected non-interleaved vertex buffer"),null;n=[e.vb.byteLength,e.ib.byteLength],e.iblines&&n.push(e.iblines.byteLength);var i,r,o=Object.keys(e.attributes),a=0;e.isLines&&(a|=w),e.isWideLines&&(a|=A),e.isPoints&&(a|=S),t.beginHeader(a,o.length,n);for(var s=0;s<o.length;s++){var l=e.attributes[o[s]],c=(i=o[s],r=void 0,void 0!==(r=M[i])?r:(0===i.indexOf("uv")||console.warn("Unknown attribute name"),u));"index"===o[s]?t.addAttribute(c,l,0,1):"indexlines"===o[s]?t.addAttribute(c,l,0,2):t.addAttribute(c,l,e.vbstride,0)}t.endHeader();var h=Buffer.from(e.vb.buffer,e.vb.byteOffset,e.vb.byteLength);return t.addBuffer(h),e.isLines?P(e.ib):function(e){for(var t,n,i=[],r=0;r<e.length;r+=3)i.push([e[r],e[r+1],e[r+2]]);for(r=0;r<i.length;r++)for(var o=i[r];o[0]>o[1]||o[0]>o[2];)n=void 0,n=(t=o)[0],t[0]=t[1],t[1]=t[2],t[2]=n;i.sort((function(e,t){return e[0]-t[0]})),o=i[0];var a=0;for(e[a]=o[0],e[a+1]=o[1]-o[0],e[a+2]=o[2]-o[0],a+=3,r=1;r<i.length;r++,a+=3)o=i[r],e[a]=o[0]-i[r-1][0],e[a+1]=o[1]-o[0],e[a+2]=o[2]-o[0]}(e.ib),h=Buffer.from(e.ib.buffer,e.ib.byteOffset,e.ib.byteLength),t.addBuffer(h),e.iblines&&(P(e.iblines),h=Buffer.from(e.iblines.buffer,e.iblines.byteOffset,e.iblines.byteLength),t.addBuffer(h)),t.end()}C[d]=1,C[p]=2,C[f]=1,C[m]=2,C[g]=1,C[v]=2,C[y]=1,C[b]=2,C[_]=4,C[x]=4,C[E]=4,I.prototype.beginHeader=function(e,t,n){var i=8,r=n.length;for(i+=4*(r-1),i+=5*t;i%4!=0;)i++;for(var o=0,a=0;a<n.length;a++)o+=n[a];this.buffer=Buffer.alloc(i+o),this.writeOffset=0;for(a=0;a<4;a++)this.writeOffset=this.buffer.writeUInt8("OTG0".charCodeAt(a),this.writeOffset);this.writeOffset=this.buffer.writeUInt16LE(e,this.writeOffset),this.writeOffset=this.buffer.writeUInt8(r,this.writeOffset),this.writeOffset=this.buffer.writeUInt8(t,this.writeOffset);var s=n[0];for(a=1;a<n.length;a++)this.writeOffset=this.buffer.writeUInt32LE(s,this.writeOffset),s+=n[a]},I.prototype.addAttribute=function(e,t,n,i){this.writeOffset=this.buffer.writeUInt8(e,this.writeOffset),e===a||e===s?(this.writeOffset=this.buffer.writeUInt8(function(e){var t=m,n=e.bytesPerItem||2;return 1===n?t=f:2===n?t=m:4===n&&(t=E),t<<4|15&e.itemSize}(t),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(4*(t.itemOffset||0),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(4*(n||0),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(i,this.writeOffset)):(this.writeOffset=this.buffer.writeUInt8(function(e){var t=_,n=e.bytesPerItem||4;return 1===n?t=e.normalized?y:f:2===n&&(t=e.normalized?b:m),t<<4|15&e.itemSize}(t),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(4*(t.itemOffset||0),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(4*(n||0),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(i,this.writeOffset))},I.prototype.endHeader=function(){for(;this.writeOffset%4!=0;)this.writeOffset=this.buffer.writeUInt8(0,this.writeOffset)},I.prototype.addBuffer=function(e){e.copy(this.buffer,this.writeOffset),this.writeOffset+=e.length},I.prototype.end=function(){return this.writeOffset!==this.buffer.length&&console.error("Incorrect encoding buffer size"),this.buffer},O.prototype.readNodeJS=function(){if("OTG0"!==this.buffer.toString("ascii",0,4))return console.error("Invalid OTG header"),!1;if(this.readOffset=4,this.meshFlag=this.buffer.readUInt16LE(this.readOffset),this.readOffset+=2,this.numBuffers=this.buffer.readUInt8(this.readOffset),this.readOffset++,this.numAttributes=this.buffer.readUInt8(this.readOffset),this.readOffset++,this.numBuffers){this.bufferOffsets.push(0);for(var e=1;e<this.numBuffers;e++){var t=this.buffer.readUInt32LE(this.readOffset);this.readOffset+=4,this.bufferOffsets.push(t)}}for(e=0;e<this.numAttributes;e++){var n={};n.name=this.buffer.readUInt8(this.readOffset),this.readOffset++;var i=this.buffer.readUInt8(this.readOffset);this.readOffset++,n.itemSize=15&i,n.type=i>>4,n.bytesPerItem=C[n.type],n.normalized=n.type===g||n.type===v||n.type===y||n.type===b,n.itemOffset=this.buffer.readUInt8(this.readOffset)/4,this.readOffset++,n.itemStride=this.buffer.readUInt8(this.readOffset)/4,this.readOffset++,n.bufferIndex=this.buffer.readUInt8(this.readOffset),this.readOffset++,this.attributes.push(n)}for(;this.readOffset%4!=0;)this.readOffset++;for(e=0;e<this.bufferOffsets.length;e++){var r,o=this.readOffset+this.bufferOffsets[e];r=e<this.bufferOffsets.length-1?this.readOffset+this.bufferOffsets[e+1]:this.buffer.length,this.buffers.push(this.buffer.slice(o,r))}return!0},O.prototype.readWeb=function(){var e=new r.A(this.buffer);if("OTG0"!==e.getString(4))return console.error("Invalid OTG header"),!1;if(this.meshFlag=e.getUint16(),this.numBuffers=e.getUint8(),this.numAttributes=e.getUint8(),this.numBuffers){this.bufferOffsets.push(0);for(var t=1;t<this.numBuffers;t++){var n=e.getUint32();this.bufferOffsets.push(n)}}for(t=0;t<this.numAttributes;t++){var i={};i.name=e.getUint8();var o=e.getUint8();i.itemSize=15&o,i.type=o>>4,i.bytesPerItem=C[i.type],i.normalized=i.type===g||i.type===v||i.type===y||i.type===b,i.itemOffset=e.getUint8()/4,i.itemStride=e.getUint8()/4,i.bufferIndex=e.getUint8(),this.attributes.push(i)}for(;e.offset%4!=0;)e.offset++;for(t=0;t<this.bufferOffsets.length;t++){var a,s=e.offset+this.bufferOffsets[t];a=t<this.bufferOffsets.length-1?e.offset+this.bufferOffsets[t+1]:e.byteLength,this.buffers.push(this.buffer.subarray(s,a))}return!0},O.prototype.read=function(){return(0,i.isNodeJS)()&&this.buffer instanceof Buffer?this.readNodeJS():this.readWeb()};var k=new o.LmvBox3;k.min.x=-.5,k.min.y=-.5,k.min.z=-.5,k.max.x=.5,k.max.y=.5,k.max.z=.5;var F={center:{x:0,y:0,z:0},radius:Math.sqrt(.75)};function U(e,t){var n=new O(e);if(!n.read())return console.error("Failed to parse OTG geometry"),null;for(var i={vblayout:{},vb:new Float32Array(n.buffers[0].buffer,n.buffers[0].byteOffset,n.buffers[0].byteLength/4),isLines:(3&n.meshFlag)===w,isWideLines:(3&n.meshFlag)===A,isPoints:(3&n.meshFlag)===S,boundingBox:k,boundingSphere:F},r=0;r<n.attributes.length;r++){var o=n.attributes[r];if(o.name===a){var l=n.buffers[1];1===o.bytesPerItem?i.indices=l:2===o.bytesPerItem?i.indices=new Uint16Array(l.buffer,l.byteOffset,l.byteLength/o.bytesPerItem):4===o.bytesPerItem&&(i.indices=new Uint32Array(l.buffer,l.byteOffset,l.byteLength/o.bytesPerItem)),i.isLines?R(i.indices):L(i.indices)}else if(o.name===s){if(!t){var c=n.buffers[2];1===o.bytesPerItem?i.iblines=c:2===o.bytesPerItem?i.iblines=new Uint16Array(c.buffer,c.byteOffset,c.byteLength/o.bytesPerItem):4===o.bytesPerItem&&(i.iblines=new Uint32Array(c.buffer,c.byteOffset,c.byteLength/o.bytesPerItem)),R(i.iblines)}}else{var u=D(o.name);i.vbstride?i.vbstride!==o.itemStride&&console.error("Unexpected vertex buffer stride mismatch."):i.vbstride=o.itemStride,o.itemOffset>=o.itemStride||(i.vblayout[u]={bytesPerItem:o.bytesPerItem,offset:o.itemOffset,normalized:o.normalized,itemSize:o.itemSize})}}return{mesh:i,packId:0,meshIndex:0}}},439:(e,t,n)=>{"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.r(t),n.d(t,{Empty2DModelLoader:()=>r});var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewer3DImpl=t}var t,n,r;return t=e,n=[{key:"loadFile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=t.width||100,o=t.height||100;i&&i(),this.svf={is2d:!0,viewports:[],layersMap:{0:0},layerCount:1,bbox:new THREE.Box3(new THREE.Vector3(0,0,0),new THREE.Vector3(r,o,0)),fragments:{length:1,fragId2dbId:[0],dbId2fragId:{},transforms:new Float32Array(12),boxes:[0,0,0,r,o,0]},loadOptions:{bubbleNode:new Autodesk.Viewing.BubbleNode({urn:"Dummy_urn",guid:"Dummy_guid"})},metadata:{page_dimensions:{page_width:r,page_height:o,logical_width:r,logical_height:o,logical_offset_x:0,logical_offset_y:0,page_units:"inch"}},strings:[],stringDbIds:[],loadDone:!0};var a=new Autodesk.Viewing.Model(this.svf);a.initialize(),a.loader=this,this.model=a,n(null,a),this.viewer3DImpl.api.dispatchEvent({type:Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT,svf:this.svf,model:a}),this.viewer3DImpl.onLoadComplete(a)}},{key:"dtor",value:function(){}},{key:"is2d",value:function(){return!0}},{key:"is3d",value:function(){return!1}}],n&&i(t.prototype,n),r&&i(t,r),e}()},7440:(e,t,n)=>{"use strict";n.r(t),n.d(t,{OUTPUT_TYPE:()=>y,F2DLoader:()=>b});var i=n(98926),r=n(25131),o=n(79659),a=n(18588),s=n(50411),l=n(57601),c=n(58092),u=n(8283),h=n(84998),d=n(37169),p=n(50005),f=n(58964),m=n(83161),g=n(16453),v=Autodesk.Viewing.Private,y={GEOMETRY:"geometry",VERTEX_BUFFER:"vertexBuffer"};function b(e){this.viewer3DImpl=e,this.loading=!1,this.tmpMatrix=new g.Matrix4,this.logger=i.logger,this.loadTime=0}b.prototype.dtor=function(){this.initWorkerScriptToken&&(this.initWorkerScriptToken.cancel(),this.initWorkerScriptToken=null,i.logger.debug("F2D loader dtor: on init worker script.")),this.streamingWorker&&(this.streamingWorker.terminate(),this.streamingWorker=null,i.logger.debug("F2D loader dtor: on streaming worker.")),this.parsingWorker&&(this.parsingWorker.terminate(),this.parsingWorker=null,i.logger.debug("F2D loader dtor: on parsing worker.")),this.svf&&this.svf.propDbLoader&&(this.svf.propDbLoader.dtor(),this.svf.propDbLoader=null),this.viewer3DImpl=null,this.loading=!1,this.tmpMatrix=null,this.logger=null,this.loadTime=0,this.svf=null,this.model=null,this.options=null},b.prototype.isValid=function(){return!!this.viewer3DImpl},b.prototype.loadFile=function(e,t,n,r){if(!this.viewer3DImpl)return i.logger.log("F2D loader was already destructed. So no longer usable."),!1;if(this.loading)return i.logger.log("Loading of F2D already in progress. Ignoring new request."),!1;this.loading=!0;var o=e.indexOf("urn:");if(-1!=o){var a=(e=decodeURIComponent(e)).substr(o,e.substr(o).indexOf("/"));i.logger.log("Extracted URN: "+a);var s=a.lastIndexOf(":");this.svfUrn=a.substr(s+1)}else this.svfUrn=e;this.sharedDbPath=t.sharedPropertyDbPath,this.currentLoadPath=e,this.acmSessionId=t.acmSessionId,this.queryParams="",this.acmSessionId&&(this.queryParams="acmsession="+this.acmSessionId),this.options=t,this.options.placementTransform?this.modelScale=this.options.modelScale||this.options.placementTransform.getMaxScaleOnAxis():this.modelScale=this.options.modelScale||1,this.isf2d=!0;var l=this;return this.initWorkerScriptToken=(0,c.initWorkerScript)((function(){l.loadFydoCB(e,t,n,r)})),!0},b.prototype.loadFydoCB=function(e,t,n,r){this.t0=Date.now();var s=(0,l.pathToURL)(e);this.streamingWorker=(0,c.createWorker)(!0),this.parsingWorker=(0,c.createWorker)();var u,p,m=this,v=!0,b=this.viewer3DImpl.glrenderer();b&&(u=b.supportsInstancedArrays(),p=b.isWebGL2());var _=function(){m.parsingWorker.terminate(),m.parsingWorker=null};this.streamingWorker.addEventListener("message",(function(e){var l;m.isValid()&&(v&&r&&(v=!1,r()),e.data&&"F2DBLOB"==e.data.type?(l={operation:"PARSE_F2D",data:e.data.buffer,metadata:e.data.metadata,manifest:e.data.manifest,basePath:e.data.basePath,f2dLoadOptions:{modelSpace:t.modelSpace,bgColor:t.bgColor,noShadow:t.noShadow,isMobile:(0,h.isMobileDevice)(),supportsInstancing:u,isWebGL2:p,excludeTextGeometry:t.excludeTextGeometry,outputType:t.outputType||y.VERTEX_BUFFER,extendStringsFetching:t.extendStringsFetching},url:s},m.parsingWorker.doOperation(l,[l.data]),m.streamingWorker.terminate(),m.streamingWorker=null):e.data&&"F2DSTREAM"==e.data.type?(l={operation:"PARSE_F2D_FRAME",data:e.data.frames,url:s,f2dLoadOptions:{modelSpace:t.modelSpace,bgColor:t.bgColor,noShadow:t.noShadow,isMobile:(0,h.isMobileDevice)(),supportsInstancing:u,isWebGL2:p,excludeTextGeometry:t.excludeTextGeometry,outputType:t.outputType||y.VERTEX_BUFFER,extendStringsFetching:t.extendStringsFetching}},e.data.metadata&&(l.metadata=e.data.metadata,l.manifest=e.data.manifest),e.data.finalFrame&&(l.finalFrame=!0,m.streamingWorker.terminate(),m.streamingWorker=null,m.fileMemorySize/=2),e.data.progress&&m.viewer3DImpl.signalProgress(100*e.data.progress,a.ProgressState.LOADING),m.parsingWorker.doOperation(l,l.data?[l.data]:void 0)):e.data&&"F2DAssetURL"==e.data.type||e.data&&e.data.assetRequest||e.data&&e.data.progress||(e.data&&e.data.debug?i.logger.debug(e.data.message):e.data&&e.data.error?(m.loading=!1,m.streamingWorker.terminate(),m.streamingWorker=null,n&&n(e.data.error)):(i.logger.error("F2D download failed.",(0,o.errorCodeString)(o.ErrorCodes.NETWORK_FAILURE)),m.loading=!1,m.streamingWorker.terminate(),m.streamingWorker=null)))}),!1);var x=t.outputType===y.GEOMETRY?function(e){if(m.isValid()&&(v&&r&&(v=!1,r()),e.data&&e.data.f2d)){m.svf=e.data.f2d;var t=e.data.f2d.geometry;_(),i.logger.info("Num polylines: "+t.numPolylines),i.logger.info("Line segments: "+t.numLineSegs),i.logger.info("Circular arcs: "+t.numCircles),i.logger.info("Ellipitcal arcs:"+t.numEllipses),m.onModelRootLoadDone(m.svf),n&&n(null,m.model),m.viewer3DImpl.api.dispatchEvent({type:d.MODEL_ROOT_LOADED_EVENT,svf:m.svf,model:m.model}),m.onGeomLoadDone()}}:function(e){var t,a;if(m.isValid())if(v&&r&&(v=!1,r()),e.data&&e.data.f2d){for(t=m.svf=e.data.f2d,_(),i.logger.info("Num polylines: "+t.numPolylines),i.logger.info("Line segments: "+t.numLineSegs),i.logger.info("Circular arcs: "+t.numCircles),i.logger.info("Ellipitcal arcs:"+t.numEllipses),i.logger.info("Plain triangles:"+t.numTriangles),i.logger.info("Total # of op codes generated by fydo.parse: "+t.opCount),m.onModelRootLoadDone(m.svf),n&&n(null,m.model),m.viewer3DImpl.api.dispatchEvent({type:d.MODEL_ROOT_LOADED_EVENT,svf:m.svf,model:m.model}),a=0;a<t.meshes.length;a++)m.processReceivedMesh2D(t.meshes[a],a);t.meshes=null,m.onGeomLoadDone(),m.loading=!1}else if(e.data&&e.data.f2dframe){var s=0;if(e.data.meshes){var l=e.data.bbox;m.svf.bbox=(new g.Box3).copy(l),m.svf.modelSpaceBBox=m.svf.bbox.clone(),m.svf.placementTransform&&m.svf.bbox.applyMatrix4(m.svf.placementTransform),s=e.data.baseIndex}else m.svf=e.data.f2dframe,s=e.data.baseIndex;if((t=m.svf).fragments&&t.fragments.initialized||(m.onModelRootLoadDone(t),n&&n(null,m.model),m.viewer3DImpl.api.dispatchEvent({type:d.MODEL_ROOT_LOADED_EVENT,svf:t,model:m.model})),e.data.meshes&&e.data.meshes.length)for(a=0;a<e.data.meshes.length;a++)m.processReceivedMesh2D(e.data.meshes[a],s+a);if(e.data.finalFrame){var c=e.data.cumulativeProps;for(var u in c)t[u]=c[u];_(),m.onGeomLoadDone(),m.loading=!1}}else e.data&&e.data.progress||(e.data&&e.data.debug?i.logger.debug(e.data.message):e.data&&e.data.error?(m.loading=!1,_(),i.logger.error("Error while processing F2d: "+JSON.stringify(e.data.error.args)),n&&n(e.data.error)):(i.logger.error("F2D download failed.",(0,o.errorCodeString)(o.ErrorCodes.NETWORK_FAILURE)),m.loading=!1,_()))};this.parsingWorker.addEventListener("message",x,!1);var E={operation:"STREAM_F2D",url:s,objectIds:t.ids,queryParams:this.queryParams};return this.streamingWorker.doOperation(f.endpoint.initLoadContext(E)),!0},b.prototype.processReceivedMesh=function(e){var t=e.packId+":"+e.meshIndex,n=this.svf,o=n.fragments,a=o.mesh2frag[t];if(void 0!==a){Array.isArray(a)||(a=[a]);var s=e.mesh;if(s.dbIds[-1]&&this.options.hideBackground&&this.model.changePaperVisibility(!1),r.BufferGeometryUtils.meshToGeometry(e),e.geometry.unpackXform=s.unpackXform,s.texData){var l=new g.DataTexture(new Uint8Array(s.texData.buffer),s.texData.length,1,g.RGBAFormat,g.UnsignedByteType,g.UVMapping,g.ClampToEdgeWrapping,g.ClampToEdgeWrapping,g.NearestFilter,g.NearestFilter,0);l.generateMipmaps=!1,l.flipY=!1,l.needsUpdate=!0,e.geometry.tIdColor=l,e.geometry.vIdColorTexSize=new g.Vector2(s.texData.length,1)}var c=a.length,u=this.model;u.getGeometryList().addGeometry(e.geometry,c,e.meshIndex+1);for(var h=(e.geometry.index.array||e.geometry.ib).length/3,d=0;d<a.length;d++){var p=0|a[d];u.getFragmentList().getOriginalWorldMatrix(p,this.tmpMatrix),this.options.placementTransform&&(this.tmpMatrix=(new g.Matrix4).multiplyMatrices(this.options.placementTransform,this.tmpMatrix));var f=o.materials[p].toString();o.polygonCounts&&(o.polygonCounts[p]=h);var m=this.viewer3DImpl.setupMesh(this.model,e.geometry,f,this.tmpMatrix);u.activateFragment(p,m)}o.mesh2frag[t]=null,o.numLoaded+=a.length;var v=o.numLoaded;n.geomPolyCount>n.nextRepaintPolys&&(n.numRepaints++,n.nextRepaintPolys+=1e4*Math.pow(1.5,n.numRepaints),this.viewer3DImpl.invalidate(!1,!0)),v%20==0&&this.viewer3DImpl.invalidate(!1,!0)}else i.logger.warn("Mesh "+t+" was not referenced by any fragments.")},b.prototype.processReceivedMesh2D=function(e,t){t>=this.bufferCount&&(this.bufferCount=t+1);var n={mesh:e,is2d:!0,packId:"0",meshIndex:t},i="0:"+t,r=this.svf.fragments;if(!r.fragId2dbId[t]){var o=Object.keys(n.mesh.dbIds).map((function(e){return parseInt(e)}));r.fragId2dbId[t]=o;for(var a=0;a<o.length;a++){var s=o[a],l=r.dbId2fragId[s];Array.isArray(l)?l.push(t):r.dbId2fragId[s]=void 0!==l?[l,t]:t}var c=this.model.getFragmentList();if(e.material.modelScale=this.modelScale,e.material.opacity=this.options.opacity,e.material.doNotCut=this.options.doNotCut||(null==c?void 0:c.getDoNotCut()),null==c?void 0:c.viewBounds){var u=c.viewBounds;e.material.viewportBounds=new g.Vector4(u.min.x,u.min.y,u.max.x,u.max.y)}var d=this.viewer3DImpl;r.materials[t]=this.viewer3DImpl.matman().create2DMaterial(this.model,e.material,!1,!1,(function(e,t){var n=t.getData();p.TextureLoader.requestsInProgress()||!n.loadDone||n.texLoadDone||(n.texLoadDone=!0,d.onTextureLoadComplete(t)),(0,h.isMobileDevice)()&&p.TextureLoader.requestsInProgress()||d.invalidate(!1,!0,!1)})),r.length++}r.mesh2frag[i]=t,this.processReceivedMesh(n)},b.prototype.onModelRootLoadDone=function(e){var t,n;e.fragments={},e.fragments.mesh2frag={},e.fragments.materials=[],e.fragments.fragId2dbId=[],e.fragments.dbId2fragId={},e.fragments.length=0,e.fragments.initialized=!0,e.geomMemory=0,e.fragments.numLoaded=0,e.gpuNumMeshes=0,e.gpuMeshMemory=0,e.nextRepaintPolys=1e4,e.numRepaints=0,e.urn=this.svfUrn,e.acmSessionId=this.acmSessionId,e.basePath="";var r=this.currentLoadPath.lastIndexOf("/");-1!==r&&(e.basePath=this.currentLoadPath.substr(0,r+1)),e.placementTransform=null===(t=this.options.placementTransform)||void 0===t?void 0:t.clone(),e.placementWithOffset=null===(n=this.options.placementTransform)||void 0===n?void 0:n.clone(),e.loadOptions=this.options,e.texLoadDone=!1;var o=Date.now();this.loadTime+=o-this.t0,i.logger.log("SVF load: "+(o-this.t0)),this.t0=o,e.bbox=(new g.Box3).copy(e.bbox),e.modelSpaceBBox=e.bbox.clone(),e.placementTransform&&e.bbox.applyMatrix4(e.placementTransform);var s=this.model=new m.Model(e);s.loader=this,s.initialize(),this.options.skipPropertyDb||(this.svf.propDbLoader=new u.PropDbLoader(this.sharedDbPath,this.model,this.viewer3DImpl.api)),i.logger.log("scene bounds: "+JSON.stringify(e.bbox));var l={category:"metadata_load_stats",urn:e.urn,layers:e.layerCount};i.logger.track(l),this.viewer3DImpl.setDoNotCut(s,!!this.options.doNotCut),this.viewer3DImpl.signalProgress(5,a.ProgressState.ROOT_LOADED,this.model),this.viewer3DImpl.invalidate(!1,!1)},b.prototype.onGeomLoadDone=function(){this.svf.loadDone=!0,this.svf.fragments.entityIndexes=null,this.svf.fragments.mesh2frag=null;var e=Date.now(),t="Fragments load time: "+(e-this.t0);this.loadTime+=e-this.t0,p.TextureLoader.loadModelTextures(this.model,this.viewer3DImpl),this.options.skipPropertyDb||this.loadPropertyDb(),i.logger.log(t);var n={category:"model_load_stats",is_f2d:!0,has_prism:this.viewer3DImpl.matman().hasPrism,load_time:this.loadTime,geometry_size:this.model.getGeometryList().geomMemory,meshes_count:this.model.getGeometryList().geoms.length,urn:this.svfUrn};i.logger.track(n,!0);var r=this.model.getGeometryList(),o={load_time:this.loadTime,polygons:r.geomPolyCount,fragments:this.model.getFragmentList().getCount(),mem_usage:r.gpuMeshMemory,viewable_type:"2d"};v.analytics.track("viewer.model.loaded",o),this.currentLoadPath=null,this.isf2d=void 0,this.viewer3DImpl.onLoadComplete(this.model)},b.prototype.loadPropertyDb=function(){this.svf.propDbLoader&&this.svf.propDbLoader.load()},b.prototype.is3d=function(){return!1},s.FileLoaderManager.registerFileLoader("f2d",["f2d"],b)},36257:(e,t,n)=>{"use strict";n.r(t),n.d(t,{LeafletLoader:()=>m});var i=n(18588),r=n(79659),o=n(98926),a=n(57601),s=n(35313),l=n(50005),c=n(50411),u=n(83161),h=n(58964),d=n(37169),p=n(16453),f=Autodesk.Viewing.Private;function m(e){var t=e;this.isLeafletLoader=!0,this.loading=!1;var n=function(e,t){var n=[80,75,1,2],i=t;if(e[i++]!==n[0]||e[i++]!==n[1]||e[i++]!==n[2]||e[i++]!==n[3])return o.logger.error("invalid file header signature"),null;var r={};return r.version=e[i++],r.os=e[i++],r.needVersion=e[i++]|e[i++]<<8,r.flags=e[i++]|e[i++]<<8,r.compression=e[i++]|e[i++]<<8,r.time=e[i++]|e[i++]<<8,r.date=e[i++]|e[i++]<<8,r.crc32=(e[i++]|e[i++]<<8|e[i++]<<16|e[i++]<<24)>>>0,r.compressedSize=(e[i++]|e[i++]<<8|e[i++]<<16|e[i++]<<24)>>>0,r.plainSize=(e[i++]|e[i++]<<8|e[i++]<<16|e[i++]<<24)>>>0,r.fileNameLength=e[i++]|e[i++]<<8,r.extraFieldLength=e[i++]|e[i++]<<8,r.fileCommentLength=e[i++]|e[i++]<<8,r.diskNumberStart=e[i++]|e[i++]<<8,r.internalFileAttributes=e[i++]|e[i++]<<8,r.externalFileAttributes=e[i++]|e[i++]<<8|e[i++]<<16|e[i++]<<24,r.relativeOffset=(e[i++]|e[i++]<<8|e[i++]<<16|e[i++]<<24)>>>0,r.filename=String.fromCharCode.apply(null,e.slice(i,i+=r.fileNameLength)),r.extraField=e.slice(i,i+=r.extraFieldLength),r.comment=e.slice(i,i+r.fileCommentLength),r.length=i-t,r},c=function(e){var t=function(e){var t=[80,75,3,4],n=0;if(e[n++]!==t[0]||e[n++]!==t[1]||e[n++]!==t[2]||e[n++]!==t[3])return o.logger.error("invalid local file header signature"),null;var i={};return i.needVersion=e[n++]|e[n++]<<8,i.flags=e[n++]|e[n++]<<8,i.compression=e[n++]|e[n++]<<8,i.time=e[n++]|e[n++]<<8,i.date=e[n++]|e[n++]<<8,i.crc32=(e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24)>>>0,i.compressedSize=(e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24)>>>0,i.plainSize=(e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24)>>>0,i.fileNameLength=e[n++]|e[n++]<<8,i.extraFieldLength=e[n++]|e[n++]<<8,i.filename=String.fromCharCode.apply(null,e.slice(n,n+=i.fileNameLength)),i.extraField=e.slice(n,n+=i.extraFieldLength),i.length=n,i}(e);if(!t)return null;var n=t.length,i=t.compressedSize;return e.slice(n,n+i)};this.continueLoadFile=function(e,n,a,l,c,h){var m,g=this;n.loadOptions&&n.loadOptions.loadFromZip?m="{z}/{x}_{y}."+n.loadOptions.mime.split("/")[1]:m=e;c.initFromLoadOptions(m,n.loadOptions,h);var v=null;l&&l(),!c.valid()&&c.initForSimpleImage(e),c.onRootLoaded=function(){if(g.loading){var s=new function(r){var o;this.bbox=new p.Box3,this.basePath=e,this.is2d=!0,this.urn=null===(o=n.bubbleNode)||void 0===o?void 0:o.getRootNode().urn();var a=r&&r.paperWidth>=0?r.paperWidth:c.texWidth,s=r&&r.paperHeight>=0?r.paperHeight:c.texHeight;this.pageToModelTransform=c.getPageToModelTransform(a,s),this.metadata={},this.metadata.page_dimensions={};var l=this.metadata.page_dimensions;l.page_width=a,l.page_height=s,l.page_units=r&&r.paperUnits,this.loadDone=!0,this.isLeaflet=!0,t.signalProgress(100,i.ProgressState.LOADING),c.texWidth>0&&(this.maxPixelPerUnit=c.texWidth/c.getQuadWidth(),c.isSimpleImage&&(this.maxPixelPerUnit*=10))}(n.loadOptions);s.loadOptions=n,s.bbox.copy(c.getBBox()),s.modelSpaceBBox=s.bbox.clone(),n.placementTransform&&(s.placementTransform=n.placementTransform.clone(),s.placementWithOffset=n.placementTransform.clone(),s.bbox.applyMatrix4(n.placementTransform));var l=new u.Model(s);return l.initFromCustomIterator(v),l.loader=g,t.api.dispatchEvent({type:d.MODEL_ROOT_LOADED_EVENT,svf:s,model:l}),v.callWhenRefined((function(){var e,t,n=Date.now();s.loadTime=n-g.t0,o.logger.log("SVF load: "+s.loadTime),f.analytics.track("viewer.model.loaded",{load_time:s.loadTime,total_raster_pixels:null===(e=s.loadOptions.bubbleNode)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.totalRasterPixels,viewable_type:"2d"})})),a(null,l),g.loading=!1,l.id}a({code:r.ErrorCodes.LOAD_CANCELED,msg:"Load canceled"},null)},c.onDone=a,c.getPixelRatio=t.glrenderer().getPixelRatio,c.maxAnisotropy=t.glrenderer().getMaxAnisotropy(),c.placementTransform=n.placementTransform,(v=new s.ModelIteratorTexQuad(c,t.getMaterials())).requestRootTile()},this.loadFile=function(e,t,i,u){if(this.loading)return o.logger.log("Loading of Leaflet already in progress. Ignoring new request."),!1;var d=this;this.options=t,this.t0=Date.now();var f=new s.TexQuadConfig,m=null,g=t.acmSessionId;if(t.loadOptions&&t.loadOptions.loadFromZip){m=function(e,t,n){for(var i,r=e.split("/")[0]-f.levelOffset,o=0;o<f.zips.length;o++)if(r<=f.zips[o].zipMaxLevel){i=f.zips[o];break}if(!i)return n("Failed loading texture - tile's level doesn't exists."),!1;var a=i.fileTable[e];if(!a)return n("Failed loading texture - entry does not exist inside fileTable."),!1;var s={extractImage:c},u=a.relativeOffset,h=a.relativeOffset+a.contentSize;i.rawData?s.rawData=i.rawData.slice(u,h):s.range={min:u,max:h},l.TextureLoader.loadTextureWithSecurity(i.urnZip,p.UVMapping,t,n,g,!0,s)};t.loadOptions.zips.forEach((function(s){var l=s.centralDirOffset,c=s.centralDirLength,p=s.centralDirEntries;!function(e,t,n,i,r,o){var s=null,l={};(0,h.isOffline)()||(t&&(s="acmsession="+t),l.range={min:n,max:i+n});var c=(0,h.initLoadContext)({queryParams:s});a.ViewingService.getItem(c,e,r,o,l)}(s.urnZip,g,l,c,(function(r){(0,h.isOffline)()&&(s.rawData=r,r=r.slice(l,l+c));var o=function(e,t,i){for(var r,o=0,a={},s=null,l=0;l<i;++l){if(!(r=n(e,o)))return null;s&&(s.contentSize=r.relativeOffset-s.relativeOffset),o+=r.length,a[r.filename]=r,s=r}return s.contentSize=t-s.relativeOffset,a}(r,l,p);if(!o)return i("Failed parsing central directory of the zip.",null),!1;s.fileTable=o,t.loadOptions.zips.every((function(e){return Object.keys(e.fileTable).length>0}))&&d.continueLoadFile(e,t,i,u,f,m)}),(function(e){o.logger.error("Zip download failed: "+e.statusText,(0,r.errorCodeString)(r.ErrorCodes.NETWORK_FAILURE)),i("Zip download failed: "+e.statusText,null)}))}))}else m=function(e,t,n){l.TextureLoader.loadTextureWithSecurity(e,p.UVMapping,t,n,g,!0)},this.continueLoadFile(e,t,i,u,f,m);return this.loading=!0,!0},this.dtor=function(){this.loading=!1}}m.prototype.is3d=function(){return!1},m.prototype.isPageCoordinates=function(){var e,t;return!!(null===(e=this.options)||void 0===e||null===(t=e.loadOptions)||void 0===t?void 0:t.fitPaperSize)},c.FileLoaderManager.registerFileLoader("Leaflet",["jpeg","jpg","png"],m)},16727:(e,t,n)=>{"use strict";n.r(t),n.d(t,{OtgLoader:()=>N});var i=n(43586),r=n(22585),o=n(73075),a=n(98926),s=n(50005),l=n(26245),c=n(46759),u=n(8283),h=n(58092),d=n(58964),p=n(57601);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function m(e){switch(e){default:return 1;case"feet and inches":case"foot":case"feet":case"ft":return.3048;case"inch":case"inches":case"in":return.0254;case"centimeter":case"centimeters":case"cm":return.01;case"millimeter":case"millimeters":case"mm":return.001}}function g(e,t){if(e.metadata){var n=e.metadata["world bounding box"],a=new o.LmvVector3(n.minXYZ[0],n.minXYZ[1],n.minXYZ[2]),s=new o.LmvVector3(n.maxXYZ[0],n.maxXYZ[1],n.maxXYZ[2]);e.bbox=new r.LmvBox3(a,s),e.modelSpaceBBox=e.bbox.clone();var l=function(e,t){if(e.placementTransform=t.placementTransform,t.applyScaling){var n="m";e.metadata["distance unit"]&&(n=e.metadata["distance unit"].value),e.scalingUnit=n,"object"===f(t.applyScaling)?(t.applyScaling.from&&(n=t.applyScaling.from),t.applyScaling.to&&(e.scalingUnit=t.applyScaling.to)):e.scalingUnit=t.applyScaling;var r=m(n)/m(e.scalingUnit);if(1!=r){var o=new i.LmvMatrix4(!0),a=new i.LmvMatrix4(!0);a.elements[0]=r,a.elements[5]=r,a.elements[10]=r,t.placementTransform&&o.copy(t.placementTransform),t.applyPlacementInModelUnits?t.placementTransform=a.multiply(o):t.placementTransform=o.multiply(a),e.placementTransform=t.placementTransform,e.scalingFactor=r}}var s=e.metadata["custom values"];if(s&&s.refPointTransform){e.refPointTransform=new i.LmvMatrix4(!0);var l=e.refPointTransform.elements,c=s.refPointTransform;l[0]=c[0],l[1]=c[1],l[2]=c[2],l[4]=c[3],l[5]=c[4],l[6]=c[5],l[8]=c[6],l[9]=c[7],l[10]=c[8],l[12]=c[9],l[13]=c[10],l[14]=c[11]}else{var u=e.metadata.georeference,h=u&&u.refPointLMV,d=0;if(s&&s.hasOwnProperty("angleToTrueNorth")&&(d=Math.PI/180*s.angleToTrueNorth),h||d){var p=new i.LmvMatrix4(!0),g=p.elements;g[0]=g[5]=Math.cos(d),g[1]=-Math.sin(d),g[4]=Math.sin(d);var v=new i.LmvMatrix4(!0);g=v.elements,h&&(g[12]=-h[0],g[13]=-h[1],g[14]=-h[2]),e.refPointTransform=p.multiply(v)}}if(t.applyRefPoint&&e.refPointTransform){var y=new i.LmvMatrix4(!0);t.placementTransform&&y.copy(t.placementTransform),y.multiply(e.refPointTransform),e.placementTransform=t.placementTransform=y}else!t.applyRefPoint&&t.placementTransform&&(e.placementTransform=new i.LmvMatrix4(!0).copy(t.placementTransform));return e.placementTransform&&function(e){for(var t=e.elements,n=0;n<4;n++)for(var i=0;i<4;i++)if(n===i){if(1!==t[4*n+i])return!1}else if(0!==t[4*n+i])return!1;return!0}(e.placementTransform)&&(e.placementTransform=null),e.placementTransform}(e,t);l&&!e.bbox.isEmpty()&&e.bbox.applyMatrix4(l),t.globalOffset?e.globalOffset=t.globalOffset:e.globalOffset=e.bbox.getCenter(new o.LmvVector3),function(e,t){var n=e.globalOffset;if(n.x||n.y||n.z){if(t){var r=new i.LmvMatrix4(!0);r.copy(t),(t=r).elements[12]-=n.x,t.elements[13]-=n.y,t.elements[14]-=n.z}else(t=new i.LmvMatrix4(!0)).makeTranslation(-n.x,-n.y,-n.z);e.placementWithOffset=t}else e.placementWithOffset=t}(e,l),e.bbox.isEmpty()||(e.bbox.min.sub(e.globalOffset),e.bbox.max.sub(e.globalOffset)),e.metadata.hasOwnProperty("double sided geometry")&&e.metadata["double sided geometry"].value&&(e.doubleSided=!0)}}function v(e,t){e[0]-=t.x,e[1]-=t.y,e[2]-=t.z}function y(e,t){if(t&&(t.transformPoint(e.position),t.transformPoint(e.target),t.transformDirection(e.up),isFinite(e.orthoScale))){var n=t.getMaxScaleOnAxis();e.orthoScale*=n}}var b=n(4100),_=n(59481);function x(e,t){var n,i,r,o,s,l=0;function c(e){var l=new Uint8Array(4);if("string"==typeof e)for(var c=0;c<4;c++)l[c]=e.charCodeAt(c);else for(var u=0;u<4;u++)l[u]=e[u];(n=l[1]<<8|l[0])||(n=t||0),n||a.logger.error("Unknwon byte stride."),n%4&&a.logger.error("Expected byte size to be multiple of 4, but got "+n),i=l[3]<<8|l[2],n/4,r=new Uint8Array(n),o=new Float32Array(r.buffer),s=new Uint32Array(r.buffer)}this.onData=function(t,i,o){void 0===i&&(i=t.length);for(var a="string"==typeof t;;){if(!l&&i>=4)c(t),l++;else if(i<4)return!1;var s=l*n;if(i<s+n)return o;if(a)for(var u=0;u<n;u++)r[u]=255&t.charCodeAt(u+s);else for(var h=0;h<n;h++)r[h]=t[h+s];if(!e(this,l))return!1;l++}},this.onEnd=function(e,t){this.onData(e,t,!0)||(this.rawData=e,this.rawLength=t)},this.flush=function(){this.rawData&&(this.onData(this.rawData,this.rawLength,!0)&&(this.rawData=null))},this.idata=function(){return s},this.fdata=function(){return o},this.bdata=function(){return r},this.version=function(){return i},this.byteStride=function(){return n}}var E="urn:adsk.fluent:",w="$otg_cdn$";function S(){this.materials=null,this.fragments=null,this.geompacks=[],this.propertydb={attrs:[],avs:[],ids:[],values:[],offsets:[],dbid:[]},this.bbox=null,this.animations=null,this.pendingRequests=0,this.globalOffset={x:0,y:0,z:0},this.pendingRequests=0,this.initialLoadProgress=0,this.materialIdToHash=[],this.aborted=!1}S.prototype.getMaterialHash=function(e){var t=this.materialIdToHash[e];if(t)return t;var n=this.materialHashes.byteStride,i=(0,b.getHexStringPacked)(this.materialHashes.hashes,e*n,n);return this.materialIdToHash[e]=i,i},S.prototype.getGeometryHash=function(e){var t=this.geomMetadata.byteStride;return(0,b.getHexStringPacked)(this.geomMetadata.hashes,e*t,t)},S.prototype.initEmptyLists=function(e){var t=this,n=t.fragments={};n.length=t.metadata.stats.num_fragments,n.numLoaded=0,n.boxes=e.fragmentTransformsDouble?new Float64Array(6*n.length):new Float32Array(6*n.length),n.transforms=e.fragmentTransformsDouble?new Float64Array(12*n.length):new Float32Array(12*n.length),n.materials=(0,_.R)(n.length,t.metadata.stats.num_materials),n.geomDataIndexes=(0,_.R)(n.length,t.metadata.stats.num_geoms),n.fragId2dbId=new Int32Array(n.length),n.visibilityFlags=new Uint8Array(n.length),n.mesh2frag={},n.topoIndexes=null,t.geomMetadata={hashes:null,byteStride:0,version:0,numLoaded:0,hashToIndex:{}},t.materialHashes={hashes:null,byteStride:0,version:0,numLoaded:0},t.materials={name:"LMVTK Simple Materials",version:"1.0",scene:{SceneUnit:8215,YIsUp:0},materials:{}}},S.prototype.loadAsyncResource=function(e,t,n,i){var r=this;this.pendingRequests++,t=(0,p.pathToURL)(t,e.basePath),p.ViewingService.getItem(e,t,(function(e){r.pendingRequests--,i(e)}),e.onFailureCallback,{responseType:n||"arraybuffer"})},S.prototype.loadAsyncProgressive=function(e,t,n,i,r){var o=this;t=(0,p.pathToURL)(t,e.basePath),p.ViewingService.getItem(e,t,(function(t,r){n.onEnd(t,r),o.postLoad(e,i,n,t)}),r||e.onFailureCallback,{responseType:"text",onprogress:function(e,t){if(o.aborted)return!0;n.onData(e,t,!1)}})},S.prototype.loadMetadata=function(e,t){var n=this;this.loadAsyncResource(e,t,"json",(function(r){n.metadata=r,n.manifest=n.metadata.manifest,n.numGeoms=n.metadata.stats.num_geoms,n.processMetadata(e),n.initEmptyLists(e);var o=n.metadata.manifest,a=o.shared_assets.pdb;for(var s in a)n.propertydb[s]&&n.propertydb[s].push({path:a[s],isShared:!0});var l=o.assets.pdb;for(var s in l)n.propertydb[s]&&n.propertydb[s].push({path:l[s],isShared:!1});o.assets.animations&&n.loadAsyncResource(e,o.assets.animations,"json",(function(e){n.animations=e,function(e){if(e.animations){var t=e.animations.animations;if(t)for(var n=e.globalOffset,r=(new i.LmvMatrix4).makeTranslation(n.x,n.y,n.z),o=(new i.LmvMatrix4).makeTranslation(-n.x,-n.y,-n.z),a=new i.LmvMatrix4,s=new i.LmvMatrix4,l=0;l<t.length;l++){var c=t[l];if(c.hierarchy)for(var u=0;u<c.hierarchy.length;u++){var h=c.hierarchy[u].keys;if(h)for(var d=0;d<h.length;d++){var p=h[d].pos;if(p){var f=n,m=h[d].rot;m&&(a.makeRotationFromQuaternion({x:m[0],y:m[1],z:m[2],w:m[3]}),s.multiplyMatrices(r,a).multiply(o),f={x:s.elements[12],y:s.elements[13],z:s.elements[14]}),v(p,f)}var g=h[d].target;g&&v(g,n);var y=h[d].points;if(y)for(var b=0;b<y.length;b++)v(y[b],n)}}}}}(n)})),o.assets.topology&&n.loadAsyncResource(e,t,"json",(function(e){n.topology=e})),e.onLoaderEvent("otg_root"),n.postLoad(e,"metadata")}))},S.prototype.loadFragmentList=function(e,t){var n=this,a=new o.LmvVector3,s=new o.LmvVector3,l={x:0,y:0,z:0,w:1},u=new i.LmvMatrix4(!0),h=new r.LmvBox3,d={x:0,y:0,z:0};var p=new x((function(t,i){if(i-=1,!n.metadata)return!1;var r=t.idata(),o=t.fdata(),p=n.fragments,f=p.geomDataIndexes[i]=r[0],m=p.materials[i]=r[1],g=p.fragId2dbId[i]=r[2],v=r[3];if(f>n.geomMetadata.numLoaded||m>n.materialHashes.numLoaded)return!1;var y,b=p.mesh2frag[f];void 0===b?p.mesh2frag[f]=i:Array.isArray(b)?b.push(i):p.mesh2frag[f]=[b,i],y=!n.dbIdFilter||n.dbIdFilter[g]?1&v?c.MeshFlags.MESH_HIDE:0:c.MeshFlags.MESH_NOTLOADED,p.visibilityFlags[i]=y;var _=n.metadata.fragmentTransformsOffset||d;a.set(o[4]+_.x,o[5]+_.y,o[6]+_.z),l.x=o[7],l.y=o[8],l.z=o[9],l.w=o[10],s.set(o[11],o[12],o[13]),u.compose(a,l,s),n.placementWithOffset&&u.multiplyMatrices(n.placementWithOffset,u);var x=u.elements,E=p.transforms,w=12*i;return E[w+0]=x[0],E[w+1]=x[1],E[w+2]=x[2],E[w+3]=x[4],E[w+4]=x[5],E[w+5]=x[6],E[w+6]=x[8],E[w+7]=x[9],E[w+8]=x[10],E[w+9]=x[12],E[w+10]=x[13],E[w+11]=x[14],h.min.x=-.5,h.min.y=-.5,h.min.z=-.5,h.max.x=.5,h.max.y=.5,h.max.z=.5,h.applyMatrix4(u),p.boxesLoaded||((E=p.boxes)[(w=6*i)+0]=h.min.x,E[w+1]=h.min.y,E[w+2]=h.min.z,E[w+3]=h.max.x,E[w+4]=h.max.y,E[w+5]=h.max.z),p.numLoaded=i+1,e.onLoaderEvent("fragment",i),!0}),52);return this.loadAsyncProgressive(e,t,p,"all_fragments"),p},S.prototype.handleHashListRequestFailures=function(e){this.metadata&&(this.geomHashListFailure&&this.metadata.stats.num_geoms>0&&e.onFailureCallback.apply(e,this.geomHashListFailure),this.matHashListFailure&&this.metadata.stats.num_materials>0&&e.onFailureCallback.apply(e,this.matHashListFailure),this.geomHashListFailure=null,this.matHashListFailure=null)},S.prototype.loadGeometryHashList=function(e,t){var n=this;var i=new x((function(e,t){return!!n.metadata&&(n.geomMetadata.hashes||(n.geomMetadata.hashes=new Uint8Array(e.byteStride()*(n.numGeoms+1)),n.geomMetadata.byteStride=e.byteStride(),n.geomMetadata.version=e.version()),n.geomMetadata.hashes.set(e.bdata(),t*e.byteStride()),n.geomMetadata.numLoaded=t,!0)}),20);return this.loadAsyncProgressive(e,t,i,"geometry_ptrs",(function(){n.geomHashListFailure=arguments,n.handleHashListRequestFailures(e),n.postLoad(e,"geometry_ptrs",i)})),i},S.prototype.loadMaterialHashList=function(e,t){var n=this;var i=new x((function(e,t){return!!n.metadata&&(n.materialHashes.hashes||(n.numMaterials=n.metadata.stats.num_materials,n.materialHashes.hashes=new Uint8Array(e.byteStride()*(n.numMaterials+1)),n.materialHashes.byteStride=e.byteStride(),n.materialHashes.version=e.version()),n.materialHashes.hashes.set(e.bdata(),t*e.byteStride()),n.materialHashes.numLoaded=t,!0)}),20);return this.loadAsyncProgressive(e,t,i,"material_ptrs",(function(){n.matHashListFailure=arguments,n.handleHashListRequestFailures(e),n.postLoad(e,"material_ptrs",i)})),i},S.prototype.processMetadata=function(e){var t=this,n=t.metadata;g(t,e);var i=t.placementWithOffset;if(n.cameras){t.cameras=n.cameras;for(var r=0;r<t.cameras.length;r++){var a=t.cameras[r];a.position=new o.LmvVector3(a.position.x,a.position.y,a.position.z),a.target=new o.LmvVector3(a.target.x,a.target.y,a.target.z),a.up=new o.LmvVector3(a.up.x,a.up.y,a.up.z),i&&y(a,i)}}},S.prototype.beginLoad=function(e,t){this.loadMetadata(e,t);var n=e.objectIds;if(n){this.dbIdFilter={};for(var i=0,r=n.length;i<r;i++)this.dbIdFilter[n[i]]=1}this.materialsCtx=this.loadMaterialHashList(e,"materials_ptrs.hl"),this.geometryCtx=this.loadGeometryHashList(e,"geometry_ptrs.hl"),this.fragmentsCtx=this.loadFragmentList(e,"fragments.fl")},S.prototype.makeSharedResourcePath=function(e,t,n){if(10===n.length&&(n=(0,b.unpackHexString)(n)),e){var i=n,r="";(s=this.manifest.shared_assets.global_sharding||0)&&(r="/"+n.slice(0,s),i=n.slice(s));var o=this.manifest.shared_assets[t];if(0===o.indexOf(E)||0===o.indexOf(w))o=o.slice(o.indexOf("/"));else{var a=o.split("/");o="/"+(a[a.length-1]||a[a.length-2])+"/"}return e+r+o+i}var s;i=n,r="";return(s=this.manifest.shared_assets.global_sharding||2)&&(r="/"+n.slice(0,s)+"/",i=n.slice(s)),(0,p.pathToURL)(this.basePath)+this.manifest.shared_assets[t]+r+i},S.prototype.postLoad=function(e,t,n,i){t&&this.initialLoadProgress++,4===this.initialLoadProgress?(this.materialsCtx.flush(),this.geometryCtx.flush(),this.fragmentsCtx.flush(),this.materialsCtx=null,this.geometryCtx=null,this.fragmentsCtx=null,this.fragments.numLoaded<this.metadata.stats.num_fragments&&a.logger.warn("Fragments actually loaded fewer than expected."),e.onLoaderEvent("all_fragments")):"metadata"===t&&(this.materialsCtx.flush(),this.geometryCtx.flush(),this.fragmentsCtx.flush())},S.prototype.abort=function(){this.aborted=!0};var A=n(50411),M=n(83161),T=n(37169),C=n(18588),P=n(84998),L=n(19115),R=n(7913);function D(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}var I=Autodesk.Viewing,O=Autodesk.Viewing.Private;function N(e){this.viewer3DImpl=e,this.loading=!1,this.tmpMatrix=new i.LmvMatrix4,this.tmpBox=new r.LmvBox3,this.logger=a.logger,this.loadTime=0,this.pendingMaterials={},this.pendingMaterialsCount=0,this.pendingMeshes={},this.pendingMeshesCount=0,this.operationsDone=0}function k(e){var t="",n=e.lastIndexOf("/");return-1!=n&&(t=e.substr(0,n+1)),t}function F(e){return e.acmSessionId?"acmsession="+e.acmSessionId:""}function U(e,t,n){var i={basePath:t,objectIds:e.ids,globalOffset:e.globalOffset,fragmentTransformsDouble:e.fragmentTransformsDouble,placementTransform:e.placementTransform,applyRefPoint:e.applyRefPoint,queryParams:n,bvhOptions:e.bvhOptions||{isWeakDevice:(0,P.isMobileDevice)()},applyScaling:e.applyScaling,applyPlacementInModelUnits:e.applyPlacementInModelUnits,loadInstanceTree:e.loadInstanceTree};return(0,d.initLoadContext)(i)}function B(e){return Math.floor(100*e.fragsLoaded/e.metadata.stats.num_fragments)}N.prototype.dtor=function(){this.initWorkerScriptToken&&(this.initWorkerScriptToken.cancel(),this.initWorkerScriptToken=null,a.logger.debug("SVF loader dtor: on init worker script.")),this.bvhWorker&&(this.bvhWorker.clearAllEventListenerWithIntercept(),this.bvhWorker.terminate(),this.bvhWorker=null,a.logger.debug("SVF loader dtor: on svf worker.")),this.svf&&(this.svf.loadDone||console.log("stopping load before it was complete"),this.svf.abort(),this.svf.propDbLoader&&(this.svf.propDbLoader.dtor(),this.svf.propDbLoader=null)),this.viewer3DImpl.geomCache()&&this.model&&(this.loading&&this.viewer3DImpl.geomCache().cancelRequests(this.svf.geomMetadata.hashToIndex),this.removeMeshReceiveListener()),this.viewer3DImpl=null,this.model=null,this.svf=null,this.logger=null,this.tmpMatrix=null,this.loading=!1,this.loadTime=0},N.prototype.isValid=function(){return null!=this.viewer3DImpl},N.prototype.removeMeshReceiveListener=function(){this.meshReceiveListener&&(this.viewer3DImpl.geomCache().updateMruTimestamps(),this.viewer3DImpl.geomCache().removeEventListener(L.MESH_RECEIVE_EVENT,this.meshReceiveListener),this.viewer3DImpl.geomCache().removeEventListener(L.MESH_FAILED_EVENT,this.meshReceiveListener),this.viewer3DImpl.geomCache().removeEventListener(L.MATERIAL_RECEIVE_EVENT,this.materialReceiveListener),this.viewer3DImpl.geomCache().removeEventListener(L.MATERIAL_FAILED_EVENT,this.materialReceiveListener),this.meshReceiveListener=null)},N.prototype.loadFile=function(e,t,n,i){if(!this.viewer3DImpl)return a.logger.log("SVF loader was already destructed. So no longer usable."),!1;if(this.loading)return a.logger.log("Loading of SVF already in progress. Ignoring new request."),!1;if(this.loading=!0,t.acmSessionId)this.svfUrn=t.acmSessionId.split(",")[0];else{console.warn("DEPRECATED: Automatic derivation of URN will be removed in a future release. Please set the acmSessionId parameter when loading OTG data.");var r=e.indexOf(E);if(-1===r&&(r=e.indexOf(w)),-1!==r){var o=e.split("/"),s=o[1]+"?version="+o[2],l=I.toUrlSafeBase64(s);this.svfUrn=l}}return this.sharedDbPath=t.sharedPropertyDbPath,this.currentLoadPath=e,this.basePath=k(e),this.acmSessionId=t.acmSessionId,this.options=t,this.queryParams=F(t),this.loadContext=U(t,this.basePath,this.queryParams),this.loadContext.raiseError=function(e,t,i){n&&n({code:e,msg:t,args:i})},this.loadContext.onFailureCallback=p.ViewingService.defaultFailureCallback.bind(this.loadContext),this.loadModelRoot(this.loadContext,n),i&&i(),!0},N.prototype.loadModelRoot=function(e,t){this.t0=(new Date).getTime(),this.firstPixelTimestamp=null;var n=this,i=!1,r={};this.initWorkerScriptToken=(0,h.initWorkerScript)((function(){for(var t in i=!0,r)r.hasOwnProperty(t)&&r[t].forEach((function(n){e.onLoaderEvent(t,n)}));r={}}));var o=this.svf=new S;return o.basePath=e.basePath,e.onLoaderEvent=function(e,s){if(n.svf){if(!i)return r.hasOwnProperty(e)||(r[e]=[]),void r[e].push(s);if("otg_root"===e){n.onModelRootLoadDone(o),t&&t(null,n.model),n.makeBVHInWorker();var l=n.viewer3DImpl.geomCache();l||a.logger.error("geomCache is required for loading OTG models."),l.initWorker(n.options.acmSessionId),n.meshReceiveListener=function(e){e.error&&e.error.args?n.onMeshError(e):n.onMeshReceived(e.geom)},l.addEventListener(L.MESH_RECEIVE_EVENT,n.meshReceiveListener),l.addEventListener(L.MESH_FAILED_EVENT,n.meshReceiveListener),n.materialReceiveListener=function(e){!e.error&&e.material&&e.material.length?n.onMaterialLoaded((0,R.Up)(e.material),e.hash):n.onMaterialLoaded(null,e.hash)},l.addEventListener(L.MATERIAL_RECEIVE_EVENT,n.materialReceiveListener),l.addEventListener(L.MATERIAL_FAILED_EVENT,n.materialReceiveListener),n.svf.loadDone=!1}else if("fragment"===e)n.options.skipMeshLoad||n.tryToActivateFragment(s,"fragment"),n.options.onFragmentListLoadProgress&&n.trackFragmentListLoadProgress();else if("all_fragments"===e)n.options.skipPropertyDb||n.loadPropertyDb(),n.viewer3DImpl.api.fireEvent({type:T.MODEL_ROOT_LOADED_EVENT,svf:o,model:n.model}),n.options.skipMeshLoad||!n.svf.fragments.length?n.onGeomLoadDone():n.onOperationComplete();else if("bvh"===e){var c=s;n.model&&(n.model.setBVH(c.nodes,c.primitives,n.options.bvhOptions),n.viewer3DImpl&&n.viewer3DImpl.modelVisible(n.model.id)&&n.viewer3DImpl.invalidate(!1,!0)),n.onOperationComplete()}}else console.error("load callback called after load was aborted")},o.beginLoad(e,(0,p.pathToURL)(n.currentLoadPath)),!0},N.prototype.makeBVHInWorker=function(){var e=this;e.bvhWorker=(0,h.createWorkerWithIntercept)();e.bvhWorker.addEventListenerWithIntercept((function(t){if(t.data.bvh){console.log("Received BVH from worker");var n=t.data.bvh;e.model&&(e.svf.bvh=n,e.model.setBVH(new l.NodeArray(n.nodes,n.useLeanNodes),n.primitives,e.options.bvhOptions),e.viewer3DImpl&&e.viewer3DImpl.modelVisible(e.model.id)&&e.viewer3DImpl.invalidate(!1,!0)),e.bvhWorker.clearAllEventListenerWithIntercept(),e.bvhWorker.terminate(),e.bvhWorker=null,e.onOperationComplete()}if(t.data.boxes&&e.model){var i=e.model.myData.fragments;!function(e,t){for(var n=t.data.boxes,i=t.data.boxStride,r=n.length/i,o=0,a=0,s=0;o<r;o++,a+=i,s+=6)e[s+0]=n[a+0],e[s+1]=n[a+1],e[s+2]=n[a+2],e[s+3]=n[a+3],e[s+4]=n[a+4],e[s+5]=n[a+5]}(i.boxes,t),i.boxesLoaded=!0,e.model.visibleBoundsDirty=!0}}));var t=Object.assign({},e.loadContext);t.operation="LOAD_OTG_BVH",t.raiseError=null,t.onFailureCallback=null,t.onLoaderEvent=null,t.fragments_extra=(0,p.pathToURL)(e.basePath)+e.svf.manifest.assets.fragments_extra,t.placementTransform=e.svf.placementTransform,t.placementWithOffset=e.svf.placementWithOffset,t.fragmentTransformsOffset=e.svf.metadata.fragmentTransformsOffset,t.globalOffset=e.svf.globalOffset,t.fragments_extra?e.bvhWorker.doOperation(t):e.onOperationComplete()},N.prototype.tryToActivateFragment=function(e,t){var n,i=this.svf,r=this.model;if(r){var o=i.fragments.visibilityFlags[e],a=o&c.MeshFlags.MESH_NOTLOADED,s=o&c.MeshFlags.MESH_HIDE,l=null!==(n=i.loadOptions.skipHiddenFragments)&&void 0!==n&&n;if(a||s&&l)return r.getFragmentList().setFlagFragment(e,c.MeshFlags.MESH_NOTLOADED,!0),void this.trackGeomLoadProgress(i,e,!1);o&c.MeshFlags.MESH_HIDE&&(r.getFragmentList().setFlagFragment(e,c.MeshFlags.MESH_HIDE,!1),r.getFragmentList().setFlagFragment(e,c.MeshFlags.MESH_VISIBLE,!1));var u=!1,h=i.fragments.materials[e],d=i.getMaterialHash(h),p=this.findOrLoadMaterial(r,d,h);p||("fragment"===t&&this.pendingMaterials[d].push(e),"material"!==t&&(u=!0));var f=i.fragments.geomDataIndexes[e];if(0!==f){r.getFragmentList().getOriginalWorldMatrix(e,this.tmpMatrix);var m=r.getGeometryList().getGeometry(f);if(m||("fragment"===t&&this.loadGeometry(f,e),u=!0),!u){var g=this.viewer3DImpl.setupMesh(r,m,d,this.tmpMatrix);g.geomId=f,r.activateFragment(e,g,!!i.placementTransform),this.viewer3DImpl.geomCache().updateGeomImportance(r,e),this.trackGeomLoadProgress(i,e,!1)}}else(p||"material"===t)&&this.trackGeomLoadProgress(i,e,!1)}},N.prototype.onModelRootLoadDone=function(e){e.isOTG=!0,e.geomMetadata.hashToIndex={},e.failedFrags={},e.failedMeshes={},e.failedMaterials={},e.geomMemory=0,e.gpuNumMeshes=0,e.gpuMeshMemory=0,e.fragsLoaded=0,e.fragsLoadedNoGeom=0,e.nextRepaintPolys=0,e.numRepaints=0,e.urn=this.svfUrn,e.acmSessionId=this.acmSessionId,e.basePath=this.basePath,e.loadOptions=this.options||{};var t=Date.now();this.loadTime+=t-this.t0,a.logger.log("SVF load: "+(t-this.t0));var n=this.model=new M.Model(e);n.loader=this,n.initialize(),this.t0=t,a.logger.log("scene bounds: "+JSON.stringify(e.bbox));var i={category:"metadata_load_stats",urn:e.urn,has_topology:!!e.topology,has_animations:!!e.animations,materials:e.metadata.stats.num_materials,is_mobile:(0,P.isMobileDevice)()};a.logger.track(i),this.viewer3DImpl.signalProgress(5,C.ProgressState.ROOT_LOADED,this.model),e.handleHashListRequestFailures(this.loadContext),e.propDbLoader=new u.PropDbLoader(this.sharedDbPath,this.model,this.viewer3DImpl.api)},N.prototype.trackGeomLoadProgress=function(e,t,n){if(n){if(e.failedFrags[t])return void console.log("Double fail",t);e.failedFrags[t]=1}var i=B(e);e.fragsLoaded++;var r=B(e);r>i&&this.viewer3DImpl.signalProgress(r,C.ProgressState.LOADING,this.model),this.model.getGeometryList().geomPolyCount>e.nextRepaintPolys&&(this.firstPixelTimestamp=this.firstPixelTimestamp||Date.now(),e.numRepaints++,e.nextRepaintPolys+=1e5*Math.pow(1.5,e.numRepaints),this.viewer3DImpl.modelVisible(this.model.id)&&this.viewer3DImpl.invalidate(!1,!0)),e.fragsLoaded===e.metadata.stats.num_fragments&&this.onOperationComplete()},N.prototype.trackFragmentListLoadProgress=function(){var e=this.svf;function t(e){return Math.floor(100*e.fragsLoadedNoGeom/e.metadata.stats.num_fragments)}var n=t(e);e.fragsLoadedNoGeom++;var i=t(e);i>n&&this.options.onFragmentListLoadProgress(this.model,i)},N.prototype.onOperationComplete=function(){this.operationsDone++,3===this.operationsDone&&this.onGeomLoadDone()},N.prototype.onMaterialLoaded=function(){var e,t=(e=regeneratorRuntime.mark((function e(t,n,i){var r,o,a,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loading){e.next=2;break}return e.abrupt("return");case 2:if(r=this.pendingMaterials[n]){e.next=5;break}return e.abrupt("return");case 5:if(o=this.viewer3DImpl.matman(),!t){e.next=21;break}return t.hash=n,e.prev=8,e.next=11,o.convertSharedMaterial(this.model,t,n);case 11:a=e.sent,s.TextureLoader.loadMaterialTextures(this.model,a,this.viewer3DImpl),o.hasTwoSidedMaterials()&&this.viewer3DImpl.renderer().toggleTwoSided(!0),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(8),this.svf.failedMaterials[n]=1;case 19:e.next=22;break;case 21:this.svf.failedMaterials[n]=1;case 22:for(l=0;l<r.length;l++)this.tryToActivateFragment(r[l],"material");this.pendingMaterialsCount--,delete this.pendingMaterials[n];case 25:case"end":return e.stop()}}),e,this,[[8,16]])})),function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function a(e){D(o,i,r,a,s,"next",e)}function s(e){D(o,i,r,a,s,"throw",e)}a(void 0)}))});return function(e,n,i){return t.apply(this,arguments)}}(),N.prototype.findOrLoadMaterial=function(e,t,n){if(this.pendingMaterials[t])return!1;var i=this.svf;if(this.viewer3DImpl.matman().findMaterial(e,t))return!0;this.pendingMaterialsCount++,this.pendingMaterials[t]=[];var r=!!this.loadContext.otg_cdn,o=i.makeSharedResourcePath(this.loadContext.otg_cdn,"materials",t);return this.viewer3DImpl.geomCache().requestMaterial(o,r,t,n,this.queryParams),!1},N.prototype.loadGeometry=function(e,t){var n=this.svf,i=n.getGeometryHash(e);if(this.pendingMeshes[i])return this.pendingMeshes[i].push(t),!1;this.pendingMeshesCount++,this.pendingMeshes[i]=[t];var r=!!this.loadContext.otg_cdn;n.geomMetadata.hashToIndex[i]=e;var o=n.makeSharedResourcePath(this.loadContext.otg_cdn,"geometry",i);this.viewer3DImpl.geomCache().requestGeometry(o,r,i,e,this.queryParams)},N.prototype.onMeshError=function(e){var t=e.error.args.hash;this.svf.failedMeshes[t]=1;var n=this.pendingMeshes[t];if(n){for(var i=0;i<n.length;i++)this.trackGeomLoadProgress(this.svf,n[i],!0);delete this.svf.geomMetadata.hashToIndex[t],delete this.pendingMeshes[t],this.pendingMeshesCount--}},N.prototype.onMeshReceived=function(e){var t=this.model;if(t){var n=t.getGeometryList(),i=this.svf.geomMetadata.hashToIndex[e.hash];if(void 0!==i){var r=n.getGeometry(i),o=this.pendingMeshes[e.hash];if(!r){n.addGeometry(e,o&&o.length||1,i),this.svf.loadDone&&console.error("Geometry received after load was done");for(var a=0;a<o.length;a++)this.tryToActivateFragment(o[a],"geom");delete this.svf.geomMetadata.hashToIndex[e.hash],delete this.pendingMeshes[e.hash],this.pendingMeshesCount--}}}else console.warn("Received geometry after loader was done. Possibly leaked event listener?",e.hash)},N.prototype.onGeomLoadDone=function(){if(this.svf.loadDone=!0,this.removeMeshReceiveListener(),s.TextureLoader.loadModelTextures(this.model,this.viewer3DImpl),this.options.skipMeshLoad)return this.currentLoadPath=null,void this.viewer3DImpl.onLoadComplete(this.model);this.svf.fragments.entityIndexes=null,this.svf.fragments.mesh2frag=null,this.svf.geomMetadata.hashes=null;var e=Date.now(),t="Fragments load time: "+(e-this.t0);this.loadTime+=e-this.t0;var n=this.firstPixelTimestamp-this.t0;t+=" (first pixel time: "+n+")",a.logger.log(t),this.options.useConsolidation&&this.viewer3DImpl.consolidateModel(this.model,this.options.consolidationMemoryLimit);var i={category:"model_load_stats",is_f2d:!1,has_prism:this.viewer3DImpl.matman().hasPrism,load_time:this.loadTime,geometry_size:this.model.getGeometryList().geomMemory,meshes_count:this.svf.metadata.stats.num_geoms,fragments_count:this.svf.metadata.stats.num_fragments,urn:this.svfUrn};n>0&&(i.first_pixel_time=n),a.logger.track(i,!0);var r=this.model.getGeometryList(),o={load_time:this.loadTime,polygons:r.geomPolyCount,fragments:this.model.getFragmentList().getCount(),mem_usage:r.gpuMeshMemory,time_to_first_pixel:this.firstPixelTimestamp-this.t0,viewable_type:"3d"};O.analytics.track("viewer.model.loaded",o),this.currentLoadPath=null,this.viewer3DImpl.onLoadComplete(this.model)},N.prototype.loadPropertyDb=function(){this.svf.propDbLoader.load()},N.prototype.is3d=function(){return!0},N.loadOnlyOtgRoot=function(e,t){var n=k(e),i=U(t,n,F(t)),r=new S;r.basePath=n;var o=(0,p.pathToURL)(e);return new Promise((function(e){r.loadAsyncResource(i,o,"json",(function(t){r.metadata=t,r.manifest=t.manifest,r.numGeoms=r.metadata.stats.num_geoms,r.processMetadata(i),e(r)}))}))},A.FileLoaderManager.registerFileLoader("json",["json"],N)},19115:(e,t,n)=>{"use strict";n.r(t),n.d(t,{MATERIAL_FAILED_EVENT:()=>w,MATERIAL_RECEIVE_EVENT:()=>E,MESH_FAILED_EVENT:()=>x,MESH_RECEIVE_EVENT:()=>_,OtgResourceCache:()=>C});var i=n(84998),r=n(25131),o=n(58092),a=n(58964),s=n(62546),l=n(37169),c=n(17167),u=n(73075),h=n(22585),d=n(29747),p=n(27820);function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function m(e,t,n){return Math.abs(e.x-t.x)<n&&Math.abs(e.y-t.y)<n&&Math.abs(e.z-t.z)<n}function g(e,t){return t.importance-e.importance}var v=new h.LmvBox3;function y(e,t,n){var i=function(e,t,n){var i=6*t;return n.min.y=e[i+1],n.min.z=e[i+2],n.min.x=e[i+0],n.max.x=e[i+3],n.max.y=e[i+4],n.max.z=e[i+5],n}(t,e,v),r=n.intersectsBox(i);if(r===d.OUTSIDE)return 0;var o=r===d.CONTAINS,a=n.projectedBoxArea(i,o),s=p.SceneMath.pointToBoxDistance2(n.eye,i);return a/(s=Math.max(s,.01))}var b=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewers=[],this.waitingTasks=[],this.urgentHashes={},this.prevNumTasks=0,this.fullSortDone=!1,this.lastCamPos={},this.lastCamTarget={},this.lastVisibleModelIds={}}var t,n,i;return t=e,(n=[{key:"addViewer",value:function(e){this.viewers.push(e),this.lastCamPos[e.id]=new u.LmvVector3,this.lastCamTarget[e.id]=new u.LmvVector3,this.lastVisibleModelIds[e.id]=[]}},{key:"removeViewer",value:function(e){var t=this.viewers.indexOf(e);-1!==t&&(delete this.lastCamPos[e.id],delete this.lastCamTarget[e.id],delete this.lastVisibleModelIds[e.id],this.viewers.splice(t,1))}},{key:"checkCameraChanged",value:function(){for(var e=!1,t=0;t<this.viewers.length;t++){var n=this.viewers[t],i=n.impl.camera,r=i.position,o=i.target;m(this.lastCamPos[n.id],r,.01)&&m(this.lastCamTarget[n.id],o,.01)||(this.lastCamPos[n.id].copy(r),this.lastCamTarget[n.id].copy(o),e=!0)}return e}},{key:"checkModelsChanged",value:function(){for(var e=!1,t=0;t<this.viewers.length;t++){var n=this.viewers[t],i=n.impl.modelQueue().getModels();i.length!==this.lastVisibleModelIds[n.id].length&&(this.lastVisibleModelIds[n.id].length=i.length,e=!0);for(var r=0;r<i.length;r++){var o=this.lastVisibleModelIds[n.id][r],a=i[r].id;o!==a&&(this.lastVisibleModelIds[n.id][r]=a,e=!0)}}return e}},{key:"validateRequestPriorities",value:function(){var e=this.checkCameraChanged(),t=this.checkModelsChanged();if(e||t)for(var n=0;n<this.waitingTasks.length;n++)this.waitingTasks[n].importanceNeedsUpdate=!0}},{key:"updateRequestPriorities",value:function(){var e=performance.now();this.validateRequestPriorities();for(var t={},n=[],i=0;i<this.viewers.length;i++){var r=(x=this.viewers[i]).impl.modelQueue(),o=r.frustum();n=n.concat(r.getModels()),o.reset(x.impl.camera),t[x.id]=o}var a=!1,s=0===this.prevNumTasks||this.waitingTasks.length-this.prevNumTasks>3e3||!this.fullSortDone;for(this.fullSortDone=!s,this.prevNumTasks=this.waitingTasks.length,i=0;i<this.waitingTasks.length;i++){var l=this.waitingTasks[i];if(l.importanceNeedsUpdate)if(this.urgentHashes[l.hash])l.importance=1/0;else{if(i%10==0&&performance.now()-e>10){a=!0;break}l.importanceNeedsUpdate=!1,l.importance=0;for(var c=0,u=l.hash,h=0;h<n.length;h++){var d=n[h];if(d.isOTG()){var p=d.myData,f=p.fragments,m=f.boxes,v=p.geomMetadata.hashToIndex[u];if(v&&f.mesh2frag)for(var b=f.mesh2frag[v],_=0;_<this.viewers.length;_++){var x;if(-1!==(x=this.viewers[_]).impl.modelQueue().getModels().indexOf(d))if("number"==typeof b)c+=y(b,m,t[x.id]);else if(Array.isArray(b))for(_=0;_<b.length;_++)c+=y(b[_],m,t[x.id])}}}if(l.importance=c,!s){for(h=i;h>0&&c>this.waitingTasks[h-1].importance;)this.waitingTasks[h]=this.waitingTasks[h-1],h--;this.waitingTasks[h]=l}}}return s&&!a&&(this.waitingTasks.sort(g),this.fullSortDone=!0),!a}},{key:"makeUrgent",value:function(e){var t=0;for(var n in e)!0===e[n]&&(this.urgentHashes[n]=!0,t++);if(0===t)return 0;for(var i=0;i<this.waitingTasks.length;i++){var r=this.waitingTasks[i];this.urgentHashes[r.hash]&&(r.importance=1/0)}return this.waitingTasks.sort(g),t}},{key:"removeUrgent",value:function(e){delete this.urgentHashes[e]}},{key:"addTask",value:function(e){this.waitingTasks.push(e)}},{key:"takeTask",value:function(){return this.waitingTasks.shift()}},{key:"isEmpty",value:function(){return 0===this.waitingTasks.length}}])&&f(t.prototype,n),i&&f(t,i),e}(),_="meshReceived",x="meshFailed",E="materialReceived",w="materialFailed",S="true"===(0,c.getParameterByName)("disableIndexedDb").toLowerCase()||(0,i.getGlobal)().DISABLE_INDEXED_DB,A="true"===(0,c.getParameterByName)("disableWebSocket").toLowerCase()||(0,i.getGlobal)().DISABLE_WEBSOCKET;function M(e){var t=(0,a.initLoadContext)(e);return t.disableIndexedDb=S,t.disableWebSocket=A,t.isInlineWorker=Autodesk.Viewing.Private.ENABLE_INLINE_WORKER,t}function T(e,t){return e.importance-t.importance}function C(){for(var e=new Map,t=new Map,n={},a=(0,i.isMobileDevice)()?2:8,s=[],c=0;c<a;c++)s.push((0,o.createWorkerWithIntercept)());this.initialized=!0,this.byteSize=0,this.refCount=0;var u=0,h=void 0,d=new b,p=this,f=1048576,m=100*f,g=0,y=!1;function S(){y=!1}var A=[];function C(i){if(i.data)if(d.waitingTasks.length&&!h&&(h=setTimeout(L,0)),i.data.error){var o=i.data.error,a=o.args?o.args.hash:void 0,s=o.args?o.args.type:"g";a&&("m"===s?(t.set(a,o),p.fireEvent({type:w,error:o}),console.warn("Error loading material",a)):(e.set(a,o),p.fireEvent({type:x,error:o}),console.warn("Error loading mesh",a)),delete n[o.hash],u--)}else if(i.data.material){a=(m=i.data).hash;var l=m.material;t.set(a,l),p.fireEvent({type:E,material:l,hash:a}),delete n[m.hash],u--}else for(var c=i.data,f=0;f<c.length;f++){var m;if((m=c[f]).hash&&m.mesh){r.BufferGeometryUtils.meshToGeometry(m);a=m.hash;var g=m.geometry;e.set(a,g),p.byteSize+=g.byteSize,p.cleanup(),p.fireEvent({type:_,geom:g}),delete n[m.hash]}u--}}this.addViewer=function(e){e.addEventListener(l.MODEL_UNLOADED_EVENT,S),A.push(e),d.addViewer(e)},this.removeViewer=function(e){var t=A.indexOf(e);-1!==t&&(e.removeEventListener(l.MODEL_UNLOADED_EVENT,S),d.removeViewer(e),A.splice(t,1)),0===A.length&&this.dtor()},this.dtor=function(){A=[];for(var n=0;n<a;n++)s[n].clearAllEventListenerWithIntercept(),s[n].terminate();e=null,t=null,this.initialized=!1};for(c=0;c<a;c++)s[c].addEventListenerWithIntercept(C);function P(e){return"number"==typeof e?e%a:0|Math.random()*a}function L(){var e=100*a-u;if(0!==e){d.updateRequestPriorities()||(e=Math.min(e,10*a));for(var t=[],n=0;!d.isEmpty()&&n<e;){var i=d.takeTask(),r=P(i.geomIdx);(l=t[r])?(l.urls.push(i.url),l.hashes.push(i.hash)):(l={operation:"LOAD_CDN_RESOURCE_OTG",type:"g",urls:[i.url],hashes:[i.hash],isCDN:i.isCDN,queryParams:i.queryParams},t[r]=l),n++}for(var o=0;o<t.length;o++){var l;(l=t[o])&&(s[o].doOperation(M(l)),u+=l.urls.length)}h=void 0}else h=setTimeout(L,30)}this.initWorker=function(e){for(var t=0;t<a;t++){var n={operation:"INIT_WORKER_OTG",authorizeUrns:[e]};s[t].doOperation(M(n))}},this.updateMruTimestamps=function(){for(var e=0;e<a;e++){var t={operation:"UPDATE_MRU_TIMESTAMPS_OTG",endSession:d.isEmpty()};s[e].doOperation(M(t))}},this.requestGeometry=function(t,r,o,a,s){var l=this,c=e.get(o);if(c&&c.args)(0,i.isNodeJS)()?setImmediate((function(){return l.fireEvent({type:x,error:c,hash:o,repeated:!0})})):this.fireEvent({type:x,error:c,hash:o,repeated:!0});else if(c)(0,i.isNodeJS)()?setImmediate((function(){return l.fireEvent({type:_,geom:c})})):this.fireEvent({type:_,geom:c});else{var u=n[o];if(u&&u.refcount)return u.importanceNeedsUpdate=!0,void u.refcount++;var p={operation:"LOAD_CDN_RESOURCE_OTG",type:"g",url:t,isCDN:r,hash:o,queryParams:s,importance:0,geomIdx:a,importanceNeedsUpdate:!0,refcount:1};d.addTask(p),n[o]=p,h||(h=setTimeout(L,0))}},this.requestMaterial=function(e,i,r,o,a){var l=this,c=t.get(r);if(c&&c.args)setImmediate((function(){return l.fireEvent({type:w,error:c,hash:r,repeated:!0})}));else if(c)setImmediate((function(){return l.fireEvent({type:E,material:c,hash:r})}));else{var h=n[r];if(h&&h.refcount)h.refcount++;else{var d={operation:"LOAD_CDN_RESOURCE_OTG",type:"m",urls:[e],hashes:[r],isCDN:i,queryParams:a,refcount:1};n[r]=d;var p=P(o);s[p].doOperation(M(d)),u++}}},this.cancelRequests=function(e){for(var t in e){var i=n[t];i&&i.refcount--}for(var r=[],o=0;o<d.waitingTasks.length;o++){var a=d.waitingTasks[o],s=n[a.hash];s&&s.refcount?r.push(a):delete n[a.hash]}d.waitingTasks=r},this.updateGeomImportance=function(e,t){return function(e,t){var n=e.getFragmentList(),i=n.getGeometry(t);if(n.getWorldBounds(t,v),i){var r,o,a,s,l=i.importance||0,c=2*((o=(r=v).max.x-r.min.x)*(a=r.max.y-r.min.y)+a*(s=r.max.z-r.min.z)+s*o);i.importance=Math.max(l,c)}}(e,t)},this.cleanup=function(){var t=[];if(!(this.byteSize<m)){for(var n=[],i=0;i<A.length;i++){var r=A[i].impl.modelQueue();n=n.concat(r.getModels().concat(A[i].getHiddenModels()))}if(!y){g++;for(i=0;i<n.length;i++){var o=n[i],a=o.getData();if(o.isOTG()){var s=a.geomMetadata.hashes;if(s)for(var l=s.length/a.geomMetadata.byteStride,c=1;c<l;c++){var u=a.getGeometryHash(c);(h=e.get(u))&&(h.timeStamp=g)}}}for(var u in t.length>0&&console.warn("OtgResourceCache.cleanup(): array must be empty"),e){(h=e.get(u)).timeStamp!==g&&t.push(h)}t.sort(T);for(i=0;i<t.length&&this.byteSize>=52428800;i++){var h=t[i];e.delete(h.hash),this.byteSize-=h.byteSize,h.dispose()}i===t.length&&(y=!0),t.length=0}}},this.waitForGeometry=function(t,n){var i=0,r=d.makeUrgent(t);if(0===r&&t)n(t);else for(var o in L(),this.addEventListener(_,l),this.addEventListener(x,c),t){var a=e.get(o);a&&s(o,a)}function s(e,o){d.removeUrgent(e),!0!=!t[e]&&(t[e]=o,++i<r||(p.removeEventListener(_,l),p.removeEventListener(x,c),n(t)))}function l(e){s(e.geom.hash,e.geom)}function c(e){s(e.error.args.hash,void 0)}},this.getGeometry=function(t){return e.get(t)}}s.EventDispatcher.prototype.apply(C.prototype)},8283:(e,t,n)=>{"use strict";n.r(t),n.d(t,{getPropWorker:()=>E,shutdownPropWorker:()=>w,clearPropertyWorkerCache:()=>S,PropDbLoader:()=>P});var i=n(98926),r=n(57601),o=n(79659),a=n(37169),s=n(58964),l=n(1840),c=n(6420),u=n(58092),h=n(62546);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f,m="GET_PROPERTIES",g="GET_PROPERTY_SET",v="UNLOAD_PROPERTYDB",y=1,b={};function _(e){var t=e.data;if(t&&t.debug)i.logger.debug(t.message);else{var n=t&&t.cbId&&b[t.cbId];n&&(t.progress?n[2]&&n[2](t.progress):(t.error?n[1]&&n[1](t.error):n[0]&&n[0](t.result),delete b[t.cbId]))}}function x(e,t,n){var i=y++;return b[i]=[e,t,n],i}function E(){return f}function w(){f&&(f.clearAllEventListenerWithIntercept(),f.terminate(),f=void 0)}function S(){f&&f.doOperation({operation:v,clearCaches:!0})}var A=0,M=1,T=2,C=3,P=function(e,t,n){var o,a,s,l;this.eventTarget=n||new h.EventDispatcher,this.model=t,this.svf=t&&t.getData(),this.dbPath="",this.sharedDbPath=!1;var c=this.svf&&this.svf.loadOptions.bubbleNode&&this.svf.loadOptions.bubbleNode.findViewableParent()._getOtgManifest(),u=c&&this.svf&&this.svf.is2d;if(this.svf&&!u&&this.svf.propertydb&&this.svf.propertydb.avs.length){for(var d in this.dbFiles=this.svf.propertydb,this.dbFiles)this.dbFiles[d][0]&&(this.dbFiles[d][0].path=this.dbFiles[d][0].path.replace(/\\/g,"/"));var p=(0,r.pathToURL)(this.svf.basePath);if(e){var f=r.ViewingService.simplifyPath(p+this.svf.propertydb.avs[0].path);if((f=f.slice(0,f.lastIndexOf("/")+1))===e){var m={};for(var g in this.dbFiles){var v=this.dbFiles[g][0],y=v.path;0===(y=r.ViewingService.simplifyPath(p+y)).indexOf(e)&&(y=y.slice(e.length)),m[g]=[{path:y,isShared:v.isShared}]}this.dbFiles=m,this.dbPath=e,this.sharedDbPath=!0}else this.dbPath=p,this.sharedDbPath=!1}else this.dbPath=p,this.sharedDbPath=!1}else{if(this.sharedDbPath=!0,this.svf&&this.svf.loadOptions.bubbleNode){this.dbPath=e;var b=this.svf.loadOptions.bubbleNode.getPropertyDbManifest();this.dbFiles=b.propertydb,this.needsDbIdRemap=b.needsDbIdRemap}else i.logger.warn("Deprecated shared property database initialization without bubbleNode in Model load options."),this.dbPath=e,this.dbFiles={attrs:[],avs:[],ids:[],values:[],offsets:[]};i.logger.log("Using shared db path "+e)}c&&(this.needsDbIdRemap=this.svf.loadOptions.needsDbIdRemap||this.needsDbIdRemap),this.queryParams="";var _=null===(o=this.model)||void 0===o||null===(a=o.getDocumentNode())||void 0===a||null===(s=a.getDocument())||void 0===s?void 0:s.getAcmSessionId(this.dbPath);_=_||(null===(l=this.svf)||void 0===l?void 0:l.acmSessionId),this.svf&&_&&(this.queryParams="acmsession="+_),this.loadProgress=0,this.cbId=void 0,this.idLoadState=A,this.waitingForExternalIds=[]};P.prototype.dtor=function(){this.asyncPropertyOperation({operation:v},(function(){}),(function(){}));var e,t=Boolean(this.cbId),n=this.instanceTree||this.propertyDbError;t&&!n&&(e=this.cbId,delete b[e],this.propertyDbError={propDbWasUnloaded:!0},this.eventTarget.dispatchEvent({type:a.OBJECT_TREE_UNAVAILABLE_EVENT,svf:this.svf,model:this.model,target:this})),this.model=null,this.svf=null},P.prototype.processLoadResult=function(e){var t=this;if(e.instanceTreeStorage){var n=new c.InstanceTreeAccess(e.instanceTreeStorage,e.rootId,e.instanceBoxes);t.instanceTree=new l.InstanceTree(n,e.objectCount,e.maxTreeDepth),t.svf&&(t.svf.instanceTree=t.instanceTree,t.instanceTree.setFragmentList(t.model.getFragmentList()))}e.objectCount&&(t.hasObjectProperties=e.objectCount,t.svf&&(t.svf.hasObjectProperties=e.objectCount)),e.dbidOldToNew&&this.model.setDbIdRemap(e.dbidOldToNew),t.onLoadProgress(100),t.eventTarget.dispatchEvent({type:a.OBJECT_TREE_CREATED_EVENT,svf:t.svf,model:t.model,target:t})},P.prototype.processLoadError=function(e){var t=this;t.propertyDbError=e,t.onLoadProgress(100),t.eventTarget.dispatchEvent({type:a.OBJECT_TREE_UNAVAILABLE_EVENT,svf:t.svf,model:t.model,target:t})},P.prototype.load=function(e){var t=this;e=e||{},f||(f=(0,u.createWorkerWithIntercept)(!0)).addEventListenerWithIntercept(_);this.cbId=x((function(e){t.processLoadResult(e)}),(function(e){t.processLoadError(e)}),(function(e){t.onLoadProgress(e.percent)}));var n=this.svf&&this.svf.loadOptions,i=!(n&&n.disablePrecomputedNodeBoxes),r=!(!n||!n.skipExternalIds);r||(this.idLoadState=M);var o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({operation:this.svf&&this.svf.instanceTree&&this.svf.instanceBoxes?"CREATE_TREE":"LOAD_PROPERTYDB",dbPath:this.dbPath,sharedDbPath:this.sharedDbPath,propertydb:this.dbFiles,fragToDbId:this.svf&&this.svf.fragments.fragId2dbId,fragBoxes:i&&this.svf&&this.svf.fragments.boxes,needsDbIdRemap:this.needsDbIdRemap,is2d:this.svf&&this.svf.is2d,cbId:this.cbId,queryParams:this.queryParams,skipExternalIds:r,gltfTree:this.svf.instanceTree,dbToFragId:this.svf&&this.svf.fragments.dbToFragId},e);f.doOperation((0,s.initLoadContext)(o))},P.prototype.asyncPropertyOperation=function(e,t,n,i){var r=this;if(e.dbPath=this.dbPath,r.instanceTree||r.hasObjectProperties)e.cbId=x(t,n,i),f.doOperation(e);else if(r.propertyDbError)n&&n(r.propertyDbError);else{var s=function s(){r.eventTarget.removeEventListener(a.OBJECT_TREE_CREATED_EVENT,s),r.eventTarget.removeEventListener(a.OBJECT_TREE_UNAVAILABLE_EVENT,s),r.instanceTree||r.hasObjectProperties||r.propertyDbError?r.asyncPropertyOperation(e,t,n,i):n&&n({code:o.ErrorCodes.UNKNOWN_FAILURE,msg:"Failed to load properties"})};r.eventTarget.addEventListener(a.OBJECT_TREE_CREATED_EVENT,s),r.eventTarget.addEventListener(a.OBJECT_TREE_UNAVAILABLE_EVENT,s)}},P.prototype.getProperties=function(e,t,n){this.idLoadState===A&&i.logger.warn("Calling getProperties() will cause loading of the potentially large externalIDs file. Use getProperties2() to avoid this warning."),this.getProperties2(e,t,n,{needsExternalId:!0})},P.prototype.getProperties2=function(e,t,n,i){var r=this,o=function(){r.asyncPropertyOperation({operation:m,dbId:e,gltfTree:r.svf&&r.svf.instanceTreeBackup},t,n)};i&&i.needsExternalId?this.loadExternalIds().then(o).catch(n):o()},P.prototype.getBulkProperties=function(e,t,n,r,o){var a={ignoreHidden:o,propFilter:t,needsExternalId:!t||t.includes("externalId")};a.needsExternalId&&this.idLoadState===A&&i.logger.warn("Calling getProperties() will cause loading of the potentially large externalIDs file. Use getProperties2() to avoid this warning."),this.getBulkProperties2(e,a,n,r)},P.prototype.getBulkProperties2=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=function(){t.asyncPropertyOperation({operation:m,dbIds:e,propFilter:n.propFilter,categoryFilter:n.categoryFilter,ignoreHidden:n.ignoreHidden},i,r)};n&&n.needsExternalId?this.loadExternalIds().then(o).catch(r):o()},P.prototype.getPropertySet=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=function(){t.asyncPropertyOperation({operation:g,dbIds:e,propFilter:n.propFilter,ignoreHidden:n.ignoreHidden,fileType:n.fileType},i,r)};n&&n.needsExternalId?this.loadExternalIds().then(o).catch(r):o()},P.prototype.searchProperties=function(e,t,n,i,r){this.asyncPropertyOperation({operation:"SEARCH_PROPERTIES",searchText:e,attributeNames:t,searchOptions:r},n,i)},P.prototype.findProperty=function(e){var t=this;return new Promise((function(n,i){t.asyncPropertyOperation({operation:"FIND_PROPERTY",propertyName:e},n,i)}))},P.prototype.diffProperties=function(e,t,n,i,r){this.asyncPropertyOperation({operation:"DIFF_PROPERTIES",dbPath2:e,diffOptions:i},t,n,r)},P.prototype.findLayers=function(){var e=this;return new Promise((function(t,n){e.asyncPropertyOperation({operation:"FIND_LAYERS"},t,n)}))},P.prototype.getExternalIdMapping=function(e,t,n){var i=this;return this.loadExternalIds().then((function(){i.asyncPropertyOperation({operation:"BUILD_EXTERNAL_ID_MAPPING",extIdFilter:n},e,t)}))},P.prototype.getLayerToNodeIdMapping=function(e,t){this.asyncPropertyOperation({operation:"BUILD_LAYER_TO_NODE_ID_MAPPING"},e,t)},P.prototype.executeUserFunction=function(e,t){var n,i=this;if("function"==typeof e)e=e.toString();else if("string"!=typeof e)return Promise.reject("Expected Function or string.");try{n=new Blob([e],{type:"application/javascript"})}catch(t){var r=new BlobBuilder;r.append(e),n=r.getBlob()}var o=URL.createObjectURL(n);return new Promise((function(e,n){i.asyncPropertyOperation({operation:"USER_FUNCTION",userFunction:o,userData:t},e,n)}))},P.prototype.isObjectTreeLoaded=function(){return!!this.instanceTree},P.prototype.getObjectTree=function(e,t){var n=this;if(n.instanceTree)e(n.instanceTree);else if(n.propertyDbError)t&&t(n.propertyDbError);else if("hasObjectProperties"in n)n.svf&&n.svf.is2d&&t?t("F2D files do not have an InstanceTree."):e(null);else{var i=function i(){n.eventTarget.removeEventListener(a.OBJECT_TREE_CREATED_EVENT,i),n.eventTarget.removeEventListener(a.OBJECT_TREE_UNAVAILABLE_EVENT,i),n.getObjectTree(e,t)};n.eventTarget.addEventListener(a.OBJECT_TREE_CREATED_EVENT,i),n.eventTarget.addEventListener(a.OBJECT_TREE_UNAVAILABLE_EVENT,i)}},P.prototype.onLoadProgress=function(e){this.eventTarget.dispatchEvent({type:a.OBJECT_TREE_LOAD_PROGRESS_EVENT,percent:e,svf:this.svf,model:this.model,target:this}),this.loadProgress=e},P.prototype.getLoadProgress=function(){return this.loadProgress},P.prototype.isLoadDone=function(){return 100==this.loadProgress},P.prototype.loadExternalIds=function(){var e=this;switch(this.idLoadState){case M:return Promise.resolve();case C:return Promise.reject();case A:this.idLoadState=T;var t={operation:"LOAD_EXTERNAL_IDS",idsFile:this.dbFiles.ids[0],queryParams:this.queryParams};(0,s.initLoadContext)(t),this.asyncPropertyOperation(t,(function(){e.idLoadState=M,e.waitingForExternalIds.forEach((function(e){return e.resolve()}))}),(function(){e.idLoadState=C,e.waitingForExternalIds.forEach((function(e){return e.reject()}))}))}return new Promise((function(t,n){e.waitingForExternalIds.push({resolve:t,reject:n})}))}},33450:(e,t,n)=>{"use strict";n.r(t),n.d(t,{SvfLoader:()=>M});var i=n(84998),r=n(98926),o=n(43586),a=n(79659),s=n(26245),l=n(46759),c=n(25131),u=n(88715),h=n(57601),d=n(8283),p=n(50005),f=n(58092),m=n(37169),g=n(83161),v=n(16453),y=n(50411),b=n(58964),_=n(18588);function x(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}function E(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function a(e){x(o,i,r,a,s,"next",e)}function s(e){x(o,i,r,a,s,"throw",e)}a(void 0)}))}}var w=Autodesk.Viewing,S=w.Private,A=(0,i.isNodeJS)()?10:(0,i.isMobileDevice)()?2:6,M=function(e){this.viewer3DImpl=e,this.next_pack=0,this.loading=!1,this.loadedPacksCount=0,this.tmpMatrix=new v.Matrix4,this.tmpBox=new v.Box3,this.fetchingTopology=!1,this.loadTime=0,this.notifiesFirstPixel=!0};M.prototype.dtor=function(){if(this.initWorkerScriptToken&&(this.initWorkerScriptToken.cancel(),this.initWorkerScriptToken=null,r.logger.debug("SVF loader dtor: on init worker script.")),this.svfWorker&&(this.svfWorker.clearAllEventListenerWithIntercept(),this.svfWorker.terminate(),this.svfWorker=null,r.logger.debug("SVF loader dtor: on svf worker.")),this.pack_workers){for(var e=0;e<this.pack_workers.length;e++)this.pack_workers[e].clearAllEventListenerWithIntercept(),this.pack_workers[e].terminate();this.pack_workers=null,r.logger.debug("SVF loader dtor: on geom worker.")}this.svf&&this.svf.propDbLoader&&(this.svf.propDbLoader.dtor(),this.svf.propDbLoader=null),this.tmpMatrix=null,this.tmpBox=null,this.svf=null,this.model=null,this.next_pack=0,this.loading=!1,this.loadedPacksCount=0,this.loadTime=0,this.viewer3DImpl=null},M.prototype.initWorkerScript=f.initWorkerScript,M.prototype.createWorkerWithIntercept=f.createWorkerWithIntercept,M.prototype.startWorkers=function(){for(var e=this,t=this.svf,n=Math.min(t.geompacks.length,w.NUM_WORKER_THREADS||A),r=0;r<n;r++){var o=t.geompacks[this.next_pack++];o.loading=!0,(0,i.isNodeJS)()?this.loadGeometryPack(o.id,o.uri):function(t){setTimeout((function(){e.loadGeometryPack(t.id,t.uri)}),200*r)}(o)}},M.prototype.createModel=function(e){var t=this.model=new g.Model(e);return t.loader=this,t.initialize(),t},M.prototype.isValid=function(){return this.viewer3DImpl},M.prototype.loadFile=function(e,t,n,i){if(!this.viewer3DImpl)return r.logger.log("SVF loader was already destructed. So no longer usable."),!1;if(this.loading)return r.logger.log("Loading of SVF already in progress. Ignoring new request."),!1;this.loading=!0;var o=e.indexOf("urn:");if(-1!=o){var a=(e=decodeURIComponent(e)).substr(o,e.substr(o).indexOf("/"));r.logger.log("Extracted URN: "+a);var s=a.lastIndexOf(":");this.svfUrn=a.substr(s+1)}else this.svfUrn=e;this.sharedDbPath=t.sharedPropertyDbPath,this.currentLoadPath=e;var l=this.currentLoadPath.lastIndexOf("/");-1!=l&&(this.basePath=this.currentLoadPath.substr(0,l+1)),this.acmSessionId=t.acmSessionId,this.queryParams="",this.acmSessionId&&(this.queryParams="acmsession="+this.acmSessionId),this.options=t;var c=this;return this.initWorkerScriptToken=this.initWorkerScript((function(){c.loadSvfCB(e,t,n,i)})),!0},M.prototype.loadSvfCB=function(e,t,n,o){this.t0=(new Date).getTime(),this.firstPixelTimestamp=null,this.failedToLoadSomeGeometryPacks=null,this.failedToLoadPacksCount=0;var l=!0,c=this,u={url:(0,h.pathToURL)(e),basePath:this.currentLoadPath,objectIds:t.ids,globalOffset:t.globalOffset,fragmentTransformsDouble:t.fragmentTransformsDouble,placementTransform:t.placementTransform,applyRefPoint:t.applyRefPoint,queryParams:this.queryParams,bvhOptions:t.bvhOptions||{isWeakDevice:(0,i.isMobileDevice)()},applyScaling:t.applyScaling,applyPlacementInModelUnits:t.applyPlacementInModelUnits,loadInstanceTree:t.loadInstanceTree};this.viewer3DImpl._signalNoMeshes();var d=this.svfWorker=this.createWorkerWithIntercept(),p=function(){var e=E(regeneratorRuntime.mark((function e(t){var i,h,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=function(){d.clearAllEventListenerWithIntercept(),d.terminate(),c.svfWorker=null,d=null},l&&o&&(l=!1,o()),!t.data||!t.data.manifest){e.next=9;break}c.interceptManifest(t.data.manifest),u.operation="LOAD_SVF_CONTD",u.manifest=t.data.manifest,d.doOperation(u),e.next=26;break;case 9:if(!t.data||!t.data.svf){e.next=25;break}return h=c.svf=t.data.svf,c.failedToLoadSomeGeometryPacks&&(n&&n(c.failedToLoadSomeGeometryPacks),c.failedToLoadSomeGeometryPacks=null),e.next=14,c.onModelRootLoadDone(h);case 14:n&&n(null,c.model),c.viewer3DImpl.api.dispatchEvent({type:m.MODEL_ROOT_LOADED_EVENT,svf:h,model:c.model}),h.loadDone=!1,p=!1,h.metadata&&h.metadata.gltf&&(p=!0),p||(0==h.geompacks.length?c.onGeomLoadDone():c.startWorkers()),1==t.data.progress&&(c.loading=!1,i()),h.fragments.polygonCounts||(h.fragments.polygonCounts=new Int32Array(h.fragments.length)),t.data.bvh&&(h.bvh=t.data.bvh,c.model.setBVH(new s.NodeArray(h.bvh.nodes,h.bvh.useLeanNodes),h.bvh.primitives,c.options.bvhOptions),c.viewer3DImpl.invalidate(!1,!0)),e.next=26;break;case 25:t.data&&t.data.bvh?(c.svf&&!c.svf.bvh&&(c.svf.bvh=t.data.bvh,c.model.setBVH(new s.NodeArray(c.svf.bvh.nodes,c.svf.bvh.useLeanNodes),c.svf.bvh.primitives,c.options.bvhOptions),c.viewer3DImpl.invalidate(!1,!0)),c.loading=!1,i()):t.data&&t.data.mesh?(c.processReceivedMesh(t.data),1===t.data.progress&&(c.onGeomLoadDone(),c.loading=!1,i())):t.data&&t.data.progress?1==t.data.progress&&(c.loading=!1,i()):t.data&&t.data.error?(c.loading=!1,i(),r.logger.error("Error while processing SVF: "+JSON.stringify(t.data.error.args)),n&&n(t.data.error,null)):t.data&&t.data.debug?r.logger.debug(t.data.message):(r.logger.error("SVF download failed.",(0,a.errorCodeString)(a.ErrorCodes.NETWORK_FAILURE)),c.loading=!1,i());case 26:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return d.addEventListenerWithIntercept(p),u.operation="LOAD_SVF",u.interceptManifest=!!this.interceptManifest,d.doOperation((0,b.initLoadContext)(u)),!0},M.prototype.loadGeometryPack=function(e,t){var n,i,o,a,s=this;if(this.svf&&this.isValid()){var l=this.pack_workers;if(l||(l=this.pack_workers=[]),l.length<(w.NUM_WORKER_THREADS||A)){var c=!0;for(o=0;o<l.length;o++)if(0===l[o].queued){c=!1;break}if(c){var u=this.createWorkerWithIntercept();u.addEventListenerWithIntercept((function(e){if(e.data&&e.data.meshes){for(var t=e.data.meshes,n={packId:e.data.packId,meshIndex:0,mesh:null},i=0;i<t.length;i++){var o=t[i];o&&(n.meshIndex=i,n.mesh=o,s.processReceivedMesh(n))}if(e.data.progress>=1){s.pack_workers[e.data.workerId].queued-=1,s.loadedPacksCount++,s.viewer3DImpl.signalProgress(100*s.loadedPacksCount/s.svf.geompacks.length,_.ProgressState.LOADING,s.model);var l=!0;for(a=0;a<s.pack_workers.length;a++)if(0!=s.pack_workers[a].queued){l=!1;break}if(l){for(a=0;a<s.pack_workers.length;a++)s.pack_workers[a].clearAllEventListenerWithIntercept(),s.pack_workers[a].terminate();s.pack_workers=null}s.loadedPacksCount+s.failedToLoadPacksCount==s.svf.geompacks.length&&s.onGeomLoadDone()}}else if(e.data&&e.data.progress){if(s.pack_workers[e.data.workerId].queued-=1,s.next_pack<s.svf.geompacks.length){var c=null;if(!c||c.loading)for(;s.next_pack<s.svf.geompacks.length&&(c=s.svf.geompacks[s.next_pack++]).loading;);c&&!c.loading?(c.loading=!0,s.loadGeometryPack(c.id,c.uri)):(s.viewer3DImpl.modelQueue().enforceBvh=!1,s.svf.fragments.packIds=null)}}else e.data&&e.data.debug?r.logger.debug(e.data.message):e.data&&e.data.error?(++s.failedToLoadPacksCount,s.failedToLoadSomeGeometryPacks={code:e.data.error.code,msg:e.data.error.msg}):s.pack_workers[e.data.workerId].queued-=2})),u.queued=0,l.push(u)}}var d=0,p=l[0].queued;for(o=1;o<l.length;o++)l[o].queued<p&&(d=o,p=l[o].queued);(n=l[d]).queued+=2,i=d;var f={operation:"LOAD_GEOMETRY",url:(0,h.pathToURL)(this.svf.basePath+t),packId:parseInt(e),workerId:i,createWireframe:this.options.createWireframe||this.model.getMetadata("renderEnvironmentDisplayEdges","value",!1),packNormals:this.options.packNormals,queryParams:this.queryParams};n.doOperation((0,b.initLoadContext)(f))}},M.prototype.processReceivedMesh=function(e){var t=e.packId+":"+e.meshIndex,n=this.svf,i=n.fragments,o=this.model,a=i.mesh2frag[t];if(void 0!==a){Array.isArray(a)||(a=[a]),c.BufferGeometryUtils.meshToGeometry(e),e.geometry.packId=e.packId;for(var s=a.length,u=o.getFragmentList().getGeometryId(a[0]),h=o.getGeometryList().addGeometry(e.geometry,s,u),d=(e.geometry.index.array||e.geometry.ib).length/3,f=0;f<a.length;f++){var m=0|a[f];if(n.loadOptions.skipHiddenFragments)if(!(i.visibilityFlags[m]&l.MeshFlags.MESH_VISIBLE))continue;o.getFragmentList().getOriginalWorldMatrix(m,this.tmpMatrix);var g=i.materials[m].toString(),v=this.viewer3DImpl.matman().findMaterial(o,g);v&&!v.texturesLoaded&&p.TextureLoader.loadMaterialTextures(o,v,this.viewer3DImpl),i.polygonCounts&&(i.polygonCounts[m]=d);var y=this.viewer3DImpl.setupMesh(this.model,e.geometry,g,this.tmpMatrix);o.activateFragment(m,y,!!n.placementTransform)}this.options.onMeshReceived&&this.options.onMeshReceived(this.model,h,a),i.mesh2frag[t]=null,i.numLoaded+=a.length,this.viewer3DImpl._signalMeshAvailable(),o.getGeometryList().geomPolyCount>n.nextRepaintPolys&&(this.firstPixelTimestamp=this.firstPixelTimestamp||Date.now(),n.numRepaints++,n.nextRepaintPolys+=1e4*Math.pow(1.5,n.numRepaints),this.viewer3DImpl.invalidate(!1,!0))}else r.logger.warn("Mesh "+t+" was not referenced by any fragments.")},M.prototype.onModelRootLoadDone=function(){var e=E(regeneratorRuntime.mark((function e(t){var n,a,s,l,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.geomMemory=0,t.fragments.numLoaded=0,t.gpuNumMeshes=0,t.gpuMeshMemory=0,t.nextRepaintPolys=0,t.numRepaints=0,t.urn=this.svfUrn,t.acmSessionId=this.acmSessionId,t.basePath=this.basePath,t.loadOptions=this.options,t.verylargebbox&&this.viewer3DImpl.setNearRadius(this.options.nearRadius||1),n=Date.now(),this.loadTime+=n-this.t0,r.logger.log("SVF load: "+(n-this.t0)),a=this.createModel(t),this.options.skipPropertyDb||this.loadPropertyDb(),e.next=18,this.convertMaterials(a);case 18:if(s=e.sent,this.viewer3DImpl.matman().hasTwoSidedMaterials()&&this.viewer3DImpl.renderer().toggleTwoSided(!0),this.t1=n,t.bbox=(new v.Box3).copy(t.bbox),t.refPointTransform&&(t.refPointTransform=new o.LmvMatrix4(!0).copy(t.refPointTransform)),t.placementTransform&&(t.placementTransform=new o.LmvMatrix4(!0).copy(t.placementTransform)),t.placementWithOffset&&(t.placementWithOffset=new o.LmvMatrix4(!0).copy(t.placementWithOffset)),t.cameras)for(l=0;l<t.cameras.length;l++)(c=t.cameras[l]).position=(new v.Vector3).copy(c.position),c.target=(new v.Vector3).copy(c.target),c.up=(new v.Vector3).copy(c.up),isFinite(c.position.x+c.position.y+c.position.z+c.target.x+c.target.y+c.target.z+c.up.x+c.up.y+c.up.z)||(c.target=t.bbox.getCenter(new v.Vector3),c.position.copy(c.target),c.position.z+=t.bbox.max.z-t.bbox.min.z,c.up={x:0,y:1,z:0}),isFinite(c.aspect)||(c.aspect=1),isFinite(c.fov)||(c.fov=90),isFinite(c.orthoScale)||(c.orthoScale=1);r.logger.log("scene bounds: "+JSON.stringify(t.bbox)),u={category:"metadata_load_stats",urn:t.urn,has_topology:!!t.topologyPath,has_animations:!!t.animations,cameras:t.cameras?t.cameras.length:0,lights:t.lights?t.lights.length:0,materials:s,is_mobile:(0,i.isMobileDevice)()},r.logger.track(u),this.viewer3DImpl.signalProgress(5,_.ProgressState.ROOT_LOADED,this.model),this.viewer3DImpl.invalidate(!1,!1);case 31:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),M.prototype.convertMaterials=function(){var e=E(regeneratorRuntime.mark((function e(t){var n,i,r,o,a,s,l,c,h,d,p,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.viewer3DImpl.matman(),i=t.getData(),r=0,i.materials){e.next=5;break}return e.abrupt("return",r);case 5:if(!i.gltfMaterials){e.next=9;break}for(o in a=i.materials.materials)s=a[o],l=u.MaterialConverter.convertMaterialGltf(s,i),c=n._getMaterialHash(t,o),n.addMaterial(c,l,!1),r++;return e.abrupt("return",r);case 9:h=i.materials.materials,d=i.proteinMaterials?i.proteinMaterials.materials:null,e.t0=regeneratorRuntime.keys(h);case 12:if((e.t1=e.t0()).done){e.next=21;break}return o=e.t1.value,p=d&&d[o]&&u.MaterialConverter.isPrismMaterial(d[o]),f=p?d[o]:h[o],e.next=18,n.convertOneMaterial(t,f,n._getMaterialHash(t,o));case 18:r++,e.next=12;break;case 21:return e.abrupt("return",r);case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),M.prototype.makeBVH=function(e){var t=performance.now(),n=e.materials?e.materials.materials:null;e.bvh=new s.BVHBuilder(e.fragments,n),e.bvh.build(this.options.bvhOptions||{isWeakDevice:(0,i.isMobileDevice)()});var o=performance.now();r.logger.log("BVH build time: "+(o-t))},M.prototype.onGeomLoadDone=function(){this.svf.loadDone=!0,p.TextureLoader.loadModelTextures(this.model,this.viewer3DImpl),this.svf.fragments.entityIndexes=null,this.svf.fragments.mesh2frag=null,this.svf.fragments.visibilityFlags=null;var e=Date.now(),t="Fragments load time: "+(e-this.t1);this.loadTime+=e-this.t0;var n=this.firstPixelTimestamp-this.t0;t+=" (first pixel time: "+n+")",this.svf.bvh&&!this.svf.placementTransform||(this.makeBVH(this.svf),this.model.setBVH(this.svf.bvh.nodes,this.svf.bvh.primitives,this.options.bvhOptions)),r.logger.log(t),this.options.useConsolidation&&this.viewer3DImpl.consolidateModel(this.model,this.options.consolidationMemoryLimit);var i={category:"model_load_stats",is_f2d:!1,has_prism:this.viewer3DImpl.matman().hasPrism,load_time:this.loadTime,geometry_size:this.model.getGeometryList().geomMemory,meshes_count:this.model.getGeometryList().geoms.length,fragments_count:this.model.getFragmentList().getCount(),urn:this.svfUrn};n>0&&(i.first_pixel_time=n),r.logger.track(i,!0);var o=this.model.getGeometryList(),a={load_time:this.loadTime,polygons:o.geomPolyCount,fragments:this.model.getFragmentList().getCount(),mem_usage:o.gpuMeshMemory,viewable_type:"3d"};S.analytics.track("viewer.model.loaded",a),this.currentLoadPath=null,this.viewer3DImpl.onLoadComplete(this.model)},M.prototype.loadPropertyDb=function(){this.svf.propDbLoader=new d.PropDbLoader(this.sharedDbPath,this.model,this.viewer3DImpl.api),this.svf.propDbLoader.load()},M.prototype.fetchTopologyFile=function(e,t){if(!this.fetchingTopology){this.fetchingTopology=!0;var n=this.createWorkerWithIntercept();n.addEventListenerWithIntercept((function(e){if(e.data["status-topology"])return i=(new Date).getTime(),a=Math.round((i-l)/1e3),void r.logger.log("Topology file downloaded. ("+a+" seconds). Processing...");var s=e.data["fetch-topology"];s&&(o=(new Date).getTime(),a=Math.round((o-i)/1e3),s.topology?r.logger.log("Topology file processed successfully! ("+a+" seconds)."):r.logger.log("Topology file processed, but an error ocurred. ("+a+" seconds)."),t(s),c.fetchingTopology=!1,n.clearAllEventListenerWithIntercept(),n.terminate(),n=null)}));var i,o,a,s={path:e,queryParams:this.queryParams},l=(new Date).getTime();r.logger.log("Fetching topology file..."),s.operation="FETCH_TOPOLOGY",n.doOperation((0,b.initLoadContext)(s));var c=this}},M.prototype.is3d=function(){return!0},y.FileLoaderManager.registerFileLoader("svf",["svf"],M)},50005:(e,t,n)=>{"use strict";n.r(t),n.d(t,{TextureLoader:()=>M});var i=n(57601),r=n(84998),o=n(79659),a=n(88715),s=n(4388),l=n(98926),c=n(16453),u=n(90050),h=n(58964),d=n(79916),p=(0,r.getGlobal)(),f=p.document,m=new d;m.max=(0,r.isMobileDevice)()?4:6;var g=0,v=(0,r.isMobileDevice)()?32:1/0;v*=1048576;var y=0,b=1/0,_=function(e,t,n,i){(new c.TextureLoader).load(e,n,void 0,i).mapping=t};function x(e,t,n,a,s,d,v){var y=h.endpoint.getUseCredentials(),x=h.endpoint.getUseCookie();y&&x?c.ImageUtils.crossOrigin="use-credentials":h.endpoint.getUseCredentials()?c.ImageUtils.crossOrigin="anonymous":c.ImageUtils.crossOrigin="";var E="";y&&s&&(E="acmsession="+s),v&&v.queryParams&&(E=E?E+"&":"",E+=v.queryParams);var w=h.endpoint.initLoadContext({queryParams:E});g++,m.go((function(s){var h=function(e,t){g--,t&&a?a(t):n(e),s()},m=d?h:function(e){function t(t){e&&(e.image=t),g--,n(e),s()}e&&e.image?function(e,t){var n,i,r=e.width,a=e.height;if(0==(r&r-1)&&0==(a&a-1)){if(r*a<=b)return void t(e);n=r,i=a}else{for(n=1;1.5*n<r;)n*=2;for(i=1;1.5*i<a;)i*=2}for(;n*i>b;)n=Math.max(n/2,1),i=Math.max(i/2,1);var s=f.createElement("canvas"),c=s.getContext("2d");s.width=n,s.height=i,c.drawImage(e,0,0,n,i);var u=new Image;u.src=s.toDataURL(),u.onload=function(){t(u)},u.onerror=function(e){l.logger.error(e,(0,o.errorCodeString)(o.ErrorCodes.UNKNOWN_FAILURE)),t(null)}}(e.image,t):t()},E=function(e){g--,l.logger.error("Texture load error",e),n(null),s()};if((0,r.isNodeJS)())!function(e,t,n,r,a){var s=new c.DataTexture(void 0,n);function u(e){a&&a.extractImage&&(e=a.extractImage(e)),s.image={data:e,width:void 0,height:void 0},s.needsUpdate=!0,r&&r(s)}function h(e,t){var n="Error: "+e+" ("+t+")";l.logger.error(n,(0,o.errorCodeString)(o.ErrorCodes.NETWORK_SERVER_ERROR)),r&&r(null,{msg:t,args:e})}i.ViewingService.getItem(t,e,u,h)}(e,w,t,h,v);else if(".dds"===e.slice(e.length-4).toLocaleLowerCase())if((0,r.isIOSDevice)()){var S=e.slice(0,e.length-4)+".pvr";(new PVRLoader).load(S+"?"+w.queryParams,h,E)}else(new u.DDSLoader).load(e+"?"+w.queryParams,h,E);else if(y&&!x||v&&(v.rawData||v.extractImage))!function(e,t,n,r,a){var s=new c.Texture(void 0,n);function u(e){a&&a.extractImage&&(e=a.extractImage(e));var t,n,i=new Image;s.image=i,i.onload=function(){s.needsUpdate=!0,r&&r(s),p.URL.revokeObjectURL(i.src)},i.onerror=function(e){l.logger.error(e,(0,o.errorCodeString)(o.ErrorCodes.UNKNOWN_FAILURE)),r&&r(null)},i.src=(t=new Uint8Array(e),n=new Blob([t],{type:"image/jpeg"}),(p.URL||p.webkitURL).createObjectURL(n))}function h(e,t){var n="Error: "+e+" ("+t+")";l.logger.error(n,(0,o.errorCodeString)(o.ErrorCodes.NETWORK_SERVER_ERROR)),r&&r(null,{msg:t,args:e})}a&&a.rawData?u(a.rawData):i.ViewingService.getItem(t,e,u,h,a)}(e,w,t,m,v);else if(/^data:/.test(e))_(e,t,m,E);else{/(\w+):\/\//gi.exec(e)&&!/^(https?|file|blob:\w+):\/\//gi.test(e)?Autodesk.Viewing.Private.ViewingService.rawGet("","",e,(function(n){var i=/\.(\w+)$/gi.exec(e);i=i?i[1]:"png";var r,o,a="data:image/".concat(i,";base64, ")+(r=n,o=Array.prototype.map.call(r,(function(e){return String.fromCharCode(e)})).join(""),btoa(o));_(a,t,m,E)}),console.error):_(w.queryParams?e+"?"+w.queryParams:e,t,m,E)}}))}function E(e,t,n){var r=t.getData();if(e.startsWith("embed:"))var o=r.loadedBuffers[e.charAt(e.length-1)];else{e=e.replace(/\\/g,"/");o=t.isOTG()?function(e){var t=h.endpoint.initLoadContext({});return r.makeSharedResourcePath(t.otg_cdn,"textures",e)}(e):function(e){for(var t=null,n=0;n<r.manifest.assets.length;++n){var o=r.manifest.assets[n];if(o.id.toLowerCase()==e.toLowerCase()){var a=o.URI;-1===a.indexOf("://")&&(a=r.basePath+a),t=(0,i.pathToURL)(a);break}}return t||(t=(0,i.pathToURL)(r.basePath+e)),t}(e)}return x(o,c.UVMapping,n,null,r.acmSessionId)}function w(e,t,n){if(t.textureMaps&&!t.texturesLoaded){t.texturesLoaded=!0;var i=e.getData(),r=t.textureMaps;for(var o in r){var s=r[o];if(!n.matman().loadTextureFromCache(e,t,s,o))E(s.uri,e,function(t){return function(r){if(r){var o=i.materials.scene.SceneUnit,s=n.renderer()?n.renderer().getMaxAnisotropy():0;(t.converter||a.MaterialConverter.convertTexture)(t,r,o,s)}var l=n.matman();l&&(l.setTextureInCache(e,t,r),i.loadOptions.onTextureReceived&&i.loadOptions.onTextureReceived(l,t,r,!S()),!S()&&n&&i.loadDone&&!i.texLoadDone&&(i.texLoadDone=!0,n.onTextureLoadComplete(e)))}}(s))}}}function S(){return g}function A(e){e>=0&&(y=e,b=Math.max(16384,v/(4*y)))}var M={loadTextureWithSecurity:x,loadMaterialTextures:w,loadModelTextures:function(e,t){var n=t.matman(),i=n._getModelHash(e),r=0;if(e.isOTG())r=e.getData().metadata.stats.num_textures||0;else for(var o in n._materials){if(-1!==o.indexOf(i))(a=n._materials[o]).textureMaps&&(r+=Object.keys(a.textureMaps).length)}for(var o in A(r),n._materials){var a;if(-1!==o.indexOf(i))w(e,a=n._materials[o],t)}var s=e.getData();!S()&&t&&s.loadDone&&!s.texLoadDone&&(s.texLoadDone=!0,t.onTextureLoadComplete(e))},loadCubeMap:function(e,t,n){var i,r=function(i){i?(i.mapping=c.CubeReflectionMapping,i.LogLuv=-1!==e.indexOf("logluv"),i.RGBM=-1!==e.indexOf("rgbm"),(0,s.DecodeEnvMap)(i,t,!1,n)):n&&n(i)};return c.ImageUtils.crossOrigin="",Array.isArray(e)?(i=c.ImageUtils.loadTextureCube(e,c.CubeReflectionMapping,r)).format=c.RGBFormat:"string"==typeof e?-1!==e.toLowerCase().indexOf(".dds")?i=(new u.DDSLoader).load(e,r):(i=_(e,c.SphericalReflectionMapping,n)).format=c.RGBFormat:e?n&&n(e):n&&n(null),i},requestsInProgress:S,calculateTextureSize:function(e){var t=4;switch(e.format){case c.AlphaFormat:t=1;break;case c.RGBFormat:t=3;break;case c.LuminanceFormat:t=1;break;case c.LuminanceAlphaFormat:t=2}switch(e.type){case c.ShortType:case c.UnsignedShortType:case c.HalfFloatType:t*=2;break;case c.IntType:case c.UnsignedIntType:case c.FloatType:t*=4;break;case c.UnsignedShort4444Type:case c.UnsignedShort5551Type:case c.UnsignedShort565Type:t=2}var n=t*e.image.width;return n+=e.unpackAlignment-1,n-=n%e.unpackAlignment,e.image.height*n},imageToCanvas:function(e,t,n){var i=e.width,r=e.height,o=f.createElement("canvas"),a=o.getContext("2d");return a.globalCompositeOperation="copy",o.width=i,o.height=r,t&&(a.fillStyle=n||"#FFFFFF",a.fillRect(0,0,i,r)),a.drawImage(e,0,0,i,r),o}}},58092:(e,t,n)=>{var i=n(84998),r=i.isNodeJS,o=i.getGlobal,a=n(17167).getResourceUrl;r()?function(){var t=n(15523).MainWorker;function i(){return new t}e.exports={createWorker:i,initWorkerScript:function(e,t){e&&e()},createWorkerWithIntercept:function(){return i()}}}():function(){var t=Autodesk.Viewing.Private,n=t.LMV_WORKER_URL||"src/file-loaders/workers/MainWorker-web.js",i=null,r=!1,s=[];function l(e){var r;return(r=t.ENABLE_INLINE_WORKER?new Worker(i):new Worker(a(n))).doOperation=r.postMessage,!0===e&&t.ViewingService.forwardProtocolHandlerToWorker(r),r}e.exports={createWorker:l,initWorkerScript:function(e,l){if(t.ENABLE_INLINE_WORKER&&!i){if(s.push({successCB:e}),!r){var c=new XMLHttpRequest,u=n,h=a(n);h&&(u=h),c.open("GET",u,!0),c.withCredentials=!1,c.onload=function(){var e,t=o();r=!1,t.URL=t.URL||t.webkitURL;try{e=new Blob([c.responseText],{type:"application/javascript"})}catch(t){var n=new BlobBuilder;n.append(c.responseText),e=n.getBlob()}i=URL.createObjectURL(e);var a=s.concat();s=[];for(var l=0;l<a.length;++l)a[l].successCB&&a[l].successCB()},r=!0,c.send()}var d={cancel:function(){var t=-1;return!!s.some((function(n,i){return n.successCB==e&&(t=i,!0)}))&&(s.splice(t,1),!0)}};return d}return e&&e(),null},createWorkerWithIntercept:function(e){var t=l(e);t.checkEvent=function(e){return!(!e.data||!e.data.assetRequest)};var n=[];return t.addEventListenerWithIntercept=function(e){var i=function(n){t.checkEvent(n)||e(n)};return n||(n=[]),n.push({arg:e,callback:i}),t.addEventListener("message",i,!1),i},t.removeEventListenerWithIntercept=function(e){var i=function(e){if(!n)return null;for(var t=0;t<n.length;++t)if(n[t].arg===e){var i=n[t].callback;return n.splice(t,1),0===n.length&&(n=null),i}return null}(e);i&&t.removeEventListener("message",i,!1)},t.clearAllEventListenerWithIntercept=function(){if(n)for(var e=n.concat(),i=0;i<e.length;++i)t.removeEventListenerWithIntercept(e[i].arg)},t},clearWorkerDataURL:function(){i=null}}}()},62066:(e,t,n)=>{"use strict";n.r(t),n.d(t,{loadWasmWorker:()=>o});var i=n(17167).getResourceUrl,r=n(84998).getGlobal;function o(e){var t={},n=i("wasm.worker.js");return new Promise((function(t,a){var s,l;(s=n,l=Autodesk.Viewing.Private,new Promise((function(e){if(l.ENABLE_INLINE_WORKER){var t=new XMLHttpRequest;t.open("GET",s,!0),t.withCredentials=!1,t.onload=function(){var n,i=r();i.URL=i.URL||i.webkitURL;try{n=new Blob([t.responseText],{type:"application/javascript"})}catch(e){var o=new BlobBuilder;o.append(t.responseText),n=o.getBlob()}e(URL.createObjectURL(n))},t.send()}else e(s)}))).then((function(n){var r=new Worker(n),s={},l=i(e);r.postMessage({eventType:"INITIALIZE",eventData:l}),r.addEventListener("message",(function(e){if("INITIALIZED"===e.data.eventType){e.data.eventData.forEach((function(e){s[e]=function(){var t=arguments;return o(e,r,(function(n){n.postMessage({eventData:{method:e,arguments:Array.from(t)}})}))}}));var n="getBuffer";return s[n]=function(){return o(n,r,(function(e){e.postMessage({eventType:"GET_BUFFER"})}))},void t(s)}})),r.addEventListener("error",(function(e){a(e)}))}))}));function o(e,n,i){return new Promise((function(r,o){var a=function(e,n){var i,r;t&&t.hasOwnProperty(e)?r=(i=t[e][0]).inUse:(t[e]=[],r=!0);r&&(i={channel:new MessageChannel,inUse:!1},t[e].push(i),n.postMessage({eventType:"SET_CHANNEL_PORT",eventData:{method:e,port:i.channel.port2}},[i.channel.port2]));return i}(e,n),s=a.channel;a.inUse=!0,i(s.port1),s.port1.onmessage=function(n){a.inUse=!1;var i=n.data.eventType,s=n.data.eventData;"ERROR"===i?o(s):r(s),function(e,t){for(var n=1;n<t.length;n++){if(t[n].channel===e.channel)return t.splice(n,1),!0}}(a,t[e])}}))}}},79659:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ErrorCodes:()=>i,errorCodeString:()=>r,getErrorCode:()=>o});var i={UNKNOWN_FAILURE:1,BAD_DATA:2,NETWORK_FAILURE:3,NETWORK_ACCESS_DENIED:4,NETWORK_FILE_NOT_FOUND:5,NETWORK_SERVER_ERROR:6,NETWORK_UNHANDLED_RESPONSE_CODE:7,BROWSER_WEBGL_NOT_SUPPORTED:8,BAD_DATA_NO_VIEWABLE_CONTENT:9,BROWSER_WEBGL_DISABLED:10,BAD_DATA_MODEL_IS_EMPTY:11,RTC_ERROR:12,UNSUPORTED_FILE_EXTENSION:13,VIEWER_INTERNAL_ERROR:14,WEBGL_LOST_CONTEXT:15,LOAD_CANCELED:16};function r(e){return"ErrorCode:"+e+"."}function o(e){return 403===e||401===e?i.NETWORK_ACCESS_DENIED:404===e?i.NETWORK_FILE_NOT_FOUND:e>=500?i.NETWORK_SERVER_ERROR:i.NETWORK_UNHANDLED_RESPONSE_CODE}},57601:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ViewingService:()=>w,pathToURL:()=>M,textToArrayBuffer:()=>T});n(82526),n(41817),n(72443),n(92401),n(8722),n(32165),n(69007),n(83510),n(41840),n(6982),n(32159),n(96649),n(39341),n(60543),n(92222),n(50545),n(26541),n(43290),n(57327),n(69826),n(34553),n(84944),n(86535),n(89554),n(91038),n(26699),n(82772),n(66992),n(69600),n(94986),n(21249),n(26572),n(85827),n(96644),n(47042),n(5212),n(2707),n(38706),n(40561),n(33792),n(99244),n(18264),n(96078),n(4855),n(68309),n(73706),n(51532),n(99752),n(82376),n(73181),n(23484),n(2388),n(88621),n(60403),n(84755),n(25438),n(90332),n(40658),n(40197),n(44914),n(52420),n(60160),n(60970),n(10408),n(73689),n(9653),n(93299),n(35192),n(33161),n(44048),n(78285),n(44363),n(55994),n(61874),n(9494),n(56977),n(19601),n(59595),n(35500),n(69720),n(43371),n(38559),n(38880),n(49337),n(36210),n(30489),n(43304),n(41825),n(98410),n(72200),n(47941),n(94869),n(33952),n(57227),n(60514),n(68304),n(41539),n(26833),n(54678),n(91058),n(88674),n(17727),n(36535),n(12419),n(69596),n(52586),n(74819),n(95683),n(39361),n(51037),n(5898),n(67556),n(14361),n(83593),n(39532),n(24603),n(74916),n(92087),n(39714),n(70189),n(79841),n(27852),n(94953),n(32023),n(78783),n(4723),n(66528),n(83112),n(38992),n(82481),n(15306),n(64765),n(23123),n(23157),n(73210),n(48702),n(55674),n(15218),n(74475),n(57929),n(50915),n(29253),n(42125),n(78830),n(58734),n(29254),n(37268),n(7397),n(60086),n(80623),n(44197),n(76495),n(87145),n(35109),n(65125),n(82472),n(49743),n(8255),n(29135),n(92990),n(18927),n(33105),n(35035),n(74345),n(7174),n(32846),n(98145),n(44731),n(77209),n(96319),n(58867),n(37789),n(33739),n(95206),n(29368),n(14483),n(12056),n(3462),n(30678),n(27462),n(33824),n(55021),n(12974),n(15016),n(4129),n(38478),n(8628),n(83475),n(46273),n(51568),n(26349),n(65743),n(10072),n(99137),n(71957),n(96306),n(103),n(8582),n(90618),n(74592),n(88440),n(58276),n(35082),n(12813),n(18222),n(24838),n(38563),n(50336),n(7512),n(46603),n(70100),n(10490),n(13187),n(60092),n(19041),n(30666),n(51638),n(62975),n(15728),n(46056),n(44299),n(5162),n(50292),n(1025),n(97314),n(96290),n(77479),n(34582),n(47896),n(12647),n(98558),n(84018),n(97507),n(61605),n(49076),n(34999),n(88921),n(96248),n(13599),n(11477),n(64362),n(15389),n(46006),n(90401),n(45164),n(91238),n(54837),n(87485),n(56767),n(69916),n(76651),n(61437),n(35285),n(39865),n(86035),n(67501),n(13728),n(27207),n(21568),n(48824),n(44130),n(78206),n(76478),n(79715),n(43561),n(32049),n(86020),n(56585),n(54747),n(33948),n(84633),n(85844),n(60285),n(83753),n(41637),n(35666);var i=n(98926),r=n(79659),o=n(7913),a=n(58964),s=n(84998),l=n(24414);function c(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var f,m,g,v,y,b,_,x,E=n(99591),w={WORKER_REGISTER_FILE_PORT:"REGISTER_FILE_PORT",WORKER_READ_FILE:"READ_FILE"},S=!1;function A(e){var t=e.split("/");if(0==t.length)return e;for(var n=[],i=0;i<t.length;++i){var r=t[i];"."!==r&&(".."===r&&n.length?n.pop():n.push(r))}return 0==n.length?"":n.join("/")}function M(e,t){if(-1!==e.indexOf("://")||0===e.indexOf("urn:"))return e;if(t)return t+e;if("undefined"==typeof window)return e;var n=(0,s.getGlobal)(),i=n.location.pathname,r=i.lastIndexOf("/");return i=i.substr(0,r+1),n.location.protocol+"//"+n.location.host+i+e}function T(e,t){for(var n=e.length-t,i=new ArrayBuffer(n),r=new Uint8Array(i,0),o=0,a=t;o<n;o++,a++)r[o]=255&e.charCodeAt(a);return r}function C(e,t){return-1===t.indexOf("file://")&&(-1!==t.indexOf("://")||(!!e||void 0))}if(w.simplifyPath=A,w.OSS_PREFIX="urn:adsk.objects:os.object:",w.generateUrl=function(e,t,n,i,r,o){if(n=n||"",(0,s.isNodeJS)()&&!C(e,n))return n;var l=(n=A(n)).indexOf("urn:"),c=n.indexOf("?");if(n=-1!=l?-1!==c?n.slice(0,l)+encodeURIComponent(n.slice(l,c))+n.slice(c):n.slice(0,l)+encodeURIComponent(n.slice(l)):encodeURI(n),r&&w.isOSSUrl(n)){var u=n.indexOf("/objects/")+9,h=n.substring(u);n=n.substring(0,u)+encodeURIComponent(h)}if(!t||0!==decodeURIComponent(n).indexOf("urn:"))return C(null,n)?n:e+n;switch("items"!==t&&(n=n.substr(6)),t){case"items":return a.endpoint.getItemApi(e,n,i);case"bubbles":return a.endpoint.getManifestApi(e,n,i);case"thumbnails":return a.endpoint.getThumbnailApi(e,n,i);case"properties":return a.endpoint.getPropertyQueryApi(e,n,i,o)}},(0,s.isNodeJS)())f=n(74617),m=n(78322),g=n(80959),v=n(75725),y=n(8575),b=new g.Agent({keepAlive:!0,keepAliveMsecs:100,maxSockets:10}),_=new v.Agent({keepAlive:!0,keepAliveMsecs:100,maxSockets:10}),x=new g.Agent({maxSockets:10}),w.rawGet=function(e,t,n,o,a,s){if(s=s||{},C(e,n=w.generateUrl(e,t,n,void 0,s.escapeOssObjects))){if(s.queryParams){var l=-1===n.indexOf("?")?"?":"&";n=n+l+s.queryParams}var c=y.parse(n),u={host:c.hostname,port:c.port,method:s.method||"GET",path:c.path,headers:{},retryCount:0,agent:"https:"===c.protocol?b:_};if(u.host.endsWith(".api.autodesk.com")&&(u.path.startsWith("/derivativeservice")||u.path.startsWith("/modelderivative"))&&(u.agent=x),s.headers)for(var h in s.headers)u.headers[h]=s.headers[h];u.headers["accept-encoding"]||(u.headers["accept-encoding"]="gzip, deflate"),s.range&&(u.headers.Range="bytes="+s.range.min+"-"+s.range.max),(s.ondata||s.onprogress)&&(s.responseType="arraybuffer");var d=("https:"===c.protocol?g:v).request(u,(function(e){var t=!(e.statusCode>=200&&e.statusCode<400),l=e;t||!function(e,t){return!!("gzip"===e.headers["content-encoding"]||t.endsWith(".json.gz")||t.endsWith("FragmentList.pack")||t.endsWith("LightList.bin")||t.endsWith("CameraList.bin")||t.endsWith("CameraDefinitions.bin")||t.endsWith("LightDefinitions.bin"))}(e,c.pathname)||s.skipDecompress||(l=e.pipe(m.createGunzip())),"json"!==s.responseType&&"text"!==s.responseType&&s.responseType||l.setEncoding("utf8");var u=[],h=Buffer.allocUnsafe(65536),p=0;l.on("data",(function(e){if(s.onprogress){if(e.length+p>h.length){var t=Buffer.allocUnsafe(0|Math.ceil(1.5*h.length));h.copy(t,0,0,p),h=t}return e.copy(h,p,0,e.length),p+=e.length,void(s.onprogress(h,p)&&d.abort())}u.push(e),s.ondata&&s.ondata(e)})),l.on("end",(function(){if(e.statusCode>=200&&e.statusCode<400){if("json"===s.responseType){var t=JSON.parse(u.join(""));return void o(t)}if("text"===s.responseType||""===s.responseType){var l=u.join("");return void o(l)}var c=s.onprogress?h:Buffer.concat(u);if(!s.skipDecompress&&31===c[0]&&139===c[1]){i.logger.warn("An LMV resource ("+n+") was double compressed, or Content-Encoding header missing");try{c=m.gunzipSync(c),p=c.length}catch(e){a(r.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:n,exception:e.toString(),stack:e.stack})}}200===d.status&&s.range&&(c=new Uint8Array(c,s.range.min,s.range.max-s.range.min)),o(c,p)}else a&&a(e.statusCode,e.statusMessage,{url:n})}))}));d.on("error",(function(e){a&&a(e.code,e.message,{url:n})})),s.postData&&d.write(s.postData),d.end()}else!function(e,t,n,i){function r(e){if("json"===i.responseType)try{return JSON.parse(e.toString("utf8"))}catch(e){n(e)}return e}0===e.indexOf("file://")&&(e=e.substr(7)),f.readFile(e,(function(o,a){o?n(0,0,{httpStatusText:o,url:e}):31===a[0]&&139===a[1]?m.gunzip(a,null,(function(o,a){o?n(0,0,{httpStatusText:o,url:e}):(a=r(a),i.ondata&&i.ondata(a),t(a))})):(a=r(a),i.ondata&&i.ondata(a),t(a))}))}(n,o,a,s)};else{var P=new(n(79916));P.max=25;var L={},R={},D={};w.registerProtocolPort=function(e,t){/^(http(s)?|file):/gi.test(e)?console.warn("http(s) or file protocol were not allowed to be handled"):t?(L[e]=t,t.onmessage=function(e){var t=e.data.url;if(R[t]){var n=R[t];if(e.data.error)n.onFailureWrapped(r.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:t,exception:e.data.error.message,stack:e.data.error.stack});else{var i=e.data.buffer;if(R[t]=void 0,31===i[0]&&139===i[1]&&t.match(/(.f2d|.gz)$/gi))try{i=E.ungzip(i),n.options&&n.options.ondata&&n.options.ondata(i),n.onSuccessWrapped(i)}catch(e){n.onFailureWrapped(r.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:t,exception:e.toString(),stack:e.stack})}else n.onSuccessWrapped(i)}}else if(D[t]){var o=[];e.data&&e.data.buffer&&e.data.buffer.buffer instanceof ArrayBuffer&&o.push(e.data.buffer.buffer),D[t].postMessage(e.data,o),D[t]=void 0}}):L[e]&&L[e]instanceof MessagePort&&(L[e].onmessage=void 0,L[e]=void 0)},w.handlerProtocol=function(e,t,n,i,r){var o=L[e];R[t]={onSuccessWrapped:n,onFailureWrapped:i,options:r},o.postMessage({operation:w.WORKER_READ_FILE,url:t})},w.forwardProtocolHandlerToWorker=function(e){var t={},n=new MessageChannel;for(var i in n.port1.onmessage=function(e){var t=new URL(e.data.url);L[t.protocol].postMessage(e.data),D[t]=n.port1},L)L[i]instanceof MessagePort&&(t[i]=n.port2);e.doOperation({operation:w.WORKER_REGISTER_FILE_PORT,protocolPortMap:t},[n.port2])},w.rawGet=function(e,t,n,i,r,o){P.go((function(a){var s=function(){a();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r&&r.apply(r,t)},l=function(){a();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i&&i.apply(i,t)},c=/^(\w+:)\/\//gi.exec(n);c&&2==c.length&&L[c[1]]?w.handlerProtocol(c[1],n,l,s,o):w._rawGet(e,t,n,l,(function(){var i=arguments.length<=0?void 0:arguments[0],r=((null==o?void 0:o.method)||((null==o?void 0:o.noBody)?"HEAD":"GET")).toLowerCase(),a="get"===r&&(429===i||i>=500);if(a){var c=arguments.length<=3?void 0:arguments[3],u=100,d=(429===i||503===i)&&(null==c?void 0:c.getResponseHeader("Retry-After"));if(d){var p=Number(d);u=(u=!isNaN(p)&&1e3*p||Date.parse(d)-(new Date).getTime())>100?u:100}w._retryRequest(e,t,n,o,u).then((function(e){return l.apply(void 0,h(e))})).catch((function(e){return s.apply(void 0,h(e))}))}else s.apply(void 0,arguments)}),o)}))},w._retryRequest=function(e,t,n,r,o){var a={delayFirstAttempt:!0,startingDelay:o,numOfAttempts:4,retry:function(e,t){var n=u(e,3),r=n[0],o=n[1],a=n[2].url;return i.logger.warn("request ".concat(a," failed with status ").concat(r," ").concat(o,". Attempt ").concat(t)),!0},timeMultiple:5};return(0,l.backOff)((function(){return new Promise((function(i,o){w._rawGet(e,t,n,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i(t)}),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o(t)}),r)}))}),a)},w.isOSSUrl=function(e){return!!e&&-1!==e.indexOf("/oss/v2/buckets")},w.getSignedS3DownloadUrl=function(e){return new Promise((function(t){var n=e.indexOf("?acmsession=");-1!==n&&(e=e.substring(0,n)),e+="/signeds3download?useCdn=true";var i=new XMLHttpRequest;i.open("GET",e),i.setRequestHeader("Authorization",a.endpoint.HTTP_REQUEST_HEADERS.Authorization),i.responseType="json",i.send();var r=function(){t(null)};i.onload=function(e){var n=e.currentTarget.response;t(n.url)},i.onerror=r,i.ontimeout=r,i.onabort=r}))},w._rawGet=function(){var e,t=(e=regeneratorRuntime.mark((function e(t,n,a,s,l,c){var u,h,d,p,f,m,g,v,y,b;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v=function(e){if(p.status>=200&&p.status<400)if(p.response&&p.response instanceof ArrayBuffer){var t;if(t=200===p.status&&c.range?new Uint8Array(p.response,c.range.min,c.range.max-c.range.min):new Uint8Array(p.response),!c.skipDecompress&&31===t[0]&&139===t[1]){S||(S=!0,i.logger.warn("An LMV resource ("+a+") was not uncompressed by the browser. This hurts performance. Check the Content-Encoding header returned by the server and check whether you're getting double-compressed streams. The warning prints only once but it's likely the problem affects multiple resources."));try{t=E.ungzip(t)}catch(e){l(r.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:a,exception:e.toString(),stack:e.stack},p)}}s&&s(g(t))}else{var n=p.response;n||c.responseType&&"text"!==c.responseType||(n=p.responseText),s&&s(g(n))}else f(e)},g=function(e){if("json"===c.responseType)try{if(e instanceof Uint8Array)return(0,o.Up)(e);if("string"==typeof e)return JSON.parse(e)}catch(e){}return e},m=function(e){l&&l(p.status,"request was aborted",{url:a,aborted:!0},p)},f=function(e){l&&l(p.status,p.statusText,{url:a},p)},c=c||{},a=w.generateUrl(t,n,a,c.apiData,c.escapeOssObjects,c.guid),u=!1,!w.isOSSUrl(a)){e.next=12;break}return e.next=10,w.getSignedS3DownloadUrl(a);case 10:(h=e.sent)?(a=h,u=!0):console.warn("Failed getting signed URL - Fallback to direct OSS resource.");case 12:c.queryParams&&!u&&(d=-1===a.indexOf("?")?"?":"&",a=a+d+c.queryParams),p=new XMLHttpRequest;try{if(y=!c.hasOwnProperty("asynchronous")||c.asynchronous,p.open(c.method||(c.noBody?"HEAD":"GET"),a,y),c.hasOwnProperty("responseType")&&(p.responseType=c.responseType),c.range&&p.setRequestHeader("Range","bytes="+c.range.min+"-"+c.range.max),!u&&(p.withCredentials=!0,c.hasOwnProperty("withCredentials")&&(p.withCredentials=c.withCredentials),c.headers))for(b in c.headers)p.setRequestHeader(b,c.headers[b]),"authorization"===b.toLocaleLowerCase()&&(p.withCredentials=!1);y&&(p.onload=v,p.onerror=f,p.ontimeout=f,p.onabort=m,(c.ondata||c.onprogress)&&(p.overrideMimeType("text/plain; charset=x-user-defined"),c._dlProgress={streamOffset:0},p.onreadystatechange=function(){if(p.readyState>2&&200===p.status)if(c.ondata){var e=p.responseText;if(c._dlProgress.streamOffset>=e.length)return;var t=T(e,c._dlProgress.streamOffset);c._dlProgress.streamOffset=e.length,c.ondata(t)}else c.onprogress&&c.onprogress(p.responseText)&&p.abort()})),p.send(c.postData),y||v()}catch(e){l(p.status,p.statusText,{url:a,exception:e},p)}case 15:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function a(e){c(o,i,r,a,s,"next",e)}function s(e){c(o,i,r,a,s,"throw",e)}a(void 0)}))});return function(e,n,i,r,o,a){return t.apply(this,arguments)}}()}function I(e,t){t.hasOwnProperty("responseType")||(t.responseType="arraybuffer"),t.hasOwnProperty("withCredentials")||(t.withCredentials=!!e.auth),t.headers=e.headers,t.queryParams=e.queryParams,t.endpoint=e.endpoint,t.escapeOssObjects=e.escapeOssObjects}w.defaultFailureCallback=function(e,t,n){403==e?this.raiseError(r.ErrorCodes.NETWORK_ACCESS_DENIED,"Access denied to remote resource",{url:n.url,httpStatus:e,httpStatusText:t}):404==e?this.raiseError(r.ErrorCodes.NETWORK_FILE_NOT_FOUND,"Remote resource not found",{url:n.url,httpStatus:e,httpStatusText:t}):0===e&&n.aborted?this.raiseError(r.ErrorCodes.LOAD_CANCELED,"Request aborted",{url:n.url,httpStatus:e,httpStatusText:t}):e>=500&&e<600?this.raiseError(r.ErrorCodes.NETWORK_SERVER_ERROR,"Server error when accessing resource",{url:n.url,httpStatus:e,httpStatusText:t}):n.exception?this.raiseError(r.ErrorCodes.NETWORK_FAILURE,"Network failure",{url:n.url,exception:n.exception.toString(),stack:n.exception.stack}):this.raiseError(r.ErrorCodes.NETWORK_UNHANDLED_RESPONSE_CODE,"Unhandled response code from server",{url:n.url,httpStatus:e,httpStatusText:t,data:n})},w.getItem=function(e,t,n,i,r){if(I(e,r=r||{}),r.range&&!e.supportsRangeRequests){var o="start="+r.range.min+"&end="+r.range.max;r.queryParams?r.queryParams+="&"+o:r.queryParams=o,r.range=void 0}w.rawGet(e.endpoint,"items",t,n,i,r)},w.getManifest=function(e,t,n,i,r){(r=r||{}).hasOwnProperty("responseType")||(r.responseType="json"),I(e,r),w.rawGet(e.endpoint,"bubbles",t,n,i,r)},w.getProperties=function(e,t,n,i,r,o){var a={};I(e,a),a.responseType="json",a.guid=n,a.method="POST",a.postData=JSON.stringify(i),a.headers["Content-Type"]="application/json",a.headers.accept="application/json",a.headers["Access-Control-Allow-Origin"]="*",w.rawGet(e.endpoint,"properties",t,r,o,a)},w.getThumbnail=function(e,t,n,i,r){I(e,r=r||{});var o=r.queryParams||"",a=[];if(-1===o.indexOf("guid=")&&r.guid&&a.push("guid="+encodeURIComponent(r.guid)),-1===o.indexOf("role=")){var s=r.role||"rendered";a.push("role="+s)}if(-1===o.indexOf("width=")){var l=r.size||400;a.push("width="+l)}if(-1===o.indexOf("height=")){l=r.size||400;a.push("height="+l)}-1===o.indexOf("acmsession=")&&r.acmsession&&a.push("acmsession="+r.acmsession);var c=a.join("&");r.queryParams?r.queryParams=r.queryParams+"&"+c:r.queryParams=c,w.rawGet(e.endpoint,"thumbnails",t,n,i,r)},w.getACMSession=function(e,t,n,r){var o={numOfAttempts:4,timeMultiple:5,retry:function(e,t){return i.logger.warn("acmsession request failed. Attempt #".concat(t)),!0}};(0,l.backOff)((function(){return new Promise((function(n,i){w._getACMSession(e,t,n,i)}))}),o).then((function(){return n.apply(void 0,arguments)})).catch((function(){return r.apply(void 0,arguments)}))},w._getACMSession=function(e,t,n,i){var r,o={};for(var a in t)"oauth2AccessToken"===a?r=t[a]:-1!==a.indexOf("x-ads-acm")&&(o[a]=t[a]);o.application="autodesk";var s=new XMLHttpRequest;s.open("POST",e+"/oss-ext/v2/acmsessions",!0),s.setRequestHeader("Content-Type","application/json"),s.setRequestHeader("Authorization","Bearer "+r),s.responseType="json",s.onload=function(){if(200===s.status&&s.response){var e="string"==typeof s.response?JSON.parse(s.response):s.response;e&&e.acmsession?n(e.acmsession):i(s.status,"Can't get acm session from response.")}else i(s.status)},s.onerror=i,s.ontimeout=i,s.send(JSON.stringify(o)),delete o.application}},58964:(e,t,n)=>{"use strict";n.r(t),n.d(t,{getEnv:()=>g,setEnv:()=>v,isOffline:()=>b,setOffline:()=>_,setOfflineResourcePrefix:()=>E,getOfflineResourcePrefix:()=>w,endpoint:()=>S,initLoadContext:()=>A});var i=n(84998),r=n(17167),o=(0,i.getGlobal)(),a={},s=null;a.ENDPOINT_API_DERIVATIVE_SERVICE_V2="derivativeV2",a.ENDPOINT_API_MODEL_DERIVATIVE_V2="modelDerivativeV2",a.ENDPOINT_API_FLUENT="fluent",a.ENDPOINT_API_D3S="D3S",a.ENDPOINT_API_DERIVATIVE_STREAMING="streamingV2";var l,c={derivativeV2:{baseURL:"/derivativeservice/v2",itemURL:"/derivativeservice/v2/derivatives/:derivativeurn",manifestURL:"/derivativeservice/v2/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/thumbnails/:urn",propertyQueryURL:"/modelderivative/v2/designdata/:urn/metadata/:guid/properties:query"},derivativeV2_EU:{baseURL:"/derivativeservice/v2/regions/eu",itemURL:"/derivativeservice/v2/regions/eu/derivatives/:derivativeurn",manifestURL:"/derivativeservice/v2/regions/eu/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/regions/eu/thumbnails/:urn"},derivativeV2_Fedramp:{baseURL:"/derivativeservice/v2/regions/fedramp",itemURL:"/derivativeservice/v2/regions/fedramp/derivatives/:derivativeurn",manifestURL:"/derivativeservice/v2/regions/fedramp/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/regions/fedramp/thumbnails/:urn"},modelDerivativeV2:{baseURL:"/modelderivative/v2/",itemURL:"/modelderivative/v2/designdata/:urn/manifest/:derivativeurn",manifestURL:"/modelderivative/v2/designdata/:urn/manifest",thumbnailsURL:"/modelderivative/v2/designdata/:urn/thumbnail",propertyQueryURL:"/modelderivative/v2/designdata/:urn/metadata/:guid/properties:query"},fluent:{baseURL:"/modeldata",itemURL:"/modeldata/file/:derivativeurn",manifestURL:"/modeldata/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/thumbnails/:urn",cdnURL:"/cdn",cdnWS:"/cdnws"},D3S:{baseURL:"/modeldata",itemURL:"/modeldata/file/:derivativeurn",manifestURL:"/modeldata/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/thumbnails/:urn",cdnURL:"/cdn",cdnWS:"/cdnws"},D3S_EU:{baseURL:"/modeldata",itemURL:"/modeldata/file/:derivativeurn",manifestURL:"/modeldata/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/regions/eu/thumbnails/:urn",cdnURL:"/cdn",cdnWS:"/cdnws"},streamingV2:{baseURL:"/modeldata",itemURL:"/modeldata/file/:derivativeurn",manifestURL:"/modeldata/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/thumbnails/:urn",cdnURL:"/cdn",cdnWS:"/cdnws"},streamingV2_EU:{baseURL:"/regions/eu/modeldata",itemURL:"/regions/eu/modeldata/file/:derivativeurn",manifestURL:"/regions/eu/modeldata/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/regions/eu/thumbnails/:urn",cdnURL:"/regions/eu/cdn",cdnWS:"/regions/eu/cdnws"},streamingV2_Fedramp:{baseURL:"/regions/fedramp/modeldata",itemURL:"/regions/fedramp/modeldata/file/:derivativeurn",manifestURL:"/regions/fedramp/modeldata/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/regions/fedramp/thumbnails/:urn",cdnURL:"/regions/fedramp/cdn",cdnWS:"/regions/fedramp/cdnws"}},u="",h=a.ENDPOINT_API_DERIVATIVE_SERVICE_V2,d=!1,p=!1,f="",m=!1;function g(){return l}function v(e){l=e,e.startsWith("MD20")&&console.warn("env=".concat(e," is deprecated and will be removed in a future release. Use Autodesk{env}2 instead, where env=Development, Staging, or Production"))}a.HTTP_REQUEST_HEADERS={},a.queryParams={},a.setEndpointAndApi=function(e,t){e&&(u=e),t&&(h=t,t.startsWith("D3S")&&console.warn("api=".concat(t," is deprecated and will be removed in a future release. Use streamingV2 or streamingV2_EU (europe region) instead")))},a.getEndpointAndApi=function(){return u+c[h].baseURL},a.getApiEndpoint=function(){return u},a.getApiFlavor=function(){return h},a.getCdnUrl=function(){return s||(u?u+c[h].cdnURL:void 0)},a.getCdnWebSocketEndpoint=function(){return u+(c[h].cdnWS||"")},a.setCdnUrl=function(e){s=e},a.getCdnRedirectUrl=function(){var e=c[h].cdnRedirectURL;return e?u+e:null},a.setAcmSession=function(e){f=e},a.getAcmSession=function(){return f},a.getManifestApi=function(e,t,n){var i=e||u;return t=t||"",i=(i+=c[n=n||h].manifestURL).replace(":urn",t)},a.getItemApi=function(e,t,n){var i=n||h,r=(e||u)+c[i].itemURL;t=t||"";var o=decodeURIComponent(t);if(-1!==r.indexOf(":urn")){var s=o.split("/")[0]||"";s=(s=s.split(":"))[s.length-1]||"",r=r.replace(":urn",s)}return i===a.ENDPOINT_API_MODEL_DERIVATIVE_V2&&(t=encodeURIComponent(o)),r=r.replace(":derivativeurn",t)},a.getThumbnailApi=function(e,t,n){return((e||u)+c[n||h].thumbnailsURL).replace(":urn",t||"")},a.getPropertyQueryApi=function(e,t,n,i){var r=(e||u)+c[n||h].propertyQueryURL;return(r=r.replace(":urn",t||"")).replace(":guid",i||"")},a.getUseCredentials=function(){return d},a.getDomainParam=function(){return console.warn("getDomainParam is deprecated, switch to getQueryParams instead."),this.getUseCredentials()&&!(0,i.isNodeJS)()?"domain="+encodeURIComponent(o.location.origin):""},a.addQueryParam=function(e,t){this.queryParams[e]=t},a.deleteQueryParam=function(e){delete this.queryParams[e]},a.getQueryParams=function(e){var t=this.getUseCredentials()&&!(0,i.isNodeJS)()?"domain="+encodeURIComponent(o.location.origin):"";(0,r.getParameterByName)("bypassds")&&(t=t?t+"&bypassds=1":"bypassds=1");var n=[];for(var a in this.queryParams)n.push(encodeURIComponent(a)+"="+encodeURIComponent(this.queryParams[a]));return n.length&&(t?t+="&"+n.join("&"):t=n.join("&")),t&&e&&(e.queryParams?e.queryParams+="&"+t:e.queryParams=t),t},a.setUseCredentials=function(e){d=e},a.setUseCookie=function(e){p=e},a.getUseCookie=function(){return p},a.isOtgBackend=function(){return this.getApiFlavor()===this.ENDPOINT_API_FLUENT},a.isSVF2Backend=function(){var e=this.getApiFlavor();return e.startsWith(this.ENDPOINT_API_D3S)||e.startsWith(this.ENDPOINT_API_DERIVATIVE_STREAMING)},a.setEscapeOssObjects=function(e){m=e},a.getEscapeOssObjects=function(){return m},a.initLoadContext=function(e){for(var t in(e=e||{}).auth=this.getUseCredentials(),e.endpoint||(e.endpoint=this.getApiEndpoint()),e.api||(e.api=this.getApiFlavor()),e.headers||(e.headers={}),this.HTTP_REQUEST_HEADERS)e.headers[t]=this.HTTP_REQUEST_HEADERS[t];return e.api,this.ENDPOINT_API_FLUENT,this.getQueryParams(e),e.otg_cdn=s||this.getCdnUrl(),e.otg_ws=this.getCdnWebSocketEndpoint(),e.escapeOssObjects=this.getEscapeOssObjects(),e};var y=!1;function b(){return y}function _(e){y=e}var x="";function E(e){x=e}function w(){return x}var S=a,A=a.initLoadContext.bind(a)},41471:(e,t,n)=>{"use strict";n.r(t),n.d(t,{extendLocalization:()=>M,initializeLocalization:()=>C,setLanguage:()=>T});var i=n(84998),r=n(71224);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}var a=[],s=a.forEach,l=a.slice;function c(e){return s.call(l.call(arguments,1),(function(t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n])})),e}function u(){return"function"==typeof XMLHttpRequest||"object"===("undefined"==typeof XMLHttpRequest?"undefined":o(XMLHttpRequest))}var h,d,p,f=n(83154),m=n.t(f,2);function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}"function"==typeof fetch&&("undefined"!=typeof global&&global.fetch?h=global.fetch:"undefined"!=typeof window&&window.fetch&&(h=window.fetch)),u&&("undefined"!=typeof global&&global.XMLHttpRequest?d=global.XMLHttpRequest:"undefined"!=typeof window&&window.XMLHttpRequest&&(d=window.XMLHttpRequest)),"function"==typeof ActiveXObject&&("undefined"!=typeof global&&global.ActiveXObject?p=global.ActiveXObject:"undefined"!=typeof window&&window.ActiveXObject&&(p=window.ActiveXObject)),h||!m||d||p||(h=f||m),"function"!=typeof h&&(h=void 0);var v=function(e,t){if(t&&"object"===g(t)){var n="";for(var i in t)n+="&"+encodeURIComponent(i)+"="+encodeURIComponent(t[i]);if(!n)return e;e=e+(-1!==e.indexOf("?")?"&":"?")+n.slice(1)}return e};const y=function(e,t,n,i){return"function"==typeof n&&(i=n,n=void 0),i=i||function(){},h?function(e,t,n,i){e.queryStringParams&&(t=v(t,e.queryStringParams));var r=c({},"function"==typeof e.customHeaders?e.customHeaders():e.customHeaders);n&&(r["Content-Type"]="application/json"),h(t,c({method:n?"POST":"GET",body:n?e.stringify(n):void 0,headers:r},"function"==typeof e.requestOptions?e.requestOptions(n):e.requestOptions)).then((function(e){if(!e.ok)return i(e.statusText||"Error",{status:e.status});e.text().then((function(t){i(null,{status:e.status,data:t})})).catch(i)})).catch(i)}(e,t,n,i):u||"function"==typeof ActiveXObject?function(e,t,n,i){n&&"object"===g(n)&&(n=v("",n).slice(1)),e.queryStringParams&&(t=v(t,e.queryStringParams));try{var r;(r=d?new d:new p("MSXML2.XMLHTTP.3.0")).open(n?"POST":"GET",t,1),e.crossDomain||r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.withCredentials=!!e.withCredentials,n&&r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.overrideMimeType&&r.overrideMimeType("application/json");var o=e.customHeaders;if(o="function"==typeof o?o():o)for(var a in o)r.setRequestHeader(a,o[a]);r.onreadystatechange=function(){r.readyState>3&&i(r.status>=400?r.statusText:null,{status:r.status,data:r.responseText})},r.send(n)}catch(e){console&&console.log(e)}}(e,t,n,i):void 0};function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var x=function(){return{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",allowMultiLoading:!1,parse:function(e){return JSON.parse(e)},stringify:JSON.stringify,parsePayload:function(e,t,n){return function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t,n||"")},request:y,reloadInterval:"undefined"==typeof window&&36e5,customHeaders:{},queryStringParams:{},crossDomain:!1,withCredentials:!1,overrideMimeType:!1,requestOptions:{mode:"cors",credentials:"same-origin",cache:"default"}}},E=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};b(this,e),this.services=t,this.options=n,this.allOptions=i,this.type="backend",this.init(t,n,i)}var t,n,i;return t=e,n=[{key:"init",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.services=e,this.options=c(n,this.options||{},x()),this.allOptions=i,this.services&&this.options.reloadInterval&&setInterval((function(){return t.reload()}),this.options.reloadInterval)}},{key:"readMulti",value:function(e,t,n){this._readAny(e,e,t,t,n)}},{key:"read",value:function(e,t,n){this._readAny([e],e,[t],t,n)}},{key:"_readAny",value:function(e,t,n,i,r){var o,a=this,s=this.options.loadPath;"function"==typeof this.options.loadPath&&(s=this.options.loadPath(e,n)),(s=function(e){return!!e&&"function"==typeof e.then}(o=s)?o:Promise.resolve(o)).then((function(o){var s=a.services.interpolator.interpolate(o,{lng:e.join("+"),ns:n.join("+")});a.loadUrl(s,r,t,i)}))}},{key:"loadUrl",value:function(e,t,n,i){var r=this;this.options.request(this.options,e,void 0,(function(o,a){if(a&&(a.status>=500&&a.status<600||!a.status))return t("failed loading "+e+"; status code: "+a.status,!0);if(a&&a.status>=400&&a.status<500)return t("failed loading "+e+"; status code: "+a.status,!1);if(!a&&o&&o.message&&o.message.indexOf("Failed to fetch")>-1)return t("failed loading "+e+": "+o.message,!0);if(o)return t(o,!1);var s,l;try{s="string"==typeof a.data?r.options.parse(a.data,n,i):a.data}catch(t){l="failed parsing "+e+" to json"}if(l)return t(l,!1);t(null,s)}))}},{key:"create",value:function(e,t,n,i,r){var o=this;if(this.options.addPath){"string"==typeof e&&(e=[e]);var a=this.options.parsePayload(t,n,i),s=0,l=[],c=[];e.forEach((function(n){var i=o.options.addPath;"function"==typeof o.options.addPath&&(i=o.options.addPath(n,t));var u=o.services.interpolator.interpolate(i,{lng:n,ns:t});o.options.request(o.options,u,a,(function(t,n){s+=1,l.push(t),c.push(n),s===e.length&&r&&r(l,c)}))}))}}},{key:"reload",value:function(){var e=this,t=this.services,n=t.backendConnector,i=t.languageUtils,r=t.logger,o=n.language;if(!o||"cimode"!==o.toLowerCase()){var a=[],s=function(e){i.toResolveHierarchy(e).forEach((function(e){a.indexOf(e)<0&&a.push(e)}))};s(o),this.allOptions.preload&&this.allOptions.preload.forEach((function(e){return s(e)})),a.forEach((function(t){e.allOptions.ns.forEach((function(e){n.read(t,e,"read",null,null,(function(i,o){i&&r.warn("loading namespace ".concat(e," for language ").concat(t," failed"),i),!i&&o&&r.log("loaded namespace ".concat(e," for language ").concat(t),o),n.loaded("".concat(t,"|").concat(e),i,o)}))}))}))}}}],n&&_(t.prototype,n),i&&_(t,i),e}();E.type="backend";const w=E;var S=n(58660);function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}var M=function(e){return null!==e&&"object"===A(e)&&(Object.keys(e).forEach((function(t){r.Z.addResourceBundle(t,"allstrings",e[t],!0,!0)})),!0)},T=function(e,t){var n={lng:e,backend:{loadPath:Autodesk.Viewing.Private.getResourceUrl("res/locales/%(lng)/%(ns).json")},ns:"allstrings",defaultNS:"allstrings",fallbackLng:"en",debug:!1,useCookie:!1,interpolation:{prefix:"%(",suffix:")",escapeValue:!1}};(0,i.getGlobal)().LOCALIZATION_REL_PATH="res/locales/"+e+"/",r.Z.use(w).init(n,(function(e){t&&t()}))},C=function(e){var t=(0,i.getGlobal)(),n=t&&t.document;r.Z.localize=function(e){var t=e||n;Array.prototype.forEach.call(t.querySelectorAll("[data-i18n]"),(function(e){var t=e.getAttribute("data-i18n"),n=[null,t],i=n[0],o=n[1],a=r.Z.translate(o);a?i?e.setAttribute(i,a):e.placeholder?e.placeholder=a:e.textContent=a:i?e.setAttribute(i,o):e.textContent=o}))};var o=e&&e.language||navigator.language,a=S.Lang.getSupported(o);T(a)}},58660:e=>{"use strict";var t=new function(){this.names=[{symbol:"en",label:"English"},{symbol:"zh-Hans",label:"Chinese Simplified"},{symbol:"zh-Hant",label:"Chinese Traditional"},{symbol:"zh-HK",label:"Hong Kong Traditional"},{symbol:"ja",label:"Japanese"},{symbol:"cs",label:"Czech"},{symbol:"ko",label:"Korean"},{symbol:"pl",label:"Polish"},{symbol:"ru",label:"Russian"},{symbol:"fr",label:"French"},{symbol:"fr-CA",label:"Canadian French"},{symbol:"de",label:"German"},{symbol:"it",label:"Italian"},{symbol:"nl",label:"Dutch"},{symbol:"es",label:"Spanish"},{symbol:"pt-BR",label:"Portuguese Brazil"},{symbol:"tr",label:"Turkish"},{symbol:"sv",label:"Swedish"},{symbol:"da",label:"Danish"},{symbol:"no",label:"Norwegian"},{symbol:"en-GB",label:"British English"}],this.isSupported=function(e){for(var t=0;t<this.names.length;++t)if(this.names[t].symbol===e)return!0;return!1},this.getSupported=function(e){var t=e.split("-");if(e=t[0].toLowerCase(),t.length>1){var n=t[1].toUpperCase();n.length>2&&(n=n[0]+n.substring(1).toLowerCase()),e+="-"+n}return this.isSupported(e)||(e=e.indexOf("zh-CN")>-1?"zh-Hans":e.indexOf("zh-TW")>-1?"zh-Hant":t.length>1&&this.isSupported(t[0].toLowerCase())?t[0]:"en"),e},this.getLanguages=function(){return this.names.slice()}};e.exports={Lang:t}},17167:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DISABLE_FORGE_LOGO:()=>s,DISABLE_FORGE_CANVAS_LOGO:()=>l,getScript:()=>c,injectCSS:()=>u,getHtmlTemplate:()=>h,isExperimentalFlagEnabled:()=>d,getResourceUrl:()=>p,getParameterByName:()=>f,getParameterByNameFromPath:()=>m,stringToDOM:()=>g,toUrlSafeBase64:()=>v,fromUrlSafeBase64:()=>y});var i=n(84998),r=(0,i.getGlobal)(),o=r,a=o&&o.document;r.LOCALIZATION_REL_PATH="",r.LMV_VIEWER_VERSION="7.58.0",r.LMV_BUILD_TYPE="Production",r.LMV_RESOURCE_ROOT="",r.USE_OTG_DS_PROXY=!1,r.LMV_THIRD_PARTY_COOKIE=!(0,i.isNodeJS)()&&void 0,"v"===r.LMV_VIEWER_VERSION.charAt(0)&&(r.LMV_VIEWER_VERSION=r.LMV_VIEWER_VERSION.substr(1)),r.LMV_VECTOR_PDF=!1,r.LMV_RASTER_PDF=!0;var s=!1,l=!0;function c(e){e=e.toLowerCase();var t=a.getElementsByTagName("SCRIPT");if(t&&t.length>0)for(var n=0;n<t.length;++n)if(t[n].src&&-1!==t[n].src.toLowerCase().indexOf(e))return t[n];return null}function u(e,t,n){for(var i=e.indexOf("://")>0?e:p(e),r=a.getElementsByTagName("link"),o=0,s=r.length;o<s;o++)if(r[o].href===i)return void(t&&t());var l=a.createElement("link");l.setAttribute("rel","stylesheet"),l.setAttribute("type","text/css"),l.setAttribute("href",i),t&&(l.onload=t),n&&(l.onerror=n),a.head.appendChild(l)}function h(e,t){var n=e.indexOf("://")>0?e:p(e),i=new XMLHttpRequest;function r(e){t(e,null)}i.onload=function(e){var n=e.currentTarget.responseText;t(null,n)},i.onerror=r,i.ontimeout=r,i.open("GET",n,!0),i.send()}function d(e,t){return!(!t||!Array.isArray(t.experimental))&&-1!==t.experimental.indexOf(e)}function p(e){return r.LMV_RESOURCE_ROOT+e}function f(e){return"undefined"==typeof window?"":m(e,o.location.href)}function m(e,t){e=e.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);return null==n?"":decodeURIComponent(n[1].replace(/\+/g," "))}function g(e){var t=a.createElement("div");return t.innerHTML=e,t.firstChild}function v(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function y(e){for(e=(e=e.replace(/-/g,"+")).replace(/_/g,"/");e.length%4;)e+="=";return(0,i.isNodeJS)()?Buffer.from(e,"base64").toString():atob(e)}},36311:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AlertBox:()=>r});var i=n(71224);function r(){}r.instances=[],r.displayError=function(e,t,n,o,a,s){var l=e.ownerDocument,c=l.createElement("div");c.className="alert-box error",e.appendChild(c);var u=o;u||(u="img-item-not-found");var h=l.createElement("div");h.className="alert-box-image "+u,c.appendChild(h);var d=l.createElement("div");d.className="alert-box-msg",c.appendChild(d);var p=n;p||(p=i.Z.t("Error Occurred",{defaultValue:"Error Occurred"}));var f=l.createElement("div");f.className="alert-box-title",f.textContent=p,f.setAttribute("data-i18n",p),d.appendChild(f);var m=l.createElement("div");if(m.className="alert-box-text",m.textContent=t,m.setAttribute("data-i18n",t),d.appendChild(m),a){var g=l.createElement("div");g.className="alert-box-content",d.appendChild(g);var v=l.createElement("ul");v.className="alert-box-content";for(var y=0;y<a.length;y++){var b=a[y];if(b){var _=l.createElement("li"),x=this.extractList(b);if(x.list.length){var E=this.generateListElement(list,l);v.appendChild(E)}_.innerHTML=x.msg,_.setAttribute("data-i18n",x.msg),v.appendChild(_)}}g.appendChild(v)}var w=l.createElement("div");w.className="alert-box-ok",w.textContent=i.Z.t("OK",{defaultValue:"OK"});var S={alertBox:c,container:e,tag:s};w.addEventListener("click",(function(t){c.style.visibility="hidden",e.removeChild(c),r.instances.splice(r.instances.indexOf(S),1)})),c.appendChild(w),c.style.visibility="visible",r.instances.push(S)},r.displayErrors=function(e,t,n){var o=e.ownerDocument,a=o.createElement("div");a.className="alert-box errors",e.appendChild(a);var s=t;s||(s="img-item-not-found");var l=o.createElement("div");l.className="alert-box-image "+s,a.appendChild(l);var c=o.createElement("div");c.className="alert-box-msg errors",a.appendChild(c);for(var u=0;u<n.length;u++){var h=n[u].header;h||(h=i.Z.t("Error",{defaultValue:"Error"}));var d=o.createElement("div");d.className="alert-box-title errors",d.textContent=h,c.appendChild(d);var p=o.createElement("div");p.className="alert-box-text errors";var f=n[u].msg;if((x=this.extractList(f)).list.length){var m=o.createElement("div"),g=this.generateListElement(x.list,o);m.appendChild(g),p.textContent=x.msg,p.appendChild(m)}else p.textContent=f;if(c.appendChild(p),n[u].hints){var v=o.createElement("ul");v.className="alert-box-content";for(var y=n[u].hints,b=0;b<y.length;b++){var _=y[b];if(_){var x,E=o.createElement("li");if(v.appendChild(E),(x=this.extractList(_)).list.length){g=this.generateListElement(x.list,o);v.appendChild(g)}E.innerHTML=x.msg}}c.appendChild(v)}}var w=o.createElement("div");w.className="alert-box-ok",w.textContent=i.Z.t("OK",{defaultValue:"OK"});var S={alertBox:a,container:e};w.addEventListener("click",(function(t){a.style.visibility="hidden",e.removeChild(a),r.instances.splice(r.instances.indexOf(S),1)})),a.appendChild(w),a.style.visibility="visible",r.instances.push(S)},r.extractList=function(e){var t={msg:e,list:[]};if(e&&-1!=e.indexOf("<ul>")){var n=e.split("<ul>");t.msg=n[0],n=n[1].split("</ul>"),t.list=n[0].split(", "),1===t.list.length&&(t.list=n[0].split(","))}return t},r.generateListElement=function(e,t){for(var n=t.createElement("ul"),i=0;i<e.length;i++){var r=t.createElement("li");r.textContent=e[i],r.setAttribute("data-i18n",e[i]),n.appendChild(r)}return n},r.dismissByTag=function(e){var t=r.instances.findIndex((function(t){return t&&t.tag===e}));if(-1==t)return!1;var n=r.instances[t];return n.alertBox.style.visibility="hidden",n.container.removeChild(n.alertBox),r.instances.splice(t,1),!0},r.dismiss=function(){if(r.instances.length>0){var e=r.instances.pop();return e.alertBox.style.visibility="hidden",e.container.removeChild(e.alertBox),!0}return!1}},74593:(e,t,n)=>{"use strict";n.r(t),n.d(t,{OptionSlider:()=>c,OptionCheckbox:()=>u,OptionLabel:()=>h,OptionButton:()=>d,OptionDropDown:()=>p,ResizeFooter:()=>f,OptionRow:()=>m,SimpleList:()=>g});var i=n(62546),r=n(71224),o=n(84998),a=n(35449);function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=n(41145);function c(e,t,n,i,o){var a=this;this.tbody=i;var s=o&&o.insertAtIndex?o.insertAtIndex:-1;this.hideStepper=o&&o.hideStepper;var l=o&&o.hideCaption;this.sliderRow=this.tbody.insertRow(s),this.sliderRow.classList.add("switch-slider-row");var c=this.getDocument(),u=this.sliderRow.insertCell(0);function h(e){e.target!=a.stepperElement&&(a.stepperElement.value=a.sliderElement.value),a.fireChangeEvent()}this.caption=c.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=r.Z.t(e),l&&(this.caption.style.display="none"),u.appendChild(this.caption),u=this.sliderRow.insertCell(1),this.sliderElement=c.createElement("input"),this.sliderElement.type="range",this.sliderElement.id=e+"_slider",this.sliderElement.min=t,this.sliderElement.max=n,this.sliderElement.style.width="85%",u.appendChild(this.sliderElement),u=this.sliderRow.insertCell(2),this.stepperElement=c.createElement("input"),this.stepperElement.type="number",this.stepperElement.id=e+"_stepper",this.stepperElement.min=t,this.stepperElement.max=n,this.stepperElement.step=1,this.stepperElement.style.width="64px",this.hideStepper&&(this.stepperElement.style.display="none"),u.appendChild(this.stepperElement),this.blockEvent=!1,this.stepperElement.addEventListener("change",(function(e){e.target!=a.sliderElement&&(a.sliderElement.value=a.stepperElement.value),a.fireChangeEvent()}),!1),this.sliderElement.addEventListener("change",h,!1),this.sliderElement.addEventListener("input",h,!1)}function u(e,t,n,i,a,s){var c=this;this.tbody=t;var u=s&&s.insertAtIndex?s.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(u),this.sliderRow.classList.add("switch-slider-row");var h=this.getDocument(),d=this.sliderRow.insertCell(0);this.caption=h.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=r.Z.t(e),d.appendChild(this.caption),d=this.sliderRow.insertCell(1),i&&(this.description=h.createElement("div"),this.description.setAttribute("data-i18n",i),this.description.textContent=r.Z.t(i),d.appendChild(this.description),d=this.sliderRow.insertCell(2));var p=h.createElement("label");p.classList.add("switch"),this.checkElement=h.createElement("input"),this.checkElement.type="checkbox",this.checkElement.id=e+"_check",this.checkElement.checked=n,p.appendChild(this.checkElement);var f=h.createElement("div");f.classList.add("slider"),p.appendChild(f),d.appendChild(p),this.blockEvent=!1,this.checked=n,this.checkElement.addEventListener("change",(function(e){c.fireChangeEvent()}),!1),(0,o.isTouchDevice)()&&(this.sliderRowHammer=new l.Manager(this.sliderRow,{recognizers:[[l.Tap]],handlePointerEventMouse:!1,inputClass:o.isIE11?l.PointerEventInput:l.TouchInput}),this.sliderRowHammer.on("tap",(function(e){e.preventDefault(),e.target.click()}))),this.checkElement.addEventListener("click",(function(e){e.stopPropagation()}),!1),this.sliderRow.addEventListener("click",(function(e){c.checkElement.disabled||(c.checkElement.checked=!c.checkElement.checked,c.fireChangeEvent())}),!1)}function h(e,t,n,i){this.tbody=t;var o=i&&i.insertAtIndex?i.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(o);var a=this.getDocument(),s=this.sliderRow.insertCell(0);this.caption=a.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=r.Z.t(e),s.appendChild(this.caption),s.colSpan="3",this.blockEvent=!1,this.removeFromParent=function(){this.tbody.removeChild(this.sliderRow),this.tbody=null,this.sliderRow=null,this.caption=null}}function d(e,t,n,i){this.tbody=t;var o=i&&i.insertAtIndex?i.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(o),this.sliderRow.insertCell();var a=this.sliderRow.insertCell();this.sliderRow.insertCell();var s=this.getDocument();this.caption=s.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=r.Z.t(e),this.caption.classList.add("adsk-button"),this.caption.classList.add("table-button"),a.appendChild(this.caption),this.removeFromParent=function(){this.tbody.removeChild(this.sliderRow),this._onClick&&(this.caption.removeEventListener("click",this._onClick),this._onClick=null),this.tbody=null,this.sliderRow=null,this.caption=null},this.setOnClick=function(e){this._onClick=e,this.caption.addEventListener("click",e,!1)}}function p(e,t,n,i,o,a,s){var l=this;this.tbody=t;var c=s&&s.insertAtIndex?s.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(c);var u=this.getDocument();this.dropdownElement=u.createElement("select"),this.dropdownElement.id=e+"_dropdown",this.dropdownElement.classList.add("option-drop-down");for(var h=0;h<n.length;h++){var d=u.createElement("option");d.value=h,d.setAttribute("data-i18n",n[h]),d.textContent=r.Z.t(n[h]),this.dropdownElement.add(d)}this.selectedIndex=this.dropdownElement.selectedIndex=i;var p=this.sliderRow.insertCell(0);this.caption=u.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=r.Z.t(e),p.appendChild(this.caption),o?(p.colSpan="2",this.sliderRow=this.tbody.insertRow(c),(p=this.sliderRow.insertCell(0)).appendChild(this.dropdownElement),p.colSpan="2",this.dropdownElement.classList.add("tabcell")):(p=this.sliderRow.insertCell(1)).appendChild(this.dropdownElement),p.style.paddingLeft=(s&&void 0!==s.paddingLeft?s.paddingLeft:5)+"px",p.style.paddingRight=(s&&void 0!==s.paddingRight?s.paddingRight:5)+"px",this.blockEvent=!1,this.dropdownElement.addEventListener("change",(function(e){l.fireChangeEvent()}),!1)}function f(e,t,n){this.resizeCallback=t;var i=this.getDocument(),r=i.createElement("div");r.classList.add("docking-panel-footer");var o=i.createElement("div");o.classList.add("docking-panel-footer-resizer"),r.appendChild(o);var a=!1,s=e.getBoundingClientRect(),l={x:0,y:0},c=i.createElement("div");c.classList.add("adsk-viewing-viewer"),c.classList.add("docking-panel-resize-overlay");var u=function(t){a=!0,s=e.getBoundingClientRect(),this.getDocument().body.appendChild(c),this.addDocumentEventListener("touchmove",d),this.addDocumentEventListener("touchcancel",h),this.addDocumentEventListener("touchend",h),this.addDocumentEventListener("mousemove",d),this.addDocumentEventListener("mouseup",h),t.preventDefault(),t.stopPropagation()};u=u.bind(this);var h=function(e){var t=this.getDocument();t.body.contains(c)&&(t.body.removeChild(c),this.removeDocumentEventListener("touchmove",d),this.removeDocumentEventListener("touchcancel",h),this.removeDocumentEventListener("touchend",h),this.removeDocumentEventListener("mousemove",d),this.removeDocumentEventListener("mouseup",h),e.preventDefault(),e.stopPropagation())};h=h.bind(this);var d=function(t){"touchmove"===t.type&&(t.canvasX=t.touches[0].screenX,t.canvasY=t.touches[0].screenY),a&&(a=!1,l.x=t.canvasX||t.clientX,l.y=t.canvasY||t.clientY);var n=(t.canvasX||t.clientX)-l.x,i=(t.canvasY||t.clientY)-l.y,r=parseInt(s.width+n),o=parseInt(s.height+i);e.style.width=r+"px",e.style.height=o+"px",this.resizeCallback&&this.resizeCallback(r,o),t.preventDefault(),t.stopPropagation()};d=d.bind(this),o.addEventListener("touchstart",u),o.addEventListener("mousedown",u),e.style.resize="none",e.appendChild(r),this.footer=r,this.resizer=o}function m(e,t,n,i,o){this.tbody=t;var a=o&&o.insertAtIndex?o.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(a),this.sliderRow.classList.add("switch-slider-row");var s=this.getDocument(),l=this.sliderRow.insertCell(0);this.caption=s.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=r.Z.t(e),l.appendChild(this.caption),l=this.sliderRow.insertCell(1),n&&(this.description=s.createElement("div"),this.description.setAttribute("data-i18n",n),this.description.textContent=r.Z.t(n),l.appendChild(this.description),l=this.sliderRow.insertCell(2))}c.prototype.constructor=c,i.EventDispatcher.prototype.apply(c.prototype),c.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.value=this.sliderElement.value;var e=new CustomEvent("change",{detail:{target:this,value:this.sliderElement.value}});this.dispatchEvent(e)}},c.prototype.setValue=function(e){this.blockEvent=!0,this.value=e,this.sliderElement.value=e,this.stepperElement.value=e,this.blockEvent=!1},c.prototype.setDisabled=function(e){this.sliderElement.disabled=e,this.stepperElement.disabled=e,this.caption.disabled=e},a.GlobalManagerMixin.call(c.prototype),u.prototype.constructor=u,i.EventDispatcher.prototype.apply(u.prototype),a.GlobalManagerMixin.call(u.prototype),u.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.checked=this.checkElement.checked;var e=new CustomEvent("change",{detail:{target:this,value:this.checkElement.checked}});this.dispatchEvent(e)}},u.prototype.setChecked=function(e){this.checkElement.checked!=e&&(this.checkElement.checked=e,this.fireChangeEvent())},u.prototype.setValue=function(e){this.blockEvent=!0,this.checked=e,this.checkElement.checked=e,this.blockEvent=!1},u.prototype.getValue=function(){return this.checkElement.checked},u.prototype.setDisabled=function(e){this.checkElement.disabled=e,this.caption.disabled=e},u.prototype.setVisibility=function(e){this.sliderRow.style.display=e?"table-row":"none"},a.GlobalManagerMixin.call(h.prototype),a.GlobalManagerMixin.call(d.prototype),p.prototype.constructor=p,i.EventDispatcher.prototype.apply(p.prototype),p.prototype.setSelectedIndex=function(e){this.blockEvent=!0,this.selectedIndex=this.dropdownElement.selectedIndex=e,this.blockEvent=!1},p.prototype.setSelectedValue=function(e){this.blockEvent=!0,this.dropdownElement.selectedValue=e,this.selectedIndex=this.dropdownElement.selectedIndex,this.blockEvent=!1},p.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.selectedIndex=this.dropdownElement.selectedIndex;var e=new CustomEvent("change",{detail:{target:this,value:this.selectedIndex}});this.dispatchEvent(e)}},p.prototype.setDisabled=function(e){this.dropdownElement.disabled=e,this.caption.disabled=e},a.GlobalManagerMixin.call(p.prototype),a.GlobalManagerMixin.call(f.prototype),a.GlobalManagerMixin.call(m.prototype);var g=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._parentDiv=t,this._renderRowFn=n,this._onClickFn=i,this._onRowClick=this._onRowClick.bind(this);var r=this.getDocument(),o=r.createElement("div");o.classList.add("settings-container"),this._parentDiv.appendChild(o),this._myContainer=o,this._myContainer.addEventListener("click",this._onRowClick,{capture:!0});var a=r.createElement("div");a.classList.add("settings-table"),this._rowsContainer=a,o.appendChild(a)}var t,n,i;return t=e,(n=[{key:"setData",value:function(e,t){this._removeAllRows(),this._items=e;for(var n=0;n<e.length;++n)this._addRow(n);this._updateSelection(t)}},{key:"removeFromParent",value:function(){this._myContainer.removeEventListener("click",this._onRowClick,{capture:!0}),this._removeAllRows(),this._parentDiv.removeChild(this._myContainer),this._parentDiv=null,this._myContainer=null,this._rowsContainer=null,this._onClickFn=null,this._items=null}},{key:"_addRow",value:function(e){var t=this._items[e],n=this.getDocument(),i=n.createElement("div");this._renderRowFn(i,t,{domDocument:n}),i.setAttribute("data-index",e),this._rowsContainer.appendChild(i)}},{key:"_removeAllRows",value:function(){for(var e=this._rowsContainer.children;e.length;)this._rowsContainer.removeChild(e[0])}},{key:"_updateSelection",value:function(e){for(var t=this._rowsContainer.children,n=0;n<t.length;n++){var i=t[n];n===e?i.classList.add("border-select"):i.classList.remove("border-select")}}},{key:"_onRowClick",value:function(e){for(var t,n=e.target;n!==this._myContainer&&!(t=n.getAttribute("data-index"));)n=n.parentNode;if(t){var i=parseInt(t);this._onClickFn(i)}}}])&&s(t.prototype,n),i&&s(t,i),e}();a.GlobalManagerMixin.call(g.prototype)},89576:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ContextMenu:()=>l});var i=n(84998),r=n(98926),o=n(71224),a=n(35449),s=n(11294);function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.viewer=e,this.setGlobalManager(e.globalManager),this.menus=[],this.container=null,this.open=!1,this._onDOMevent=this._onDOMevent.bind(this),this.onHide=t.onHide}l.prototype.constructor=l,a.GlobalManagerMixin.call(l.prototype),l.prototype.show=function(e,t){var n=this.viewer.container.getBoundingClientRect();Array.isArray(e.changedPointers)&&e.changedPointers.length>0&&(e.clientX=e.changedPointers[0].clientX,e.clientY=e.changedPointers[0].clientY);var i=e.clientX-n.left,r=e.clientY-n.top;this.open||(this.showMenu(t,i,r),this.open=!0),this._startX=e.clientX,this._startY=e.clientY},l.prototype.showMenu=function(e,t,n,o){var a,s=this,l=[],c=this.getDocument(),u=c.createElement("div");u.style.left="0",u.style.top="0",u.style.width="100%",u.style.height="100%",u.style.position="absolute",u.style.zIndex="10";var h=c.createElement("div");h.classList.add("menu"),h.classList.add("docking-panel"),h.classList.add("docking-panel-container-solid-color-a"),u.appendChild(h),this.viewer.container.appendChild(u),this.container=u,this.menus.push(h);for(var d=!1,p=0;p<e.length;++p){var f=e[p],m=f.title,g=f.target,v=f.icon,y=f.shortcut,b=f.divider,_=Array.isArray(g);_&&!e.isChild?d=!0:_=!1,b?(a=this.createDivider(),h.appendChild(a)):(a=this.createMenuItem(m,v,y,_),h.appendChild(a),"function"==typeof g?this.addCallbackToMenuItem(a,g):_?l.push({menuItem:a,target:g}):r.logger.warn("Invalid context menu option:",m,g))}if(!d)for(var x=h.children,E=0;E<x.length;E++){var w=x[E],S=w.getElementsByClassName("menu-item-expand");S.length>0&&w.removeChild(S[0])}var A=h.getBoundingClientRect(),M=A.width,T=A.height,C=this.viewer.container.getBoundingClientRect(),P=C.width,L=C.height;(o=!!o||(0,i.isTouchDevice)()&&!this.viewer.navigation.getUseLeftHandedInput())&&(t-=M),t<0&&(t=0),P<t+M&&(t=P-M)<0&&(t=0),n<0&&(n=0),L<n+T&&(n=L-T)<0&&(n=0),h.style.top=Math.round(n)+"px",h.style.left=Math.round(t)+"px";var R=function(e,t){var n=e.getElementsByClassName("menu-item-expand");e.removeChild(n[0]);var i=e.getElementsByClassName("menu-item-icon");i.length>0&&e.insertBefore(i[0],e.childNodes[e.length-1]),s.setMenuExpand(e,!0,t)},D=!1;for(p=0;p<l.length;++p){var I=l[p],O=(a=I.menuItem).getBoundingClientRect(),N=this.viewer.container.getBoundingClientRect(),k=O.right-O.left;(D=N.right-O.right<k||o)&&R(a,!0),t=Math.round((D?O.left:O.right)-N.left),n=Math.round(O.top-N.top),this.addSubmenuCallbackToMenuItem(a,I.target,t,n,D)}if(l.length>0&&D)for(var F=h.children,U=0;U<F.length;U++){var B=F[U];B.children.length>2&&-1!==B.children[2].className.indexOf("menu-item-expand")&&R(B,!1)}this.container.addEventListener("touchend",this._onDOMevent),this.container.addEventListener("mousedown",this._onDOMevent),this.container.addEventListener("mouseup",this._onDOMevent),(0,i.isTouchDevice)()||this.container.addEventListener("mousemove",this._onDOMevent)},l.prototype._onDOMevent=function(e){switch(e.type){case"touchend":this._isContextMenu(e)||this.hide();break;case"mousedown":this._startX=e.clientX,this._startY=e.clientY;break;case"mouseup":this._isContextMenu(e)||(this.hide(),s.EventUtils.isRightClick(e)&&e.clientX===this._startX&&e.clientY===this._startY&&this.viewer.triggerContextMenu(e));break;case"mousemove":if(!this.currentItem||this.menus.length<2)break;var t=this._isInside(e,this.currentItem),n=this._isInside(e,this.menus[1]);t||n?this.currentItem.backgroundColor&&(this.currentItem.style.backgroundColor=this.currentItem.backgroundColor):(this.hideMenu(this.menus[1]),this.currentItem.style.backgroundColor=null,this.currentItem=null)}},l.prototype.createMenuItem=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.getDocument(),o=r.createElement("div");return o.className="menu-item",n=n||"",this.setMenuItemIcon(o,t),this.setMenuItemText(o,e),this.setMenuExpand(o,!1,i),this.setMenuItemShortcut(o,n),o},l.prototype.createDivider=function(){var e=this.getDocument(),t=e.createElement("div");t.className="menu-divider-container";var n=e.createElement("div");return n.className="menu-divider",t.appendChild(n),t},l.prototype.setMenuItemIcon=function(e,t){var n=this.getDocument().createElement("div");n.classList.add("menu-item-icon"),t&&n.classList.add(t),e.appendChild(n)},l.prototype.setMenuItemText=function(e,t){var n=this.getDocument().createElement("div");n.classList.add("menu-item-text"),n.setAttribute("data-i18n",t),n.textContent=o.Z.t(t),e.appendChild(n)},l.prototype.setMenuItemShortcut=function(e,t){var n=this.getDocument().createElement("div");n.classList.add("menu-item-shortcut"),n.textContent=t,e.appendChild(n)},l.prototype.setMenuExpand=function(e,t,n){var i=this.getDocument().createElement("div");i.classList.add("menu-item-expand"),t?(i.style.transform="scale(-1)",e.insertBefore(i,e.childNodes[0])):e.appendChild(i);var r=0|n;i.style.opacity=r},l.prototype.addCallbackToMenuItem=function(e,t){var n=this;e.addEventListener("click",(function(e){return n.hide(),t(),e.preventDefault(),!1}),!1)},l.prototype.addSubmenuCallbackToMenuItem=function(e,t,n,r,o){var a=this;t.isChild=!0,(0,i.isTouchDevice)()?e.addEventListener("click",(function(){a.open=!0,a.currentItem=e,a.showMenu(t,n,r,o)}),!1):e.addEventListener("mouseenter",(function(){if(a._isInside(event,e)){a.open=!0,a.currentItem=e;var i=a.getWindow().getComputedStyle(a.currentItem).getPropertyValue("background-color");a.currentItem.backgroundColor=i,a.showMenu(t,n,r,o)}}),!1)},l.prototype.hideMenu=function(e){var t,n=this;e&&-1!==this.menus.indexOf(e)&&e.parentNode&&((t=e.parentNode).removeEventListener("touchend",n._onDOMevent),t.removeEventListener("mousedown",n._onDOMevent),t.removeEventListener("mouseup",n._onDOMevent),(0,i.isTouchDevice)()||t.removeEventListener("mousemove",n._onDOMevent),t.parentNode.removeChild(t),this.menus.splice(this.menus.indexOf(e),1)),0===this.menus.length?(this.open=!1,this.container=null):1===this.menus.length&&(this.container=this.menus[0].parentNode)},l.prototype.hide=function(){if(this.open){for(;this.menus.length>0;)this.hideMenu(this.menus[0]);return this.onHide&&this.onHide(),!0}return!1},l.prototype._isContextMenu=function(e){for(var t=0;t<this.menus.length;t++)for(var n=this.menus[t],i=e.target;i!==this.container;){if(i===n)return!0;i=i.parentNode}return!1},l.prototype._isInside=function(e,t){var n=this.viewer.container.getBoundingClientRect();Array.isArray(e.changedPointers)&&e.changedPointers.length>0&&(e.clientX=e.changedPointers[0].clientX,e.clientY=e.changedPointers[0].clientY);var i=Math.ceil(e.clientX-n.left),r=Math.ceil(e.clientY-n.top),o=t.getBoundingClientRect(),a=Math.floor(o.top-n.top),s=Math.ceil(o.bottom-n.top),l=Math.floor(o.left-n.left),c=Math.ceil(o.right-n.left);return r>=a&&r<=s&&i>=l&&i<=c}},12074:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DataTable:()=>o});var i=n(52072),r=Autodesk.Viewing.UI;function o(e){if(!(e instanceof r.DockingPanel))throw new Error("Invalid docking panel");this.dockingPanel=e;var t=this.dockingPanel.getDocument();this.datatableDiv=t.createElement("div"),this.datatableDiv.setAttribute("id","datatable"),this.datatableDiv.setAttribute("class","datatable"),e.container.appendChild(this.datatableDiv),e.footerInstance&&(e.footerInstance.resizeCallback=this._fitHeaderColumns.bind(this)),this.groupedByColumn=!1,this.aggregated=!1}o.prototype._createColumns=function(e){var t=this.dockingPanel.getDocument(),n=t.createElement("div");n.setAttribute("id","columnArea"),n.setAttribute("class","clusterize-headers");var i='<table id="headersArea"><thead><tr id ="columnRow"></tr></thead></table>';n.innerHTML=i,this.datatableDiv.appendChild(n);var r=n.querySelector("tr");e.forEach((function(e){var n=t.createElement("th");n.appendChild(t.createTextNode(e)),r.appendChild(n)})),i=this.datatableDiv.querySelector("table"),this._makeTableSortable(i)},o.prototype._createRows=function(){var e=this.dockingPanel.getDocument().createElement("div");e.innerHTML='<div id="scrollArea" class="clusterize-scroll"><table id="bodyArea" class="table-striped"><tbody id="contentArea" class="clusterize-content"><tr class="clusterize-no-data"><td>Loading data</td></tr></tbody></table></div>',this.datatableDiv.appendChild(e)},o.prototype.setData=function(e,t){if(t.length!==e[0].length)throw new Error("Column length should be same as the row length");this._createColumns(t),this._createRows();var n=this;this.rowData=e,this.clusterize=new i({rows:this.rowData.map((function(e){return"<tr>"+e.map((function(e){return"<td>"+e+"</td>"})).join(" ")+"</tr>"})),scrollId:"scrollArea",contentId:"contentArea",callbacks:{clusterChanged:function(){n._fitHeaderColumns(),n._syncHeaderWidth(),n.groupedByColumn&&n._updateClusterGroup()}}}),this.datatableDiv.querySelector(".clusterize-scroll").addEventListener("scroll",(function(){var e=this.scrollLeft;r(e)}));var r=function(e){n.datatableDiv.querySelector("#headersArea").style.setProperty("margin-left",-e+"px")}},o.prototype.destroyTable=function(){this.clusterize.destroy(!0),this.clusterize=null,this.rowData=null,this.groupedByColumn=!1},o.prototype._makeTableSortable=function(e){var t,n=this,i=e.tHead;if(i&&i.rows[0]&&(i=i.rows[0].cells),i)for(t=i.length;--t>=0;)!function(e){var t=1;i[e].addEventListener("click",(function(){n._sortTable(e,t=1-t)}))}(t)},o.prototype._sortTable=function(e,t){var n=this.rowData;this.sortFunction||this.restoreDefaultSortFunction();var i=this.sortFunction&&this.sortFunction.bind(this),r=(n=n.sort(i(e,t))).map((function(e){return"<tr>"+e.map((function(e){return"<td>"+e+"</td>"})).join(" ")+"</tr>"}));this.clusterize.update(r);var o=this.datatableDiv.querySelector("#bodyArea");o.classList.contains("table-striped")||o.classList.add("table-striped")},o.prototype.setSortFunction=function(e){this.sortFunction=e},o.prototype.getSortFunction=function(){return this.sortFunction},o.prototype.restoreDefaultSortFunction=function(){this.sortFunction=function(e,t){return t=-(+t||-1),function(n,i){return t*n[e].localeCompare(i[e])}}},o.prototype.getGroupByColumn=function(e){for(var t=this.rowData,n={},i=0;i<t.length;i++){var r=t[i][e];n[r]||(n[r]=[]),n[r].push(i)}return n},o.prototype.groupByColumn=function(e){for(var t=this,n=this.rowData,i={},r=0;r<n.length;r++){var o=n[r],a=o[e];if(i[a]||(i[a]=[]),i[a].length>0)o="<tr class= 'subrow'>"+o.map((function(e){return"<td>"+e+"</td>"})).join(" ")+"</tr>";else!function(){var e=o.length;'<span value="click"></span>',o="<tr class= 'parentrow'>"+o.map((function(t,n){return e===n+1?"<td>"+t+'<span value="click"></span></td>':"<td>"+t+"</td>"})).join(" ")+"</tr>"}();i[a].push(o)}var s=[];for(var l in i)for(var c=i[l],u=0;u<c.length;u++){var h=c[u];s.push(h)}this.clusterize.update(s);var d=this.datatableDiv.querySelector("#bodyArea");d.classList.contains("table-striped")&&d.classList.remove("table-striped"),this.datatableDiv.querySelectorAll(".subrow").forEach((function(e){t._slideDown(e),e.style.fontSize="14px"}));var p=this._fitHeaderColumns.bind(this),f=this._expandContent.bind(this);this.datatableDiv.querySelectorAll("span").forEach((function(e){e.addEventListener("click",(function(e){f(this,e),p()}))})),this._fitHeaderColumns(),this.groupedByColumn||(this.groupedByColumn=!0)},o.prototype._updateClusterGroup=function(){var e=this,t=this._fitHeaderColumns.bind(this),n=this._expandContent.bind(this);this.datatableDiv.querySelectorAll("span").forEach((function(e){e.addEventListener("click",(function(e){n(this,e),t()}))})),this.datatableDiv.querySelectorAll(".subrow").forEach((function(t){e._slideDown(t),t.style.fontSize="14px"}))},o.prototype._expandContent=function(e){var t=!1;"collapsed"===e.className&&(t=!0);for(var n=t?14:0,i=e.closest("tr"),r=this._nextUntil(i,":not(.subrow)"),o=0;o<r.length;o++)this._slideToggle(r[o],500),r[o].style.fontSize=n+"px";e.classList.toggle("collapsed")},o.prototype._nextUntil=function(e,t,n){var i=[];for(e=e.nextElementSibling;e&&!e.matches(t);)!n||e.matches(n)?(i.push(e),e=e.nextElementSibling):e=e.nextElementSibling;return i},o.prototype._slideToggle=function(e,t){return"none"===this.dockingPanel.getWindow().getComputedStyle(e).display?this._slideDown(e,t):this._slideUp(e,t)},o.prototype._slideUp=function(e,t){e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.boxSizing="border-box",e.style.height=e.offsetHeight+"px",e.offsetHeight,e.style.overflow="hidden",e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,e.style.display="none",e.style.removeProperty("height"),e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property")},o.prototype._slideDown=function(e,t){var n=this.dockingPanel.getWindow();e.style.removeProperty("display");var i=n.getComputedStyle(e).display;"none"===i&&(i="block"),e.style.display=i;e.style.overflow="hidden",e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,e.offsetHeight,e.style.boxSizing="border-box",e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.height="21pxpx",e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),n.setTimeout((function(){e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property")}),t)},o.prototype.getAggregate=function(e,t){var n,i=this.rowData,r=null;switch(e){case"MIN":r=function(){for(var e=i[0][t],n=1;n<i.length;n++)e>i[n][t]&&(e=i[n][t]);return e||0}();break;case"MAX":r=function(){for(var e=i[0][t],n=1;n<i.length;n++)e<i[n][t]&&(e=i[n][t]);return e||0}();break;case"SUM":r=o();break;case"AVG":n=o()/i.length,r=(n=parseFloat(n))||0;break;case"COUNT":r=i.length}return r;function o(){for(var e=0,n=0;n<i.length;n++)e+=parseFloat(i[n][t]);return e||0}},o.prototype.aggregate=function(e,t){var n=this.datatableDiv.querySelector(".clusterize-content").querySelector("tr:not(.clusterize-extra-row):not(.first)");if(n){for(var i=[],r=0;r<n.children.length;r++)i.push(n.children[r].clientWidth);var o=this.getAggregate(e,t),a=this.dockingPanel.getDocument();if(!this.aggregated){var s=a.createElement("div");s.setAttribute("id","aggregate"),s.setAttribute("class","aggregate-headers");s.innerHTML='<table id="aggregateArea"><tbody></tbody></table>',this.datatableDiv.appendChild(s)}for(var l=this.datatableDiv.querySelector("#aggregateArea"),c=0;c<l.rows.length;c++){if(l.rows[c].cells[t].innerText.indexOf(e)>-1)return}for(var u=0;u<l.rows.length;u++){var h=l.rows[u].cells[t];if(0===h.innerText.length)return h.appendChild(a.createTextNode(e+": ")),void h.appendChild(a.createTextNode(o))}for(var d=l.insertRow(l.rows.length),p=0;p<i.length;p++){var f=a.createElement("td");d.appendChild(f),f.style.setProperty("min-width",i[p]+"px","important"),p===t&&(f.appendChild(a.createTextNode(e+": ")),f.appendChild(a.createTextNode(o)))}this.aggregated=!0}},o.prototype.clearAggregates=function(){for(var e=this.datatableDiv.querySelectorAll(".aggregate-headers"),t=0;t<e.length;t++)e[t].parentNode.removeChild(e[t])},o.prototype._fitHeaderColumns=function(){var e=this.datatableDiv.querySelector(".clusterize-content"),t=this.datatableDiv.querySelector("#headersArea"),n=e.querySelector("tr:not(.clusterize-extra-row):not(.first)");if(n){for(var i=[],r=[],o=0;o<n.children.length;o++)r.push(n.children[o].clientWidth);if(r.toString()!=i.toString()){for(var a=t.querySelector("tr"),s=0;s<a.children.length;s++)a.children[s].style.setProperty("clientWidth",r[s]+"px","important"),a.children[s].style.setProperty("min-width",r[s]+"px","important");if(this.aggregated)for(var l=this.datatableDiv.querySelector("#aggregateArea"),c=0;c<l.rows.length;c++)for(var u=l.rows[c],h=0;h<u.children.length;h++)u.children[h].style.setProperty("clientWidth",r[h]+"px","important"),u.children[h].style.setProperty("min-width",r[h]+"px","important");i=r}}},o.prototype._syncHeaderWidth=function(){var e=this.datatableDiv.querySelector(".clusterize-content"),t=this.datatableDiv.querySelector("#headersArea");t.style.setProperty("clientWidth",e.width),t.style.setProperty("min-idth",e.width)}},76723:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DockingPanel:()=>o});var i=n(71224),r=n(74593);function o(e,t,n,i){this.kMinWdth=100,this.kMinHeight=100,this.visibilityCallbacks=[],this.movedSinceLastClick=!1,this.movedSinceCreate=!1,this.parentContainer=e;var r=this.getDocument();this.container=r.createElement("div"),this.container.id=t,this.container.lastWidth="",this.container.dockRight=!1,this.container.dockBottom=!1,this.titleLabel=n,i=i||{},Object.prototype.hasOwnProperty.call(i,"localizeTitle")||(i.localizeTitle=!0),Object.prototype.hasOwnProperty.call(i,"addFooter")||(i.addFooter=!0),this.options=i,this.container.classList.add("docking-panel"),e.appendChild(this.container),this.listeners=[],this.initialize(),this.setVisible(!1)}n(35449).GlobalManagerMixin.call(o.prototype),o.prototype.onSetGlobalManager=function(e){this.footerInstance&&this.footerInstance.setGlobalManager(e)},o.prototype.initialize=function(){this.title=this.createTitleBar(this.titleLabel||this.container.id),this.container.appendChild(this.title),this.initializeMoveHandlers(this.title),this.setTitle(this.titleLabel||this.container.id,this.options),this.closer=this.createCloseButton(),this.container.appendChild(this.closer),this.options.addFooter&&(this.footer=this.createFooter(),this.container.appendChild(this.footer))},o.prototype.uninitialize=function(){for(var e=0;e<this.listeners.length;++e){var t=this.listeners[e];t.target.removeEventListener(t.eventId,t.callback)}this.listeners=[],this.visibilityCallbacks=[],this.parentContainer.removeChild(this.container),this.parentContainer=null,this.container=null,this.title=null,this.closer=null},o.prototype.addVisibilityListener=function(e){this.visibilityCallbacks.push(e)},o.prototype.setVisible=function(e){if(e){var t=this.getContainerBoundingRect();if(this.container.dockRight){var n=t.width,i=300,r=this.container.lastWidth||this.container.style.width;r||(r=this.container.getBoundingClientRect().width),r&&(i=parseInt(r)),this.container.style.left=n-i+"px"}if(this.container.dockBottom){var o=t.height,a=300,s=this.container.lastHeight||this.container.style.height;s||(s=this.container.getBoundingClientRect().height),s&&(a=parseInt(s));var l=o-a;this.container.style.top=l>0?l+"px":0}this.container.style.maxHeight=t.height+"px",this.container.style.maxWidth=t.width+"px",this.container.style.display="block",this.bringToFront()}else this.container.lastWidth=this.container.style.width,this.container.lastHeight=this.container.style.height,this.container.style.display="none";for(var c=0;c<this.visibilityCallbacks.length;c++)this.visibilityCallbacks[c](e)},o.prototype.isVisible=function(){return"block"===this.container.style.display},o.prototype.visibilityChanged=function(){},o.prototype.initializeMoveHandlers=function(e){var t,n,i,r,o,a,s,l,c=this.container,u=this;function h(e){var h=c.style.minWidth?parseInt(c.style.minWidth):u.kMinWdth,d=c.style.minHeight?parseInt(c.style.minHeight):u.kMinHeight,p=u.getContainerBoundingRect();c.style.maxWidth&&parseInt(c.style.width)>parseInt(c.style.maxWidth)&&(c.style.width=c.style.maxWidth),c.style.maxHeight&&parseInt(c.style.height)>parseInt(c.style.maxHeight)&&(c.style.height=c.style.maxHeight),parseInt(c.style.width)<h&&(c.style.width=h+"px"),parseInt(c.style.height)<d&&(c.style.height=d+"px"),"touchmove"===e.type&&(e.screenX=e.touches[0].screenX,e.screenY=e.touches[0].screenY),s+=e.screenX-i,l+=e.screenY-r,t=o+s,n=a+l;var f=parseInt(c.style.width),m=parseInt(c.style.height);isNaN(f)&&(f=u.container.getBoundingClientRect().width),isNaN(m)&&(m=u.container.getBoundingClientRect().height),t<5&&(t=0),n<5&&(n=0),c.dockRight=!1,c.dockBottom=!1,p.width-5<t+f&&(t=p.width-f,c.dockRight=!0),p.height-5<n+m&&(n=p.height-m,c.dockBottom=!0),c.style.left=t+"px",c.style.top=n+"px",c.style.maxWidth=p.width-t+"px",c.style.maxHeight=p.height-n+"px",i=e.screenX,r=e.screenY,u.onMove(e,t,n)}function d(e){u.removeWindowEventListener("mousemove",h),u.removeWindowEventListener("mouseup",d),u.removeWindowEventListener("touchmove",h),u.removeWindowEventListener("touchend",d),u.onEndMove(e,t,n)}function p(e){"touchstart"===e.type&&(e.screenX=e.touches[0].screenX,e.screenY=e.touches[0].screenY),i=e.screenX,r=e.screenY,s=0,l=0,o=u.container.offsetLeft,a=u.container.offsetTop,u.addWindowEventListener("mousemove",h,!1),u.addWindowEventListener("mouseup",d,!1),u.addWindowEventListener("touchmove",h,!1),u.addWindowEventListener("touchend",d,!1),e.preventDefault(),u.onStartMove(e,o,a)}u.addEventListener(e,"mousedown",p),u.addEventListener(e,"touchstart",p)},o.prototype.initializeCloseHandler=function(e){var t=this;t.addEventListener(e,"click",(function(){t.setVisible(!1)}),!1)},o.prototype.createScrollContainer=function(e){var t=this.getDocument().createElement("div"),n=t.classList;return n.add("docking-panel-scroll"),n.add("docking-panel-container-solid-color-a"),n.add(e&&e.left?"left":"right"),e&&e.heightAdjustment&&(t.style.height="calc(100% - "+e.heightAdjustment+"px)"),e&&e.marginTop&&(t.style.marginTop=e.marginTop+"px"),t.id=this.container.id+"-scroll-container",this.container.appendChild(t),this.scrollContainer=t,this.scrollEaseCurve=e&&e.scrollEaseCurve||[0,0,.29,1],this.scrollEaseSpeed=e&&e.scrollEaseSpeed||.003,t},o.prototype.createTitleBar=function(e){var t=this.getDocument().createElement("div");t.classList.add("docking-panel-title"),t.textContent=e;var n=this;return n.addEventListener(t,"click",(function(e){n.movedSinceLastClick||n.onTitleClick(e),n.movedSinceLastClick=!1})),n.addEventListener(t,"mousedown",(function(){n.bringToFront()})),n.addEventListener(t,"dblclick",(function(e){n.onTitleDoubleClick(e)})),t},o.prototype.createFooter=function(){var e=new r.ResizeFooter(this.container);return e.setGlobalManager(this.globalManager),this.footerInstance=e,this.container.style.resize="none",e.footer},o.prototype.setTitle=function(e,t){t&&t.localizeTitle?(this.title.setAttribute("data-i18n",e),e=i.Z.t(e,t.i18nOpts)):this.title.removeAttribute("data-i18n"),this.title.textContent=e},o.prototype.createCloseButton=function(){var e=this.getDocument().createElement("div");return e.className="docking-panel-close",this.initializeCloseHandler(e),e},o.prototype.onStartMove=function(){},o.prototype.onEndMove=function(){},o.prototype.onMove=function(){this.movedSinceLastClick=!0,this.movedSinceCreate=!0},o.prototype.onTitleClick=function(){},o.prototype.onTitleDoubleClick=function(){},o.prototype.addEventListener=function(e,t,n){e.addEventListener(t,n),this.listeners.push({target:e,eventId:t,callback:n})},o.prototype.removeEventListener=function(e,t,n){for(var i=0;i<this.listeners.length;++i){var r=this.listeners[i];if(r.target===e&&r.eventId===t&&r.callback===n)return e.removeEventListener(t,n),this.listeners.splice(i,1),!0}return!1},o.prototype.getContentSize=function(){return{height:this.container.clientHeight,width:this.container.clientWidth}},o.prototype.resizeToContent=function(e){if(this.isVisible()){var t=this.getContentSize().height,n=this.container.getBoundingClientRect(),i=this.getContainerBoundingRect(),r=this.container.querySelector(".docking-panel-footer");r&&(t+=r.getBoundingClientRect().height);var o=i.height;o-=n.top-i.top+75,e&&void 0!==e.maxHeight&&(o=Math.min(o,e.maxHeight)),t>o&&(t=o),this.container.style.maxHeight=o.toString()+"px",this.container.style.height=t.toString()+"px"}},o.prototype.getContainerBoundingRect=function(){return this.parentContainer.getBoundingClientRect()},o.prototype.animateScroll=function(e,t,n){var i=this.scrollEaseCurve,r=this.scrollEaseSpeed,o=this.scrollContainer;var a=performance.now();requestAnimationFrame((function s(l){var c=(l-a)*r;c=Math.min(c,1);var u=function(e,t){var n=3*e[1],i=3*(e[3]-e[1])-n;return(((1-n-i)*t+i)*t+n)*t}(i,c),h=e+(t-e)*u;o.scrollTop=h,n&&n(h),c<1&&requestAnimationFrame(s)}))},o.prototype.onViewerResize=function(e,t,n,i,r,o){var a=this.container,s=a.getBoundingClientRect(),l=s.width,c=s.height;if(!l||!c)return!1;var u=s.top,h=s.bottom,d=s.left,p=s.right;return r<l&&(l=Math.round(r),a.style.width=l+"px"),o<c&&(c=Math.round(o),a.style.height=c+"px"),(i<p||a.dockRight)&&(d=Math.round(i-l-n),a.style.left=d+"px"),(t<h||a.dockBottom)&&((u=Math.round(t-c-e))<0&&(u=0),a.style.top=u+"px"),a.style.maxWidth=Math.round(r)+"px",a.style.maxHeight=Math.round(o)+"px",!0},o.prototype.bringToFront=function(){var e=this.scrollContainer?this.scrollContainer.scrollTop:0;this.parentContainer.appendChild(this.container),this.scrollContainer&&(this.scrollContainer.scrollTop=e)}},96250:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ErrorHandler:()=>c});var i=n(36311),r=n(98926),o=n(71224),a=n(26261);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}var l={1:{img:"img-reload","globalized-msg":"Viewer-UnknownFailure","default-msg":"<title> Sorry </title><message>We seem to have some technical difficulties and couldn't complete your request.</message><hint>Try loading the item again. </hint><hint>Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},2:{img:"img-unsupported","globalized-msg":"Viewer-BadData","default-msg":"<title> Sorry </title><message>The item you are trying to view was not processed completely. </message><hint>Try loading the item again.</hint><hint>Please upload the file again to see if that fixes the issue.</hint>"},3:{img:"img-reload","globalized-msg":"Viewer-NetworkError","default-msg":"<title> Sorry </title><message>We seem to have some technical difficulties and couldn't complete your request.</message><hint> Try loading the item again.</hint><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},4:{img:"img-unlock","globalized-msg":"Viewer-AccessDenied","default-msg":"<title> No access </title><message>Sorry. You dont have the required privileges to access this item.</message><hint> Please contact the author</hint>"},5:{img:"img-item-not-found","globalized-msg":"Viewer-FileNotFound","default-msg":'<title> Sorry </title><message>We cant display the item you are looking for. It may not have been processed yet. It may have been moved, deleted, or you may be using a corrupt file or unsupported file format.</message><hint> Try loading the item again.</hint><hint> Please upload the file again to see if that fixes the issue.</hint><hint> <a href="http://help.autodesk.com/view/ADSK360/ENU/?guid=GUID-488804D0-B0B0-4413-8741-4F5EE0FACC4A" target="_blank">See a list of supported formats.</a></hint>'},6:{img:"img-reload","globalized-msg":"Viewer-ServerError","default-msg":"<title> Sorry </title><message>We seem to have some technical difficulties and couldn't complete your request.</message><hint> Try loading the item again.</hint><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},7:{img:"img-reload","globalized-msg":"Viewer-UnhandledResponseCode","default-msg":"<title> Network problem </title><message>Sorry. We seem to have some technical difficulties and couldn't complete your request.</message><hint> Try loading the item again.</hint><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},8:{img:"img-unsupported","globalized-msg":"Viewer-WebGlNotSupported","default-msg":'<title>Sorry</title><message>We can\'t show this item because this browser doesn\'t support WebGL.</message><hint>Try Google Chrome, Mozilla Firefox, or another browser that supports WebGL 3D graphics.</hint><hint>For more information, see the <a href="WEBGL_HELP" target="_blank">A360 browser reqirements.</a></hint>'},9:{img:"img-item-not-found","globalized-msg":"Viewer-NoViewable","default-msg":"<title> No viewable content </title><message>Theres nothing to display for this item. It may not have been processed or it may not have content we can display.</message><hint> Please contact the author.</hint><hint> Please upload the file again to see if that fixes the issue.</hint>"},10:{img:"img-unsupported","globalized-msg":"Viewer-WebGlDisabled","default-msg":'<title>Sorry</title><message>We can\'t show this item because WebGL is disabled on this device.</message><hint> For more information see the <a href="WEBGL_HELP" target="_blank">A360 Help.</a></hint>'},11:{img:"img-item-not-found","globalized-msg":"Viewer-ModeIsEmpty","default-msg":"<title>Model is empty</title><message>Model is empty, there is no geometry for the viewer to show.</message><hint> Please contact the author.</hint><hint> Please upload the file again to see if that fixes the issue.</hint>"},12:{img:"img-unsupported","globalized-msg":"Viewer-RTCError","default-msg":"<title> Sorry </title><message>We couldnt connect to the Collaboration server.</message><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},13:{img:"img-unsupported","globalized-msg":"Viewer-FileExtNotSupported","default-msg":{title:"Sorry",message:"The file extension loaded into the Viewer is not supported",hints:["Try a different file"]}},15:{img:"img-unsupported","globalized-msg":"Viewer-WebGlContextLost","default-msg":{title:"WebGL context lost",message:"Unable to recover from software mode.  Please restart your browser and reload the Viewer",hints:["If you continue to encounter this issue when viewing this model, we recommend switching to a different browser."]}}};function c(){}c.prototype.constructor=c,c.reportError=function(e,t,n,s,u,h){if(c.currentError=null,c.currentErrors=null,t){var d={category:"error",code:t,message:n,httpStatusCode:s,httpStatusText:u};r.logger.track(d,!0),c.currentError=[e,t,n,h];var p=l[t];if(p){(b={defaultValue:""}).defaultValue=p["default-msg"];var f=p.img,m=p["globalized-msg"],g=this.parseErrorString(m,b);if(t===Autodesk.Viewing.ErrorCodes.BROWSER_WEBGL_DISABLED||t===Autodesk.Viewing.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED)for(var v=(0,a.getWebGLHelpLink)()||"http://www.autodesk.com/a360-browsers",y=0;y<g.hints.length;y++){-1!==g.hints[y].indexOf('href="WEBGL_HELP"')&&(g.hints[y]=g.hints[y].replace('href="WEBGL_HELP"','href="'+v+'"'))}i.AlertBox.displayError(e,g.msg,g.header,f,g.hints)}else{f="img-unsupported";var b={defaultValue:"",interpolationPrefix:"{",interpolationSuffix:"}"};this.parseArguments(n,b),(g=this.parseErrorString(t,b)).header||(g.header="warning"===h?o.Z.t("header-warning"):""),i.AlertBox.displayError(e,g.msg,g.header,f,g.hints,t)}}},c.reportErrors=function(e,t){if(c.currentError=null,c.currentErrors=null,t){c.currentErrors=[e,t];for(var n={defaultValue:"",interpolationPrefix:"{",interpolationSuffix:"}"},a=[],s=0;s<t.length;s++)if(t[s].code){this.parseArguments(t[s].message,n);var l=this.parseErrorString(t[s].code,n);l.header||(l.header="warning"===t[0].type?o.Z.t("header-warning",{defaultValue:"Warning"}):""),a.push(l);var u={category:"error",code:t[s].code,message:t[s].message};r.logger.track(u,!0)}if(a.length){i.AlertBox.displayErrors(e,"img-unsupported",a)}}},c.parseArguments=function(e,t){if(e)if("string"==typeof e)t.defaultValue=e;else{t.defaultValue=e[0];for(var n=1;n<e.length;n++){t[(n-1).toString()]=e[n]}}},c.parseErrorString=function(e,t){var n={msg:null,msgList:null,header:null,hints:null};if(!e)return n;if("object"===s(t.defaultValue)){var i=t.defaultValue;return n.header=i.title,n.msg=i.message,n.hints=i.hints.concat(),n}var r=o.Z.t(e,t);if(!r)return n;if(-1!=r.indexOf("<title>")){var a=r.split("<title>")[1].split("</title>");n.header=a[0],r=a[1]}if(r&&-1!=r.indexOf("<message>")){a=r.split("<message>")[1].split("</message>");n.msg=a[0],r=a[1]}else n.msg=r;if(r&&-1!=r.indexOf("<hint>")){n.hints=[];for(var l=r.split("<hint>"),c=0;c<l.length;c++){var u=l[c].split("</hint")[0];n.hints.push(u)}}return n},c.localize=function(){if(i.AlertBox.instances.length>0)if(i.AlertBox.dismiss(),c.currentError){var e=c.currentError.shift(),t=c.currentError;c.reportError(e,t[0],t[1],t[2])}else{e=c.currentErrors.shift();var n=c.currentErrors[0];c.reportErrors(e,n)}},c.dismissError=function(e){return i.AlertBox.dismissByTag(e)}},66803:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GuiViewer3D:()=>C});var i=n(37169),r=n(55412),o=n(24327),a=n(84998),s=n(79659),l=n(41471),c=n(71224),u=n(58660),h=n(17167),d=n(98926),p=n(42024),f=n(36311),m=n(42106),g=n(66704),v=n(96250),y=n(6355),b=n(56441),_=n(76095),x=n(42430),E=n(89853),w=n(65663),S=n(51676),A=n(73306);function M(e,t){(null==t?void 0:t.globalManager)&&this.setGlobalManager(t.globalManager),A.ToolBar.call(this,e,t),this.onToolbarUpdated=(null==t?void 0:t.onToolbarUpdated)||function(){},this.screenModeDelegate=null==t?void 0:t.screenModeDelegate,this.navigation=null==t?void 0:t.navigation,this.onClickViewerOption=(null==t?void 0:t.onClickViewerOption)||function(){},this.onClickRenderOptions=(null==t?void 0:t.onClickRenderOptions)||function(){},this.onClickFullScreen=(null==t?void 0:t.onClickFullScreen)||function(){},this.navTools=new S.RadioButtonGroup(y.TOOLBAR.NAVTOOLSID),this.modelTools=new g.ControlGroup(y.TOOLBAR.MODELTOOLSID),this.settingsTools=new g.ControlGroup(y.TOOLBAR.SETTINGSTOOLSID),this.addControl(this.navTools),this.addControl(this.modelTools),this.addControl(this.settingsTools)}n(35449).GlobalManagerMixin.call(M.prototype),M.prototype=Object.create(A.ToolBar.prototype),M.prototype.constructor=M,M.prototype.initRenderOptionsButton=function(){this.settingsTools&&!this.renderOptionsButton&&(this.renderOptionsButton=new m.Button("toolbar-renderOptionsTool"),this.renderOptionsButton.setToolTip("Rendering options"),this.renderOptionsButton.setIcon("adsk-icon-settings-render"),this.renderOptionsButton.onClick=this.onClickRenderOptions,this.settingsTools.addControl(this.renderOptionsButton))},M.prototype.initSettingsOptionsButton=function(){var e=new m.Button("toolbar-settingsTool");this.viewerOptionButton=e,e.setIcon("adsk-icon-settings"),e.setToolTip("Settings"),this.viewerOptionButton.onClick=this.onClickViewerOption,this.settingsTools.addControl(e)},M.prototype.initModelTools=function(){if(!this.settingsTools.fullscreenbutton){var e=new m.Button("toolbar-fullscreenTool",{collapsible:!1});e.setToolTip("Full screen"),e.setIcon("adsk-icon-fullscreen"),e.onClick=this.onClickFullScreen,this.settingsTools.addControl(e),this.settingsTools.fullscreenbutton=e,this.updateFullscreenButton(this.screenModeDelegate.getMode())}},M.prototype.updateFullscreenButton=function(e){var t="adsk-icon-fullscreen";switch(e){case w.ScreenMode.kNormal:this.screenModeDelegate.isModeSupported(w.ScreenMode.kFullBrowser)||(t="adsk-icon-fullscreen");break;case w.ScreenMode.kFullBrowser:t=this.screenModeDelegate.isModeSupported(w.ScreenMode.kFullScreen)?"adsk-icon-fullscreen":"adsk-icon-fullscreen-exit";break;case w.ScreenMode.kFullScreen:t="adsk-icon-fullscreen-exit"}this.settingsTools.fullscreenbutton.setIcon(t)},M.prototype.updateToolbarButtons=function(e,t){var n,i,r;r=e>310?"block":"none",(i=this.modelTools.getControl("toolbar-explodeTool"))&&i.setDisplay(r),r=e>380?"block":"none",(i=this.modelTools.getControl("toolbar-collaborateTool"))&&i.setDisplay(r),r=e>515?"block":"none";var o=this.navTools.getControl("toolbar-cameraSubmenuTool");o&&(o.setDisplay(r),(i=o.subMenu.getControl("toolbar-homeTool"))&&i.setDisplay(this.navigation.isActionEnabled("gotoview")?"block":"none"),(i=o.subMenu.getControl("toolbar-fitToViewTool"))&&i.setDisplay(this.navigation.isActionEnabled("gotoview")?"block":"none"),(i=o.subMenu.getControl("toolbar-focalLengthTool"))&&i.setDisplay(this.navigation.isActionEnabled("fov")?"block":"none"),(i=o.subMenu.getControl("toolbar-rollTool"))&&i.setDisplay(this.navigation.isActionEnabled("roll")?"block":"none")),r=e>700?"block":"none",(i=this.modelTools.getControl("toolbar-measureTool"))&&i.setDisplay(r),(i=this.modelTools.getControl("toolbar-sectionTool"))&&i.setDisplay(r),r=e>740?"block":"none",(i=this.navTools.getControl("toolbar-beelineTool"))&&i.setDisplay(this.navigation.isActionEnabled("walk")?r:"none"),(i=this.navTools.getControl("toolbar-firstPersonTool"))&&i.setDisplay(this.navigation.isActionEnabled("walk")?r:"none"),(i=this.navTools.getControl("toolbar-zoomTool"))&&i.setDisplay(this.navigation.isActionEnabled("zoom")?r:"none"),(i=this.navTools.getControl("toolbar-panTool"))&&i.setDisplay(this.navigation.isActionEnabled("pan")?r:"none"),(i=this.navTools.getControl("toolbar-orbitTools"))&&i.setDisplay(this.navigation.isActionEnabled("orbit")?r:"none"),null===(n=this.onToolbarUpdated)||void 0===n||n.call(this,e,t)},M.prototype.registerCustomizeToolbarCB=function(e){this.onToolbarUpdated=e};var T=n(49710);function C(e,t){t||(t={}),t.startOnInitialize=!1,o.Viewer3D.call(this,e,t),this.toolbar=null,this.dockingPanels=[],this.onFullScreenModeEvent=this.onFullScreenModeEvent.bind(this),this.onProgressBarUpdate=this.onProgressBarUpdate.bind(this)}C.prototype=Object.create(o.Viewer3D.prototype),C.prototype.constructor=C,C.prototype.initialize=function(e){var t=o.Viewer3D.prototype.initialize.call(this,e);if(t>0)return v.ErrorHandler.reportError(this.container,t),t;var n=this;if(this.toolController){var r=new p.HotGestureTool(this);this.toolController.registerTool(r),this.toolController.activateTool(r.getName())}return this.addEventListener(i.FULLSCREEN_MODE_EVENT,this.onFullScreenModeEvent),this.contextMenu||this.setDefaultContextMenu(),this.progressbar=new _.ProgressBar(this.container),this.addEventListener(i.PROGRESS_UPDATE_EVENT,this.onProgressBarUpdate),this.addEventListener(i.VIEWER_RESIZE_EVENT,(function(e){var t;n.resizePanels(),null===(t=n.toolbar)||void 0===t||t.updateToolbarButtons(e.width,e.height)})),this.addEventListener(i.NAVIGATION_MODE_CHANGED_EVENT,(function(){var e;null===(e=n.toolbar)||void 0===e||e.updateToolbarButtons(n.container.clientWidth,n.container.clientHeight)})),this.initEscapeHandlers(),this.localize(),this.addEventListener(i.WEBGL_CONTEXT_LOST_EVENT,function(){for(var e=this.container,t=e.childElementCount,n=0;n<t;++n)e.children[n].classList.add("hide-while-context-lost");v.ErrorHandler.reportError(this.container,s.ErrorCodes.WEBGL_LOST_CONTEXT)}.bind(this)),this.addEventListener(i.WEBGL_CONTEXT_RESTORED_EVENT,function(){for(var e=this.container,t=e.childElementCount,n=0;n<t;++n)e.children[n].classList.remove("hide-while-context-lost");v.ErrorHandler.dismissError(s.ErrorCodes.WEBGL_CONTEXT_LOST_EVENT)}.bind(this)),this.run(),0},C.prototype.uninitialize=function(){this.viewerSettingsPanel&&(this.viewerSettingsPanel.uninitialize(),this.viewerSettingsPanel=null),this.renderoptions&&(this.renderoptions.uninitialize(),this.renderoptions=null),this.viewerOptionButton&&(this.viewerOptionButton=null),this.removeEventListener(i.FULLSCREEN_MODE_EVENT,this.onFullScreenModeEvent),this.removeEventListener(i.PROGRESS_UPDATE_EVENT,this.onProgressBarUpdate),this.progressbar=null,this.debugMenu=null,this.modelStats=null,this.toolbar=null,o.Viewer3D.prototype.uninitialize.call(this)},C.prototype.setUp=function(e){e||(e={}),e.startOnInitialize=!1,o.Viewer3D.prototype.setUp.call(this,e)},C.prototype.tearDown=function(){o.Viewer3D.prototype.tearDown.call(this),this.toolbar&&(this.toolbar.container.parentNode.removeChild(this.toolbar.container),this.toolbar=null),this.viewerSettingsPanel&&this.setSettingsPanel(null),this.renderoptions&&(this.removePanel(this.renderoptions),this.renderoptions.uninitialize(),this.renderoptions=null),this.debugMenu=null,this.removeEventListener(i.GEOMETRY_LOADED_EVENT,this.checkGeometry),this.checkGeometry=null},C.prototype.onPostExtensionLoad=function(e){var t,n=this.getToolbar();n&&e.onToolbarCreated&&e.onToolbarCreated(n),null===(t=this.toolbar)||void 0===t||t.updateToolbarButtons(this.container.clientWidth,this.container.clientHeight)},C.prototype.loadModel=function(e,t,n,i,r){var a=this;var l=o.Viewer3D.prototype.loadModel.call(this,e,t,(function(e){setTimeout((function(){t&&(t.loadAsHidden||t.headlessViewer)||function(e){a.running?a.createUI(e):d.logger.error("createUI expects the viewer to be running.",(0,s.errorCodeString)(s.ErrorCodes.VIEWER_INTERNAL_ERROR))}(e),n&&n.call(n,e)}),1)}),(function(e){e!==s.ErrorCodes.LOAD_CANCELED?v.ErrorHandler.reportError(a.container,e):d.logger.warn("A load was canceled"),i&&i.apply(i,arguments)}),r);return l},C.prototype.createUI=function(e,t){var n=this;if(this.model===e||t){var r=this,o=this._createToolbar();this.checkGeometry=function(e){setTimeout((function(){if(!r.impl.is2d&&e.model&&!e.model.hasGeometry()){var t=s.ErrorCodes.BAD_DATA_MODEL_IS_EMPTY;v.ErrorHandler.reportError(r.container,t,"Model is empty"),r._loadingSpinner.hide()}}),1)};var l=this.config.disabledExtensions||{},c=function(e){return-1===(n.profile&&n.profile.extensions.unload?n.profile.extensions.unload:[]).indexOf(e)};this.initModelTools(e),(0,a.getGlobal)().ENABLE_DEBUG&&this.initDebugTools(),"true"===(0,h.getParameterByName)("lmv_viewer_debug")&&this.loadExtension("Autodesk.Debug",this.config);var u=function(e){r.getExtension(e)&&r.unloadExtension(e)};e.is2d()&&(u("Autodesk.BimWalk"),u("Autodesk.Section"),u("Autodesk.Viewing.FusionOrbit"),u("Autodesk.Explode")),l.measure||u("Autodesk.Measure"),o&&(this.dispatchEvent({type:y.TOOLBAR_CREATED_EVENT}),this.forEachExtension((function(e){e.onToolbarCreated&&e.onToolbarCreated(n.toolbar)})));var d="Autodesk.DefaultTools.NavTools",p=this.getExtension(d);p?p.updateUI(e.is3d()):this.loadExtension(d,r.config),this.resize(),e.is2d()?(this.setDefaultNavigationTool("pan"),this.setClickToSetCOI(!1,!1),setTimeout((function(){var e={viewcube:"Autodesk.ViewCubeUi",measure:"Autodesk.Measure",hyperlink:"Autodesk.Hyperlink",layerManager:"Autodesk.LayerManager",propertiesPanel:"Autodesk.PropertiesManager"};for(var t in(0,a.isMobileDevice)()||(e.boxSelection="Autodesk.BoxSelection"),e){var n=e[t];!l[t]&&c(n)&&r.loadExtension(n,r.config)}}),1)):(-1===this.getDefaultNavigationToolName().indexOf("orbit")&&this.setDefaultNavigationTool("orbit"),setTimeout((function(){var e={viewcube:"Autodesk.ViewCubeUi",explode:"Autodesk.Explode",bimwalk:"Autodesk.BimWalk",fusionOrbit:"Autodesk.Viewing.FusionOrbit",measure:"Autodesk.Measure",section:"Autodesk.Section",layerManager:"Autodesk.LayerManager",modelBrowser:"Autodesk.ModelStructure",propertiesPanel:"Autodesk.PropertiesManager"};for(var t in(0,a.isMobileDevice)()||(e.boxSelection="Autodesk.BoxSelection"),e){var n=e[t];!l[t]&&c(n)&&r.loadExtension(n,r.config)}!l.scalarisSimulation&&c("Autodesk.Viewing.ScalarisSimulation")&&r.model&&r.model.isScalaris&&r.loadExtension("Autodesk.Viewing.ScalarisSimulation",r.config)}),1),e.isLoadDone()?this.checkGeometry({model:e}):this.addEventListener(i.GEOMETRY_LOADED_EVENT,this.checkGeometry,{once:!0}))}},C.prototype.onFullScreenModeEvent=function(e){this.resizePanels(),this.toolbar.updateFullscreenButton(e.mode)},C.prototype.onProgressBarUpdate=function(e){e.percent>=0&&this.progressbar.setPercent(e.percent)},C.prototype.addOptionToggle=function(e,t,n,i,r){var o=r?this.prefs[r]:null;n="boolean"==typeof o?o:n;var s=this.getDocument(),l=s.createElement("li");l.className="toolbar-submenu-listitem";var u=s.createElement("input");u.className="toolbar-submenu-checkbox",u.type="checkbox",u.id=t,l.appendChild(u);var h=s.createElement("label");return h.setAttribute("for",t),h.setAttribute("data-i18n",t),h.textContent=c.Z.t(t),l.appendChild(h),e.appendChild(l),u.checked=n,u.addEventListener("touchstart",a.touchStartToClick),h.addEventListener("touchstart",a.touchStartToClick),l.addEventListener("touchstart",a.touchStartToClick),u.addEventListener("click",(function(e){i(u.checked),e.stopPropagation()})),h.addEventListener("click",(function(e){e.stopPropagation()})),l.addEventListener("click",(function(e){i(!u.checked),e.stopPropagation()})),r&&this.prefs.addListeners(r,(function(e){u.checked=e}),(function(e){u.checked=e,i(e)})),u},C.prototype.addOptionList=function(e,t,n,i,r,o){var a=this.prefs[o];i="number"==typeof a?a:i;var s=this.getDocument(),l=s.createElement("select");l.className="option-drop-down",l.id="selectMenu_"+t;for(var u=0;u<n.length;u++){var h=s.createElement("option");h.value=u,h.setAttribute("data-i18n",n[u]),h.textContent=c.Z.t(n[u]),l.add(h)}var d=s.createElement("li");d.className="toolbar-submenu-select";var p=s.createElement("div");return p.className="toolbar-submenu-selectlabel",p.setAttribute("for",t),p.setAttribute("data-i18n",t),p.textContent=c.Z.t(t),d.appendChild(p),d.appendChild(l),e.appendChild(d),l.selectedIndex=i,l.onchange=function(e){var t=e.target.selectedIndex;r(t),e.stopPropagation()},l.addEventListener("touchstart",(function(e){e.stopPropagation()})),l.addEventListener("click",(function(e){e.stopPropagation()})),o&&this.prefs.addListeners(o,(function(e){l.selectedIndex=e}),(function(e){l.selectedIndex=e,r(e)})),l},C.prototype.showViewer3dOptions=function(e){var t=this.getSettingsPanel(!0);e&&t.isVisible()&&t.setVisible(!1),t.setVisible(e)},C.prototype.showRenderingOptions=function(e){e&&this._createRenderingOptionsPanel(),this.renderoptions&&this.renderoptions.setVisible(e)},C.prototype._createRenderingOptionsPanel=function(){this.renderoptions||this.model.is2d()||(this.renderoptions=new x.RenderOptionsPanel(this),this.addPanel(this.renderoptions),this.toolbar.initRenderOptionsButton())},C.prototype.showLayerManager=function(){d.logger.warn('viewer.showLayerManager() is now handled the extension "Autodesk.LayerManager" and will be removed in version 8.0.0.')},C.prototype.initHotkeys=function(){d.logger.warn("viewer.initHotkeys() has been deprecated and will be removed in version 8.0.0.")},C.prototype.setModelStructurePanel=function(e){d.logger.warn('viewer.setModelStructurePanel() is deprecated and will be removed in v8.0.0 - Use extension "Autodesk.ModelStructure".');var t=this.getExtension("Autodesk.ModelStructure");return!!t&&t.setModelStructurePanel(e)},C.prototype.setLayersPanel=function(){d.logger.warn('viewer.setLayersPanel() is now handled the extension "Autodesk.LayerManager" and will be removed in version 8.0.0.')},C.prototype.setPropertyPanel=function(e){d.logger.warn('viewer.setPropertyPanel() is now handled by extension "Autodesk.PropertiesManager" and will be removed in version 8.0.0.');var t=this.getExtension("Autodesk.PropertiesManager");return!!t&&t.setPanel(e)},C.prototype.getPropertyPanel=function(e){d.logger.warn('viewer.getPropertyPanel() is now handled the extension "Autodesk.PropertiesManager" and will be removed in version 8.0.0.');var t=this.getExtension("Autodesk.PropertiesManager");return!t&&e&&(this.loadExtension("Autodesk.PropertiesManager"),t=this.getExtension("Autodesk.PropertiesManager")),t?t.getPanel():null},C.prototype.setSettingsPanel=function(e){var t=this;return(e instanceof E.SettingsPanel||!e)&&(this.viewerSettingsPanel&&(this.viewerSettingsPanel.setVisible(!1),this.removePanel(this.viewerSettingsPanel),this.viewerSettingsPanel.uninitialize()),this.viewerSettingsPanel=e,e&&(this.addPanel(e),e.addVisibilityListener((function(n){var i;n&&t.onPanelVisible(e,t),null===(i=t.toolbar)||void 0===i||i.viewerOptionButton.setState(n?m.Button.State.ACTIVE:m.Button.State.INACTIVE)}))),!0)},C.prototype.getSettingsPanel=function(e,t){return!this.viewerSettingsPanel&&e&&this.createSettingsPanel(t||this.model),this.viewerSettingsPanel},C.prototype.createSettingsPanel=function(e){var t=new T.ViewerSettingsPanel(this,e);this.setSettingsPanel(t),t.syncUI(),this.toolbar.initSettingsOptionsButton(),this.dispatchEvent({type:y.SETTINGS_PANEL_CREATED_EVENT})},C.prototype.initModelTools=function(e){this.createSettingsPanel(e),(0,a.getGlobal)().ENABLE_DEBUG&&this._createRenderingOptionsPanel(),this.canChangeScreenMode()&&(0,a.isFullscreenEnabled)(this.getDocument())&&(this.toolbar.initModelTools(),this.toolbar.updateFullscreenButton(this.getScreenMode()))},C.prototype.setPropertiesOnSelect=function(e){d.logger.warn('viewer.setPropertiesOnSelect() is now handled by viewer.prefs.set("openPropertiesOnSelect", <boolean>) and will be removed in version 8.0.0.'),this.prefs.set(r.Prefs.OPEN_PROPERTIES_ON_SELECT,e)},C.prototype.addDivider=function(e){var t=this.getDocument().createElement("li");return t.className="toolbar-submenu-horizontal-divider",e.appendChild(t),t},C.prototype.initDebugTools=function(){if(this.debugMenu)return!1;var e=new g.ControlGroup("debugTools");this.debugMenu=e;var t=new m.Button("toolbar-debugTool");return t.setIcon("adsk-icon-bug"),e.addControl(t),this.debugMenu.debugSubMenuButton=t,this.createDebugSubmenu(this.debugMenu.debugSubMenuButton),this.toolbar.addControl(e),!0},C.prototype.removeDebugTools=function(){this.debugMenu&&(this.debugMenu.removeFromParent(),this.debugMenu=null)},C.prototype.createDebugSubmenu=function(e){var t=this,n=this.getDocument().createElement("div");n.id="toolbar-debugToolSubmenu",n.classList.add("toolbar-submenu"),n.classList.add("toolbar-settings-sub-menu"),n.classList.add("adsk-hidden"),this.debugMenu.subMenu=n,this.debugMenu.subMenu.style.minWidth="180px",this.container.appendChild(n),this.initModelStats(),this.addDivider(n),this.addDivider(n);var i=u.Lang.getLanguages(),r=i.map((function(e){return e.label})),o=i.map((function(e){return e.symbol}));function s(){t.localize()}var c=t.selectedLanguage?t.selectedLanguage:0;this.addOptionList(n,"Language",r,c,(function(e){var n=o[e];t.selectedLanguage=e,(0,l.setLanguage)(n,s)}),null).parentNode.style.paddingBottom="15px",this.addDivider(this.debugMenu.subMenu);this.addOptionList(n,"Error",["UNKNOWN FAILURE","BAD DATA","NETWORK ERROR","NETWORK ACCESS DENIED","NETWORK FILE NOT FOUND","NETWORK SERVER ERROR","NETWORK UNHANDLED RESPONSE CODE","BROWSER WEBGL NOT SUPPORTED","BAD DATA NO VIEWABLE CONTENT"],0,(function(e){var n=e+1;v.ErrorHandler.reportError(t.container,n,"")}),null).parentNode.style.paddingBottom="15px";var h=n.getBoundingClientRect();this.debugMenu.subMenu.style.width=h.width+"px",this.container.removeChild(n),e.container.appendChild(n);var d=h.left+h.width,p=this.container.getBoundingClientRect().right;if(d>p){var f=-(d-p+10)+"px";this.debugMenu.subMenu.style.left=f}e.onMouseOver=function(){n.classList.remove("adsk-hidden")},e.onMouseOut=function(){n.classList.add("adsk-hidden")},(0,a.isTouchDevice)()&&(e.onClick=function(){n.classList.toggle("adsk-hidden")})},C.prototype.initModelStats=function(){var e=this;function t(t){var n=e.impl,i="";e.model&&(i+="Geom&nbsp;polys:&nbsp;"+n.modelQueue().getGeometryList().geomPolyCount+"<br>",i+="Instance&nbsp;polys:&nbsp;"+n.modelQueue().getGeometryList().instancePolyCount+"<br>",i+="Fragments:&nbsp;"+n.modelQueue().getFragmentList().getCount()+"<br>",i+="Geoms:&nbsp;"+n.modelQueue().getGeometryList().geoms.length+"<br>",i+="Loading&nbsp;time:&nbsp;"+(n.model.loader.loadTime/1e3).toFixed(2)+" s<br>"),i+="# "+(t||""),e.modelStats.innerHTML=i}this.addOptionToggle(this.debugMenu.subMenu,"Model statistics",!1,(function(n){var r;n&&!e.modelStats&&(r=e.getDocument(),e.modelStats=r.createElement("div"),e.modelStats.className="statspanel",e.container.appendChild(e.modelStats),e.addEventListener(i.PROGRESS_UPDATE_EVENT,(function(e){e.message&&t(e.message)})),e.fpsDisplay=r.createElement("div"),e.fpsDisplay.className="fps",e.container.appendChild(e.fpsDisplay),t("")),e.modelStats.style.visibility=n?"visible":"hidden",e.fpsDisplay.style.visibility=n?"visible":"hidden",e.impl.fpsCallback=n?function(t){e.fpsDisplay.textContent=""+(0|t)}:null}))},C.prototype.initEscapeHandlers=function(){var e=this;this.addEventListener(i.ESCAPE_EVENT,(function(){if(!e.contextMenu||!e.contextMenu.hide())if(e.renderoptions&&e.renderoptions.isVisible())e.renderoptions.setVisible(!1);else if(e.impl.selector.hasSelection())e.clearSelection();else{if(e.getActiveNavigationTool()!==e.getDefaultNavigationToolName())return e.toolController&&e.toolController.setIsLocked(!1),e.setActiveNavigationTool(),void b.HudMessage.dismiss();if(e.areAllVisible()){if(!f.AlertBox.dismiss()){for(var t=0;t<e.dockingPanels.length;++t){var n=e.dockingPanels[t];if("none"!==n.container.style.display&&""!==n.container.style.display)return void n.setVisible(!1)}e.escapeScreenMode()}}else e.showAll()}}))},C.prototype.getToolbar=function(){return this.toolbar},C.prototype._createToolbar=function(){var e=this;if(this.toolbar)return!1;var t=this;if(this.toolbar=new M("guiviewer3d-toolbar",{globalManager:this.globalManager,navigation:this.navigation,screenModeDelegate:this.getScreenModeDelegate(),onClickFullScreen:t.nextScreenMode.bind(t),onClickRenderOptions:function(){var t=e.renderoptions&&e.renderoptions.isVisible();e.renderoptions.setVisible(!t)},onClickViewerOption:function(){t.getSettingsPanel(!0).isVisible()?t.showViewer3dOptions(!1):t.showViewer3dOptions(!0)}}),this._forgeLogo){var n=this._forgeLogo.getBoundingClientRect();this.toolbar.container.style.bottom="".concat(n.height+10,"px")}return this.container.appendChild(this.toolbar.container),this.toolbar.updateToolbarButtons(this.container.clientWidth,this.container.clientHeight,this.navigation),!0},C.prototype.showModelStructurePanel=function(e){d.logger.warn('viewer.showModelStructurePanel() is deprecated and will be removed in v8.0.0 - Use extension "Autodesk.ModelStructure".'),e?this.activateExtension("Autodesk.ModelStructure"):this.deactivateExtension("Autodesk.ModelStructure")},C.prototype.onPanelVisible=function(e){this.dockingPanels.splice(this.dockingPanels.indexOf(e),1),this.dockingPanels.splice(0,0,e)},C.prototype.localize=function(){o.Viewer3D.prototype.localize.call(this),this.debugMenu&&this.debugMenu.debugSubMenuButton&&(this.debugMenu.debugSubMenuButton.container.removeChild(this.debugMenu.subMenu),this.createDebugSubmenu(this.debugMenu.debugSubMenuButton)),v.ErrorHandler.localize()},C.prototype.addPanel=function(e){return-1===this.dockingPanels.indexOf(e)&&(this.dockingPanels.push(e),!0)},C.prototype.removePanel=function(e){var t=this.dockingPanels.indexOf(e);return t>-1&&(this.dockingPanels.splice(t,1),!0)},C.prototype.resizePanels=function(e){e=e||{};var t=this.toolbar?this.toolbar.getDimensions().height:0,n=this.getDimensions(),i=n.height;e.dimensions&&e.dimensions.height?i=e.dimensions.height:e.dimensions={height:n.height,width:n.width},e.dimensions.height=i-t;var r=e?e.dockingPanels:null;r||(r=this.dockingPanels);var o,a,s=this.container.getBoundingClientRect(),l=s.top,c=s.bottom,u=s.left,h=s.right;e&&e.dimensions?(o=e.dimensions.width,c=l+(a=e.dimensions.height)):(o=s.width,a=s.height);for(var d=0;d<r.length;++d)r[d].onViewerResize(l,c,u,h,o,a)},C.prototype.initExplodeSlider=function(){d.logger.warn('viewer.initExplodeSlider() has been replaced by extension "Autodesk.Explode". initExplodeSlier() will be removed in version 7.0.0.')},C.prototype.registerCustomizeToolbarCB=function(e){var t,n;null===(t=this.toolbar)||void 0===t||t.registerCustomizeToolbarCB(e.bind(null,this)),null===(n=this.toolbar)||void 0===n||n.updateToolbarButtons(this.container.clientWidth,this.container.clientHeight)},Object.defineProperty(C.prototype,"navTools",{get:function(){var e;return null===(e=this.toolbar)||void 0===e?void 0:e.navTools}}),Object.defineProperty(C.prototype,"modelTools",{get:function(){var e;return null===(e=this.toolbar)||void 0===e?void 0:e.modelTools}}),Object.defineProperty(C.prototype,"settingsTools",{get:function(){var e;return null===(e=this.toolbar)||void 0===e?void 0:e.settingsTools}}),Object.defineProperty(C.prototype,"updateFullscreenButton",{get:function(){var e;return null===(e=this.toolbar)||void 0===e?void 0:e.updateFullscreenButton.bind(this)}}),Autodesk.Viewing.Private.GuiViewer3D=C},6355:(e,t,n)=>{"use strict";n.r(t),n.d(t,{TOOLBAR_CREATED_EVENT:()=>i,SETTINGS_PANEL_CREATED_EVENT:()=>r,VIEW_CUBE_CREATED_EVENT:()=>o,TOOLBAR:()=>a});var i="toolbarCreated",r="settingsPanelCreated",o="viewCubeCreated",a={NAVTOOLSID:"navTools",MODELTOOLSID:"modelTools",SETTINGSTOOLSID:"settingsTools",MEASURETOOLSID:"measureTools"}},56441:(e,t,n)=>{"use strict";n.r(t),n.d(t,{HudMessage:()=>r});var i=n(71224);function r(){}r.instances=[],r.displayMessage=function(e,t,n,o,a){var s=e.ownerDocument,l=s.defaultView||s.parentWindow;function c(e){var t=l.getComputedStyle(e),n=parseInt(t["margin-top"]),i=parseInt(t["margin-bottom"]);return e.getBoundingClientRect().height+n+i}function u(e,t,n){var i=l.getComputedStyle(e,null);if(!Array.isArray(t))return i[t];for(var r=n||{},o=0;o<t.length;o++){var a=t[o];r[a]=i[a]}return r}if(!(r.instances.length>0)){var h=t.msgTitleKey,d=t.msgTitleDefaultValue||h,p=t.messageKey,f=t.messageDefaultValue||p,m=t.buttonText,g=t.checkboxChecked||!1,v=t.position||"center",y=s.createElement("div");if(y.classList.add("docking-panel"),y.classList.add("hud"),"top"===v&&y.classList.add("top"),e.appendChild(y),h){var b,_=s.createElement("div");_.classList.add("docking-panel-title"),_.classList.add("docking-panel-delimiter-shadow"),_.textContent=i.Z.t(h,{defaultValue:d}),_.setAttribute("data-i18n",h),y.appendChild(_),n&&((b=s.createElement("div")).classList.add("docking-panel-close"),b.addEventListener("click",(function(e){r.dismiss(),n&&n(e)})),y.appendChild(b));var x=u(_,["width","font-size"]),E=function(e){var t=e.textContent,n=s.createElement("span");u(e,["font-size","font-weight","text-transform","padding","white-space","font-family"],n.style),n.textContent=t,n.style.position="absolute",n.style.top="10000px",n.style.left="-10000px",s.body.appendChild(n);var i=n.offsetWidth;return s.body.removeChild(n),i}(_),w=parseFloat(x["font-size"]),S=b?parseFloat(u(b,"width")):0,A=parseFloat(x.width)-S;_.style["font-size"]="".concat(E>A?A/E*w:w,"px")}var M=s.createElement("div");M.classList.add("hud-client"),M.classList.add("docking-panel-container-solid-color-b"),y.appendChild(M);var T=s.createElement("div");T.className="hud-message",T.textContent=i.Z.t(p,{defaultValue:f}),T.setAttribute("data-i18n",f),M.appendChild(T);var C=c(T);if(o){var P=s.createElement("div");P.classList.add("docking-panel-primary-button"),P.classList.add("hud-button"),P.textContent=i.Z.t(m,{defaultValue:m}),P.setAttribute("data-i18n",m),P.addEventListener("click",o),M.appendChild(P),C+=c(P)}if(a){var L=s.createElement("div"),R=s.createElement("input");R.className="hud-checkbox",R.type="checkbox",R.checked=g,L.appendChild(R);var D="Do not show this message again",I=s.createElement("label");I.setAttribute("for",D),I.setAttribute("data-i18n",D),I.textContent=i.Z.t(D,{defaultValue:D}),L.appendChild(I),R.addEventListener("change",a),M.appendChild(L),C+=c(a)}M.style.height=C+"px",y.style.height=C+(_?c(_):0)+"px";var O={hudMessage:y,container:e};r.instances.push(O)}},r.dismiss=function(){if(r.instances.length>0){var e=r.instances.pop();return e.hudMessage.style.visibility="hidden",e.container.removeChild(e.hudMessage),!0}return!1}},59005:(e,t,n)=>{"use strict";n.r(t),n.d(t,{LoadingSpinner:()=>r});var i=n(71224);function r(e){this.parentDiv=e;var t=this.getDocument();this.container=t.createElement("div"),this.container.innerHTML=['<div class="path">','<svg width="100%" height="100%" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">','<path d="M2.5,50a47.5,47.5 0 1,0 95,0a47.5,47.5 0 1,0 -95,0" vector-effect="non-scaling-stroke"/>','<path d="M 2.5 50 A 47.5 47.5 0 0 1 47.5 2.5" vector-effect="non-scaling-stroke"/>',"</svg>","</div>",'<div class="message" data-i18n="Spinner Loading">LOADING</div>'].join(""),this.container.className="loading-spinner"}n(35449).GlobalManagerMixin.call(r.prototype),r.prototype.addClass=function(e){this.container.classList.add(e)},r.prototype.attachToDom=function(){return!this.container.parentNode&&(i.Z.localize(this.container),this.parentDiv.appendChild(this.container),!0)},r.prototype.removeFromDom=function(){return!!this.container.parentNode&&(this.container.parentNode.removeChild(this.container),!0)},r.prototype.setVisible=function(e){e?this.attachToDom():this.removeFromDom()}},1204:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ModelStructurePanel:()=>m});var i=n(76723),r=n(79893),o=n(30814),a=n(98926),s=n(17167),l=n(71224);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}var u=-1,h=-2,d=-1e10;function p(e,t){o.TreeDelegate.call(this),this.panel=e,this.model=t;var n=this.getDocument();this.modelDiv=n.createElement("div"),this.modelDiv.classList.add("model-div"),this.modelDiv.setAttribute("lmv-modelId",t.id),this.instanceTree=null,this.rootId=u,this.state=1}function f(e){var t=function(e){var t=e.getData();if(t&&t.loadOptions&&t.loadOptions.modelNameOverride)return t.loadOptions.modelNameOverride;return""}(e);if(t)return t;if(!e.getData())return"";var n=e.getDocumentNode();return n?n.getModelName():"Model"}function m(e,t,n,r){i.DockingPanel.call(this,e,t,n,r),this.container.classList.add("model-structure-panel"),(r=r||{}).heightAdjustment||(r.heightAdjustment=40),r.marginTop||(r.marginTop=0),r.left=!0,this.createScrollContainer(r),this.onScroll=this.onScroll.bind(this),this.scrollContainer.addEventListener("scroll",this.onScroll),this.scrollContainer.style["overflow-x"]="hidden",this.options=r,this.tree=null,this._pendingModels=[],this.uiCreated=!1;var o=this;this.addVisibilityListener((function(e){e&&(o.uiCreated||o.createUI(),o.resizeToContent())}))}p.prototype=Object.create(o.TreeDelegate.prototype),p.prototype.constructor=p,p.prototype.isLoading=function(){return 1===this.state},p.prototype.isAvailable=function(){return 2===this.state},p.prototype.isNotAvailable=function(){return 3===this.state},p.prototype.isControlId=function(e){return e===u||e===h},p.prototype.getControlIdCss=function(e){return null},p.prototype.getRootId=function(){return this.rootId},p.prototype.getTreeNodeId=function(e){return"object"==c(e)?(a.logger.warn("Object used instead of dbId. Fix it."),e.dbId):e},p.prototype.getTreeNodeIndex=function(e){return this.instanceTree.nodeAccess.dbIdToIndex[e]},p.prototype.getTreeNodeLabel=function(e){if(e===u){var t=f(this.model);return l.Z.t("Loading model",{name:t})}return e===h||e===this.getRootId()?t=f(this.model):e==d?"Object 0":this.instanceTree.getNodeName(e,!0)||"Object "+e},p.prototype.getTreeNodeClass=function(e){return e===u||e===h?"message-unexpected":""},p.prototype.getTreeNodeParentId=function(e){if(e===d)return 0;var t=this.instanceTree.nodeAccess.getParentId(e);return 0===t?d:t},p.prototype.getTreeNodeCount=function(){return this.instanceTree.nodeAccess.getNumNodes()},p.prototype.getTreeNodeClientHeight=function(e){return 36},p.prototype.getTreeNodeDepthOffset=function(e,t){return 13+25*t},p.prototype.isTreeNodeGroup=function(e){return!this.isControlId(e)&&this.instanceTree.getChildCount(e)>0},p.prototype.shouldCreateTreeNode=function(e){return!0},p.prototype.createTreeNode=function(e,t){var n=this,i=n.getDocument();if(t.addEventListener("mousedown",(function(){var e=function(){this.classList.remove("highlight"),n.removeDocumentEventListener("mouseup",e)}.bind(t);t.classList.add("highlight"),n.addDocumentEventListener("mouseup",e)})),!this.isControlId(e)){var r=i.createElement("div");r.dbId=e,r.classList.add("visibility"),r.addEventListener("mousedown",(function(e){e.preventDefault(),e.stopPropagation()})),r.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var t=parseInt(e.target.dbId);this.panel.onEyeIcon(t,this.model)}.bind(this)),t.appendChild(r)}if(e===u){var a=i.createElement("img");a.src=(0,s.getResourceUrl)("res/ui/spinner.png"),a.style.animation="loading-spinner-perpetual-motion 1s infinite linear",a.style.float="right",a.style.marginRight="5px",a.style.width="20px",t.appendChild(a)}var l={localize:e===u||e===h};o.TreeDelegate.prototype.createTreeNode.call(this,e,t,l)},p.prototype.onTreeNodeRightClick=function(e,t,n){this.isControlId(t)||this.panel.onTreeNodeRightClick(e,t,this.model,n)},p.prototype.onTreeNodeClick=function(e,t,n){this.isControlId(t)||this.panel.onTreeNodeClick(e,t,this.model,n)},p.prototype.onTreeNodeDoubleClick=function(e,t,n){},p.prototype.onTreeNodeIconClick=function(e,t,n){if(this.isTreeNodeGroup(t)){var i=e.isCollapsed(this,t);e.setCollapsed(this,t,!i)}},p.prototype.onTreeNodeReized=function(e){},p.prototype.forEachChild=function(e,t,n){this.isControlId(e)||this.instanceTree.enumNodeChildren(e,t,n)},p.prototype.setInstanceTree=function(e){this.instanceTree=e,this.state=e?2:3,this.rootId=e?e.getRootId():h,function(e){var t=e.instanceTree;if(!t)return;var n,i=e.rootId,r=t.getNodeName(i),o=0,a=0;t.enumNodeChildren(i,(function(e){a||(n=t.getNodeName(e),o=e),a++})),e.hasDoubleRoot=1===a&&r===n,e.rootId=e.hasDoubleRoot?o:i}(this)},p.prototype.clean=function(){for(var e,t=this.modelDiv;e=t.lastChild;)t.removeChild(e)},m.prototype=Object.create(i.DockingPanel.prototype),m.prototype.constructor=m,m.prototype.uninitialize=function(){var e;this.scrollContainer.addEventListener("scroll",this.onScroll),this.scrollContainer.parentNode.removeChild(this.scrollContainer),null===(e=this.tree)||void 0===e||e.destroy(),i.DockingPanel.prototype.uninitialize.call(this)},m.prototype.addModel=function(e){if(e)if(this.uiCreated)this.createTreeUI(e);else{if(-1!==this._pendingModels.indexOf(e))return;this._pendingModels.push(e)}},m.prototype.unloadModel=function(e){if(e)if(this.uiCreated)this.removeTreeUI(e);else{var t=this._pendingModels.indexOf(e);if(-1===t)return;this._pendingModels.splice(t,1)}},m.prototype.createUI=function(){if(!this.uiCreated){var e,t="";if(this.options&&this.options.defaultTitle?(t=this.options.defaultTitle,e=void 0===this.options.localizeTitle||!!this.options.localizeTitle):(t=this.modelTitle,e=!1),t||(t="Browser",e=!0),this.setTitle(t,{localizeTitle:e}),this.uiCreated=!0,this.tree=new r.TreeOnDemand(this.scrollContainer,this.options),this.tree.setGlobalManager(this.globalManager),0!==this._pendingModels.length){for(var n=0;n<this._pendingModels.length;++n)this.createTreeUI(this._pendingModels[n]);this._pendingModels=[]}}},m.prototype.createTreeUI=function(e){if(this.tree.getDelegate(e.id))return!1;var t=new p(this,e);t.setGlobalManager(this.globalManager),this.tree.pushDelegate(t);var n=this;return e.getObjectTree((function(e){n.setInstanceTree(t,e)}),(function(){n.setInstanceTree(t,null)})),!0},m.prototype.setInstanceTree=function(e,t){this.tree.setInstanceTree(e,t)},m.prototype.removeTreeUI=function(e){this.tree.removeDelegate(e.id)&&(this.scrollContainer.scrollTop=0,this.onScroll())},m.prototype.onScroll=function(){this.tree.setScroll(this.scrollContainer.scrollTop)},m.prototype.getNodeLabel=function(e){return this.myDelegate.getNodeLabel(e)},m.prototype.onTreeNodeClick=function(){throw new Error("Method must be overriden.")},m.prototype.onTreeNodeRightClick=function(){throw new Error("Method must be overriden.")},m.prototype.onTitleClick=function(){},m.prototype.onTitleDoubleClick=function(){}},30587:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ObjectContextMenu:()=>o});var i=n(89576),r=n(35449);function o(e){this.viewer=e,this.setGlobalManager(e.globalManager),this.contextMenu=new i.ContextMenu(e)}o.prototype.constructor=o,r.GlobalManagerMixin.call(o.prototype),o.prototype.show=function(e){var t=this.viewer.getSelectionCount(),n=this.viewer.getSelectionVisibility(),i=this.viewer.impl.getCanvasBoundingClientRect(),r={event:e,numSelected:t,hasSelected:0<t,hasVisible:n.hasVisible,hasHidden:n.hasHidden,canvasX:e.clientX-i.left,canvasY:e.clientY-i.top},o=this.buildMenu(e,r);this.viewer.runContextMenuCallbacks(o,r),o&&0<o.length&&this.contextMenu.show(e,o)},o.prototype.hide=function(){return this.contextMenu.hide()},o.prototype.buildMenu=function(){return null}},76095:(e,t,n)=>{"use strict";function i(e){var t=e.ownerDocument;this.bg=t.createElement("div"),this.bg.className="progressbg",this.fg=t.createElement("div"),this.fg.className="progressfg",this.bg.appendChild(this.fg),e.appendChild(this.bg),this.lastValue=-1,this.fg.style.transform="scale(0, 1)"}n.r(t),n.d(t,{ProgressBar:()=>i}),i.prototype.setPercent=function(e){e!=this.lastValue&&(this.lastValue=e,e>=99?this.bg.style.opacity="0":(this.bg.style.opacity="1",this.fg.style.transform="scale(".concat(e/100,", 1)")))},i.prototype.setStyle=function(e){!this.fg.classList.contains(e)&&this.fg.classList.add(e)},i.prototype.removeStyle=function(e){this.fg.classList.contains(e)&&this.fg.classList.remove(e)}},53974:(e,t,n)=>{"use strict";n.r(t),n.d(t,{PropertyPanel:()=>c});var i=n(76723),r=n(30814),o=n(33218),a=n(50638),s=n(71224),l=n(51137);function c(e,t,n,a){i.DockingPanel.call(this,e,t,n,a),this.title.classList.add("docking-panel-delimiter-shadow"),this.container.classList.add("property-panel"),this.container.dockRight=!0,this.createScrollContainer({left:!1,heightAdjustment:70,marginTop:0}),this.highlightableElements={};var s=this;var l=function(){var e=new r.TreeDelegate;function t(e){return"category"===e.type}return e.setGlobalManager(s.globalManager),e.getTreeNodeId=function(e){return e.name+(Object.prototype.hasOwnProperty.call(e,"value")?e.value:"")+(Object.prototype.hasOwnProperty.call(e,"category")?e.category:"")},e.getTreeNodeClass=function(e){return t(e)?s.getCategoryClass(e):s.getPropertyClass(e)},e.isTreeNodeGroup=function(e){return t(e)},e.onTreeNodeClick=function(e,n,i){t(n)?s.onCategoryClick(n,i):s.onPropertyClick(n,i)},e.onTreeNodeRightClick=function(e,n,i){t(n)?s.onCategoryRightClick(n,i):s.onPropertyRightClick(n,i)},e.onTreeNodeDoubleClick=function(e,n,i){t(n)?s.onCategoryDoubleClick(n,i):s.onPropertyDoubleClick(n,i)},e.onTreeNodeIconClick=function(e,n,i){t(n)?s.onCategoryIconClick(n,i):s.onPropertyIconClick(n,i)},e.createTreeNode=function(e,n,i){var r=null;(r=t(e)?s.displayCategory(e,n,i):s.displayProperty(e,n,i))&&(s.highlightableElements[this.getTreeNodeId(e)]=r)},e}();this.tree=new o.Tree(l,null,this.scrollContainer,{}),this.tree.setGlobalManager(this.globalManager)}function u(e){e=String(e);var t=' target="blank" class="propertyLink" ';return[{pattern:/\b(?:https?|ftp):\/\/[a-z0-9-+&@#/%?=~_|()!:,.;]*[a-z0-9-+&@#/%=~_|()]/gim,value:"<a"+t+'href="$&">$&</a>'},{pattern:/(^|[^/])(www\.[\S]+(\b|$))/gim,value:"$1<a"+t+'href="http://$2">$2</a>'}].reduce((function(e,t){return e.replace(t.pattern,t.value)}),e)}c.prototype=Object.create(i.DockingPanel.prototype),c.prototype.constructor=c,c.prototype.setAggregatedProperties=function(e){var t=this;this.removeAllProperties();var n=Autodesk.Viewing.Private,i=this.viewer.prefs.get(n.Prefs.DISPLAY_UNITS),r=this.viewer.prefs.get(n.Prefs.DISPLAY_UNITS_PRECISION),o=Object.prototype.hasOwnProperty.call(e.map,"Name")?e.map.Name.map((function(e){return e.displayValue})):[];function c(e,t){var n=Number(e);e=isNaN(n)?e:n;var o="number"==typeof r?r:t.precision||(0,a.calculatePrecision)(e),s=(0,a.convertToDisplayUnits)(e,t.type,t.units,i);return(0,a.formatValueWithUnits)(s.displayValue,s.displayUnits,t.type,o)}var u=e.getValue2PropertiesMap("Name");if(u){var h=Object.keys(u);if(1===h.length){var d=h[0];this.tree.createElement_({name:"Name",value:d,type:"property",category:"",css:{name:"aggregate-name"}},this.tree.myRootContainer)}else{var p={name:"Name",type:"category",value:"Varies"},f=this.tree.createElement_(p,this.tree.myRootContainer);for(var m in this.setCategoryCollapsed(p,!0),u)this.tree.createElement_({name:m,value:"",type:"property",category:"Name"},f)}}var g=e.getKeysWithCategories().length>0;e.forEach((function(n,i){if("Name"!==n){var r=e.getAggregation(n),a=e.getValue2PropertiesMap(n);if(r||a){var u=i[0];if(!u.hidden){var h,d=!!u.displayCategory,p="";if(d)p=u.displayCategory,h=(h=t.tree.getElementForNode({name:p}))||t.tree.createElement_({name:p,type:"category"},t.tree.myRootContainer);else if(g){if(p="Other",!(h=t.tree.getElementForNode({name:p}))){var f=p,m=(h=t.tree.createElement_({name:f,type:"category"},t.tree.myRootContainer)).children[0].children[1];m.setAttribute("data-i18n",f),f=s.Z.t(f),m.textContent=f,m.title=f}}else h=t.tree.myRootContainer;var v=Object.keys(a);if(1===v.length){var y=v[0];return y=(0,l.OY)(i[0].type)?c(Number(y),u):y,void(h=t.tree.createElement_({name:u.displayName,value:y,type:"property",category:p,css:{name:"aggregate-name"}},h))}var b={name:u.displayName,value:"Varies",type:"category",category:p};if(h=t.tree.createElement_(b,h),t.setCategoryCollapsed(b,!0),p=u.displayName,(d||g)&&h.classList.add("indented"),r){var _={};for(var x in r)if("count"!==x)if("mode"!==x){var E=r[x];_[x]=c(E,u)}else _[x]=r[x].map((function(e){return c(e,u)})).join(", ");else _[x]=r[x];t.tree.createElement_({map:_,default:"sum",type:"property",category:p},h)}var w=[];for(var S in a){for(var A=c(S,u),M=a[S],T=0;T<M.length;++T){var C=o.indexOf(M[T]);C>-1&&o.splice(C,1)}w.push({name:M,value:A,type:"property",category:p})}o.length>0&&t.tree.createElement_({name:o,value:"--",type:"property",category:p},h),w.forEach((function(e){t.tree.createElement_(e,h)}))}}}}))},c.prototype.setProperties=function(e){this.removeAllProperties();for(var t=[],n=[],i=0;i<e.length;i++){var r=e[i];if(!r.hidden){var o=e[i].displayCategory;o&&"string"==typeof o&&""!==o?t.push(r):n.push(r)}}if(t.length+n.length!==0){n[0]&&"Name"===n[0].displayName&&(this.addProperty(n[0].displayName,n[0].displayValue),n.shift());for(var s=Autodesk.Viewing.Private,l=this.viewer.prefs.get(s.Prefs.DISPLAY_UNITS),c=this.viewer.prefs.get(s.Prefs.DISPLAY_UNITS_PRECISION),u=0;u<t.length;u++){var h=t[u],d="number"==typeof c?c:h.precision||(0,a.calculatePrecision)(h.displayValue),p=(0,a.convertToDisplayUnits)(h.displayValue,h.type,h.units,l),f=(0,a.formatValueWithUnits)(p.displayValue,p.displayUnits,h.type,d);this.addProperty(h.displayName,f,h.displayCategory)}for(var m=t.length>0,g=0;g<n.length;g++){var v=n[g],y="number"==typeof c?c:v.precision||(0,a.calculatePrecision)(v.displayValue),b=(0,a.convertToDisplayUnits)(v.displayValue,v.type,v.units,l),_=(0,a.formatValueWithUnits)(b.displayValue,b.displayUnits,v.type,y);this.addProperty(v.displayName,_,m?"Other":"",m?{localizeCategory:!0}:{})}}else this.showNoProperties()},c.prototype.showNoProperties=function(){this.removeAllProperties();var e=this.tree.myRootContainer,t=this.getDocument().createElement("div");t.className="no-properties";var n="No properties to display";t.setAttribute("data-i18n",n),t.textContent=s.Z.t(n),e.appendChild(t)},c.prototype.showDefaultProperties=function(){this.showNoProperties(),this.resizeToContent()},c.prototype.areDefaultPropertiesShown=function(){return!this.hasProperties()},c.prototype.addProperty=function(e,t,n,i){if(this.tree.getElementForNode({name:e,value:t,category:n}))return!1;var r=null,o={name:e,value:t,type:"property"};return n?((r=this.tree.getElementForNode({name:n}))||(r=this.tree.createElement_({name:n,type:"category"},this.tree.myRootContainer,i&&i.localizeCategory?{localize:!0}:null)),o.category=n):r=this.tree.myRootContainer,this.tree.createElement_(o,r,i&&i.localizeProperty?{localize:!0}:null),!0},c.prototype.hasProperties=function(){for(var e in this.highlightableElements)return!0;return!1},c.prototype.removeProperty=function(e,t,n){var i={name:e,value:t,category:n},r=this.tree.getElementForNode(i);return!!r&&(delete this.highlightableElements[this.tree.delegate().getTreeNodeId(i)],r.parentNode.removeChild(r),!0)},c.prototype.removeAllProperties=function(){this.highlightableElements={},this.tree.clear()},c.prototype.setCategoryCollapsed=function(e,t){var n=this.tree.delegate().getTreeNodeId(e);this.tree.setCollapsed(n,t)},c.prototype.isCategoryCollapsed=function(e){var t=this.tree.delegate().getTreeNodeId(e);return this.tree.isCollapsed(t)},c.prototype.getContentSize=function(){var e=this.tree.myRootContainer;return{height:e.clientHeight+55,width:e.clientWidth}},c.prototype.highlight=function(e){function t(t){var n=t.innerHTML,i=n.replace(/(<highlight>|<\/highlight>)/gim,"");if(n!==i&&(t.innerHTML=i),e&&""!==e){var r=new RegExp("(\\b"+e+"\\b)","gim"),o=i.replace(r,"<highlight>$1</highlight>");t.innerHTML=o}}for(var n in this.highlightableElements)for(var i=this.highlightableElements[n],r=0;r<i.length;++r)t(i[r])},c.prototype.displayCategory=function(e,t,n){var i=this.getDocument(),r=i.createElement("div"),o=e.name;n&&n.localize&&(r.setAttribute("data-i18n",o),o=s.Z.t(o)),r.textContent=o,r.title=o,r.className="category-name",t.appendChild(r);var a=[r];if(e.value){var l=i.createElement("div");l.textContent=e.value;var c=e.value;l.title=c,c=u(c),l.innerHTML=c,l.className="category-value",t.appendChild(l),a.push(l)}return a},c.prototype.displayProperty=function(e,t,n){var i,r=this.getDocument(),o=r.createElement("div");if(o.className="separator",e.map){for(var a in i=r.createElement("select"),e.map){var l=r.createElement("option");l.value=a,a=a.charAt(0).toUpperCase()+a.slice(1),l.setAttribute("data-i18n",a),l.textContent=s.Z.t(a),i.add(l)}i.value=e.default,e.value=e.map[e.default],i.className="property-drop-down",o.innerText="="}else{i=r.createElement("div");var c=e.name;n&&n.localize&&(i.setAttribute("data-i18n",c),c=s.Z.t(c)),i.textContent=c,i.title=c,i.className="property-name"}var h=r.createElement("div");h.textContent=e.value;var d=e.value;h.title=d,d=u(d),h.innerHTML=d,h.className="property-value",e.map&&i.addEventListener("change",(function(t){var n=t.target.value,i=e.map[n];h.title=i,h.innerHTML=i}),!1);var p=e.css;return p&&(p.name&&i.classList.add(p.name),p.value&&h.classList.add(p.value)),t.appendChild(i),t.appendChild(o),t.appendChild(h),[i,h]},c.prototype.getCategoryClass=function(){return"category"},c.prototype.getPropertyClass=function(){return"property"},c.prototype.onCategoryClick=function(e){this.setCategoryCollapsed(e,!this.isCategoryCollapsed(e))},c.prototype.onPropertyClick=function(){},c.prototype.onCategoryIconClick=function(e){this.setCategoryCollapsed(e,!this.isCategoryCollapsed(e))},c.prototype.onPropertyIconClick=function(){},c.prototype.onCategoryDoubleClick=function(){},c.prototype.onPropertyDoubleClick=function(){},c.prototype.onCategoryRightClick=function(){},c.prototype.onPropertyRightClick=function(){}},42430:(e,t,n)=>{"use strict";n.r(t),n.d(t,{RenderOptionsPanel:()=>l});var i=n(76723),r=n(37169),o=n(84998),a=n(74593),s=n(95018);function l(e){var t=this;this.viewer=e,this.setGlobalManager(e.globalManager),i.DockingPanel.call(this,e.container,"RenderOptionsPanel","Rendering Options");var n=this.getDocument();this.table=n.createElement("table"),this.table.className="adsk-lmv-tftable",this.tbody=n.createElement("tbody"),this.table.appendChild(this.tbody),this.createScrollContainer({heightAdjustment:70}),this.scrollContainer.appendChild(this.table),this.container.style.width="320px",this.container.style.top="260px",this.container.style.left="220px",this.container.style.height="460px",this.container.dockRight=!0,this.saoToggle=new a.OptionCheckbox("AO Enabled",this.tbody,!0),this.saoToggle.setGlobalManager(this.globalManager),this.addEventListener(this.saoToggle,"change",(function(n){var i=t.saoToggle.checked;e.prefs.set("ambientShadows",i),e.setQualityLevel(i,e.impl.renderer().settings.antialias)})),this.saoRadius=new a.OptionSlider("AO Radius",0,200,this.tbody),this.saoRadius.setGlobalManager(this.globalManager),this.saoRadius.setValue(10),this.saoRadius.sliderElement.step=this.saoRadius.stepperElement.step=.01,this.addEventListener(this.saoRadius,"change",(function(n){e.impl.renderer().setAOOptions(parseFloat(t.saoRadius.value),parseFloat(t.saoIntensity.value)),e.impl.renderer().composeFinalFrame()})),this.saoIntensity=new a.OptionSlider("AO Intensity",0,3,this.tbody),this.saoIntensity.setGlobalManager(this.globalManager),this.saoIntensity.setValue(.4),this.saoIntensity.sliderElement.step=this.saoIntensity.stepperElement.step=.01,this.addEventListener(this.saoIntensity,"change",(function(n){e.impl.renderer().setAOOptions(parseFloat(t.saoRadius.value),parseFloat(t.saoIntensity.value)),e.impl.renderer().composeFinalFrame()})),this.groundShadowAlpha=new a.OptionSlider("Shadow Alpha",0,2,this.tbody),this.groundShadowAlpha.setGlobalManager(this.globalManager),this.groundShadowAlpha.setValue(1),this.groundShadowAlpha.sliderElement.step=this.groundShadowAlpha.stepperElement.step=.1,this.addEventListener(this.groundShadowAlpha,"change",(function(n){e.setGroundShadowAlpha(parseFloat(t.groundShadowAlpha.value))})),this.groundShadowColor=new a.OptionCheckbox("Shadow Color",this.tbody),this.groundShadowColor.setGlobalManager(this.globalManager),o.isIE11||(this.groundShadowColor.checkElement.value="#000000",this.groundShadowColor.checkElement.type="color"),this.addEventListener(this.groundShadowColor,"change",(function(n){var i=t.groundShadowColor.checkElement.value;e.setGroundShadowColor(new THREE.Color(parseInt(i.substr(1,7),16)))})),this.groundReflectionAlpha=new a.OptionSlider("Reflection Alpha",0,2,this.tbody),this.groundReflectionAlpha.setGlobalManager(this.globalManager),this.groundReflectionAlpha.setValue(1),this.groundReflectionAlpha.sliderElement.step=this.groundReflectionAlpha.stepperElement.step=.1,this.addEventListener(this.groundReflectionAlpha,"change",(function(n){e.setGroundReflectionAlpha(parseFloat(t.groundReflectionAlpha.value))})),this.groundReflectionColor=new a.OptionCheckbox("Reflection Color",this.tbody),this.groundReflectionColor.setGlobalManager(this.globalManager),o.isIE11||(this.groundReflectionColor.checkElement.value="#000000",this.groundReflectionColor.checkElement.type="color"),this.addEventListener(this.groundReflectionColor,"change",(function(n){var i=t.groundReflectionColor.checkElement.value;e.setGroundReflectionColor(new THREE.Color(parseInt(i.substr(1,7),16)))}));for(var l=[],c=0;c<s.LightPresets.length;c++)l.push(s.LightPresets[c].name);this.envSelect=new a.OptionDropDown("Environment",this.tbody,l,e.impl.currentLightPreset()),this.envSelect.setGlobalManager(this.globalManager),this.addEventListener(this.envSelect,"change",(function(n){var i=t.envSelect.selectedIndex;e.setLightPreset(i)}));var u=e.impl.renderer().getToneMapMethod();this.toneMapMethod=new a.OptionDropDown("Tonemap Method",this.tbody,["None","Canon-Lum","Canon-RGB"],u),this.toneMapMethod.setGlobalManager(this.globalManager),this.addEventListener(this.toneMapMethod,"change",(function(){var n=t.toneMapMethod.selectedIndex;e.impl.setTonemapMethod(n)})),this.exposureBias=new a.OptionSlider("Exposure Bias",-30,30,this.tbody),this.exposureBias.setGlobalManager(this.globalManager),this.exposureBias.setValue(e.impl.renderer().getExposureBias()),this.exposureBias.sliderElement.step=this.exposureBias.stepperElement.step=.1,this.addEventListener(this.exposureBias,"change",(function(n){e.impl.setTonemapExposureBias(t.exposureBias.value,t.whiteScale.value)})),this.exposureBias.setDisabled(0==u),this.whiteScale=new a.OptionSlider("Light Intensity",-5,20,this.tbody),this.whiteScale.setGlobalManager(this.globalManager);var h=0;e.impl.dir_light1&&(h=0!=e.impl.dir_light1.intensity?Math.log(e.impl.dir_light1.intensity)/Math.log(2):-1e-20),this.whiteScale.setValue(h),this.whiteScale.sliderElement.step=this.whiteScale.stepperElement.step=.1,this.addEventListener(this.whiteScale,"change",(function(n){e.impl.dir_light1.intensity=Math.pow(2,t.whiteScale.value),e.impl.setTonemapExposureBias(t.exposureBias.value,t.whiteScale.value)})),this.fovAngle=new a.OptionSlider("FOV-degrees",6.88,100,this.tbody),this.fovAngle.setGlobalManager(this.globalManager),this.fovAngle.setValue(e.getFOV()),this.addEventListener(this.fovAngle,"change",(function(n){e.setFOV(parseFloat(t.fovAngle.value))})),this.frameRate=new a.OptionSlider("Frame rate:",1,100,this.tbody),this.frameRate.setGlobalManager(this.globalManager),this.frameRate.setValue(e.impl.getFrameRate()),this.frameRate.sliderElement.step=this.frameRate.stepperElement.step=1,this.addEventListener(this.frameRate,"change",(function(n){e.impl.setFrameRate(t.frameRate.value)})),this.addEventListener(this.viewer,r.CAMERA_CHANGE_EVENT,(function(n){var i=parseFloat(t.fovAngle.value),r=e.getFOV();i!=r&&t.fovAngle.setValue(r)})),this.addEventListener(this.viewer,r.RENDER_OPTION_CHANGED_EVENT,(function(e){t.syncUI()})),this.addEventListener(this.viewer,r.VIEWER_STATE_RESTORED_EVENT,(function(e){t.syncUI()})),this.addVisibilityListener((function(e){e&&t.resizeToContent()}))}l.prototype=Object.create(i.DockingPanel.prototype),l.prototype.constructor=l,l.prototype.getContentSize=function(){return{height:this.table.clientHeight+75,width:this.table.clientWidth}},l.prototype.syncUI=function(){var e=this.viewer.impl,t=0;e.dir_light1&&(t=0!=e.dir_light1.intensity?Math.log(e.dir_light1.intensity)/Math.log(2):-1e-20),this.whiteScale.setValue(t),this.exposureBias.setValue(e.renderer().getExposureBias());var n=e.renderer().getToneMapMethod();this.toneMapMethod.setSelectedIndex(n),this.envSelect.setSelectedIndex(e.currentLightPreset()),this.exposureBias.setDisabled(0==n),this.saoToggle.setValue(e.renderer().getAOEnabled()),this.saoRadius.setDisabled(!e.renderer().getAOEnabled()),this.saoIntensity.setDisabled(!e.renderer().getAOEnabled()),this.saoRadius.setValue(e.renderer().getAORadius()),this.saoIntensity.setValue(e.renderer().getAOIntensity()),this.groundShadowAlpha.setDisabled(!this.viewer.prefs.get("groundShadow")),this.groundShadowColor.setDisabled(!this.viewer.prefs.get("groundShadow")),this.groundReflectionAlpha.setDisabled(!this.viewer.prefs.get("groundReflection")),this.groundReflectionColor.setDisabled(!this.viewer.prefs.get("groundReflection")),this.fovAngle.setValue(this.viewer.getFOV())},l.prototype.uninitialize=function(){i.DockingPanel.prototype.uninitialize.call(this),this.table=null,this.tbody=null,this.saoToggle=null,this.saoRadius=null,this.saoIntensity=null,this.groundShadowAlpha=null,this.envSelect=null,this.toneMapMethod=null,this.exposureBias=null,this.whiteScale=null,this.fovAngle=null,this.viewer=null}},89853:(e,t,n)=>{"use strict";n.r(t),n.d(t,{SettingsPanel:()=>l});var i=n(76723),r=n(71224),o=n(84998),a=n(74593);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function l(e,t,n,r){i.DockingPanel.call(this,e,t,n,r),this.panelTabs=[],this.tabIdToIndex={},this.controls={},this.controlIdCount=0,this.shown=!1;var o=this,a=r&&void 0!==r.width?r.width:340;this.container.style.maxWidth="800px",this.container.style.minWidth=a+"px",this.container.style.top="10px",this.container.style.left=e.offsetWidth/2-170+"px",this.container.style.position="absolute";var s=this.getDocument();this.tabContainer=s.createElement("div"),this.tabContainer.classList.add("docking-panel-container-solid-color-b"),this.tabContainer.classList.add("settings-tabs"),this.tabContainer.classList.add("docking-panel-delimiter-shadow"),this.container.appendChild(this.tabContainer),this.tabs=s.createElement("ul"),this.tabContainer.appendChild(this.tabs),this.heightAdjustment=r&&r.heightAdjustment?r.heightAdjustment:179,r&&r.hideTabBar&&(this.heightAdjustment-=40,this.tabContainer.style.display="none",this.tabContainer.style.height=0),this.createScrollContainer({left:!1,heightAdjustment:this.heightAdjustment,marginTop:0}),this.tablesContainer=s.createElement("div"),this.tablesContainer.classList.add("settings-tabs-tables-container"),r&&r.hideTabBar&&(this.scrollContainer.style.top="50px"),this.scrollContainer.appendChild(this.tablesContainer),this.mouseOver=!1,this.addEventListener(this.container,"mouseover",(function(e){var t=e.toElement||e.relatedTarget;if(o.mouseOver)return!0;for(var n=o.getWindow();t&&t.parentNode&&t.parentNode!=n;){if(t.parentNode==this||t==this){t.preventDefault&&t.preventDefault(),o.mouseOver=!0;for(var i=0;i<o.panelTabs.length;i++)o.panelTabs[i].classList.remove("selectedmouseout");return!0}t=t.parentNode}})),this.addEventListener(this.container,"mouseout",(function(e){var t=e.toElement||e.relatedTarget;if(o.mouseOver){for(var n=o.getWindow();t&&t.parentNode&&t.parentNode!=n;){if(t.parentNode==this||t==this)return t.preventDefault&&t.preventDefault(),!1;t=t.parentNode}o.mouseOver=!1;for(var i=0;i<o.panelTabs.length;i++)o.panelTabs[i].classList.contains("tabselected")&&o.panelTabs[i].classList.add("selectedmouseout")}})),this.expandID=function(e){return t+"-"+e}}l.prototype=Object.create(i.DockingPanel.prototype),l.prototype.constructor=l,l.prototype.setVisible=function(e){e&&(this.container.style.display="block",this.shown||(this.resizeToContent(),this.container.style.left=this.parentContainer.offsetWidth/2-this.container.getBoundingClientRect().width/2+"px"),this.shown=!0),i.DockingPanel.prototype.setVisible.call(this,e)},l.prototype.addTab=function(e,t,n){var i=this;if(void 0!==this.tabIdToIndex[e])return!1;var a=n&&void 0!==n.className?n.className:null,s=n&&void 0!==n.width?n.width:200,l=n&&void 0!==n.index?n.index:this.panelTabs.length;var c=this.getDocument(),u=c.createElement("li");u._id=e,u.id=this.expandID(u._id),u.classList.add(a);var h=c.createElement("a"),d=c.createElement("span");d.setAttribute("data-i18n",t),d.textContent=r.Z.t(t),h.appendChild(d),u.appendChild(h),this.tabs.appendChild(u);var p=c.createElement("table");p._id=e+"-table",p.id=this.expandID(p._id),p.classList.add("settings-table"),p.classList.add("adsk-lmv-tftable"),p.classList.add(a);var f=c.createElement("tbody");return f.style.display="table",f.style.width="100%",p.appendChild(f),this.tablesContainer.appendChild(p),this.addEventListener(u,"touchstart",o.touchStartToClick),this.addEventListener(u,"click",(function(){i.selectTab(e)})),this.panelTabs.push(u),this.tabIdToIndex[e]=l,s>(this.container.style.minWidth?parseInt(this.container.style.minWidth):0)&&(this.container.style.minWidth=s+"px"),!0},l.prototype.removeTab=function(e){var t=this.tabIdToIndex[e];if(!t)return!1;this.panelTabs.splice(t,1);var n=this.getDocument().getElementById(this.expandID(e));this.tabs.removeChild(n),this.tabIdToIndex={};for(var i=this.panelTabs.length,r=0;r<i;r++){var a=this.panelTabs[r];this.tabIdToIndex[a._id]=r,this.removeEventListener(a,"touchstart",o.touchStartToClick)}return!0},l.prototype.resizeTabs=function(){for(var e=this.tabs.getElementsByTagName("li"),t=100/e.length,n=0;n<e.length;n++)e[n].style.width=t+"%"},l.prototype.hasTab=function(e){var t=this.tabIdToIndex[e];return void 0!==this.panelTabs[t]},l.prototype.selectTab=function(e){if(this.isTabSelected(e))return!1;for(var t=this.getDocument(),n=this.panelTabs.length,i=0;i<n;i++){var r=this.panelTabs[i],o=t.getElementById(this.expandID(r._id+"-table"));e===r._id?(r.classList.add("tabselected"),o.classList.add("settings-selected-table"),this.mouseOver||r.classList.add("selectedmouseout")):(r.classList.remove("tabselected"),o.classList.remove("settings-selected-table"),this.mouseOver||this.panelTabs[i].classList.remove("selectedmouseout"))}return this.scrollContainer.scrollTop=0,!0},l.prototype.isTabSelected=function(e){var t=this.tabIdToIndex[e],n=this.panelTabs[t];return n&&n.classList.contains("tabselected")},l.prototype.getSelectedTabId=function(){for(var e in this.tabIdToIndex)if(this.isTabSelected(e))return e;return null},l.prototype.addLabel=function(e,t){var n,i=this.tabIdToIndex[e];if(-1===i)return!1;n=this.tablesContainer.childNodes[i];var r=new a.OptionLabel(t,n.tBodies[0]);return r.setGlobalManager(this.globalManager),r.sliderRow.classList.add("logical-group"),r},l.prototype.addButton=function(e,t){var n=this.tabIdToIndex[e];if(void 0===n)return null;var i=this.tablesContainer.childNodes[n],r=new a.OptionButton(t,i.tBodies[0]);return r.setGlobalManager(this.globalManager),this.addControl(e,r)},l.prototype.addCheckbox=function(e,t,n,i,r,o){var s=this.tabIdToIndex[e];if(void 0===s)return null;var l=this.tablesContainer.childNodes[s],c=new a.OptionCheckbox(t,l.tBodies[0],n,r,o);return c.setGlobalManager(this.globalManager),c.changeListener=function(e){var t=e.detail.target.checked;i(t)},this.addEventListener(c,"change",c.changeListener),this.addControl(e,c)},l.prototype.addRow=function(e,t,n,i){if(void 0===this.tabIdToIndex[e])return null;var r=this.getDocument().getElementById(this.expandID(e+"-table")),o=new a.OptionRow(t,r.tBodies[0],n,i);return o.setGlobalManager(this.globalManager),this.addControl(e,o)},l.prototype.addSlider=function(e,t,n,i,r,o,s){if(void 0===this.tabIdToIndex[e])return null;var l=this.getDocument().getElementById(this.expandID(e+"-table")),c=new a.OptionSlider(t,n,i,l.tBodies[0],s);c.setGlobalManager(this.globalManager),c.setValue(r);var u=1;return s&&s.step&&(u=s.step),c.sliderElement.step=c.stepperElement.step=u,this.addEventListener(c,"change",(function(e){o(e)})),this.addControl(e,c)},l.prototype.addSliderV2=function(e,t,n,i,r,o,a,s){(s=s||{}).hideStepper=!0,s.hideCaption=!0;var l=[];return l.push(this.addRow(e,t,n,s)),l.push(this.addSlider(e,t,i,r,o,a,s)),l},l.prototype.addDropDownMenu=function(e,t,n,i,r,o){if(void 0===this.tabIdToIndex[e])return null;var s=this.getDocument().getElementById(this.expandID(e+"-table")),l=new a.OptionDropDown(t,s.tBodies[0],n,i,null,this.globalManager,o);return l.setGlobalManager(this.globalManager),this.addEventListener(l,"change",(function(e){r(e)})),this.addControl(e,l)},l.prototype.addControl=function(e,t,n){if(void 0===this.tabIdToIndex[e])return null;if(!Object.prototype.hasOwnProperty.call(t,"sliderRow")){var i=n&&n.insertAtIndex?n.insertAtIndex:-1,o=n&&n.caption?n.caption:null,a=this.getDocument(),s=a.getElementById(this.expandID(e+"-table"));i>s.length&&(i=-1);var l=s.tBodies[0].insertRow(i),c=l.insertCell(0);if(o){var u=a.createElement("div");u.setAttribute("data-i18n",o),u.textContent=r.Z.t(o),c.appendChild(u),c=l.insertCell(1)}else c.colSpan=3;c.appendChild(t),t.sliderRow=l,t.tbody=s.tBodies[0]}var h=this.expandID("adsk_settings_control_id_"+this.controlIdCount.toString());return this.controlIdCount=this.controlIdCount+1,this.controls[h]=t,t.parent=this,h},l.prototype.removeButton=function(e){return this.removeControl(e)},l.prototype.removeCheckbox=function(e){return this.removeControl(e)},l.prototype.removeSlider=function(e){return this.removeControl(e)},l.prototype.removeDropdownMenu=function(e){return this.removeControl(e)},l.prototype.removeControl=function(e){var t;if("object"===s(e)&&e.tbody){for(var n in t=e,this.controls)if(this.controls[n]===t){e=n;break}}else t=this.controls[e];if(void 0===t)return!1;if(t.removeFromParent)t.removeFromParent();else{var i=t.tbody,r=t.sliderRow.rowIndex;i.deleteRow(r)}return delete this.controls[e],t.parent=void 0,!0},l.prototype.getControl=function(e){return this.controls[e]||null},l.prototype.getContentSize=function(){for(var e=this.heightAdjustment,t=0,n=this.getDocument(),i=0;i<this.panelTabs.length;i++){var r=this.panelTabs[i],o=n.getElementById(this.expandID(r._id+"-table")),a=o?o.clientHeight:0;t=Math.max(t,a)}return{height:e+t,width:this.container.clientWidth}},l.prototype.sizeToContent=function(e){var t=this.getContentSize().height+this.heightAdjustment,n=e.clientHeight-this.heightAdjustment,i=Math.min(t,n);this.container.style.height=parseInt(i)+"px"},l.prototype.addSimpleList=function(e,t,n){var i=new a.SimpleList(e,t,n);return i.setGlobalManager(this.globalManager),i},l.prototype.removeSimpleList=function(e){return!!e&&(e.removeFromParent(),!0)}},33218:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Tree:()=>s});var i=n(84998),r=n(33317),o=n(35449),a=n(41145);function s(e,t,n,i){this.myDelegate=e,this.mySelectedNodes=[],this.myOptions=i||{},this.parentContainer=n;this.groupClassName=this.myOptions.groupClassName||"expanded",this.leafClassName=this.myOptions.leafClassName||"expanded",this.selectedClassName=this.myOptions.selectedClassName||"selected",this.myGroupNodes=[],this.nodeToElement={},this.nodeIdToNode={};var r=this.myRootContainer=this.createHtmlElement_(n,"div","treeview"),o=this.rootElem=this.createElement_(t,r,i,0);this.setInputHandlers_(),i&&i.excludeRoot&&o.classList.add("exclude")}s.prototype.constructor=s,o.GlobalManagerMixin.call(s.prototype),s.prototype.destroy=function(){this.myDelegate=null,this.parentContainer&&(this.parentContainer.removeChild(this.myRootContainer),this.myRootContainer=null,this.parentContainer=null)},s.prototype.show=function(e){var t=this.myRootContainer;t.style.display=e?"block":"none"},s.prototype.getRootContainer=function(){return this.myRootContainer},s.prototype.getElementForNode=function(e){return"number"!=typeof e&&"string"!=typeof e&&(e=this.myDelegate.getTreeNodeId(e)),this.nodeToElement[e]},s.prototype.delegate=function(){return this.myDelegate},s.prototype.isCollapsed=function(e){return this.hasClass(e,"collapsed")},s.prototype.setCollapsed=function(e,t,n){t?(this.addClass(e,"collapsed",n),this.removeClass(e,"expanded",n)):(this.addClass(e,"expanded",n),this.removeClass(e,"collapsed",n))},s.prototype.setAllCollapsed=function(e){var t,n;e?(t=function(e){return e.classList.contains("expanded")},n=function(e){e.classList.add("collapsed"),e.classList.remove("expanded")}):(t=function(e){return e.classList.contains("collapsed")},n=function(e){e.classList.add("expanded"),e.classList.remove("collapsed")});for(var i=0;i<this.myGroupNodes.length;++i){var r=this.myGroupNodes[i];t(r)&&n(r)}},s.prototype.addToSelection=function(e){var t=this;function n(e){return-1===t.mySelectedNodes.indexOf(e)&&(t.mySelectedNodes.push(e),!0)}for(var i=e.length,r=0;r<i;++r){var o=e[r];n(o)&&this.addClass(o,this.selectedClassName)}},s.prototype.removeFromSelection=function(e){var t=this;function n(e){var n=t.mySelectedNodes.indexOf(e);return-1!==n&&(t.mySelectedNodes.splice(n,1),!0)}for(var i=e.length-1;i>=0;--i){var r=e[i];n(r)&&this.removeClass(r,this.selectedClassName)}},s.prototype.setSelection=function(e){return this.removeFromSelection(this.mySelectedNodes),this.addToSelection(e),this.mySelectedNodes},s.prototype.getSelection=function(){return this.mySelectedNodes.concat()},s.prototype.clearSelection=function(){this.removeFromSelection(this.mySelectedNodes)},s.prototype.isSelected=function(e){return this.hasClass(e,this.selectedClassName)},s.prototype.scrollTo=function(e){var t=this.getElementForNode(e);if(t){var n=t.offsetTop;for(t=t.parentNode;t&&t!=this.myRootContainer;)n+=t.offsetTop,t=t.parentNode;var i=this.myRootContainer.parentNode;this.myDelegate.getScrollContainer()&&(i=this.myDelegate.getScrollContainer()),i.scrollTop=n}},s.prototype.addClass=function(e,t,n){var i=this.getElementForNode(e);if(i){if(n){i=i.parentNode;for(var r=this.myOptions.excludeRoot?this.rootElem:this.myRootContainer;i&&i!==r;)i.classList.add(t),i=i.parentNode}else i.classList.add(t);return!0}return!1},s.prototype.removeClass=function(e,t,n){var i=this.getElementForNode(e);if(i){if(n){i=i.parentNode;for(var r=this.myOptions.excludeRoot?this.rootElem:this.myRootContainer;i&&i!==r;)i.classList.remove(t),i=i.parentNode}else i.classList.remove(t);return!0}return!1},s.prototype.hasClass=function(e,t){return this.getElementForNode(e).classList.contains(t)},s.prototype.clear=function(){for(var e=this.myRootContainer;e.hasChildNodes();)e.removeChild(e.lastChild);this.nodeToElement={},this.nodeIdToNode={}},s.prototype.createElement_=function(e,t,n,i){if(null==e)return null;if(!this.myDelegate.shouldCreateTreeNode(e))return null;var r,o=this;function a(t,r,a,s){var l=o.createHtmlElement_(t,r,a),c=o.myDelegate.getTreeNodeId(s);l.setAttribute("lmv-nodeId",c);var u=o.createHtmlElement_(l,"lmvheader"),h=o.createHtmlElement_(u,"icon");return h.addEventListener("mousedown",(function(e){e.stopPropagation(),e.preventDefault()}),!1),h.addEventListener("click",(function(t){o.myDelegate.onTreeNodeIconClick(o,e,t),t.stopPropagation(),t.preventDefault()}),!1),o.myDelegate.createTreeNode(e,u,n,r,i),l}var s=this.myDelegate.getTreeNodeId(e),l=o.myOptions.excludeRoot?1:0;o.myDelegate.isTreeNodeGroup(e)?(r=a(t,"group",o.groupClassName,e),o.nodeToElement[s]=r,o.nodeIdToNode[s]=e,i==l&&(r.style.left="0px"),o.myGroupNodes.push(r),o.myDelegate.forEachChild(e,(function(e){o.createElement_(e,r,n,i+1)}))):(r=a(t,"leaf",o.leafClassName,e),o.nodeToElement[s]=r,o.nodeIdToNode[s]=e,i==l&&(r.style.marginLeft="0px"));var c=o.myDelegate.getTreeNodeClass(e);return c&&r.classList.add(c),r},s.prototype.setInputHandlers_=function(){var e=this,t=this.myRootContainer,n=null,o=function(i){var r=null,o=!1;do{i&&i!==t?i.hasAttribute("lmv-nodeId")?(r=i,o=!0):i=i.parentElement:(r=null,o=!0)}while(!o);if(r){var a=r.getAttribute("lmv-nodeId");return e.nodeIdToNode[a]||n}return n};(0,i.isTouchDevice)()&&(this.hammer=new a.Manager(t,{recognizers:[r.GestureRecognizers.doubletap,r.GestureRecognizers.press],handlePointerEventMouse:!1,inputClass:i.isIE11?a.PointerEventInput:a.TouchInput}),this.hammer.on("doubletap",(function(t){var i=o(t.target);i!==n&&e.myDelegate.onTreeNodeDoubleClick(e,i,t)})),this.hammer.on("press",(function(t){var i=o(t.target);i!==n&&e.myDelegate.onTreeNodeRightClick(e,i,t)}))),t.addEventListener("click",(function(t){var i=o(t.target);i!==n&&(e.myDelegate.onTreeNodeClick(e,i,t),t.stopPropagation(),t.target.classList.contains("propertyLink")||t.preventDefault())}),!1),t.addEventListener("dblclick",(function(t){var i=o(t.target);i!==n&&(e.myDelegate.onTreeNodeDoubleClick(e,i,t),t.stopPropagation(),t.preventDefault())}),!1),t.addEventListener("contextmenu",(function(t){var i=o(t.target);i!==n&&(e.myDelegate.onTreeNodeRightClick(e,i,t),t.stopPropagation(),t.preventDefault())}),!1),t.addEventListener("mouseover",(function(t){var i=o(t.target);i!==n&&(e.myDelegate.onTreeNodeHover(e,i,t),t.stopPropagation(),t.preventDefault())}),!1),t.addEventListener("mouseout",(function(t){var n=t.toElement||t.relatedTarget;if(o(t.target)!=o(n)){e.myDelegate.onTreeNodeHover(e,-1,t),t.stopPropagation(),t.preventDefault()}}),!1)},s.prototype.createHtmlElement_=function(e,t,n){var i=this.getDocument().createElement(t);return e.appendChild(i),n&&(i.className=n),i},s.prototype.iterate=function(e,t){if(null!=e&&this.myDelegate.shouldCreateTreeNode(e)){var n=this.getElementForNode(e);if(n){t(e,n);var i=this;this.myDelegate.forEachChild(e,(function(e){i.iterate(e,t)}))}}}},30814:(e,t,n)=>{"use strict";n.r(t),n.d(t,{TreeDelegate:()=>r});var i=n(71224);function r(){}n(35449).GlobalManagerMixin.call(r.prototype),r.prototype.constructor=r,r.prototype.isTreeNodeGroup=function(e){throw"isTreeNodeGroup is not implemented."},r.prototype.getTreeNodeId=function(e){throw"getTreeNodeId is not implemented."},r.prototype.getTreeNodeIndex=function(e){throw"getTreeNodeIndex is not implemented."},r.prototype.getTreeNodeParentId=function(e){throw"getTreeNodeParentId is not implemented."},r.prototype.getTreeNodeLabel=function(e){return e.name},r.prototype.getTreeNodeCount=function(){throw"getTreeNodeCount is not implemented."},r.prototype.shouldCreateTreeNode=function(e){return!0},r.prototype.forEachChild=function(e,t){for(var n=e.children?e.children.length:0,i=0;i<n;++i){t(e.children[i])}},r.prototype.createTreeNode=function(e,t,n,r,o){var a=this.getDocument().createElement("label");t.appendChild(a);var s=this.getTreeNodeLabel(e);return n&&n.localize&&(a.setAttribute("data-i18n",s),s=i.Z.t(s)),a.textContent=s,a},r.prototype.onTreeNodeClick=function(e,t,n){},r.prototype.onTreeNodeIconClick=function(e,t,n){e.delegate().isTreeNodeGroup(t)&&e.setCollapsed(t,!e.isCollapsed(t))},r.prototype.onTreeNodeDoubleClick=function(e,t,n){},r.prototype.onTreeNodeRightClick=function(e,t,n){},r.prototype.onTreeNodeReized=function(e){},r.prototype.getTreeNodeClass=function(e){return""},r.prototype.getTreeNodeParentMaxSize=function(e){return{width:0,height:0}},r.prototype.getTreeNodeClientHeight=function(e){return 0},r.prototype.getTreeNodeDepthOffset=function(e,t){return 0},r.prototype.onTreeNodeHover=function(e,t,n){},r.prototype.getScrollContainer=function(){return null}},79893:(e,t,n)=>{"use strict";n.r(t),n.d(t,{TreeOnDemand:()=>u});var i=n(84998),r=n(33317),o=n(59005),a=n(71224),s=n(35449),l=n(41145),c=300;function u(e,t){this.dirty=!1,this.nextFrameId=0,this.scrollY=0,this.delegates=[],this.idToDelegate={},this.options=t;var n=this.getDocument();this.rootContainer=n.createElement("div"),this.rootContainer.classList.add("docking-panel-container-gradient"),this.rootContainer.classList.add("treeview"),this.rootContainer.classList.add("on-demand"),e.appendChild(this.rootContainer),this.paddingDiv=n.createElement("div"),this.paddingDiv.style.border=0,this.paddingDiv.style.margin=0,this.paddingDiv.style.padding=0,this.sizedDiv=e.parentNode,this.nodeCssTable=[[],["group"],["leaf"]],this.cssStringToNodeCssTable={"":0,group:1,leaf:2},this.nodeIndexToNodeCssTables={};for(var a=[],s=0;s<150;++s){var c=_(n);a[s]=c}this.elementsPool=a,this.elementsUsed=0,this.spinner=new o.LoadingSpinner(e),this.spinner.setGlobalManager(this.globalManager),this.spinner.addClass("tree-loading-spinner");var u=(0,i.isTouchDevice)();u&&(this.hammer=new l.Manager(this.rootContainer,{recognizers:[r.GestureRecognizers.doubletap,r.GestureRecognizers.press],handlePointerEventMouse:!1,inputClass:i.isIE11?l.PointerEventInput:l.TouchInput}));for(s=0;s<150;++s){c=a[s];u&&(this.hammer.on("doubletap",x.bind(this)),this.hammer.on("press",E.bind(this))),c.addEventListener("click",w.bind(this)),c.addEventListener("dblclick",S.bind(this)),c.addEventListener("contextmenu",A.bind(this)),c.icon.addEventListener("click",M.bind(this)),c.icon.addEventListener("mousedown",T.bind(this))}f(this)}var h=u.prototype;function d(e){if(e.dirty=!1,function(e){for(var t=e.elementsUsed,n=e.elementsPool,i=0;i<t;++i){var r=n[i];r.setAttribute("lmv-nodeId",""),r.className="";for(var o=r.header,a=o.childNodes.length-1,s=0;s<a;++s)o.removeChild(o.lastChild)}e.clear()}(e),e.displayNoProperties(!1),0!==e.delegates.length)if(1===e.delegates.length&&e.delegates[0].isLoading())e.spinner.setVisible(!0);else{if(1===e.delegates.length&&e.delegates[0].isNotAvailable())return e.spinner.setVisible(!1),void e.displayNoProperties(!0);e.spinner.setVisible(!1),function(e){var t=e.rootContainer,n=function(e){return{width:0|e.sizedDiv.clientWidth,height:0|e.sizedDiv.clientHeight}}(e).height,i=0,r=0,o=!0;t.appendChild(e.paddingDiv);var a=e.delegates.slice(0),s=e.isExcludeRoot();for(;a.length;){var l=a.shift(),u=l.modelDiv;t.appendChild(u);for(var h=[l.getRootId()],d={curr:s?-1:0,popIds:[]};h.length&&o;){if(i>e.scrollY+n+c){o=!1;break}if(e.elementsUsed===e.elementsPool.length){o=!1;break}var f=h.shift(),m=i+(A=-1===d.curr?0:l.getTreeNodeClientHeight(f));if(A>0&&m+c>=e.scrollY){var g=e.elementsPool[e.elementsUsed++];g.setAttribute("lmv-nodeId",f),l.createTreeNode(f,g.header);var v=l.getTreeNodeClass(f);v&&g.classList.add(v);var b=y(e,l,f);if(b)for(var _=b.length,x=0;x<_;++x)g.classList.add(b[x]);var E=l.getTreeNodeDepthOffset(f,d.curr);g.header.style.paddingLeft=E+"px",u.appendChild(g)}if(m+c<e.scrollY&&(r=m),i=m,(M=p(e,l,f,0===A))&&M.length>0){d.curr++;for(var w=M[M.length-1],S=d.popIds.length-1;S>=0&&d.popIds[S]===f;)d.popIds[S--]=w;d.popIds.push(w),h=M.concat(h)}for(;d.popIds.length>0&&f===d.popIds[d.popIds.length-1];)d.popIds.pop(),d.curr--}for(e.paddingDiv.style.height=r+"px";h.length;){var A,M;f=h.shift();i=m=i+(A=-1===d.curr?0:l.getTreeNodeClientHeight(f)),(M=p(e,l,f))&&M.length&&(h=M.concat(h))}}t.style.height=i+"px"}(e)}else e.spinner.setVisible(!1)}function p(e,t,n,i){if(!t.isTreeNodeGroup(n))return null;if(!i&&e.isCollapsed(t,n))return null;var r=[];return t.forEachChild(n,(function(e){r.push(e)})),r}function f(e,t){e.dirty&&!t||(t?d(e):(e.dirty=!0,e.nextFrameId=requestAnimationFrame((function(){d(e)}))))}function m(e,t){return"number"!=typeof t&&"string"!=typeof t?e.threeDelegate.getTreeNodeId(0|t):t}function g(e,t){for(var n=null;t&&t!==e.rootContainer;){if(t.hasAttribute("lmv-nodeId")){n=t;break}t=t.parentElement}if(!n)return null;var i=n.getAttribute("lmv-nodeId");return parseFloat(i)}function v(e,t){for(var n=null;t&&t!==e.rootContainer;){if(t.hasAttribute("lmv-modelId")){n=t;break}t=t.parentElement}if(!n)return null;var i=n.getAttribute("lmv-modelId");return parseInt(i)}function y(e,t,n){if(t.isControlId(n))return t.getControlIdCss(n);var i=t.getTreeNodeIndex(n);return e.nodeCssTable[e.nodeIndexToNodeCssTables[t.model.id][i]]}function b(e,t,n,i){var r=i.join(" "),o=e.cssStringToNodeCssTable[r]||e.nodeCssTable.length;o===e.nodeCssTable.length&&(e.nodeCssTable.push(i),e.cssStringToNodeCssTable[r]=o);var a=t.getTreeNodeIndex(n);e.nodeIndexToNodeCssTables[t.model.id][a]=o}function _(e,t,n){var i=e.createElement("lmvheader"),r=e.createElement("icon");i.appendChild(r);var o=e.createElement("div");return o.header=i,o.icon=r,o.appendChild(i),o}function x(e){var t=g(this,e.target);if(t){var n=v(this,e.target),i=this.getDelegate(n);i&&i.onTreeNodeDoubleClick(this,t,e)}}function E(e){var t=g(this,e.target);if(t){var n=v(this,e.target),i=this.getDelegate(n);i&&i.onTreeNodeRightClick(this,t,e)}}function w(e){if(!e.target.classList.contains("group")&&!e.target.classList.contains("leaf")){var t=g(this,e.target);if(t){var n=v(this,e.target),i=this.getDelegate(n);i&&(i.onTreeNodeClick(this,t,e),e.stopPropagation(),e.preventDefault())}}}function S(e){if(!e.target.classList.contains("group")&&!e.target.classList.contains("leaf")){var t=g(this,e.target);if(t){var n=v(this,e.target),i=this.getDelegate(n);i&&(i.onTreeNodeDoubleClick(this,t,e),e.stopPropagation(),e.preventDefault())}}}function A(e){if(!e.target.classList.contains("group")&&!e.target.classList.contains("leaf")){var t=g(this,e.target);if(t){var n=v(this,e.target),i=this.getDelegate(n);i&&(i.onTreeNodeRightClick(this,t,e),e.stopPropagation(),e.preventDefault())}}}function M(e){var t=g(this,e.target);if(t){var n=v(this,e.target),i=this.getDelegate(n);i&&(i.onTreeNodeIconClick(this,t,e),e.stopPropagation(),e.preventDefault())}}function T(e){e.stopPropagation(),e.preventDefault()}h.constructor=u,s.GlobalManagerMixin.call(h),h.pushDelegate=function(e){this.delegates.push(e),this.idToDelegate[e.model.id]=e,f(this)},h.removeDelegate=function(e){for(var t=0;t<this.delegates.length;++t){if(this.delegates[t].model.id===e)return this.delegates.splice(t,1),delete this.idToDelegate[e],delete this.nodeIndexToNodeCssTables[e],f(this),!0}return!1},h.setInstanceTree=function(e,t){if(e.setInstanceTree(t),f(this),t){var n=new Uint8Array(e.getTreeNodeCount()),i=e.instanceTree.getRootId();e.forEachChild(i,(function(t){var i=e.getTreeNodeIndex(t);n[i]=e.isTreeNodeGroup(t)?1:2}),!0);var r=e.model.id;this.nodeIndexToNodeCssTables[r]=n;var o=0,a=0;t.enumNodeChildren(i,(function(e){a||(o=e),a++})),this.setAllCollapsed(e,!0);var s=this.options.excludeRoot,l=this.options.startCollapsed;s?(this.setCollapsed(e,i,!1),l||this.setCollapsed(e,o,!1)):l||this.setCollapsed(e,e.rootId,!1),f(this,!0)}},h.show=function(e){this.rootContainer.style.display=block},h.getRootContainer=function(){return this.rootContainer},h.getDelegate=function(e){return this.idToDelegate[parseInt(e)]},h.isCollapsed=function(e,t){var n=y(this,e,t);return n&&-1!==n.indexOf("collapsed")},h.setCollapsed=function(e,t,n,i){n?(this.addClass(e,t,"collapsed",i),this.removeClass(e,t,"expanded",i)):(this.addClass(e,t,"expanded",i),this.removeClass(e,t,"collapsed",i))},h.setAllCollapsed=function(e,t){var n=function(t){this.addClass(e,t,"collapsed",!1),this.removeClass(e,t,"expanded",!1)}.bind(this),i=e.instanceTree.getRootId();this.iterate(e,i,(function(t){return e.isTreeNodeGroup(t)&&n(t),!0}))},h.addToSelection=function(e,t){for(var n=t.length,i=0;i<n;++i)this.addClass(e,t[i],"selected",!1);f(this)},h.removeFromSelection=function(e,t){for(var n=t.length,i=0;i<n;++i)this.removeClass(e,t[i],"selected",!1);f(this)},h.setSelection=function(e,t){return this.clearSelection(e),this.addToSelection(e,t),this.selectedNodes},h.clearSelection=function(e){var t=[],n=function(n){var i=y(this,e,n);i&&-1!==i.indexOf("selected")&&(t[0]=n,this.removeFromSelection(e,t))}.bind(this),i=e.instanceTree.getRootId();e.forEachChild(i,n,!0)},h.isSelected=function(e){var t=y(this,delegate,e);return t&&-1!==t.indexOf("selected")},h.scrollTo=function(e,t){var n=this.getDelegate(t.id);if(!n||!n.isNotAvailable()){var i=!1,r=[],o=function(t,n){if(!(i=i||e===t)){r.push(n.getTreeNodeClientHeight(t));var a=r.length,s=n.isTreeNodeGroup(t)&&-1!==y(this,n,t).indexOf("expanded");n.forEachChild(t,(function(e){o(e,n)})),s||i||r.length>a&&r.splice(a)}}.bind(this);this.setCollapsed(n,e,!1,!0);var a=n.getRootId();if(o(a,n),!i)return-1;for(var s=0,l=r.length,c=this.isExcludeRoot()?1:0;c<l;++c)s+=r[c];if(1===this.delegates.length)return f(this,!0),s;for(c=0;c<this.delegates.length;++c){var u=this.delegates[c];if(u===n)break;r=[],e=-1,i=!1,a=u.getRootId(),o(a,u),l=r.length;for(var h=0,d=0;d<l;++d)h+=r[d];s+=h}return f(this,!0),s}},h.addClass=function(e,t,n,i){function r(t,n,i){var r=y(t,e,n);r&&(-1===r.indexOf(i)&&((r=r.slice(0)).push(i),r.sort(),b(t,e,n,r)))}if(i)for(var o=e.getTreeNodeParentId(m(this,t));o;)r(this,o,n),o=e.getTreeNodeParentId(o);else r(this,t,n);return f(this),!0},h.removeClass=function(e,t,n,i){function r(t,n,i){var r=y(t,e,n);if(r){var o=r.indexOf(i);-1!==o&&((r=r.slice(0)).splice(o,1),b(t,e,n,r))}}if(i)for(var o=e.getTreeNodeParentId(m(this,t));o;)r(this,o,n),o=e.getTreeNodeParentId(o);else r(this,t,n);return f(this),!0},h.hasClass=function(e,t){return 1!==y(this,delegate,e).indexOf(t)},h.clear=function(){for(var e,t=this.rootContainer;e=t.lastChild;)t.removeChild(e);for(var n=0;n<this.delegates.length;++n)this.delegates[n].clean();this.elementsUsed=0},h.iterate=function(e,t,n){null!=t&&e.shouldCreateTreeNode(t)&&n(t)&&e.forEachChild(t,function(t){this.iterate(e,t,n)}.bind(this))},h.forEachDelegate=function(e){for(var t=0;t<this.delegates.length;++t)e(this.delegates[t])},h.destroy=function(){this.clear(),cancelAnimationFrame(this.nextFrameId),this.rootContainer.parentNode.removeChild(this.rootContainer),this.rootContainer=null,this.rootId=-1,this.nodeCssTable=null,this.nodeIndexToNodeCssTables=null,this.cssStringToNodeCssTable=null,this.elementsPool=null,this.elementsUsed=-1,this.scrollY=-1,this.hammer&&(this.hammer.destroy(),this.hammer=null)},h.setScroll=function(e){Math.abs(this.scrollY-e)>c&&(this.scrollY=e,f(this))},h.displayNoProperties=function(e){var t=this.getDocument();if(e){if(!this.divNoProps){this.divNoProps=t.createElement("div");var n="Model Browser is not available";this.divNoProps.innerText=a.Z.t(n),this.divNoProps.setAttribute("data-i18n",n),this.divNoProps.classList.add("lmv-no-properties")}if(!this.divNoProps.parentNode)this.rootContainer.parentNode.appendChild(this.divNoProps)}else this.divNoProps&&this.divNoProps.parentNode&&this.divNoProps.parentNode.removeChild(this.divNoProps)},h.isExcludeRoot=function(){return 1===this.delegates.length&&this.options.excludeRoot},h.getDelegateCount=function(){return this.delegates.length}},75977:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ViewerModelStructurePanel:()=>g,generateDefaultViewerHandlerOptions:()=>c});var i=n(1204),r=n(20361),o=n(37169),a=n(68005),s=n(98926),l=n(83802),c=function(e){return{onSearchSelected:function(t){var n=t.id,i=e.impl.findModel(t.modelId);e.isolate(n,i)},onVisibilityIconClick:function(t,n){e.toggleVisibility(t,n)},onCreateUI:function(t){e.resizePanels&&e.resizePanels({dockingPanels:[t]}),t.scrollContainer.addEventListener("contextmenu",function(t){e.contextMenu.show(t)}.bind(t))},onIsolate:function(t,n){if(e.isolate(t,n),e.fitToView([t],n,!1),n){var i={type:o.SHOW_PROPERTIES_EVENT,dbId:t,model:n};e.dispatchEvent(i)}},onToggleMultipleOverlayedSelection:function(t){e.impl.selector.setAggregateSelection(t.map((function(t){return{model:e.impl.findModel(parseInt(t.modelId)),ids:t.ids}})));var n=e.getAggregateSelection();e.fitToView(n)},onToggleOverlayedSelection:function(t,n,i){i?e.select([],void 0,n):(e.select(t,n),e.fitToView([t],n,!1))},onTreeNodeRightClick:function(t){e.contextMenu.show(t)},onSelectOnly:function(t,n){e.select(t,n)},onDeselectAll:function(){e.clearSelection()},onSelectToggle:function(t,n){e.toggleSelect(t,n)},onShowAll:function(){e.showAll()},onFocus:function(){e.fitToView()},onHide:function(t,n){e.hide(t,n)},onShow:function(t,n){e.show(t,n)},onToggleVisibility:function(t,n){e.toggleVisibility(t,n)},getAggregateIsolation:e.getAggregateIsolation.bind(e),getAggregateHiddenNodes:e.getAggregateHiddenNodes.bind(e),getAggregateSelection:e.getAggregateSelection.bind(e),globalManager:e.globalManager,container:e.container,removeEventListener:e.removeEventListener.bind(e),addEventListener:e.addEventListener.bind(e)}};function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=Autodesk.Viewing.Private,m={click:{onObject:["isolate"]},clickShift:{onObject:["toggleMultipleOverlayedSelection"]},clickCtrl:{onObject:["toggleVisibility"]}};function g(e,t,n){var o=d({},n)||{},l=t;e instanceof Autodesk.Viewing.GuiViewer3D||e instanceof Autodesk.Viewing.Viewer3D?(s.logger.warn("Deprecated use of Viewer as parameter. Use options callbacks instead"),o=d(d({},o),c(e))):o=d({},e),this.visible=!1,this._trackNodeClick=!0,o.defaultTitle="Model",o.excludeRoot=void 0===o.excludeRoot||o.excludeRoot,o.startCollapsed=void 0!==o.startCollapsed&&o.startCollapsed,o.scrollEaseCurve=o.scrollEaseCurve||[0,0,.29,1],o.scrollEaseSpeed=void 0!==o.scrollEaseSpeed?o.scrollEaseSpeed:.003,o.addFooter=void 0===o.addFooter||o.addFooter,this.clickConfig=o&&o.docStructureConfig?o.docStructureConfig:m,this.isMac=-1!==navigator.userAgent.search("Mac OS"),o.hideSearch?(o.heightAdjustment=70,i.ModelStructurePanel.call(this,o.container,o.container.id+"ViewerModelStructurePanel",l,o),this.scrollContainer.classList.add("no-search")):(o.heightAdjustment=104,i.ModelStructurePanel.call(this,o.container,o.container.id+"ViewerModelStructurePanel",l,o),this.searchbox=new a.Searchbox(o.container.id+"ViewerModelStructurePanel-Searchbox",o.container,{excludeRoot:o.excludeRoot,searchFunction:v.bind(this)}),this.searchbox.setGlobalManager(this.globalManager),o.onSearchSelected&&this.searchbox.addEventListener(r.J,o.onSearchSelected),this.container.appendChild(this.searchbox.container)),this.setGlobalManager(o.globalManager),this._ignoreScroll=!1,this.selectedNodes={},this.onViewerSelect=this.onViewerSelect.bind(this),this.onViewerIsolate=this.onViewerIsolate.bind(this),this.onViewerHide=this.onViewerHide.bind(this),this.onViewerShow=this.onViewerShow.bind(this)}function v(e){var t=this.tree,n=e.toLowerCase(),i=[];return t.forEachDelegate((function(e){var r=e.getRootId(),o=[];t.iterate(e,r,(function(t){var i=e.instanceTree&&e.instanceTree.getNodeName(t);return i&&-1!==i.toLowerCase().indexOf(n)&&o.push(t),!0})),i.push({ids:o,delegate:e})})),f.analytics.track("viewer.model_browser",{from:"Panel",action:"Search"}),i}g.prototype=Object.create(i.ModelStructurePanel.prototype),g.prototype.constructor=g,l.ViewerPanelMixin.call(g.prototype),g.prototype.uninitialize=function(){var e,t,n,r,a,s,l,c;null===(e=(t=this.options).removeEventListener)||void 0===e||e.call(t,o.AGGREGATE_SELECTION_CHANGED_EVENT,this.onViewerSelect),null===(n=(r=this.options).removeEventListener)||void 0===n||n.call(r,o.AGGREGATE_ISOLATION_CHANGED_EVENT,this.onViewerIsolate),null===(a=(s=this.options).removeEventListener)||void 0===a||a.call(s,o.HIDE_EVENT,this.onViewerHide),null===(l=(c=this.options).removeEventListener)||void 0===l||l.call(c,o.SHOW_EVENT,this.onViewerShow),this.searchResults&&(this.searchResults.uninitialize(),this.searchResults=null),i.ModelStructurePanel.prototype.uninitialize.call(this)},g.prototype.resizeToContent=function(){var e=this.scrollContainer,t=this.tree?this.tree.getRootContainer():null;if(e&&t){var n="calc(100% + "+e.scrollLeft+"px)";t.style.width=n}},g.prototype.createUI=function(){var e,t,n,r,a,s,l,c,u,h;if(!this.uiCreated){i.ModelStructurePanel.prototype.createUI.call(this),this.scrollContainer.classList.remove("left");var d=function(){this.visible&&this.resizeToContent(),requestAnimationFrame(d)}.bind(this);d(),null===(e=(t=this.options).onCreateUI)||void 0===e||e.call(t,this);var p=this.options,f=p.maxHeight?p.maxHeight:"calc("+this.container.style.maxHeight+" - 30px)";this.container.style.top="10px",this.container.style.left="10px",this.container.style.height=f,this.container.style.maxHeight=f,null===(n=(r=this.options).addEventListener)||void 0===n||n.call(r,o.AGGREGATE_SELECTION_CHANGED_EVENT,this.onViewerSelect),null===(a=(s=this.options).addEventListener)||void 0===a||a.call(s,o.AGGREGATE_ISOLATION_CHANGED_EVENT,this.onViewerIsolate),null===(l=(c=this.options).addEventListener)||void 0===l||l.call(c,o.HIDE_EVENT,this.onViewerHide),null===(u=(h=this.options).addEventListener)||void 0===u||u.call(h,o.SHOW_EVENT,this.onViewerShow)}},g.prototype.onViewerSelect=function(e){this.setSelection(e.selections),this._ignoreScroll||this.scrollToSelection(e.selections),this._ignoreScroll=!1},g.prototype.onViewerIsolate=function(e){this.setIsolation(e.isolation)},g.prototype.onViewerHide=function(e){this.setHidden(e.nodeIdArray.slice(),e.model,!0)},g.prototype.onViewerShow=function(e){this.setHidden(e.nodeIdArray.slice(),e.model,!1)},g.prototype.setVisible=function(e){i.ModelStructurePanel.prototype.setVisible.call(this,e),this.visible!==e&&(this.visible=e,this.visible&&this.sync())},g.prototype.sync=function(){var e,t,n,i,r,o,a=(null===(e=(t=this.options).getAggregateIsolation)||void 0===e?void 0:e.call(t))||[],s=(null===(n=(i=this.options).getAggregateHiddenNodes)||void 0===n?void 0:n.call(i))||[],l=(null===(r=(o=this.options).getAggregateSelection)||void 0===r?void 0:r.call(o))||[];if(this.setIsolation(a),0===a.length)for(var c=0;c<s.length;++c){var u=s[c].model,h=s[c].ids;this.setHidden(h,u,!0)}this.setSelection(l),this.scrollToSelection(l)},g.prototype.removeTreeUI=function(e){delete this.selectedNodes[e.id],i.ModelStructurePanel.prototype.removeTreeUI.call(this,e)},g.prototype.setHidden=function(e,t,n){for(var i=this.tree,r=i.getDelegate(t.id),o=n?function(e){return i.addClass(r,e,"dim",!1),i.removeClass(r,e,"visible",!1),!0}:function(e){return i.removeClass(r,e,"dim",!1),i.addClass(r,e,"visible",!1),!0},a=0;a<e.length;++a)i.iterate(r,e[a],o)},g.prototype.setIsolation=function(e){var t=this,n=this.tree;if(0!==e.length){var i=[];e.length&&this.tree.forEachDelegate(function(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].model===t.model){n=r;break}-1===n&&i.push(t)}.bind(this));for(var r=function(i){var r=e[i].model,o=r.getData().instanceTree;if(!o)return"continue";var s=o.getRootId(),l=n.getDelegate(r.id);return n.iterate(l,s,(function(e){return n.removeClass(l,e,"dim",!1),n.removeClass(l,e,"visible",!1),!0})),0===(a=e[i].ids).length?"continue":1===a.length&&a[0]===s?{v:void 0}:(t.setHidden([s],r,!0),void t.setHidden(a,r,!1))},o=0;o<e.length;++o){var a,s=r(o);if("continue"!==s&&"object"===u(s))return s.v}for(var l=function(e){var r=i[e],o=r.model,a=r.instanceTree;if(!a)return"continue";var s=a.getRootId();n.iterate(r,s,(function(e){return n.removeClass(r,e,"dim",!1),n.removeClass(r,e,"visible",!1),!0})),t.setHidden([s],o,!0)},c=0;c<i.length;++c)l(c)}else n.forEachDelegate(function(e){var t=e.model,i=e.instanceTree;if(i){var r=i.getRootId();n.iterate(e,r,(function(t){return n.removeClass(e,t,"dim",!1),n.removeClass(e,t,"visible",!1),!0})),this.setHidden([r],t,!1)}}.bind(this))},g.prototype.setSelection=function(e){var t,n,i,r,o,a,s,l=this.tree;for(var c in this.selectedNodes)if(o=this.selectedNodes[c],(a=l.getDelegate(c))&&(s=a.instanceTree)){for(n=0;n<o.length;++n)for(i=s.getNodeParentId(o[t]);i;)l.removeClass(a,i,"ancestor-selected"),i=s.getNodeParentId(i);l.clearSelection(a)}for(this.selectedNodes={},t=0;t<e.length;++t)if(r=e[t].model,o=e[t].dbIdArray||e[t].selection,(a=l.getDelegate(r.id))&&(s=a.instanceTree)){for(n=0;n<o.length;++n)for(i=s.getNodeParentId(o[t]);i;)l.addClass(a,i,"ancestor-selected"),i=s.getNodeParentId(i);l.setSelection(a,o),this.selectedNodes[r.id]=o.concat()}},g.prototype.scrollToSelection=function(e){var t=e[0];if(t){var n=t.model,i=t.dbIdArray||t.selection,r=this.tree.scrollTo(i[0],n),o=this.scrollContainer.scrollTop;this.scrollContainer.scrollTop=r;var a=this.scrollContainer.scrollTop;this.scrollContainer.scrollTop=o,this.options.scrollEaseSpeed>0?this.animateScroll(o,a,function(e){this.tree.setScroll(e)}.bind(this)):(this.scrollContainer.scrollTop=a,this.tree.setScroll(a))}},g.prototype.onEyeIcon=function(e,t){var n,i;null===(n=(i=this.options).onVisibilityIconClick)||void 0===n||n.call(i,e,t),f.analytics.track("viewer.model_browser",{from:"Panel",action:"Toggle Visibility"})},g.prototype.onTreeNodeClick=function(e,t,n,i){if(this._trackNodeClick&&(s.logger.track({category:"node_selected",name:"model_browser_tool"}),this._trackNodeClick=!1),!this.isMac||!i.ctrlKey){var r="click";this.ctrlDown(i)&&(r+="Ctrl"),i.shiftKey&&(r+="Shift"),i.altKey&&(r+="Alt");var o=["toggleOverlayedSelection"],a=this.clickConfig[r];a&&(o=a.onObject),f.analytics.track("viewer.model_browser",{from:"Panel",action:"Select"}),this.handleAction(o,t,n)}},g.prototype.onTreeNodeRightClick=function(e,t,n,i){if(this.isMac&&i.ctrlKey&&0===i.button)return this.clickConfig&&this.clickConfig.clickCtrl&&this.handleAction(this.clickConfig.clickCtrl.onObject,t,n),null;this.options.onTreeNodeRightClick&&this.options.onTreeNodeRightClick(i)},g.prototype.handleAction=function(e,t,n){var i,r,o,a,s,l,c,u,h,d,p,f,m,g,v,y;for(var b in e)switch(e[b]){case"toggleOverlayedSelection":this.toggleOverlayedSelection(t,n);break;case"toggleMultipleOverlayedSelection":this.toggleMultipleOverlayedSelection(t,n);break;case"selectOnly":this.options.onSelectOnly&&this.options.onSelectOnly(t,n);break;case"deselectAll":null===(i=(r=this.options).onDeselectAll)||void 0===i||i.call(r,t,n);break;case"selectToggle":null===(o=(a=this.options).onSelectToggle)||void 0===o||o.call(a,t,n);break;case"isolate":null===(s=(l=this.options).onIsolate)||void 0===s||s.call(l,t,n);break;case"showAll":null===(c=(u=this.options).onShowAll)||void 0===c||c.call(u,t,n);break;case"focus":null===(h=(d=this.options).onFocus)||void 0===h||h.call(d,t,n);break;case"hide":null===(p=(f=this.options).onHide)||void 0===p||p.call(f,t,n);break;case"show":null===(m=(g=this.options).onShow)||void 0===m||m.call(g,t,n);break;case"toggleVisibility":null===(v=(y=this.options).onToggleVisibility)||void 0===v||v.call(y,t,n)}},g.prototype.toggleOverlayedSelection=function(e,t){var n,i,r=this.selectedNodes[t.id],o=r?r.indexOf(e):-1;this._ignoreScroll=!0,null===(n=(i=this.options).onToggleOverlayedSelection)||void 0===n||n.call(i,e,t,-1===o)},g.prototype.toggleMultipleOverlayedSelection=function(e,t){var n=this.selectedNodes[t.id],i=n?n.indexOf(e):-1;if(-1===i?(n||(n=this.selectedNodes[t.id]=[]),n.push(e)):n.splice(i,1),this.options.onToggleMultipleOverlayedSelection){var r=[];for(var o in this.selectedNodes)if(Object.prototype.hasOwnProperty.call(this.selectedNodes,o)){var a=this.selectedNodes[o];r.push({modelId:o,ids:a})}this.options.onToggleMultipleOverlayedSelection(r)}this._ignoreScroll=!0},g.prototype.ctrlDown=function(e){return this.isMac&&e.metaKey||!this.isMac&&e.ctrlKey}},66190:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ViewerObjectContextMenu:()=>o});var i=n(30587),r=n(98926);function o(e){i.ObjectContextMenu.call(this,e)}o.prototype=Object.create(i.ObjectContextMenu.prototype),o.prototype.constructor=o,o.prototype.buildMenu=function(e,t){var n=this;if(this.viewer.model){var i=this,o=[],a=this.viewer.navigation,s=this.viewer.model.is2d(),l=Autodesk.Viewing.Private.analytics;t.hasSelected&&(o.push({title:"Isolate",target:function(){var e=i.viewer.getAggregateSelection();i.viewer.clearSelection(),i.viewer.impl.visibilityManager.aggregateIsolate(e),r.logger.track({name:"isolate_count",aggregate:"count"}),l.track("viewer.object.visibility",{action:"Isolate"})}}),t.hasVisible&&o.push({title:"Hide Selected",target:function(){var e=i.viewer.impl.selector.getAggregateSelection();i.viewer.clearSelection(),i.viewer.impl.visibilityManager.aggregateHide(e),l.track("viewer.object.visibility",{action:"Hide Selected"})}}),t.hasHidden&&o.push({title:"Show Selected",target:function(){var e=i.viewer.getSelection();i.viewer.clearSelection(),i.viewer.show(e),l.track("viewer.object.visibility",{action:"Show Selected"})}})),s&&o.push({title:"Show All Layers",target:function(){i.viewer.setLayerVisible(null,!0),l.track("viewer.object.visibility",{action:"Show All Layers"})}}),o.push({title:"Show All Objects",target:function(){i.viewer.showAll(),r.logger.track({name:"showall",aggregate:"count"}),l.track("viewer.object.visibility",{action:"Show All Objects"})}});var c=i.viewer.getAggregateSelection();if(!s&&1===c.length&&a.isActionEnabled("gotoview")&&o.push({title:"Focus",target:function(){if((c=i.viewer.getAggregateSelection()).length>0){var e=c[0];i.viewer.fitToView(e.selection,e.model)}else 0===c.length&&i.viewer.fitToView();r.logger.track({name:"fittoview",aggregate:"count"})}}),!s){var u=this.viewer.impl.getCanvasBoundingClientRect(),h=e.clientX-u.left,d=e.clientY-u.top,p=this.viewer.clientToWorld(h,d,!1);p&&o.push({title:"Pivot",target:function(){n.viewer.navigation.setPivotPoint(p.point)}})}return t.hasSelected&&o.push({title:"Clear Selection",target:function(){i.viewer.clearSelection(),r.logger.track({name:"clearselection",aggregate:"count"})}}),o}}},83802:(e,t,n)=>{"use strict";function i(){this.getContainerBoundingRect=function(){var e=this.parentContainer.getBoundingClientRect(),t={height:0,width:0,left:0,bottom:0,right:0,top:0},n=this.getDocument().getElementsByClassName("toolbar-menu");return n&&n.length>0&&(t=n[0].getBoundingClientRect()),{height:e.height-t.height,width:e.width,left:e.left,bottom:e.bottom-t.height,right:e.right,top:e.top}}}n.r(t),n.d(t,{ViewerPanelMixin:()=>i})},32757:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ViewerPropertyPanel:()=>c});var i=n(53974),r=n(83802),o=n(37169),a=n(76723),s=n(98926);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e){this.viewer=e,this.setGlobalManager(e.globalManager),this.currentNodeIds=[],this.currentModel=null,this.currentSelections=[],this.isDirty=!0,this.propertyNodeId=null,this.normalTitle="Properties",this.loadingTitle="Object Properties Loading",this._viewDbId=null,this.onProperties=this.onProperties.bind(this),this.onPropertySet=this.onPropertySet.bind(this),this.onPropError=this.onPropError.bind(this),this.setPropertiesIntoUI=this.setPropertiesIntoUI.bind(this),this.setAggregatedPropertiesIntoUI=this.setAggregatedPropertiesIntoUI.bind(this),this._onDisplayUnitPreferenceChanged=this._onDisplayUnitPreferenceChanged.bind(this),i.PropertyPanel.call(this,e.container,"ViewerPropertyPanel",this.loadingTitle)}function u(e){var t=e.getDocumentNode(),n=t&&t.findViewableParent();return!(!n||-1===n.name().toLocaleLowerCase().indexOf(".sld"))}c.prototype=Object.create(i.PropertyPanel.prototype),c.prototype.constructor=c,r.ViewerPanelMixin.call(c.prototype),c.prototype._onDisplayUnitPreferenceChanged=function(){this.isDirty=!0;var e=this.currentModel?this.currentModel.getRootId():null;if(null!==this.propertyNodeId&&this.propertyNodeId!==e){var t={model:this.currentModel};t.selection=Array.isArray(this.propertyNodeId)?this.propertyNodeId:[this.propertyNodeId],this.requestAggregatedNodeProperties(t)}else this.requestProperties()},c.prototype.initialize=function(){i.PropertyPanel.prototype.initialize.call(this);var e=this;this.viewer.prefs.addListeners(Autodesk.Viewing.Private.Prefs.DISPLAY_UNITS,this._onDisplayUnitPreferenceChanged),this.viewer.prefs.addListeners(Autodesk.Viewing.Private.Prefs.DISPLAY_UNITS_PRECISION,this._onDisplayUnitPreferenceChanged),e.addEventListener(e.viewer,o.AGGREGATE_SELECTION_CHANGED_EVENT,(function(t){t.selections&&t.selections.length?(e.currentNodeIds=t.selections[0].dbIdArray,e.currentModel=t.selections[0].model,e.currentSelections=[],t.selections.forEach((function(t){e.currentSelections.push({model:t.model,selection:t.dbIdArray})}))):e.resetCurrentModel(),e.isDirty=!0,e.requestProperties()})),e.addEventListener(e.viewer,o.SHOW_PROPERTIES_EVENT,(function(t){t&&t.dbId&&(e.currentModel=t.model,e.requestAggregatedNodeProperties({model:t.model,selection:[t.dbId]}))})),e.addEventListener(e.viewer,o.HIDE_EVENT,(function(t){e.isDirty=!0,e.requestProperties()})),e.addEventListener(e.viewer,o.OBJECT_TREE_CREATED_EVENT,(function(t){e.currentModel===t.model&&(e.isDirty=!0,e.requestProperties())})),e.addEventListener(e.viewer,o.SHOW_EVENT,(function(t){e.isDirty=!0,e.requestProperties()}));var t=this.viewer.getAggregateSelection();t.length?(this.currentModel=t[0].model,this.currentNodeIds=t[0].selection,this.currentSelections=t):this.resetCurrentModel()},c.prototype.resetCurrentModel=function(){var e=this.viewer?this.viewer.getVisibleModels():[];this.currentModel=1===e.length?e[0]:null,this.currentNodeIds=[],this.currentSelections=[]},c.prototype.setTitle=function(e,t){e||(e="Object Properties",(t=t||{}).localizeTitle=!0),i.PropertyPanel.prototype.setTitle.call(this,e,t)},c.prototype.setVisible=function(e){a.DockingPanel.prototype.setVisible.call(this,e),this.requestProperties()},c.prototype.visibilityChanged=function(){a.DockingPanel.prototype.visibilityChanged.call(this),this.isVisible()&&this.requestProperties()},c.prototype.requestProperties=function(){this.isVisible()&&this.isDirty&&(this.currentSelections.length>0?this.requestAggregatedNodeProperties(this.currentSelections):this.showDefaultProperties(),this.isDirty=!1)},c.prototype.onProperties=function(e){var t=this;if(this.viewer&&this.currentModel&&e.dbId===this.propertyNodeId){var n,i=[],r=e.properties;if(r)for(var o=0,a=r.length;o<a;++o){var s=r[o];"__internalref__"===s.displayCategory&&i.push(s.displayValue)}var l=this.currentModel;n=l.is3d()&&u(l)&&i.length>0?function(e,t,n){return new Promise((function(i,r){e.getBulkProperties2(t,{ignoreHidden:!0},(function(e){for(var t=0,r=e.length;t<r;++t)for(var o=e[t],a=0,s=o.properties.length;a<s;++a){for(var l=o.properties[a],c=!0,u=0,h=n.properties.length;u<h;++u)n.properties[u].displayName===l.displayName&&(c=!1,u=h);c&&n.properties.push(l)}i(n)}))}))}(l,i,e):Promise.resolve(e),n.then(this.setPropertiesIntoUI).catch((function(){t.setProperties([]),t.highlight(""),t.resizeToContent(),t.respositionPanel()}))}},c.prototype.onPropertySet=function(e){var t=this;if(this.viewer&&this.currentModel){if(0===e.getVisibleKeys().length)return this.onPropError(),this.resizeToContent(),void this.respositionPanel();var n=e.map,i=[];e.getValidIds(null,"__internalref__").forEach((function(e){n[e].forEach((function(e){i.includes(e.displayValue)||i.push(e.displayValue)}))}));var r=this.currentModel;(r.is3d()&&u(r)&&i.length>0?function(e,t,n){return new Promise((function(i,r){e.getPropertySet(t,(function(e){i(n.merge(e))}),r,{ignoreHidden:!0})}))}(r,i,e):Promise.resolve(e)).then(this.setAggregatedPropertiesIntoUI).catch((function(e){s.logger.error(e),t.setProperties([]),t.highlight(""),t.resizeToContent(),t.respositionPanel()}))}},c.prototype.setAggregatedPropertiesIntoUI=function(e){var t=e.getDbIds().length;if(1===t){var n=Object.prototype.hasOwnProperty.call(e.map,"Name"),i=n?e.map.Name[0]:this.normalTitle;"object"===l(i)&&Object.prototype.hasOwnProperty.call(i,"displayValue")&&(n=!0,i=i.displayValue),this.setTitle(i,{localizeTitle:!n})}else this.setTitle("Properties %(value)",{localizeTitle:!0,i18nOpts:{value:"(".concat(t,")")}});this.setAggregatedProperties(e),this.highlight(this.viewer.searchText),this.resizeToContent(),this.respositionPanel()},c.prototype.setPropertiesIntoUI=function(e){var t=e.name||this.normalTitle,n=!e.name;this.setTitle(t,{localizeTitle:n}),"name"in e&&e.properties&&e.properties.splice(0,0,{displayName:"Name",displayValue:e.name,displayCategory:null,attributeName:"Name",type:20,units:null,hidden:!1,precision:0}),this.setProperties(e.properties),this.highlight(this.viewer.searchText),this.resizeToContent(),this.respositionPanel()},c.prototype.onPropError=function(){this.setTitle(this.normalTitle,{localizeTitle:!0}),this.showNoProperties()},c.prototype.requestAggregatedNodeProperties=function(e){var t,n=this;1===(e=Array.isArray(e)?e:[e]).length&&1===(null===(t=e[0].selection)||void 0===t?void 0:t.length)&&(this.propertyNodeId=e[0].selection[0]);var i=[];e.forEach((function(e){var t,n,r,o;i.push(e.model.getPropertySetAsync(e.selection,{fileType:null===(t=e.model.getData())||void 0===t||null===(n=t.loadOptions)||void 0===n?void 0:n.fileExt,needsExternalId:null===(r=e.model.getData())||void 0===r||null===(o=r.loadOptions)||void 0===o?void 0:o.needsExternalId}))})),Promise.all(i).then((function(e){for(var t=e[0],i=1;i<e.length;i++)t.merge(e[i]);n.onPropertySet(t)})).catch(this.onPropError)},c.prototype.requestNodeProperties=function(e){var t=this,n=this.currentModel;this.propertyNodeId=e;var i=Array.isArray(e);(i?n.getPropertySet.bind(n):n.getProperties2.bind(n))(e,(function(e){t.viewer&&n===t.currentModel&&(i?t.onPropertySet(e):t.onProperties(e))}),this.onPropError)},c.prototype.setNodeProperties=c.prototype.requestNodeProperties,c.prototype.requestViewProperties=function(e){var t=this;if(null===this._viewDbId){var n=this.currentModel,i=n.getRootId();this.propertyNodeId=i,n.getPropertySet([i],(function(r){if(t.viewer&&n===t.currentModel){t._viewDbId=i;var o=e.name(),a=e.isSheet(),s=[],l=[],c=r.getValidIds("Sheet"),u=r.getValidIds("View");c.forEach((function(e){r.map[e].forEach((function(e){l.push(e.displayValue)}))})),u.forEach((function(e){r.map[e].forEach((function(e){s.push(e.displayValue)}))}));var h=a?l:s;if(0!==h.length){var d=t;n.getBulkProperties2(h,{propFilter:["name","dbId"],ignoreHidden:!0},(function(e){for(var t=[],s=0;s<e.length;++s)if(-1!==o.indexOf(e[s].name)){var l=e[s].dbId;if(!a)return d._viewDbId=l,void d.requestAggregatedNodeProperties({model:d.currentModel,selection:[l]});t.push(l)}0!==t.length?function(e,t,n){return new Promise((function(i,r){n=n||e.myData.metadata.title,e.getBulkProperties2(t,{ignoreHidden:!0},(function(e){for(var t=0,r=e.length;t<r;++t){var o=e[t];if(o.name&&-1!==n.indexOf(o.name))for(var a=0,s=o.properties.length;a<s;++a){var l=o.properties[a];if("Sheet Number"===l.displayName&&-1!==n.indexOf(l.displayValue))return i(o)}}return i(null)}))}))}(n,t,o).then((function(e){e&&e.dbId&&e.dbId!==i?(d._viewDbId=e.dbId,d.requestAggregatedNodeProperties({model:d.currentModel,selection:[e.dbId]})):d.onPropertySet(r)})):d.onPropertySet(r)}))}else t.onPropertySet(r)}}),this.onPropError)}else{var r={model:this.currentModel,selection:[this._viewDbId]};this.requestAggregatedNodeProperties(r)}},c.prototype.respositionPanel=function(){if(this.isVisible()){var e=this.viewer.toolController,t=e.lastClickX,n=e.lastClickY,i=this.container.getBoundingClientRect(),r=i.left,o=i.top,a=i.width,s=i.height,l=this.viewer.impl.getCanvasBoundingClientRect(),c=l.left,u=l.top,h=l.width,d=l.height;r<=t&&t<r+a&&o<=n&&n<o+s&&(t<r+a/2&&t+a<c+h?(this.container.style.left=Math.round(t-c)+"px",this.container.dockRight=!1):c<=t-a?(this.container.style.left=Math.round(t-c-a)+"px",this.container.dockRight=!1):t+a<c+h?(this.container.style.left=Math.round(t-c)+"px",this.container.dockRight=!1):n+s<u+d?(this.container.style.top=Math.round(n-u)+"px",this.container.dockBottom=!1):u<=n-s&&(this.container.style.top=Math.round(n-u-s)+"px",this.container.dockBottom=!1))}},c.prototype.showDefaultProperties=function(){var e=this.currentModel?this.currentModel.getRootId():null;if(e){var t=this.currentModel.getDocumentNode();t&&!t.isMasterView()?this.requestViewProperties(t):this.requestAggregatedNodeProperties({model:this.currentModel,selection:[e]})}else this.propertyNodeId=null,this.setTitle(this.normalTitle,{localizeTitle:!0}),i.PropertyPanel.prototype.showDefaultProperties.call(this)},c.prototype.areDefaultPropertiesShown=function(){if(!this.currentModel)return!1;var e=this.currentModel.getRootId();return this.propertyNodeId===e},c.prototype.uninitialize=function(){i.PropertyPanel.prototype.uninitialize.call(this),this.viewer.prefs.removeListeners(Autodesk.Viewing.Private.Prefs.DISPLAY_UNITS,this._onDisplayUnitPreferenceChanged),this.viewer.prefs.removeListeners(Autodesk.Viewing.Private.Prefs.DISPLAY_UNITS_PRECISION,this._onDisplayUnitPreferenceChanged),this.viewer=null,this._viewDbId=null,this.currentModel=null,this.currentSelections=[],this.propertyNodeId=null,this.currentNodeIds=null},c.prototype.onCategoryClick=function(e,t){i.PropertyPanel.prototype.onCategoryClick.call(this,e,t),this.resizeToContent()},c.prototype.onCategoryIconClick=function(e,t){i.PropertyPanel.prototype.onCategoryIconClick.call(this,e,t),this.resizeToContent()}},49710:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ViewerSettingTab:()=>A,ViewerSettingsPanel:()=>T});var i=n(89853),r=n(37169),o=n(98926),a=n(95018),s=n(71224),l=n(84998),c=n(83802),u=n(35449);function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var d=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._width=t||60,this._height=n||60}var t,n,i;return t=e,(n=[{key:"createThumbnail",value:function(e,t){var n=this;return new Promise((function(t){var i=n.getDocument().createElement("canvas");i.width=n._width,i.height=n._height;var r=i.getContext("2d"),o=r.createLinearGradient(0,0,0,i.height),a=e.bgColorGradient,s=p(a[0],a[1],a[2]),l=p(a[3],a[4],a[5]);o.addColorStop(0,s),o.addColorStop(1,l),r.fillStyle=o,r.fillRect(0,0,i.width,i.height),i.toBlob((function(e){var n=URL.createObjectURL(e);t(n)}))}))}}])&&h(t.prototype,n),i&&h(t,i),e}();function p(e,t,n){return e=parseInt(e),t=parseInt(t),n=parseInt(n),"#"+f(e)+f(t)+f(n)}function f(e){if(0===e)return"00";for(var t="",n=e>255?255:e;0!==n;){var i=n%16;n=n/16|0,t=m[i.toString()]+t}return t.length>1?t:"0"+t}u.GlobalManagerMixin.call(d.prototype);var m={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},g=n(23279),v=n.n(g),y=n(55412),b=n(50041),_=n(5130);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=Autodesk.Viewing.Private,S=0,A={Navigation:"navigationtab",Configuration:"performancetab",Appearance:"appearance",Environment:"environment"},M=0;function T(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);if(e instanceof Autodesk.Viewing.GuiViewer3D||e instanceof Autodesk.Viewing.Viewer3D){var a=e;n={preferences:a.prefs,globalManager:a.globalManager,addEventListener:a.addEventListener.bind(a),removeEventListener:a.removeEventListener.bind(a),container:a.container,version:a.config.viewerVersion,onRestoreDefaults:a.restoreDefaultSettings.bind(a),detectIfModelsHaveEdge:function(){if(t.is2d())return!1;for(var e=!1,n=a.impl.modelQueue().getModels(),i=0;i<n.length;i++){if(n[i].hasEdges){e=!0;break}}return e},loadExtension:function(e){a.loadExtension(e)},unloadExtension:function(e){a.unloadExtension(e)},width:400,heightAdjustment:110}}this.options=n,this.preferences=n.preferences,this.is3dMode=!t.is2d(),this.visible=!1,this._externalButtonIds=[],this._externalButtonsLabel=null,i.SettingsPanel.call(this,this.options.container,"ViewerSettingsPanel"+S+++"-"+M++,"Settings",n),this.container.classList.add("viewer-settings-panel"),this.setGlobalManager(this.options.globalManager),this.addTab(A.Configuration,"Configuration",{className:"performance"}),this.addTab(A.Navigation,"Navigation",{className:"navigation"}),this.addTab(A.Appearance,"Appearance",{className:"appearance"}),this.is3dMode?this.addTab(A.Environment,"Environment",{className:"environment"}):this.container.classList.add("for-2d-model"),this.createRestoreDefaultSettingsButton(),this.modelPreferenceCount=0,this.createNavigationPanel(),this.createConfigurationPanel(),this.createAppearancePanel(),this.modelPreferenceCount&&o.logger.log("Model locked ("+this.modelPreferenceCount+") render settings in UI."),this.selectTab(A.Configuration),this.footer=this.createFooter(),this.createVersionLabel(this.footer),this.syncUI=this.syncUI.bind(this),this.options.addEventListener(r.RESTORE_DEFAULT_SETTINGS_EVENT,this.syncUI),this.options.addEventListener(r.VIEWER_STATE_RESTORED_EVENT,this.syncUI),this.updateEdgeToggle=this.updateEdgeToggle.bind(this),this.options.addEventListener(r.GEOMETRY_LOADED_EVENT,this.updateEdgeToggle),this.sendAnalyticsDebounced=v()((function(e,t){w.analytics.track("viewer.settings.changed",{setting_name:e,setting_value:t})}),500)}function C(e,t,n){e.createThumbnail(n).then((function(e){t.src=e,t.onload=function(){URL.revokeObjectURL(e)}}))}T.prototype=Object.create(i.SettingsPanel.prototype),T.prototype.constructor=T,c.ViewerPanelMixin.call(T.prototype),T.prototype.uninitialize=function(){var e,t,n,o,a,s;this._onBgEnvironmentChange&&this._onBgEnvironmentReset&&(this.preferences.removeListeners(w.Prefs3D.LIGHT_PRESET,this._onBgEnvironmentChange,this._onBgEnvironmentReset),this._onBgEnvironmentChange=null,this._onBgEnvironmentReset=null),null===(e=(t=this.options).removeEventListener)||void 0===e||e.call(t,r.RESTORE_DEFAULT_SETTINGS_EVENT,this.syncUI),null===(n=(o=this.options).removeEventListener)||void 0===n||n.call(o,r.VIEWER_STATE_RESTORED_EVENT,this.syncUI),null===(a=(s=this.options).removeEventListener)||void 0===a||a.call(s,r.GEOMETRY_LOADED_EVENT,this.updateEdgeToggle),i.SettingsPanel.prototype.uninitialize.call(this),this.envSelect=null},T.prototype.setVisible=function(e){this.visible=e,i.SettingsPanel.prototype.setVisible.call(this,e),e&&this.sizeToContent(),e&&this.createEnvironmentPanel()},T.prototype.addCheckbox=function(e,t,n,r,o,a){var s=this.preferences,l=s[a];r="boolean"==typeof l?l:r;var c=i.SettingsPanel.prototype.addCheckbox.call(this,e,t,r,(function(e){a&&(s.set(a,e),w.analytics.track("viewer.settings.changed",{setting_name:a,setting_value:e})),o&&o(e)}),n),u=this.getControl(c);return u.saveKey=a,a?s.addListeners(a,(function(e){u.setValue(e)}),(function(e){u.setValue(e),o&&o(e)})):u.sliderRow.classList.add("logical-group"),s.hasTag(a,"no-storage")&&(u.sliderRow.classList.add("no-storage"),this.modelPreferenceCount++),c},T.prototype.addDropDownMenu=function(e,t,n,r,o,a,s){var l=this.preferences;a&&(o=r.indexOf(l.get(a)));var c=i.SettingsPanel.prototype.addDropDownMenu.call(this,e,t,n,o,(function(e){a&&("displayUnits"==a?l.set(a,new b.EnumType(_.displayUnitsEnum,r[e.detail.value])):"displayUnitsPrecision"==a?l.set(a,new b.EnumType(_.displayUnitsPrecisionEnum,r[e.detail.value])):l.set(a,r[e.detail.value]),w.analytics.track("viewer.settings.changed",{setting_name:a,setting_value:r[e.detail.value]}))}),s),u=this.getControl(c);return a?l.addListeners(a,(function(e){u.setSelectedIndex(r.indexOf(e))}),(function(e){u.setSelectedIndex(r.indexOf(e))})):u.sliderRow.classList.add("logical-group"),l.hasTag(a,"no-storage")&&(u.sliderRow.classList.add("no-storage"),this.modelPreferenceCount++),c},T.prototype.addSliderV2=function(e,t,n,r,o,a,s,l){var c=this.preferences,u=c.get(l);a="number"==typeof u?u:a,l&&!Object.prototype.hasOwnProperty.call(c,l)&&c.add(l,a,["2d","3d"]);var h=i.SettingsPanel.prototype.addSliderV2.call(this,e,t,n,r,o,a,(function(e){var t="number"==typeof e?e:Number(e.detail.value);l&&c.set(l,t)}),s),d=this.getControl(h[1]);return d.saveKey=l,l?c.addListeners(l,(function(e){d.setValue(e)})):d.sliderRow.classList.add("logical-group"),c.hasTag(l,"no-storage")&&(d.sliderRow.classList.add("no-storage"),this.modelPreferenceCount++),h},T.prototype.addGrid=function(e,t,n,i){var r=this.preferences,o=e,a=this.getDocument(),l=a.createElement("div");l.classList.add("environments-container"),o.appendChild(l);var c=a.createElement("div");c.classList.add("environments-lighting-table"),l.appendChild(c);var u=new d(42,26);u.setGlobalManager(this.globalManager);for(var h=0;h<t.length;h++){var p=t[h],f=a.createElement("div");f.classList.add("settings-environment-cell"),f.index=h;var m=a.createElement("img");m.classList.add("settings-environment-image"),C(u,m,p),f.appendChild(m);var g=a.createElement("span");g.textContent=s.Z.t(p.name),g.classList.add("settings-environment-name"),g.setAttribute("data-i18n",p.name),f.appendChild(g),f.addEventListener("click",(function(){r.set(i,this.index)})),c.appendChild(f)}return this.preferences.addListeners(i,n),c},T.prototype.updateEnvironmentSelection=function(){if(this.is3dMode&&this.envTabCreated){var e=this.preferences.get("lightPreset");if("string"==typeof e)e=a.LightPresets.map((function(e){return e.name})).indexOf(e);for(var t=this.gridTable.querySelectorAll(".settings-environment-cell"),n=0;n<t.length;n++)t[n].index===e?t[n].classList.add("border-select"):t[n].classList.remove("border-select")}},T.prototype.removeCheckbox=function(e){return this.preferences.removeListeners(e.saveKey),this.removeEventListener(e,"change",e.changeListener),i.SettingsPanel.prototype.removeCheckbox.call(this,e)},T.prototype.createNavigationPanel=function(){var e=this,t=A.Navigation;function n(){return this.addSliderV2(t,"Drag Speed","Changes sensitivity of mouse movement with the zoom tool",5,300,this.options.initialZoomDragSpeed,{step:5},y.Prefs.ZOOM_DRAG_SPEED)[1]}function i(){return this.addSliderV2(t,"Scroll Speed","Changes sensitivity of the mouse scroll wheel when zooming",.1,3,this.options.initialZoomScrollScale,{step:.1},y.Prefs.ZOOM_SCROLL_SPEED)[1]}this.is3dMode&&(this.addLabel(t,"ViewCube"),this.addCheckbox(t,"Show ViewCube","Toggles availability of the ViewCube navigation control",!0,void 0,y.Prefs3D.VIEW_CUBE),(0,l.isMobileDevice)()||this.addCheckbox(t,"ViewCube acts on pivot","When enabled, the ViewCube orbits the view around the active pivot point When disabled, it orbits around the center of the view",!1,void 0,y.Prefs3D.ALWAYS_USE_PIVOT),this.addLabel(t,"Orbit"),this.addCheckbox(t,"Fusion style orbit","Enables Fusion-style orbit overlay and gives the ability to lock orbit axis",!1,(function(t){t?e.options.loadExtension("Autodesk.Viewing.FusionOrbit",null):e.options.unloadExtension("Autodesk.Viewing.FusionOrbit",null)}),y.Prefs.FUSION_ORBIT),this.addCheckbox(t,"Orbit past world poles","Allows view rotation to continue past the models North Pole",!0,void 0,y.Prefs3D.ORBIT_PAST_WORLD_POLES),this.addLabel(t,"Zoom"),(0,l.isMobileDevice)()||(this.addCheckbox(t,"Zoom towards pivot","When disabled, zooming operations are centered at the current cursor location",!1,void 0,y.Prefs3D.ZOOM_TOWARDS_PIVOT),this.addCheckbox(t,"Reverse mouse zoom direction","Toggles direction of zooming in and out",!1,void 0,y.Prefs.REVERSE_MOUSE_ZOOM_DIR),this.scrollSpeed=i.call(this)),this.dragSpeed=n.call(this),this.addLabel(t,"Mouse"),(0,l.isMobileDevice)()||(this.addCheckbox(t,"Left handed mouse setup","Swaps the buttons on the mouse",!1,void 0,y.Prefs.LEFT_HANDED_MOUSE_SETUP),this.addCheckbox(t,"Set pivot with left mouse button","Change left-click behavior to set new pivot point (overrides select object)",!1,void 0,y.Prefs3D.CLICK_TO_SET_COI)),this.addCheckbox(t,"Open properties on select","Always show properties upon selecting object",!0,void 0,y.Prefs.OPEN_PROPERTIES_ON_SELECT)),this.is3dMode||(this.addLabel(t,"Zoom"),this.addCheckbox(t,"Reverse mouse zoom direction","Toggles direction of zooming in and out",!1,void 0,y.Prefs.REVERSE_MOUSE_ZOOM_DIR),(0,l.isMobileDevice)()||(this.scrollSpeed=i.call(this)),this.dragSpeed=n.call(this),this.addLabel(t,"Mouse"),this.addCheckbox(t,"Open properties on select","Always show properties upon selecting object",!0,void 0,y.Prefs.OPEN_PROPERTIES_ON_SELECT),(0,l.isMobileDevice)()||this.addCheckbox(t,"Left handed mouse setup","Swaps the buttons on the mouse",!1,void 0,y.Prefs.LEFT_HANDED_MOUSE_SETUP))},T.prototype.addConfigButton=function(e,t){var n=this;if(!t)throw new Error("Must register a function callback.");this._externalButtonsLabel||(this._externalButtonsLabel=this.addLabel(A.Configuration,"More"));var i=this.addButton(A.Configuration,e);return this.getControl(i).setOnClick((function(){n.setVisible(!1),t()})),this._externalButtonIds.push(i),i},T.prototype.removeConfigButton=function(e){var t=this._externalButtonIds.indexOf(e);if(-1===t)return!1;var n=this.getControl(e);return!!n&&(this.removeControl(n),this._externalButtonIds.splice(t,1),0===this._externalButtonIds.length&&null!==this._externalButtonsLabel&&(this._externalButtonsLabel.removeFromParent(),this._externalButtonsLabel=null),!0)},T.prototype.updateEdgeToggle=function(){var e=document.getElementById(this.edgeCheckboxName+"_check");e&&(this.is3dMode&&(this.options.detectIfModelsHaveEdge()?e.disabled=!1:(e.disabled=!0,e.checked=!1)))},T.prototype.createConfigurationPanel=function(){var e=this,t=A.Configuration;this.is3dMode?(this.addLabel(t,"Performance Optimization"),this.optimizeNavigationhkBoxId=this.addCheckbox(t,"Smooth navigation","Provides faster response(but degrades quality) while navigating",(0,l.isMobileDevice)(),void 0,y.Prefs3D.OPTIMIZE_NAVIGATION),this.progressiveRenderChkBoxId=this.addCheckbox(t,"Progressive display","Shows incremental updates of the view and allows for more responsive interaction with the model (some elements may flicker) This improves perceived waiting time",!0,void 0,y.Prefs.PROGRESSIVE_RENDERING),this.addLabel(t,"Display"),this.ghosthiddenChkBoxId=this.addCheckbox(t,"Ghost hidden objects","Leave hidden objects slightly visible",!0,void 0,y.Prefs3D.GHOSTING),this.displayLinesId=this.addCheckbox(t,"Display Lines","Toggles display of line objects",!0,void 0,y.Prefs3D.LINE_RENDERING),this.displayPointsId=this.addCheckbox(t,"Display Points","Toggles display of point objects",!0,void 0,y.Prefs.POINT_RENDERING),this.edgeCheckboxName="Display edges",this.displayEdgesId=this.addCheckbox(t,this.edgeCheckboxName,"Shows outline of model surfaces",!1,(function(t){e.getControl(e.displayEdgesId).setValue(t),e.updateEdgeToggle()}),y.Prefs3D.EDGE_RENDERING),this.updateEdgeToggle(),this.displaySectionHatchesId=this.addCheckbox(t,"Display Section Hatches","Shows hatch pattern for section planes this does not apply to section boxes",!0,null,w.Prefs3D.DISPLAY_SECTION_HATCHES)):(this.addLabel(t,"Performance Optimization"),this.progressiveRenderChkBoxId=this.addCheckbox(t,"Progressive display","Shows incremental updates of the view and allows for more responsive interaction with the model (some elements may flicker) This improves perceived waiting time",!0,void 0,y.Prefs.PROGRESSIVE_RENDERING),this.addLabel(t,"Display")),this.displayUnitsId=this.addDropDownMenu(t,"Display Units",w.displayUnits,w.displayUnitsEnum,null,w.Prefs.DISPLAY_UNITS),this.displayUnitsPrecisionId=this.addDropDownMenu(t,"Precision",w.displayUnitsPrecision,w.displayUnitsPrecisionEnum,null,w.Prefs.DISPLAY_UNITS_PRECISION),this.is3dMode&&this._addSelectionModeOption()},T.prototype._addSelectionModeOption=function(){var e=A.Configuration;this.addLabel(e,"Selection");var t=[],n=[],i=0;for(var r in Autodesk.Viewing.SelectionMode)t[i]=r,n[i]=Autodesk.Viewing.SelectionMode[r],i++;var o=t.map((function(e){return e.split("_").map((function(e){return e.charAt(0)+e.slice(1).toLowerCase()})).join(" ")}));this.selectionModeId=this.addDropDownMenu(e,"Selection Mode",o,n,null,w.Prefs3D.SELECTION_MODE)},T.prototype.createAppearancePanel=function(){var e=A.Appearance;this.is3dMode?(this.addLabel(e,"Visual Quality Optimization"),this.antialiasingChkBoxId=this.addCheckbox(e,"Anti-aliasing","Remove jagged edges from lines",!0,void 0,y.Prefs3D.ANTIALIASING),this.ambientshadowsChkBoxId=this.addCheckbox(e,"Ambient shadows","Improve shading of occluded surfaces",!0,void 0,y.Prefs3D.AMBIENT_SHADOWS),this.groundShadowChkBoxId=this.addCheckbox(e,"Ground shadow","Add simulated ground surface shadows",!0,void 0,y.Prefs3D.GROUND_SHADOW),this.groundReflectionChkBoxId=this.addCheckbox(e,"Ground reflection","Add simulated ground surface reflections",!1,void 0,y.Prefs3D.GROUND_REFLECTION)):(this.addLabel(e,"Existing behavior"),this.swapBlackAndWhiteChkBoxId=this.addCheckbox(e,"2D Sheet Color","Switch sheet color white to black",!0,void 0,y.Prefs2D.SWAP_BLACK_AND_WHITE),this.loadingAnimationChkBoxId=this.addCheckbox(e,"Loading Animation","Animate lines during loading",!0,void 0,y.Prefs2D.LOADING_ANIMATION))},T.prototype.createEnvironmentPanel=function(){if(this.is3dMode&&!this.envTabCreated){this.envTabCreated=!0;var e=A.Environment,t=this.tablesContainer.childNodes[3];this.gridTable=t,this.addLabel(e,"Environment"),this.envMapBackgroundChkBoxId=this.addCheckbox(e,"Environment Image Visible","Shows lighting environment as background",!0,void 0,y.Prefs3D.ENV_MAP_BACKGROUND);var n=t.tBodies[0].insertRow(-1).insertCell(0),i=this.getDocument();this.caption=i.createElement("div"),this.caption.setAttribute("data-i18n","Environments and Lighting Selection"),this.caption.textContent=s.Z.t("Environments and Lighting Selection"),this.caption.classList.add("settings-row-title"),n.appendChild(this.caption),n.colSpan="3",this.envSelect=this.addGrid(t,a.LightPresets,this.updateEnvironmentSelection.bind(this),w.Prefs3D.LIGHT_PRESET),this.updateEnvironmentSelection(),this.envSelect.classList.add("with-environment")}},T.prototype.createVersionLabel=function(e){var t=this;if(e){var n=this.getDocument();this.versionDiv=n.createElement("div"),this.versionDiv.textContent=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:LMV_VIEWER_VERSION;"@"===e.charAt(0)&&(e="0.0.0");return"v"+e}(this.options.version),this.versionDiv.className="docking-panel-version-label",this.addEventListener(this.versionDiv,"click",(function(e){e.shiftKey&&navigator.clipboard.writeText(t.versionDiv.textContent)})),e.appendChild(this.versionDiv)}},T.prototype.createRestoreDefaultSettingsButton=function(){var e=this,t=this.getDocument();this.restoreDiv=t.createElement("div"),this.restoreDiv.classList.add("docking-panel-container-solid-color-b"),this.restoreDiv.classList.add("restore-defaults-container"),this.restoreButton=t.createElement("div"),this.restoreButton.className="docking-panel-tertiary-button",this.restoreButton.setAttribute("data-i18n","Restore all default settings"),this.restoreButton.textContent=s.Z.t("Restore all default settings"),this.restoreDiv.appendChild(this.restoreButton),this.addEventListener(this.restoreDiv,"touchstart",l.touchStartToClick),this.addEventListener(this.restoreDiv,"click",(function(){var t,n;null===(t=(n=e.options).onRestoreDefaults)||void 0===t||t.call(n),w.analytics.track("viewer.settings.default")}),!1),this.scrollContainer.appendChild(this.restoreDiv)},T.prototype.selectTab=function(e){i.SettingsPanel.prototype.selectTab.call(this,e),this.sizeToContent()},T.prototype.sizeToContent=function(){i.SettingsPanel.prototype.sizeToContent.call(this,this.options.container)},T.prototype.onViewerResize=function(e,t,n,i,r,o){this.sizeToContent()},T.prototype.syncUI=function(){var e=this.preferences;this.setControlValue(this.antialiasingChkBoxId,e.get("antialiasing")),this.setControlValue(this.ambientshadowsChkBoxId,e.get("ambientShadows")),this.setControlValue(this.groundShadowChkBoxId,e.get("groundShadow")),this.setControlValue(this.groundReflectionChkBoxId,e.get("groundReflection")),this.setControlValue(this.envMapBackgroundChkBoxId,e.get("envMapBackground")),this.setControlValue(this.progressiveRenderChkBoxId,e.get("progressiveRendering")),this.setControlValue(this.swapBlackAndWhiteChkBoxId,e.get("swapBlackAndWhite")),this.setControlValue(this.loadingAnimationChkBoxId,e.get("loadingAnimation")),this.setControlValue(this.ghosthiddenChkBoxId,e.get("ghosting")),this.setControlValue(this.displayLinesId,e.get("lineRendering")),this.setControlValue(this.displayPointsId,e.get("pointRendering")),this.setControlValue(this.displayEdgesId,e.get("edgeRendering")),this.setControlValue(this.displaySectionHatchesId,e.get("displaySectionHatches")),this.setControlValue(this.scrollSpeed,e.get("zoomScrollSpeed")),this.setControlValue(this.dragSpeed,e.get("zoomDragSpeed")),this.updateEnvironmentSelection()},T.prototype.setControlValue=function(e,t){var n=this.getControl(e);n&&n.setValue(t)}},15024:(e,t,n)=>{"use strict";n.r(t),n.d(t,{BrowserDelegate:()=>l,Browser:()=>c});var i=n(38202),r=n(79659),o=n(98926),a=(0,n(84998).getGlobal)(),s=a.document;function l(){}function c(e,t,n){this.myDelegate=e,this.mySelectedIds=[];var i="browserview";this.myRootContainerId=n+"-"+i,this.idToElement={},this.myRootContainer=s.createElement("div"),this.myRootContainer.id=this.myRootContainerId,this.myRootContainer.classList.add(i),s.getElementById(n).appendChild(this.myRootContainer),this.createElements(t,this.myRootContainer)}l.prototype.constructor=l,l.prototype.getNodeId=function(e){throw"getId is not implemented."},l.prototype.getNodeLabel=function(e){return e.name},l.prototype.getNodeClass=function(e){return""},l.prototype.hasThumbnail=function(e){return!1},l.prototype.getThumbnailOptions=function(e){return null},l.prototype.getThumbnail=function(e){return null},l.prototype.onNodeClick=function(e,t,n){},l.prototype.onNodeHover=function(e,t,n){},l.prototype.selectItem=function(e){},l.prototype.deselectItem=function(e){},l.prototype.hasContent=function(e){return!1},l.prototype.addContent=function(e,t){},c.prototype.constructor=c,c.prototype.show=function(e){e?(this.myRootContainer.classList.remove("browserHidden"),this.myRootContainer.classList.add("browserVisible"),this.myRootContainer.style.display="block"):(this.myRootContainer.classList.remove("browserVisible"),this.myRootContainer.classList.add("browserHidden"),this.myRootContainer.style.display="none")},c.prototype.getRootContainer=function(){return this.myRootContainer},c.prototype.delegate=function(){return this.myDelegate},c.prototype.addToSelection=function(e){var t=this;function n(e){return-1==t.mySelectedIds.indexOf(e)&&(t.mySelectedIds.push(e),!0)}for(var i=0,r=e.length;i<r;++i){var o=e[i];if(n(o)){var a=t.idToElement[o];void 0===a?t.myDelegate.selectItem(o):a.classList.add("selected")}}},c.prototype.removeFromSelection=function(e){var t=this;function n(e){var n=t.mySelectedIds.indexOf(e);return-1!=n&&(t.mySelectedIds.splice(n,1),!0)}for(var i=e.length-1;i>=0;--i){var r=e[i];if(n(r)){var o=this.idToElement[r];void 0===o?t.myDelegate.deselectItem(r):o.classList.remove("selected")}}},c.prototype.setSelection=function(e){return this.removeFromSelection(this.mySelectedIds),this.addToSelection(e),this.mySelectedIds},c.prototype.clearSelection=function(){this.removeFromSelection(this.mySelectedIds)},c.prototype.createElements=function(e,t){if(e)for(var n=0;n<e.length;n++){var i=e[n];this.createElement(i,t)}},c.prototype.createElement=function(e,t){var n=this,l=n.myDelegate.getNodeId(e),c=s.createElement("item");t.appendChild(c),this.idToElement[l]=c,c.onmouseover=function(){n.myDelegate.onNodeHover(n,e)},c.onclick=function(t){n.myRootContainer.querySelector(".flipped").removeClass("flipped"),n.myDelegate.onNodeClick(n,e,t)};var u=s.createElement("div");u.classList.add("card"),c.appendChild(u);var h=s.createElement("div");h.classList.add("browserElement"),u.appendChild(h);var d=n.myDelegate.getNodeLabel(e),p=s.createElement("label");p.innerHTML=d,h.appendChild(p),p.onclick=function(t){n.myDelegate.onNodeClick(n,e,t)};var f=n.myDelegate.getThumbnail(e);if(f){var m=s.createElement("img");m.classList.add("thumb");var g=n.myDelegate.getThumbnailOptions(e);i.Document.requestThumbnailWithSecurity(g,(function(e,t){e?o.logger.error("Failed to load thumbnail: "+f,(0,r.errorCodeString)(r.ErrorCodes.NETWORK_FAILURE)):(m.src=a.URL.createObjectURL(t),m.onload=function(){a.URL.revokeObjectURL(m.src)})})),h.appendChild(m),m.onclick=function(t){n.myDelegate.onNodeClick(n,e,t)}}n.myDelegate.hasContent(e)&&n.myDelegate.addContent(e,u),c.classList.add(n.myDelegate.getNodeClass(e))}},42106:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Button:()=>s});var i,r,o=n(37522),a=n(84998);function s(e,t){o.Control.call(this,e,t);var n=this;this._state=s.State.INACTIVE;var i=this.getDocument();this.icon=i.createElement("div"),this.icon.classList.add("adsk-button-icon"),this.container.appendChild(this.icon),this.container.addEventListener("click",(function(e){n.getState()!==s.State.DISABLED&&(n.dispatchEvent(s.Event.CLICK),n.onClick&&n.onClick(e)),e.stopPropagation()})),(0,a.isTouchDevice)()?this.container.addEventListener("touchstart",a.touchStartToClick):(this.container.addEventListener("mouseover",(function(e){n.onMouseOver(e)})),this.container.addEventListener("mouseout",(function(e){n.onMouseOut(e)}))),this.addClass("adsk-button"),this.addClass(s.StateToClassMap[this._state])}s.Event={VISIBILITY_CHANGED:o.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:o.Control.Event.COLLAPSED_CHANGED,STATE_CHANGED:"Button.StateChanged",CLICK:"click"},s.State={ACTIVE:0,INACTIVE:1,DISABLED:2},s.StateToClassMap=(i=s.State,(r={})[i.ACTIVE]="active",r[i.INACTIVE]="inactive",r[i.DISABLED]="disabled",r),s.prototype=Object.create(o.Control.prototype),s.prototype.constructor=s,s.prototype.setState=function(e){if(e===this._state)return!1;this.removeClass(s.StateToClassMap[this._state]),this.addClass(s.StateToClassMap[e]),this._state=e;var t={type:s.Event.STATE_CHANGED,state:e};return this.dispatchEvent(t),!0},s.prototype.setIcon=function(e){this.iconClass&&this.icon.classList.remove(this.iconClass),this.iconClass=e,this.icon.classList.add(e)},s.prototype.getState=function(){return this._state},s.prototype.onClick=function(e){},s.prototype.onMouseOver=function(e){},s.prototype.onMouseOut=function(e){}},35010:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ComboButton:()=>a});var i=n(42106),r=n(51676),o=n(17167);function a(e,t){i.Button.call(this,e,t),this.arrowButton=new i.Button(e+"arrow"),this.arrowButton.addClass("adsk-button-arrow"),this.arrowButton.removeClass("adsk-button"),this.subMenu=new r.RadioButtonGroup(e+"SubMenu"),this.subMenu.addClass("toolbar-vertical-group"),this.subMenu.setVisible(!1),this.container.insertBefore(this.subMenu.container,this.container.firstChild),this.container.insertBefore(this.arrowButton.container,this.container.firstChild);var n=this;this.arrowButton.onClick=function(){n.subMenu.setVisible(!n.subMenu.isVisible())},this.toggleFlyoutVisible=function(){n.subMenu.setVisible(!n.subMenu.isVisible())},this.onClick=function(){n.subMenu.setVisible(!n.subMenu.isVisible())},this.subMenuActiveButtonChangedHandler=function(e){e.isActiveButton?(n.setIcon(e.target.getActiveButton().iconClass),n.setToolTip(e.target.getActiveButton().getToolTip()),n.setState(i.Button.State.ACTIVE),n.onClick=e.button.onClick):n.setState(i.Button.State.INACTIVE)},this.subMenu.addEventListener(r.RadioButtonGroup.Event.ACTIVE_BUTTON_CHANGED,this.subMenuActiveButtonChangedHandler);var a=(0,o.stringToDOM)('<div class="clickoff" style="position:fixed; top:0; left:0; width:100vw; height:100vh;"></div>');this.subMenu.container.insertBefore(a,this.subMenu.container.firstChild),a.addEventListener("click",(function(e){n.subMenu.setVisible(!1),e.stopPropagation()}))}a.prototype=Object.create(i.Button.prototype),a.prototype.constructor=a,a.prototype.addControl=function(e){this.subMenu.addControl(e),e.addEventListener(i.Button.Event.CLICK,this.toggleFlyoutVisible)},a.prototype.removeControl=function(e){e.removeEventListener(i.Button.Event.CLICK,this.toggleFlyoutVisible)},a.prototype.setState=function(e){if(e===i.Button.State.INACTIVE){var t=this.subMenu.getActiveButton();t&&t.setState(i.Button.State.INACTIVE)}i.Button.prototype.setState.call(this,e)},a.prototype.saveAsDefault=function(){this.defaultState={},this._toolTipElement&&this._toolTipElement.getAttribute("tooltipText")&&(this.defaultState.tooltip=this._toolTipElement.getAttribute("tooltipText")),this.defaultState.icon=this.iconClass,this.defaultState.onClick=this.onClick},a.prototype.restoreDefault=function(){this.defaultState&&(this.defaultState.tooltip&&this.setToolTip(this.defaultState.tooltip),this.defaultState.icon&&this.setIcon(this.defaultState.icon),this.onClick=this.defaultState.onClick,this.setState(i.Button.State.INACTIVE))}},37522:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Control:()=>r});var i=n(62546);function r(e,t){this._id=e,this._isCollapsible=!t||t.collapsible,this._toolTipElement=null,this._listeners={},this.container=this.getDocument().createElement("div"),this.container.id=e,this.addClass("adsk-control")}n(35449).GlobalManagerMixin.call(r.prototype),r.Event={VISIBILITY_CHANGED:"Control.VisibilityChanged",COLLAPSED_CHANGED:"Control.CollapsedChanged"},i.EventDispatcher.prototype.apply(r.prototype),r.prototype.constructor=r,r.prototype.container=null,r.prototype.getId=function(){return this._id},r.prototype.setVisible=function(e){if(!this.container.classList.contains("adsk-hidden")===e)return!1;e?this.container.classList.remove("adsk-hidden"):this.container.classList.add("adsk-hidden");var t={type:r.Event.VISIBILITY_CHANGED,target:this,controlId:this._id,isVisible:e};return this.dispatchEvent(t),!0},r.prototype.isVisible=function(){return!this.container.classList.contains("adsk-hidden")},r.prototype.setToolTip=function(e){return(!this._toolTipElement||this._toolTipElement.getAttribute("tooltipText")!==e)&&(this._toolTipElement||(this._toolTipElement=this.getDocument().createElement("div"),this._toolTipElement.id=this._id+"-tooltip",this._toolTipElement.classList.add("adsk-control-tooltip"),this.container.appendChild(this._toolTipElement)),this._toolTipElement.setAttribute("data-i18n",e),this._toolTipElement.setAttribute("tooltipText",e),this._toolTipElement.textContent=Autodesk.Viewing.i18n.translate(e,{defaultValue:e}),!0)},r.prototype.getToolTip=function(){return this._toolTipElement&&this._toolTipElement.getAttribute("tooltipText")},r.prototype.setCollapsed=function(e){if(!this._isCollapsible||this.isCollapsed()===e)return!1;e?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed");var t={type:r.Event.COLLAPSED_CHANGED,isCollapsed:e};return this.dispatchEvent(t),!0},r.prototype.isCollapsed=function(){return!!this.container.classList.contains("collapsed")},r.prototype.isCollapsible=function(){return this._isCollapsible},r.prototype.addClass=function(e){this.container.classList.add(e)},r.prototype.removeClass=function(e){this.container.classList.remove(e)},r.prototype.getPosition=function(){var e=this.container.getBoundingClientRect();return{top:e.top,left:e.left}},r.prototype.getDimensions=function(){var e=this.container.getBoundingClientRect();return{width:e.width,height:e.height}},r.prototype.setDisplay=function(e){this.container.style.display=e},r.prototype.removeFromParent=function(){return!!this.parent&&this.parent.removeControl(this)}},66704:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ControlGroup:()=>r});var i=n(37522);function r(e,t){i.Control.call(this,e,t);var n=this;this._controls=[],this.addClass("adsk-control-group"),this.handleChildSizeChanged=function(e){var t={type:r.Event.SIZE_CHANGED,childEvent:e};n.dispatchEvent(t)}}r.Event={VISIBILITY_CHANGED:i.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:i.Control.Event.COLLAPSED_CHANGED,SIZE_CHANGED:"ControlGroup.SizeChanged",CONTROL_ADDED:"ControlGroup.ControlAdded",CONTROL_REMOVED:"ControlGroup.ControlRemoved"},r.prototype=Object.create(i.Control.prototype),r.prototype.constructor=r,r.prototype.addControl=function(e,t){e.setGlobalManager(this.globalManager);var n=t&&void 0!==t.index?t.index:this._controls.length;if(null!==this.getControl(e.getId()))return!1;var o={type:r.Event.CONTROL_ADDED,control:e,index:n};return n<this._controls.length?(this.container.insertBefore(e.container,this._controls[n].container),this._controls.splice(n,0,e)):(this.container.appendChild(e.container),this._controls.push(e)),e.addEventListener(i.Control.Event.VISIBILITY_CHANGED,this.handleChildSizeChanged),e.addEventListener(i.Control.Event.COLLAPSED_CHANGED,this.handleChildSizeChanged),e instanceof r&&e.addEventListener(r.Event.SIZE_CHANGED,this.handleChildSizeChanged),e.parent=this,this.dispatchEvent(o),this.dispatchEvent(r.Event.SIZE_CHANGED),!0},r.prototype.indexOf=function(e){for(var t=0;t<this._controls.length;t++){var n=this._controls[t];if(n===e||"string"==typeof e&&e===n.getId())return t}return-1},r.prototype.removeControl=function(e){var t="string"==typeof e?this.getControl(e):e;if(!t)return!1;var n=this._controls.indexOf(t);if(-1===n)return!1;this._controls.splice(n,1),this.container.removeChild(t.container);var o={type:r.Event.CONTROL_REMOVED,control:t,index:n};return t.removeEventListener(i.Control.Event.VISIBILITY_CHANGED,this.handleChildSizeChanged),t.removeEventListener(i.Control.Event.COLLAPSED_CHANGED,this.handleChildSizeChanged),t instanceof r&&t.removeEventListener(r.Event.SIZE_CHANGED,this.handleChildSizeChanged),t.parent=void 0,this.dispatchEvent(o),this.dispatchEvent(r.Event.SIZE_CHANGED),!0},r.prototype.getControl=function(e){for(var t=0;t<this._controls.length;t++)if(e===this._controls[t].getId())return this._controls[t];return null},r.prototype.getControlId=function(e){return e<0||e>=this._controls.length?null:this._controls[e].getId()},r.prototype.getNumberOfControls=function(){return this._controls.length},r.prototype.setCollapsed=function(e){if(!this._isCollapsible)return!1;var t=!1;return this._controls.forEach((function(n){n.isCollapsible()&&n.setCollapsed(e)&&(t=!0)})),t&&(e?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed"),this.dispatchEvent({type:r.Event.COLLAPSED_CHANGED,isCollapsed:e})),t}},55848:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Filterbox:()=>o});var i=n(37522),r=n(71224);function o(e,t){this._id=e,this._listeners={},this._options=t||{},this._filterFunction=this._options.filterFunction||function(){};var n=this.getDocument();this.container=n.createElement("div"),this.container.id=e,this.addClass("adsk-control"),this.addClass("adsk-filterbox"),this.addClass("empty");var i=n.createElement("input");i.classList.add("filter-box"),i.classList.add("docking-panel-delimiter-shadow"),i.type="search",i.placeholder=r.Z.t("Enter filter term"),i.setAttribute("data-i18n","Enter filter term"),i.incremental="incremental",i.autosave=this.container.id+"filter",this.container.appendChild(i),this.filterbox=i;var o=this,a=function(e){0===(e=e.trim()).length?o.container.classList.add("empty"):o.container.classList.remove("empty"),o._filterFunction&&o._filterFunction(e)},s=n.createElement("div");s.className="filter-box-icon",this.container.insertBefore(s,i.nextSibling);var l=n.createElement("div");l.className="filter-box-close",l.addEventListener("click",(function(){o.filterbox.value="",o.addClass("empty")})),this.container.appendChild(l),i.addEventListener("keydown",(function(e){var t=o.getWindow();13===(e=e||t.event).keyCode&&o.filterbox.blur()})),i.addEventListener("input",(function(){a(this.value)})),i.addEventListener("change",(function(){a(this.value)})),i.addEventListener("focus",(function(){s.classList.add("focused")})),i.addEventListener("blur",(function(){s.classList.remove("focused")}))}o.prototype=Object.create(i.Control.prototype),o.prototype.constructor=o},51676:(e,t,n)=>{"use strict";n.r(t),n.d(t,{RadioButtonGroup:()=>a});var i=n(66704),r=n(42106),o=n(37522);function a(e,t){i.ControlGroup.call(this,e,t);var n=this;this._activeButton=null,this._handleButtonStateChange=function(e){var t=r.Button.State;e.state===t.ACTIVE?(n._activeButton=e.target,n.dispatchEvent({type:a.Event.ACTIVE_BUTTON_CHANGED,button:e.target,isActiveButton:!0}),n._controls.forEach((function(n){n!==e.target&&n.getState()!==t.DISABLED&&n.setState(t.INACTIVE)}))):e.target===n._activeButton&&(n._activeButton=null,n.dispatchEvent({type:a.Event.ACTIVE_BUTTON_CHANGED,button:e.target,isActiveButton:!1}))}}a.Event={ACTIVE_BUTTON_CHANGED:"RadioButtonGroup.ActiveButtonChanged",VISIBILITY_CHANGED:o.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:o.Control.Event.COLLAPSED_CHANGED,CONTROL_ADDED:i.ControlGroup.Event.CONTROL_ADDED,CONTROL_REMOVED:i.ControlGroup.Event.CONTROL_REMOVED,SIZE_CHANGED:i.ControlGroup.Event.SIZE_CHANGED},a.prototype=Object.create(i.ControlGroup.prototype),a.prototype.constructor=a,a.prototype.addControl=function(e,t){return e instanceof r.Button&&(!!i.ControlGroup.prototype.addControl.call(this,e,t)&&(e.addEventListener(r.Button.Event.STATE_CHANGED,this._handleButtonStateChange),!0))},a.prototype.removeControl=function(e){var t="string"==typeof e?this.getControl(e):e;return!(null===t||!i.ControlGroup.prototype.removeControl.call(this,t))&&(t.removeEventListener(r.Button.Event.STATE_CHANGED,this._handleButtonStateChange),!0)},a.prototype.getActiveButton=function(){return this._activeButton}},20361:(e,t,n)=>{"use strict";n.d(t,{J:()=>i});var i="search-selected"},68005:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Searchbox:()=>E});var i=n(37522),r=n(20361),o=n(98926),a=n(62546),s=n(74593),l=n(35449),c=50,u=100;function h(e,t,n){var i=n;this.excludeRoot=t,(i instanceof Autodesk.Viewing.GuiViewer3D||i instanceof Autodesk.Viewing.Viewer3D)&&(o.logger.warn("Deprecated use of Viewer as parameter. Provide container instead"),i=n.container),this.results=[],this.resultCount=0,this.selectedIndex=-1;var r=this.getDocument();this.container=r.createElement("div"),this.container.classList.add("docking-panel"),this.container.classList.add("adsk-search-results"),this.container.results=r.createElement("div"),this.container.results.classList.add("docking-panel-scroll"),this.container.results.classList.add("docking-panel-container-solid-color-b"),this.container.results.addEventListener("scroll",p.bind(this)),this.container.appendChild(this.container.results),e.insertBefore(this.container,e.firstChild),this.scrollingContainer=r.createElement("div"),this.scrollingContainer.classList.add("adsk-search-results-scrolling-panel"),this.scrollingContainer.addEventListener("click",d.bind(this)),this.container.results.appendChild(this.scrollingContainer),this.footer=new s.ResizeFooter(this.container,function(){var e=this.container.getBoundingClientRect(),t=i.getBoundingClientRect();t.right<e.right&&(this.container.style.width=t.right-e.left+"px"),t.bottom<e.bottom&&(this.container.style.height=t.bottom-e.top+"px")}.bind(this)),this.footer.setGlobalManager(this.globalManager),this.divNoResults=function(e){var t=e.createElement("div"),n=e.createElement("div"),i=e.createElement("div");t.classList.add("no-results-container"),t.style.display="none";var r="No Results";n.setAttribute("data-i18n",r),n.textContent=Autodesk.Viewing.i18n.translate(r),n.classList.add("no-results-title");var o="Try another term";return i.setAttribute("data-i18n",o),i.textContent=Autodesk.Viewing.i18n.translate(o),i.classList.add("no-results-description"),t.appendChild(n),t.appendChild(i),t.domTitle=n,t.domMessage=i,t}(r),this.scrollingContainer.appendChild(this.divNoResults),this.scrollY=0,this.dirty=!1,this.nextFrameId=0,this.it={init:function(e){return this.isDone=!1,this.results=e,this.indexRs=0,this.indexId=-1,this},done:function(){return this.isDone},next:function(){if(this.isDone)return this;for(this.indexId++;this.results.length!==this.indexRs&&this.indexId===this.results[this.indexRs].ids.length;)this.indexId=0,this.indexRs++;return this.isDone=this.indexRs===this.results.length,this},id:function(){return this.results[this.indexRs].ids[this.indexId]},delegate:function(){return this.results[this.indexRs].delegate}},this.elementsPool=[],this.elementsUsed=0;for(var a=0;a<150;++a)this.elementsPool[a]=v(r);this.setVisible(!1)}function d(e){var t=e.target,n=this._getNodeAndModelIds(t);n&&(this.fireEvent({type:r.J,id:n.nodeId,modelId:n.modelId}),e.preventDefault())}function p(){var e=this.container.results.scrollTop;Math.abs(this.scrollY-e)>=100&&(this.scrollY=e,f(this))}function f(e,t){e.dirty&&!t||(t?m(e):(e.dirty=!0,e.nextFrameId=requestAnimationFrame((function(){m(e)}))))}function m(e){e.dirty=!1,function(e){for(var t=e.elementsUsed,n=e.elementsPool,i=0;i<t;++i){y(n[i])}e.elementsUsed=0}(e),0!==e.resultCount?(e.setDisplayNoResults(!1),function(e){var t=e.container.results,n=0,i=t.clientHeight,r=e.scrollY,o=e.it.init(e.results),a=Math.max(0,e.scrollY-u),s=0|Math.floor(a/c),l=0;n=s*c;for(;s;)s--,l++,o.next();var h=e.elementsPool[e.elementsUsed++];h.style.height=n+"px",e.scrollingContainer.appendChild(h);var d=!0;for(;d;){if(o.next(),o.done()){d=!1;break}if(n>r+i+u){d=!1;break}if(e.elementsUsed===e.elementsPool.length){d=!1;break}var p=o.id(),f=o.delegate(),m=n+c,v=e.elementsPool[e.elementsUsed++];g(p,f,v,e,l===e.selectedIndex),e.scrollingContainer.appendChild(v),n=m,l++}var y=e.resultCount*c;e.scrollingContainer.style.height=y+"px"}(e)):e.setDisplayNoResults(!0)}function g(e,t,n,i,r){n.classList.add("search-result"),r?n.classList.add("selected"):n.classList.remove("selected"),n.setAttribute("lmv-nodeId",e),n.setAttribute("lmv-modelId",t.model.id),n.style.height="50px";var o=t.instanceTree.getNodeName(e),a=i.searchString,s=o.toLowerCase().indexOf(a.toLowerCase()),l=o.substr(0,s),c=o.substr(s,a.length),u=o.substr(s+a.length);n.domPrefix.innerText=l,n.domMatch.innerText=c,n.domSufix.innerText=u;var h=function(e,t,n){var i=[],r=t.getRootId(),o=n.isRootExcluded(),a=t.instanceTree,s=e,l=!1;for(;s&&!l&&(s!==r||(l=!0,!o));){var c=a.getNodeName(s);i.unshift(c),s=a.getNodeParentId(s)}return i}(e,t,i);n.domPath.innerText=h.join(" > ")}function v(e){var t=e.createElement("div"),n=e.createElement("div"),i=e.createElement("span"),r=e.createElement("span"),o=e.createElement("span"),a=e.createElement("span");return n.classList.add("search-result-container"),r.classList.add("search-match"),a.classList.add("search-path"),n.appendChild(i),n.appendChild(r),n.appendChild(o),n.appendChild(a),t.appendChild(n),t.domPrefix=i,t.domMatch=r,t.domSufix=o,t.domPath=a,t.domContainer=n,t}function y(e){e.setAttribute("lmv-nodeId",""),e.setAttribute("lmv-modelId",""),e.domPrefix.innerText="",e.domMatch.innerText="",e.domSufix.innerText="",e.domPath.innerText="",e.style.height="0"}function b(e,t){e.scrollTop+e.clientHeight<(t+1)*c&&(e.scrollTop+=(t+1)*c-(e.scrollTop+e.clientHeight)),e.scrollTop/c>t&&(e.scrollTop=t*c)}h.prototype.constructor=h,a.EventDispatcher.prototype.apply(h.prototype),l.GlobalManagerMixin.call(h.prototype),h.prototype.setPosition=function(e,t){this.container.style.left=e+"px",this.container.style.top=t+"px"},h.prototype.setMinWidth=function(e){this.container.style.width=e+"px"},h.prototype.setMaxWidth=function(e){this.container.style.maxHeight=e+"px"},h.prototype.setVisible=function(e){this.container.style.display=e?"":"none"},h.prototype.setResults=function(e,t){this.searchString=e,this.results=t,this.resultCount=function(e){for(var t=0,n=0;n<e.length;++n){t+=e[n].ids.length}return t}(t),this.selectedIndex=0==this.resultCount?-1:0,this.container.style.height=this.resultCount*c+20+"px",this.container.results.scrollTop=0,this.scrollY=0,0===this.resultCount?this.container.classList.add("no-content"):this.container.classList.remove("no-content"),f(this)},h.prototype.getSelection=function(){var e=this.scrollingContainer.querySelector(".selected");if(!e)return null;var t=this._getNodeAndModelIds(e);return t||null},h.prototype.isRootExcluded=function(){return!(this.results&&this.results.length>1)&&(!(this.modelCount>1)&&this.excludeRoot)},h.prototype.uninitialize=function(){this.setVisible(!1),this.container=null,this.container.parentNode&&this.container.parentNode.removeChild(this.container),cancelAnimationFrame(this.nextFrameId),this.clearListeners()},h.prototype.setDisplayNoResults=function(e){this.divNoResults.style.display=e?"":"none"},h.prototype.selectNext=function(){0!==this.resultCount&&(this.selectedIndex=Math.min(this.resultCount-1,this.selectedIndex+1),b(this.container.results,this.selectedIndex),f(this))},h.prototype.selectPrevious=function(){0!==this.resultCount&&(this.selectedIndex=Math.max(0,this.selectedIndex-1),b(this.container.results,this.selectedIndex),f(this))},h.prototype._getNodeAndModelIds=function(e){for(;!e.hasAttribute("lmv-nodeId");)if(!(e=e.parentNode)||e===this.scrollingContainer)return;return{nodeId:parseInt(e.getAttribute("lmv-nodeId")),modelId:parseInt(e.getAttribute("lmv-modelId"))}};var _=n(71224),x=n(23279);function E(e,t,n){this._id=e,this._listeners={},this._options=n||{},this._searchFunction=this._options.searchFunction||function(){};var i=this.getDocument();this.container=i.createElement("div"),this.container.id=e,this.addClass("adsk-control"),this.addClass("adsk-searchbox"),this.addClass("empty");var a=i.createElement("input");a.classList.add("search-box"),a.classList.add("docking-panel-delimiter-shadow"),a.type="search",a.results=[],a.placeholder=_.Z.t("Search"),a.setAttribute("data-i18n","Search"),a.incremental="incremental",a.autosave=this.container.id+"search_autosave",this.container.insertBefore(a,this.scrollContainer),this.searchbox=a;var s=function(){d.searchbox.value="",d.addClass("empty")},l=function(){d.searchbox.classList.remove("searching"),d.searchResults.setVisible(!1)},c=i.createElement("div");c.className="search-box-icon",this.container.insertBefore(c,a.nextSibling);var u=i.createElement("div");u.className="search-box-close",u.addEventListener("click",(function(){s(),l()})),this.container.appendChild(u),this.searchResults=new h(this.container,n.excludeRoot,t),this.searchResults.addEventListener(r.J,(function(e){s(),l(),d.fireEvent(e)}));var d=this,p=!0;a.addEventListener("keydown",(function(e){var t=d.getWindow();if(38===(e=e||t.event).keyCode&&(d.searchResults.selectPrevious(),e.preventDefault()),40===e.keyCode&&(d.searchResults.selectNext(),e.preventDefault()),13===e.keyCode){var n=d.searchResults.getSelection();if(!n)return!1;s(),l(),d.fireEvent({type:E.Events.ON_SEARCH_SELECTED,id:n.nodeId,modelId:n.modelId}),e.preventDefault()}}));var f=x((function(){if(0===a.value.length)return d.container.classList.add("empty"),void l();d.container.classList.remove("empty"),a.value.length<3||function(){var e=a.value.trim();if(0!==e.length){p&&(o.logger.track({category:"search_node",name:"model_browser_tool"}),p=!1),a.classList.add("searching");var t=d._searchFunction(e);d.searchResults.setResults(e,t),d.searchResults.setVisible(!0)}else l()}()}),800);a.addEventListener("input",(function(){f()})),a.addEventListener("change",(function(e){var t=d.getDocument();e.target===t.activeElement&&f()})),a.addEventListener("focus",(function(){c.classList.add("focused")})),a.addEventListener("blur",(function(){c.classList.remove("focused")}))}E.prototype=Object.create(i.Control.prototype),E.prototype.constructor=E,E.Events={ON_SEARCH_SELECTED:r.J}},29271:(e,t,n)=>{"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}n.r(t),n.d(t,{SplitViewLayout:()=>P});var a={down:{pointer:"pointerdown",mouse:"mousedown",touch:"touchstart"},up:{pointer:"pointerup",mouse:"mouseup",touch:"touchend"},move:{pointer:"pointermove",mouse:"mousemove",touch:"touchmove"}};function s(e){if(Autodesk.Viewing.isIE11)return[a[e].pointer];var t=[];return Autodesk.Viewing.isMobileDevice()||t.push(a[e].mouse),Autodesk.Viewing.isTouchDevice()&&t.push(a[e].touch),t}function l(e,t,n){var i,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=(o?"remove":"add")+"EventListener",l=s(t),c=r(l);try{for(c.s();!(i=c.n()).done;){var u=i.value;e[a](u,n)}}catch(e){c.e(e)}finally{c.f()}}var c=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=t,this.isDragging=!1,this.resizeHandlerElement=null,this.onMoveCB=n,this.panelSizeThreshold=20,this.margin=16,this.initResizeHandlerElement()}var t,n,r;return t=e,(n=[{key:"onDown",value:function(e){this.isDragging=!0,e.preventDefault()}},{key:"onUp",value:function(e){this.isDragging=!1}},{key:"onMove",value:function(e){if(this.isDragging){"touchmove"===e.type&&(e.pageX=e.touches[0].pageX,e.pageY=e.touches[0].pageY);var t=this.container.getBoundingClientRect(),n=this.getTargetWidthPercentage(e,t);this.panelSizeThreshold<n&&n<100-this.panelSizeThreshold&&this.onMoveCB(n)}}},{key:"getTargetWidthPercentage",value:function(e,t){}},{key:"initResizeHandlerElement",value:function(){this.resizeHandlerElement=document.createElement("div"),this.handlerSplitLine=document.createElement("div"),this.resizeHandlerElement.appendChild(this.handlerSplitLine),l(this.resizeHandlerElement,"down",this.onDown.bind(this)),this.onUpBinded=this.onUp.bind(this),this.onMoveBinded=this.onMove.bind(this),l(document,"move",this.onMoveBinded),l(document,"up",this.onUpBinded),this.resizeHandlerElement.className="resize-handler",this.handlerSplitLine.className="resize-handler-center-mark"}},{key:"setPosition",value:function(e){}},{key:"terminate",value:function(){this.resizeHandlerElement.parentNode.removeChild(this.resizeHandlerElement),this.resizeHandlerElement=null,l(document,"up",this.onUpBinded,!0),l(document,"move",this.onMoveBinded,!0)}}])&&i(t.prototype,n),r&&i(t,r),e}();function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function p(e,t,n){return p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}},p(e,t,n||e)}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=v(e);if(t){var r=v(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return g(this,n)}}function g(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(o,e);var t,n,i,r=m(o);function o(){return h(this,o),r.apply(this,arguments)}return t=o,(n=[{key:"initResizeHandlerElement",value:function(){p(v(o.prototype),"initResizeHandlerElement",this).call(this),this.resizeHandlerElement.classList.add("vertical"),this.handlerSplitLine.classList.add("vertical"),this.resizeHandlerElement.style.width="".concat(this.margin,"px")}},{key:"getTargetWidthPercentage",value:function(e,t){return(e.pageX-t.left)/t.width*100}},{key:"setPosition",value:function(e){this.resizeHandlerElement.style.left="calc(".concat(e,"% - ").concat(this.margin/2,"px)")}}])&&d(t.prototype,n),i&&d(t,i),o}(c);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function E(e,t,n){return E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=M(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}},E(e,t,n||e)}function w(e,t){return w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},w(e,t)}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=M(e);if(t){var r=M(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return A(this,n)}}function A(e,t){return!t||"object"!==b(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function M(e){return M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},M(e)}var T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(o,e);var t,n,i,r=S(o);function o(){return _(this,o),r.apply(this,arguments)}return t=o,(n=[{key:"initResizeHandlerElement",value:function(){E(M(o.prototype),"initResizeHandlerElement",this).call(this),this.resizeHandlerElement.classList.add("horizontal"),this.handlerSplitLine.classList.add("horizontal"),this.resizeHandlerElement.style.height="".concat(this.margin,"px")}},{key:"getTargetWidthPercentage",value:function(e,t){return(e.pageY-t.top)/t.height*100}},{key:"setPosition",value:function(e){this.resizeHandlerElement.style.top="calc(".concat(e,"% - ").concat(this.margin/2,"px)")}}])&&x(t.prototype,n),i&&x(t,i),o}(c);function C(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var P=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._splitType=t||e.SplitType.Vertical,this.onResizeHandlerMove=this.onResizeHandlerMove.bind(this)}var t,n,i;return t=e,(n=[{key:"createSplitViewLayout",value:function(t,n,i){if(this.targetContainer=t,this.splitViewContainer=document.createElement("div"),this.splitViewContainer.classList.add("split-view-container"),this.targetContainer.parentNode.replaceChild(this.splitViewContainer,this.targetContainer),this.firstViewerContainer=this.wrapViewerContainer(n),this._splitType===e.SplitType.Vertical)this._resizeHandler=new y(this.splitViewContainer,this.onResizeHandlerMove);else{if(this._splitType!==e.SplitType.Horizontal)return void console.error("unknown splitType");this._resizeHandler=new T(this.splitViewContainer,this.onResizeHandlerMove)}this._resizeHandler&&this.splitViewContainer.appendChild(this._resizeHandler.resizeHandlerElement),this.secondViewerContainer=this.wrapViewerContainer(i),this.onResizeHandlerMove(50)}},{key:"wrapViewerContainer",value:function(e){var t=document.createElement("div");return t.className="split-view-viewer-container",e&&t.appendChild(e),this.splitViewContainer.appendChild(t),t}},{key:"restoreMainViewer",value:function(){this._resizeHandler&&(this._resizeHandler.terminate(),this._resizeHandler=null),this.splitViewContainer&&(this.splitViewContainer.parentNode.replaceChild(this.targetContainer,this.splitViewContainer),this.splitViewContainer=null,this.targetContainer=null,this.firstViewerContainer=null,this.secondViewerContainer=null)}},{key:"onResizeHandlerMove",value:function(t){this._resizeHandler&&this._resizeHandler.setPosition(t),this._splitType===e.SplitType.Vertical?(this.firstViewerContainer.style.width="".concat(t,"%"),this.secondViewerContainer.style.width="".concat(100-t,"%"),this.secondViewerContainer.style.left="".concat(t,"%")):this._splitType===e.SplitType.Horizontal&&(this.firstViewerContainer.style.height="".concat(t,"%"),this.secondViewerContainer.style.height="".concat(100-t,"%"),this.secondViewerContainer.style.top="".concat(t,"%"))}}])&&C(t.prototype,n),i&&C(t,i),e}();P.SplitType={Vertical:"vertical",Horizontal:"horizontal"}},73306:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ToolBar:()=>o});var i=n(66704),r=n(37522);function o(e,t){i.ControlGroup.call(this,e,t),this.removeClass("adsk-control-group"),this.addClass("adsk-toolbar"),t&&t.alignVertically&&this.addClass("adsk-toolbar-vertical")}o.Event={VISIBILITY_CHANGED:r.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:r.Control.Event.COLLAPSED_CHANGED,CONTROL_ADDED:i.ControlGroup.Event.CONTROL_ADDED,CONTROL_REMOVED:i.ControlGroup.Event.CONTROL_REMOVED,SIZE_CHANGED:i.ControlGroup.Event.SIZE_CHANGED},o.prototype=Object.create(i.ControlGroup.prototype),o.prototype.constructor=o},87571:(e,t,n)=>{"use strict";n.r(t)},78808:(e,t,n)=>{function i(t,n){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e.exports[i]=t[i],n&&(e.exports[n][i]=t[i]))}n(82526),n(41817),n(72443),n(92401),n(8722),n(32165),n(69007),n(83510),n(41840),n(6982),n(32159),n(96649),n(39341),n(60543),n(92222),n(50545),n(26541),n(43290),n(57327),n(69826),n(34553),n(84944),n(86535),n(89554),n(91038),n(26699),n(82772),n(66992),n(69600),n(94986),n(21249),n(26572),n(85827),n(96644),n(47042),n(5212),n(2707),n(38706),n(40561),n(33792),n(99244),n(18264),n(96078),n(4855),n(68309),n(73706),n(51532),n(99752),n(82376),n(73181),n(23484),n(2388),n(88621),n(60403),n(84755),n(25438),n(90332),n(40658),n(40197),n(44914),n(52420),n(60160),n(60970),n(10408),n(73689),n(9653),n(93299),n(35192),n(33161),n(44048),n(78285),n(44363),n(55994),n(61874),n(9494),n(56977),n(19601),n(59595),n(35500),n(69720),n(43371),n(38559),n(38880),n(49337),n(36210),n(30489),n(43304),n(41825),n(98410),n(72200),n(47941),n(94869),n(33952),n(57227),n(60514),n(68304),n(41539),n(26833),n(54678),n(91058),n(88674),n(17727),n(36535),n(12419),n(69596),n(52586),n(74819),n(95683),n(39361),n(51037),n(5898),n(67556),n(14361),n(83593),n(39532),n(24603),n(74916),n(92087),n(39714),n(70189),n(79841),n(27852),n(94953),n(32023),n(78783),n(4723),n(66528),n(83112),n(38992),n(82481),n(15306),n(64765),n(23123),n(23157),n(73210),n(48702),n(55674),n(15218),n(74475),n(57929),n(50915),n(29253),n(42125),n(78830),n(58734),n(29254),n(37268),n(7397),n(60086),n(80623),n(44197),n(76495),n(87145),n(35109),n(65125),n(82472),n(49743),n(8255),n(29135),n(92990),n(18927),n(33105),n(35035),n(74345),n(7174),n(32846),n(98145),n(44731),n(77209),n(96319),n(58867),n(37789),n(33739),n(95206),n(29368),n(14483),n(12056),n(3462),n(30678),n(27462),n(33824),n(55021),n(12974),n(15016),n(4129),n(38478),n(8628),n(83475),n(46273),n(51568),n(26349),n(65743),n(10072),n(99137),n(71957),n(96306),n(103),n(8582),n(90618),n(74592),n(88440),n(58276),n(35082),n(12813),n(18222),n(24838),n(38563),n(50336),n(7512),n(46603),n(70100),n(10490),n(13187),n(60092),n(19041),n(30666),n(51638),n(62975),n(15728),n(46056),n(44299),n(5162),n(50292),n(1025),n(97314),n(96290),n(77479),n(34582),n(47896),n(12647),n(98558),n(84018),n(97507),n(61605),n(49076),n(34999),n(88921),n(96248),n(13599),n(11477),n(64362),n(15389),n(46006),n(90401),n(45164),n(91238),n(54837),n(87485),n(56767),n(69916),n(76651),n(61437),n(35285),n(39865),n(86035),n(67501),n(13728),n(27207),n(21568),n(48824),n(44130),n(78206),n(76478),n(79715),n(43561),n(32049),n(86020),n(56585),n(54747),n(33948),n(84633),n(85844),n(60285),n(83753),n(41637),n(35666),e.exports.Autodesk=n(45375).Autodesk;var r=Object.assign||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])};e.exports.THREE=n(16453),e.exports.av={},e.exports.avp={},e.exports.avu={},e.exports.ave={},i({Hammer:n(41145)},"av"),i(n(84998),"av"),i(n(84998),"avp"),i(n(17167),"avp"),i(n(17167),"av"),i(n(76967),"avp"),i(n(21319),"avp"),i(n(26261),"avp"),i(n(26261),"av"),i(n(34500),"avp"),i(n(41471),"avp");var o=n(71224).Z;o.translate=o.t.bind(o),o.localize=function(){},i({i18n:o},"av"),i(n(58660),"avp"),i(n(98926),"avp"),i(n(92445),"avp"),i(n(77416),"avp"),i(n(83359),"avp"),i(n(74007),"avp"),i(n(93180),"avp"),i(n(68538),"avp"),i(n(4388),"avp"),i(n(12990),"avp"),i(n(97339),"avp"),i(n(85994),"avp"),i(n(21995),"avp"),i(n(61768),"avp"),i(n(66199),"avp"),i(n(49321),"avp"),i(n(96890),"avp"),i(n(14705),"avp"),i(n(68693),"avp"),i(n(90564),"avp"),i(n(57658),"avp"),i(n(97122),"avp"),i(n(88715),"avp"),i(n(9140),"avp"),i(n(29003),"avp"),i(n(88771),"avp"),i(n(5106),"avp"),i(n(46759),"avp"),i(n(2727),"avp"),i(n(25119),"avp"),i(n(73075),"avp"),i(n(43586),"avp"),i(n(22585),"avp"),i(n(36757),"avp"),i(n(89812),"avp"),i(n(76543),"avp"),i(n(48862),"avp"),i(n(25920),"avp"),i(n(44971),"avp"),i(n(73080),"avp"),i(n(18187),"avp"),i(n(25131),"avp"),i(n(23305),"avp"),i(n(79175),"avp"),i(n(30190),"avp"),i(n(29747),"avp"),i(n(282),"avp"),i(n(82197),"av"),i(n(1840),"avp"),i(n(6420),"avp"),i(n(26245),"avp"),i(n(27820),"avp"),i(n(67317),"avp"),i(n(35313),"avp"),i(n(95920),"avp"),i(n(45451),"avp"),i(n(23406),"avp"),i(n(87289),"avp"),i(n(96610),"avp"),i(n(42517),"avp"),i(n(86620),"avp"),i(n(89371),"avp"),i(n(79659),"av"),i(n(58964),"av"),i(n(57601),"avp"),i(n(90050),"avp"),i(n(85212),"avp"),i(n(50411),"av"),i(n(77368),"av"),i(n(62546),"av"),i(n(25282),"av"),i(n(61445),"av"),i(n(25637),"av"),i(n(37169),"av"),i(n(11294),"av"),i(n(65663),"av"),i(n(95018),"avp"),i(n(24032),"avp"),i(n(19255),"avp"),i(n(83161),"av"),i(n(38202),"av"),i(n(91217),"avp"),i(n(55412),"avp"),i(n(41772),"av"),i(n(50041),"av"),i(n(24327),"av"),i(n(20313),"avp"),i(n(59823),"avp"),i(n(99248),"av"),i(n(66904),"av"),i(n(76079),"av"),i(n(70520),"av"),i(n(12032),"av"),i(n(20974),"av"),i(n(9322),"av"),i(n(7724),"av"),i(n(65522),"av"),i(n(50638),"avp"),e.exports.av.ModelUnits=n(50638).ModelUnits,i(n(7963),"avp"),i(n(51902),"av"),i(n(5130),"avp");var a=e.exports.av.MeasureCommon={};r(a,n(85553)),a.MeasurementTypes=n(37495).o,a.MeasurementTypesToAnalytics=n(37495).D,a.SnapType=n(5646).t,a.Events=n(80890).n,a.Measurement=n(70757).g,a.SnapResult=n(9331).N,i(n(27800),"av"),i(n(35449),"av"),i(n(80382),"avp"),i(n(21550),"avp"),i(n(94981),"avp"),i(n(10831),"av"),i(n(93382),"av"),i(n(2799),"avp"),i(n(26074),"av"),i(n(30093),"avp"),i(n(9487),"av"),i(n(49083),"av"),i(n(3260),"av"),i(n(26099),"av"),i(n(25406),"av"),i(n(33317),"av"),i(n(77702),"av"),i(n(80401),"av"),i(n(42024),"av"),i(n(49991),"av"),i(n(82803),"av"),i(n(79757),"av"),i(n(98265),"avp"),i(n(33450),"avp"),i(n(7440),"avp"),i(n(36257),"avp"),i(n(8283),"avp"),i(n(50005),"avp"),i(n(16727),"avp"),i(n(19115),"avp"),i(n(439),"avp"),i(n(58092),"avp"),i(n(18588),"av"),i(n(80723),"av"),i(n(62066),"avp"),i(n(96651),"avp"),n(87571),i(n(59005),"avu"),i(n(33218),"avu"),i(n(30814),"avu"),i(n(79893),"avu"),i(n(74593),"avp"),i(n(12074),"avu"),i(n(76723),"avu"),i(n(89576),"avp"),i(n(15024),"avp"),i(n(36311),"avp"),i(n(96250),"avp"),i(n(1204),"avu"),i(n(53974),"avu"),i(n(30587),"avu"),i(n(76095),"avp"),i(n(83802),"ave"),i(n(37522),"avu"),i(n(66704),"avu"),i(n(42106),"avu"),i(n(51676),"avu"),i(n(35010),"avu"),i(n(73306),"avu"),i(n(56441),"avp"),i(n(89853),"avu"),i(n(55848),"avu"),i(n(68005),"avu"),i(n(42430),"avp"),i(n(75977),"ave"),i(n(32757),"ave"),i(n(49710),"ave"),i(n(66190),"ave"),i(n(6355),"av"),i(n(66803),"av"),i(n(29271),"avu"),i(n(83522),"av"),i(n(25090),"av"),i(n(17452),"av"),i(n(43155),"av"),i(n(85101),"avp"),i(n(96546),"av"),n(92148).i(e.exports)},43155:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CrossViewerInteractionCommon:()=>r});var i=n(37169),r={onSelectionChanged:{eventName:i.AGGREGATE_SELECTION_CHANGED_EVENT,cb:function(e,t,n){var i=e.getAggregateSelection();if(t.impl.model)if(i.length>0)for(var r=0;r<i.length;r++)for(var o=i[r],a=o.model,s=o.selection,l=0;l<t.impl.modelQueue().getModels().length;l++){var c=t.impl.modelQueue().getModels()[l];c&&c.getDocumentNode()&&a.getDocumentNode()&&c.getDocumentNode().originModel===a.getDocumentNode().originModel?(t.impl.is2d?t.select(s,c):(t.showAll(),t.select(s,c),t.isolate(s,c)),t.fitToView(s)):!t.impl.is2d&&c.visibilityManager&&c.visibilityManager.setAllVisibility(!1)}else t.clearSelection(),t.impl.is2d||t.showAll()}}}},17452:(e,t,n)=>{"use strict";n.r(t),n.d(t,{createLeechViewer:()=>R});var i=n(29003);function r(e){Autodesk.Viewing.Private.RenderContext.call(this),this.originalInit=this.init.bind(this),this.init=function(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.canvas=e,this.ctx2D=this.canvas.getContext("2d");var o=Object.assign({},r,{offscreen:!0});this.originalInit(t,n,i,o),this.glrenderer=t;var a=this.glrenderer.getPixelRatio();this.setSize(n/a,i/a)},this.renderToCanvas=function(){this.ctx2D&&(this.getOffscreenTarget()||0!=this.widthWithPixelRatio&&0!=this.heightWithPixelRatio&&(this.ctx2D.clearRect(0,0,this.widthWithPixelRatio,this.heightWithPixelRatio),this.ctx2D.drawImage(this.glrenderer.domElement,0,this.glrenderer.domElement.height-this.heightWithPixelRatio,this.widthWithPixelRatio,this.heightWithPixelRatio,0,0,this.widthWithPixelRatio,this.heightWithPixelRatio)))},this.originalSetSize=this.setSize.bind(this),this.setSize=function(e,t,n,i){if(!i){var r=this.glrenderer.getPixelRatio();this.width=e,this.height=t,this.widthWithPixelRatio=e*r,this.heightWithPixelRatio=t*r,this.canvas.width=this.widthWithPixelRatio,this.canvas.height=this.heightWithPixelRatio,this.canvas.style.width="".concat(this.width,"px"),this.canvas.style.height="".concat(this.height,"px")}this.prepareViewport(n,i),this.restoreViewport()},this.prepareViewport=function(e,t){this.glrenderer.pushViewport();var n=this.glrenderer.getPixelRatio(),i=this.glrenderer.domElement.width/n,r=this.glrenderer.domElement.height/n;(i<this.width||r<this.height)&&this.glrenderer.setSize(Math.max(this.width,i),Math.max(this.height,r)),this.originalSetSize(this.width,this.height,e,t)},this.restoreViewport=function(){this.glrenderer.popViewport()}}r.prototype=Object.create(i.RenderContext.prototype),r.prototype.constructor=r;var o=n(95018),a=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var n=-1;return e.some((function(e,i){return e[0]===t&&(n=i,!0)})),n}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var n=e(this.__entries__,t),i=this.__entries__[n];return i&&i[1]},t.prototype.set=function(t,n){var i=e(this.__entries__,t);~i?this.__entries__[i][1]=n:this.__entries__.push([t,n])},t.prototype.delete=function(t){var n=this.__entries__,i=e(n,t);~i&&n.splice(i,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var n=0,i=this.__entries__;n<i.length;n++){var r=i[n];e.call(t,r[1],r[0])}},t}()}(),s="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,l=void 0!==n.g&&n.g.Math===Math?n.g:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),c="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(l):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)};var u=["top","right","bottom","left","width","height","size","weight"],h="undefined"!=typeof MutationObserver,d=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var n=!1,i=!1,r=0;function o(){n&&(n=!1,e()),i&&s()}function a(){c(o)}function s(){var e=Date.now();if(n){if(e-r<2)return;i=!0}else n=!0,i=!1,setTimeout(a,t);r=e}return s}(this.refresh.bind(this),20)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){s&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),h?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){s&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,n=void 0===t?"":t;u.some((function(e){return!!~n.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),p=function(e,t){for(var n=0,i=Object.keys(t);n<i.length;n++){var r=i[n];Object.defineProperty(e,r,{value:t[r],enumerable:!1,writable:!1,configurable:!0})}return e},f=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||l},m=x(0,0,0,0);function g(e){return parseFloat(e)||0}function v(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce((function(t,n){return t+g(e["border-"+n+"-width"])}),0)}function y(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return m;var i=f(e).getComputedStyle(e),r=function(e){for(var t={},n=0,i=["top","right","bottom","left"];n<i.length;n++){var r=i[n],o=e["padding-"+r];t[r]=g(o)}return t}(i),o=r.left+r.right,a=r.top+r.bottom,s=g(i.width),l=g(i.height);if("border-box"===i.boxSizing&&(Math.round(s+o)!==t&&(s-=v(i,"left","right")+o),Math.round(l+a)!==n&&(l-=v(i,"top","bottom")+a)),!function(e){return e===f(e).document.documentElement}(e)){var c=Math.round(s+o)-t,u=Math.round(l+a)-n;1!==Math.abs(c)&&(s-=c),1!==Math.abs(u)&&(l-=u)}return x(r.left,r.top,s,l)}var b="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof f(e).SVGGraphicsElement}:function(e){return e instanceof f(e).SVGElement&&"function"==typeof e.getBBox};function _(e){return s?b(e)?function(e){var t=e.getBBox();return x(0,0,t.width,t.height)}(e):y(e):m}function x(e,t,n,i){return{x:e,y:t,width:n,height:i}}var E=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=x(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=_(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),w=function(e,t){var n=function(e){var t=e.x,n=e.y,i=e.width,r=e.height,o="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,a=Object.create(o.prototype);return p(a,{x:t,y:n,width:i,height:r,top:n,right:t+i,bottom:r+n,left:t}),a}(t);p(this,{target:e,contentRect:n})},S=function(){function e(e,t,n){if(this.activeObservations_=[],this.observations_=new a,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=n}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof f(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new E(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof f(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new w(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),A="undefined"!=typeof WeakMap?new WeakMap:new a,M=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=d.getInstance(),i=new S(t,n,this);A.set(this,i)};["observe","unobserve","disconnect"].forEach((function(e){M.prototype[e]=function(){var t;return(t=A.get(this))[e].apply(t,arguments)}}));const T=void 0!==l.ResizeObserver?l.ResizeObserver:M;function C(e){return function(e){if(Array.isArray(e))return P(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var L=new Map;function R(e,t,n,i){if(L.has(i))return new(L.get(i))(e,t,n);function a(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;this.sharedResources=o,this.loadingIntervals={},i.call(this,e,n),this.renderContext=new r(this.canvas),this.originalLoadDocumentNode=this.loadDocumentNode.bind(this),this.sharedResources.mrtFlags?this.renderContext.mrtFlags=this.sharedResources.mrtFlags:this.sharedResources.mrtFlags=this.renderContext.mrtFlags,this.resizeObserver=new T((function(e){var n=e[0].contentRect,i=Math.floor(n.width),r=Math.floor(n.height);i&&r&&(t.impl.resize(i,r,!0),t.dispatchEvent({type:Autodesk.Viewing.VIEWER_RESIZE_EVENT,width:i,height:r}),t.impl.tick(performance.now()))})),this.resizeObserver.observe(this.container)}function s(e,t){var n=e.getModelKey();return n+=".ref:"+!!t.applyRefPoint,n+=".g:"+(t.globalOffset?[t.globalOffset.x,t.globalOffset.y,t.globalOffset.z]:[0,0,0]).toString(),t.placementTransform&&(n+=".p:"+t.placementTransform.toArray().toString()),t.customHash&&(n+=".h:"+t.customHash),n}a.prototype=Object.create(i.prototype),a.prototype.constructor=a,a.prototype.initialize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={glrenderer:this.sharedResources.glrenderer,materialManager:this.sharedResources.materialManager,renderer:this.renderContext},n=Object.assign({},e,t),r=i.prototype.initialize.call(this,n);return this.overrideAPIs(),this.sharedResources.geomCache&&this.sharedResources.geomCache.initialized&&this.impl.setGeomCache(this.sharedResources.geomCache),r},a.prototype.uninitialize=function(){var e=this;this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),Object.keys(this.loadingIntervals).forEach((function(t){e.clearLoadingInterval(t)})),i.prototype.uninitialize.call(this)},a.prototype.overrideAPIs=function(){var e=this,t=this.impl.tick.bind(this.impl);this.impl.tick=function(){if(e.impl){e.impl.renderer().prepareViewport(),e.restoreViewerState();var n=performance.now();t(n),e.impl.renderer().restoreViewport()}},this.addEventListener(Autodesk.Viewing.RENDER_PRESENTED_EVENT,(function(){e.renderContext.renderToCanvas()}),{priority:-1e3});var n=this.impl.setLightPreset.bind(this.impl);this.impl.setLightPreset=function(t,i,r){if(e.impl.is2d){e.impl.initLights();var o=Autodesk.Viewing.Private.LightPresets[t].bgColorGradient;e.setBackgroundColor.apply(e,C(o)),e.impl.setCurrentLightPreset(t);var a=e.impl.loadCubeMapFromColors(e.impl.clearColorTop,e.impl.clearColorBottom);e.impl.renderer().setCubeMap(a)}else n(t,i,r)};var i=this.toolController.__invokeStack.bind(this.toolController);this.toolController.__invokeStack=function(){return e.restoreViewerState(),i.apply(void 0,arguments)};var r=this.impl.unloadModel.bind(this.impl);this.impl.unloadModel=function(t){var n=t.leechViewerKey,i=!1,o=e.sharedResources.loadedModels[n];return o&&(o.usedByViewersCounter--,(i=o.forceKeepResources||o.usedByViewersCounter>0)||delete e.sharedResources.loadedModels[n]),e.clearLoadingInterval(n),r(t,i)},this.loadDocumentNode=function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(r,o){var a=s(n,i),l=e.sharedResources.loadedModels[a];if(l){var c=e.onModelLoaded(l.model,i);r(c)}else e.originalLoadDocumentNode(t,n,i).then((function(t){t.leechViewerKey=a,e.sharedResources.loadedModels[a]={model:t,usedByViewersCounter:1,loadingViewer:e},r(t)})).catch(o)}))};var o=this.impl.geomCache.bind(this.impl);this.impl.geomCache=function(){return e.sharedResources.geomCache&&e.sharedResources.geomCache.initialized||(e.sharedResources.geomCache=o()),e.sharedResources.geomCache}},a.prototype.setViewerProfile=function(e,t){if(!t.loadAsHidden){t.isAEC=e.isAEC();var n=this.chooseProfile(t);delete n.settings.lineRendering,delete n.settings.pointRendering,this.setProfile(n)}},a.prototype.setViewerLight=function(e,t){if(!t.loadAsHidden)if(this.impl.is2d){this.impl.setLightPreset(o.DefaultLightPreset2d);var n=this.impl.clearColorTop.clone().multiplyScalar(255),i=this.impl.clearColorBottom.clone().multiplyScalar(255);t.isAEC?this.impl.setLightPresetForAec():this.impl.setLightPreset(o.DefaultLightPreset),this.impl.toggleEnvMapBackground(!1),this.setBackgroundColor(n.x,n.y,n.z,i.x,i.y,i.z)}else this.impl.toggleEnvMapBackground(this.profile.settings.envMapBackground)},a.prototype.cleanViewerBeforeLoadModel=function(e){if(!e.keepCurrentModels&&this.impl.hasModels()){var t=this.config;this.tearDown(),this.setUp(t)}!this.impl.hasModels()&&this._loadingSpinner&&this._loadingSpinner.show()};var l=new THREE.Vector4(0,0,-1,-1e20);function c(e){var t=!e,n=e&&!e.isLoadDone(),i=e&&e.getPropertyDb()&&!e.getPropertyDb().isLoadDone();return!(t||n||i)}return a.prototype.syncCutPlanes=function(){var e=this.impl.getAllCutPlanes()||[l],t=this.impl.matman(),n=Math.max(e.length,t._cutplanes.length);t._cutplanes.length=0;for(var i=0;i<e.length;i++)t._cutplanes.push(e[i].clone());for(;i<n;i++)t._cutplanes.push(l);t.forEach((function(e){e.doNotCut||(e.cutplanes=t._cutplanes)}),!1,!0)},a.prototype.restoreViewerState=function(){this.sharedResources.lastRenderedViewer!==this&&(this.syncCutPlanes(),this.impl.is2d&&this.impl.updateCameraMatrices(),this.sharedResources.lastRenderedViewer=this)},a.prototype.onModelLoaded=function(e,t){var n=e.leechViewerKey;this.sharedResources.loadedModels[n].forceKeepResources=!0,this.cleanViewerBeforeLoadModel(t);var i=this.cloneModelToViewer(e);return this.addModelToViewer(i,t),delete this.sharedResources.loadedModels[n].forceKeepResources,i},a.prototype.addModelToViewer=function(e,t){this.impl.modelQueue().addHiddenModel(e),t.loadAsHidden||(this.setViewerProfile(e,t),this.showModel(e),this.setViewerLight(e,t),!t.headlessViewer&&this.createUI&&this.createUI(e)),this._loadingSpinner&&this._loadingSpinner.hide()},a.prototype.clearLoadingInterval=function(e){this.loadingIntervals[e]&&(clearInterval(this.loadingIntervals[e]),delete this.loadingIntervals[e])},a.prototype.cloneModelToViewer=function(e){var t=this,n=e.clone(),i=e.leechViewerKey;n.leechViewerKey=i;var r=this.sharedResources.loadedModels[i];r.usedByViewersCounter++;var o=r.loadingViewer;return this.clearLoadingInterval(i),this.loadingIntervals[i]=setInterval((function(){t.impl.invalidate(!1,!0,!1)}),1e3),function(e,t){return new Promise((function(n){c(t)&&n();var i=function i(){c(t)&&(e.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,i),e.removeEventListener(Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT,i),n())};e.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,i),e.addEventListener(Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT,i)}))}(o,n).then((function(){t.clearLoadingInterval(i),setTimeout((function(){n.setInnerAttributes(e.getInnerAttributes()),t.impl.onLoadComplete(n)}),1)})),n},L.set(i,a),new a(e,t,n,i)}},25090:(e,t,n)=>{"use strict";n.r(t),n.d(t,{MultiViewerFactory:()=>a});var i=n(17452),r=n(9140);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var t=Autodesk.Viewing.Private.createRenderer(void 0,{alpha:!0}),n=new r.MaterialManager(t);this.sharedResources={glrenderer:t,materialManager:n,loadedModels:{}}}var t,n,a;return t=e,n=[{key:"createViewer",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Autodesk.Viewing.Viewer3D;return(0,i.createLeechViewer)(e,t,this.sharedResources,n)}},{key:"destroy",value:function(){this.sharedResources=null}}],n&&o(t.prototype,n),a&&o(t,a),e}()},98926:(e,t,n)=>{"use strict";n.r(t),n.d(t,{LogLevels:()=>c,Logger:()=>u,logger:()=>f,setLogger:()=>m});var i=n(84998),r=n(58964),o=n(21319);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}var s=(0,i.getGlobal)(),l=s,c={DEBUG:5,LOG:4,INFO:3,WARNING:2,ERROR:1,NONE:0};function u(){this.runtimeStats={},this.level=-1,this.setLevel(c.ERROR),this._reportError=this._reportError.bind(this)}function h(e,t){var n;"string"==typeof t?n={message:t}:"object"===a(t)&&(n=t),o.analytics.track(e,n)}function d(){return"undefined"!=typeof window?encodeURI(l.location.href):""}function p(){}u.prototype.initialize=function(e){if(e.eventCallback&&(this.callback=e.eventCallback),this.sessionId=e.sessionId,!this.sessionId){var t=Date.now()+"";this.sessionId=parseFloat((1e4*Math.random()|0)+""+t.substring(4))}"number"==typeof e.logLevel&&this.setLevel(e.logLevel),this.environmentInfo={touch:(0,i.isTouchDevice)(),env:(0,r.getEnv)(),referer:d(),version:s.LMV_VIEWER_VERSION,build_type:s.LMV_BUILD_TYPE};var n={category:"viewer_start",touch:this.environmentInfo.touch,env:this.environmentInfo.env,referer:this.environmentInfo.referer,version:this.environmentInfo.version,build_type:this.environmentInfo.build_type};this.track(n);var o=this;this.interval=setInterval((function(){o.reportRuntimeStats()}),6e4)},u.prototype.shutdown=function(){clearInterval(this.interval),this.interval=void 0},u.prototype.track=function(e){this.updateRuntimeStats(e),!(0,r.isOffline)()&&this.sessionId&&(this.callback&&(e.timestamp=Date.now(),e.sessionId=this.sessionId,this.callback(e)),"error"===(null==e?void 0:e.category)&&h("viewer.error.tracked",e))},u.prototype.updateRuntimeStats=function(e){if(Object.prototype.hasOwnProperty.call(e,"aggregate"))switch(e.aggregate){case"count":this.runtimeStats[e.name]>0?this.runtimeStats[e.name]++:this.runtimeStats[e.name]=1,this.runtimeStats._nonempty=!0;break;case"last":this.runtimeStats[e.name]=e.value,this.runtimeStats._nonempty=!0;break;default:this.warn("unknown log aggregate type")}},u.prototype.reportRuntimeStats=function(){this.runtimeStats._nonempty&&(delete this.runtimeStats._nonempty,this.runtimeStats.category="misc_stats",this.track(this.runtimeStats),this.runtimeStats={})},u.prototype.setLevel=function(e){this.level!==e&&(this.level=e,this.debug=e>=c.DEBUG?console.log:p,this.log=e>=c.LOG?console.log:p,this.info=e>=c.INFO?console.info:p,this.warn=e>=c.WARNING?console.warn:p,this.error=e>=c.ERROR?this._reportError:p)},u.prototype._reportError=function(){console.error.apply(console,arguments);var e=Array.prototype.slice.call(arguments).join(" ");this.callback&&this.callback({category:"error",message:e}),h("viewer.error.logged",e)};var f=new u;function m(e){f=e}},5130:(e,t,n)=>{"use strict";n.r(t),n.d(t,{displayUnits:()=>a,displayUnitsEnum:()=>s,displayUnitsPrecision:()=>l,displayUnitsPrecisionEnum:()=>c,getUnitEnum:()=>h});var i=n(71224),r=[{name:"File units",type:""},{name:"Millimeters",type:"mm",matches:["millimeter","millimeters"]},{name:"Centimeters",type:"cm",matches:["centimeter","centimeters"]},{name:"Meters",type:"m"},{name:"Inches",type:"in",matches:["inch","inches"]},{name:"Feet",type:"ft",matches:["foot"]},{name:"Feet and fractional inches",type:"ft-and-fractional-in"},{name:"Feet and decimal inches",type:"ft-and-decimal-in"},{name:"Decimal inches",type:"decimal-in"},{name:"Decimal feet",type:"decimal-ft"},{name:"Fractional inches",type:"fractional-in"},{name:"Meters and centimeters",type:"m-and-cm"},{name:"Points",type:"pt",matches:["point","points"]}],o=[{name:"File precision",value:""},{name:"0 (1)",value:0},{name:"0.1 (1/2)",value:1},{name:"0.01 (1/4)",value:2},{name:"0.001 (1/8)",value:3},{name:"0.0001 (1/16)",value:4},{name:"0.00001 (1/32)",value:5},{name:"0.000001 (1/64)",value:6}],a=r.map((function(e){return e.name})),s=r.map((function(e){return e.type})),l=o.map((function(e){return e.name})),c=o.map((function(e){return e.value}));r.forEach((function(e){if(e.matches){var t=e.matches.map((function(e){return i.Z.t(e)}));e.matches=e.matches.concat(t)}}));var u=new Set(s);function h(e){if(e=e&&e.toLocaleLowerCase(),u.has(e))return e;for(var t in r){var n=r[t],i=n.matches;if(i&&i.indexOf(e)>-1)return n.type}return null}},85553:(e,t,n)=>{"use strict";n.r(t),n.d(t,{EPSILON:()=>s,getSnapResultPosition:()=>l,correctPerpendicularPicks:()=>c,calculateDistance:()=>u,computeResult:()=>v,getFaceArea:()=>y,getCircularArcRadius:()=>b,project:()=>_,inverseProject:()=>x,nearestPointInPointToLine:()=>E,nearestPointInPointToSegment:()=>w,isEqualVectors:()=>S,getEndPointsInEdge:()=>A,angleVectorToVector:()=>M,isParallel:()=>C,isPerpendicular:()=>P,nearestVertexInVertexToEdge:()=>L,createCommonOverlay:()=>R,safeToggle:()=>D});var i=n(16453),r=n(5646),o=n(37495),a=n(50638),s=1e-4;function l(e,t){if(!e)return null;var n=function(n){var i,r,o,a=null==e?void 0:e.viewportIndex2d,s=null==t||null===(i=t.model)||void 0===i||null===(r=i.getData())||void 0===r?void 0:r.viewports;if(s&&a&&(null===(o=s[a])||void 0===o?void 0:o.precision)){var l=s[a].precision;n.set(Number(n.x.toFixed(l)),Number(n.y.toFixed(l)),Number(n.z.toFixed(l)))}return n};if(e.isPerpendicular)return n(e.intersectPoint);switch(e.geomType){case r.t.SNAP_VERTEX:case r.t.RASTER_PIXEL:case r.t.SNAP_MIDPOINT:case r.t.SNAP_CIRCLE_CENTER:return n(e.getGeometry());case r.t.SNAP_EDGE:var i=A(e.getGeometry()),o=i[0].clone(),a=i[1].clone();return n(E(e.intersectPoint,o,a));case r.t.SNAP_FACE:return n(T(e.intersectPoint,e.getGeometry().vertices[0],e.faceNormal));case r.t.SNAP_CIRCULARARC:if(t&&t.model&&t.model.is2d()){var s=e.snapPoint;return e.geomType=r.t.SNAP_VERTEX,e.geomVertex=s,n(s)}return n(e.circularArcCenter);case r.t.SNAP_CURVEDEDGE:return n(L(e.intersectPoint,e.getGeometry()));case r.t.SNAP_CURVEDFACE:return n(e.intersectPoint);case r.t.SNAP_INTERSECTION:return n(e.snapPoint);default:return null}}function c(e,t,n,o){if(!(e&&t&&e.getGeometry()&&t.getGeometry()))return!1;var a=l(e,n);if(o&&n)if(t.geomType===r.t.SNAP_EDGE){var s=new i.Vector3,c=new i.Vector3,u=t.getGeometry();if(s.subVectors(t.intersectPoint,a).normalize(),c.subVectors(u.vertices[0],u.vertices[1]).normalize(),P(s,c,.05))if(p=w(a,u.vertices[0],u.vertices[1],!0))return o.onMouseMove(_(p,n))&&o.setPerpendicular(!0),t.geomVertex=p,t.intersectPoint=p,!0}else if(t.geomType===r.t.SNAP_FACE){var h=new i.Vector3,d=t.getGeometry();if(h.subVectors(t.intersectPoint,a).normalize(),C(t.faceNormal,h,.05)){var p=T(a,d.vertices[0],t.faceNormal);return o.onMouseMove(_(p,n))&&o.setPerpendicular(!0),t.geomVertex=p,t.intersectPoint=p,!0}}}function u(e,t,n,i){if(!(e&&t&&e.getGeometry()&&t.getGeometry()))return null;var r=l(e,i),a=l(t,i);if(!r||!a)return null;if(S(r,a,s))return null;if(i.model.is2d()&&(r=r.clone(),a=a.clone(),i.model.pageToModel(r,a,e.viewportIndex2d)),n){n=m(n);var c=r.distanceTo(a);return{distanceXYZ:g(c,n),distanceX:g(c=Math.abs(r.x-a.x),n),distanceY:g(c=Math.abs(r.y-a.y),n),distanceZ:0,type:o.o.MEASUREMENT_DISTANCE}}return{distanceXYZ:r.distanceTo(a),distanceX:Math.abs(r.x-a.x),distanceY:Math.abs(r.y-a.y),distanceZ:Math.abs(r.z-a.z),type:o.o.MEASUREMENT_DISTANCE}}function h(e,t){if(e.is3d())return 0;if(e.isPdf(!0))return 0;var n=e.getMetadata("page_dimensions","page_width",null),r=e.getMetadata("page_dimensions","logical_width",null),o=e.getMetadata("page_dimensions","page_height",null),a=e.getMetadata("page_dimensions","logical_height",null);if(!(n&&r&&o&&a))return 0;var s=n/r,l=o/a,c=new i.Vector3(0,0,0),u=new i.Vector3(s,l,0);return e.pageToModel(c,u,t),c.distanceTo(u)}function d(e,t){var n=[];for(var r in e)if(e.hasOwnProperty(r)){var o=l(e[r],t);o&&n.push(o)}if(3!==n.length||function(e){for(var t=0;t<e.length;t++)for(var n=0;n<e.length;n++)if(t!==n&&S(e[t],e[n],s))return!0;return!1}(n))return null;var a=new i.Vector3,c=new i.Vector3;return a.subVectors(n[0],n[1]),c.subVectors(n[2],n[1]),M(a,c)}function p(e,t){var n=[];for(var i in e)if(e.hasOwnProperty(i)){var r=l(e[i],t);r&&n.push(r.clone())}var o=l(e[1],t);o&&n.push(o.clone());for(var a=0;a<n.length;a+=2)t.model.pageToModel(n[a],n[a+1],e[1].viewportIndex2d);var s=0,c=0;for(a=0;a<n.length-1;a++)s+=n[a].x*n[a+1].y,c+=n[a].y*n[a+1].x;return Math.abs((s-c)/2)}function f(e,t,n,r){if(!(e&&t&&e.getGeometry()&&t.getGeometry()))return null;if(!e.circularArcRadius)return null;var o=l(e,r).clone(),a=l(t,r).clone(),c=e.circularArcCenter,u=c instanceof i.Vector3?c.clone():new i.Vector3(c.x,c.y,c.z);if(!o||!a)return null;if(S(o,a,s))return 0;r.model.is2d()&&(r.model.pageToModel(o,a,e.viewportIndex2d),r.model.pageToModel(u,null,e.viewportIndex2d));var h=function(){var e=new i.Vector3,t=new i.Vector3;e.subVectors(o,u),t.subVectors(a,u);var n=e.length()*t.length(),r=e.dot(t);return Math.acos(r/n)*e.length()}();return n?g(h,n=m(n)):h}function m(e){var t=Math.log(2*e)/Math.log(10),n=Math.floor(t);return 1<2*e/Math.pow(10,n)&&n++,Math.pow(10,n)}function g(e,t){return Math.floor(e/t+.5)*t}function v(e,t,n,i){switch(t){case o.o.MEASUREMENT_DISTANCE:return u(a=e[1],e[2],h(n.model,a.viewportIndex2d),n);case o.o.MEASUREMENT_ANGLE:var r=d(e,n);return r?{angle:i&&i.angleOuter?360-r:r,type:t}:null;case o.o.MEASUREMENT_AREA:return{area:p(e,n),type:t};case o.o.MEASUREMENT_ARC:var a;return{arc:f(a=e[1],e[2],h(n.model,a.viewportIndex2d),n),type:t};case o.o.MEASUREMENT_LOCATION:return{location:l(e[1],n),type:t};default:return null}}function y(e,t,n,r,o,s){for(var l=0,c=n.vertices,u=new i.Vector3,h=new i.Vector3,d=0;d<c.length;d+=3)u.subVectors(c[d+1],c[d]),h.subVectors(c[d+2],c[d]),l+=u.length()*h.length()*Math.sin(u.angleTo(h))/2;return l=(0,a.convertUnits)(e.model.getUnitString(),r,s,l,"square"),r?(0,a.formatValueWithUnits)(l,r+"^2",3,o):(0,a.formatValueWithUnits)(l,null,3,o)}function b(e,t,n,i,r,o){var s=n.radius;if(s){if(e.model.is2d()){var l=n.center.clone(),c=n.vertices[0].clone();e.model.pageToModel(l,c,t.getPick(1).viewportIndex2d),s=l.distanceTo(c)}return s=(0,a.convertUnits)(e.model.getUnitString(),i,o,s),(0,a.formatValueWithUnits)(s,i,3,r)}}function _(e,t,n){var r=t.navigation.getCamera(),o=t.navigation.getScreenViewport(),a=new i.Vector3(e.x,e.y,e.z);return a=a.project(r),n=n||0,new i.Vector2(Math.round((a.x+1)/2*o.width)+n,Math.round((1-a.y)/2*o.height)+n)}function x(e,t){var n=t.navigation.getCamera(),r=t.navigation.getScreenViewport(),o=new i.Vector3;return o.x=e.x/r.width*2-1,o.y=-(e.y/r.height*2-1),o.z=0,o=o.unproject(n)}function E(e,t,n){var r,o=new i.Vector3,a=new i.Vector3;return o.subVectors(t,e),a.subVectors(n,t),r=o.dot(a),o.subVectors(n,t),r=-r/o.dot(o),o.subVectors(n,t),o.multiplyScalar(r),o.add(t)}function w(e,t,n,r){var o,a,s=new i.Vector3,l=new i.Vector3;return s.subVectors(t,e),l.subVectors(n,t),a=s.dot(l),s.subVectors(n,t),(a=-a/s.dot(s))<0?o=r?null:t:a>1?o=r?null:n:(s.subVectors(n,t),s.multiplyScalar(a),o=s.add(t)),o}function S(e,t,n){return!(!e||!t)&&(Math.abs(e.x-t.x)<=n&&Math.abs(e.y-t.y)<=n&&Math.abs(e.z-t.z)<=n)}function A(e){for(var t=e.vertices,n=[],i=0;i<t.length;++i){for(var r=!1,o=0;o<t.length;++o)if(o!==i&&t[o].equals(t[i])){r=!0;break}r||n.push(t[i])}return n.length<2&&(n[0]=t[0],n[1]=t[1]),n}function M(e,t){return 180*e.angleTo(t)/Math.PI}function T(e,t,n){var r=new i.Vector3,o=n.clone(),a=new i.Vector3;a.subVectors(e,t);var s=-o.dot(a)/o.dot(o);return r.addVectors(e,o.multiplyScalar(s)),r}function C(e,t,n){return n=n||s,1-Math.abs(e.dot(t))<n}function P(e,t,n){return n=n||s,Math.abs(e.dot(t))<n}function L(e,t){for(var n,i=Number.MAX_VALUE,r=0;r<t.vertices.length;r++){var o=e.distanceTo(t.vertices[r]);i>o&&(n=t.vertices[r],i=o)}return n}function R(e,t){e.impl.overlayScenes[t]||e.impl.createOverlayScene(t)}function D(e,t,n){(e.classList.contains(t)&&!n||!e.classList.contains(t)&&n)&&e.classList.toggle(t,n)}},80890:(e,t,n)=>{"use strict";n.d(t,{n:()=>i});var i={MEASUREMENT_CHANGED_EVENT:"measurement-changed",MEASUREMENT_COMPLETED_EVENT:"measurement-completed",UNITS_CALIBRATION_STARTS_EVENT:"units_calibration_starts_event",FINISHED_CALIBRATION_FOR_DIMENSION_EVENT:"finished_calibration_for_dimension_event",CALIBRATION_REQUIRED_EVENT:"calibration-required",OPEN_CALIBRATION_PANEL_EVENT:"open-calibration-panel",CLOSE_CALIBRATION_PANEL_EVENT:"close-calibration-panel",CLEAR_CALIBRATION_SIZE_EVENT:"clear-calibration-size",FINISHED_CALIBRATION:"finished-calibration",DISPLAY_UNITS_CHANGED:"display-units-changed",PRECISION_CHANGED:"precision-changed",MEASUREMENT_MODE_ENTER:"measure-mode-enter",MEASUREMENT_MODE_LEAVE:"measure-mode-leave",DELETE_MEASUREMENT:"delete-measurement"}},70757:(e,t,n)=>{"use strict";n.d(t,{g:()=>a});var i=n(9331),r=n(37495),o=n(85553);function a(e,t,n){this.measurementType=e,this.id=t,this.picks=[],this.closedArea=!1,this.isRestored=!1,this.options=n,this.resetMeasureValues()}a.prototype.clone=function(){var e,t=new a(this.measurementType,this.id,this.options);return t.closedArea=this.closedArea,t.isRestored=this.isRestored,t.picks=this.clonePicks(),t.angle=this.angle,t.distanceX=this.distanceX,t.distanceY=this.distanceY,t.distanceZ=this.distanceZ,t.distanceXYZ=this.distanceXYZ,t.arc=this.arc,t.location=null===(e=this.location)||void 0===e?void 0:e.clone(),t.result=Object.assign({},this.result),t},a.prototype.resetMeasureValues=function(){this.angle=0,this.distanceX=0,this.distanceY=0,this.distanceZ=0,this.distanceXYZ=0,this.arc=0,this.location=null,this.result=null},a.prototype.setPick=function(e,t){var n=this.picks[e]=t;return n.id=parseInt(e),n},a.prototype.getPick=function(e){var t=this.picks[e];return t||(t=this.setPick(e,new i.N)),t},a.prototype.clonePicks=function(e){var t=[];for(var n in this.picks)if(Object.prototype.hasOwnProperty.call(this.picks,n)){var i=this.picks[n];t.push(i.clone())}return t},a.prototype.countPicks=function(){return Object.keys(this.picks).length},a.prototype.getMaxNumberOfPicks=function(){switch(this.measurementType){case r.o.MEASUREMENT_DISTANCE:case r.o.MEASUREMENT_LOCATION:case r.o.MEASUREMENT_CALLOUT:case r.o.MEASUREMENT_ARC:return 2;case r.o.MEASUREMENT_ANGLE:return 3;case r.o.MEASUREMENT_AREA:return this.closedArea?this.countPicks():Number.MAX_VALUE-1}},a.prototype.hasPick=function(e){return this.picks[e]&&!this.picks[e].isEmpty()||this.isRestored},a.prototype.isComplete=function(){var e=this.countPicks()===this.getMaxNumberOfPicks();for(var t in this.picks)if(Object.prototype.hasOwnProperty.call(this.picks,t)&&!(e=e&&this.hasPick(t)))break;return e},a.prototype.isEmpty=function(){var e=!0;for(var t in this.picks)if(Object.prototype.hasOwnProperty.call(this.picks,t)&&!(e=e&&!this.hasPick(t)))break;return e},a.prototype.clearPick=function(e){this.picks[e]&&this.picks[e].clear(),this.resetMeasureValues()},a.prototype.clearAllPicks=function(){for(var e in this.picks)Object.prototype.hasOwnProperty.call(this.picks,e)&&this.clearPick(e)},a.prototype.hasEqualPicks=function(e,t){if(!e||!t)return!1;if(e.geomType===t.geomType){var n=(0,o.getSnapResultPosition)(e),i=(0,o.getSnapResultPosition)(t);return(0,o.isEqualVectors)(n,i,o.EPSILON)}return!1},a.prototype.computeResult=function(e,t){if(this.resetMeasureValues(),!t.model)return this.result=null,!1;var n=this.result=(0,o.computeResult)(e,this.measurementType,t,this.options);if(null===n)return!this.isComplete();switch(n.type){case r.o.MEASUREMENT_DISTANCE:return this.distanceXYZ=n.distanceXYZ,this.distanceX=n.distanceX,this.distanceY=n.distanceY,this.distanceZ=n.distanceZ,!0;case r.o.MEASUREMENT_ANGLE:return this.angle=isNaN(n.angle)?0:n.angle,!0;case r.o.MEASUREMENT_AREA:return this.area=n.area,!0;case r.o.MEASUREMENT_ARC:return this.arc=n.arc,!0;case r.o.MEASUREMENT_LOCATION:return this.location=n.location,!0;case r.o.MEASUREMENT_CALLOUT:return!0;default:return!1}},a.prototype.getGeometry=function(e){return{type:this.picks[e].geomType,geometry:this.picks[e].getGeometry()}},a.prototype.attachIndicator=function(e,t,n){this.indicator=new n(e,this,t),this.indicator.init()}},37495:(e,t,n)=>{"use strict";var i;function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{o:()=>o,D:()=>a});var o={MEASUREMENT_DISTANCE:1,MEASUREMENT_ANGLE:2,MEASUREMENT_AREA:3,CALIBRATION:4,MEASUREMENT_CALLOUT:5,MEASUREMENT_LOCATION:6,MEASUREMENT_ARC:7},a=(r(i={},o.MEASUREMENT_DISTANCE,"Distance"),r(i,o.MEASUREMENT_ANGLE,"Angle"),r(i,o.MEASUREMENT_AREA,"Area"),r(i,o.CALIBRATION,"Calibration"),r(i,o.MEASUREMENT_CALLOUT,"Callout"),r(i,o.MEASUREMENT_LOCATION,"Location"),r(i,o.MEASUREMENT_ARC,"Arc"),i)},51902:(e,t,n)=>{"use strict";n.r(t),n.d(t,{PDFUtils:()=>s});var i=n(27820);function r(e){var t,n=e.impl.model.getDocumentNode(),i=null==n||null===(t=n.search(Autodesk.Viewing.BubbleNode.LEAFLET_NODE)[0])||void 0===t?void 0:t._raw();if(!i)return null;var r={};return new Autodesk.Viewing.Document(n.getRootNode()._raw(),"").getLeafletParams(r,n,i),r}function o(e){var t=new Autodesk.Viewing.Private.TexQuadConfig,n=r(e);return n?(t.initFromLoadOptions(null,n),t.getBBox()):null}function a(e){var t=o(e);return t?i.SceneMath.getNormalizingMatrix(null,t):null}var s={leafletToPdfWorld:function(e,t){var n,r=a(e);if(!r)return null;if(t.applyMatrix4(r),e.model.isLeaflet()){var o=e.model.getMetadata("page_dimensions"),s=new THREE.Box3(new THREE.Vector3,new THREE.Vector3(o.page_width,o.page_height,0));n=i.SceneMath.getNormalizingMatrix(void 0,s)}else n=i.SceneMath.getNormalizingMatrix(e.model);return t.applyMatrix4(n.invert()),t},pdfToLeafletWorld:function(e,t){var n=i.SceneMath.getNormalizingMatrix(e.model);t.applyMatrix4(n);var r=a(e);return r?(t.applyMatrix4(r.invert()),t):null},getLeafletLoadOptions:r,getLeafletBoundingBox:o,getLeafletNormalizingMatrix:a}},9331:(e,t,n)=>{"use strict";n.d(t,{N:()=>r});var i=n(5646);function r(){this.clear()}r.prototype.clear=function(){this.geomType=null,this.modelId=null,this.snapNode=null,this.geomVertex=null,this.geomEdge=null,this.geomFace=null,this.radius=null,this.intersectPoint=null,this.faceNormal=null,this.viewportIndex2d=null,this.circularArcCenter=null,this.circularArcRadius=null,this.fromTopology=!1,this.isPerpendicular=!1,this.snapPoint=null},r.prototype.copyTo=function(e){e.modelId=this.modelId,e.snapNode=this.snapNode,e.geomVertex=this.geomVertex,e.geomFace=this.geomFace,e.geomEdge=this.geomEdge,e.radius=this.radius,e.geomType=this.geomType,e.intersectPoint=this.intersectPoint,e.faceNormal=this.faceNormal,e.viewportIndex2d=this.viewportIndex2d,e.circularArcCenter=this.circularArcCenter,e.circularArcRadius=this.circularArcRadius,e.fromTopology=this.fromTopology,e.isPerpendicular=this.isPerpendicular,e.snapPoint=this.snapPoint},r.prototype.clone=function(){var e=new r;return this.copyTo(e),e},r.prototype.isEmpty=function(){return!this.getGeometry()};var o=null,a=null,s=null,l=function(e,t){return a=a||new THREE.Vector3,s=s||new THREE.Vector3,a.set(0,0,0),s.set(e,0,0),a.applyMatrix4(t),s.applyMatrix4(t),a.distanceTo(s)};r.prototype.applyMatrix4=function(e){if(this.geomEdge&&this.geomEdge.applyMatrix4(e),this.geomFace&&this.geomFace.applyMatrix4(e),this.geomVertex&&this.geomVertex.applyMatrix4(e),this.intersectPoint&&this.intersectPoint.applyMatrix4(e),this.circularArcCenter&&this.circularArcCenter.applyMatrix4(e),this.snapPoint&&this.snapPoint.applyMatrix4(e),this.faceNormal){var t=(o=o||new THREE.Matrix4).getNormalMatrix(e);this.faceNormal.applyMatrix4(t)}this.radius=l(this.radius,e),this.circularArcRadius=l(this.circularArcRadius,e)},r.prototype.getFace=function(){return this.geomFace},r.prototype.getEdge=function(){return this.geomEdge},r.prototype.getVertex=function(){return this.geomVertex},r.prototype.getGeometry=function(){switch(this.geomType){case i.t.SNAP_VERTEX:case i.t.SNAP_MIDPOINT:case i.t.SNAP_INTERSECTION:case i.t.SNAP_CIRCLE_CENTER:case i.t.RASTER_PIXEL:return this.geomVertex;case i.t.SNAP_EDGE:return this.geomEdge;case i.t.SNAP_FACE:return this.geomFace;case i.t.SNAP_CIRCULARARC:case i.t.SNAP_CURVEDEDGE:return this.geomEdge;case i.t.SNAP_CURVEDFACE:return this.geomFace}return null},r.prototype.setGeometry=function(e,t){switch(e){case i.t.SNAP_VERTEX:case i.t.SNAP_MIDPOINT:case i.t.SNAP_INTERSECTION:case i.t.SNAP_CIRCLE_CENTER:case i.t.RASTER_PIXEL:this.geomVertex=t;break;case i.t.SNAP_EDGE:this.geomEdge=t;break;case i.t.SNAP_FACE:this.geomFace=t;break;case i.t.SNAP_CIRCULARARC:case i.t.SNAP_CURVEDEDGE:this.geomEdge=t;break;case i.t.SNAP_CURVEDFACE:this.geomFace=t;break;default:return}this.geomType=e}},5646:(e,t,n)=>{"use strict";n.d(t,{t:()=>i});var i={SNAP_VERTEX:0,SNAP_MIDPOINT:1,SNAP_CIRCLE_CENTER:2,SNAP_EDGE:3,SNAP_FACE:4,SNAP_CIRCULARARC:5,SNAP_CURVEDEDGE:6,SNAP_CURVEDFACE:7,RASTER_PIXEL:8,SNAP_INTERSECTION:9}},50638:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ModelUnits:()=>c,formatValueWithUnits:()=>b,fixUnitString:()=>_,getUnitData:()=>x,convertUnits:()=>E,calculatePrecision:()=>w,convertToDisplayUnits:()=>S,getMainUnit:()=>A});var i,r=n(71224),o=n(5130);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=n(30325),c={METER:"m",CENTIMETER:"cm",MILLIMETER:"mm",FOOT:"ft",INCH:"in",POINT:"pt"},u=(s(i={},c.METER,1),s(i,c.CENTIMETER,.01),s(i,c.MILLIMETER,.001),s(i,c.FOOT,.3048),s(i,c.INCH,.0254),s(i,c.POINT,.0254/72),i);function h(e){var t="";return 2===e?t=String.fromCharCode(178):3===e&&(t=String.fromCharCode(179)),t}function d(e){var t=0<=e?Math.floor(e):Math.ceil(e);return{intPart:t,fracPart:e-t}}function p(e,t,n){var i="";return n&&0===e&&(i+="-"),i+=0<t?e.toFixed(t):e.toFixed(0)}function f(e,t,n,i){for(var r,o,a="",s=1,l=e<0,c=0;c<t;++c)s*=2;e>0?e+=.5/s:e-=.5/s,n?o=e:(a+=p(r=d(e/12).intPart,0,l)+i.feet+" ",(o=e-12*r)<0&&(o=-o));var u=d(o).intPart,h=d((o-u)*s).intPart;if(0!==h&&0===u||(a+=p(u,0)),0!==h){for(u<0&&h<0&&(h=-h);h%2==0;)h/=2,s/=2;0!==u&&(a+="-"),a+=p(h,0)+"/"+p(s,0)}return a+=i.inches}function m(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i="";e<0&&(i="-",e=Math.abs(e));var r=d(e),o=r.intPart,a=r.fracPart*Math.pow(100,n),s=h(n),l=p(o,0),c=p(a,t);return c.startsWith(Math.pow(100,n).toString())&&(l=p(o+1,0),c=p(0,t)),i+l+" m".concat(s," ")+c+" cm".concat(s)}function g(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r="";e<0&&(r="-",e=Math.abs(e));var o=d(e),a=o.intPart,s=o.fracPart*Math.pow(12,i),l=h(i),c=p(a,0),u=p(s,t);return u.startsWith(Math.pow(12,i).toString())&&(c=p(a+1,0),u=p(0,t)),r+c+n.feet+l+" "+u+n.inches+l}var v={feetFractionalInches:"ft-and-fractional-in",fractionalInches:"fractional-in",feet:"feet",inches:"inches",stationingFeet:"feet"};function y(e){if(!e||!e.startsWith("autodesk.unit.unit:"))return e;var t=e.split(":")[1].split("-")[0],n=l.unit[t];if(!n)return console.warn("Failed to find Forge unit schema for",e),e;var i=v[t];if(i)return i;if(!n.symbols)return console.warn("Unit without symbols.",n),"";if(n.defaultSymbol&&n.symbols[n.defaultSymbol])return n.symbols[n.defaultSymbol];for(var r in n.symbols)return n.symbols[r]}function b(e,t,n,i,o){var a;null==i&&(i=3);var s=(o=o||{}).preferLetters?{feet:" ft",inches:" in"}:{feet:"'",inches:'"'};t=y(t);try{if(1===n)a=r.Z.t(e?"Yes":"No");else if(24===n){var l=e.split(" ");a=[];for(var c=0;c<l.length;++c)a.push(b(parseFloat(l[c]),t,3,i));a=a.join(", ")}else if(2!==n&&3!==n||!isNaN(e))if("ft-and-fractional-in"===t)a=f(12*e,i,!1,s);else if("ft-and-fractional-in^2"===t)a=o.noMixedArea?p(e,i)+" ft"+h(2):f(12*e,i,!1,s)+" "+h(2);else if("ft-and-fractional-in^3"===t)a=o.noMixedVolume?p(e,i)+" ft"+h(3):f(12*e,i,!1,s)+" "+h(3);else if("ft-and-decimal-in"===t)a=g(e,i,s);else if("ft-and-decimal-in^2"===t)a=o.noMixedArea?p(e,i)+" ft"+h(2):g(e,i,s,2);else if("ft-and-decimal-in^3"===t)a=o.noMixedVolume?p(e,i)+" ft"+h(3):g(e,i,s,3);else if("decimal-in"===t||"in"===t||"inch"===t||"inches"===t)a=p(e,i)+s.inches;else if("decimal-in^2"===t||"in^2"===t||"inch^2"===t)a=p(e,i)+" in"+h(2);else if("decimal-in^3"===t||"in^3"===t||"inch^3"===t)a=p(e,i)+" in"+h(3);else if("decimal-in-sq"===t||"fractional-in-sq"===t)a=p(e,i)+" sq. in";else if("decimal-ft"===t||"ft"===t||"feet"===t||"foot"===t)a=p(e,i)+s.feet;else if("decimal-ft^2"===t||"ft^2"===t||"feet^2"===t||"foot^2"===t)a=p(e,i)+" ft"+h(2);else if("decimal-ft^3"===t||"ft^3"===t||"feet^3"===t||"foot^3"===t)a=p(e,i)+" ft"+h(3);else if("decimal-ft-sq"===t||"ft-and-fractional-in-sq"===t||"ft-and-decimal-in-sq"===t)a=p(e,i)+" sq. ft";else if("fractional-in"===t)a=f(e,i,!0,s);else if("fractional-in^2"===t)a=f(e,i,!0,s)+h(2);else if("fractional-in^3"===t)a=f(e,i,!0,s)+h(3);else if("m-and-cm"===t)a=m(e,i);else if("m-and-cm^2"===t)a=o.noMixedArea?p(e,i)+" m"+h(2):m(e,i,2);else if("m-and-cm^3"===t)a=o.noMixedVolume?p(e,i)+" m"+h(3):m(e,i,3);else if(t&&t.text){a=function(e,t){var n=t.space?" ":"";return"Prefix"===t.placement?t.text+n+e:e+n+t.text}(3===n?p(e,i):e,t)}else 3===n&&t?(t=(t=t.replace("^2",h(2))).replace("^3",h(3)),a=p(e,i)+" "+t):a=t?e+" "+t:3===n?p(e,i):e;else a="NaN"}catch(n){a=t?e+" "+t:e}return a}function _(e){var t;switch(e=null===(t=e)||void 0===t?void 0:t.toLowerCase()){case"meter":case"meters":case"m":return c.METER;case"foot":case"feet":case"ft":return c.FOOT;case"feet and inches":case"inch":case"inches":case"in":return c.INCH;case"centimeter":case"centimeters":case"cm":return c.CENTIMETER;case"millimeter":case"millimeters":case"mm":return c.MILLIMETER;case"point":case"points":case"pt":return c.POINT;default:return e}}function x(e){var t=_(e);return{unitString:t,unitScale:u[t]||1}}function E(e,t,n,i,r,o){if(n=n||1,o=o||72,(e=_(e))===(t=_(t))&&1===n)return i;var a=c,s=u,l=1;switch(t){case a.MILLIMETER:l=1/s[a.MILLIMETER];break;case a.CENTIMETER:l=1/s[a.CENTIMETER];break;case a.METER:l=1;break;case a.INCH:l=1/s[a.INCH];break;case a.FOOT:case"ft-and-fractional-in":case"ft-and-decimal-in":l=1/s[a.FOOT];break;case"decimal-in":l=1/s[a.INCH];break;case"decimal-ft":l=1/s[a.FOOT];break;case"fractional-in":l=1/s[a.INCH];break;case"m-and-cm":l=1;break;case a.POINT:l=1/s[a.INCH]*o}var h=1;switch(e){case a.MILLIMETER:h=s[a.MILLIMETER];break;case a.CENTIMETER:h=s[a.CENTIMETER];break;case a.METER:h=s[a.METER];break;case a.INCH:h=s[a.INCH];break;case a.FOOT:case"ft-and-fractional-in":case"ft-and-decimal-in":h=s[a.FOOT];break;case"decimal-in":h=s[a.INCH];break;case"decimal-ft":h=s[a.FOOT];break;case"fractional-in":h=s[a.INCH];break;case"m-and-cm":h=1;break;case a.POINT:h=s[a.INCH]/o}return"square"===r?i?i*Math.pow(l*h*n,2):0:"cube"===r?i?i*Math.pow(l*h*n,3):0:i?i*l*h*n:0}function w(e){if(!e)return 0;var t=e.toString().split(".")[1];if(!t){var n=e.toString().split("/")[1],i=n&&n.match(/\d+/);if(i){var r=parseFloat(i);if(r&&!isNaN(r))return Math.floor(Math.log2(r))}return 0}return(t=t.match(/\d+/))&&t[0]&&t[0].length||0}function S(e,t,n,i){if(!n||!i)return{displayValue:e,displayUnits:n};var r,s=n,l=i,c=y(s);return"object"===a(c)&&"text"in c&&(s=c.text),s&&(s=s.replace(/$/,"^2").replace(/$/,"^3")),/\^2$/.test(s)?(s=s.replace("^2",""),l+="^2",r="square"):/\^3$/.test(s)&&(s=s.replace("^3",""),l+="^3",r="cube"),null===(s=(0,o.getUnitEnum)(s))?{displayValue:e,displayUnits:n}:2===t||3===t?{displayValue:E(s,i,1,e,r,null),displayUnits:l}:24===t?{displayValue:e.split(" ").map((function(e){return E(s,i,1,e,r,null)})).join(" "),displayUnits:l}:{displayValue:e,displayUnits:n}}function A(e){switch(e){case"decimal-ft":case"ft-and-fractional-in":case"ft-and-decimal-in":return"ft";case"decimal-in":case"fractional-in":return"in";case"m-and-cm":return"m"}return e}},7963:(e,t,n)=>{"use strict";n.r(t),n.d(t,{UnitParser:()=>i});var i={};function r(e,t,n,i){if(!e)return NaN;var r,o=(e=e.toString()).trim();if(0==o.length)return NaN;var a=n.join("| *"),s=i.join("| *");if(r=o.match(new RegExp("^([+-]?\\d+)(?: *)/(?: *)(\\d+)(?: *)(?:"+s+") *$")))return parseFloat(r[1])/parseFloat(r[2])/t;if(r=o.match(new RegExp("^([+-]?\\d+)(?: *)/(?: *)(\\d+)(?: *)(?:"+a+")? *$")))return parseFloat(r[1])/parseFloat(r[2]);var l;if(!(r=o.match(/^[+-]? *(?:\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?/i)))return NaN;if(l=parseFloat(r[0].replace(/ */g,"")),0==(o=(o=o.slice(r[0].length)).replace("-"," ")).length||isNaN(l))return l;var c=Math.sign(l);return 0===c&&(c=1),o.match(new RegExp("^(?: *)(?:"+s+") *$","i"))?l/t:(r=o.match(new RegExp("^ +(\\d+)(?: *)/(?: *)(\\d+)(?: *)(?:"+s+") *$","i")))?(l+c*parseFloat(r[1])/parseFloat(r[2]))/t:(r=o.match(new RegExp("^(?: *)(?:"+a+"|-| +-?) *","i")))?0==(o=o.slice(r[0].length).trim()).length?r[0].match(/-/)?NaN:l:(r=o.match(new RegExp("^(\\d+(?:\\.\\d*)?)(?: *)(?:"+s+")? *$")))?l+c*parseFloat(r[1])/t:(r=o.match(new RegExp("^(\\d+)(?: *)/(?: *)(\\d+)(?: *)(?:"+s+")? *$")))?l+c*(parseFloat(r[1])/parseFloat(r[2]))/t:(r=o.match(new RegExp("^(\\d+) +(\\d+)(?: *)/(?: *)(\\d+)(?: *)(?:"+s+")? *$")))?l+c*(parseFloat(r[1])+parseFloat(r[2])/parseFloat(r[3]))/t:NaN:NaN}i.parseFeet=function(e){return r(e,12,["ft","feet","'","`","",""],["in","inch",'\\"',"''","``","",""])},i.parseMeter=function(e){return r(e,100,["m","meter"],["cm","centimeter"])},i.parseNumber=function(e,t){switch(t){case"ft":case"decimal-ft":case"ft-and-fractional-in":case"ft-and-decimal-in":case"decimal-in":case"fractional-in":return i.parseFeet(e);default:return i.parseMeter(e)}},i.parsePositiveNumber=function(e,t){var n=i.parseNumber(e,t);return n>=0?n:NaN}},80723:(e,t,n)=>{"use strict";n.r(t),n.d(t,{MobileCallbacks:()=>r});var i=(0,n(84998).getGlobal)();function r(){this.ios=i.webkit,this.android=i.JSINTERFACE,this.iosSend=function(e,t){return i.webkit.messageHandlers.callbackHandler.postMessage({command:e,data:t})},this.androidSend=i.JSINTERFACE}var o=r.prototype;o.animationReady=function(){this.ios?this.iosSend("animationReady"):this.android&&this.androidSend.animationReady()},o.onSelectionChanged=function(e){this.ios?this.iosSend("selectionChanged",e):this.android&&this.androidSend.onSelectionChanged(e)},o.onLongTap=function(e,t){this.ios?this.iosSend("onLongTap",[e,t]):this.android&&this.androidSend.onLongTap(e,t)},o.onSingleTap=function(e,t){this.ios?this.iosSend("onSingleTap",[e,t]):this.android&&this.androidSend.onSingleTap(e,t)},o.onDoubleTap=function(e,t){this.ios?this.iosSend("onDoubleTap",[e,t]):this.android&&this.androidSend.onDoubleTap(e,t)},o.setRTCSession=function(e){this.ios?this.iosSend("setRTCSession",{id:e}):this.android&&this.androidSend.setRTCSessionID(e)},o.putProperties=function(e,t){this.ios?this.iosSend("putProperties",{name:e,value:t}):this.android&&this.androidSend.putProperties(e,t)},o.onPropertyRetrievedSuccess=function(){this.ios?this.iosSend("onPropertyRetrievedSuccess"):this.android&&this.androidSend.onPropertyRetrievedSuccess()},o.onPropertyRetrievedFailOrEmptyProperties=function(){this.ios?this.iosSend("onPropertyRetrievedFailOrEmptyProperties"):this.android&&this.androidSend.onPropertyRetrievedFailOrEmptyProperties()},o.resetAnimationStatus=function(){this.ios?this.iosSend("resetAnimationStatus"):this.android&&this.androidSend.resetAnimationStatus()},o.setPauseUI=function(){this.ios?this.iosSend("setPauseUI"):this.android&&this.androidSend.setToPaused()},o.getDeviceAvailableMemory=function(){return this.ios?this.iosSend("getDeviceAvailableMemory"):this.android?this.androidSend.getDeviceAvailableMemory():void 0},o.onDeviceMemoryInsufficient=function(){return this.ios?this.iosSend("onDeviceMemoryInsufficient"):this.android?this.androidSend.onDeviceMemoryInsufficient():void 0},o.updateAnimationTime=function(e){this.ios?this.iosSend("updateAnimationTime",e):this.android&&this.androidSend.updateAnimationTime(e)},o.setLoadingProgress=function(e,t){this.ios?this.iosSend("setLoadingProgress",{state:e,progress:t}):this.android&&this.androidSend.setLoadingProgress(e,t)},o.objectTreeCreated=function(){this.ios?this.iosSend("objectTreeCreated"):this.android&&this.androidSend.objectTreeCreated()},o.geometryLoaded=function(){this.ios?this.iosSend("geometryLoaded"):this.android&&this.androidSend.geometryLoaded()},o.putSheets=function(e,t){this.ios?this.iosSend("putSheets",[e,t]):this.android&&this.androidSend.putSheets(e,t)},o.putAllSheets=function(e){this.ios?this.iosSend("putAllSheets",e):this.android&&this.androidSend.putAllSheets(e)},o.hideLoadingView=function(){this.android&&this.androidSend.hideLoadingView()},o.instanceTree=function(e){this.ios?this.iosSend("instanceTree",e):this.android&&this.androidSend.instanceTree(e)},o.loadSheetFailed=function(){this.ios?this.iosSend("loadSheetFailed"):this.android&&this.androidSend.loadSheetFailed()},o.sheetSelected=function(e){this.ios?this.iosSend("sheetSelected",e):this.android&&this.androidSend.sheetSelected(e)},"undefined"!=typeof window&&(i.MobileCallbacks=r)},45375:(e,t,n)=>{function i(){return"undefined"!=typeof window&&null!==window?window:"undefined"!=typeof self&&null!==self?self:n.g}function r(e){for(var t=i(),n=e.split("."),r=0;r<n.length;++r)t[n[r]]=t[n[r]]||{},t=t[n[r]];return t}r("Autodesk.Viewing.Private"),r("Autodesk.Viewing.Extensions"),r("Autodesk.Extensions"),r("Autodesk.Viewing.Shaders"),r("Autodesk.Viewing.UI"),r("Autodesk.LMVTK"),Autodesk.Viewing.getGlobal=i,Autodesk.Viewing.AutodeskNamespace=r,i().AutodeskNamespace=r;var o=i().Autodesk.Viewing.Private;o.LMV_WORKER_URL="lmvworker.min.js",o.ENABLE_DEBUG=o.ENABLE_DEBUG||!1,i().ENABLE_DEBUG=o.ENABLE_DEBUG,o.ENABLE_INLINE_WORKER=!0,e.exports.Autodesk=i().Autodesk},92148:(e,t,n)=>{"use strict";function i(e){var t=Autodesk.Viewing,n=t.Private,i=t.UI,r=t.Extensions;for(var o in e.av)t[o]=e.av[o];for(var a in e.avp)n[a]=e.avp[a];for(var s in e.avu)i[s]=e.avu[s];for(var l in e.ave)r[l]=e.ave[l];t.getGlobal().THREE=e.THREE,t.getGlobal().LMV=e,n.isRightClick=t.isRightClick,n.isMiddleClick=t.isMiddleClick}n.d(t,{i:()=>i})},34500:(e,t,n)=>{"use strict";n.r(t),n.d(t,{theResourceLoader:()=>s,loadDependency:()=>l});var i=n(17167);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=(0,n(84998).getGlobal)(),a=o.document,s=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loadPromises={}}var t,n,s;return t=e,(n=[{key:"getResourceUrl",value:function(e){return e.indexOf("://")>0?e:(0,i.getResourceUrl)(e)}},{key:"loadScriptIntoDom",value:function(e,t,n){var i=a.createElement("SCRIPT");i.src=e;var r=function(){i.onerror=null,i.onload=null};i.onload=function(){r(),t()},i.onerror=function(t){r(),n&&n(new Error("Error loading script ".concat(e,", with error ").concat(t)))},a.head.appendChild(i)}},{key:"loadScript",value:function(e,t){var n=this;if(t&&void 0!==o[t])return Promise.resolve();var r=(e=this.getResourceUrl(e)).toLowerCase();if(r in this.loadPromises)return this.loadPromises[r];var a=(0,i.getScript)(e);return this.loadPromises[r]=a?Promise.resolve():new Promise((function(t,i){n.loadScriptIntoDom(e,t,i)})),this.loadPromises[r]}},{key:"_getLink",value:function(e){for(var t=a.getElementsByTagName("link"),n=0,i=t.length;n<i;n++)if(t[n].href===e)return t[n];return null}}])&&r(t.prototype,n),s&&r(t,s),e}());function l(e,t,n,i){s.loadScript(t,e).then((function(){n&&n()})).catch((function(e){i&&i(e)}))}Object.freeze(s)},96546:(e,t,n)=>{"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.r(t),n.d(t,{SearchManager:()=>T});var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewer=t}var t,n,r;return t=e,(n=[{key:"search",value:function(e){return new Promise((function(e,t){}))}},{key:"getProviderId",value:function(){return"Search Provider Id"}}])&&i(t.prototype,n),r&&i(t,r),e}();function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=u(e);if(t){var r=u(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(o,e);var t,n,i,r=l(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,(n=[{key:"search",value:function(e){var t=this;return new Promise((function(n,i){var r=t.viewer.getVisibleModels(),o=[];0===r.length&&n(o);for(var a=function(t){var n=r[t],i=[],a=n.getInstanceTree();n.getObjectTree((function(t){t.enumNodeChildren(t.getRootId(),(function(t){var n=a&&a.getNodeName(t);n&&-1!==n.toLowerCase().indexOf(e)&&i.push(t)}),!0)})),o.push({ids:i,model:n})},s=0;s<r.length;s++)a(s);n(o)}))}},{key:"getProviderId",value:function(){return"ModelPartsSearchProvider"}}])&&a(t.prototype,n),i&&a(t,i),o}(r);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=v(e);if(t){var r=v(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return g(this,n)}}function g(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(o,e);var t,n,i,r=m(o);function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r.call(this,e)}return t=o,(n=[{key:"search",value:function(e){var t=this;return new Promise((function(n,i){var r=t.viewer.getVisibleModels(),o=[];0===r.length&&n(o);for(var a=function(t){var a=r[t];a.search(e,(function(e){o.push({ids:e,model:a}),o.length===r.length&&n(o)}),i)},s=0;s<r.length;s++)a(s)}))}},{key:"getProviderId",value:function(){return"PropertiesSearchProvider"}}])&&p(t.prototype,n),i&&p(t,i),o}(r);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function _(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function x(e,t){return x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},x(e,t)}function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=S(e);if(t){var r=S(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return w(this,n)}}function w(e,t){return!t||"object"!==b(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}var A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(o,e);var t,n,i,r=E(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),t=r.call(this,e),e.loadExtension("Autodesk.StringExtractor"),t}return t=o,(n=[{key:"search",value:function(e){var t=this;return new Promise((function(n){t.viewer.getExtensionAsync("Autodesk.StringExtractor").then((function(i){return i.getDocumentStrings().then((function(i){for(var r=[],o=t.viewer.impl.get2DModels(),a=0;a<o.length;a++){var s=o[a].id,l=!o[a].isLeaflet(),c=i[s];if(c){var u=c.strings,h=t.searchStrings(u,e,s,l);r.push({modelId:s,searchResult:h})}}n(r)}))}))}))}},{key:"searchStrings",value:function(e,t,n,i){var r=[];if(i)for(var o=0;o<e.length;o++){for(var a=0,s=[];-1!==a;)-1!==(a=e[o].string.toLowerCase().indexOf(t,a))&&(s.push(a),a+=1);if(s.length>0){var l=this.splitOccurrences(e[o],s,t,n);r=r.concat(l)}}else for(var c=0;c<e.length;c++)-1!==e[c].string.toLowerCase().indexOf(t)&&r.push(e[c]);return r}},{key:"splitOccurrences",value:function(e,t,n,i){var r=this.viewer.impl.findModel(i),o=[],a=1/72,s=r.getData();function l(t,n){var i=e.stringCharWidths.slice(t,n);return i.length?i.reduce((function(e,t){return e+t})):0}if(r){var c=s.metadata.page_dimensions.page_units;a*=Autodesk.Viewing.Private.convertUnits(Autodesk.Viewing.Private.ModelUnits.INCH,c,1,1);for(var u=s.scaleX,h=(r.getData().scaleY||a)*e.stringHeight,d=0;d<t.length;d++){var p={string:n},f=l(0,t[d]),m=l(t[d],t[d]+n.length);if(e.stringWidth){var g=l(0,e.string.length),v=e.stringWidth/g*a;f*=v,m*=v}else f*=u,m*=u;var y=e.angle||0,b=Math.cos(y)*f,_=Math.sin(y)*f,x=e.stringPosition[0]+b,E=e.stringPosition[1]+_,w=x+m,S=E+h,A=new THREE.Vector2(x,E),M=new THREE.Vector2(w,S),T=new THREE.Box2(A,M);p.boundingBox=T,p.angle=e.angle,o.push(p)}}return o}},{key:"getProviderId",value:function(){return"TextSearchProvider"}}])&&_(t.prototype,n),i&&_(t,i),o}(r);function M(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var T=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewer=t,this.searchProviders=new Map}var t,n,i;return t=e,(n=[{key:"addSearchProvider",value:function(e){this.searchProviders.has(e)||this.searchProviders.set(e,new e(this.viewer))}},{key:"search",value:function(e){var t=this;return new Promise((function(n,i){var r=t.prepareSearchInput(e),o=[];t.searchProviders.forEach((function(e){var t=e.search(r),n=e.getProviderId();t.id=n,o.push(t)})),Promise.all(o).then((function(e){var t={};e.forEach((function(e,n){var i=o[n].id;t[i]=e})),n(t)})).catch(i)}))}},{key:"removeAllProviders",value:function(){this.searchProviders.clear()}},{key:"removeProvider",value:function(e){this.searchProviders.delete(e)}},{key:"prepareSearchInput",value:function(e){return e.toLowerCase()}}])&&M(t.prototype,n),i&&M(t,i),e}(),C=AutodeskNamespace("Autodesk.Viewing.Search");C.SearchManager=T,C.ModelPartsSearchProvider=h,C.PropertiesSearchProvider=y,C.TextSearchProvider=A},26099:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DefaultHandler:()=>r});n(16453);var i=n(84998);function r(e,t,n){this.clickConfig=null,this.getNames=function(){return["default"]},this.getName=function(){return this.getNames()[0]},this.setClickBehavior=function(e){this.clickConfig=e},this.getClickBehavior=function(){return this.clickConfig},this.activate=function(e){},this.deactivate=function(e){},this.handleAction=function(t,i){for(var r=0;r<t.length;++r)switch(t[r]){case"selectOnly":e.selector&&i&&e.selector.setSelection([i.dbId],i.model);break;case"deselectAll":e.selector&&e.selector.setSelection([]);break;case"selectToggle":e.selector&&i&&e.selector.toggleSelection(i.dbId,i.model);break;case"isolate":i&&e.isolate(i.dbId);break;case"showAll":e.showAll();break;case"setCOI":i&&i.intersectPoint&&(n.setPivotPoint(i.intersectPoint,!0,!0),n.pivotActive(!0,!0));break;case"hide":i&&e.hide(i.dbId);break;case"show":i&&e.show(i.dbId);break;case"toggleVisibility":i&&e.toggleVisibility(i.dbId);break;case"focus":e.selector&&(i?e.selector.setSelection([i.dbId],i.model):e.selector.setSelection([]),n.fitToView())}},this.handleSingleClick=function(t,r){if((0,i.isMobileDevice)())return!1;var o=t.ctrlKey||t.metaKey,a=t.shiftKey,s=t.altKey;if(0===r){var l=e.clientToViewport(t.canvasX,t.canvasY),c="click";o&&(c+="Ctrl"),a&&(c+="Shift"),s&&(c+="Alt");var u=(h=e.hitTestViewport(l,!1))?"onObject":"offObject";if(this.clickConfig&&this.clickConfig[c]&&this.clickConfig[c][u])return this.handleAction(this.clickConfig[c][u],h),!0}else if(1===r&&a&&!s&&!o){var h;l=e.clientToViewport(t.canvasX,t.canvasY);if((h=e.hitTestViewport(l,!1))&&h.intersectPoint)return n.setPivotPoint(h.intersectPoint,!0,!0),n.pivotActive(!0,!0),!0}return!1},this.handleDoubleClick=function(i,r){if(e.selector&&0===r){var o=e.clientToViewport(i.canvasX,i.canvasY),a=e.hitTestViewport(o,!1);return a?e.selector.setSelection([a.dbId],a.model):e.selector.clearSelection(),n.fitToView(),!0}return 1===r&&(t.fitBounds(!1,n.getBoundingBox(!0)),t.setPivotSetFlag(!1),!0)},this.handleSingleTap=function(n){if(n.clientX=n.pointers[0].clientX,n.clientY=n.pointers[0].clientY,e.api.triggerSingleTapCallback(n),n.hasOwnProperty("pointers")&&2===n.pointers.length)return t.setRequestHomeView(!0),!0;if(e.selector){var i=e.clientToViewport(n.canvasX,n.canvasY),r=e.hitTestViewport(i,!1);return r?(e.selector.setSelection([r.dbId],r.model),e.api.triggerSelectionChanged([r.dbId])):(e.selector.clearSelection(),e.api.triggerSelectionChanged(null)),!0}return!1},this.handleDoubleTap=function(t){t.clientX=t.pointers[0].clientX,t.clientY=t.pointers[0].clientY,e.api.triggerDoubleTapCallback(t);var i=this.handleSingleTap(t,0);return n.fitToView(),i},this.handlePressHold=function(t){return"press"===t.type&&(t.clientX=t.pointers[0].clientX,t.clientY=t.pointers[0].clientY,e.api.triggerContextMenu(t))},this.handleGesture=function(t){return!!t.type.includes("swipe")&&(t.clientX=t.pointers[0].clientX,t.clientY=t.pointers[0].clientY,e.api.triggerSwipeCallback(t))}}},49991:(e,t,n)=>{"use strict";n.r(t),n.d(t,{FovTool:()=>r});var i=n(16453);function r(e){var t=.001,n=e.navigation,r=n.getCamera(),o=["fov"],a=!1,s=0,l=null,c=null,u=!1,h=0,d=-5,p=-1,f=d,m=new i.Vector3,g=new i.Vector3,v=new i.Vector3,y=null;function b(e){return e<0&&e>-3?-3:e>0&&e<3?3:e}this.getNames=function(){return o},this.getName=function(){return o[0]},this.activate=function(e){h=0},this.deactivate=function(e){f=d},this.getCursor=function(){return 0!==h&&f===d?null:"url(data:image/x-icon;base64,AAACAAEAGBgAAAAAAACICQAAFgAAACgAAAAYAAAAMAAAAAEAIAAAAAAAYAkAABMLAAATCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAACEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnAwMD/yEhIf8AAABmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAGknJyf/goKC/8/Pz/8aGhr/AAAALQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAABTFBQU/2lpaf/MzMz///////////+Wlpb/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAOAAAAKFTU1P/t7e3////////////8PDw////////////AQEB/wAAAAEAAAAAAAAAFAAAAH0KCgr/AAAAYwAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAjCwsL/6Ghof/t7e3///////Dw8P9MTEz/LS0t//Pz8///////Ghoa/wAAABoAAAANDQ0N/319ff+rq6v/Y2Nj/wAAAK8AAABGAAAA////////////AAAA/wAAAF0hISH/jIyM////////////sLCw/xEREf8AAACHAAAArKysrP//////V1dX/wAAAFcAAABSUlJS//f39///////8PDw/6+vr/86Ojr/LS0t////////////FRUV/1xcXP/Gxsb/+Pj4//Hx8f9MTEz/AAAAsAAAAEcAAAAAAAAAZ2dnZ///////pKSk/wAAAKQAAACtra2t///////////////////////m5ub/kZGR/wAAAP8AAAD/q6ur//Hx8f//////vb29/x0dHf8AAACIAAAAAAAAAAAAAAAAAAAAOjo6Ov//////5+fn/wAAAOcAAADd3d3d////////////////////////////+/v7/9bW1v/i4uL//v7+//Pz8/9hYWH/AAAAvQAAAFQAAAAAAAAAAAAAAAAAAAAAAAAAJycnJ//6+vr//////wMDA/8AAADv7+/v/////////////////////////////////////////////////7y8vP8ODg7/AAAAKwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJiYmJv/6+vr//////wkJCf8AAADv7+/v//////////////////////////////////f39//9/f3//////+np6f+UlJT/GBgY/wAAAH0AAAACAAAAAAAAAAAAAAAAAAAAKSkpKf///////v7+/w0NDf8AAADd3d3d////////////////////////////29vb/39/f/+Xl5f/5+fn////////////5ubm/1RUVP8CAgL/AAAAPwAAAAAAAAAAAAAAOTk5Of//////8PDw/wgICP8AAAChoaGh/////////////////+np6f+YmJj/QkJC/wAAAP8AAAD/UFBQ/7e3t//39/f///////////+oqKj/EBAQ/wAAAIgAAAAAAAAAZ2dnZ///////29vb/wEBAf8AAAA4NTU1/9zc3P/t7e3/tbW1/01NTf8AAACYAAAA////////////AwMD/wsLC/9oaGj/y8vL////////////8fHx/zg4OP8AAACWAAAApaWlpf//////n5+f/wAAAJ8AAAAAAAAAczg4OP9LS0v/EhIS/wAAAE0AAAAAAAAA////////////FRUV/wAAABUAAABoJSUl/4GBgf/i4uL///////////9+fn7/Pz8///b29v//////SkpK/wAAAEoAAAAAAAAAAAAAADgAAABLAAAAEgAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAJQAAAIE8PDz/np6e//z8/P/////////////////8/Pz/CQkJ/wAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAA8DAwM/09PT/+7u7v///////////+QkJD/AAAAkwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////Dw8P/wAAAA8AAAAAAAAAAAAAAAAAAAAAAAAADAAAAFIYGBj/aGho/729vf8WFhb/AAAAJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////FRUV/wAAABUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAQEB/w8PD/8AAABUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////DAwM/wAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8x/h/nO/4fw1D+HwFy/h4BRu4YAHOGEABkAAAAXAAAIFwAAOBnAAHgIAAD4GUAAOB4AABgXAAAIGMAAABtggAAVMYYAHT+HgE7/g8BcP4Pw2/+D+dc/h//XP///2c=), auto"},this.getMotionDelta=function(e){var n=g.x-m.x,i=g.y-m.y,r=g.z-m.z;Math.abs(n)<t&&(n=0),Math.abs(i)<t&&(i=0),Math.abs(r)<t&&(r=0),e.set(n,i,r)},this.stepMotionDelta=function(e,t){t?(m.x+=.6*e.x,m.y+=.6*e.y,m.z+=.6*e.z):m.copy(g)},this.getAccumulatedWheelDelta=function(){var e=Date.now(),t=0;return c&&e-c>100?(t=b(s),s=0,l=null,c=null,u=!1):l&&e-l>100&&(u?Math.abs(s)>=3&&(t=s,s=0):(t=b(s),u=!0,s=0)),t},this.update=function(){var e=!1,t=f>d;if(f>d){this.controller.setIsLocked(!0),this.getMotionDelta(v);var i=v.x,o=v.y,s=v.z;if(0!==i||0!==o||0!==s)if(t=!0,f>=0)o=-o,0!==(s=Math.abs(i)>Math.abs(o)?i:o)&&(s*=-1,n.setVerticalFov(n.getVerticalFov()*(1+s),!0));else{var l=this.getAccumulatedWheelDelta()/3;0!==l&&n.setFocalLength(n.getFocalLength()+l,!0)}this.stepMotionDelta(v,!0),f===p&&Math.abs(s)<1e-5&&(this.interactionEnd(p),e=!0)}return t?this.utilities.pivotActive(n.getPivotSetFlag(),!0):this.utilities.pivotUpdate(),!a&&(e||f>d)&&(f>p&&m.copy(g),f=d,this.controller.setIsLocked(!1)),r.dirty},this.interactionStart=function(e,t){(t||e>f)&&(f=e,a=!0),n.toPerspective()},this.interactionEnd=function(e){e===f&&(e!==p&&this.utilities.pivotActive(!1),a=!1)},this.handleWheelInput=function(e){if(f>p)return!1;n.getReverseZoomDirection()&&(e*=-1),g.z+=e,s+=e;var t=Date.now();return l||(l=t),c=t,0!=e&&this.interactionStart(p),!0},this.handleGesture=function(e){switch(e.type){case"dragstart":return this.handleButtonDown(e,0);case"dragmove":return this.handleMouseMove(e);case"dragend":return this.handleButtonUp(e,0);case"drag3start":return y="drag",this.handleButtonDown(e,0);case"drag3move":return"drag"===y&&this.handleMouseMove(e);case"drag3end":return"drag"===y&&this.handleButtonUp(e,0),y=null,!1}return!1},this.handleButtonDown=function(e,t){return h+=1<<t,2!==t&&(m.x=.5*(e.normalizedX+1),m.y=1-.5*(e.normalizedY+1),g.copy(m),this.interactionStart(t),!0)},this.handleButtonUp=function(e,t){return h-=1<<t,2!==t&&(g.x=.5*(e.normalizedX+1),g.y=1-.5*(e.normalizedY+1),this.interactionEnd(t),!0)},this.handleMouseMove=function(e){return g.x=.5*(e.normalizedX+1),g.y=1-.5*(e.normalizedY+1),f>p},this.handleBlur=function(e){return this.interactionEnd(f),!1}}},33317:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GestureRecognizers:()=>o,GestureHandler:()=>a});var i,r=n(84998);(0,r.isNodeJS)()||(i=n(41145));var o={};function a(e){var t=e.navigation,n=["gestures"],a=this,s=!0,l=!1,c=!0,u=null,h=!1,d=(0,r.isTouchDevice)();t.setIsTouchDevice(d),d&&((u=new i.Manager(e.canvasWrap,{recognizers:[o.drag,o.doubletap,o.doubletap2,o.singletap,o.singletap2,o.press,o.drag3,o.swipe,o.pan,o.pinch,o.rotate],handlePointerEventMouse:!1,inputClass:r.isIE11?i.PointerEventInput:i.TouchInput})).get("pinch").recognizeWith([u.get("drag")]),e.canvasWrap.addEventListener("touchstart",this.onTouchStart,!1)),this.onTouchStart=function(e){e.preventDefault()},this.getNames=function(){return n},this.getName=function(){return n[0]},this.isActive=function(){return h},this.__clientToCanvasCoords=function(t){var n,i,r=e.impl.getCanvasBoundingClientRect(),o=r.width,a=r.height;t.hasOwnProperty("center")?(n=t.center.x-r.left,i=t.center.y-r.top):(n=t.pointers[0].clientX-r.left,i=t.pointers[0].clientY-r.top),t.canvasX=n,t.canvasY=i,t.normalizedX=n/o*2-1,t.normalizedY=(a-i)/a*2-1},this.distributeGesture=function(e){a.__clientToCanvasCoords(e),a.controller.distributeEvent("handleGesture",e)&&e.preventDefault()},this.onSingleTap=function(e){a.__clientToCanvasCoords(e),a.controller.distributeEvent("handleSingleTap",e)&&e.preventDefault()},this.onDoubleTap=function(e){a.__clientToCanvasCoords(e),a.controller.distributeEvent("handleDoubleTap",e)&&e.preventDefault()},this.onPressHold=function(e){a.__clientToCanvasCoords(e),a.controller.distributeEvent("handlePressHold",e)&&e.preventDefault()},this.onHammerInput=function(e){a.setMouseDisabledWhenTouching(e)},this.setMouseDisabledWhenTouching=function(e){e.isFirst&&!l?(s=a.controller.enableMouseButtons(!1),l=!0):e.isFinal&&setTimeout((function(){a.controller.enableMouseButtons(s),l=!1}),10)},this.activate=function(e){u&&!h&&(u.on("dragstart dragmove dragend",this.distributeGesture),u.on("singletap",this.onSingleTap),u.on("singletap2",this.onSingleTap),u.on("doubletap",this.onDoubleTap),u.on("doubletap2",this.onDoubleTap),u.on("press pressup",this.onPressHold),u.on("drag3start drag3move drag3end",this.distributeGesture),u.on("swipeleft swiperight swipeup swipedown",this.distributeGesture),c&&(u.on("panstart panmove panend",this.distributeGesture),u.on("pinchstart pinchmove pinchend",this.distributeGesture),u.on("rotatestart rotatemove rotateend",this.distributeGesture)),u.on("hammer.input",this.onHammerInput),u.get("doubletap2").recognizeWith("doubletap"),u.get("singletap2").recognizeWith("singletap"),u.get("singletap").requireFailure("doubletap"),u.get("swipe").recognizeWith("drag")),h=!0},this.deactivate=function(e){u&&h&&(u.off("dragstart dragmove dragend",this.distributeGesture),u.off("singletap",this.onSingleTap),u.off("singletap2",this.onSingleTap),u.off("doubletap",this.onDoubleTap),u.off("doubletap2",this.onDoubleTap),u.off("press pressup",this.onPressHold),u.off("drag3start drag3move drag3end",this.distributeGesture),u.off("swipeleft swiperight swipeup swipedown",this.distributeGesture),c&&(u.off("panstart panmove panend",this.distributeGesture),u.off("pinchstart pinchmove pinchend",this.distributeGesture),u.off("rotatestart rotatemove rotateend",this.distributeGesture)),u.off("hammer.input",this.onHammerInput)),h=!1},this.update=function(){return!1},this.handleBlur=function(e){return!1},this.disableTwoFingerSwipe=function(){c=!1,u&&(u.remove(i.Pan),u.remove(i.Pinch),u.remove(i.Rotate),u.off("panstart panmove panend",this.distributeGesture),u.off("pinchstart pinchmove pinchend",this.distributeGesture),u.off("rotatestart rotatemove rotateend",this.distributeGesture))},this.setGestureParameter=function(e,t,n){var i=u&&u.get(e);return!!i&&(i.options[t]=n,!0)},this.restoreGestureParameterDefault=function(e,t){var n=u&&u.get(e);if(!n)return!1;var i=o[e][1];return n.options[t]=i.hasOwnProperty(t)?i[t]:n.defaults[t],!0}}i&&function(){if(!o.singletap){var e=o;e.singletap=[i.Tap,{event:"singletap",threshold:7,time:400}],e.singletap2=[i.Tap,{event:"singletap2",pointers:2,threshold:7,time:400}],e.press=[i.Press,{event:"press",time:500,threshold:50}],e.doubletap=[i.Tap,{event:"doubletap",taps:2,interval:300,threshold:6,posThreshold:30}],e.doubletap2=[i.Tap,{event:"doubletap2",pointers:2,taps:2,interval:300,threshold:6,posThreshold:40}],e.swipe=[i.Swipe,{event:"swipe",pointers:1,threshold:200,velocity:1.7}],e.drag=[i.Pan,{event:"drag",pointers:1}],e.drag3=[i.Pan,{event:"drag3",pointers:3,threshold:15}],e.pan=[i.Pan,{event:"pan",pointers:2,threshold:20}],e.pinch=[i.Pinch,{event:"pinch",pointers:2,enable:!0,threshold:.05}],e.rotate=[i.Rotate,{event:"rotate",pointers:2,enable:!0,threshold:7}]}}()},42024:(e,t,n)=>{"use strict";function i(e){var t=["hottouch"],n={SHIFT:0,ALT:0,CONTROL:0},i=null,r=null,o=!1,a=!1,s=null,l=16,c=17,u=18;this.active=!1,this.getNames=function(){return t},this.getName=function(){return t[0]},this.activate=function(e){this.active=!0},this.deactivate=function(e){this.active=!1},this.isActive=function(){return this.active},this.__checkStart=function(){s&&(this.controller.distributeEvent("handleGesture",s),s=null)},this.update=function(){if(this.controller.getIsLocked())return!1;var t=e.getActiveNavigationTool(),n=!1===o&&!0===a;if(n||!0===o&&!1===a){var s=n?"worldup":"fov";if(t===s)return!1;if(t===i)return e.setActiveNavigationTool(s),i=s,this.__checkStart(),!1;r=t,e.setActiveNavigationTool(s),i=s,this.__checkStart()}else i&&(e.setActiveNavigationTool(r),i=null,r=null);return!1},this.resetKeys=function(){n.SHIFT=0,n.CONTROL=0,n.ALT=0},this.updateModifierState=function(e){n.CONTROL=e.ctrlKey?1:0,n.SHIFT=e.shiftKey?1:0,n.ALT=e.altKey?1:0},this.handleGesture=function(t){if(t===s)return!1;switch(t.type){case"drag3start":e.navigation.isActionEnabled("fov")&&(s=t,o=!0);break;case"drag3move":case"rotatemove":break;case"drag3end":o=!1;break;case"rotatestart":e.navigation.isActionEnabled("roll")&&(s=t,a=!0);break;case"rotateend":a=!1}return!1},this.handleKeyDown=function(e,t){switch(this.updateModifierState(e),t){case l:n.SHIFT=1;break;case c:n.CONTROL=1;break;case u:n.ALT=1}return!1},this.handleKeyUp=function(e,t){switch(this.updateModifierState(e),t){case l:n.SHIFT=0;break;case c:n.CONTROL=0;break;case u:n.ALT=0}return!1},this.handleButtonDown=function(e,t){return this.updateModifierState(e),!1},this.handleButtonUp=function(e,t){return this.updateModifierState(e),!1},this.handleMouseMove=function(e){return this.updateModifierState(e),!1},this.handleBlur=function(e){return this.resetKeys(),!1}}n.r(t),n.d(t,{HotGestureTool:()=>i})},3260:(e,t,n)=>{"use strict";function i(){var e=[],t=[],n=[],i=[],r=["hotkeys"];function o(e,t){return e-t}function a(){var e,r=t.join();for(e=0;e<i.length;)i[e].keys===r?i.splice(e,1):e++;for(e=0;e<n.length;)n[e].keys!==r?n.splice(e,1):e++}function s(r,o){var s=t.join(),l=t.slice(0),c=t.indexOf(o);c>-1&&t.splice(c,1);var u=t.join(),h=t.slice(0);a();var d,p=[],f=[];for(c=e.length-1;c>=0;c--)(d=e[c]).keys===s&&d.onRelease?p.unshift(d):d.keys===u&&d.onPress&&f.unshift(d);for(c=p.length-1;c>=0&&!(d=p[c]).onRelease(l);c--)d.options.tryUntilSuccess&&i.unshift(d);for(c=f.length-1;c>=0&&!(d=f[c]).onPress(h);c--)d.options.tryUntilSuccess&&n.unshift(d)}return{pushHotkeys:function(t,n,i){if(e.some((function(e){return e.id===t})))return!1;for(var r=0;r<n.length;r++)e.push({id:t,keys:n[r].keycodes.sort(o).join(),onPress:n[r].onPress,onRelease:n[r].onRelease,options:i||{}});return!0},popHotkeys:function(t){for(var n=!1,i=e.length-1;i>=0;i--)e[i].id===t&&(e.splice(i,1),n=!0);return n},handleKeyDown:function(r,o){if(-1===t.indexOf(o)){for(var s=t.join(),l=t.slice(0),c=0;c<t.length&&t[c]<o;)c++;t.splice(c,0,o);var u=t.join(),h=t.slice(0);a();var d,p=[],f=[];for(c=e.length-1;c>=0;c--)(d=e[c]).keys===s&&d.onRelease?p.unshift(d):d.keys===u&&d.onPress&&f.unshift(d);for(c=p.length-1;c>=0&&!(d=p[c]).onRelease(l);c--)d.options.tryUntilSuccess&&i.unshift(d);for(c=f.length-1;c>=0&&!(d=f[c]).onPress(h);c--)d.options.tryUntilSuccess&&n.unshift(d)}},handleKeyUp:s,handleBlur:function(){for(var e=t.length-1;e>=0;e--)s(0,t[e])},getName:function(){return r[0]},getNames:function(){return r},activate:function(){},deactivate:function(){},update:function(){var e,t;for(t=0;t<i.length;)!0===(e=i[t]).onRelease(e.keys.split())?i.splice(t,1):t++;for(t=0;t<n.length;)!0===(e=n[t]).onPress(e.keys.split())?n.splice(t,1):t++;return!1}}}n.r(t),n.d(t,{HotkeyManager:()=>i})},9487:(e,t,n)=>{"use strict";n.r(t),n.d(t,{KeyCode:()=>i});var i={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,ZERO:48,SEMICOLONMOZ:59,EQUALSMOZ:61,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,LCOMMAND:91,RCOMMAND:93,PLUS:107,PLUSMOZ:171,DASHMOZ:109,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,DASHMOZNEW:173,SEMICOLON:186,EQUALS:187,COMMA:188,DASH:189,PERIOD:190,SLASH:191,LBRACKET:219,RBRACKET:221,SINGLEQUOTE:222,COMMANDMOZ:224}},10831:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Navigation:()=>s});var i=n(16453),r=n(98926),o=n(62546),a={TRANSITION_ACTIVE_FLAG_CHANGED:"transitionActiveFlagChanged"};function s(e){var t=6.88,n=1e-6;this.__options={dollyToPivot:!1,orbitPastPoles:!0,reverseDolly:!1,reverseHorizontalLook:!1,reverseVerticalLook:!1,useLeftHandedInput:!1,usePivotAlways:!1,lockNavigation:!1},this.__lockSettings={orbit:!1,pan:!1,zoom:!1,roll:!1,fov:!1,gotoview:!1,walk:!1},this.FIT_TO_VIEW_VERTICAL_MARGIN=.05,this.FIT_TO_VIEW_VERTICAL_OFFSET=0,this.FIT_TO_VIEW_HORIZONTAL_MARGIN=.05,this.FIT_TO_VIEW_HORIZONTAL_OFFSET=0,this.__pivotIsSetFlag=!1,this.__fitToViewRequested=!1,this.__homeViewRequested=!1,this.__transitionActive=!1,this.__destinationView=null,this.__is2D=!1,this.__isTouchDevice=!1,this.__kEpsilon=n,this.__minDistance=1e-5;var r=void 0,o=void 0,a=2,s=200,l=null,c={left:0,top:0,width:1,height:1},u=Number.MAX_VALUE;this.uninitialize=function(){this.setCamera(null)},this.setMinimumLineWidth=function(e){u=e||Number.MAX_VALUE},this.setCamera=function(e){e!==l&&(l=e,e&&(Object.prototype.hasOwnProperty.call(e,"target")||(e.target=new i.Vector3(0,0,0)),Object.prototype.hasOwnProperty.call(e,"pivot")||(e.pivot=new i.Vector3(0,0,0)),e.worldup=e.up.clone(),e.dirty=!0))},this.getCamera=function(){return l},this.setScreenViewport=function(e){c=e},this.getScreenViewport=function(){return c},this.__setUp=function(e){if(e&&l&&0!==e.clone().normalize().sub(l.worldup).lengthSq())return l.worldup.copy(e).normalize(),l.dirty=!0,!0;return!1},this.__getUp=function(){return l?l.worldup:new i.Vector3(0,1,0)},this.setView=function(e,t){l&&e&&t&&(l.position.copy(e),l.target.copy(t),l.dirty=!0)},this.orientCameraUp=function(e){l&&(this.isActionEnabled("roll")||e)&&(l.up.copy(this.getAlignedUpVector()),l.dirty=!0)},this.getPivotPoint=function(){return l?l.pivot.clone():new i.Vector3(0,0,0)},this.setPivotPoint=function(e){l&&e&&l.pivot.copy(e)},this.getPosition=function(){return l?l.position.clone():new i.Vector3(0,0,1)},this.setPosition=function(e){l&&e&&(l.position.copy(e),l.dirty=!0)},this.setTarget=function(e){l&&e&&(l.target.copy(e),l.dirty=!0)},this.getTarget=function(){return l?l.target.clone():new i.Vector3(0,0,0)},this.getEyeVector=function(){return l?l.target.clone().sub(l.position):new i.Vector3(0,0,-1)},this.getEyeToCenterOfBoundsVec=function(e){return l?e.getCenter(new i.Vector3).sub(l.position):new i.Vector3(0,0,-1)},this.getFovMin=function(){return t},this.getFovMax=function(){return 100},this.setZoomInLimitFactor=function(e){s=e},this.getZoomInLimitFactor=function(){return s},this.setZoomOutLimitFactor=function(e){a=e},this.getZoomOutLimitFactor=function(){return a},this.isPointVisible=function(e){return(new i.Frustum).setFromProjectionMatrix(l.projectionMatrix.clone().multiply(l.matrixWorldInverse)).containsPoint(e)},this.setVerticalFov=function(e,r){if((!l||l.isPerspective)&&(e<t?e=t:e>100&&(e=100),l&&this.isActionEnabled("fov"))){if(Math.abs(l.fov-e)<=n)return;if(r){var o=this.__pivotIsSetFlag&&this.isPointVisible(this.getPivotPoint()),a=this.getPosition(),s=this.getEyeVector(),c=i.Math.degToRad(l.fov),u=i.Math.degToRad(e),h=o?this.getPivotPlaneDistance():s.length(),d=h*Math.tan(.5*c)/Math.tan(.5*u),p=s.normalize().multiplyScalar(h-d);this.setPosition(a.add(p)),o&&this.setTarget(this.getTarget().add(p))}l.setFov(e),l.dirty=!0}},this.applyRotation=function(e,t,n,i){e.sub(n),e.applyAxisAngle(i,t),e.add(n)},this.getSignedAngle=function(e,t,n){var i=e.angleTo(t),r=e.clone().cross(t).normalize();return i*(n.dot(r)>0?1:-1)},this.computeFit=function(t,n,r,o,a){if(!o||o.isEmpty())return{position:t,target:n};a=void 0===a?1:a;for(var s=o.getCenter(new i.Vector3),l=o.getSize(new i.Vector3),c=t.clone().sub(n).normalize(),u=Math.tan(i.Math.degToRad(.5*r)),h=0,d=this.computeOrthogonalUp(t,n),p=c.clone().cross(d).normalize(),f=new i.Vector3,m=0===l.z?4:8,g=0;g<m;g++){f.set(0==(1&g)?-.5*l.x:.5*l.x,0==(2&g)?-.5*l.y:.5*l.y,0==(4&g)?-.5*l.z:.5*l.z);var v=0;e.isPerspective&&(v=f.dot(c));var y=Math.abs(f.dot(d)),b=Math.abs(f.dot(p)),_=v+(1+2*this.FIT_TO_VIEW_VERTICAL_MARGIN/(1-2*this.FIT_TO_VIEW_VERTICAL_MARGIN))*y/u;h<_&&(h=_),h<(_=v+(1+2*this.FIT_TO_VIEW_HORIZONTAL_MARGIN/(1-2*this.FIT_TO_VIEW_HORIZONTAL_MARGIN))*b/(a*u))&&(h=_)}return s.add(d.multiplyScalar(-h*this.FIT_TO_VIEW_VERTICAL_OFFSET)),s.add(p.multiplyScalar(h*this.FIT_TO_VIEW_HORIZONTAL_OFFSET)),c.multiplyScalar(h),{position:s.clone().add(c),target:s}},this.computeOrthogonalUp=function(e,t){var n=this.__getUp(),i=t.clone().sub(e);if(0===i.lengthSq())return i.copy(n);var r=i.clone().cross(n);return 0===r.lengthSq()&&(n.z>n.y?i.y-=1e-4:i.z-=1e-4,r.crossVectors(i,n)),r.cross(i).normalize()},this.fitBounds=function(e,t,n,i){var r=this.getTarget(),o=this.getPosition();if(!this.isActionEnabled("gotoview")&&!i||!t||t.isEmpty())return{position:o,target:r};var a=this.getVerticalFov();n||(t=this.rotateBoundsToCamera(t,o,r));var s=this.computeFit(o,r,a,t,l.aspect),c=n?this.computeOrthogonalUp(o,r):l.up;return e?(l.up.copy(c),this.setView(s.position,s.target)):this.setRequestTransitionWithUp(!0,s.position,s.target,a,c),this.setPivotPoint(s.target),this.setPivotSetFlag(!0),s},this.rotateBoundsToCamera=function(e,t,n){var r=(e=e.clone()).getCenter(new i.Vector3),o=t.clone().sub(n).normalize(),a=this.getSignedAngle(this.getCameraUpVector(),this.getAlignedUpVector(),o);return this.applyRotation(e.min,a,r,o),this.applyRotation(e.max,a,r,o),e.setFromPoints([e.min.clone(),e.max.clone()]),e},this.computeOverviewDistance=function(e){var t=e.getSize(new i.Vector3);if(this.__is2D){var n=l.aspect,r=t.x/n,o=t.y;return Math.max(r,o)}var a=this.getVerticalFov(),s=t.length();return 0===s&&(s=2),l.isPerspective?.5*s/Math.tan(i.Math.degToRad(.5*a)):s},this.applyDollyConstraint=function(e,t){if(!(r||o||a)||!this.__is2D)return e;var n=e;if(r&&a&&t&&e>1){var i,c=l.isPerspective?this.getEyeToCenterOfBoundsVec(t):this.getEyeVector();i=r?a*this.computeOverviewDistance(r):a*this.computeOverviewDistance(t);var h=Math.abs(i/c.length());h=Math.max(h,1),n=Math.min(n,h)}if(o||s&&t){var d=(o?l.clientHeight/o:Math.min(u,this.computeOverviewDistance(t)/s))/-this.getEyeVector().z;d=Math.min(d,1),n=Math.max(n,d)}return n},this.applyPanningConstraint2D=function(e){if(this.__is2D&&r){var t=l.position.x+e.x,n=l.position.y+e.y;t=i.Math.clamp(t,r.min.x,r.max.x),n=i.Math.clamp(n,r.min.y,r.max.y);var o=t-l.position.x,a=n-l.position.y,s=Math.min(e.x,0),c=Math.min(e.y,0),u=Math.max(e.x,0),h=Math.max(e.y,0);o=i.Math.clamp(o,s,u),a=i.Math.clamp(a,c,h),e.x=o,e.y=a}},this.updateCamera=function(){l&&(l.updateProjectionMatrix(),this.orient(l,l.target,l.position,l.up),l.dirty=!1)},this.setCamera(e),this.setConstraints2D=function(e,t){r=e,o=t}}s.prototype.constructor=s,s.prototype.setIs2D=function(e){this.__is2D=!!e},s.prototype.getIs2D=function(){return this.__is2D},s.prototype.setIsTouchDevice=function(e){this.__isTouchDevice=!!e},s.prototype.getIsTouchDevice=function(){return this.__isTouchDevice},s.prototype.orient=function(){var e,t,n,r;return function(o,a,s,l){e||(e=new i.Matrix4,t=new i.Vector3,n=new i.Vector3,r=new i.Vector3);var c=e.elements;r.subVectors(s,a).normalize(),0===r.lengthSq()&&(r.z=1),t.crossVectors(l,r).normalize(),0===t.lengthSq()&&(l.z>l.y?r.y-=1e-4:r.z+=1e-4,t.crossVectors(l,r).normalize()),n.crossVectors(r,t),c[0]=t.x,c[4]=n.x,c[8]=r.x,c[1]=t.y,c[5]=n.y,c[9]=r.y,c[2]=t.z,c[6]=n.z,c[10]=r.z,o.setRotationFromMatrix(e)}}(),s.prototype.fov2fl=function(e){var t=i.Math.degToRad(e);return t<=0&&(t=1e-4),Math.round(12/Math.tan(.5*t))},s.prototype.fl2fov=function(e){e<=0&&(e=1e-4);var t=2*Math.atan(12/e);return i.Math.radToDeg(t)},s.prototype.setCameraUpVector=function(e){if(this.isActionEnabled("roll")){var t=this.getCamera();t.up.copy(e),t.dirty=!0}},s.prototype.getCameraUpVector=function(){var e=this.getCameraRightVector(!1),t=this.getEyeVector();return e.cross(t).normalize()},s.prototype.getAlignedUpVector=function(){var e=this.getCameraRightVector(!0),t=this.getEyeVector();return e.cross(t).normalize()},s.prototype.getCameraRightVector=function(e){var t=new i.Vector3,n=e?this.getWorldUpVector():this.getCamera().up,r=this.getEyeVector();return t.crossVectors(r,n),0===t.lengthSq()&&(Math.abs(r.z)>=Math.abs(r.y)?n.set(0,1,0):n.set(0,0,1),t.crossVectors(r,n)),t.normalize()},s.prototype.setWorldUpVector=function(e,t,n){(this.isActionEnabled("roll")||n)&&(this.__setUp(e),t&&this.orientCameraUp(n))},s.prototype.getWorldUpVector=function(){return this.__getUp().clone()},s.prototype.getWorldRightVector=function(){var e=new i.Vector3;return e.copy(this.__getUp()),Math.abs(e.z)<=Math.abs(e.y)?e.set(e.y,-e.x,0):e.z>=0?e.set(e.z,0,-e.x):e.set(-e.z,0,e.x),e.normalize()},s.prototype.getVerticalFov=function(){return this.getCamera().fov},s.prototype.getHorizontalFov=function(){var e=this.getScreenViewport();return this.getCamera().fov*(e.width/e.height)},s.prototype.getFocalLength=function(){return this.fov2fl(this.getVerticalFov())},s.prototype.setFocalLength=function(e,t){this.setVerticalFov(this.fl2fov(e),t)},s.prototype.setReverseZoomDirection=function(e){this.__options.reverseDolly=!!e},s.prototype.setReverseHorizontalLookDirection=function(e){this.getIs2D()?r.logger.warn("Autodesk.Viewing.Navigation.setReverseHorizontalLookDirection is not applicable to 2D"):this.__options.reverseHorizontalLookDirection=!!e},s.prototype.setReverseVerticalLookDirection=function(e){this.getIs2D()?r.logger.warn("Autodesk.Viewing.Navigation.setReverseVerticalLookDirection is not applicable to 2D"):this.__options.reverseVerticalLookDirection=!!e},s.prototype.getReverseZoomDirection=function(){return this.__options.reverseDolly},s.prototype.getReverseHorizontalLookDirection=function(){return this.getIs2D()?(r.logger.warn("Autodesk.Viewing.Navigation.getReverseHorizontalLookDirection is not applicable to 2D"),!1):this.__options.reverseHorizontalLookDirection},s.prototype.getReverseVerticalLookDirection=function(){return this.getIs2D()?(r.logger.warn("Autodesk.Viewing.Navigation.getReverseVerticalLookDirection is not applicable to 2D"),!1):this.__options.reverseVerticalLookDirection},s.prototype.setZoomTowardsPivot=function(e){this.__options.dollyToPivot=!!e},s.prototype.getZoomTowardsPivot=function(){return this.__options.dollyToPivot},s.prototype.setOrbitPastWorldPoles=function(e){this.getIs2D()?r.logger.warn("Autodesk.Viewing.Navigation.setOrbitPastWorldPoles is not applicable to 2D"):this.__options.orbitPastPoles=!!e},s.prototype.getOrbitPastWorldPoles=function(){return this.getIs2D()?(r.logger.warn("Autodesk.Viewing.Navigation.orbitPastWorldPoles is not applicable to 2D"),!1):this.__options.orbitPastPoles},s.prototype.setUsePivotAlways=function(e){this.__options.usePivotAlways=!!e},s.prototype.getUsePivotAlways=function(){return this.__options.usePivotAlways},s.prototype.setUseLeftHandedInput=function(e){this.__options.useLeftHandedInput=!!e},s.prototype.getUseLeftHandedInput=function(){return this.__options.useLeftHandedInput},s.prototype.setWheelSetsPivot=function(e){this.__options.wheelSetsPivot=!!e},s.prototype.getWheelSetsPivot=function(){return this.__options.wheelSetsPivot},s.prototype.setSelectionSetsPivot=function(e){this.__options.SelectionSetsPivot=!!e},s.prototype.getSelectionSetsPivot=function(){return this.__options.SelectionSetsPivot},s.prototype.setIsLocked=function(e){this.__options.lockNavigation=!!e},s.prototype.getIsLocked=function(){return this.__options.lockNavigation},s.prototype.setLockSettings=function(e){for(var t in this.__lockSettings)Object.prototype.hasOwnProperty.call(e,t)&&(this.__lockSettings[t]=e[t])},s.prototype.getLockSettings=function(){var e={};for(var t in this.__lockSettings)e[t]=this.__lockSettings[t];return e},s.prototype.isActionEnabled=function(e){return!this.__options.lockNavigation||!0===this.__lockSettings[e]},s.prototype.setPivotSetFlag=function(e){this.__pivotIsSetFlag=!!e},s.prototype.getPivotSetFlag=function(){return this.__pivotIsSetFlag},s.prototype.setRequestFitToView=function(e){this.isActionEnabled("gotoview")&&(this.__fitToViewRequested=!!e)},s.prototype.getRequestFitToView=function(){return this.__fitToViewRequested},s.prototype.setRequestHomeView=function(e){this.isActionEnabled("gotoview")&&(this.__homeViewRequested=!!e)},s.prototype.getRequestHomeView=function(){return this.__homeViewRequested},s.prototype.setRequestTransition=function(e,t,n,i,r,o){this.__destinationView=e?{position:t.clone(),coi:n.clone(),fov:i,up:this.getCamera().up.clone(),worldUp:this.getWorldUpVector(),reorient:r,pivot:o?o.clone():n.clone()}:null},s.prototype.setRequestTransitionWithUp=function(e,t,n,i,r,o,a){this.__destinationView=e?{position:t.clone(),coi:n.clone(),fov:i,up:r.clone(),worldUp:o||this.getWorldUpVector(),reorient:!1,pivot:a?a.clone():n.clone()}:null},s.prototype.getRequestTransition=function(){return this.__destinationView},s.prototype.setTransitionActive=function(e){var t=this.__transitionActive!=e;this.__transitionActive=!!e,t&&this.fireEvent({type:a.TRANSITION_ACTIVE_FLAG_CHANGED,transitionActive:!!e})},s.prototype.getTransitionActive=function(){return this.__transitionActive},s.prototype.getWorldSize=function(e){var t=this.getCamera(),n=t.aspect,r=2*e*Math.tan(i.Math.degToRad(.5*t.fov)),o=r*n;return new i.Vector2(o,r)},s.prototype.screenToViewport=function(e,t){return e=2*e-1,t=2*(t=1-t)-1,new i.Vector3(e,t,1)},s.prototype.viewportToScreen=function(e,t){return e=(e+1)/2,t=1-(t=(t+1)/2),new i.Vector2(e,t)},s.prototype.getWorldPoint=function(e,t){var n=this.screenToViewport(e,t);e=n.x,t=n.y;var r,o=this.getCamera();o.isPerspective&&(r=(r=new i.Vector3(e,t,1)).unproject(o));var a,s,l=this.getEyeVector(),c=this.getPosition();if(!o.isPerspective||isNaN(r.x)){var u=this.getWorldSize(l.length()),h=this.getCameraRightVector(!1).multiplyScalar(.5*e*u.x),d=this.getCameraUpVector().multiplyScalar(.5*t*u.y);a=l.clone().add(h).add(d).normalize()}else a=r.sub(c).normalize();var p=this.getPivotPoint(),f=a.dot(l);return s=this.__pivotIsSetFlag&&(this.getIs2D()||o.isPerspective&&f>0)?0!==f?Math.abs(p.sub(c).dot(l))/f:p.sub(c).length():o.isPerspective?.5*(o.near+o.far):o.orthoScale,a.multiplyScalar(s).add(c)},s.prototype.getPivotPlaneDistance=function(){var e=this.getPivotPoint(),t=this.getEyeVector(),n=this.getPosition();return e.sub(n).dot(t.normalize())},s.prototype.panRelative=function(e,t,n){if(this.isActionEnabled("pan")){var i=this.getScreenViewport(),r=this.getCamera(),o=this.getWorldSize(n),a=e*o.x*i.width/r.clientWidth,s=t*o.y*i.height/r.clientHeight,l=this.getCameraRightVector(!1).multiplyScalar(a),c=this.getCameraUpVector().multiplyScalar(s),u=l.add(c);this.applyPanningConstraint2D(u),this.setView(this.getPosition().add(u),this.getTarget().add(u))}},s.prototype.dollyFromPoint=function(e,t,n){if(this.isActionEnabled("zoom")&&!(Math.abs(e)<=this.__kEpsilon)){var i=this.getPosition(),r=this.getEyeVector();if(!this.getCamera().isPerspective){var o=r.lengthSq(),a=r.dot(this.getTarget().sub(t));t=r.clone().multiplyScalar(a/o).add(t)}var s=t.clone().sub(i),l=s.length(),c=l+e;c<this.__minDistance&&(c=this.__minDistance);var u=c/l;if(u=this.applyDollyConstraint(u,n),Math.abs(u-1)>this.__kEpsilon){s.multiplyScalar(u),s.set(-s.x,-s.y,-s.z);var h=s.add(t);r=this.getEyeVector(),this.getCamera().isPerspective||r.multiplyScalar(u),this.setView(h,r.add(h))}}},s.prototype.toPerspective=function(){if(this.getIs2D())r.logger.warn("Autodesk.Viewing.Navigation.toPerspective is not applicable to 2D");else{var e=this.getCamera();e.isPerspective||(e.toPerspective(),e.dirty=!0)}},s.prototype.toOrthographic=function(){var e=this.getCamera();e.isPerspective&&(e.toOrthographic(),e.dirty=!0)},s.snapToAxis=function(e){var t=new i.Vector3(Math.abs(e.x),Math.abs(e.y),Math.abs(e.z));return t.x>t.y&&t.x>t.z?e.set(e.x>0?1:-1,0,0):t.y>t.x&&t.y>t.z?e.set(0,e.y>0?1:-1,0):e.set(0,0,e.z>0?1:-1),e},o.EventDispatcher.prototype.apply(s.prototype),s.Events=a},80401:(e,t,n)=>{"use strict";n.r(t),n.d(t,{OrbitDollyPanTool:()=>a});var i=n(37169),r=n(35449),o=n(55412);function a(e,t,n){var r=this;this.setGlobalManager(t.globalManager);var a,s,l=this,c=.001,u=.01,h=n&&n.hasOwnProperty("dollyDragScale")?n.dollyDragScale:100,d=-1!=navigator.userAgent.search("Mac OS"),p=n&&n.disablePinchRotation,f=t.navigation,m=f.getCamera(),g=["orbit","freeorbit","dolly","pan"],v=g[0],y=[v],b=v,_=null,x=1,E=0,w=0,S=0,A=0,M=!0,T=!1,C=null,P=!1,L=33,R=34,D=37,I=38,O=39,N=40,k=48,F=187,U=189,B=-4,V=-1,G=-5,z=new THREE.Vector3,H=new THREE.Vector3,W=new THREE.Vector2,j=new THREE.Vector2,q=new THREE.Vector2,X=new THREE.Vector2,Y=new THREE.Vector3,K=new THREE.Vector3,Z=new THREE.Vector3,J=new THREE.Vector3,Q=new THREE.Vector3,$=new THREE.Vector3,ee=new THREE.Vector3,te=new THREE.Vector3,ne=new THREE.Vector3,ie=new THREE.Quaternion,re=new THREE.Plane,oe=[!1,!1,!1,!1,!1,!1],ae={SHIFT:0,ALT:0,CONTROL:0,SPACE:0};this.active=!1;var se,le=function(t){e.renderer().rolloverObjectId(0,null,0)},ce=.01,ue=n&&n.hasOwnProperty("dollyScrollScale")?n.dollyScrollScale:.6,he=1,de=5,pe=.025;function fe(e,t){var n=l.getWindow(),i=0,r=0,o=n.innerWidth,a=n.innerHeight;te.set((e-.5*o-i)/(.5*o),(.5*a+r-t)/(.5*a),0);var s=te.length();return s>1?te.normalize():te.z=Math.sqrt(1-s*s),J.copy(m.position).sub(m.pivot),$.copy(m.up).setLength(te.y),$.add(ee.copy(m.up).cross(J).setLength(te.x)),$.add(J.setLength(te.z)),$}this.getNames=function(){return g},this.getName=function(){return g[0]},this.activate=function(n){this.active=!0,y.push(n),b=n,M=t.prefs.get(o.Prefs3D.ENABLE_CUSTOM_ORBIT_TOOL_CURSOR),t.prefs.addListeners(o.Prefs3D.ENABLE_CUSTOM_ORBIT_TOOL_CURSOR,this._onPrefCursor),e.canvas.addEventListener("mouseout",le),t.addEventListener(i.ESCAPE_EVENT,this.handleBlur)},this.deactivate=function(n){this.active=!1,t.prefs.removeListeners(o.Prefs3D.ENABLE_CUSTOM_ORBIT_TOOL_CURSOR,this._onPrefCursor);var r=y.length-1;r>0&&y[r]===n&&(y.pop(),b=y[r-1]),e.canvas.removeEventListener("mouseout",le),t.removeEventListener(i.ESCAPE_EVENT,this.handleBlur)},this.isActive=function(){return this.active},this.adjustDollyLookSpeed=function(e){0===e?(pe=.025,de=5):((pe*=e>0?1.1:.9)<1e-6&&(pe=1e-6),(de*=e>0?1.1:.9)<1e-6&&(de=1e-6))},this.getDollySpeed=function(e,t){var n;if(!f.getZoomTowardsPivot()&&!f.getWheelSetsPivot()||m.isPerspective||f.getIs2D()){var i=f.getEyeVector(),r=f.getPosition();o=e.clone().sub(r).dot(i.normalize())*pe;n=Math.abs(o)<ce?o<0?-.01:ce:o}else{var o=m.orthoScale*pe;n=Math.abs(o)<5e-4&&t?0:o}return n},this.setPivotPointFromInput=function(t,n){if(!f.getIs2D()&&f.getWheelSetsPivot()){var i=e.hitTest(t,n,!0);if(i&&i.intersectPoint)this.utilities.setPivotPoint(i.intersectPoint,!0,!0);else{var r=f.getPivotPoint(),o=f.getEyeVector().normalize(),a=-r.dot(o);re.set(o,a);var s=e.viewportToRay(e.clientToViewport(t,n)).intersectPlane(re);this.utilities.setPivotPoint(s,!0,!0)}}},this.getDollyScrollScale=function(){return ue},this.setDollyScrollScale=function(e){ue=e},this.getDollyDragScale=function(){return h},this.setDollyDragScale=function(e){h=e},this.getLookSpeed=function(){return de},this.coiIsActive=function(){return f.getPivotSetFlag()&&f.isPointVisible(f.getPivotPoint())},this.adjustSpeed=function(e){this.adjustDollyLookSpeed(e),this.utilities.autocam&&(this.utilities.autocam.orbitMultiplier=this.getLookSpeed())},this.getTriggeredMode=function(){return 1===G&&ae.SHIFT?y[1]:(e=ae,2===G&&e.SHIFT&&!e.ALT&&!e.CONTROL||2===G&&e.ALT&&!e.SHIFT&&!e.CONTROL||"dolly"===b&&!e.ALT&&"pinch"!==_||0!==Y.z?function(){var e=ae;return!(e.CONTROL||e.ALT||e.SHIFT||2!==G&&1!==G)}()?"pan":"dolly":function(){var e=ae;return 2===G&&!e.SHIFT&&!(e.ALT^e.CONTROL)||2===G&&e.SHIFT&&e.CONTROL||1===G&&!e.SHIFT&&!e.CONTROL||1===G&&e.ALT||1===G&&e.CONTROL&&!e.ALT||0===G&&e.SHIFT&&!e.CONTROL&&!e.ALT||"pan"===b&&1!==G&&!e.ALT&&!("pinch"===_)||e.SPACE}()?"pan":"pan"===_||"pinch"===_?"dollypan":b);var e},this.initTracking=function(e,t){var n;if(m.isPerspective){n=.5*(m.near+m.far);var i=this.utilities.getHitPoint(e,t),r=f.getPosition();if(i&&i.sub){var o=i.sub(r),a=f.getEyeVector().normalize();n=Math.abs(a.dot(o))}else{if(f.getPivotSetFlag()&&f.isPointVisible(f.getPivotPoint())){var s=f.getPivotPlaneDistance();s>.01&&(n=s)}}}else n=f.getEyeVector().length();he=n},this.initOrbit=function(){this.utilities.setTemporaryPivot(m.isPerspective&&f.getPivotPoint().sub(f.getPosition()).dot(f.getEyeVector())<=0?f.getTarget():null)},this.getActiveMode=function(){return v},this.getCursor=function(){if(!M)return null;switch(v){case"freeorbit":case"orbit":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAt1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8AAAAzMzP6+vri4uISEhKKioqtra2dnZ2EhIR9fX10dHRkZGQdHR3t7e3Hx8e5ubm1tbWoqKhWVlZKSko4ODgICAjv7+/o6OjMzMyxsbFOTk4pKSkXFxcEBAT29vbW1tZ6enpISEgLCwvhzeX+AAAAGXRSTlMANRO0nHRJHfnskIxQRKh89syDVwTWZjEJxPFEswAAAOFJREFUKM+1j+lygkAQhIflEAJe0Rw9u4CCeKKoSTTX+z9XoMJWWeX+ssrvZ3f19DQ5zOw/0DUMQPlmQ72bE2adBp8/Rp3CQUi3ILx+bxj4fjDs9T1Bmo6bbPPN8aDU4bjJt4nb+de789kSFyxn826jW3ICLNZZKU8nWWbrBTCRVm04U8TpjquRFf1Go0d7l8aYOrUR7FGEFr1S9LGymwthgX2gE/Kl0cHPOtF2xOWZ5QpIC93RflW4InkDoPRXesd5LJIMQPzV7tCMa7f6BvhJL79AVDmYTNQ1NhnxbI/uwB8H5Bjd4zQPBAAAAABJRU5ErkJggg==), auto";case"dolly":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAgVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8mJiYAAADNzc2/v7+fn59paWlPT08MDAwICAj6+vqpqak7Ozv29vby8vLp6em2traAgIBkZGRZWVlAQEAaGhpISEgkS7tbAAAAFHRSTlMAOvhpZD8mkQWegMy9qY1YVE01EYiqlE0AAADZSURBVCjPbY9ZloMgEAAbEbfsmRZZXbJn7n/AAX2RQVN/VD26AXLOeZLDGo6IbfI9tHq8cdxuj1HwvgCoaiHqKoRk+M3hB9jueUW8PnfsE/bJ3vms7nCkq7NoE3s99AXxoh8vFoXCpknrn5faAuJCenT0xPkYqnxQFJaU0gdZrsKm8aHZrAIffBj40mc1jsTfIJRWegq6opTMvlfqLqYg7kr1ZB7jFgeaMC59N//8O4WZ1IiPF8b5wMHcJn8zB4g4mc77zpxgAbMSUVoGK4iV0hL4wrksz+H0Bw5+E+HrniDQAAAAAElFTkSuQmCC), auto";case"pan":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAABHVBMVEUAAABPTk4AAAAAAAAJCQkRERE0MzQQEBAODg4QEBB4d3dbWlo9PDw/Pj4vLy8sLCwZGBgWFhYcHBwKCgoSEhIAAAAKCgoICAgKCgoQEBAODg4EBAQICAgPDw8REREMDAx2dnY0NDQvLy9QUFAaGhomJSYjIyM7OjokJCQNDA0mJiYNDQ0AAAAUFBQJCQkQEBAEBAQNDQ0PDw8VFRX///+amJkAAAD5+fnz8/PKycn9/f339vbi4eLR0dDNzMyAgIB8e3xycHH7+/vw7+/o6OjX1ta7urq4t7iwsLCnp6eioqKbmppva21OTk74+Pjl5eXc3Nzb29vLy8vDw8PDwsKrqqqdnZ2WlpaSkpKTkZKMiouEg4NkZGRISEgxLzBpgbsEAAAANHRSTlMA+fiQXgngKSYG/vX17uvBuqackpCNg3BpUkpAPBwTDvj18+vl0s/NwrOwoZZ+TDg4NBkBGrzX8QAAAP5JREFUKM99j9Vuw0AQRdeuKZyGkyZNmbnXDLHDVGb8/8/oy7paK1bO0+oc7WiGnGiaxq+QRTQAOh8f9Jv4H/Ge8PZPrCdlvkxfYluUT2WyyCq3mZ7unwlKVLcqOzA/Mf71j0TWJ/Ym6rPeca05Ni4iIevYc7yoUD2zQFhq71BdI9nvBeBabFDSPe8DswlUc1Riw3VxbH0NHBUPQ0jrbDnPYDjALQBMq9E7nkC5y7VDKTZlUg8Q0lmjvl74zlYErgvKa42GPKf3/a0kQmYCDY1SYMDosqMoiWrGwz/uAbNvc/fNon4kXRKGq+PUo2Mb96afV0iUxqGU2s4VBbKUP65NL/LKF+7ZAAAAAElFTkSuQmCC), auto"}return null},this.getMotionDelta=function(e,t){var n=f&&f.getReverseZoomDirection()?-1.5:1.5;d&&(n*=-1),oe[0]&&(H.x+=u,q.x+=20),oe[1]&&(H.x-=u,q.x-=20),oe[2]&&(H.y+=u,q.y+=20),oe[3]&&(H.y-=u,q.y-=20),oe[4]&&(H.z+=n),oe[5]&&(H.z-=n);var i=H.x-z.x,r=H.y-z.y,o=H.z-z.z;Math.abs(i)<c&&(i=0),Math.abs(r)<c&&(r=0),Math.abs(o)<c&&(o=0),e.set(i,r,o),t&&t.set(q.x-j.x,q.y-j.y)},this.stepMotionDelta=function(e,t){t?(z.x+=.6*e.x,z.y+=.6*e.y,z.z+=.6*e.z):z.copy(H),j.copy(q)},this.getFitBounds=function(){return this.utilities.viewerImpl.zoomBoundsChanged&&(se=this.utilities.viewerImpl.getVisibleBounds(!0),this.utilities.viewerImpl.zoomBoundsChanged=!1),se},this.update=function(){var e,n=!1,i=!1;this.getMotionDelta(Y,X);var r=Y.x,o=Y.y,l=Y.z;if(T||this.checkInteractionMode(),(T=G>V)&&this.controller.setIsLocked(!0),0!==r||0!==o||0!==l){switch(v){case"orbit":this.utilities.autocam&&this.utilities.autocam.startState&&(X.x=-X.x,C&&this.utilities.autocam.orbit(q,C,X.multiplyScalar(2),this.utilities.autocam.startState));break;case"freeorbit":!function(){if(f.isActionEnabled("orbit")){J.subVectors(m.position,m.pivot),Q.subVectors(m.position,m.target);var e=Q.length();Q.normalize();var t=Math.acos(K.dot(Z)/K.length()/Z.length());t&&(t*=2,ne.crossVectors(K,Z).normalize(),ie.setFromAxisAngle(ne,-t),J.applyQuaternion(ie),m.up.applyQuaternion(ie),Z.applyQuaternion(ie),Q.applyQuaternion(ie),K.copy(Z)),m.position.addVectors(m.pivot,J),m.target.subVectors(m.position,Q.multiplyScalar(e)),m.dirty=!0}}();break;case"dolly":var c,u=new THREE.Vector2;l*=ue,G>=0?(o=-o,l=Math.abs(r)>Math.abs(o)?r:o,f.getReverseZoomDirection()&&(l*=-1),l*=h,r=0,o=0,u=f.viewportToScreen(0,0)):(e=f.getScreenViewport(),a&&s?(u.x=a/e.width,u.y=s/e.height):u=f.viewportToScreen(0,0)),!f.getIs2D()&&f.getZoomTowardsPivot()?this.coiIsActive()?c=f.getPivotPoint():(u=f.viewportToScreen(0,0),c=f.getWorldPoint(u.x,u.y)):c=f.getWorldPoint(u.x,u.y),f.dollyFromPoint(l*this.getDollySpeed(c,l<0),c,this.getFitBounds());break;case"pan":f.panRelative(-r,o,he);break;case"dollypan":0===r&&0===o||f.panRelative(-r,o,he),e=f.getScreenViewport(),c=f.getWorldPoint(a/e.width,s/e.height);var d=f.getPosition(),y=f.getIs2D()?d.sub(c).length():he,b=(E/w-1)*y;f.dollyFromPoint(b,c,this.getFitBounds());var A=new THREE.Vector3,M=new THREE.Quaternion,L=f.getCameraUpVector(),R=A.copy(m.position).sub(m.target).normalize();M.setFromAxisAngle(R,1.2*S),L.applyQuaternion(M),f.getIs2D()||p&&("pinch"===_||"pan"===_)||f.setCameraUpVector(L),E=w,x,he=y+b}i=!0}return this.stepMotionDelta(Y,"pan"!==v&&"dollypan"!==v),G===V&&Math.abs(l)<.01&&(this.interactionEnd(V),H.z=0,z.z=0,n=!0,i=!0),(ae.SHIFT||ae.ALT)&&-1!==g.indexOf(t.getActiveNavigationTool())&&(i=!0),!P&&(n||G>-5)&&(G>V&&(z.copy(H),this.utilities.removeTemporaryPivot()),this.utilities.autocam.endInteraction(),G=-5,T&&this.controller.setIsLocked(!1),T=!1,C=null,_=null),i?this.utilities.pivotActive(f.getPivotSetFlag(),G<=V):this.utilities.pivotUpdate(),m.dirty},this.checkInteractionMode=function(){var e=this.getTriggeredMode();e!==v&&("pan"===(v=e)&&G>V||"dollypan"===v)&&this.initTracking(z.x,z.y)},this.interactionStart=function(e,t){(t||e>G)&&(G=e,P=!0,e>V&&("pan"===v&&this.initTracking(z.x,z.y),"orbit"===v&&this.initOrbit()),!f.getSelectionSetsPivot()&&this.utilities.pivotActive(f.getPivotSetFlag(),e===V),this.utilities.autocam&&(this.utilities.autocam.sync(m),this.utilities.autocam.startInteraction(j.x,j.y),C=j.clone()))},this.interactionCheck=function(){(oe[0]||oe[1]||oe[2]||oe[3]||oe[4]||oe[5]||ae.SHIFT||ae.CONTROL||ae.ALT||ae.SPACE)&&this.interactionStart(B,!0)},this.interactionEnd=function(e){e===G&&(e!==V&&this.utilities.pivotActive(!1),P=!1)},this.isInteractionActive=function(){return P},this.handleWheelInput=function(t,n){if(a=n.canvasX,s=n.canvasY,this.isDragging)return!1;if(f.getIs2D()){var i=f.getScreenViewport(),r=e.intersectGround(a+i.width,s+i.height);this.utilities.setPivotPoint(r,!0,!0)}else this.setPivotPointFromInput(a,s);return f.getReverseZoomDirection()&&(t*=-1),H.z+=t,0!=t&&this.interactionStart(V),!0},this.resetKeys=function(){this.autoMove(-1,!1),ae.SHIFT=0,ae.CONTROL=0,ae.ALT=0,ae.SPACE=0},this.autoMove=function(e,t){t&&this.isDragging||(e<0?oe[0]=oe[1]=oe[2]=oe[3]=oe[4]=oe[5]=t:oe[e]=t,t||this.interactionEnd(B),this.interactionCheck())},this.updateModifierState=function(e){ae.CONTROL=d&&e.metaKey||e.ctrlKey?1:0,ae.SHIFT=e.shiftKey?1:0,ae.ALT=e.altKey?1:0},this.handleKeyDown=function(e,t){this.updateModifierState(e);var n=!1;if(d&&ae.CONTROL)return this.autoMove(-1,!1),this.interactionEnd(B),!1;switch(t){case F:this.adjustSpeed(1),n=!0;break;case U:this.adjustSpeed(-1),n=!0;break;case k:this.adjustSpeed(0),n=!0;break;case D:this.autoMove(0,!0),n=!0;break;case O:this.autoMove(1,!0),n=!0;break;case L:this.autoMove(2,!0),n=!0;break;case R:this.autoMove(3,!0),n=!0;break;case I:this.autoMove(4,!0),n=!0;break;case N:this.autoMove(5,!0),n=!0;break;default:return!1}return this.isDragging||this.interactionStart(B),n},this.handleKeyUp=function(e,t){this.updateModifierState(e);var n=!1;if(d&&ae.CONTROL)return this.autoMove(-1,!1),this.interactionEnd(B),!1;switch(t){case D:this.autoMove(0,!1),n=!0;break;case O:this.autoMove(1,!1),n=!0;break;case L:this.autoMove(2,!1),n=!0;break;case R:this.autoMove(3,!1),n=!0;break;case I:this.autoMove(4,!1),n=!0;break;case N:this.autoMove(5,!1),n=!0;break;default:return!1}return n&&(this.interactionEnd(B),P||this.interactionCheck()),n},this.handleDollyPan=function(e){a=e.canvasX,s=e.canvasY;var t=f.getScreenViewport();q.x=a,q.y=s,H.x=q.x/t.width,H.y=q.y/t.height,w=function(e){var t=e.pointers[1].clientX-e.pointers[0].clientX,n=e.pointers[1].clientY-e.pointers[0].clientY;return Math.sqrt(t*t+n*n)}(e);var n,i,r=THREE.Math.degToRad(e.rotation);S=r-A,Math.abs(S)>1&&(S=0),A=r,n=e.type,i="start",-1!==n.indexOf(i,n.length-i.length)&&(E=w,1,S=0,A=r),x=e.scale},this.handleGesture=function(e){switch(e.type){case"dragstart":return _="drag",this.handleButtonDown(e,0);case"dragmove":return"drag"!==_&&(this.handleButtonDown(e,0),_="drag"),this.handleMouseMove(e);case"dragend":return"drag"===_&&(this.handleButtonUp(e,0),_=null,!0);case"panstart":return _="pan",this.handlePanStart(e),this.handleDollyPan(e),!0;case"panmove":return"pan"!==_&&(_="pan",this.handlePanStart(e)),this.handleDollyPan(e);case"panend":return"pan"===_&&(this.isDragging=!1,this.handleDollyPan(e),this.interactionEnd(3),!0);case"pinchstart":return this.setPivotPointFromInput(e.center.x,e.center.y),this.isDragging=!0,_="pinch",z.x=.5*(e.normalizedX+1),z.y=1-.5*(e.normalizedY+1),W.set(e.canvasX,e.canvasY),j.set(e.canvasX,e.canvasY),T=!1,this.interactionStart(3),this.handleDollyPan(e),!0;case"pinchmove":return"pinch"===_&&this.handleDollyPan(e);case"pinchend":return"pinch"===_&&(this.isDragging=!1,this.handleDollyPan(e),this.interactionEnd(3),!0)}return!1},this.handleButtonDown=function(e,t){return this.updateModifierState(e),z.x=.5*(e.normalizedX+1),z.y=1-.5*(e.normalizedY+1),j.set(e.canvasX,e.canvasY),H.copy(z),q.copy(j),K.copy(fe(e.canvasX,e.canvasY)),Z.copy(K),a=e.canvasX,s=e.canvasY,this.isDragging=!0,this.interactionStart(t),!0},this.handlePanStart=function(e){return this.isDragging=!0,z.x=.5*(e.normalizedX+1),z.y=1-.5*(e.normalizedY+1),W.set(e.canvasX,e.canvasY),j.set(e.canvasX,e.canvasY),this.interactionStart(3),!0},this.handleButtonUp=function(e,t){return this.updateModifierState(e),H.x=.5*(e.normalizedX+1),H.y=1-.5*(e.normalizedY+1),q.set(e.canvasX,e.canvasY),Z.copy(fe(e.canvasX,e.canvasY)),K.copy(Z),a=e.canvasX,s=e.canvasY,this.interactionEnd(t),this.isDragging=!1,!0},this.handleMouseMove=function(t){return this.updateModifierState(t),this.isDragging?(H.x=.5*(t.normalizedX+1),H.y=1-.5*(t.normalizedY+1),q.set(t.canvasX,t.canvasY),Z.copy(fe(t.canvasX,t.canvasY)),a=t.canvasX,s=t.canvasY,!0):(z.x=.5*(t.normalizedX+1),z.y=1-.5*(t.normalizedY+1),j.set(t.canvasX,t.canvasY),H.x=z.x,H.y=z.y,q.copy(j),a=t.canvasX,s=t.canvasY,t.target===e.canvas&&e.rolloverObject(a,s),!1)},this.handleBlur=function(e){r.resetKeys(),r.interactionEnd(G)},this._onPrefCursor=function(e){M=e}.bind(this)}r.GlobalManagerMixin.call(a.prototype)},26074:(e,t,n)=>{"use strict";n.r(t),n.d(t,{SelectionType:()=>i});var i={MIXED:1,REGULAR:2,OVERLAYED:3}},2799:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Selector:()=>c,MultiModelSelector:()=>u});var i=n(82197),r=n(26074),o=n(79659),a=n(98926),s=n(37169),l=n(16453);function c(e,t){var n=this;this.selectedObjectIds={},this.selectionCount=0,this.selectionMode=i.SelectionMode.LEAF_OBJECT,this.lockedNodes=[];var s={};function c(){return t.getData().instanceTree}function u(n){var i=c();if(s[n]>0)s[n]--,0==s[n]&&e.highlightObjectNode(t,n,!1);else if(s[n]<0)throw"Selection State machine broken. Negatively selected object!";i&&i.enumNodeChildren(n,(function(e){u(e)}),!1)}function h(n,i,o){var a=c();if(s[n])s[n]++;else{switch(o){default:case r.SelectionType.MIXED:e.highlightObjectNode(t,n,!0,i);break;case r.SelectionType.REGULAR:e.highlightObjectNode(t,n,!0,!0);break;case r.SelectionType.OVERLAYED:e.highlightObjectNode(t,n,!0,!1)}s[n]=1}a&&a.enumNodeChildren(n,(function(e){h(e,!0,o)}),!1)}function d(e){if(void 0!==e&&n.selectedObjectIds[e])return!0}function p(i,o){if(!n.isNodeSelectionLocked(i)){var a,s,l,u,p=c();if(o=o||r.SelectionType.MIXED,p){var f=(l="ifc"===(null===(a=t.getData())||void 0===a||null===(s=a.loadOptions)||void 0===s?void 0:s.fileExt),u=void 0!==e.api.prefs.getPrefFromLocalStorage(Autodesk.Viewing.Private.Prefs3D.SELECTION_MODE),l&&!u?Autodesk.Viewing.SelectionMode.FIRST_OBJECT:n.selectionMode);if(i=p.findNodeForSelection(i,f),!p.isNodeSelectable(i))return}d(i)||(n.selectedObjectIds[i]=o,n.selectionCount++,h(i,!1,o))}}function f(e){d(e)&&(u(e),n.selectedObjectIds[e]=0,n.selectionCount--)}this.getInstanceTree=c,this.hasSelection=function(){return n.selectionCount>0},this.getSelectionLength=function(){return n.selectionCount},this.getSelection=function(){var e=[],t=n.selectedObjectIds;for(var i in t)if(t[i]){var r=parseInt(i);e.push(r)}return e},this.isSelected=function(e){return d(e)},this.clearNodeSelection=function(e){return void 0!==e&&0!==this.selectionCount&&(u(e),delete n.selectedObjectIds[e],!0)},this.clearSelection=function(e){if(this.selectionCount>0){var t=n.selectedObjectIds;for(var i in t){var r=parseInt(i);void 0!==r&&u(r)}return n.selectedObjectIds={},n.selectionCount=0,!0}},this.deselectInvisible=function(){var i=!1,r=n.selectedObjectIds,o=e.visibilityManager;for(var a in r){var s=parseInt(a);s&&!o.isNodeVisible(t,s)&&(f(s),i=!0)}return i},this.toggleSelection=function(e,n){e||t.isLeaflet()?d(e)?f(e):p(e,n):a.logger.error("Attempting to select node 0.",(0,o.errorCodeString)(o.ErrorCodes.VIEWER_INTERNAL_ERROR))},this.setSelectionMode=function(e){this.clearSelection(!0),this.selectionMode=e},this.isNodeSelectionLocked=function(e){if(-1===e)return!1;var t=c();return t?t.isNodeSelectionLocked(e):-1!==n.lockedNodes.indexOf(e)},this.lockSelection=function(e,t){var i=c();function r(e,t){if(e&&-1!==e)if(t)-1===n.lockedNodes.indexOf(e)&&(n.lockedNodes.push(e),n.clearNodeSelection(e));else{var i=n.lockedNodes.indexOf(e);n.lockedNodes.splice(i,1)}}e=Array.isArray(e)?e:[e],i?e.forEach((function(e){i.enumNodeChildren(e,(function(e){i.lockNodeSelection(e,!1),r(e,t),t&&i.lockNodeSelection(e,t)}),!0)})):e.forEach((function(e){r(e,t)}))},this.setSelection=function(e,t){if(!function(e){if(n.selectionCount!==e.length)return!1;for(var t=0;t<e.length;t++)if(!d(e[t]))return!1;return!0}(e)&&(this.clearSelection(!0),null!=e&&0!==e.length))for(var i=0;i<e.length;i++)p(e[i],t)},this.getSelectionBounds=function(){var e=new l.Box3,i=new l.Box3,r=c();if(r){var o=t.getFragmentList(),a=n.selectedObjectIds;for(var s in a){var u=parseInt(s);r.enumNodeFragments(u,(function(t){o.getWorldBounds(t,i),e.union(i)}),!0)}}return e},this.getSelectionVisibility=function(){var e=!1,i=!1,r=n.selectedObjectIds;for(var o in r){var a=parseInt(o);if(a){var s=c();if(s&&s.isNodeHidden(a)?i=!0:e=!0,e&&i)break}}return{hasVisible:e,hasHidden:i,model:t}},this.update2DSelectionHighlighting=function(){if(!n._2DSelectionHighlightingUpdated&&t.isLoadDone()){var e=t.getPropertyDb();if(!e||e.isLoadDone()){s={};var i={};Object.keys(n.selectedObjectIds).forEach((function(e){i[t.remapDbId(e)]=n.selectedObjectIds[e]})),n.selectedObjectIds=i;for(var r=n.getSelection(),o=0;o<r.length;o++){var a=r[o];h(a,!1,n.selectedObjectIds[a])}n._2DSelectionHighlightingUpdated=!0}}},this.dtor=function(){this.selectedObjectIds=null}}function u(e){var t=[];function n(){t.length>1&&a.logger.warn("This selection call does not yet support multiple models.")}function i(){for(var n,i=[],r=0;r<t.length;r++){var o=[],a=[],l=t[r].selector.selectedObjectIds,c=t[r].selector.getInstanceTree();for(var u in l)if(l[u]){var h=parseInt(u);h&&(o.push(h),c&&c.enumNodeFragments(h,(function(e){a.push(e)}),!1))}o.length&&i.push({fragIdsArray:a,dbIdArray:o,nodeArray:o,model:t[r]})}1===t.length&&(n={type:s.SELECTION_CHANGED_EVENT,fragIdsArray:i[0]?i[0].fragIdsArray:[],dbIdArray:i[0]?i[0].dbIdArray:[],nodeArray:i[0]?i[0].dbIdArray:[],model:t[0]},e.api.dispatchEvent(n)),n={type:s.AGGREGATE_SELECTION_CHANGED_EVENT,selections:i},e.api.dispatchEvent(n)}function r(){for(var e=!1,n=0;n<t.length;n++)e=t[n].selector.deselectInvisible()||e;e&&i()}function o(e){e.model.is2d()&&e.model.selector&&e.model.selector.update2DSelectionHighlighting()}this.highlightDisabled=!1,this.highlightPaused=!1,this.selectionDisabled=!1,this.addModel=function(n){-1==t.indexOf(n)&&(n.selector=new c(e,n),t.push(n))},this.removeModel=function(e){var n=t.indexOf(e);e.selector.getSelection();e.selector.clearSelection(),e.selector=null,t.splice(n,1)},this.hasSelection=function(){for(var e=0;e<t.length;e++)if(t[e].selector.hasSelection())return!0;return!1},this.getSelectionLength=function(){for(var e=0,n=0;n<t.length;n++)e+=t[n].selector.getSelectionLength();return e},this.getSelection=function(){return n(),t.length>1&&a.logger.warn("Use getAggregateSelection instead of getSelection when there are multiple models in the scene."),t[0]?t[0].selector.getSelection():[]},this.getAggregateSelection=function(){for(var e=[],n=0;n<t.length;n++){var i=t[n].selector.getSelection();i&&i.length&&e.push({model:t[n],selection:i})}return e},this.clearSelection=function(e){for(var n,r=0;r<t.length;r++)t[r].selector.clearSelection(e)&&(n=!0);!e&&n&&i()},this.toggleSelection=function(e,r,o){this.selectionDisabled||(r||(n(),r=t[0]),r.selector.toggleSelection(e,o),i())},this.setSelectionMode=function(e){for(var n=0;n<t.length;n++)t[n].selector.setSelectionMode(e)},this.isNodeSelectionLocked=function(e,i){return i||(n(),i=t[0]),i&&i.selector.isNodeSelectionLocked(e)},this.lockSelection=function(e,i,r){r||(n(),r=t[0]),r&&r.selector.lockSelection(e,i)},this.unlockSelection=function(e,i){var r=this;e||i?(i||(n(),i=t[0]),e=e||i.selector.lockedNodes.slice(),this.lockSelection(e,!1,i)):t.forEach((function(e){var t=e.selector.lockedNodes.slice();r.lockSelection(t,!1,e)}))},this.setSelection=function(e,r,o){if(!this.selectionDisabled){if(e&&0!==e.length){if(r)for(var a=0;a<t.length;a++)t[a]!==r&&t[a].selector.clearSelection();else n(),r=t[0];r.selector.setSelection(e,o)}else this.clearSelection(!0);i()}},this.setAggregateSelection=function(e){if(!this.selectionDisabled){if(e&&0!==e.length)for(var t=0;t<e.length;++t){var n=e[t].model,r=e[t].ids,o=e[t].selectionType;n.selector.setSelection(r,o)}else this.clearSelection(!0);i()}},this.getSelectionBounds=function(){if(1==t.length)return t[0].selector.getSelectionBounds();for(var e=new l.Box3,n=0;n<t.length;n++){var i=t[n].selector.getSelectionBounds();e.union(i)}return e},this.getSelectionVisibility=function(){for(var e={hasVisible:!1,hasHidden:!1,details:[]},n=0;n<t.length;n++){var i=t[n].selector.getSelectionVisibility();e.hasVisible=e.hasVisible||i.hasVisible,e.hasHidden=e.hasHidden||i.hasHidden,e.details.push(i)}return e},this.dtor=function(){for(var e=0;e<t.length;e++)t[e].selector.dtor()},e.api.addEventListener(s.ISOLATE_EVENT,(function(e){r()})),e.api.addEventListener(s.HIDE_EVENT,(function(e){r()})),e.api.addEventListener(s.GEOMETRY_LOADED_EVENT,o),e.api.addEventListener(s.OBJECT_TREE_CREATED_EVENT,o),e.api.addEventListener(s.OBJECT_TREE_UNAVAILABLE_EVENT,o)}},49083:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ToolController:()=>l});var i=n(84998),r=n(98926),o=n(37169),a=n(9487),s=n(35449);function l(e,t,n,s,c){this.setGlobalManager(t.globalManager),this.domElement=t.canvasWrap,this.selector=e.selector,this.autocam=n,this.lastClickX=-1,this.lastClickY=-1,this.scrollInputEnabled=!0,this.keyMapCmd=!0,this.propagateInputEventTypes=[];var u=-1!==navigator.userAgent.search("Mac OS"),h=-1!==navigator.userAgent.search("Firefox"),d=-1!==navigator.userAgent.search("Chrome"),p=-1!==navigator.userAgent.search("Safari")&&!d,f={},m={},g={},v=[],y=!1,b=-1,_=-1,x=!1,E=null,w=!1,S={},A=this;function M(e){return e.getPriority instanceof Function&&e.getPriority()||0}function T(e,n){return t.navigation.getUseLeftHandedInput()&&0===e||h&&1===e||u&&!p&&0===e&&n.ctrlKey}this.__registerToolByName=function(e,t){f[t]=e},this.registerTool=function(e,t){var n=this,i=e.getNames();if(!i||0===i.length)return r.logger.warn("Cannot register tool with no name."),!1;for(var o=!1,a=0;a<i.length;++a)if("default"!==i[a]){this.__registerToolByName(e,i[a]);g[i[a]]=t&&t instanceof Function?t:function(t){var i=e.getName();t?n.activateTool(i):n.deactivateTool(i)},o=!0}return e.utilities=s,e.controller=this,e.register&&e.register(),o},this.deregisterTool=function(e){this.deactivateTool(e.getName());var t=e.getNames();if(!t||0===t.length)return!1;for(var n=t.length;--n>=0;)this.__deregisterToolName(t[n]);return e.deregister&&e.deregister(),e.utilities=null,e.controller=null,!0},this.__deregisterToolName=function(e){e in f&&(!function(e){for(var t=v.length;--t>=0;)v[t].activeName===e&&(f[e].deactivate(e),v.splice(t,1))}(e),delete f[e])},this.getTool=function(e){return f[e]},this.getActiveToolName=function(){var e=v.length;return e>0?v[e-1].activeName:"default"},this.getActiveTool=function(){var e=v.length;return e>0?v[e-1]:f.default},this.getActiveTools=function(){return v.slice()},this.isToolActivated=function(e){for(var t=0;t<v.length;t++)if(v[t].activeName===e)return!0;return!1},this.setToolActiveName=function(e){var t=f[e];t&&(t.activeName=e)},this.rearrangeByPriorities=function(){v.sort((function(e,t){return M(e)-M(t)}))},this.activateToolModality=function(e){var t=this.getToolModality(e);for(var n in t){var i=t[n],r=g[n];i!==this.isToolActivated(n)&&r&&r(i,n)}},this.activateTool=function(e){if(y)return!1;var n=f[e];if(this.activateToolModality(e),n){void 0===n.count&&(n.count=0);var i=null;v.length&&"intercept"===v[v.length-1].activeName&&(i=v.pop());for(var a=0,s=0;s<v.length;s++)v[s]===n&&n.count++,M(v[s])<=M(n)&&(a=s+1);return n.activeName=e,0===n.count&&(n.count++,v.splice(a,0,n)),n.activate(e,t),i&&v.push(i),t.dispatchEvent({type:o.TOOL_CHANGE_EVENT,toolName:e,tool:n,active:!0}),!0}return r.logger.warn("activateTool not found: "+e),!1},this.deactivateTool=function(e){if(y)return!1;for(var n=v.length;--n>=0;)if(v[n].activeName===e){var i=f[e];return 1===i.count&&v.splice(n,1),i.count--,i.deactivate(e),t.dispatchEvent({type:o.TOOL_CHANGE_EVENT,toolName:e,tool:i,active:!1}),!0}return r.logger.warn("deactivateTool not found: "+e),!1},this.getToolNames=function(){return Object.keys(f)},this.setDefaultTool=function(e){var t=this.getDefaultTool();return!(!e||e===t)&&(this.__registerToolByName(e,"default"),t&&t.deactivate("default"),e.activate("default"),!0)},this.getDefaultTool=function(){return f.default},this.setDefaultTool(c),this.setIsLocked=function(e){var t=y;return y=!!e,t},this.getIsLocked=function(){return y},this.__checkCursor=function(){for(var e=null,n=v.length;--n>=0;){var i=v[n];if(i.getCursor&&(e=i.getCursor()))break}e||(e="auto"),E!=e&&(t.canvas.style.cursor=e,E=e)},this.update=function(e){this.__checkCursor();var n=!1;s&&s.update()&&(n=!0);for(var i=v.length;--i>=0;){var r=v[i];r.update&&r.update(e)&&(n=!0)}if(t.navigation.getCamera().dirty?(t.navigation.updateCamera(),n=!0,this.cameraUpdated=!0):this.cameraUpdated=!1,n)t.navigation.updateCamera(),this.moveDelay=Date.now()+150;else if(0!==this.moveDelay){this.moveDelay-Date.now()>0?n=!0:this.moveDelay=0}return n},this.__clientToCanvasCoords=function(t,n,i){var r=e.getCanvasBoundingClientRect(),o=r.width,a=r.height,s=t.clientX-r.left,l=t.clientY-r.top;t.canvasX=s,t.canvasY=l,t.normalizedX=s/o*2-1,t.normalizedY=(a-l)/a*2-1,n&&n.set(s/o,l/a,0),i&&i.set(s,l)},this.__invokeStack=function(e,t,n){for(var i=v.length;--i>=0;){var r=v[i];if(r&&r[e]&&r[e](t,n))return!0}var o=this.getDefaultTool();return!(!o[e]||!o[e](t,n))},this.distributeEvent=function(e,t,n){return this.__invokeStack(e,t,n)},this.handleResize=function(){t.navigation.setScreenViewport(t.container.getBoundingClientRect());for(var e=v.length;--e>=0;){var n=v[e];n.handleResize&&n.handleResize()}},this.handleSingleClick=function(e){var t=this.applyButtonMappings(e);this.lastClickX=e.clientX,this.lastClickY=e.clientY,this.__invokeStack("handleSingleClick",e,t)&&this.__onEventHandled(e)},this.handleDoubleClick=function(e){var t=this.applyButtonMappings(e);this.__invokeStack("handleDoubleClick",e,t)&&this.__onEventHandled(e)},this.handleSingleTap=function(e){this.lastClickX=e.canvasX,this.lastClickY=e.canvasY,this.__invokeStack("handleSingleTap",e)&&this.__onEventHandled(e)},this.handleDoubleTap=function(e){this.lastClickX=e.canvasX,this.lastClickY=e.canvasY,this.__invokeStack("handleDoubleTap",e)&&this.__onEventHandled(e)},this.handleWheelInput=function(e,t){this.__invokeStack("handleWheelInput",e,t)&&this.__onEventHandled(t)},this.applyButtonMappings=function(e){var n=e.button;return"buttons"in e&&(e.firefoxSpoof?n=0:!x||1&e.buttons?2===n&&1&e.buttons&&(n=0,e.firefoxSpoof=x=!0):(e.firefoxSpoof=!0,x=!1,n=0)),t.navigation.getUseLeftHandedInput()&&(n=0===n?2:2===n?0:n),n},this.applyKeyMappings=function(e){switch(e.keyCode){case a.KeyCode.EQUALSMOZ:return a.KeyCode.EQUALS;case a.KeyCode.DASHMOZNEW:case a.KeyCode.DASHMOZ:return a.KeyCode.DASH}return e.keyCode},this.handleKeyDown=function(e){var t;!this.keyMapCmd||!u||"MetaLeft"!=e.code&&"MetaRight"!=e.code?(t=this.applyKeyMappings(e))&&this.__invokeStack("handleKeyDown",e,t)&&this.__onEventHandled(e):this.handleCmdKeyEvent(e,"keydown")},this.handleKeyUp=function(e){var t;!this.keyMapCmd||!u||"MetaLeft"!=e.code&&"MetaRight"!=e.code?(t=this.applyKeyMappings(e))&&this.__invokeStack("handleKeyUp",e,t)&&this.__onEventHandled(e):this.handleCmdKeyEvent(e,"keyup")},this.handleCmdKeyEvent=function(e,t){this.__onEventHandled(e);var n=new KeyboardEvent(t,{key:"Control",code:"MetaLeft"==e.code?"ControlLeft":"ControlRight",location:e.location,ctrlKey:!0,metaKey:!1,repeat:e.repeat,isComposing:e.isComposing,charCode:0,keyCode:17,which:17});window.dispatchEvent(n)},this.handleButtonDown=function(e,t){this.__invokeStack("handleButtonDown",e,t)&&this.__onEventHandled(e)},this.handleButtonUp=function(e,t){this.__invokeStack("handleButtonUp",e,t)&&this.__onEventHandled(e)},this.handleMouseMove=function(e){this.__invokeStack("handleMouseMove",e)&&this.__onEventHandled(e)},this.handleBlur=function(e){this.__invokeStack("handleBlur",e)&&this.__onEventHandled(e)},this.keydown=function(e){if(!l._lastTouchedElement||A.domElement.contains(l._lastTouchedElement)){var t=A.getDocument();if(!(t.activeElement instanceof HTMLInputElement||t.activeElement instanceof HTMLTextAreaElement||t.activeElement instanceof HTMLSelectElement)){if(t.activeElement){var n=t.activeElement.getAttribute("contenteditable");if("true"===n||""===n)return}A.handleKeyDown(e)}}},this.keyup=function(e){A.handleKeyUp(e)},this.mousedown=function(e){var t=A.getDocument();i.isIE11&&(0,i.inFullscreen)(t)||t.activeElement&&t.activeElement.blur&&t.activeElement.blur(),A.__clientToCanvasCoords(e);var n=A.applyButtonMappings(e);if(A.handleButtonDown(e,n),b=e.canvasX,_=e.canvasY,T(n,e)){var r=S,o=void 0!==r.time&&e.timeStamp-r.time<500,a=void 0!==r.x&&void 0!==r.y&&Math.abs(r.x-e.canvasX)<=2&&Math.abs(r.y-e.canvasY)<=2;(!o||!a||r.clickCount&&2<=r.clickCount)&&(r.clickCount=0),r.clickCount?1===r.clickCount&&(r.clickCount=2):(r.clickCount=1,r.x=e.canvasX,r.y=e.canvasY,r.time=e.timeStamp)}A.addDocumentEventListener("mouseup",(function e(t){A.applyButtonMappings(t)===n&&(A.removeDocumentEventListener("mouseup",e),A.mouseup(t))}),!1),A.registerWindowMouseMove()},this.mousemove=function(e){A.__clientToCanvasCoords(e);var t=b-e.canvasX,n=_-e.canvasY;(Math.abs(t)>2||Math.abs(n)>2)&&(b=-1,_=-1),A.handleMouseMove(e)},this.mouseup=function(e){A.__clientToCanvasCoords(e);var t=A.applyButtonMappings(e);A.handleButtonUp(e,t);var n=b-e.canvasX,i=_-e.canvasY;if(b=-1,_=-1,Math.abs(n)<=2&&Math.abs(i)<=2&&A.handleSingleClick(e),T(t,e)){var r=S;2===r.clickCount&&(A.handleDoubleClick(e),r.clickCount=0,r.x=void 0,r.y=void 0,r.time=void 0)}A.unregisterWindowMouseMove()},this.doubleclick=function(e){A.__clientToCanvasCoords(e),b=e.canvasX,_=e.canvasY,A.handleDoubleClick(e)},this.mousewheel=function(e){if(A.scrollInputEnabled){A.__clientToCanvasCoords(e);var t=0;if(e.wheelDelta)t=e.wheelDelta/40;else if(e.detail)t=-e.detail;else if(e.deltaY){var n=h?1:40;t=-e.deltaY/n}A.handleWheelInput(t,e)}},this.blur=function(e){A.handleBlur(e)},this.mouseover=function(e){l._lastTouchedElement=e.target},this.registerWindowMouseMove=function(){A.addWindowEventListener("mousemove",A.mousemove),A.addWindowEventListener("mouseover",A.mouseover),A.domElement.removeEventListener("mousemove",A.mousemove),A.domElement.removeEventListener("mouseover",A.mouseover)},this.unregisterWindowMouseMove=function(){A.removeWindowEventListener("mousemove",A.mousemove),A.removeWindowEventListener("mouseover",A.mouseover),A.domElement.addEventListener("mousemove",A.mousemove),A.domElement.addEventListener("mouseover",A.mouseover)},this.enableMouseButtons=function(e){e&&!w?(this.domElement.addEventListener("mousedown",this.mousedown),this.domElement.addEventListener("dblclick",this.doubleclick),this.domElement.addEventListener("mousemove",this.mousemove),this.domElement.addEventListener("mouseover",this.mouseover)):!e&&w&&(this.domElement.removeEventListener("mousedown",this.mousedown),this.domElement.removeEventListener("dblclick",this.doubleclick),this.domElement.removeEventListener("mousemove",this.mousemove),this.domElement.removeEventListener("mouseover",this.mouseover));var t=w;return w=e,t},this.domElement.addEventListener("mousewheel",this.mousewheel,!1),this.domElement.addEventListener("DOMMouseScroll",this.mousewheel,!1),A.addWindowEventListener("keydown",this.keydown,!1),A.addWindowEventListener("keyup",this.keyup,!1),A.addWindowEventListener("blur",this.blur,!1),this.uninitialize=function(){for(this.domElement.removeEventListener("mousemove",this.mousemove),this.domElement.removeEventListener("mouseover",this.mouseover),this.removeWindowEventListener("mousemove",this.mousemove),this.removeWindowEventListener("mouseover",this.mouseover),this.removeWindowEventListener("keydown",this.keydown),this.removeWindowEventListener("keyup",this.keyup),this.removeWindowEventListener("blur",this.blur),this.domElement=null,this.selector=null,this.autocam=null,y=!1;v.length>0;)this.deactivateTool(v[v.length-1].activeName);f=null,v=null,A=null,s=null,t=null,e=null,l._lastTouchedElement=null},this.set2DMode=function(){},this.setAutocam=function(){},this.syncCamera=function(){},this.recordHomeView=function(){var e=t.navigation.getCamera();n.sync(e),n.setHomeViewFrom(e)},this.setMouseWheelInputEnabled=function(e){this.scrollInputEnabled=e},this.setModalityMap=function(e){for(var t in m={},e)this.setToolModality(t,e[t])},this.getModalityMap=function(){return Object.assign({},m)},this.getToolModality=function(e){return m[e]},this.setToolModality=function(e,t){e?t?m[e]=t:r.logger.warn("Cannot add tool modality. Missing tool map."):r.logger.warn("Cannot add tool modality. Missing tool name.")},this.__onEventHandled=function(e){this.propagateInputEventTypes.includes(e.type)||(e.preventDefault(),e.stopPropagation())}}Object.defineProperty(l,"_lastTouchedElement",{value:null,writable:!0}),s.GlobalManagerMixin.call(l.prototype)},77702:(e,t,n)=>{"use strict";function i(){this.names=["unnamed"],this.getNames=function(){return this.names},this.getName=function(){return this.names[0]},this.getPriority=function(){return 0},this.register=function(){},this.deregister=function(){},this.activate=function(e,t){},this.deactivate=function(e){},this.update=function(e){return!1},this.handleSingleClick=function(e,t){return!1},this.handleDoubleClick=function(e,t){return!1},this.handleSingleTap=function(e){return!1},this.handleDoubleTap=function(e){return!1},this.handleKeyDown=function(e,t){return!1},this.handleKeyUp=function(e,t){return!1},this.handleWheelInput=function(e){return!1},this.handleButtonDown=function(e,t){return!1},this.handleButtonUp=function(e,t){return!1},this.handleMouseMove=function(e){return!1},this.handleGesture=function(e){return!1},this.handleBlur=function(e){return!1},this.handleResize=function(){}}n.r(t),n.d(t,{ToolInterface:()=>i})},93382:(e,t,n)=>{"use strict";n.r(t),n.d(t,{UnifiedCamera:()=>h});var i=n(16453),r=n(98926);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t){return s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},s(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=u(e);if(t){var r=u(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return c(this,n)}}function c(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(c,e);var t,n,r,o=l(c);function c(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(n=o.call(this)).fov=45,n.near=.1,n.far=1e5,n.aspect=e/t,n.left=-e/2,n.right=e/2,n.top=t/2,n.bottom=-t/2,n.clientWidth=e,n.clientHeight=t,n.target=new i.Vector3(0,0,-1),n.worldup=new i.Vector3(0,1,0),n.orthographicCamera=new i.OrthographicCamera(n.left,n.right,n.top,n.bottom,n.near,n.far),n.perspectiveCamera=new i.PerspectiveCamera(n.fov,n.aspect,n.near,n.far),n.zoom=1,n.disableXr=!1,n.globalOffset=new i.Vector3,n.toPerspective(),n}return t=c,n=[{key:"clone",value:function(e){return(e=e||new c(2*this.right,2*this.top)).copy(this),e.position.copy(this.position),e.up.copy(this.up),this.target&&(e.target=this.target.clone()),this.worldup&&(e.worldup=this.worldup.clone()),this.worldUpTransform&&(e.worldUpTransform=this.worldUpTransform.clone()),e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e.fov=this.fov,e.aspect=this.aspect,e.zoom=this.zoom,e.clientWidth=this.clientWidth,e.clientHeight=this.clientHeight,e.isPerspective=this.isPerspective,e.globalOffset=this.globalOffset.clone(),e.orthoScale=this.orthoScale,this.updateProjectionMatrix(),e}},{key:"__computeFovPosition",value:function(e){if(Math.abs(this.fov-e)<=1e-4)return this.position.clone();var t,n,r=this.target.clone().sub(this.position),o=r.clone().normalize(),a=i.Math.degToRad(this.fov),s=i.Math.degToRad(e),l=Math.tan(.5*a)/Math.tan(.5*s);this.pivot?(t=(new i.Plane).setFromNormalAndCoplanarPoint(o.clone().negate(),this.pivot).distanceToPoint(this.position),n=o.clone().multiplyScalar(t).add(this.position)):(t=r.length(),n=this.target),t*=l;var c=o.multiplyScalar(-t);return n.clone().add(c)}},{key:"toPerspective",value:function(){!this.isPerspective&&this.saveFov&&(this.position.copy(this.__computeFovPosition(this.saveFov)),this.fov=this.saveFov),this.perspectiveCamera.aspect=this.aspect,this.perspectiveCamera.near=this.near,this.perspectiveCamera.far=this.far,this.perspectiveCamera.fov=this.fov/this.zoom,this.perspectiveCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspectiveCamera.projectionMatrix,this.projectionMatrixInverse=this.perspectiveCamera.projectionMatrixInverse,this.isPerspective=!0}},{key:"toOrthographic",value:function(){if(this.isPerspective){this.saveFov=this.fov;var e=c.ORTHO_FOV;this.position.copy(this.__computeFovPosition(e)),this.fov=e}this.orthoScale=this.target.clone().sub(this.position).length();var t=.5*this.orthoScale,n=t*this.aspect;this.left=this.orthographicCamera.left=-n,this.right=this.orthographicCamera.right=n,this.top=this.orthographicCamera.top=t,this.bottom=this.orthographicCamera.bottom=-t,this.orthographicCamera.near=this.near,this.orthographicCamera.far=this.far,this.orthographicCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthographicCamera.projectionMatrix,this.projectionMatrixInverse=this.orthographicCamera.projectionMatrixInverse,this.isPerspective=!1}},{key:"updateProjectionMatrix",value:function(){this.isPerspective?this.toPerspective():this.toOrthographic()}},{key:"setSize",value:function(e,t){this.aspect=e/t,this.left=-e/2,this.right=e/2,this.top=t/2,this.bottom=-t/2}},{key:"setFov",value:function(e){this.fov=e,this.updateProjectionMatrix()}},{key:"setLens",value:function(e,t){void 0===t&&(t=24);var n=2*i.Math.radToDeg(Math.atan(t/(2*e)));return this.setFov(n),n}},{key:"setViewFromBox",value:function(e,t){c.getViewParamsFromBox(e,t,this.aspect,this.up,this.fov,this),this.updateCameraMatrices()}},{key:"updateCameraMatrices",value:function(){this.lookAt(this.target),this.updateProjectionMatrix(),this.updateMatrixWorld()}},{key:"setView",value:function(e){e.position&&this.position.copy(e.position),e.target&&this.target.copy(e.target),e.up&&this.up.copy(e.up),void 0!==e.isPerspective&&(this.isPerspective=e.isPerspective),void 0!==e.orthoScale&&(this.orthoScale=e.orthoScale),this.updateCameraMatrices()}},{key:"pixelsPerUnitAtDistance",value:function(e){if(!this.isPerspective)return this.clientHeight/this.orthoScale;var t=2*e*Math.tan(i.Math.degToRad(.5*this.fov));return this.clientHeight/t}},{key:"UnifpixelsPerUnitAtPoint",value:function(e){var t=this.position.distanceTo(e);return this.pixelsPerUnitAtDistance(t)}},{key:"setGlobalOffset",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e!==this.position&&e!==this.target&&e!==this.pivot||(e=e.clone()),n&&(this.position.add(this.globalOffset).sub(e),this.target.add(this.globalOffset).sub(e),null===(t=this.pivot)||void 0===t||t.add(this.globalOffset).sub(e)),this.globalOffset.copy(e)}},{key:"getGlobalPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new i.Vector3;return e.copy(this.position).add(this.globalOffset)}},{key:"viewportToRay",value:function(e,t){e.z=-1;var n=new i.Vector3(e.x,e.y,1);return e=e.unproject(this),(n=n.unproject(this)).sub(e).normalize(),t||(t=new i.Ray),t.set(this.isPerspective?this.position:e,n),t}}],n&&a(t.prototype,n),r&&a(t,r),c}(i.Camera);h.ORTHO_FOV=2*Math.atan(.5)*180/Math.PI,h.getViewParamsFromBox=function(e,t,n,r,o,a){var s=a||{},l=e.getSize(new i.Vector3);if(s.target=e.getCenter(new i.Vector3),s.position||(s.position=new i.Vector3),s.up||(s.up=new i.Vector3),t){s.isPerspective=!1;var c=l.x/l.y,u=n;s.orthoScale=u>c?l.y:l.x/u,s.up.set(0,1,0),s.position.copy(s.target),s.position.z+=s.orthoScale,s.target.y+=1e-6*l.y}else s.isPerspective=!0,s.fov=o,s.up.copy(r),s.position.copy(s.target),s.position.z+=1.5*Math.max(l.x,l.y,l.z);return s},h.copyViewParams=function(e,t){return(t=t||{}).position=(t.position||new i.Vector3).copy(e.position),t.target=(t.target||new i.Vector3).copy(e.target),t.up=(t.up||new i.Vector3).copy(e.up),t.aspect=e.aspect,t.fov=e.fov,t.isPerspective=e.isPerspective,t.orthoScale=e.orthoScale,t},h.transformViewParams=function(e,t){e.position.applyMatrix4(t),e.target.applyMatrix4(t),e.up.transformDirection(t)},h.adjustOrthoCamera=function(e,t){if(!e.isPerspective){var n=t.getSize(new i.Vector3),o=e.target.clone().sub(e.position),a=o.length();if(a>1e3*n.length()&&!t.isEmpty()){var s=e.position.distanceTo(t.getCenter(new i.Vector3));e.target.copy(e.position).add(o.normalize().multiplyScalar(s))}else{if(Math.abs(a-e.orthoScale)/a>1e-5)r.logger.warn("Ortho scale does not match eye-target distance. One of them is likely wrong, but which one?"),!(0===e.fov&&1===e.orthoScale)&&e.position.copy(e.target).add(o.normalize().multiplyScalar(-e.orthoScale))}}}},25406:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ViewingUtilities:()=>r});var i=n(16453);function r(e,t,n){this.autocam=t,this.viewerImpl=e,this.setGlobalManager(this.viewerImpl.globalManager);var r=n.getCamera(),o={},a={};var s=new function(e){var t=.6,n=0,r=new i.SphereGeometry(1),o=new i.MeshPhongMaterial({color:32512,ambient:32512,opacity:t,transparent:!0}),a=new i.Mesh(r,o),s=e,l=1;s.createOverlayScene("pivot"),a.visible=!1,this.shown=function(){return a.visible},this.show=function(e,i,r){a.scale.x=i*l,a.scale.y=i*l,a.scale.z=i*l,a.position.set(e.x,e.y,e.z),o.opacity=t,a.visible=!0,s.addOverlay("pivot",a),s.invalidate(!1,!1,!0),n=r?Date.now()+500:0},this.hide=function(){a.visible&&(a.visible=!1,s.removeOverlay("pivot",a),s.invalidate(!1,!1,!0),n=0)},this.fade=function(){if(n>0){var e=n-Date.now();if(e<=0)return this.hide(),!0;var i=e/500*t;return o.opacity=i,!0}return!1},this.fading=function(){return n>0},this.setSize=function(e){l=e},this.setColor=function(e,n){o.color=new i.Color(e),void 0!==n&&(t=n,o.opacity=t)}}(this.viewerImpl);this.transitionView=function(e,i,o,a,s,l,c){s=s||n.getWorldUpVector();var u=l?function(e,t,n){var i=t.clone().sub(e);if(0===i.lengthSq())return i.copy(n);var r=i.clone().cross(n);return 0===r.lengthSq()&&(n.z>n.y?i.y-=1e-4:i.z-=1e-4,r.crossVectors(i,n)),r.cross(i).normalize()}(e,i,s):a;u||(u=r.up);var h={position:e,center:i,pivot:c=c||i,fov:o,up:u,worldUp:s,isOrtho:!1===r.isPerspective};t.goToView(h)},this.goHome=function(){this.viewerImpl.track({name:"navigation/home",aggregate:"count"}),t.goHome()},this.getHitPoint=function(e,t){var i=this.viewerImpl.hitTestViewport(n.screenToViewport(e,t),!1);return i?i.intersectPoint:null},this.activatePivot=function(e){if(this.viewerImpl.model&&!this.viewerImpl.model.is2d()){var t=r.isPerspective?n.getPivotPlaneDistance():n.getEyeVector().length(),o=n.getVerticalFov(),a=2*t*Math.tan(i.Math.degToRad(.5*o)),l=n.getScreenViewport(),c=this.getWindow().devicePixelRatio||1,u=5*a/(l.height*c);s.show(n.getPivotPoint(),u,e)}},this.pivotActive=function(e,t){t=t||!1,(e=e&&!n.getIs2D())||!s.shown()?e&&this.activatePivot(t):s.hide()},this.pivotUpdate=function(){s.shown()&&s.fade()&&this.viewerImpl.invalidate(!1,!1,!0)},this.setPivotPoint=function(e,t,i){n.setPivotPoint(e),t||n.setTarget(e),i&&n.setPivotSetFlag(!0),this.setTemporaryPivot(null),n.getIs2D()||s.shown()&&this.activatePivot(s.fading())},this.savePivot=function(e){e||(e="default"),o[e]=n.getPivotPoint(),a[e]=n.getPivotSetFlag()},this.restorePivot=function(e){if(e||(e="default"),o[e]){var t=a[e];this.setPivotPoint(o[e],!0,t),t||n.setPivotSetFlag(!1),delete o[e],delete a[e]}},this.setTemporaryPivot=function(e){if(e){var t=n.getPivotPoint(),i=n.getPivotSetFlag();this.setPivotPoint(e,!0,i),o.TEMP=t,a.TEMP=i}else delete o.TEMP,delete a.TEMP},this.removeTemporaryPivot=function(){this.restorePivot("TEMP")},this.setPivotSize=function(e){s.setSize(e)},this.setPivotColor=function(e,t){s.setColor(e,t)},this.getBoundingBox=function(e){return this.viewerImpl.getFitBounds(e)},this.fitToView=function(e){this.viewerImpl.track({name:"navigation/fit",aggregate:"count"}),this.viewerImpl.fitToView(this.viewerImpl.selector.getAggregateSelection(),e),this.activatePivot(!0)},this.update=function(){n.getRequestFitToView()&&!n.getTransitionActive()&&(n.setRequestFitToView(!1),this.fitToView()),n.getRequestHomeView()&&!n.getTransitionActive()&&(n.setRequestHomeView(!1),this.goHome());var e=n.getRequestTransition();return e&&!n.getTransitionActive()&&(n.setRequestTransition(!1),this.transitionView(e.position,e.coi,e.fov,e.up,e.worldUp,e.reorient,e.pivot)),!1}}n(35449).GlobalManagerMixin.call(r.prototype)},30093:(e,t,n)=>{"use strict";n.r(t),n.d(t,{VisibilityManager:()=>a,MultiModelVisibilityManager:()=>s});var i=n(98926),r=n(37169);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){this.viewerImpl=e,this.model=t,this.isolatedNodes=[],this.hiddenNodes=[]}function s(e){this.viewerImpl=e,this.models=[]}function l(e){var t=e.getAggregateIsolatedNodes();if(1===e.models.length){var n={type:r.ISOLATE_EVENT,nodeIdArray:t.length?t[0].ids:[],model:e.models[0]};e.viewerImpl.api.dispatchEvent(n)}n={type:r.AGGREGATE_ISOLATION_CHANGED_EVENT,isolation:t};e.viewerImpl.api.dispatchEvent(n)}a.prototype.getInstanceTree=function(){return this.model?this.model.getData().instanceTree:null},a.prototype.getIsolatedNodes=function(){return this.isolatedNodes.slice(0)},a.prototype.getHiddenNodes=function(){return this.hiddenNodes.slice(0)},a.prototype.setAllVisibility=function(e){var t=this.model?this.model.getRootId():null;t&&this.setVisibilityOnNode(t,e),this.model.getData().is2d&&this.model.setAllVisibility(e)},a.prototype.isNodeVisible=function(e){var t=this.getInstanceTree();return t?!t.isNodeHidden(e):-1==this.hiddenNodes.indexOf(e)&&(0==this.isolatedNodes.length||-1!=this.isolatedNodes.indexOf(e))},a.prototype.isolate=function(e){var t=this.getInstanceTree(),n=t?t.getRootId():null,i="number"==typeof e&&e===n||"object"==o(e)&&e.dbId===n;e&&!i?this.isolateMultiple(Array.isArray(e)?e:[e]):this.isolateNone()},a.prototype.isolateNone=function(){this.model.setAllVisibility(!0),this.viewerImpl.sceneUpdated(!0),this.setAllVisibility(!0),this.hiddenNodes=[],this.isolatedNodes=[],this.viewerImpl.invalidate(!0)},a.prototype.isolateMultiple=function(e){if(e&&0!=e.length){this.model.getData().is2d||(this.model.setAllVisibility(!1),this.viewerImpl.sceneUpdated(!0)),this.setAllVisibility(!1),this.isolatedNodes=e.slice(0),this.hiddenNodes=[];for(var t=0;t<e.length;t++)this.setVisibilityOnNode(e[t],!0)}else this.isolateNone();this.viewerImpl.invalidate(!0)},a.prototype.hide=function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(Array.isArray(e)){for(var i=0;i<e.length;++i)this.setVisibilityOnNode(e[i],!1);e.length>0&&(t={type:r.HIDE_EVENT,nodeIdArray:e,model:this.model})}else this.setVisibilityOnNode(e,!1),t={type:r.HIDE_EVENT,nodeIdArray:[e],model:this.model};t&&n&&this.viewerImpl.api.dispatchEvent(t)},a.prototype.show=function(e){var t;if(Array.isArray(e)){for(var n=0;n<e.length;++n)this.setVisibilityOnNode(e[n],!0);e.length>0&&(t={type:r.SHOW_EVENT,nodeIdArray:e,model:this.model})}else this.setVisibilityOnNode(e,!0),t={type:r.SHOW_EVENT,nodeIdArray:[e],model:this.model};t&&this.viewerImpl.api.dispatchEvent(t)},a.prototype.toggleVisibility=function(e){var t=this.getInstanceTree().isNodeHidden(e);this.setVisibilityOnNode(e,t);var n={type:t?r.SHOW_EVENT:r.HIDE_EVENT,nodeIdArray:[e],model:this.model};this.viewerImpl.api.dispatchEvent(n)},a.prototype.setVisibilityOnNode=function(e,t){var n,i=this.viewerImpl,r=this.model,o=this.getInstanceTree(),a=!t,s=r.getData().is2d;this.viewerImpl.matman();o?o.enumNodeChildren(e,(function(e){var n=o.isNodeVisibleLocked(e);if(o.setNodeHidden(e,a&&!n),s){var i=r.reverseMapDbIdFor2D(e);r.getFragmentList().setObject2DGhosted(i,!t&&!n)}else o.enumNodeFragments(e,(function(e){r.setVisibility(e,t||n)}),!1)}),!0):s?r.isLeaflet()?r.setVisibility(null,t):null===(n=r.getFragmentList())||void 0===n||n.setObject2DGhosted(e,!t):r.setVisibility(e,t);i.sceneUpdated(!0),this.updateNodeVisibilityTracking(e,t)},a.prototype.updateNodeVisibilityTracking=function(e,t){var n=t;if(this.isolatedNodes.length>0){var i=this.isolatedNodes.indexOf(e);n&&-1===i?this.isolatedNodes.push(e):n||-1===i||(this.isolatedNodes.splice(i,1),0===this.isolatedNodes.length&&(this.hiddenNodes=[this.model.getRootId()]))}else{var r=this.hiddenNodes.indexOf(e);n||-1!==r?n&&-1!==r&&this.hiddenNodes.splice(r,1):this.hiddenNodes.push(e)}var o=this.getInstanceTree();o&&o.root&&o.root.dbId===e&&(t?(this.isolatedNodes=[],this.hiddenNodes=[]):(this.isolatedNodes=[],this.hiddenNodes=[e]))},a.prototype.toggleNodeVisibleLocked=function(e){var t=this.getInstanceTree().isNodeVisbileLocked(e);this.lockNodeVisible(e,!t)},a.prototype.lockNodeVisible=function(e,t){var n=this,i=this.viewerImpl,r=this.model,o=this.getInstanceTree(),a=r.getData().is2d;if(o){var s=function(e){o.enumNodeChildren(e,(function(e){if(o.lockNodeVisible(e,t),t)if(o.setNodeHidden(e,!1),a){var n=r.reverseMapDbIdFor2D(e);r.getFragmentList().setObject2DGhosted(n,!1)}else o.enumNodeFragments(e,(function(e){r.setVisibility(e,!0)}),!1)}),!0),t&&(i.sceneUpdated(!0),n.updateNodeVisibilityTracking(e,t))};Array.isArray(e)?e.forEach(s):s(e)}},a.prototype.isNodeVisibleLocked=function(e){var t=this.getInstanceTree();return t&&t.isNodeVisibleLocked(e)},a.prototype.setNodeOff=function(e,t,n,i){var r,o,a=this.viewerImpl,s=this.model,l=this.getInstanceTree(),c=s.getData().is2d;if(!l)return c?s.getFragmentList().setObject2DVisible(e,!t):s.getFragmentList().setFragOff(e,t),void a.sceneUpdated(!0);if(n&&i)if(c)for(var u=0;u<n.length;++u){r=n[u],l.setNodeOff(r,t);var h=s.reverseMapDbIdFor2D(r);s.getFragmentList().setObject2DVisible(h,!t)}else{for(var d=0;d<n.length;++d)r=n[d],l.setNodeOff(r,t);for(var p=0;p<i.length;++p)o=i[p],s.getFragmentList().setFragOff(o,t)}else l.enumNodeChildren(e,(function(e){if(l.setNodeOff(e,t),c){var n=s.reverseMapDbIdFor2D(e);s.getFragmentList().setObject2DVisible(n,!t)}else l.enumNodeFragments(e,(function(e){s.getFragmentList().setFragOff(e,t)}),!1)}),!0);a.sceneUpdated(!0)},s.prototype.addModel=function(e){-1==this.models.indexOf(e)&&(e.visibilityManager=new a(this.viewerImpl,e),this.models.push(e))},s.prototype.removeModel=function(e){var t=this.models.indexOf(e);e.visibilityManager.isolateNone(),e.visibilityManager=null,this.models.splice(t,1)},s.prototype.warn=function(){this.models.length>1&&i.logger.warn("This selection call does not yet support multiple models.")},s.prototype.getAggregateIsolatedNodes=function(){for(var e=[],t=this.models,n=0;n<t.length;n++){var i=t[n].visibilityManager.getIsolatedNodes();i&&i.length&&e.push({model:t[n],ids:i})}return e},s.prototype.getIsolatedNodes=function(e){return e||(this.warn(),e=this.models[0]),e.visibilityManager.getIsolatedNodes()},s.prototype.getAggregateHiddenNodes=function(){for(var e=[],t=this.models,n=0;n<t.length;n++){var i=t[n].visibilityManager.getHiddenNodes();i&&i.length&&e.push({model:t[n],ids:i})}return e},s.prototype.getHiddenNodes=function(e){return e||(this.warn(),e=this.models[0]),e.visibilityManager.getHiddenNodes()},s.prototype.isNodeVisible=function(e,t){return e||(this.warn(),e=this.models[0]),e.visibilityManager.isNodeVisible(t)},s.prototype.isolate=function(e,t){t||(this.warn(),t=this.models[0]),t.visibilityManager.isolate(e),l(this)},s.prototype.aggregateIsolate=function(e,t){if(e&&0!==e.length){var n=this.models.concat();for(s=0;s<e.length;++s){var i=e[s].model,r=e[s].ids||e[s].selection,o=n.indexOf(i);n.splice(o,1),i.visibilityManager.isolate(r)}for(var a=!t||void 0!==t.hideLoadedModels&&t.hideLoadedModels;n.length&&a;)n.pop().visibilityManager.setAllVisibility(!1)}else for(var s=0;s<this.models.length;++s)this.models[s].visibilityManager.isolateNone();l(this)},s.prototype.hide=function(e,t){t||(this.warn(),t=this.models[0]),t.visibilityManager.hide(e)},s.prototype.aggregateHide=function(e){if(e&&0!==e.length){for(var t=0;t<e.length;++t){var n=e[t].model,i=e[t].ids||e[t].selection;n.visibilityManager.hide(i,1===this.models.length)}var o=this.getAggregateHiddenNodes(),a={type:r.AGGREGATE_HIDDEN_CHANGED_EVENT,hidden:o};this.viewerImpl.api.dispatchEvent(a)}},s.prototype.show=function(e,t){t||(this.warn(),t=this.models[0]),t.visibilityManager.show(e)},s.prototype.toggleVisibility=function(e,t){t||(this.warn(),t=this.models[0]),t.visibilityManager.toggleVisibility(e)},s.prototype.setVisibilityOnNode=function(e,t,n){n||(this.warn(),n=this.models[0]),n.visibilityManager.setVisibilityOnNode(e,t)},s.prototype.toggleVisibleLocked=function(e,t){t||(this.warn(),t=this.models[0]),t.visibilityManager.toggleVisibleLocked(e)},s.prototype.lockNodeVisible=function(e,t,n){n||(this.warn(),n=this.models[0]),n.visibilityManager.lockNodeVisible(e,t)},s.prototype.isNodeVisibleLocked=function(e,t){return t||(this.warn(),t=this.models[0]),t.visibilityManager.isNodeVisibleLocked(e,t)},s.prototype.setNodeOff=function(e,t,n,i,r){n||(this.warn(),n=this.models[0]),n.visibilityManager.setNodeOff(e,t,i,r)}},82803:(e,t,n)=>{"use strict";n.r(t),n.d(t,{WorldUpTool:()=>o});var i=n(16453),r=n(37169);function o(e,t){var n,o=t.navigation,a=o.getCamera(),s=["worldup"],l=this,c=(n=new i.Vector3,function(e,t,r,o){var a=new i.Vector3(e,t,r),s=o.dot(a);return n.copy(o),n.multiplyScalar(s),a.sub(n)});var u=2*Math.PI,h=.001,d=1e-5,p=!1,f=!1,m=!1,g=new function(e,t){var n=12303291,r=2*Math.tan(i.Math.degToRad(15)),a=new i.MeshPhongMaterial({color:n,ambient:n,opacity:.5,transparent:!0,depthTest:!1,depthWrite:!1}),s=new i.Vector3,l=new i.Vector3,h=new i.Quaternion,p=new i.PerspectiveCamera(30,t.aspect,t.near,t.far),f=t,m=1,g=1,v=null,y=null,b=null,_=null,x=null,E=null,w=null,S=null,A=null,M=new Array(6),T=0,C=!1,P=!0,L=0,R=5*Math.PI/180,D=7*Math.PI/180,I=1,O=1e3;function N(e,t){var n=Math.abs(e-t);return n>u?n:Math.min(u-n,n)}function k(e,t){var n=V(e);return n.distanceToSquared(t)<d||(l.set(-t.x,-t.y,-t.z),n.distanceToSquared(l)<d)}function F(e){return e>u?e:e<=0?e+Math.PI:e-Math.PI}function U(e,t,n){var i,r=e.clone().normalize(),o=new Array(3),a=new Array(6);o[0]=c(1,0,0,r),o[1]=c(0,1,0,r),o[2]=c(0,0,1,r);var s=t.clone().cross(r).normalize();for(i=0;i<3;++i){var u=o[i];a[i]=u.length(),a[i]<.1?M[i]=O:(u.multiplyScalar(1/a[i]),M[i]=Math.atan2(s.dot(u),t.dot(u)))}for(M[3]=F(M[0]),M[4]=F(M[1]),M[5]=F(M[2]),a[3]=a[0],a[4]=a[1],a[5]=a[2],function(e,t){for(var n=R+D+2*Math.PI/180,i=0;i<6;++i)if(M[i]!==O)for(var r=i+1;r<6;++r)if(M[r]!==O&&N(M[i],M[r])<n){if(e[i]<e[r]&&!k(i,t)||k(r,t)){M[i]=O;break}M[r]=O}}(a,n),i=0;i<6;++i)if(M[i]!==O){var d=l.set(0,0,1);h.setFromAxisAngle(d,M[i]);var p=l.set(0,.54,0);p.applyQuaternion(h),S[i].position.copy(p),S[i].visible=!0}else S[i].visible=!1}function B(e,t,n,r,s){return E||(E=function(){E=new i.Object3D;var e=new i.RingGeometry(.5-.01*m,.5,60),t=new i.Mesh(e,a);y=t;var n=.007*m,r=new i.BoxGeometry(.93,n,n),o=new i.BoxGeometry(n,.93,n),s=new i.BoxGeometry(n,n,.93);b=new i.Mesh(r,a),_=new i.Mesh(o,a),x=new i.Mesh(s,a),E.add(b),E.add(_),E.add(x),w=new i.Mesh(new i.CircleGeometry(.005),a),E.add(w),S=new Array(6),A=new Array(6);for(var l=0;l<6;++l){var c=.005*m,u=.0025*m;S[l]=new i.Mesh(new i.CircleGeometry(c,16),a),A[l]=new i.Mesh(new i.CircleGeometry(u,16),a),A[l].visible=!1,S[l].add(A[l]),t.add(S[l])}return E.add(t),E}()),o.orient(y,t,p.position,r),U(n,s,r),E.scale.x=e,E.scale.y=e,E.scale.z=e,E.position.copy(t),E}function V(e){if(s.set(0,0,0),e>=0){var t=e>=3?-1:1;0===(e%=3)&&(s.x=t),1===e&&(s.y=t),2===e&&(s.z=t)}return C&&s.multiplyScalar(-1),s}function G(e,t){for(var n=N(M[0],e),i=0,r=1;r<6;++r){var o=N(M[r],e);o<n&&(n=o,i=r)}return n,n<t?i:-1}function z(e){o.setWorldUpVector(e,!0)}function H(e){if(0!==e){var t=30*Math.PI/180,n=l.copy(p.position).sub(v).normalize();h.setFromAxisAngle(n,e);var i=o.getWorldUpVector(),r=Math.abs(n.angleTo(i));(r<t||Math.PI-r<t)&&i.copy(o.getCameraUpVector()),i.applyQuaternion(h),z(i)}}function W(e,t,n,i){return e<t&&V(n).distanceToSquared(i)<d}function j(e,t){e.dot(t)<0&&(t=t.clone().multiplyScalar(-1)),o.orient(w,v,p.position,t),w.position.copy(t.multiplyScalar(.495));for(var n=!1,i=P?D:R,r=0;r<6;++r){var a=N(M[r],T),s=W(a,i,r,e);s&&(n=!0);var l=s?4:3*(1-3*a/Math.PI);l<1&&(l=1),l*=m,A[r].visible=s;var c=S[r];c.scale.x=l,c.scale.y=l,c.scale.z=l}return b.visible=n,_.visible=n,x.visible=n,n}function q(e){(T+=e)>Math.PI?T-=u:T<=-Math.PI&&(T=u+T);var t=function(){if(!P){var e=G(T,R);if(e>=0)return 0,P=!0,T=M[e],V(e)}return!1}();if(t)L=T,z(t);else if(function(){if(P){if(G(T,D)<0)return P=!1,!0;0}return!1}()){H(T-L),L=0}else{if(P)return!1;H(e)}return!0}e.createOverlayScene("roll",null,null,p),this.updateRollCamera=function(e,t){p.position.copy(f.position),p.quaternion.copy(f.quaternion),p.up.copy(f.up),p.aspect=f.aspect,e&&t&&(p.near=t-e,p.far=t+e),p.updateProjectionMatrix()},this.isSnapped=function(){return P},this.resize=function(){var e=I*r,t=e*f.aspect,n=(f.aspect<1?t:e)*g;E.scale.x=n,E.scale.y=n,E.scale.z=n},this.start=function(t,n){this.updateHUD(t,n),e.addOverlay("roll",E)},this.updateHUD=function(e,t){v=e,t<.35?t=.35:t>.8&&(t=.8),g=t,m=.8/t;var n=s.copy(e).sub(f.position),i=(I=n.length())*r,a=i*f.aspect,l=(f.aspect<1?a:i)*t;this.updateRollCamera(l,I);var c=o.getWorldUpVector(),u=o.getCameraUpVector();B(l,e,n,c,u),T=0,L=0;var h=c.dot(u);C=h<0,P=j(c,u)},this.handleRoll=function(e,t,n){if(this.updateRollCamera(),j(o.getWorldUpVector(),o.getCameraUpVector()),0!==e||0!==t){var i=n.x-e-.5,r=n.y-t-.5,a=n.x-.5,s=n.y-.5;return q(Math.atan2(s,a)-Math.atan2(r,i))}return!1},this.handleRollTouch=function(e){this.updateRollCamera(),j(o.getWorldUpVector(),o.getCameraUpVector());var t=e-T;return Math.abs(t)>.001&&q(t)},this.end=function(){e.removeOverlay("roll",E)}}(e,a),v=new i.Vector3,y=new i.Vector3,b=new i.Vector3,_=null,x=0;this.getNames=function(){return s},this.getName=function(){return s[0]},this.activate=function(e){t.addEventListener(r.CAMERA_CHANGE_EVENT,this.handleCameraChange),m=!1},this.deactivate=function(e){g.end(),t.removeEventListener(r.CAMERA_CHANGE_EVENT,this.handleCameraChange),this.utilities.restorePivot(),_=null,p=!1,m=!1},this.getCursor=function(){return"auto"},this.getMotionDelta=function(e){var t=y.x-v.x,n=y.y-v.y,i=y.z-v.z;Math.abs(t)<h&&(t=0),Math.abs(n)<h&&(n=0),Math.abs(i)<h&&(i=0),e.set(t,n,i)},this.stepMotionDelta=function(){v.copy(y)},this.update=function(){if(!m){var e=o.getEyeVector(),t=.5*(a.near+a.far);e.normalize().multiplyScalar(t);var n=e.add(a.position);this.utilities.savePivot(),this.utilities.setPivotPoint(n,!0,!0),this.utilities.pivotActive(!0);g.start(n,.65),m=!0}var i=f;this.getMotionDelta(b);var r=b.x,s=b.y,l=b.z;return(f||"roll"===_||p&&(0!==r||0!==s||0!==l))&&(f="roll"===_?g.handleRollTouch(x):g.handleRoll(r,s,y)),this.stepMotionDelta(),a.dirty&&(i=!0),i},this.handleResize=function(){g.resize(),f=!0},this.handleGesture=function(e){switch(e.type){case"dragstart":return _="drag",this.handleButtonDown(e,0);case"dragmove":return this.handleMouseMove(e);case"dragend":return _=null,this.handleButtonUp(e,0);case"rotatestart":return t.removeEventListener(r.CAMERA_CHANGE_EVENT,this.handleCameraChange),_="roll",x=i.Math.degToRad(e.rotation),{x:.5*(e.normalizedX+1),y:1-.5*(e.normalizedY+1)},function(e){var t=e.pointers[1].clientX-e.pointers[0].clientX,n=e.pointers[1].clientY-e.pointers[0].clientY,i=Math.sqrt(t*t+n*n),r=o.getScreenViewport();return i/Math.min(r.width,r.height)}(e),!0;case"rotatemove":return x=i.Math.degToRad(e.rotation),"roll"===_;case"rotateend":return t.addEventListener(r.CAMERA_CHANGE_EVENT,this.handleCameraChange),x=i.Math.degToRad(e.rotation),_=null,!1}return!1},this.handleWheelInput=function(e){return!0},this.handleCameraChange=function(){var e=o.getEyeVector(),t=.5*(a.near+a.far);e.normalize().multiplyScalar(t);var n=e.add(a.position);g.updateHUD(n,.65)},this.handleButtonDown=function(e,n){return v.x=.5*(e.normalizedX+1),v.y=1-.5*(e.normalizedY+1),y.copy(v),p=!0,_=null,this.controller.setIsLocked(!0),t.removeEventListener(r.CAMERA_CHANGE_EVENT,l.handleCameraChange),!0},this.handleButtonUp=function(e,n){return y.x=.5*(e.normalizedX+1),y.y=1-.5*(e.normalizedY+1),p=!1,f=!0,this.controller.setIsLocked(!1),t.addEventListener(r.CAMERA_CHANGE_EVENT,l.handleCameraChange),!0},this.handleMouseMove=function(e){return y.x=.5*(e.normalizedX+1),y.y=1-.5*(e.normalizedY+1),!0},this.handleBlur=function(e){return p=!1,_=null,!1}}},79757:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Autocam:()=>u});var i=n(16453),r=n(71224),o=n(35449),a=n(55412),s=Number.MIN_VALUE||3e-308,l=1e-5;function c(e){var t=1e-12;Math.abs(e.x)<t&&Math.abs(e.y)<t?e.set(0,0,e.z>0?1:-1):Math.abs(e.y)<t&&Math.abs(e.z)<t?e.set(e.x>0?1:-1,0,0):Math.abs(e.z)<t&&Math.abs(e.x)<t&&e.set(0,e.y>0?1:-1,0)}function u(e,t,n){var o=this,u=null,h=!1;this.cube=null,this.camera=e,this.renderer="WEBGL",this.startState={},this.navApi=t,this.orthographicFaces=!1,this.canvas=n,this.cameraChangedCallback=function(){},this.pivotDisplayCallback=function(){},this.transitionCompletedCallback=function(){};var d,p=Date.now(),f=!1;function m(t){h=!0,e.target.copy(o.center),e.pivot.copy(o.pivot),e.worldup?e.worldup.copy(o.sceneUpDirection):e.up.copy(o.sceneUpDirection),o.cameraChangedCallback(t),h=!1}function g(e,t){e.position.copy(e.globalPosition).sub(t),e.center.copy(e.globalCenter).sub(t),e.pivot.copy(e.globalPivot).sub(t)}this.recordTime=!0,this.dtor=function(){this.cube=null,this.cameraChangedCallback=null,this.pivotDisplayCallback=null,this.transitionCompletedCallback=null,this.canvas=null,this.recordTime=!1},this.registerCallbackCameraChanged=function(e){this.cameraChangedCallback=e},this.registerCallbackPivotDisplay=function(e){this.pivotDisplayCallback=e},this.registerCallbackTransitionCompleted=function(e){this.transitionCompletedCallback=e},this.showPivot=function(e){this.pivotDisplayCallback(e)},this.setWorldUpVector=function(e){h||e&&e.lengthSq()>0&&!e.normalize().equals(this.sceneUpDirection)&&(this.sceneUpDirection.copy(e),this.sceneFrontDirection.copy(this.getWorldFrontVector()),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),this.cube&&requestAnimationFrame(this.cube.render))},this.getWorldUpVector=function(){return this.sceneUpDirection.clone()},this.getWorldRightVector=function(){var e=this.sceneUpDirection.clone();return Math.abs(e.z)<=Math.abs(e.y)?e.set(e.y,-e.x,0):e.z>=0?e.set(e.z,0,-e.x):e.set(-e.z,0,e.x),e.normalize()},this.getWorldFrontVector=function(){return this.getWorldUpVector().cross(this.getWorldRightVector()).normalize()},this.goToView=function(e){if(this.navApi.isActionEnabled("gotoview")){var t={position:e.position.clone(),up:e.up.clone(),center:e.center.clone(),pivot:e.pivot.clone(),fov:e.fov,worldUp:e.worldUp.clone(),isOrtho:e.isOrtho};this.addGlobalPositions(t),o.elapsedTime=0,this.animateTransition(t)}},this.getCurrentView=function(){return{position:e.position.clone(),up:e.up.clone(),center:this.center.clone(),pivot:this.pivot.clone(),fov:e.fov,worldUp:this.sceneUpDirection.clone(),isOrtho:!1===e.isPerspective}},this.setCurrentViewAsHome=function(e){e?(this.navApi.setRequestFitToView(!0),f=!0):this.homeVector=this.getCurrentView()},this.setHomeViewFrom=function(e){var t=e.pivot?e.pivot:this.center,n=e.target?e.target:this.pivot,i=e.worldup?e.worldup:this.sceneUpDirection;this.homeVector={position:e.position.clone(),up:e.up.clone(),center:n.clone(),pivot:t.clone(),fov:e.fov,worldUp:i.clone(),isOrtho:!1===e.isPerspective},this.originalHomeVector={position:e.position.clone(),up:e.up.clone(),center:n.clone(),pivot:t.clone(),fov:e.fov,worldUp:i.clone(),worldFront:this.sceneFrontDirection.clone(),isOrtho:!1===e.isPerspective},this.addGlobalPositions(this.homeVector),this.addGlobalPositions(this.originalHomeVector)},this.toPerspective=function(){e.isPerspective||(e.toPerspective(),m(!1))},this.toOrthographic=function(){e.isPerspective&&(e.toOrthographic(),m(!1))},this.setOrthographicFaces=function(e){this.orthographicFaces=e},this.getViewType=function(){return this.orthographicFaces?a.VIEW_TYPES.PERSPECTIVE_ORTHO_FACES:e.isPerspective?a.VIEW_TYPES.PERSPECTIVE:a.VIEW_TYPES.ORTHOGRAPHIC},this.setViewType=function(e,t){switch(e){case a.VIEW_TYPES.ORTHOGRAPHIC:return this.setOrthographicFaces(!1),this.toOrthographic(),!0;case a.VIEW_TYPES.PERSPECTIVE:return this.setOrthographicFaces(!1),this.toPerspective(),!0;case a.VIEW_TYPES.PERSPECTIVE_ORTHO_FACES:return this.setOrthographicFaces(!0),void 0===t&&(t=this.isFaceView()),t?this.toOrthographic():this.toPerspective(),!0;default:return!1}},this.goHome=function(){this.navApi.isActionEnabled("gotoview")&&(this.navApi.setPivotSetFlag(!1),this.goToView(this.homeVector))},this.resetHome=function(){this.homeVector.position.copy(this.originalHomeVector.position),this.homeVector.up.copy(this.originalHomeVector.up),this.homeVector.center.copy(this.originalHomeVector.center),this.homeVector.pivot.copy(this.originalHomeVector.pivot),this.homeVector.fov=this.originalHomeVector.fov,this.homeVector.worldUp.copy(this.originalHomeVector.worldUp),this.homeVector.isOrtho=this.originalHomeVector.isOrtho,this.goHome()},this.getView=function(){return this.center.clone().sub(e.position)},this.setCameraUp=function(t){var n=this.dir.clone(),i=n.cross(t).normalize();0===i.lengthSq()&&(n.copy(this.dir),t.z>t.y?n.y+=1e-4:n.z+=1e-4,i=n.cross(t).normalize()),e.up.copy(i).cross(this.dir).normalize()},this.addGlobalPositions=function(e){var t=this.camera.globalOffset;e.globalPosition=e.position.clone().add(t),e.globalCenter=e.center.clone().add(t),e.globalPivot=e.pivot.clone().add(t)},this.onGlobalOffsetChanged=function(e){g(this.homeVector,e),g(this.originalHomeVector,e),this.camera.setGlobalOffset(e)};var v,b,_,E,w=this;!function e(){w.recordTime&&requestAnimationFrame(e);var t=Date.now();d=t-p,p=t}(),this.ortho=!1,this.center=e.target?e.target.clone():new i.Vector3(0,0,0),this.pivot=e.pivot?e.pivot.clone():this.center.clone(),this.sceneUpDirection=e.worldup?e.worldup.clone():e.up.clone(),this.sceneFrontDirection=this.getWorldFrontVector(),this.dir=this.getView(),this.setCameraUp(e.up),this.saveCenter=this.center.clone(),this.savePivot=this.pivot.clone(),this.saveEye=e.position.clone(),this.saveUp=e.up.clone(),this.cubeFront=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize(),this.setHomeViewFrom(e);var S,A,M=new i.Quaternion,T=new i.Quaternion,C=new i.Quaternion,P=new i.Quaternion;this.userPanSpeed=.5,this.userLookSpeed=2,this.userHeightSpeed=5,this.walkMultiplier=1,this.userZoomSpeed=1.015,this.orbitMultiplier=5,this.currentlyAnimating=!1,e.keepSceneUpright=!0,this.preserveOrbitUpDirection=!0,this.alignOrbitUpDirection=!0,this.constrainOrbitHorizontal=!1,this.constrainOrbitVertical=!1,this.doCustomOrbit=!1,this.snapOrbitDeadZone=.045,this.snapOrbitThresholdH=this.snapOrbitThresholdV=i.Math.degToRad(15),this.snapOrbitAccelerationAX=this.snapOrbitAccelerationAY=1.5,this.snapOrbitAccelerationBX=this.snapOrbitAccelerationBY=2,this.snapOrbitAccelerationPointX=this.snapOrbitAccelerationPointY=.5,this.combined=!1,this.useSnap=!1,this.lockDeltaX=0,this.lockedX=!1,this.lastSnapRotateX=0,this.lockDeltaY=0,this.lockedY=!1,this.lastSnapRotateY=0,this.lastSnapDir=new i.Vector3(0,0,0),this.topLimit=!1,this.bottomLimit=!1,this.minSceneBound=0,this.maxSceneBound=0;var L,R,D={destinationPercent:1,duration:1,zoomToFitScene:!0,useOffAxis:!1};this.shotParams=D,this.zoomDelta=new i.Vector2;var I;function O(e,t,n){if(e<=t)return 0;if(e>=n)return 1;var i=(e-t)/(n-t);return.5*(Math.sin((i-.5)*Math.PI)+1)}function N(e){return Math.round(10*e)/10}function k(e,t){var n=new i.Vector2(0,0),r=o.getWindow();return n.x=e/r.innerWidth,n.y=t/r.innerHeight,n}function F(e,t,n){var i,r,a,s;i=r=a=s=0;var l=0,c=null,u=null,h=o.snapOrbitDeadZone,d=o.orbitMultiplier;return"h"==e?(i=o.snapOrbitThresholdH,r=o.snapOrbitAccelerationAX,a=o.snapOrbitAccelerationBX,s=1-o.snapOrbitAccelerationPointX,u=o.lockDeltaX,c=o.lockedX):(i=o.snapOrbitThresholdV,r=o.snapOrbitAccelerationAY,a=o.snapOrbitAccelerationBY,s=1-o.snapOrbitAccelerationPointY,u=o.lockDeltaY,c=o.lockedY),c?(u+=n)<-h?(l=(u+h)*d*1/a,c=!1):u>h&&(l=(u-h)*d*1/a,c=!1):(l=Math.abs(t)>i?n*d:Math.abs(t)>s*i?n*t>0?n*d*r:n*d*1/r:n*t>0?n*d*a:n*d*1/a)*t>0&&Math.abs(l)>Math.abs(t)&&(this.lockDeltaX=this.lockDeltaY=0,c=!0,l=t),l}function U(){return o.combined}function B(e,t){var n=!1,i=o.getWindow(),r=i.innerWidth,a=e.x%r,s=i.innerHeight,l=e.y%s,c=a>0?a-t.x:r+a-t.x,u=l>0?l-t.y:s+l-t.y;return Math.abs(c)<30&&Math.abs(u)<30&&(n=!0),n}function V(e,t,n){var r=o.getWindow();if(!I||!e){if(e){var a=new i.Vector2,s=t.x,l=t.y;!function(e,t,n){var i=o.getWindow();n.x=(e.x-t.x)/i.innerWidth,e.x=t.x+(e.x-t.x)%i.innerWidth,n.y=(e.y-t.y)/i.innerHeight,e.y=t.y+(e.y-t.y)%i.innerHeight}(t,n,a),r.innerWidth*a.x,r.innerHeight*a.y,s<n.x?s-=60:s+=60,l<n.y?l-=60:l+=60}I=e}}function G(e){var t=Math.pow(e,2);e<0&&(t=-t);var n=k(0,t),i=.01*(o.maxSceneBound-o.minSceneBound);n.y*=i;var r=o.userHeightSpeed*n.y;return r=function(e,t,n){if(0===t)return 0;var i=e,r=o.saveEye.clone().sub(worldUp.clone().multiplyScalar(n+i)),a=o.saveEye.clone().sub(worldUp.clone().multiplyScalar(n)),s=0,l=(o.maxSceneBound-o.minSceneBound)/1e3;o.topLimit&&t>0?(s=o.maxSceneBound-l,o.topLimit=!1):o.bottomLimit&&t<0?(s=o.minSceneBound+l,o.bottomLimit=!1):s=r.dot(worldUp);var c=a.dot(worldUp);return s<o.minSceneBound?c<o.minSceneBound&&(o.bottomLimit=!0,i=0):s>o.maxSceneBound&&c>o.maxSceneBound&&(o.topLimit=!0,i=0),i}(r,e,o.m_amount),r}function z(e){var t=o.sceneFrontDirection.clone().cross(o.sceneUpDirection),n=Math.abs(Math.abs(e.dot(o.sceneUpDirection))-1),i=Math.abs(Math.abs(e.dot(o.sceneFrontDirection))-1),r=Math.abs(Math.abs(e.dot(t))-1);return n<l||i<l||r<l}this.viewCubeMenuOpen=!1,this.menuSize=new i.Vector2(0,0),this.menuOrigin=new i.Vector2(0,0),e.lookAt(this.center),this.setCube=function(e){this.cube=e},this.sync=function(t){t.isPerspective!==e.isPerspective&&(t.isPerspective?e.toPerspective():(e.toOrthographic(),t.saveFov&&(e.saveFov=t.saveFov))),e.fov=t.fov,e.position.copy(t.position),t.target&&(this.center.copy(t.target),e.target.copy(t.target)),t.pivot&&(this.pivot.copy(t.pivot),e.pivot.copy(t.pivot)),this.dir.copy(this.center).sub(e.position),this.setCameraUp(t.up);var n=t.worldup?t.worldup:t.up;n.distanceToSquared(this.sceneUpDirection)>1e-4&&this.setWorldUpVector(n),f&&!this.navApi.getTransitionActive()&&(f=!1,this.setCurrentViewAsHome(!1)),this.cube&&requestAnimationFrame(this.cube.render)},this.refresh=function(){this.cube&&this.cube.refreshCube()},i.Matrix3.prototype.makeRotationFromQuaternion=function(e){var t=this.elements,n=e.x,i=e.y,r=e.z,o=e.w,a=n+n,s=i+i,l=r+r,c=n*a,u=n*s,h=n*l,d=i*s,p=i*l,f=r*l,m=o*a,g=o*s,v=o*l;return t[0]=1-(d+f),t[3]=u-v,t[6]=h+g,t[1]=u+v,t[4]=1-(c+f),t[7]=p-m,t[2]=h-g,t[5]=p+m,t[8]=1-(c+d),this},i.Quaternion.prototype.setFromRotationMatrix3=function(e){var t,n=e.elements,i=n[0],r=n[3],o=n[6],a=n[1],s=n[4],l=n[7],c=n[2],u=n[5],h=n[8],d=i+s+h;return d>0?(t=.5/Math.sqrt(d+1),this.w=.25/t,this.x=(u-l)*t,this.y=(o-c)*t,this.z=(a-r)*t):i>s&&i>h?(t=2*Math.sqrt(1+i-s-h),this.w=(u-l)/t,this.x=.25*t,this.y=(r+a)/t,this.z=(o+c)/t):s>h?(t=2*Math.sqrt(1+s-i-h),this.w=(o-c)/t,this.x=(r+a)/t,this.y=.25*t,this.z=(l+u)/t):(t=2*Math.sqrt(1+h-i-s),this.w=(a-r)/t,this.x=(o+c)/t,this.y=(l+u)/t,this.z=.25*t),this},i.Quaternion.prototype.rotate=function(e){var t=(new i.Matrix4).makeRotationFromQuaternion(this).elements,n=(new i.Matrix3).set(t[0],t[1],t[2],t[4],t[5],t[6],t[8],t[9],t[10]);return e.applyMatrix3(n)},this.animateTransition=function(t){if(g(t,e.globalOffset),t){var n=!1,i=0;if(this.setCameraOrtho(t.isOrtho),o.elapsedTime>=D.duration)return i=1,o.center.copy(t.center),o.pivot.copy(t.pivot),e.position.copy(t.position),e.up.copy(t.up),e.target.copy(t.center),t.isOrtho||(e.fov=t.fov),e.dirty=!0,(n=!t.worldUp.equals(this.sceneUpDirection))&&this.setWorldUpVector(t.worldUp),this.currentlyAnimating=!1,m(n),this.showPivot(!1),this.cube&&requestAnimationFrame(this.cube.render),this.navApi.setTransitionActive(!1),void this.transitionCompletedCallback();this.currentlyAnimating=!0,this.showPivot(!0),this.navApi.setTransitionActive(!0);var r=D.destinationPercent,a=1-(i=O(o.elapsedTime/D.duration,0,r));o.elapsedTime+=d/500;var s=o.center.clone().multiplyScalar(a).add(t.center.clone().multiplyScalar(i)),l=e.position.clone().multiplyScalar(a).add(t.position.clone().multiplyScalar(i)),c=e.up.clone().multiplyScalar(a).add(t.up.clone().multiplyScalar(i)),u=e.pivot.clone().multiplyScalar(a).add(t.pivot.clone().multiplyScalar(i)),h=this.sceneUpDirection.clone().multiplyScalar(a).add(t.worldUp.clone().multiplyScalar(i)),p=e.fov*a+t.fov*i;o.center.copy(s),o.pivot.copy(u),e.position.copy(l),e.up.copy(c),e.target.copy(s),t.isOrtho||(e.fov=p),e.dirty=!0,(n=h.distanceToSquared(this.sceneUpDirection)>1e-4)&&this.setWorldUpVector(h),e.lookAt(o.center),m(n),this.cube&&requestAnimationFrame(this.cube.render),requestAnimationFrame((function(){o.animateTransition(t)}))}},this.sphericallyInterpolateTransition=function(t){var n,r,a,s,l=0;if(this.currentlyAnimating=!0,this.navApi.setTransitionActive(!0),o.elapsedTime>=D.duration)l=1,this.currentlyAnimating=!1;else{var c=D.destinationPercent;l=O(o.elapsedTime/D.duration,0,c),o.elapsedTime+=d/500}if(1===l)r=R.position,n=R.center,a=R.up;else{var u=new i.Matrix3,h=M.clone();h.slerp(T,l),u.makeRotationFromQuaternion(h);var p=S*(1-(s=l))+A*s,f=u.elements;r=(n=L.center.clone().multiplyScalar(1-l).add(R.center.clone().multiplyScalar(l))).clone().sub(new i.Vector3(f[0],f[1],f[2]).multiplyScalar(p)),a=new i.Vector3(f[3],f[4],f[5])}o.center.copy(n),e.position.copy(r),e.up.copy(a),o.navApi.getUsePivotAlways()||o.pivot.copy(n),e.lookAt(o.center),!0===this.currentlyAnimating?(this.showPivot(!0),requestAnimationFrame((function(){o.sphericallyInterpolateTransition(t)}))):(this.navApi.setTransitionActive(!1),this.showPivot(!1),this.orthographicFaces&&this.isFaceView()&&this.setCameraOrtho(!0),t&&t()),m(!1),this.cube&&requestAnimationFrame(this.cube.render)},this.getOrientation=function(){if(this.cube){var t=N(e.up.x),n=N(e.up.y),i=N(e.up.z),r=this.sceneFrontDirection.clone(),o=this.sceneUpDirection.clone(),a=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();r.x=N(r.x),r.y=N(r.y),r.z=N(r.z),o.x=N(o.x),o.y=N(o.y),o.z=N(o.z),a.x=N(a.x),a.y=N(a.y),a.z=N(a.z);var s=a.clone().multiplyScalar(-1),l=o.clone().multiplyScalar(-1),c=r.clone().multiplyScalar(-1);switch(this.cube.currentFace){case"front":if(o.x==t&&o.y==n&&o.z==i)return"up";if(l.x==t&&l.y==n&&l.z==i)return"down";if(a.x==t&&a.y==n&&a.z==i)return"right";if(s.x==t&&s.y==n&&s.z==i)return"left";break;case"right":if(o.x==t&&o.y==n&&o.z==i)return"up";if(l.x==t&&l.y==n&&l.z==i)return"down";if(c.x==t&&c.y==n&&c.z==i)return"left";if(r.x==t&&r.y==n&&r.z==i)return"right";break;case"left":if(o.x==t&&o.y==n&&o.z==i)return"up";if(l.x==t&&l.y==n&&l.z==i)return"down";if(r.x==t&&r.y==n&&r.z==i)return"left";if(c.x==t&&c.y==n&&c.z==i)return"right";break;case"back":if(o.x==t&&o.y==n&&o.z==i)return"up";if(l.x==t&&l.y==n&&l.z==i)return"down";if(s.x==t&&s.y==n&&s.z==i)return"right";if(a.x==t&&a.y==n&&a.z==i)return"left";break;case"top":if(c.x==t&&c.y==n&&c.z==i)return"down";if(r.x==t&&r.y==n&&r.z==i)return"up";if(a.x==t&&a.y==n&&a.z==i)return"right";if(s.x==t&&s.y==n&&s.z==i)return"left";break;case"bottom":if(r.x==t&&r.y==n&&r.z==i)return"down";if(c.x==t&&c.y==n&&c.z==i)return"up";if(a.x==t&&a.y==n&&a.z==i)return"right";if(s.x==t&&s.y==n&&s.z==i)return"left"}}},this.setCameraOrtho=function(t){t&&e.isPerspective&&e.toOrthographic(),t||e.isPerspective||e.toPerspective()},this.resetOrientation=function(){this.cube&&this.cube.showCompass(this.cube.prevRenderCompass),this.setCameraOrtho(this.originalHomeVector.isOrtho),this.sceneUpDirection.copy(this.originalHomeVector.worldUp),this.sceneFrontDirection.copy(this.originalHomeVector.worldFront),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),this.setCameraUp(this.sceneUpDirection),m(!0)},this.setCurrentViewAsFront=function(){this.cube&&(this.cube.currentFace="front",this.cube.showCompass(!1)),this.sceneUpDirection.copy(e.up.clone()),c(this.sceneUpDirection),this.sceneFrontDirection.copy(this.getView()).normalize(),c(this.sceneFrontDirection),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),c(this.cubeFront),this.orthographicFaces&&this.setCameraOrtho(!0),m(!0)},this.setCurrentViewAsTop=function(){this.cube&&(this.cube.currentFace="top",this.cube.showCompass(!1)),this.sceneUpDirection.copy(this.getView()).multiplyScalar(-1).normalize(),c(this.sceneUpDirection),this.sceneFrontDirection.copy(e.up),c(this.sceneFrontDirection),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),c(this.cubeFront),m(!0)},this.calculateCubeTransform=function(t){var n=this.sceneUpDirection.clone(),r=this.sceneFrontDirection.clone(),a=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();(L=e.clone()).center=o.center.clone(),L.pivot=o.pivot.clone(),(R=e.clone()).center=o.center.clone(),R.pivot=o.pivot.clone();var l=new i.Vector3(0,0,0);t.indexOf("back")>=0&&(l=l.add(r)),t.indexOf("front")>=0&&(l=l.sub(r)),t.indexOf("top")>=0&&(l=l.add(n)),t.indexOf("bottom")>=0&&(l=l.sub(n)),t.indexOf("right")>=0&&(l=l.add(a)),t.indexOf("left")>=0&&(l=l.sub(a));var c=n,u=l.clone().normalize();if(1-Math.abs(u.dot(n))<s)for(var h=this.getView().normalize(),d=[r.clone(),r.clone().negate(),a.clone(),a.clone().negate()],p=u.dot(n)>0?1:-1,f=h.clone().add(e.up.clone().multiplyScalar(p)).normalize(),m=-2,g=0;g<4;g++){var v=f.dot(d[g]);v>m&&(m=v,c=d[g].multiplyScalar(p))}A=S=this.getView().length(),R.position.copy(R.center.clone().add(l.multiplyScalar(A/l.length()))),R.up.copy(c);var y=L.center.clone().sub(L.position).normalize(),b=y.clone().cross(L.up).normalize(),_=b.clone().cross(y).normalize(),x=new i.Matrix3;x.set(y.x,_.x,b.x,y.y,_.y,b.y,y.z,_.z,b.z),M.setFromRotationMatrix3(x),_=(b=(y=R.center.clone().sub(R.position).normalize()).clone().cross(R.up).normalize()).clone().cross(y).normalize(),x.set(y.x,_.x,b.x,y.y,_.y,b.y,y.z,_.z,b.z),C.setFromAxisAngle(y,0),P.setFromAxisAngle(_,0),T.setFromRotationMatrix3(x),T.multiply(C).multiply(P).normalize()},this.drawDropdownMenu=function(e,t,n,i,o,a,s){var l=0,c=this.getDocument();if(u)a.appendChild(u);else{(u=c.createElement("div")).className="dropDownMenu",u.style.top="100px",u.style.left="-400px";for(var h=0,d=0,p=0;p<e.length;p++){var f;if(null===e[p])(f=c.createElement("li")).style.height="1px",h+=1,f.style.backgroundColor="#E0E0E0";else{var m=r.Z.t(e[p]);if(d=m.length>d?m.length:d,n[p]){f=c.createElement("div");var g=c.createElement("input"),v=c.createElement("label");g.type="radio",g.className="dropDownMenuCheck",v.innerHTML=m,v.className="dropDownMenuCheckText",f.appendChild(g),f.appendChild(v),f.className="dropDownMenuCheckbox"}else(f=c.createElement("li")).textContent=m,f.className=t[p]?"dropDownMenuItem":"dropDownMenuItemDisabled";f.id="menuItem"+l,l++,h+=25,f.setAttribute("data-i18n",e[p])}u.appendChild(f)}a.appendChild(u),u.style.minWidth=Math.max(256,7.4*d)+"px";var y=u.getBoundingClientRect().width;this.menuSize.x=y,this.menuSize.y=h}l=0;for(p=0;p<e.length;p++)if(null!==e[p]){if(n[p]){var b="menuItem"+l,_=c.getElementById(b);_&&(_.children[0].checked=n[p]())}l++}var x=o-15,E=i+1,w=this.canvas.getBoundingClientRect();E+this.menuSize.x>w.right&&(E=i-this.menuSize.x-1),x+this.menuSize.y>w.bottom&&(x=w.bottom-this.menuSize.y),x-=s.y,E-=s.x,u.style.top=x+"px",u.style.left=E+"px",this.menuOrigin.x=E,this.menuOrigin.y=x},this.removeDropdownMenu=function(e){e.removeChild(u)},this.isFaceView=function(){return z(this.center.clone().sub(e.position).normalize())&&z(e.up)},this.startInteraction=function(e,t){this.startCursor=new i.Vector2(e,t),this.startState={saveCenter:this.center.clone(),saveEye:this.camera.position.clone(),savePivot:this.pivot.clone(),saveUp:this.camera.up.clone()},this.lockDeltaX=0,this.lockedX=!1,this.lastSnapRotateX=0,this.lockDeltaY=0,this.lockedY=!1,this.lastSnapRotateY=0,this.lastSnapDir=new i.Vector3(0,0,0),this.navApi.setTransitionActive(!0)},this.orbit=function(t,n,r,a){if(this.navApi.isActionEnabled("orbit")&&!0!==this.currentlyAnimating){var s="wheel";if(o.orthographicFaces&&!e.isPerspective&&(e.toPerspective(),a&&a.saveEye.copy(this.camera.position)),a&&(s="cube"),"cube"==s?(this.saveCenter.copy(a.saveCenter),this.saveEye.copy(a.saveEye),this.savePivot.copy(a.savePivot),this.saveUp.copy(a.saveUp),this.useSnap=!0,this.doCustomOrbit=!0):(this.saveCenter.copy(this.center),this.savePivot.copy(this.pivot),this.saveEye.copy(e.position),this.saveUp.copy(e.up),this.useSnap=!1,this.doCustomOrbit=!1),U()&&null==b&&(b=this.saveCenter.clone(),v=this.saveEye.clone(),E=this.savePivot.clone(),_=this.saveUp.clone()),this.preserveOrbitUpDirection){var l=k(t.x-n.x,t.y-n.y),c=k(r.x,r.y),u=this.sceneUpDirection.clone(),h=this.sceneFrontDirection.clone(),d=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize(),p=U()?E:this.savePivot,f=U()?v:this.saveEye,g=U()?b:this.saveCenter,y=U()?_:this.saveUp,x=p.clone().sub(f).normalize(),w=g.clone().sub(f).normalize(),S=w.clone().cross(y),A=f.clone().sub(p).length(),M=f.clone().sub(g).length(),T=x.clone().multiplyScalar(-1),C=w.clone().multiplyScalar(-1),P=S,L=y.clone();if(!this.constrainOrbitHorizontal){u.dot(this.saveUp)<-.009&&(l.x=-l.x,c.x=-c.x);var R=0;R=U()?c.x*this.orbitMultiplier:this.useSnap?this.lastSnapRotateX+F("h",0,-c.x):l.x*this.orbitMultiplier,this.lastSnapRotateX=R;var D=(new i.Quaternion).setFromAxisAngle(u,-R);T.applyQuaternion(D),C.applyQuaternion(D),P.applyQuaternion(D),L.applyQuaternion(D)}if(!this.constrainOrbitVertical){var I=h.clone().multiplyScalar(h.dot(P)),O=d.clone().multiplyScalar(d.dot(P)),N=I.clone().add(O);N.clone().normalize();var B=0;if(U())B=c.y*this.orbitMultiplier;else{var V=F("v",0,c.y);B=this.useSnap?this.lastSnapRotateY+V:l.y*this.orbitMultiplier}var G=(new i.Quaternion).setFromAxisAngle(N,-B);if(this.navApi.getOrbitPastWorldPoles())T.applyQuaternion(G).normalize(),C.applyQuaternion(G).normalize(),L.applyQuaternion(G).normalize();else{var z=L.clone();if(z.applyQuaternion(G).normalize(),u.dot(z)<0){var H=C.clone();H.applyQuaternion(G).normalize();var W=H.angleTo(u);Math.abs(W)>.5*Math.PI&&(W-=W>0?Math.PI:-Math.PI),B-=W,G.setFromAxisAngle(N,-B),T.applyQuaternion(G).normalize(),C.applyQuaternion(G).normalize(),L.applyQuaternion(G).normalize()}else T.applyQuaternion(G).normalize(),C.applyQuaternion(G).normalize(),L.applyQuaternion(G).normalize()}this.lastSnapRotateY=B}var j=T.multiplyScalar(A).add(p);e.position.copy(j),e.up.copy(L),this.center.copy(j),this.center.sub(C.multiplyScalar(M)),U()&&(b.copy(this.center),v.copy(e.position),E.copy(this.pivot),_.copy(e.up))}e.lookAt(this.center),m(!1)}},this.endInteraction=function(){this.navApi.setTransitionActive(!1)},this.look=function(t){if(this.navApi.isActionEnabled("walk")){var n=k(t.x,t.y),r=this.userLookSpeed,o=this.getView(),a=e.up,s=o.clone().cross(a).normalize(),l=this.sceneUpDirection.clone(),c=n.clone();c.x*=Math.PI,c.y*=Math.PI/e.aspect,c.multiplyScalar(r);var u=(new i.Quaternion).setFromAxisAngle(s,-c.y);if(e.keepSceneUpright&&!this.navApi.getOrbitPastWorldPoles()){var h=a.clone();if(h.applyQuaternion(u).normalize(),h.dot(l)<0){var d=o.clone();d.applyQuaternion(u);var p=d.angleTo(l);Math.abs(p)>.5*Math.PI&&(p-=p>0?Math.PI:-Math.PI),c.y-=p,u.setFromAxisAngle(s,-c.y)}}o=u.clone().rotate(o),(a=u.clone().rotate(a)).normalize();var f=e.keepSceneUpright?l:a,g=(new i.Quaternion).setFromAxisAngle(f,-c.x);o=g.clone().rotate(o),a=g.clone().rotate(a),this.center.copy(o.add(e.position)),e.up.copy(a),e.lookAt(this.center),m(!1)}},this.pan=function(t){if(this.navApi.isActionEnabled("pan")){t=k(t.x,t.y);var n=this.getView(),r=e.up.clone().cross(n),o=n.clone().cross(r);r.normalize(),o.normalize(),n.normalize();var a=this.pivot.clone().sub(e.position),s=n.clone().dot(a),l=s*(Math.tan(i.Math.degToRad(e.leftFov))+Math.tan(i.Math.degToRad(e.rightFov))),c=s*(Math.tan(i.Math.degToRad(e.topFov))+Math.tan(i.Math.degToRad(e.bottomFov))),u=t.x*Math.abs(l),h=t.y*Math.abs(c),d=new i.Vector3,p=r.clone().multiplyScalar(u),f=o.clone().multiplyScalar(h);d=p.clone().add(f).clone().multiplyScalar(this.userPanSpeed),e.position.add(d),this.center.add(d),e.lookAt(this.center),m(!1)}},this.zoom=function(t){if(this.navApi.isActionEnabled("zoom")){var n=this.userZoomSpeed,i=Number.MAX_VALUE,r=t.x+t.y,a=Math.pow(n,r),s=this.pivot.clone().sub(this.pivot.clone().sub(this.saveEye).clone().multiplyScalar(a)),l=s.clone().add(o.D.clone().multiplyScalar(o.D.clone().dot(this.pivot.clone().sub(s).clone())));if(!(a>=i)){if(r>0){Math.pow(n,r-0);if(r<0)return void 0;e.position.copy(s),this.center.copy(l);var c=s.clone().sub(this.saveEye).dot(o.D);c>i?(e.position.copy(this.saveEye.sub(o.D).clone().multiplyScalar(i)),i>0?-1:0):-c/i}else e.position.copy(s),this.center.copy(l);e.lookAt(this.center),m(!1)}}},this.walk=function(t,n,r,o,a){if(this.navApi.isActionEnabled("walk")){var l=this.sceneUpDirection.clone(),c=this.sceneFrontDirection.clone(),u=this.sceneFrontDirection.clone().cross(this.sceneUpDirection);B(t,n)?(wheel.cursorImage("SWWalk"),V(!0,t,n),x=n.x,y=n.y):V(!1,t,n),x=t.x,y=t.y;var h=k(x-n.x,y-n.y),d=-h.x,p=-h.y,f=d<0?-1:1,g=p<0?-1:1,v=Math.abs(d),b=Math.abs(p),_=new i.Vector2(30,30);_=k(_.x,_.y),v=B(t,n)?0:Math.abs(d)-_.x,b=B(t,n)?0:Math.abs(p)-_.y;b/=.25;var E=(v=(v/=.25)<1?O(v,0,1):Math.pow(v,1))>0?v*f:0,w=(b=b<1?O(b,0,1):Math.pow(b,1))>0?b*g:0,S=this.getView(),A=S.length();S.normalize(),S.clone().cross(e.up).normalize();var M=u.clone().multiplyScalar(u.clone().dot(S)),T=c.clone().multiplyScalar(c.clone().dot(S)).clone().add(M);T=T.clone().length()>s?T.normalize():e.up;var C=w*(1*this.walkMultiplier),P=T,L=Math.cos(.65);1!=L&&(l.clone().dot(e.up)<-s&&l.clone().dot(S)<-L||l.clone().dot(e.up)>s&&l.clone().dot(S)>L)&&(P=-P);var R=-E*this.walkMultiplier*.05,D=e.up;(l.clone().dot(e.up)<-s||Math.abs(l.clone().dot(e.up))<s&&l.clone().dot(S)>s)&&(R=-R),D=l;var I=(new i.Quaternion).setFromAxisAngle(D,R);I.normalize(),(S=I.clone().rotate(S)).normalize(),e.up.copy(I.clone().rotate(e.up)),e.up.normalize(),e.position.add(P.clone().multiplyScalar(C)),this.center.copy(e.position.clone().add(S.clone().multiplyScalar(A))),(P=l).normalize(),0===C&&(C=.01),e.lookAt(this.center),m(!1)}},this.updown=function(t){if(!this.navApi.getIsLocked()){var n=G(t);o.m_amount+=n;var r=new i.Vector3(0,1,0),a=o.saveEye.clone().sub(r.clone().multiplyScalar(o.m_amount)),s=a.clone().dot(r);e.position.copy(a),s<o.minSceneBound&&e.position.add(r.clone().multiplyScalar(o.minSceneBound-s)),s>o.maxSceneBound&&e.position.add(r.clone().multiplyScalar(o.maxSceneBound-s)),this.center.copy(e.position.clone().add(o.saveCenter.clone().sub(o.saveEye))),e.lookAt(this.center),m(!1)}}}o.GlobalManagerMixin.call(u.prototype)},98265:(e,t,n)=>{"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=(0,n(84998).getGlobal)();function o(){this.stop=null,this.isRunning=!0}function a(e,t,n,i,a){var s=performance.now(),l=1e3*n,c=0,u=new o;u.stop=function(){c&&r.cancelAnimationFrame(c),u.isRunning=!1},u.skip=function(){u.isRunning&&(i(t),u.stop(),a&&a())};return function n(o){var h=(o-s)/l;h=Math.max(h,0),h=Math.min(h,1),i(e+h*(t-e)),h<1?c=r.requestAnimationFrame(n):(u.isRunning=!1,a&&a())}(s),u}var s,l=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setValueCb=n,this.animTime=i,this.fadeAnim=null,this.targetValue=t,this.curValue=t,n(t),this.pendingFinishedCallbacks=[]}var t,n,r;return t=e,(n=[{key:"stopAnim",value:function(){this.fadeAnim&&(this.fadeAnim.stop(),this.fadeAnim=null)}},{key:"_onAnimEnded",value:function(){this.pendingFinishedCallbacks.forEach((function(e){return e()})),this.pendingFinishedCallbacks.length=0}},{key:"fadeTo",value:function(e,t){var n=this,i=this.fadeAnim&&this.fadeAnim.isRunning;i||this.curValue!=e?(t&&this.pendingFinishedCallbacks.push(t),i&&e===this.targetValue||(this.stopAnim(),this.targetValue=e,this.fadeAnim=a(this.curValue,this.targetValue,this.animTime,(function(e){e=u(e),n.curValue=e,n.setValueCb(e)}),(function(){return n._onAnimEnded()})))):t&&t()}},{key:"skipAnim",value:function(){this.fadeAnim&&this.fadeAnim.skip()}},{key:"setValue",value:function(e){this.stopAnim(),this.curValue=e,this.setValueCb(e)}}])&&i(t.prototype,n),r&&i(t,r),e}();function c(e,t,n){return(1-n)*e+n*t}function u(e){return THREE.Math.smootherstep(e,0,1)}function h(e){var t=new THREE.Vector3,n=new THREE.Vector3,i=new THREE.Vector3,r=new THREE.Vector3,o=new THREE.Vector3,a=new THREE.Vector3,s=0,l=0,h=new THREE.Quaternion,d=new THREE.Quaternion,p=new THREE.Vector3,f=new THREE.Quaternion,m=new THREE.Object3D;new THREE.Matrix4;function g(e,t,n,i){Autodesk.Viewing.Navigation.prototype.orient(m,n,t,i),e.copy(m.quaternion)}function v(){g(h,t,n,i),g(d,r,o,a)}this.init=function(e,c,u,h){var d=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];t.copy(e.position),n.copy(e.target),i.copy(d?e.worldup:e.up),r.copy(c),o.copy(u),a.copy(d?e.worldup:h),s=t.distanceTo(n),l=r.distanceTo(o),v()},this.updateCamera=function(e,n){var i=u(e);n.position.lerpVectors(t,r,i),THREE.Quaternion.slerp(h,d,f,i),f.normalize();var o=c(s,l,i);!function(e,t,n){p.set(0,0,-n).applyQuaternion(t),e.target.addVectors(e.position,p),p.set(0,1,0).applyQuaternion(t),e.up.copy(p)}(n,f,o),n.dirty=!0},this.updateViewerCamera=function(e,t){this.updateCamera(e,t.impl.camera),t.impl.syncCamera(),t.impl.invalidate(!0,!0)}}e.exports={flyToView:function(e,t,n,i){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];s||(s=new h),n=n||2;var o=e.impl.camera;s.init(o,t.position,t.target,t.up,r);var l=function(t){s.updateViewerCamera(t,e)};return a(0,1,n,l,i)},ShadowFader:function(e,t,n){var i=1,r=null,o=t,s=void 0,l=n;function c(t){i=t,e.impl.setGroundShadowAlpha(t)}function u(){r=null,l&&l(s)}this.shadowOn=function(){r&&s||(r&&!s&&(r.stop(),r=null),i>=1||(r=a(i,1,o*(1-i),c,u),s=!0))},this.shadowOff=function(){r&&!s||(r&&s&&(r.stop(),r=null),i<=0||(r=a(i,0,o*i,c,u),s=!1))},this.isFading=function(){return r&&r.isRunning}},lerp:c,smootherStep:u,fadeValue:a,AnimatedParam:l}},96651:(e,t,n)=>{"use strict";function i(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}function r(e,t){try{WebAssembly.instantiateStreaming||(WebAssembly.instantiateStreaming=function(){var e,t=(e=regeneratorRuntime.mark((function e(t,n){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:return e.next=4,e.sent.arrayBuffer();case 4:return i=e.sent,e.next=7,WebAssembly.instantiate(i,n);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){i(a,r,o,s,l,"next",e)}function l(e){i(a,r,o,s,l,"throw",e)}s(void 0)}))});return function(e,n){return t.apply(this,arguments)}}())}catch(e){throw new Error("WebAssembly is not supported for the current browser.")}if(!e)throw new Error("Expecting a wasm file path.");var n=256,r=256;t&&t.memory&&(n=t.memory.initial,r=t.memory.maximum),this._wasmPath=e,this._memory=new WebAssembly.Memory({initial:n,maximum:r})}n.r(t),n.d(t,{Wasm:()=>r}),r.prototype.constructor=r,r.prototype.instantiate=function(){var e=this,t={env:{abortStackOverflow:function(e){throw new Error("overflow")},table:new WebAssembly.Table({initial:0,maximum:0,element:"anyfunc"}),__table_base:0,memory:this._memory,__memory_base:1024,STACKTOP:0,STACK_MAX:this.getBuffer().byteLength}};return new Promise((function(n,i){try{WebAssembly.instantiateStreaming(fetch(e._wasmPath),t).then((function(t){var i=t.instance.exports;e.proxy=i,n(i)}))}catch(e){i(e)}}))},r.prototype.getBuffer=function(){return this._memory.buffer}},92445:(e,t,n)=>{"use strict";n.r(t),n.d(t,{memoryOptimizedLoading:()=>r,GPU_MEMORY_LIMIT:()=>o,GPU_OBJECT_LIMIT:()=>a,USE_VAO:()=>s,GEOMETRY_OVERHEAD:()=>l,PIXEL_CULLING_THRESHOLD:()=>c});var i=n(84998),r=!0,o=1024*((0,i.isMobileDevice)()?64:256)*1024,a=(0,i.isMobileDevice)()?2500:1e4,s=!(0,i.isMobileDevice)(),l=336,c=1},69632:(e,t,n)=>{"use strict";n.d(t,{Q:()=>l});var i=n(16453),r=n(59047),o=n.n(r),a=n(2867),s=n.n(a),l={uniforms:{color1:{type:"v3",value:new i.Vector3(41/255,76/255,120/255)},color2:{type:"v3",value:new i.Vector3(1/255,2/255,3/255)},opacity:{type:"f",value:1},envMap:{type:"t",value:null},envRotationSin:{type:"f",value:0},envRotationCos:{type:"f",value:1},exposureBias:{type:"f",value:1},envMapExposure:{type:"f",value:1},uCamDir:{type:"v3",value:new i.Vector3},uCamUp:{type:"v3",value:new i.Vector3},uResolution:{type:"v2",value:new i.Vector2(600,400)},uHalfFovTan:{type:"f",value:.5},envMapBackground:{type:"i",value:0},backgroundTexture:{type:"t",value:null}},vertexShader:o(),fragmentShader:s()}},68538:(e,t,n)=>{"use strict";n.r(t),n.d(t,{BasicShader:()=>c});var i=n(16453),r=n(12990),o=n(75101),a=n.n(o),s=n(48544),l=n.n(s),c={uniforms:i.UniformsUtils.merge([i.UniformsLib.common,i.UniformsLib.fog,i.UniformsLib.shadowmap,r.ShaderChunks.CutPlanesUniforms,r.ShaderChunks.IdUniforms,r.ShaderChunks.ThemingUniform,r.ShaderChunks.PointSizeUniforms,r.ShaderChunks.WideLinesUniforms,r.ShaderChunks.DepthTextureTestUniforms]),vertexShader:a(),fragmentShader:l()};i.ShaderLib.firefly_basic=c},21995:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CelShader:()=>c});var i=n(16453),r=n(12990),o=n(66209),a=n.n(o),s=n(40518),l=n.n(s),c={uniforms:i.UniformsUtils.merge([r.ShaderChunks.DepthTextureUniforms,{tDiffuse:{type:"t",value:null},tID:{type:"t",value:null},resolution:{type:"v2",value:new i.Vector2(1/1024,1/512)},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},tFill:{type:"t",value:null},tPaper:{type:"t",value:null},style:{type:"i",value:0},idEdges:{type:"i",value:1},normalEdges:{type:"i",value:1},depthEdges:{type:"i",value:1},brightness:{type:"f",value:0},contrast:{type:"f",value:0},grayscale:{type:"i",value:0},preserveColor:{type:"i",value:0},levels:{type:"f",value:6},repeats:{type:"f",value:3},rotation:{type:"f",value:0},outlineRadius:{type:"f",value:1},outlineNoise:{type:"i",value:0},tGraphite1:{type:"t",value:null},tGraphite2:{type:"t",value:null},tGraphite3:{type:"t",value:null},tGraphite4:{type:"t",value:null},tGraphite5:{type:"t",value:null},tGraphite6:{type:"t",value:null},tGraphite7:{type:"t",value:null},tGraphite8:{type:"t",value:null}}]),vertexShader:a(),fragmentShader:l()}},61768:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CopyShader:()=>s});var i=n(66209),r=n.n(i),o=n(67086),a=n.n(o),s={uniforms:{tDiffuse:{type:"t",value:null}},vertexShader:r(),fragmentShader:a()}},4388:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CreateCubeMapFromColors:()=>a,DecodeEnvMap:()=>p});var i=n(16453),r=n(96890),o=n(98926);function a(e,t){for(var n=255*e.x,r=255*e.y,o=255*e.z,a=255*t.x,s=255*t.y,l=255*t.z,c=new Uint8Array(16),u=new Uint8Array(16),h=new Uint8Array(16),d=0;d<4;d++)c[4*d]=n,c[4*d+1]=r,c[4*d+2]=o,c[4*d+3]=255,u[4*d]=a,u[4*d+1]=s,u[4*d+2]=l,u[4*d+3]=255,d>1?(h[4*d]=n,h[4*d+1]=r,h[4*d+2]=o,h[4*d+3]=255):(h[4*d]=a,h[4*d+1]=s,h[4*d+2]=l,h[4*d+3]=255);var p=new i.DataTexture(h,2,2,i.RGBAFormat),f=new i.DataTexture(h,2,2,i.RGBAFormat),m=new i.DataTexture(u,2,2,i.RGBAFormat),g=new i.DataTexture(c,2,2,i.RGBAFormat),v=new i.DataTexture(h,2,2,i.RGBAFormat),y=new i.DataTexture(h,2,2,i.RGBAFormat),b=new i.Texture(null,i.CubeReflectionMapping,i.RepeatWrapping,i.RepeatWrapping,i.LinearFilter,i.LinearFilter,i.RGBAFormat);return b.image=[f,p,g,m,y,v],b.needsUpdate=!0,b}var s=[6.0014,-2.7008,-1.7996,-1.332,3.1029,-5.7721,.3008,-1.0882,5.6268];function l(e,t){var n=255*t[2]+t[3],i=Math.pow(2,(n-127)/2),r=i/t[1],o=t[0]*r,a=s[0]*o+s[3]*i+s[6]*r,l=s[1]*o+s[4]*i+s[7]*r,c=s[2]*o+s[5]*i+s[8]*r;a<0&&(a=0),l<0&&(l=0),c<0&&(c=0),e[0]=a,e[1]=l,e[2]=c}function c(e,t,n){var i=.0625*Math.sqrt(t[0]*n),r=.0625*Math.sqrt(t[1]*n),o=.0625*Math.sqrt(t[2]*n),a=Math.max(Math.max(i,r),Math.max(o,1e-6));a>1&&(a=1);var s=Math.ceil(255*a)/255;i>1&&(i=1),r>1&&(r=1),o>1&&(o=1),e[3]=s;var l=1/s;e[0]=i*l,e[1]=r*l,e[2]=o*l}function u(e,t,n){var i=Math.sqrt(t[0]*n),r=Math.sqrt(t[1]*n),o=Math.sqrt(t[2]*n),a=65504;i>a&&(i=a),r>a&&(r=a),o>a&&(o=a),e[0]=i,e[1]=r,e[2]=o}var h=new Float32Array(4),d=new Float32Array(4);function p(e,t,n,a){if(e.LogLuv){for(var s=Math.pow(2,t),p=Array.isArray(e.image)?e.image:[e.image],f=0;f<p.length;f++)for(var m=p[f],g=0;g<m.mipmaps.length;g++){var v,y=m.mipmaps[g],b=y.data;n?(v=new Uint16Array(b.length/4*3),y.data=v):v=b.buffer;for(var _=0,x=0;x<b.length;x+=4)h[0]=b[x]/255,h[1]=b[x+1]/255,h[2]=b[x+2]/255,h[3]=b[x+3]/255,l(d,h),n?(u(h,d,s),v[_++]=(0,r.FloatToHalf)(h[0]),v[_++]=(0,r.FloatToHalf)(h[1]),v[_++]=(0,r.FloatToHalf)(h[2])):(c(h,d,s),b[x]=Math.round(255*h[0]),b[x+1]=Math.round(255*h[1]),b[x+2]=Math.round(255*h[2]),b[x+3]=Math.round(255*h[3]))}e.LogLuv=!1,n?(e.type=i.HalfFloatType,e.format=i.RGBFormat,e.RGBM=!1,e.GammaEncoded=!0):e.RGBM=!0,a&&a(e)}else o.logger.warn("Environment map expected to be in LogLuv format.")}},95708:(e,t,n)=>{"use strict";n.d(t,{D:()=>u});var i=n(16453),r=n(3911),o=n.n(r),a=n(93285),s=n.n(a),l=n(85994),c={uniforms:{tDiffuse:{type:"t",value:null},uColor:{type:"v4",value:new i.Vector4(1,1,1,1)}},vertexShader:o(),fragmentShader:s()},u=function(e,t,n,r,o){var a,s,u,h=e,d=t,p=n||3,f=r||1,m=o.hasAlpha||!1,g=o.blending||!1,v=o.flipUV||!1;this.render=function(e,t,n){a.render(e,u,n),s.render(e,t,u)},this.setSize=function(e,t){this.cleanup(),h=e,d=t,(u=new i.WebGLRenderTarget(e,t,{minFilter:i.LinearFilter,magFilter:i.LinearFilter,format:void 0!==o.format?o.format:i.RGBAFormat,type:void 0!==o.type?o.type:i.UnsignedByteType,stencilBuffer:!1})).texture.generateMipmaps=!1,a.material.defines.KERNEL_SCALE_H=s.material.defines.KERNEL_SCALE_H=(f/h).toFixed(4),a.material.defines.KERNEL_SCALE_V=s.material.defines.KERNEL_SCALE_V=(f/d).toFixed(4),a.material.needsUpdate=s.material.needsUpdate=!0},this.cleanup=function(){u&&u.dispose()},this.setColor=function(e){s.material.uniforms.uColor.value.x=e.r,s.material.uniforms.uColor.value.y=e.g,s.material.uniforms.uColor.value.z=e.b},this.setAlpha=function(e){s.material.uniforms.uColor.value.w=e},a=new l.ShaderPass(c),s=new l.ShaderPass(c),this.setSize(e,t),a.material.blending=s.material.blending=i.NoBlending,a.material.depthWrite=s.material.depthWrite=!1,a.material.depthTest=s.material.depthTest=!1,a.material.defines.HORIZONTAL=1,a.material.defines.KERNEL_RADIUS=s.material.defines.KERNEL_RADIUS=p.toFixed(1),g&&(s.material.transparent=!0,s.material.blending=i.NormalBlending),m&&(a.material.defines.HAS_ALPHA=s.material.defines.HAS_ALPHA=""),v&&(a.material.defines.FLIP_UV="")}},85989:(e,t,n)=>{"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,{S:()=>r});var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"needsClear",value:function(e,t){if(e.length!==t.length)return!0;for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!0}}])&&i(t.prototype,n),r&&i(t,r),e}()},5106:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GroundFlags:()=>i});var i={GROUND_UNFINISHED:0,GROUND_FINISHED:1,GROUND_RENDERED:2}},77416:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GroundReflection:()=>f});var i=n(85994),r=n(95708),o=n(69632),a=n(66209),s=n.n(a),l=n(24687),c=n.n(l),u=n(85989),h=n(5106),d=n(16453),p={uniforms:{tDiffuse:{type:"t",value:null}},vertexShader:s(),fragmentShader:c()},f=function(e,t,n,a){var s,l,c,u,f,m,g=e,v=g.getContext(),y=t||512,b=n||512,_=!1,x=new d.Color(0,0,0),E=!1,w=!1;this.inTarget=void 0,this.outTarget=void 0;var S,A,M,T,C,P=!0,L=h.GroundFlags.GROUND_UNFINISHED,R={color:new d.Color(1,1,1),alpha:.3,texScale:.5,blurRadius:2,blurTexScale:.5,fadeAngle:Math.PI/18};if(this.setTransform=function(e,t,n){u=e,c.normal=t,c.constant=-e.dot(t)},this.cleanup=function(){s&&s.cleanup(),this.inTarget&&this.inTarget.dispose(),this.outTarget&&this.outTarget.dispose()},this.setSize=function(e,t){y=e,b=t,this.cleanup(),this.inTarget=new d.WebGLRenderTarget(y*R.texScale,b*R.texScale,{magFilter:d.LinearFilter,minFilter:d.LinearFilter,format:d.RGBAFormat,stencilBuffer:!1}),this.inTarget.texture.generateMipmaps=!1,this.inTarget.name="GroundReflection inTarget",this.outTarget=new d.WebGLRenderTarget(y*R.texScale,b*R.texScale,{magFilter:d.LinearFilter,minFilter:d.LinearFilter,format:d.RGBAFormat,stencilBuffer:!1}),this.outTarget.texture.generateMipmaps=!1,this.outTarget.name="GroundReflection outTarget",s?s.setSize(y*R.texScale*R.blurTexScale,b*R.texScale*R.blurTexScale):s=new r.D(y*R.texScale*R.blurTexScale,b*R.texScale*R.blurTexScale,R.blurRadius,1,{hasAlpha:!0,blending:!0,flipUV:!0})},this.updateCamera=function(e){var t;t=e.isPerspective?u.clone():e.target.clone();var n=e.position.clone().sub(t).normalize(),i=Math.PI/2-n.angleTo(c.normal);if(!(_=i<0)){if(R.fadeAngle>0){var r=Math.min(R.fadeAngle,i)/R.fadeAngle;s.setAlpha(r*R.alpha)}var o,a,l,h=(a=(o=c).normal,l=o.constant,(new d.Matrix4).set(1-2*a.x*a.x,-2*a.y*a.x,-2*a.x*a.z,-2*l*a.x,-2*a.x*a.y,1-2*a.y*a.y,-2*a.y*a.z,-2*l*a.y,-2*a.x*a.z,-2*a.y*a.z,1-2*a.z*a.z,-2*l*a.z,0,0,0,1));(f=e.clone()).applyMatrix4(h),f.projectionMatrix.elements[5]*=-1,f.matrixWorldNeedsUpdate=!0,e.worldUpTransform?f.worldUpTransform=e.worldUpTransform.clone():f.worldUpTransform=new d.Matrix4}},this.renderIntoReflection=function(e){_||g.render(e,f,this.inTarget)},this.prepareGroundReflection=(A=[],M=0,T=0,C=0,function(e,t,n,i,r,o){var a=t.modelQueue();if(L!==h.GroundFlags.GROUND_UNFINISHED||a.isEmpty())return L=h.GroundFlags.GROUND_FINISHED,r;var s,l,c,u=a.getGeomScenesPerModel();if(P=this.needsClear(A,u)||P){if(P=!1,this.updateCamera(t.camera),this.isGroundCulled())return L=h.GroundFlags.GROUND_FINISHED,r;this.clear(),A=u,S=a.getGeomScenes(),M=S.length,T=0,C=i?Math.max(Math.ceil(M/100),i):M,L=h.GroundFlags.GROUND_UNFINISHED}else{if(L!==h.GroundFlags.GROUND_UNFINISHED)return L=h.GroundFlags.GROUND_FINISHED,r;0===i&&(C=M)}r&&(s=performance.now(),l=(o=void 0===o?1:o)*r);for(var d=0;d<C&&T<M;){var p=S[T++];if(p&&(d++,p.forceVisible=!0,this.renderIntoReflection(p),p.forceVisible=!1,r)){var f=performance.now()-s;if(l<f&&T<M){L=h.GroundFlags.GROUND_UNFINISHED,c=r-f;break}}}return T<M&&(L=h.GroundFlags.GROUND_UNFINISHED,c=r?r-performance.now()+s:1),void 0===c||n?(this.postprocess(t.camera,t.matman()),e&&e.enabled&&t.renderGroundShadow(this.outTarget),this.renderReflection(t.camera,t.renderer().getColorTarget()),void 0===c&&(L=h.GroundFlags.GROUND_RENDERED),r?r-performance.now()+s:1):c}),this.renderReflection=function(e,t){_||(v.depthRange(.999999,1),l.render(g,t,this.outTarget),v.depthRange(0,1))},this.toggleEnvMapBackground=function(e){w=e,m.uniforms.envMapBackground.value=e},this.postprocess=function(e){if(!_){if(E||w){var t=m.uniforms.uCamDir.value||new d.Vector3;m.uniforms.uCamDir.value=e.worldUpTransform?e.getWorldDirection(t).applyMatrix4(e.worldUpTransform):e.getWorldDirection(t),m.uniforms.uCamUp.value=e.worldUpTransform?e.up.clone().applyMatrix4(e.worldUpTransform):e.up,m.uniforms.uResolution.value.set(y,b),m.uniforms.uHalfFovTan.value=Math.tan(d.Math.degToRad(.5*e.fov)),m.render(g,this.outTarget),g.clearTarget(this.outTarget,!1,!0,!1)}else g.setClearColor(x,1),g.clearTarget(this.outTarget,!0,!0,!1);s.render(g,this.outTarget,this.inTarget)}},this.clear=function(){g.setClearColor(x,0),g.clearTarget(this.inTarget,!0,!0,!1),g.clearBlend()},this.setClearColors=function(e,t,n){t?(x.setRGB(.5*(e.x+t.x),.5*(e.y+t.y),.5*(e.z+t.z)),E=!e.equals(t)&&!n):(x.copy(e),E=!1),E&&(m.uniforms.color1.value.copy(e),m.uniforms.color2.value.copy(t))},this.setEnvRotation=function(e){m.material.envRotationSin=Math.sin(e),m.material.envRotationCos=Math.cos(e)},this.isGroundCulled=function(){return _},this.getStatus=function(){return L},this.setDirty=function(){P=!0,L=h.GroundFlags.GROUND_UNFINISHED},this.setColor=function(e){s.setColor(R.color),R.color.set(e)},this.setAlpha=function(e){s.setAlpha(R.alpha),R.alpha=e},a)for(var D in R)R[D]=void 0!==a[D]?a[D]:R[D];(l=new i.ShaderPass(p)).material.blending=d.NoBlending,l.material.depthTest=!0,l.material.depthWrite=!1,l.scene.position.z=-.999999,a.clearPass?m=a.clearPass:((m=new i.ShaderPass(o.Q)).material.blending=d.NoBlending,m.material.depthWrite=!1,m.material.depthTest=!1),this.setSize(y,b),s.setAlpha(R.color),s.setAlpha(R.alpha),c=new d.Plane(new d.Vector3(0,1,0),0),u=new d.Vector3(0,0,0)};f.prototype=u.S.prototype,f.prototype.constructor=f},83359:(e,t,n)=>{"use strict";n.r(t),n.d(t,{createGroundShape:()=>T,setGroundShapeTransform:()=>C,GroundShadow:()=>P});var i,r,o,a=n(14705),s=n(85994),l=n(40520),c=n.n(l),u=n(57165),h=n.n(u),d=n(66209),p=n.n(d),f=n(24009),m=n.n(f),g=n(8242),v=n.n(g),y=n(14810),b=n.n(y),_=n(85989),x=n(5106),E=n(16453),w={uniforms:{cutplanes:{type:"v4v",value:[]}},vertexShader:c(),fragmentShader:h()},S={uniforms:{tDepth:{type:"t",value:null},worldSize:{type:"v3",value:new E.Vector3(1,1,1)}},defines:{},vertexShader:p(),fragmentShader:m()},A={uniforms:{tDepth:{type:"t",value:null}},defines:{},vertexShader:p(),fragmentShader:v()},M={uniforms:{tDepth:{type:"t",value:null},uShadowColor:{type:"v4",value:new E.Vector4(0,0,0,1)}},vertexShader:p(),fragmentShader:b()};function T(e){var t=new E.PlaneBufferGeometry(1,1);if(t.index.array.reverse)t.index.array.reverse();else for(var n,i=t.index.array,r=Math.floor(i.length/2),o=0,a=i.length;o<r;++o)n=i[o],i[o]=i[a-1-o],i[a-1-o]=n;return new E.Mesh(t,e)}function C(e,t,n,a,s){i||(i=new E.Matrix4),r||(r=new E.Vector3),o||(o=new E.Vector3),r.subVectors(t,a),i.lookAt(r,t,s),o.copy(a).multiplyScalar(-.5*n.y).add(t),e.position.copy(o),e.rotation.setFromRotationMatrix(i),e.scale.set(n.z,n.x,n.y)}function P(e,t){var n,i,r,o,l,c,u,h,d,p,f,m,g,v,y,b,_,P,L,R,D=e,I=!1,O=!0,N=x.GroundFlags.GROUND_FINISHED,k={texSize:64,pixScale:1,blurRadius:7,debug:!1};if(this.setTransform=(m=new E.Vector3(0,0,0),g=new E.Vector3(0,0,0),v=new E.Vector3(0,0,0),y=new E.Vector3(0,0,0),function(e,t,i,o){e.equals(m)&&t.equals(g)&&i.equals(v)&&o.equals(y)||(m.copy(e),g.copy(t),v.copy(i),y.copy(o),this.setDirty(),n.left=-t.z/2,n.right=t.z/2,n.top=t.x/2,n.bottom=-t.x/2,n.near=1,n.far=t.y+n.near,n.updateProjectionMatrix(),C(r,e,t,i,o),n.position.addVectors(e,i.clone().multiplyScalar(-t.y/2-n.near)),o&&n.up.set(o.x,o.y,o.z),n.lookAt(e),k.debug&&(f.position.set(e.x,e.y,e.z),f.rotation.set(n.rotation.x,n.rotation.y,n.rotation.z),f.scale.set(t.z,t.x,t.y)),p.uniforms.worldSize.value.copy(t))}),this.renderIntoShadow=function(e){if(!e.overrideMaterial||!e.overrideMaterial.transparent){var t=e.overrideMaterial;e.overrideMaterial=c,D.render(e,n,o,!1),e.overrideMaterial=t}},this.prepareGroundShadow=(_=[],P=0,L=0,R=0,function(e,t,n,i){if(!this.enabled||e.isEmpty())return N=x.GroundFlags.GROUND_FINISHED,n;var r,o,a,s=e.getGeomScenesPerModel();if(O=this.needsClear(_,s)||O)this.clear(),O=!1,_=s,b=e.getGeomScenes(),P=b.length,L=0,R=t?Math.max(Math.ceil(P/100),t):P;else{if(N===x.GroundFlags.GROUND_RENDERED||N===x.GroundFlags.GROUND_FINISHED)return N=x.GroundFlags.GROUND_FINISHED,n;0===t&&(R=P)}n&&(r=performance.now(),o=(i=void 0===i?1:i)*n);for(var l=0;l<R&&L<P;){var c=b[L++];if(c&&(l++,c.forceVisible=!0,this.renderIntoShadow(c),c.forceVisible=!1,n)){var u=performance.now()-r;if(o<u){N=x.GroundFlags.GROUND_UNFINISHED,a=n-u;break}}}return L<P&&(N=x.GroundFlags.GROUND_UNFINISHED,a=n?n-performance.now()+r:1),void 0!==a?a:(this.postprocess(),N=x.GroundFlags.GROUND_RENDERED,n?n-performance.now()+r:1)}),this.renderShadow=function(e,t){I&&(t?D.render(i,e,t,!1):D.render(i,e))},this.postprocess=function(){d.render(D,l,o),h.render(D,o,l),I=!0},this.clear=function(){var e=D.getClearColor().getHex(),t=D.getClearAlpha();D.setClearColor(0,0),D.clearTarget(o,!0,!0,!1),D.setClearColor(e,t),D.clearBlend(),I=!1},this.setColor=function(e){u.uniforms.uShadowColor.value.x=e.r,u.uniforms.uShadowColor.value.y=e.g,u.uniforms.uShadowColor.value.z=e.b},this.getColor=function(){return new E.Color(u.uniforms.uShadowColor.value.x,u.uniforms.uShadowColor.value.y,u.uniforms.uShadowColor.value.z)},this.setAlpha=function(e){u.uniforms.uShadowColor.value.w=e},this.getAlpha=function(){return u.uniforms.uShadowColor.value.w},this.isValid=function(){return I},this.getStatus=function(){return N},this.setDirty=function(){O=!0,N=x.GroundFlags.GROUND_UNFINISHED},this.getDepthMaterial=function(){return c},t)for(var F in k)k[F]=t[F]||k[F];i=new E.Scene,n=new E.OrthographicCamera,(o=new E.WebGLRenderTarget(k.texSize,k.texSize,{minFilter:E.LinearFilter,magFilter:E.LinearFilter,format:E.RGBAFormat,stencilBuffer:!1})).texture.generateMipmaps=!1,o.name="GroundShadow targetH",(l=new E.WebGLRenderTarget(k.texSize,k.texSize,{minFilter:E.LinearFilter,magFilter:E.LinearFilter,format:E.RGBAFormat,stencilBuffer:!1})).texture.generateMipmaps=!1,l.name="GroundShadow targetV",(c=(0,a.createShaderMaterial)(w)).side=E.DoubleSide,c.blending=E.NoBlending,h=new s.ShaderPass(A,"tDepth"),d=new s.ShaderPass(A,"tDepth"),p=new s.ShaderPass(S,"tDepth"),h.material.defines.KERNEL_SCALE=d.material.defines.KERNEL_SCALE=(k.pixScale/k.texSize).toFixed(4),h.material.defines.KERNEL_RADIUS=d.material.defines.KERNEL_RADIUS=k.blurRadius.toFixed(2),p.material.blending=h.material.blending=d.material.blending=E.NoBlending,p.material.depthWrite=h.material.depthWrite=d.material.depthWrite=!1,p.material.depthTest=h.material.depthTest=d.material.depthTest=!1,h.material.defines.HORIZONTAL=1,(u=(0,a.createShaderMaterial)(M)).uniforms.tDepth.value=o,u.depthWrite=!1,u.transparent=!0,r=T(u),i.add(r),k.debug&&(f=new E.Mesh(new E.BoxGeometry(1,1,1),new E.MeshBasicMaterial({color:65280,wireframe:!0})),i.add(f)),this.setTransform(new E.Vector3(0,0,0),new E.Vector3(1,1,1),new E.Vector3(0,1,0),E.Object3D.DefaultUp)}P.prototype=_.S.prototype,P.prototype.constructor=P},96890:(e,t,n)=>{"use strict";n.r(t),n.d(t,{FloatToHalf:()=>s,HalfToFloat:()=>l,HALF_INT_MAX:()=>c,IntToHalf:()=>u,HalfToInt:()=>h,HalfTest:()=>d});var i=new Float32Array(1),r=new Uint32Array(i.buffer),o=new Uint16Array(1),a=new Uint16Array(1),s=function(e){i[0]=e;var t=r[0],n=0;if(0==(2147483647&t))a[n++]=t>>16;else{var s=2147483648&t,l=2139095040&t,c=8388607&t;if(0===l)a[n++]=s>>16;else if(2139095040==l)a[n++]=0===c?s>>16|31744:65024;else{var u,h,d=s>>16,p=(0|l>>23)-127+15;p>=31?a[n++]=s>>16|31744:p<=0?(14-p>24?u=0:(u=(c|=8388608)>>14-p,o[0]=u,u=o[0],c>>13-p&1&&(u+=1)),a[n++]=d|u):(h=p<<10,o[0]=h,h=o[0],u=c>>13,o[0]=u,u=o[0],a[n++]=4096&c?1+(d|h|u):d|h|u)}}return a[0]},l=function(e){var t,n=65535&e;if(0==(32767&n))t=n<<16;else{var o=32768&n,a=31744&n,s=1023&n;if(0===a){var l=-1;do{l++,s<<=1}while(0==(1024&s));var c=o<<16,u=(a<<16>>26)-15+127-l,h=u<<23,d=(1023&s)<<13;t=c|h|d}else t=31744==a?0===s?o<<16|2139095040:4290772992:(c=o<<16)|(h=(u=(a<<16>>26)-15+127)<<23)|(d=s<<13)}return r[0]=t,i[0]},c=59390,u=function(e){if(e>c-1||e<0)return console.log("out of range"),s(NaN);if(0===e)return 0;var t=!1;e>c/2-1&&(t=!0,e-=c/2-1);var n=0|Math.abs(e/1024),i=Math.pow(2,n-13),r=i+(e-1024*n)*i/1024;return t&&(r=-r),s(r)},h=function(e){if(0===e)return 0;var t=l(e),n=!1;t<0&&(n=!0,t=-t);var i=0|Math.floor(Math.log(t)/Math.log(2)),r=Math.pow(2,i),o=(t-r)/r*1024+1024*(i+13);return n&&(o+=c/2-1),o},d=function(){for(var e=[-1/255,-.17,-75,-1789,-.005],t=0;t<e.length;t++)console.log("input",e[t],"encoded",s(e[t]),"decoded",l(s(e[t])));for(var n=0;n<c;n++){var i=h(u(n));i!==n&&console.log("Roundtrip failed for",n,i)}}},49321:(e,t,n)=>{"use strict";n.r(t),n.d(t,{LineStyleDefs:()=>r,createLinePatternTextureData:()=>o,createLinePatternTextureFromDefs:()=>a,createLinePatternTexture:()=>s,createLinePatternForDef:()=>l});var i=n(16453),r=[{id:"SOLID",name:"Solid",ascii_art:"_______________________________________",def:[1]},{id:"BORDER",name:"Border",ascii_art:"__ __ . __ __ . __ __ . __ __ . __ __ .",def:[.5,-.25,.5,-.25,0,-.25]},{id:"BORDER2",name:"Border (.5x)",ascii_art:"__ __ . __ __ . __ __ . __ __ . __ __ .",def:[.25,-.125,.25,-.125,0,-.125]},{id:"BORDERX2",name:"Border (2x)",ascii_art:"____  ____  .  ____  ____  .  ___",def:[1,-.5,1,-.5,0,-.5]},{id:"CENTER",name:"Center",ascii_art:"____ _ ____ _ ____ _ ____ _ ____ _ ____",def:[1.25,-.25,.25,-.25]},{id:"CENTER2",name:"Center (.5x)",ascii_art:"___ _ ___ _ ___ _ ___ _ ___ _ ___",def:[.75,-.125,.125,-.125]},{id:"CENTERX2",name:"Center (2x)",ascii_art:"________  __  ________  __  _____",def:[2.5,-.5,.5,-.5]},{id:"DASHDOT",name:"Dash dot",ascii_art:"__ . __ . __ . __ . __ . __ . __ . __",def:[.5,-.25,0,-.25]},{id:"DASHDOT2",name:"Dash dot (.5x)",ascii_art:"_._._._._._._._._._._._._._._.",def:[.25,-.125,0,-.125]},{id:"DASHDOTX2",name:"Dash dot (2x)",ascii_art:"____  .  ____  .  ____  .  ___",def:[1,-.5,0,-.5]},{id:"DASHED",name:"Dashed",ascii_art:"__ __ __ __ __ __ __ __ __ __ __ __ __ _",def:[.5,-.25]},{id:"DASHED2",name:"Dashed (.5x)",ascii_art:"_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _",def:[.25,-.125]},{id:"DASHEDX2",name:"Dashed (2x)",ascii_art:"____  ____  ____  ____  ____  ___",def:[1,-.5]},{id:"DIVIDE",name:"Divide",ascii_art:"____ . . ____ . . ____ . . ____ . . ____",def:[.5,-.25,0,-.25,0,-.25]},{id:"DIVIDE2",name:"Divide (.5x)",ascii_art:"__..__..__..__..__..__..__..__.._",def:[.25,-.125,0,-.125,0,-.125]},{id:"DIVIDEX2",name:"Divide (2x)",ascii_art:"________  .  .  ________  .  .  _",def:[1,-.5,0,-.5,0,-.5]},{id:"DOT",name:"Dot",ascii_art:". . . . . . . . . . . . . . . . . . . . . . . .",def:[0,-.25]},{id:"DOT2",name:"Dot (.5x)",ascii_art:"........................................",def:[0,-.125]},{id:"DOTX2",name:"Dot (2x)",ascii_art:".  .  .  .  .  .  .  .  .  .  .  .  .  .",def:[0,-.5]},{id:"HIDDEN",name:"Hidden",ascii_art:"__ __ __ __ __ __ __ __ __ __ __ __ __ __",def:[.25,-.125]},{id:"HIDDEN2",name:"Hidden (.5x)",ascii_art:"_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _",def:[.125,-.0625]},{id:"HIDDENX2",name:"Hidden (2x)",ascii_art:"____ ____ ____ ____ ____ ____ ____",def:[.5,-.25]},{id:"PHANTOM",name:"Phantom",ascii_art:"______  __  __  ______  __  __  ______",def:[1.25,-.25,.25,-.25,.25,-.25]},{id:"PHANTOM2",name:"Phantom (.5x)",ascii_art:"___ _ _ ___ _ _ ___ _ _ ___ _ _",def:[.625,-.125,.125,-.125,.125,-.125]},{id:"PHANTOMX2",name:"Phantom (2x)",ascii_art:"____________    ____    ____   _",def:[2.5,-.5,.5,-.5,.5,-.5]},{id:"ACAD_ISO02W100",name:"ISO dash",ascii_art:"__ __ __ __ __ __ __ __ __ __ __ __ __",def:[12,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO03W100",name:"ISO dash space",ascii_art:"__    __    __    __    __    __",def:[12,-18],pen_width:1,unit:"mm"},{id:"ACAD_ISO04W100",name:"ISO long-dash dot",ascii_art:"____ . ____ . ____ . ____ . _",def:[24,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO05W100",name:"ISO long-dash double-dot",ascii_art:"____ .. ____ .. ____ .",def:[24,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO06W100",name:"ISO long-dash triple-dot",ascii_art:"____ ... ____ ... ____",def:[24,-3,.5,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO07W100",name:"ISO dot",ascii_art:". . . . . . . . . . . . . . . . . . . .",def:[.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO08W100",name:"ISO long-dash short-dash",ascii_art:"____ __ ____ __ ____ _",def:[24,-3,6,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO09W100",name:"ISO long-dash double-short-dash",ascii_art:"____ __ __ ____",def:[24,-3,6,-3,6,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO10W100",name:"ISO dash dot",ascii_art:"__ . __ . __ . __ . __ . __ . __ . ",def:[12,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO11W100",name:"ISO double-dash dot",ascii_art:"__ __ . __ __ . __ __ . __ _",def:[12,-3,12,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO12W100",name:"ISO dash double-dot",ascii_art:"__ . . __ . . __ . . __ . .",def:[12,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO13W100",name:"ISO double-dash double-dot",ascii_art:"__ __ . . __ __ . . _",def:[12,-3,12,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO14W100",name:"ISO dash triple-dot",ascii_art:"__ . . . __ . . . __ . . . _",def:[12,-3,.5,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO15W100",name:"ISO double-dash triple-dot",ascii_art:"__ __ . . . __ __ . .",def:[12,-3,12,-3,.5,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"FENCELINE1",name:"Fenceline circle",ascii_art:"----0-----0----0-----0----0-----0--",def:[.25,-.1,["CIRC1","ltypeshp.shx","x=-.1","s=.1"],-.1,1]},{id:"FENCELINE2",name:"Fenceline square",ascii_art:"----[]-----[]----[]-----[]----[]---",def:[.25,-.1,["BOX","ltypeshp.shx","x=-.1","s=.1"],-.1,1]},{id:"TRACKS",name:"Tracks",ascii_art:"-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-",def:[.15,["TRACK1","ltypeshp.shx","s=.25"],.15]},{id:"BATTING",name:"Batting",ascii_art:"SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS",def:[1e-4,-.1,["BAT","ltypeshp.shx","x=-.1","s=.1"],-.2,["BAT","ltypeshp.shx","r=180","x=.1","s=.1"],-.1]},{id:"HOT_WATER_SUPPLY",name:"Hot water supply",ascii_art:"---- HW ---- HW ---- HW ----",def:[.5,-.2,["HW","STANDARD","S=.1","R=0.0","X=-0.1","Y=-.05"],-.2]},{id:"GAS_LINE",name:"Gas line",ascii_art:"----GAS----GAS----GAS----GAS----GAS----GAS--",def:[.5,-.2,["GAS","STANDARD","S=.1","R=0.0","X=-0.1","Y=-.05"],-.25]},{id:"ZIGZAG",name:"Zig zag",ascii_art:"/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/",def:[1e-4,-.2,["ZIG","ltypeshp.shx","x=-.2","s=.2"],-.4,["ZIG","ltypeshp.shx","r=180","x=.2","s=.2"],-.2]}],o=function(e,t){for(var n=e+3,r=t,o=1;o<n;)o*=2;for(n=o,o=1;o<r;)o*=2;r=o;var a=new Uint8Array(n*r),s=new i.DataTexture(a,n,r,i.LuminanceFormat,i.UnsignedByteType,i.UVMapping,i.ClampToEdgeWrapping,i.ClampToEdgeWrapping,i.NearestFilter,i.NearestFilter,0);return s.generateMipmaps=!1,s.flipY=!1,s.needsUpdate=!0,{tex:a,pw:n,ph:r,lineStyleTex:s}},a=function(e){for(var t=e.length,n=0,i=0;i<t;i++){var r=e[i];r.def.length>n&&(n=r.def.length)}for(var a=o(n,t),s=a.tex,c=a.pw,u=a.lineStyleTex,h=0;h<t;h++){var d=e[h];l(d,s,h,c)}return u},s=function(){return a(r)},l=function(e,t,n,i){for(var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:96,o=n*i,a=e.unit&&"mm"==e.unit?1/25.4:1,s=e.pen_width||0,l=e.def,c=0,u=0;u<l.length;u++){var h=Math.abs(l[u]),d=h<=.5*s;d&&(h=0);var p=0|h*r*a;c+=p,t[o+u+2]=p||1}t[o]=c%256,t[o+1]=c/256,t[o+l.length+2]=0}},31102:(e,t,n)=>{"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.d(t,{ZP:()=>r,I5:()=>o,p1:()=>a});var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.webglContextId=1}var t,n,r;return t=e,(n=[{key:"onContextRestored",value:function(){this.webglContextId++}},{key:"refreshTargetIfNeeded",value:function(e){this.refreshIfNeeded(e);var t=null==e?void 0:e.shareDepthFrom;this.refreshIfNeeded(t)}},{key:"refreshTargetsIfNeeded",value:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)this.refreshTargetIfNeeded(e[t]);else this.refreshTargetIfNeeded(e)}},{key:"refreshIfNeeded",value:function(e){if(!e||e.__webglContextId===this.webglContextId)return!1;this._refreshGlData(e),e.__webglContextId=this.webglContextId}},{key:"_refreshGlData",value:function(e){e instanceof THREE.Mesh&&this._refreshMeshGlData(e),e instanceof THREE.BufferGeometry&&this._refreshBufferGeometryGlData(e),e instanceof THREE.WebGLRenderTarget&&this._refreshTargetGlData(e),e instanceof THREE.Texture&&this._refreshTextureGlData(e),e instanceof THREE.Material&&this._refreshMaterialGlData(e)}},{key:"_refreshMeshGlData",value:function(e){var t;e.__webglActive&&(e.__webglActive=void 0),(null===(t=e.geometry)||void 0===t?void 0:t.__webglInit)&&(e.geometry.__webglInit=void 0)}},{key:"_refreshBufferGeometryGlData",value:function(e){for(var t in e.__webglInit&&(e.__webglInit=void 0,e.needsUpdate=!0),e.vbbuffer&&(e.vbbuffer=void 0,e.needsUpdate=!0),e.ibbuffer&&(e.ibbuffer=void 0,e.needsUpdate=!0),e.iblinesbuffer&&(e.iblinesbuffer=void 0,e.needsUpdate=!0),e.vaos&&(e.vaos=void 0,e.needsUpdate=!0),e.attributes){var n=e.attributes[t];n.buffer&&(n.buffer=void 0,e.needsUpdate=!0)}}},{key:"_refreshTargetGlData",value:function(e){e.__webglFramebuffer&&(e.__webglFramebuffer=null),e.__webglRenderbuffer&&(e.__webglRenderbuffer=null),e.__webglBoundBuffers&&(e.__webglBoundBuffers=null),e.__webglTexture&&(e.__webglTexture=null)}},{key:"_refreshTextureGlData",value:function(e){e.__webglInit&&(e.__webglInit=void 0,e.needsUpdate=!0),e.__webglTexture&&(e.__webglTexture=void 0,e.needsUpdate=!0),e.__webglTextureCube&&(e.__webglTextureCube=null,e.needsUpdate=!0)}},{key:"_refreshMaterialGlData",value:function(e){(e.program||e.programs)&&(e.program=null,e.programs=[],e.needsUpdate=!0)}}])&&i(t.prototype,n),r&&i(t,r),e}(),o=function(e){var t={};return e.getAllModels().forEach((function(e){e.isConsolidated()&&(e.unconsolidate(),t[e.id]=!0)})),t},a=function(e,t){e.getAllModels().forEach((function(n){t[n.id]&&e.impl.consolidateModel(n)}))}},88715:(e,t,n)=>{"use strict";n.r(t),n.d(t,{MaterialConverter:()=>c});var i=n(16453),r=n(97122);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function s(e){a(o,i,r,s,l,"next",e)}function l(e){a(o,i,r,s,l,"throw",e)}s(void 0)}))}}var l=Autodesk.Viewing,c={convertMaterial:function(e,t,n,i){return d.apply(this,arguments)},convertTexture:function(e,t,n,o){"bumpMap"==e.mapName||"normalMap"==e.mapName?t.anisotropy=0:t.anisotropy=o||0;t.flipY=void 0===e.flipY||e.flipY,t.invert=!1,t.wrapS=i.RepeatWrapping,t.wrapT=i.RepeatWrapping,e.isPrism?c.convertPrismTexture(e.textureObj,t,n):function(e,t){if(!e)return;var n=e.properties;t.invert=(0,r.parseMaterialBoolean)(n,"unifiedbitmap_Invert"),t.clampS=!(0,r.parseMaterialBoolean)(n,"texture_URepeat",!0),t.clampT=!(0,r.parseMaterialBoolean)(n,"texture_VRepeat",!0),t.wrapS=t.clampS?i.ClampToEdgeWrapping:i.RepeatWrapping,t.wrapT=t.clampT?i.ClampToEdgeWrapping:i.RepeatWrapping,t.matrix=e.matrix||(e.matrix=(0,r.Get2DSimpleMapTransform)(n))}(e.textureObj,t)},isPrismMaterial:f,convertMaterialGltf:function(e,t){var n=new i.MeshPhongMaterial;n.packedNormals=!0,n.textureMaps={},n.reflectivity=0;var r=e.pbrMetallicRoughness||{},a=r.baseColorTexture||r.baseColorFactor;if(a)if(Array.isArray(a))n.color=new i.Color(a[0],a[1],a[2]),n.opacity=a[3];else if("object"===o(a)){n.color=new i.Color(1,1,1);var s={mapName:"map"},l=t.gltf.textures[a.index];s.uri=t.gltf.images[l.source].uri,s.flipY=!1,n.textureMaps[s.mapName]=s}var c=r.metallicRoughnessTexture;if(c){s={mapName:"metallicRoughnessTexture"},l=t.gltf.textures[c.index];s.uri=t.gltf.images[l.source].uri,s.flipY=!1,n.textureMaps[s.mapName]=s}else n.metalness=void 0!==r.metallicFactor?r.metallicFactor:1,n.roughness=void 0!==r.roughnessFactor?r.roughnessFactor:1;!0===e.doubleSided&&(n.side=i.DoubleSide);var u=e.alphaMode||m;u===v?(n.transparent=!0,n.depthWrite=!1):(n.transparent=!1,u===g&&(n.alphaTest=void 0!==e.alphaCutoff?e.alphaCutoff:.5));if(void 0!==e.normalTexture){s={mapName:"normalTexture"},l=t.gltf.textures[e.normalTexture.index];s.uri=l.source,s.flipY=!1,s.uri=t.gltf.images[l.source].uri,n.normalScale=new i.Vector2(1,1),void 0!==e.normalTexture.scale&&n.normalScale.set(e.normalTexture.scale,e.normalTexture.scale)}if(void 0!==e.occlusionTexture){s={mapName:"occlusionTexture"},l=t.gltf.textures[e.occlusionTexture.index];s.uri=t.gltf.images[l.source].uri,s.flipY=!1,n.textureMaps[s.mapName]=s,void 0!==e.occlusionTexture.strength&&(n.aoMapIntensity=e.occlusionTexture.strength)}void 0!==e.emissiveFactor&&(n.emissive=(new i.Color).fromArray(e.emissiveFactor));if(void 0!==e.emissiveTexture){s={mapName:"emissiveTexture"},l=t.gltf.textures[e.emissiveTexture.index];s.uri=t.gltf.images[l.source].uri,s.flipY=!1,n.textureMaps[s.mapName]=s}return n},applyAppearanceHeuristics:function(e,t,n){var r=e.proteinMat?e.proteinMat:null,o=e.prismType&&-1!==e.prismType.indexOf("Prism");o&&e.transparent&&(e.side===i.FrontSide&&"PrismGlazing"!==e.prismType&&(e.side=i.DoubleSide),e.side===i.DoubleSide&&e.depthTest&&(e.twoPassTransparency=!0));var a=e.textureMaps||{};if(!t){var s,l,c=e.proteinType&&-1!==e.proteinType.indexOf("Prism");if(e.metal)e.reflectivity||(e.reflectivity=y(e.specular)),r&&(1===e.reflectivity&&(e.reflectivity=y(e.specular)),0===e.color.r&&0===e.color.g&&0===e.color.b||(e.color.r*=.1,e.color.g*=.1,e.color.b*=.1));else if(c){var u=!1;if("PrismLayered"===e.proteinType){e.clearcoat=!0,e.reflectivity=.06;var h=e.proteinCategories;h&&h.length&&-1!=h[0].indexOf("Metal")&&(u=!0)}e.reflectivity=Math.sqrt(e.reflectivity),u?e.specular.copy(e.color):(e.specular.r=e.reflectivity,e.specular.g=e.reflectivity,e.specular.b=e.reflectivity)}else e.reflectivity?e.reflectivity>.3?(e.metal=!0,e.specular.r=e.color.r,e.specular.g=e.color.g,e.specular.b=e.color.b,e.color.r*=.1,e.color.g*=.1,e.color.b*=.1):(e.specular.r*=e.reflectivity,e.specular.g*=e.reflectivity,e.specular.b*=e.reflectivity):1!==e.color.r||1!==e.color.g||1!==e.color.b||1!==e.specular.r||1!==e.specular.g||1!==e.specular.b||a.map||a.specularMap?(e.reflectivity=.01+.06*y(e.specular),e.specular.r*=e.reflectivity,e.specular.g*=e.reflectivity,e.specular.b*=e.reflectivity):(e.metal=!0,e.reflectivity=.7,e.color.r*=.1,e.color.g*=.1,e.color.b*=.1),e.opacity<1&&(e.reflectivity=1);(e.transparent||-1!==(null===(s=a.map)||void 0===s||null===(l=s.uri)||void 0===l?void 0:l.toLowerCase().indexOf(".png"))||a.alphaMap)&&(e.alphaTest=.01)}if(a.normalMap){var d=e.bumpScale;(void 0===d||d>=1)&&(d=1),e.normalScale=new i.Vector2(d,d)}else(void 0===e.bumpScale&&(a.map||a.bumpMap)||e.bumpScale>=1)&&(e.bumpScale=.03);if((!t||o)&&e.transparent){if(o)e.lmv_depthWriteTransparent=!0,e.depthWrite=!!n;else if(e.opacity>=1)a.alphaMap||(e.transparency=!1);else e.lmv_depthWriteTransparent=!0,e.depthWrite=!!n}void 0!==e.shininess&&(e.shininess*=.25)},applyGeometryFlagsToMaterial:function(e,t){t.attributes.color&&(e.vertexColors=i.VertexColors,e.needsUpdate=!0);if(!e.proteinType&&t.attributes.uv&&t.attributes.uv.isPattern){var n=!1;e.map&&!e.bumpMap&&(e.bumpMap=e.map,e.needsUpdate=!0,n=!0),e.textureMaps&&e.textureMaps.map&&!e.textureMaps.bumpMap&&(e.textureMaps.bumpMap=e.textureMaps.map,e.needsUpdate=!0,n=!0),n&&void 0===e.bumpScale&&(e.bumpScale=.03)}},hasTiling:function(e){var t=e.materials[e.userassets[0]];if(t){if("TilingPattern"===t.definition)return!0}return!1},loadMaterialConverterPrismLibrary:u};function u(){return h.apply(this,arguments)}function h(){return(h=s(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l.MaterialConverterPrism&&l.MaterialConverterPrism.convertPrismMaterial){e.next=3;break}return e.next=3,l.theExtensionManager.downloadExtension("Autodesk.Viewing.MaterialConverterPrism");case 3:if(!c.convertPrismMaterial)for(t in l.MaterialConverterPrism)c[t]=l.MaterialConverterPrism[t];case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(){return(d=s(regeneratorRuntime.mark((function e(t,n,o,a){var s,l,h,d,m,g,v,y,b,_,x,E,w,S,A,M;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!f(t)){e.next=7;break}return e.next=4,u();case 4:return o=c.convertPrismMaterial(t,n,o,a),t.transparent=o.transparent,e.abrupt("return",o);case 7:if(a=a||t.userassets,s=t.materials,l=s[a],h=l.properties,o){e.next=15;break}o=new i.MeshPhongMaterial,e.next=20;break;case 15:if(o instanceof i.MeshPhongMaterial){e.next=19;break}return e.abrupt("return",null);case 19:o.needsUpdate=!0;case 20:if(o.proteinMat=t,o.proteinCategories=l.categories,o.packedNormals=!0,!l||"SimplePhong"!==l.definition){e.next=86;break}o.tag=l.tag,o.proteinType=l.proteinType,void 0===o.proteinType&&(o.proteinType=null),g=(0,r.parseMaterialBoolean)(h,"generic_baked_lighting",!1),o.disableEnvMap=g,v=o.ambient=(0,r.parseMaterialColor)(h,"generic_ambient"),y=o.color=(0,r.parseMaterialColor)(h,"generic_diffuse"),b=o.specular=(0,r.parseMaterialColor)(h,"generic_specular"),_=o.emissive=(0,r.parseMaterialColor)(h,"generic_emissive"),o.shininess=(0,r.parseMaterialScalar)(h,"generic_glossiness",30),o.opacity=1-(0,r.parseMaterialScalar)(h,"generic_transparency",0),o.reflectivity=(0,r.parseMaterialScalar)(h,"generic_reflectivity_at_0deg",0),x=(0,r.parseMaterialBoolean)(h,"generic_bump_is_normal"),null==(E=(0,r.parseMaterialScalar)(h,"generic_bump_amount",0))&&(E=1),x?(E>1&&(E=1),o.normalScale=new i.Vector2(E,E)):(E>=1&&(E=.03),o.bumpScale=E),void 0!==(w=(0,r.parseMaterialBoolean)(h,"generic_is_metal"))&&(o.metal=w),void 0===(S=(0,r.parseMaterialBoolean)(h,"generic_backface_cull"))||S||(o.side=i.DoubleSide),o.transparent=l.transparent,o.textureMaps={},A=l.textures,e.t0=regeneratorRuntime.keys(A);case 48:if((e.t1=e.t0()).done){e.next=81;break}if(M=e.t1.value,(d={}).textureObj=s[A[M].connections[0]],m=d.textureObj.properties,d.textureObj.matrix=p(d.textureObj),d.uriPointer=m.uris.unifiedbitmap_Bitmap.values,d.uri=d.uriPointer[0],d.uri){e.next=58;break}return e.abrupt("continue",48);case 58:if("generic_diffuse"!=M){e.next=63;break}d.mapName="map",(!o.color||0===o.color.r&&0===o.color.g&&0===o.color.b)&&o.color.setRGB(1,1,1),e.next=78;break;case 63:if("generic_bump"!=M){e.next=67;break}d.mapName=x?"normalMap":"bumpMap",e.next=78;break;case 67:if("generic_specular"!=M){e.next=71;break}d.mapName="specularMap",e.next=78;break;case 71:if("generic_alpha"!=M){e.next=77;break}d.mapName="alphaMap",o.side=i.DoubleSide,o.transparent=!0,e.next=78;break;case 77:return e.abrupt("continue",48);case 78:o.textureMaps[d.mapName]=d,e.next=48;break;case 81:0===y.r&&0===y.g&&0===y.b&&0===b.r&&0===b.g&&0===b.b&&0===v.r&&0===v.g&&0===v.b&&0===_.r&&0===_.g&&0===_.b&&(y.r=y.g=y.b=.4),o.extraDepthOffset=(0,r.parseMaterialScalar)(h,"generic_depth_offset"),o.extraDepthOffset&&(o.polygonOffset=!0,o.polygonOffsetFactor=o.extraDepthOffset,o.polygonOffsetUnits=0),e.next=91;break;case 86:o.ambient=new i.Color(197379),o.color=new i.Color(7829367),o.specular=new i.Color(3355443),o.shininess=30,o.shading=i.SmoothShading;case 91:return t.transparent=o.transparent,e.abrupt("return",o);case 93:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return e.matrix||(e.matrix=(0,r.Get2DSimpleMapTransform)(e.properties)),e.matrix}function f(e){var t=e.materials,n=t[e.userassets[0]];if(n){var i=n.definition;if("TilingPattern"===i)(n=t[n.properties.references.grout_material.connections[0]])&&(i=n.definition);return"PrismLayered"===i||"PrismMetal"===i||"PrismOpaque"===i||"PrismTransparent"===i||"PrismGlazing"===i||"PrismWood"===i}return!1}var m="OPAQUE",g="MASK",v="BLEND";function y(e){return.299*e.r+.587*e.g+.114*e.b}},97122:(e,t,n)=>{"use strict";n.r(t),n.d(t,{parseMaterialColor:()=>r,parseMaterialScalar:()=>o,parseMaterialBoolean:()=>a,parseMaterialGeneric:()=>s,SRGBToLinearFloat:()=>l,SRGBToLinear:()=>c,Get2DSimpleMapTransform:()=>u,MaterialConverterCommon:()=>h});var i=n(16453);function r(e,t,n){if(!e||!e.colors)return new i.Color(1,0,0);var r=e.colors[t];if(!r)return new i.Color(0,0,0);var o=r.values;if(!o||!o.length)return new i.Color(1,0,0);var a=o[0];return new i.Color(a.r,a.g,a.b)}function o(e,t,n){if(!e||!e.scalars)return n;var i=e.scalars[t];return i?i.values[0]:n}function a(e,t,n){if(!e||!e.booleans)return n;var i=e.booleans[t];return void 0===i?n:i}function s(e,t,n,i){if(!e||!e[t])return i;var r=e[t][n];return r?r.values[0]:i}function l(e){var t=e;return t<=.04045?t/=12.92:t=Math.pow((t+.055)/1.055,2.4),t}function c(e){var t,n,r;return t=l(e.r),n=l(e.g),r=l(e.b),new i.Color(t,n,r)}function u(e){var t=o(e,"texture_UScale",1),n=o(e,"texture_VScale",1),i=o(e,"texture_UOffset",0),r=o(e,"texture_VOffset",0),a=o(e,"texture_WAngle",0);return{elements:[Math.cos(a)*t,Math.sin(a)*n,0,-Math.sin(a)*t,Math.cos(a)*n,0,i,r,1]}}var h={parseMaterialColor:r,parseMaterialScalar:o,parseMaterialBoolean:a,parseMaterialGeneric:s,SRGBToLinearFloat:l,SRGBToLinear:c,Get2DSimpleMapTransform:u}},9140:(e,t,n)=>{"use strict";n.r(t),n.d(t,{MATERIAL_VARIANT:()=>A,MaterialManager:()=>M});var i=n(49321),r=n(98926),o=n(88715),a=n(50005),s=n(16453),l=n(14705),c=n(71519),u=n.n(c),h=n(18350),d=n.n(h),p=n(12990),f={uniforms:s.UniformsUtils.merge([p.ShaderChunks.CutPlanesUniforms,{pixelsPerUnit:{type:"f",value:1},aaRange:{type:"f",value:.5},tLayerMask:{type:"t",value:null},tLineStyle:{type:"t",value:null},vLineStyleTexSize:{type:"v2",value:new s.Vector2(13,70)},tRaster:{type:"t",value:null},tSelectionTexture:{type:"t",value:null},vSelTexSize:{type:"v2",value:new s.Vector2(4096,1)},displayPixelRatio:{type:"f",value:1},opacity:{type:"f",value:1},selectionColor:{type:"v4",value:new s.Vector4(0,0,1,1)},modelId:{type:"v3",value:new s.Vector3(0,0,0)},viewportId:{type:"f",value:0},swap:{type:"f",value:0},grayscale:{type:"f",value:0},viewportBounds:{type:"v4",value:new s.Vector4(0,0,1,1)},unpackXform:{type:"v4",value:new s.Vector4(1,1,0,0),perObject:!0},tIdColor:{type:"t",value:null,perObject:!0},vIdColorTexSize:{type:"v2",value:new s.Vector2(256,1),perObject:!0},meshAnimTime:{type:"f",value:0,perObject:!0}}]),attributes:{fields1:0,fields2:0,color4b:0,dbId4b:0,flags4b:0,layerVp4b:0,extraParams:0,instFlags4b:0,uvIdColor:0},defines:{},vertexShader:u(),fragmentShader:d()},m=n(84325),g=n.n(m),v=n(59191),y=n.n(v),b={uniforms:s.UniformsUtils.merge([p.ShaderChunks.CutPlanesUniforms,{pixelsPerUnit:{type:"f",value:1},aaRange:{type:"f",value:1},tLayerMask:{type:"t",value:null},tLineStyle:{type:"t",value:null},vLineStyleTexSize:{type:"v2",value:new s.Vector2(13,70)},tRaster:{type:"t",value:null},tSelectionTexture:{type:"t",value:null},vSelTexSize:{type:"v2",value:new s.Vector2(4096,1)},displayPixelRatio:{type:"f",value:1},size:{type:"v2",value:new s.Vector2(1024,768)},opacity:{type:"f",value:1},selectionColor:{type:"v4",value:new s.Vector4(0,0,1,1)},modelId:{type:"v3",value:new s.Vector3(0,0,0)},viewportId:{type:"f",value:0},swap:{type:"f",value:0},grayscale:{type:"f",value:0},viewportBounds:{type:"v4",value:new s.Vector4(0,0,1,1)},unpackXform:{type:"v4",value:new s.Vector4(1,1,0,0),perObject:!0},tIdColor:{type:"t",value:null,perObject:!0},vIdColorTexSize:{type:"v2",value:new s.Vector2(256,1),perObject:!0},meshAnimTime:{type:"f",value:0,perObject:!0}}]),attributes:{fields1:0,fields2:0,color4b:0,dbId4b:0,flags4b:0,layerVp4b:0,extraParams:0,instFlags4b:0,uvIdColor:0},defines:{},vertexShader:g(),fragmentShader:y()};function _(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}function x(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function a(e){_(o,i,r,a,s,"next",e)}function s(e){_(o,i,r,a,s,"throw",e)}a(void 0)}))}}function E(e,t,n){e.x=t.r,e.y=t.g,e.z=t.b,e.w=n}var w=new s.Color("#0000FF"),S=.6,A={INSTANCED:0,VERTEX_IDS:1};function M(e){this._renderer=e,this._textures={},this._texturesToUpdate=[],this._materials={},this._materialsNonHDR={},this._exposureBias=0,this._tonemapMethod=0,this._envMapExposure=1,this._envRotationSin=0,this._envRotationCos=1,this._reflectionMap=null,this._irradianceMap=null,this._cutplanes=[],this._mrtNormals=!1,this._mrtIdBuffer=void 0,this._polygonOffsetOn=!1,this._pixelsPerUnit=1,this._lineStyleTex=null,this._swapBlackAndWhite=0,this._grayscaleLines=0,this._depthWriteTransparent=!0,this._needsTwoSided=!1,this._hasTransparentMaterial=!1,this.hasPrism=!1,this._forceDoubleSided=!1,this._layerMaskTextures=[],this._layerMaps=[],this._selectionTextures={},this._prismWoodTextures=void 0,this.defaultMaterial=new s.MeshPhongMaterial({ambient:197379,color:7829367,specular:3355443,shininess:30,shading:s.SmoothShading,reflectivity:0}),this.addMaterial("__defaultMaterial__",this.defaultMaterial),this.initLineStyleTexture(),this.refCount=0}M.prototype.dtor=function(){this.cleanup(),s.Cache.clear(),this._renderer=null},M.prototype._getModelHash=function(e){var t=e&&("number"==typeof e?e:e.id);return"model:"+(t||"")+"|"},M.prototype._getMaterialHash=function(e,t){return e&&e.isOTG()?t:this._getModelHash(e)+"mat:"+t},M.prototype._getTextureHash=function(e,t,n){return this._getModelHash(e)+"tex:"+t+"|map:"+n},M.prototype.addNonHDRMaterial=function(e,t){t.doNotCut||(t.cutplanes=this._cutplanes),this._applyMRTFlags(t),this._materialsNonHDR[e]=t},M.prototype.removeNonHDRMaterial=function(e){delete this._materialsNonHDR[e]},M.prototype.addMaterialNonHDR=function(e,t){this.addNonHDRMaterial(e,t)},M.prototype.addHDRMaterial=function(e,t){this._reflectionMap&&!t.disableEnvMap&&(t.envMap=this._reflectionMap),this._irradianceMap&&(t.irradianceMap=this._irradianceMap),t.exposureBias=Math.pow(2,this._exposureBias),t.tonemapOutput=this._tonemapMethod,t.envMapExposure=this._envMapExposure,t.envRotationSin=this._envRotationSin,t.envRotationCos=this._envRotationCos,this._applyCutPlanes(t),this._applyMRTFlags(t),this._applyPolygonOffset(t,this._polygonOffsetOn),this._materials[e]=t},M.prototype._applyCutPlanes=function(e){e.doNotCut?e.cutplanes=null:(e.cutplanes=this._cutplanes,e.needsUpdate=!0,this._cutplanes&&this._cutplanes.length>0?e.side=s.DoubleSide:this._needsTwoSided||e.is2d||this._forceDoubleSided||(e.side=s.FrontSide))},M.prototype.addMaterial=function(e,t,n){var i=t.prismType&&-1!==t.prismType.indexOf("Prism");this.hasPrism=i||this.hasPrism,o.MaterialConverter.applyAppearanceHeuristics(t,i||n,this.isDepthWriteTransparentEnabled()),t.side===s.DoubleSide&&(this._needsTwoSided=!0),this.addHDRMaterial(e,t)},M.prototype.addLineMaterial=function(e,t,n){var i=n&&this._layerMaskTextures[n];i&&(t.defines.HAS_LAYERS=1,t.uniforms.tLayerMask.value=i),t.hasLineStyles&&(t.defines.HAS_LINESTYLES=1,t.defines.MAX_LINESTYLE_LENGTH=this._lineStyleTex.image.width,t.uniforms.tLineStyle.value=this._lineStyleTex,t.uniforms.vLineStyleTexSize.value.set(this._lineStyleTex.image.width,this._lineStyleTex.image.height)),t.uniforms.swap.value=this._swapBlackAndWhite,t.uniforms.grayscale.value=this._grayscaleLines,t.doNotCut||(t.cutplanes=this._cutplanes),this._updatePixelScaleForMaterial(t),this._materials[e]=t,this._applyMRTFlags(t)},M.prototype.addOverrideMaterial=function(e,t){if(this.addNonHDRMaterial(e,t),t.variants)for(var n=0;n<t.variants.length;n++){var i=t.variants[n];if(i){var r=e+"_variant_"+n;this.addNonHDRMaterial(r,i)}}},M.prototype.getMaterialVariant=function(e,t,n){var i=!!e.hash,r=(i?e.hash:this._getModelHash(n)+e.id)+"|"+t,o=this._materials[r];return o||(o=this.cloneMaterial(e,n),t===A.INSTANCED?(o.useInstancing=!0,o.vertexIds=!0):t===A.VERTEX_IDS&&(o.vertexIds=!0),this.addHDRMaterial(r,o)),i&&this._addMaterialRef(o,n.id),o},M.prototype.addInstancingSupport=function(e){var t=e.clone();t.useInstancing=!0,t.packedNormals=e.packedNormals;var n=e.clone();n.wideLines=!0,n.packedNormals=e.packedNormals,e.variants=[t,n],e.getCustomOverrideMaterial=function(e){return e.useInstancing?this.variants[0]:e.wideLines?(this.variants[1].linewidth=e.linewidth,this.variants[1]):null}},M.prototype.addCompactLayoutSupport=function(e){var t=function(t){var n=t.clone();return e.uniforms.tSelectionTexture.value&&(n.uniforms.tSelectionTexture.value=e.uniforms.tSelectionTexture.value),e.uniforms.tLayerMask.value&&(n.uniforms.tLayerMask.value=e.uniforms.tLayerMask.value),n.is2d=e.is2d,n.supportsViewportBounds=e.supportsViewportBounds,n.modelScale=e.modelScale,n.defines=Object.assign({},e.defines),n.attributes=Object.assign({},e.attributes),n},n=t(e);n.defines.UNPACK_POSITIONS=1;var i=t(e);i.defines.USE_INSTANCING=1;var r=t(e);r.defines.UNPACK_POSITIONS=1,r.defines.USE_INSTANCING=1,e.variants=[n,i,r],e.getCustomOverrideMaterial=function(e){if(e.defines){var t=(e.defines.UNPACK_POSITIONS?1:0)+(e.defines.USE_INSTANCING?2:0);if(t>0)return this.variants[t-1]}return null}},M.prototype.removeMaterial=function(e){delete this._materials[e]},M.prototype.findMaterial=function(e,t){var n=this._getMaterialHash(e,t);return this._materials[n]},M.prototype.convertSharedMaterial=function(){var e=x(regeneratorRuntime.mark((function e(t,n,i){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.findMaterial(t,i)){e.next=6;break}return e.next=4,this.convertOneMaterial(t,n,i);case 4:(r=e.sent).hash=i;case 6:return this._addMaterialRef(r,t.id),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),M.prototype.convertOneMaterial=function(){var e=x(regeneratorRuntime.mark((function e(t,n,i){var a,l,c,u,h,d,p,f,m,g,v,y,b,_,x,E;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=o.MaterialConverter.isPrismMaterial(n))){e.next=4;break}return e.next=4,o.MaterialConverter.loadMaterialConverterPrismLibrary();case 4:return l=t.getData(),c=l&&l.materials?l.materials.scene.SceneUnit:"inch",(u=a&&o.MaterialConverter.swapPrismWoodTextures(this._prismWoodTextures))&&r.logger.warn("Unexpected wood textures converting a material"),e.next=10,o.MaterialConverter.convertMaterial(n,c);case 10:if(h=e.sent,l.doubleSided&&(h.side=s.DoubleSide),this.addMaterial(i,h),this._hasTransparentMaterial=this._hasTransparentMaterial||h.transparent,!o.MaterialConverter.hasTiling(n)){e.next=36;break}h.decals=[],d=n.materials,p=d[n.userassets[0]],f=p.properties.references.base_materials.connections,m=p.properties.references.tiles.connections,g=[],v=0;case 22:if(!(v<m.length)){e.next=35;break}return y=d[m[v]],g.push(y),e.next=27,o.MaterialConverter.convertMaterial(n,c,null,f[v]);case 27:(b=e.sent).useTiling=!0,b.transparent=!0,h.decals.push({uv:0,material:b}),this.addMaterial(i+"|tile|"+v,b);case 32:v++,e.next=22;break;case 35:o.MaterialConverter.materialTilingPattern(n,p,g,h.decals,c);case 36:if(!n.decals){e.next=49;break}h.decals||(h.decals=[]),_=0,x=n.decals.length;case 39:if(!(_<x)){e.next=49;break}return E=n.decals[_],e.next=43,o.MaterialConverter.convertMaterial(E.material,c);case 43:b=e.sent,h.decals.push({uv:E.uv||0,material:b}),this.addMaterial(i+"|decal|"+_,b);case 46:_++,e.next=39;break;case 49:return this._prismWoodTextures=a&&o.MaterialConverter.swapPrismWoodTextures(u),e.abrupt("return",h);case 51:case"end":return e.stop()}}),e,this)})));return function(t,n,i){return e.apply(this,arguments)}}(),M.prototype.forEach=function(e,t,n,i){for(var r in i=i||this._materials){var o=i[r];t&&o.is2d||(e(o,r),n&&o.variants&&o.variants.forEach((function(t){t&&e(t)})))}},M.prototype.forEachInModel=function(e,t,n){var i=this._getModelHash(e),r=function(e,t){-1!==t.indexOf(i)&&n(e)};this.forEach(r,!1,t),this.forEach(r,!1,t,this._materialsNonHDR)};var T={needsClear:!1,needsRender:!1,overlayDirty:!1};function C(e,t,n){var i=e.slots[n];i?-1==i.indexOf(t)&&i.push(t):e.slots[n]=[t]}M.prototype.updateMaterials=function(){for(T.needsRender=!1;this._texturesToUpdate.length;){var e=this._texturesToUpdate.pop();for(var t in e.slots)for(var n=e.slots[t],i=0;i<n.length;i++)n[i][t]=e.tex,n[i].needsUpdate=!0,T.needsRender=!0}return T},M.prototype.setTextureInCache=function(e,t,n){var i=this._getTextureHash(e,t.uri,t.mapName),r=this._textures[i];if(r){for(var o in r.tex||(r.tex=n),r.slots)for(var a=r.slots[o],s=0;s<a.length;s++)a[s][o]=n;this._texturesToUpdate.push(r)}},M.prototype.loadTextureFromCache=function(e,t,n,i){var r=this._getTextureHash(e,n.uri,n.mapName),o=this._textures[r];if(o)o.tex?(t[i]=o.tex,t.needsUpdate=!0):(o.slots[i]||(o.slots[i]=[]),o.slots[i].push(t));else{var a={};a[i]=[t],this._textures[r]={slots:a,tex:null}}return!!o},M.prototype.getOtgMaterials=function(e){for(var t=function(e,t){var n=t.indexOf(e);if(-1!==n)return{hash:e,idx:n};var i=e+"|"+A.INSTANCED,r=t.indexOf(i);if(-1!==r)return{hash:i,idx:r};var o=e+"|"+A.VERTEX_IDS,a=t.indexOf(o);return-1!==a?{hash:o,idx:a}:void 0},n={},i=e.getData(),r=i.fragments.materials,o=Object.keys(this._materials),a=0;a<r.length;a++){var s=r[a],l=t(i.getMaterialHash(s),o);l&&(n[l.hash]=this._materials[l.hash],o.splice(l.idx,1))}return n},M.prototype.getModelMaterials=function(e,t){var n=this._getModelHash(e),i={},r={};for(var o in t&&e.isOTG()&&(i=this.getOtgMaterials(e)),this._materials)if(-1!==o.indexOf(n)){var a=this._materials[o];a.defines&&a.defines.hasOwnProperty("SELECTION_RENDERER")?r[o]=a:i[o]=a}var s={};for(var l in this._materialsNonHDR)-1!==l.indexOf(n)&&(s[l]=this._materialsNonHDR[l]);var c={};for(var u in this._textures)-1!==u.indexOf(n)&&(c[u]=this._textures[u]);return{mats:i,selectionMats:r,matsNonHDR:s,textures:c}},M.prototype.exportModelMaterials=function(e,t){var n=this.getModelMaterials(e);return this.cleanup(e),n},M.prototype.importModelMaterials=function(e,t){for(var n in e.mats){var i=e.mats[n];i.is2d?this.addLineMaterial(n,i,t):this.addHDRMaterial(n,i)}for(var n in e.matsNonHDR)this.addMaterialNonHDR(n,e.matsNonHDR[n]);for(var r in e.textures)this._textures[r]=e.textures[r]},M.prototype.cloneMaterial=function(e,t){var n=e.clone();if(e.defines&&(n.defines=Object.assign({},e.defines)),(n instanceof s.MeshPhongMaterial||n.isPrismMaterial)&&(n.packedNormals=e.packedNormals,n.exposureBias=e.exposureBias,n.irradianceMap=e.irradianceMap,n.envMapExposure=e.envMapExposure,n.envRotationSin=e.envRotationSin,n.envRotationCos=e.envRotationCos,n.proteinType=e.proteinType,n.proteinMat=e.proteinMat,n.proteinCategories=e.proteinCategories,n.tonemapOutput=e.tonemapOutput,n.cutplanes=e.cutplanes,n.textureMaps=e.textureMaps,n.texturesLoaded=e.texturesLoaded),e.doNotCut&&(n.doNotCut=!0),e.is2d&&(n.is2d=!0),e.disableEnvMap&&(n.disableEnvMap=!0),e.supportsViewportBounds&&(n.supportsViewportBounds=!0),e.textureMaps)for(var i in e.textureMaps)if(e[i])n[i]=e[i];else if(t){var o=n.textureMaps[i],a=o.uri,l=o.mapName,c=this._getTextureHash(t,a,l),u=this._textures[c];u?C(u,n,i):r.logger.error("Missing texture receiver",c)}else r.logger.error("Cannot connect pending texture maps because cloneMaterial was called without a model");return this._applyMRTFlags(n),n},M.prototype.setupMaterial=function(e,t,n){var i=e.getData(),a=this.findMaterial(e,n);if(!a){a=this.cloneMaterial(this.defaultMaterial,e);var l=this._getMaterialHash(e,n);this._materials[l]=a,r.logger.warn("Material ("+n+") missing, using default material instead.")}if(t.isLines||t.isWideLines||t.isPoints){var c=!!t.attributes.color,u=a;if(u||(u=this.defaultMaterial.clone()),t.isPoints)a=new s.PointCloudMaterial({vertexColors:c,size:t.pointSize});else{var h=c?"cachedLineMaterialVC":"cachedLineMaterial";a=u[h],t.isWideLines?(a||((a=u[h]=new s.MeshBasicMaterial({vertexColors:c})).wideLines=!0,t.isLines=!1),a.polygonOffset=u.polygonOffset,a.polygonOffsetFactor=u.polygonOffsetFactor,a.polygonOffsetUnits=u.polygonOffsetUnits,a.linewidth=u.linewidth):a||(a=u[h]=new s.LineBasicMaterial({vertexColors:c}))}c||(a.color=u.color),a.svfMatId=n;var d=this._getMaterialHash(e,n+"_line_"+a.id);this.addMaterialNonHDR(d,a),i.hasLines=!0}else a.svfMatId=n,o.MaterialConverter.applyGeometryFlagsToMaterial(a,t);return a},M.prototype._addMaterialRef=function(e,t){e._sharedBy||(e._sharedBy=[]);var n=e._sharedBy;-1===n.indexOf(t)&&n.push(t)},M.prototype._removeMaterialRef=function(e,t){var n=e._sharedBy,i=n?n.indexOf(t):-1;-1!==i&&n.splice(i,1)},M.prototype.cleanup=function(e){var t=this,n=this._getModelHash(e),i={};for(var r in this._textures){var a=this._textures[r];-1===r.indexOf(n)?i[r]=a:a.tex&&(a.tex.dispose(),a.tex.needsUpdate=!0)}this._textures=i;var l={},c={type:"dispose"};for(var u in this._materials){var h=this._materials[u],d=!e||-1!==u.indexOf(n);if(h._sharedBy&&(d?h._sharedBy.length=0:(this._removeMaterialRef(h,e.id),0===h._sharedBy.length&&(d=!0))),d){if((h=this._materials[u]).dispatchEvent(c),h.needsUpdate=!0,h.envMap=null,h.is2d){h.uniforms.tLayerMask.value=null,h.uniforms.tLineStyle.value=null;var p=h.uniforms.tRaster;p&&p.value instanceof s.Texture&&(p.value.dispose(),p.value.needsUpdate=!0)}}else l[u]=this._materials[u]}this._materials=l;var f={};for(var u in this._materialsNonHDR){if(e&&-1===u.indexOf(n))f[u]=this._materialsNonHDR[u];else(h=this._materialsNonHDR[u]).dispatchEvent(c),h.needsUpdate=!0}this._materialsNonHDR=f;var m=function(e,n){var i=t._selectionTextures[e];i&&(i.dispose(),i.needsUpdate=!0,n&&delete t._selectionTextures[e])};if(this._prismWoodTextures&&o.MaterialConverter.disposePrismWoodTextures(this._prismWoodTextures),this._prismWoodTextures=void 0,e)m(e.id,!0),delete this._layerMaskTextures[e.id],delete this._layerMaps[e.id];else{for(var g in this._selectionTextures)this._selectionTextures.hasOwnProperty(g)&&m(g,!1);this._selectionTextures={},this._layerMaskTextures={},this._layerMaps={},this._reflectionMap=null,this._irradianceMap=null}},M.prototype.toggleDepthWriteTransparent=function(e){this._depthWriteTransparent!=e&&(this._depthWriteTransparent=e,this.forEach((function(t){t.lmv_depthWriteTransparent&&(t.depthWrite=e)}),!1,!0))},M.prototype.isDepthWriteTransparentEnabled=function(){return this._depthWriteTransparent},M.prototype.hasTwoSidedMaterials=function(){return this._needsTwoSided},M.prototype.hasTransparentMaterial=function(){return this._hasTransparentMaterial},M.prototype.texturesLoaded=function(){return 0===this._texturesToUpdate.length},M.prototype.renderer=function(){return this._renderer},M.prototype.setTonemapExposureBias=function(e){this._exposureBias=e;var t=Math.pow(2,e);this.forEach((function(e){e.exposureBias=t,e.needsUpdate=!0}),!0,!0)},M.prototype.setTonemapMethod=function(e){this._tonemapMethod=e,this.forEach((function(t){t.tonemapOutput=e,t.needsUpdate=!0}),!0,!0)},M.prototype.setEnvExposure=function(e){var t=Math.pow(2,e);this._envMapExposure=t,this.forEach((function(e){e.envMapExposure=t,e.needsUpdate=!0}),!0,!0)},M.prototype.setEnvRotation=function(e){var t=this._envRotationSin=Math.sin(e),n=this._envRotationCos=Math.cos(e);this.forEach((function(e){e.envRotationSin=t,e.envRotationCos=n,e.needsUpdate=!0}),!0,!0)},M.prototype.setReflectionMap=function(e){this._reflectionMap=e,this.forEach((function(t){t.disableEnvMap||(t.envMap=e,t.needsUpdate=!0)}),!0,!0)},M.prototype.setIrradianceMap=function(e){this._irradianceMap=e,this.forEach((function(t){t.irradianceMap=e,t.needsUpdate=!0}),!0,!0)},M.prototype.setDoubleSided=function(e,t){this._forceDoubleSided=e;var n={};n=t?this.getModelMaterials(t,!0).mats:this._materials,this.forEach((function(t){t.side=e?s.DoubleSide:s.FrontSide,t.needsUpdate=!0}),!0,!0,n)},M.prototype.setCutPlanes=function(e){for(var t=this,n=!1,i=this._cutplanes.length!==(e&&e.length||0);this._cutplanes.length>0;)this._cutplanes.pop();if(e)for(var r=0;r<e.length;r++)this._cutplanes.push(e[r].clone());if(i)for(var o in this.forEach((function(e){t._applyCutPlanes(e),n=n||e.side==s.DoubleSide}),!1,!0),this._materialsNonHDR)this._materialsNonHDR[o].doNotCut||(this._materialsNonHDR[o].needsUpdate=!0);return n||this._needsTwoSided},M.prototype.getCutPlanes=function(){return this._cutplanes.slice()},M.prototype.getCutPlanesRaw=function(){return this._cutplanes},M.prototype._applyPolygonOffset=function(e){(e instanceof s.MeshPhongMaterial||e.isPrismMaterial)&&(e.polygonOffset=this._polygonOffsetOn,e.polygonOffsetFactor=this._polygonOffsetFactor,e.polygonOffsetUnits=this._polygonOffsetUnits,e.extraDepthOffset&&(e.polygonOffsetFactor+=e.extraDepthOffset),e.needsUpdate=!0)},M.prototype.getPolygonOffsetOn=function(){return this._polygonOffsetOn},M.prototype.getPolygonOffsetFactor=function(){return this._polygonOffsetFactor},M.prototype.getPolygonOffsetUnits=function(){return this._polygonOffsetUnits},M.prototype.togglePolygonOffset=function(e,t,n){this._polygonOffsetOn=e,this._polygonOffsetFactor=e?t||1:0,this._polygonOffsetUnits=e?n||.1:0;var i=this;this.forEach((function(e){i._applyPolygonOffset(e)}),!1,!0)},M.prototype._applyMRTFlags=function(e){var t=e.supportsMrtNormals||e instanceof s.MeshPhongMaterial||e.isPrismMaterial||e instanceof s.MeshBasicMaterial||e instanceof s.LineBasicMaterial||e instanceof s.PointCloudMaterial||e instanceof s.PointsMaterial,n=e.mrtNormals,i=e.mrtIdBuffer,r=this._renderer&&this._renderer.supportsMRT();e.skipMrtNormals||(e.mrtNormals=t&&r&&this._mrtNormals),e.mrtIdBuffer=r?this._mrtIdBuffer:void 0,e.mrtNormals===n&&e.mrtIdBuffer===i||(e.needsUpdate=!0)},M.prototype.toggleMRTSetting=function(e){this._mrtNormals=e.mrtNormals,this._mrtIdBuffer=e.mrtIdBuffer;var t=this;function n(e){t._applyMRTFlags(e)}this.forEach(n,!1,!0),this.forEach(n,!1,!0,this._materialsNonHDR)},M.prototype.adjustMaterialMRTSetting=function(e){this._applyMRTFlags(e)},M.prototype.initLineStyleTexture=function(){this._lineStyleTex=(0,i.createLinePatternTexture)()},M.prototype.setLineStyleTexture=function(e){this._lineStyleTex=e},M.prototype.initLayersTexture=function(e,t,n){for(var i=this._layerMaskTextures[n],r=i?i.image.data:new Uint8Array(65536),o=0,a=e;o<a;o++)r[o]=255;(i=i||new s.DataTexture(r,256,256,s.LuminanceFormat,s.UnsignedByteType,s.UVMapping,s.ClampToEdgeWrapping,s.ClampToEdgeWrapping,s.NearestFilter,s.NearestFilter,0)).generateMipmaps=!1,i.flipY=!1,i.needsUpdate=!0,this._layerMaskTextures[n]=i,this._layerMaps[n]=t},M.prototype.setLayerVisible=function(e,t,n){for(var i=this._layerMaskTextures[n],r=i.image.data,o=this._layerMaps[n],a=t?255:0,s=0;s<e.length;++s){r[o[e[s]]]=a}i.needsUpdate=!0,this.forEach((function(e){e.is2d&&(e.needsUpdate=!0)}))},M.prototype.initSelectionTexture=function(e,t){if(this._selectionTextures[t])return this._selectionTextures[t];for(var n=e||1,i=4096,r=0|Math.ceil(n/i),o=1;o<r;)o*=2;r=o;for(var a=new Uint8Array(i*r),l=0;l<n;l++)a[l]=0;var c=new s.DataTexture(a,i,r,s.LuminanceFormat,s.UnsignedByteType,s.UVMapping,s.ClampToEdgeWrapping,s.ClampToEdgeWrapping,s.NearestFilter,s.NearestFilter,0);return c.generateMipmaps=!1,c.flipY=!1,c.needsUpdate=!0,this._selectionTextures[t]=c,c},M.prototype.highlightObject2D=function(e,t,n){var i=this._selectionTextures[n];i&&(i.image.data[e]=t?255:0,i.needsUpdate=!0)},M.prototype._updatePixelScaleForMaterial=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._deviceWidth,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._deviceHeight,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._pixelsPerUnit,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;e.is2d&&(e.isScreenSpace?(e.uniforms.size.value.set(t,n),e.uniforms.aaRange.value=.5):e.uniforms.aaRange.value=.5/(i*e.modelScale*r),e.uniforms.pixelsPerUnit.value=i*e.modelScale*r)},M.prototype.updatePixelScale=function(e,t,n){var i=this;this._pixelsPerUnit=e,this._deviceWidth=t,this._deviceHeight=n,this.forEach((function(r){return i._updatePixelScaleForMaterial(r,t,n,e)}))},M.prototype.updatePixelScaleForModel=function(e,t,n,i,r){var o=this,a=this.getModelMaterials(e),s=function(e){return o._updatePixelScaleForMaterial(e,n,i,t,r)};Object.values(a.mats).forEach(s),Object.values(a.matsNonHDR).forEach(s),Object.values(a.selectionMats).forEach(s)},M.prototype.updateSwapBlackAndWhite=function(e){var t=this._swapBlackAndWhite=e?1:0;this.forEach((function(e){e.is2d&&(e.uniforms.swap.value=t)}))},M.prototype.setGrayscale=function(e){var t=this._grayscaleLines=e?1:0;this.forEach((function(e){e.is2d&&(e.uniforms.grayscale.value=t)}))},M.prototype.updateViewportId=function(e){this.forEach((function(t){t.is2d&&(t.uniforms.viewportId.value=e,t.needsUpdate=!0)}))},M.prototype.create2DMaterial=function(e,t,n,i,r){var o=e?e.getData():null,c="__lineMaterial__";t.image&&(c+="|image:"+t.image.name),t.clip&&(c+="|clip:"+JSON.stringify(t.clip)),n&&(c+="|id"),i&&(c+="|selection"),t.skipEllipticals&&(c+="|skipEllipticals"),t.skipCircles&&(c+="|skipCircles"),t.skipTriangleGeoms&&(c+="|skipTriangleGeoms"),t.useInstancing&&(c+="|useInstancing"),t.isScreenSpace&&(c+="|isScreenSpace"),t.unpackPositions&&(c+="|unpackPositions"),t.hasLineStyles&&(c+="|hasLineStyles"),t.compositeOperation&&(c+="|"+t.compositeOperation),t.hasOpacity&&(c+="|hasOpacity"),t.noIdOutput&&(c+="|noIdOutput");var u=this._getMaterialHash(e,c);if(!this._materials.hasOwnProperty(u)){var h;if(t.isScreenSpace?(h=(0,l.createShaderMaterial)(b)).isScreenSpace=!0:h=(0,l.createShaderMaterial)(f),t.hasLineStyles&&(h.hasLineStyles=!0),h.is2d=!0,h.supportsViewportBounds=!0,h.transparent=!0,h.depthWrite=!1,h.depthTest=!1,h.side=s.DoubleSide,h.blending=s.NormalBlending,"multiply"==t.compositeOperation?h.blending=s.MultiplyBlending:"min"==t.compositeOperation||"darken"==t.compositeOperation?(h.blending=s.CustomBlending,h.blendEquation=s.MinEquation,h.blendEquationAlpha=s.AddEquation,h.blendSrcAlpha=s.SrcAlphaFactor,h.blendDstAlpha=s.DstAlphaFactor):"max"!=t.compositeOperation&&"lighten"!=t.compositeOperation||(h.blending=s.CustomBlending,h.blendEquation=s.MaxEquation,h.blendEquationAlpha=s.AddEquation,h.blendSrcAlpha=s.SrcAlphaFactor,h.blendDstAlpha=s.DstAlphaFactor),n?(h.defines.ID_COLOR=1,h.blending=s.NoBlending):i?(h.uniforms.tSelectionTexture.value=i,h.uniforms.vSelTexSize.value.set(i.image.width,i.image.height),h.defines.SELECTION_RENDERER=1,this.get2dSelectionColor(h.uniforms.selectionColor)):(this.get2dSelectionColor(h.uniforms.selectionColor),this.renderer()&&this.renderer().supportsMRT()&&(h.mrtIdBuffer=this._mrtIdBuffer)),t.skipEllipticals||(h.defines.HAS_ELLIPTICALS=1),t.skipCircles||(h.defines.HAS_CIRCLES=1),t.skipTriangleGeoms||(h.defines.HAS_TRIANGLE_GEOMS=1),t.noIdOutput&&(h.defines.NO_ID_OUTPUT=1),t.useInstancing&&(h.defines.USE_INSTANCING=1),t.unpackPositions&&!n&&(h.defines.UNPACK_POSITIONS=1),t.msdfFontTexture&&(h.defines.MSDF_TEXTURE_FONT=1),t.imageUVTexture&&(h.defines.IMAGE_UV_TEXTURE=1),t.viewportBounds&&(h.uniforms.viewportBounds.value=t.viewportBounds.clone(),h.defines.VIEWPORT_CLIPPING=1),"number"==typeof t.opacity&&(h.uniforms.opacity.value=t.opacity),t.image){var d=function(n,i){n?(n.wrapS=s.ClampToEdgeWrapping,n.wrapT=s.ClampToEdgeWrapping,n.minFilter=i?s.LinearFilter:s.LinearMipMapLinearFilter,n.magFilter=s.LinearFilter,n.anisotropy=1,n.flipY=!0,n.generateMipmaps=!0,n.needsUpdate=!0,t.msdfFontTexture||t.imageUVTexture||(h.defines.HAS_RASTER_QUADS=1),h.uniforms.tRaster.value=n,h.needsUpdate=!0,r&&r(n,e)):r&&r(n,e,t)};if("undefined"!=typeof HTMLCanvasElement&&t.image instanceof HTMLCanvasElement||"undefined"!=typeof HTMLImageElement&&t.image instanceof HTMLImageElement)d(new s.Texture(a.TextureLoader.imageToCanvas(t.image,"multiply"==t.compositeOperation,t.compositeCanvasColor),s.UVMapping),!0);else a.TextureLoader.loadTextureWithSecurity(t.image.dataURI,s.UVMapping,d,null,o.acmSessionId)}h.modelScale=t.modelScale||1,t.doNotCut&&(h.doNotCut=!0),h.textureMaps={},this.addLineMaterial(u,h,e&&e.id),(n||i)&&this.addCompactLayoutSupport(h)}return c},M.prototype.set2dSelectionColor=function(e,t){w=new s.Color(e),S=null==t?S:t,this.forEach((function(e){if(e.is2d&&e.uniforms){var t=e.uniforms.selectionColor;t&&(E(t.value,w,S),e.needsUpdate=!0)}}))},M.prototype.get2dSelectionColor=function(e){return e&&E(e.value,w,S),w},M.prototype.get2dSelectionOpacity=function(){return S},M.prototype.setMaterialViewportBounds=function(e,t){e.supportsViewportBounds&&(t?e.defines.VIEWPORT_CLIPPING?e.uniforms.viewportBounds.value.set(t.min.x,t.min.y,t.max.x,t.max.y):(e.uniforms.viewportBounds.value=new s.Vector4(t.min.x,t.min.y,t.max.x,t.max.y),e.defines.VIEWPORT_CLIPPING=1,e.needsUpdate=!0):e.defines.VIEWPORT_CLIPPING&&(delete e.defines.VIEWPORT_CLIPPING,e.needsUpdate=!0))},M.prototype.setViewportBoundsForModel=function(e,t){var n=this;this.forEachInModel(e,!1,(function(e){n.setMaterialViewportBounds(e,t)}))}},93180:(e,t,n)=>{"use strict";n.r(t),n.d(t,{PhongShader:()=>c});var i=n(16453),r=n(12990),o=n(4352),a=n.n(o),s=n(83039),l=n.n(s),c={uniforms:i.UniformsUtils.merge([i.UniformsLib.common,i.UniformsLib.bump,i.UniformsLib.normalmap,i.UniformsLib.lights,i.UniformsLib.fog,r.ShaderChunks.CutPlanesUniforms,r.ShaderChunks.IdUniforms,r.ShaderChunks.ThemingUniform,r.ShaderChunks.ShadowMapUniforms,r.ShaderChunks.WideLinesUniforms,{emissive:{type:"c",value:new i.Color(0)},specular:{type:"c",value:new i.Color(1118481)},shininess:{type:"f",value:30},reflMipIndex:{type:"f",value:0},texMatrix:{type:"m3",value:new i.Matrix3},texMatrixBump:{type:"m3",value:new i.Matrix3},texMatrixAlpha:{type:"m3",value:new i.Matrix3},irradianceMap:{type:"t",value:null},exposureBias:{type:"f",value:1},envMapExposure:{type:"f",value:1},envRotationSin:{type:"f",value:0},envRotationCos:{type:"f",value:1}}]),vertexShader:a(),fragmentShader:l()};i.ShaderLib.firefly_phong=c},90564:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GetPrismMapUniforms:()=>r,PrismUtil:()=>o});var i=n(16453);function r(e){var t=e+"_texMatrix",n=e+"_invert",r={};return r[e]={type:"t",value:null},r[t]={type:"m3",value:new i.Matrix3},r[n]={type:"i",value:0},r}var o={GetPrismMapUniforms:r}},29003:(e,t,n)=>{"use strict";n.r(t),n.d(t,{RenderContext:()=>ee});var i=n(98926),r=n(79659),o=n(84998),a=n(16453),s=n(14705),l=n(5030),c=n.n(l),u=n(74957),h=n.n(u),d={uniforms:{cutplanes:{type:"v4v",value:[]}},vertexShader:c(),fragmentShader:h()},p=n(85994),f=n(79282),m=n.n(f),g=n(6750),v=n.n(g),y={uniforms:{color:{type:"v4",value:new a.Vector4(0,0,0,.3)},cutplanes:{type:"v4v",value:[]}},vertexShader:m(),fragmentShader:v()},b=n(97339),_=n(66209),x=n.n(_),E=n(50410),w=n.n(E),S={uniforms:{tDiffuse:{type:"t",value:null},size:{type:"v2",value:new a.Vector2(512,512)},resolution:{type:"v2",value:new a.Vector2(1/512,1/512)},axis:{type:"v2",value:new a.Vector2(1,0)},radius:{type:"f",value:50}},vertexShader:x(),fragmentShader:w()},A=n(11342),M=n.n(A),T=n(92003),C=n.n(T),P=n(3819),L=n.n(P),R={uniforms:{tDiffuse:{type:"t",value:null},cameraNear:{type:"f",value:1},cameraInvNearFar:{type:"f",value:100},resolution:{type:"v2",value:new a.Vector2(1/512,1/512)}},vertexShader:M(),fragmentShader:C()},D={uniforms:{tDiffuse:{type:"t",value:null},resolution:{type:"v2",value:new a.Vector2(1/512,1/512)}},vertexShader:M(),fragmentShader:L()},I=n(63332),O=n.n(I),N=n(49510),k=n.n(N),F={uniforms:{tDiffuse:{type:"t",value:null},uResolution:{type:"v2",value:new a.Vector2(1/1024,1/512)}},vertexShader:O(),fragmentShader:k()},U=n(12990),B=n(20505),V=n.n(B),G={uniforms:a.UniformsUtils.merge([U.ShaderChunks.DepthTextureUniforms,{tDiffuse:{type:"t",value:null},tAO:{type:"t",value:null},useAO:{type:"i",value:0},aoOpacity:{type:"f",value:.625},tOverlay:{type:"t",value:null},useOverlay:{type:"i",value:0},useOverlayAlpha:{type:"i",value:1},tID:{type:"t",value:null},tID2:{type:"t",value:null},objIDv4:{type:"v4",value:new a.Vector4(0,0,0,0)},modelIDv2:{type:"v2",value:new a.Vector2(0,0)},modelIDsv2v:{type:"v2v",value:[]},edgeObjIDv4:{type:"v4",value:new a.Vector4(0,0,0,0)},edgeModelIDv2:{type:"v2",value:new a.Vector2(0,0)},highlightIntensity:{type:"f",value:1},highlightColor:{type:"c",value:new a.Color(1,1,1)},resolution:{type:"v2",value:new a.Vector2(1/1024,1/512)},selectionColor:{type:"c",value:new a.Color(0,0,0)},expand2dSelection:{type:"f",value:.5},tCrossFadeTex0:{type:"t",value:null},tCrossFadeTex1:{type:"t",value:null},crossFadeOpacity0:{type:"f",value:0},crossFadeOpacity1:{type:"f",value:0},highlightFullModel:{type:"f",value:0}}]),vertexShader:x(),fragmentShader:V()},z=n(69632),H=n(61768),W=n(66199),j=(0,o.getGlobal)().document,q=1,X=2,Y=3,K=4,Z=5,J=6,Q=7,$=8;function ee(){var e,t,n,l,c,u,h,f,m,g,v,_,x,E,w,A=!1,M=new W.RenderContextPostProcessManager;this.postShadingManager=function(){return M};var T,C,P,L={},I=null,O=null,N=null,k=null,U=null,B=null,V=null,ee=[],te=null,ne=0,ie=0,re=0,oe=0,ae=1,se=!1,le=!1,ce={},ue={},he=[0,0],de=(new a.Color).setRGB(1,1,1),pe=(new a.Color).setRGB(0,0,0),fe=new a.Vector4(0,0,0,.3),me=new a.Vector4(1,1,1,1),ge=new a.Vector4(1,1,1,.5),ve=null,ye=1,be=1,_e=!1,xe=!1,Ee=!1,we=!1,Se=!1,Ae=a.RGBAFormat,Me=a.FloatType,Te=!1,Ce=0,Pe=0,Le=0,Re=[.42,0,1,1],De=!0,Ie={antialias:!0,sao:!1,useHdrTarget:!1,haveTwoSided:!1,useSSAA:!1,idbuffer:!0,customPresentPass:!1,envMapBg:!1,numIdTargets:1,renderEdges:!1,useIdBufferSelection:!1,copyDepth:!1},Oe={},Ne=null,ke=null;function Fe(e,t,n,i,r){var o=new a.WebGLRenderTarget(e,t,{minFilter:a.NearestFilter,magFilter:a.NearestFilter,format:n,type:i,stencilBuffer:!1});return r&&(o.shareDepthFrom=r),o.name="depthTarget",o}function Ue(t){try{var n=Fe(2,2,t.format,t.type);n.texture.generateMipmaps=!1,e.setRenderTarget(n);var i=e.context,r=i.checkFramebufferStatus(i.FRAMEBUFFER);return e.setRenderTarget(null),n.dispose(),r===i.FRAMEBUFFER_COMPLETE}catch(e){return!1}}function Be(){var e=(_e?[{format:a.RGBAFormat,type:a.HalfFloatType},{format:a.RGBAFormat,type:a.FloatType}]:[{format:a.RGBAFormat,type:a.FloatType},{format:a.RGBAFormat,type:a.HalfFloatType}]).find(Ue);e?(Te=!0,Ae=e.format,Me=e.type):(Te=!1,i.logger.warn("Depth target is unsupported for this device."))}function Ve(e){Ie.useIdBufferSelection=e,e?E.material.defines.USE_IDBUFFER_SELECTION="1":delete E.material.defines.USE_IDBUFFER_SELECTION}function Ge(e,t){e.depthWrite=t;for(var n=0;n<e.variants.length;n++){var i=e.variants[n];i&&(i.depthWrite=t)}}function ze(e){e(t);for(var n=1;n<t.variants.length;n++)e(t.variants[n])}function He(e){e.material.blending=a.NoBlending,e.material.depthWrite=!1,e.material.depthTest=!1}function We(){!function(){var e=d;(t=(0,s.createShaderMaterial)(e)).blending=a.NoBlending,t.packedNormals=!0,t.depthWrite=!1;var n=1,i=2,r=4,o=8,l=[];l[0]=null;for(var c=1;c<o;c++){var u=t.clone();u.packedNormals=t.packedNormals,c&n&&(u.cutPlanes=null,u.doNotCut=!0),c&i&&(u.useInstancing=!0),c&r&&(u.packedNormals=!1),l[c]=u}t.variants=l,t.getCustomOverrideMaterial=function(e){var t=!e||!e.cutplanes||0==e.cutplanes.length,o=e.useInstancing,a=!e.packedNormals,s=(t?n:0)|(o?i:0)|(a?r:0);return this.variants[s]}}(),function(){var e=y;(n=(0,s.createShaderMaterial)(e)).depthWrite=!0,n.depthTest=!0,n.isEdgeMaterial=!0,n.transparent=!0,n.blending=a.NormalBlending,n.supportsMrtNormals=!0;var t=1,i=2,r=4,l=[];l[0]=null;for(var c=1;c<r;c++){var u=n.clone();u.defines=(0,o.ObjectAssign)({},n.defines),u.isEdgeMaterial=!0,u.supportsMrtNormals=!0,c&t&&(u.useInstancing=!0),c&i&&(u.doNotCut=!0,u.cutplanes=[]),l[c]=u}n.variants=l,n.getCustomOverrideMaterial=function(e){var r=e.useInstancing?t:0;e.doNotCut&&(r|=i);var o=this.variants[r]||n;return Ee?xe?o.uniforms.color.value.copy(ge):o.uniforms.color.value.copy(me):o.uniforms.color.value.copy(fe),void 0!==e.edgeOpacity&&(o.uniforms.color.value.w=e.edgeOpacity),o.uniforms.color.needsUpdate=!0,o}}(),He(g=new p.ShaderPass(b.SAOShader)),He(m=new p.ShaderPass(S)),He(_=new p.ShaderPass(R)),He(v=new p.ShaderPass(D)),He(x=new p.ShaderPass(F)),He(E=new p.ShaderPass(G)),He(f=new p.ShaderPass(z.Q)),He(w=new p.ShaderPass(H.CopyShader))}function je(e){switch(e){case q:case K:return!0;case X:return Te&&(Ie.sao||M.isPostProcShaded());case Y:return Ie.idbuffer;case Q:return Ie.sao;case Z:return Ie.antialias||Ie.sao||Ie.customPresentPass||M.isPostProcShaded();case J:return M.isPostProcShaded()||Ie.customPresentPass;case $:return Ie.antialias&&M.isPostProcShaded()}}function qe(e,t){var n=new a.WebGLRenderTarget(e,t,{minFilter:a.NearestFilter,magFilter:a.NearestFilter,format:a.RGBAFormat,type:a.UnsignedByteType,stencilBuffer:!1});return n.texture.generateMipmaps=!1,n.shareDepthFrom=O,n.canReadPixels=!0,n}function Xe(){var t=k,n=O;if(E.uniforms.useAO.value){var i=function(){var e=[E.uniforms.useOverlay.value,E.uniforms.objIDv4.value];return E.uniforms.useOverlay.value=0,E.uniforms.objIDv4.value=new a.Vector4,e}();E.render(e,t,n),n=t,t=V,function(e){E.uniforms.useOverlay.value=e[0],E.uniforms.objIDv4.value=e[1]}(i)}var r=t===k?V:k;if(t=(n=M.render(e,t,n,r,!1))===k?V:k,E.uniforms.useOverlay.value||E.uniforms.objIDv4.value){i=function(){var e=E.uniforms.useAO.value;return E.uniforms.useAO.value=0,e}();E.render(e,t,n),n=t,function(e){E.uniforms.useAO.value=e}(i)}return r=(t=n===k?V:k)===k?V:k,n=M.render(e,t,n,r,!0)}function Ye(e,t){if(e&&t){t.length=0;for(var n=0;n<e.length;n++)t[n]=e[n]}}function Ke(e,t){return(t=t||new a.Vector2).set((255&e)/255,(e>>8&255)/255),t}function Ze(e,t,n){t=t||0;var i=function(e){return e!==Pe&&(Pe=e,-1===e&&(e=0),E.uniforms.objIDv4.value.set((255&e)/255,(e>>8&255)/255,(e>>16&255)/255,(e>>24&255)/255),!0)}(e),r=function(e){if(Array.isArray(e)&&1==e.length&&(e=e[0]),e===Le)return!1;var t=Array.isArray(Le)?Le.length:1,n=Array.isArray(e)?e.length:1;return!(n>1&&(e.sort(),n==t&&!Le.some((function(t,n){return t!==e[n]})))||(n!=t&&(1==n?delete E.material.defines.HIGHLIGHT_MODEL_ID_COUNT:E.material.defines.HIGHLIGHT_MODEL_ID_COUNT=n.toString(),E.material.needsUpdate=!0),Le=e,1==n?Ke(e=Array.isArray(e)?e[0]:e,E.uniforms.modelIDv2.value):E.uniforms.modelIDsv2v.value=e.map((function(e){return Ke(e)})),0))}(t);if(i||r)return E.uniforms.highlightIntensity.value=0,Ce=performance.now(),E.uniforms.highlightFullModel.value=n?1:0,!0}this.settings=Ie,this.depthTargetSupported=function(){return Te},this.isRolloverHighlightEnabled=function(){return _enableRolloverHighlight},this.isWeakDevice=function(){return _e},this.init=function(t,n,a){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=s.offscreen,c=void 0!==s.useIdBufferSelection&&s.useIdBufferSelection;We(),t?(_e=(0,o.isMobileDevice)(),Ie.idbuffer=!_e,c&&(Ie.idbuffer=!0,Ie.numIdTargets=2,E.material.defines.USE_MODEL_ID="1",Ve(!0)),C=n,P=a,e=t,le=!!l,Be()):(0,o.isNodeJS)()||i.logger.error("You need a gl context to make a renderer. Things will go downhill from here.",(0,r.errorCodeString)(r.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED))},this.setDepthMaterialOffset=function(e,t,n){ze((function(i){i.polygonOffset=e,i.polygonOffsetFactor=t,i.polygonOffsetUnits=n,i.extraDepthOffset&&(i.polygonOffsetFactor+=i.extraDepthOffset),i.needsUpdate=!0}))},this.setNoDepthNoBlend=He,this.overlayUpdate=function(){if(0===Pe||-1===Pe)return!1;var e=E.uniforms.highlightIntensity.value,t=1;if(De){var n=.004*(performance.now()-Ce);n=Math.min(n,1),t=function(e,t){var n=3*e[1],i=3*(e[3]-e[1])-n;return(((1-n-i)*t+i)*t+n)*t}(Re,n)}return e!=t&&(E.uniforms.highlightIntensity.value=t,!0)},this.setRollOverFadeEnabled=function(e){De=e},this.beginScene=function(t,n,s,l){if(c=n,h=t.fog,u=s,A=!1,L={},!O&&C)this.initPostPipeline(Ie.sao,Ie.antialias);else if(!O&&!C)return void(se||(0,o.isNodeJS)()||(i.logger.error("Rendering to a canvas that was resized to zero. If you see this message you may be accidentally leaking a viewer instance.",(0,r.errorCodeString)(r.ErrorCodes.VIEWER_INTERNAL_ERROR)),se=!0));if(l){var d=Ie.envMapBg&&!!f.material.envMap,p=!!f.material.useBackgroundTexture;if(!ve||d||p){var m=f.uniforms.uCamDir.value||new a.Vector3;f.uniforms.uCamDir.value=c.worldUpTransform?c.getWorldDirection(m).applyMatrix4(c.worldUpTransform):c.getWorldDirection(m),f.uniforms.uCamUp.value=c.worldUpTransform?c.up.clone().applyMatrix4(c.worldUpTransform):c.up,f.uniforms.uResolution.value.set(C,P),f.uniforms.uHalfFovTan.value=Math.tan(a.Math.degToRad(.5*c.fov)),f.uniforms.opacity.value=ye,e.clearTarget(O,!1,!0,!1),f.render(e,O,null)}else e.setClearColor(ve,ye),e.clearTarget(O,!0,!0,!1);Ne&&Ne.clearTarget(e);for(var v=0;v<ee.length;v++)e.setClearColor(de,1),e.clearTarget(ee[v],!0,!1,!1)}if(je(X)){l&&(e.setClearColor(pe,0),e.clearTarget(T,!0,!1,!1));var y=n.near,b=n.far;g.uniforms.cameraNear.value=y,g.uniforms.cameraFar.value=b,_.uniforms.cameraNear.value=y,_.uniforms.cameraInvNearFar.value=1/(y-b);var x=n.projectionMatrix.elements;n.isPerspective?g.uniforms.projInfo.value.set(-2/(O.width*x[0]),-2/(O.height*x[5]),(1-x[8])/x[0],(1+x[9])/x[5]):g.uniforms.projInfo.value.set(-2/(O.width*x[0]),-2/(O.height*x[5]),(1-x[12])/x[0],(1-x[13])/x[5]),E.uniforms.projInfo.value.copy(g.uniforms.projInfo.value);var w=n.isPerspective?0:1;g.uniforms.isOrtho.value=w,E.uniforms.isOrtho.value=w;if(g.uniforms.projScale.value=O.height*x[5]*.125,E.uniforms.worldMatrix_mainPass.value=n.matrixWorld,M.isPostProcShaded()){var S=Autodesk.Viewing.Navigation.prototype.fov2fl(n.fov);M.updateUniformValue("focalLength",S),M.updateUniformValue("unitScale",ae),M.updateUniformValue("worldMatrix_mainPass",n.matrixWorld,!0),M.updateUniformValue("cameraPos",n.position,!0),M.updateUniformValue("cameraNear",y),M.updateUniformValue("cameraFar",b),M.updateUniformValue("projInfo",g.uniforms.projInfo.value,!0),M.updateUniformValue("isOrtho",w)}}Ie.sao||(E.uniforms.useAO.value=0),this.renderScenePart(t,!0,!0,!0,!0)},this.renderScenePart=function(i,r,o,a,s){void 0!==i.skipColorTarget&&(r=!i.skipColorTarget),void 0!==i.skipDepthTarget&&(o=!i.skipDepthTarget),void 0!==i.skipIdTarget&&(a=!i.skipIdTarget),r&&Ie.renderEdges&&(i.edgeMaterial=n);var d=o&&je(X),p=O,f=T,m=!1;Ne&&(p=Ne.chooseColorTarget(i,p),m=(f=Ne.getRenderSao(i)?T:null)&&T.shareDepthFrom!==p),A=!1,L={};var g,v,y=s?u:void 0;i.fog=h,we&&Se?(g=je(Y)&&a&&d?[p,f].concat(ee):d?[p,f]:je(Y)&&a?[p].concat(ee):p,e.render(i,c,g,!1,y)):Se?(g=je(Y)&&a?[p].concat(ee):p,e.render(i,c,g,!1,y),d&&!i.sortObjects&&f&&(v=i.overrideMaterial,i.overrideMaterial=t,t.depthWrite!==m&&Ge(t,m),e.render(i,c,f,!1),i.overrideMaterial=v)):(r?(g=p,e.render(i,c,p,!1,y)):m=!0,je(Y)&&a&&(l?(v=i.overrideMaterial,i.overrideMaterial=l,e.render(i,c,ee[0],!1),i.overrideMaterial=v):(e.setProgramPrefix(1,"#define ID_COLOR","#define ID_COLOR"),e.render(i,c,ee[0],!1),e.setProgramPrefix(0,"","")),m=!1),d&&!i.sortObjects&&f&&(v=i.overrideMaterial,t.depthWrite!==m&&Ge(t,m),i.overrideMaterial=t,e.render(i,c,f,!1),i.overrideMaterial=v)),i.edgeMaterial=void 0},this.clearAllOverlays=function(){e.clearTarget(N,!0,!1,!1)},this.renderOverlays=function(t,i,r){var o=0;Ee=!0;for(var s=!1,l=!1,u=!1,h=Object.values(t).sort((function(e,t){return e.needSeparateDepth==t.needSeparateDepth?0:1==e.needSeparateDepth?1:1==t.needSeparateDepth?-1:void 0})),d=0;d<h.length;++d){var p=h[d],f=p.scene,m=p.camera?p.camera:c,g=p.externalRenderer?p.externalRenderer():e,v=p.externalOverlayTarget?p.externalOverlayTarget(N):N;if(f.children.length){if(g.setRenderTarget(v),o||(o=1,r||(g.setClearColor(pe,0),g.clear(!0,!1,!1))),p.materialPre&&(f.overrideMaterial=p.materialPre),1==p.needSeparateDepth&&0==l?(v.shareDepthFrom=null,g.clearTarget(v,!1,!0,!1),l=!0):(Ie.copyDepth&&!u&&(v.shareDepthFrom=null,g.setRenderTarget(v),u=e.copyDepthBuffer(O,v)),!1===u&&(v.shareDepthFrom=O)),Se&&p.needIdTarget){te||((te=qe(v.width,v.height)).name="overlayId"),0==s&&(g.clearTarget(te,!0,!1,!1),s=!0);var y=[v];p.needIdTarget&&y.push(te),g.render(f,m,y,!1,i)}else g.render(f,m,v,!1,i),p.needIdTarget&&(te||((te=qe(v.width,v.height)).name="overlayId"),g.setProgramPrefix(1,"#define ID_COLOR","#define ID_COLOR"),g.render(f,m,te,!1,i),g.setProgramPrefix(0,"",""));p.materialPost&&(xe=!0,g.context.depthFunc(g.context.GREATER),p.materialPost.depthFunc=a.GreaterDepth,Ie.renderEdges&&(n.depthWrite=!1,n.depthTest=!1,f.overrideMaterial=n,g.render(f,m,v,!1)),f.overrideMaterial=p.materialPost,g.render(f,m,v,!1,i),g.context.depthFunc(g.context.LEQUAL),p.materialPost.depthFunc=a.LessEqualDepth,xe=!1),Ie.renderEdges&&p.materialPre&&(n.depthWrite=!1,n.depthTest=!0,f.overrideMaterial=n,g.render(f,m,v,!1)),f.overrideMaterial=null}}Ee=!1,n.depthWrite=!0,n.depthTest=!0,E.uniforms.useOverlay.value=o,o&&(E.uniforms.useOverlayAlpha.value=be)},this.computeSSAO=function(t){if(!t&&Ie.sao){if(!A){if(I&&I.length){var n=I[0];_.uniforms.resolution.value.set(1/n.width,1/n.height),_.render(e,n,T);for(var i=1;i<I.length;i++){var r=I[i];v.uniforms.resolution.value.set(1/r.width,1/r.height),v.render(e,r,n),n=r}}g.render(e,B,O),m.uniforms.axis.value.set(1,0),m.render(e,k,B),m.uniforms.axis.value.set(0,1),m.render(e,B,k),A=!0}E.uniforms.useAO.value=1}else E.uniforms.useAO.value=0},this.getFinalTarget=function(){return ke||null},this.presentBuffer=function(t){if(e){var n=this.getFinalTarget();if(!(E.uniforms.useAO.value||E.uniforms.useOverlay.value||Ne||0!==Pe&&-1!==Pe||0!==Le&&-1!==Le))if(Ie.antialias)if(t)x.render(e,k,O),t.render(e,n,k);else if(M.isPostProcShaded()){var i=M.render(e,k,O,V);w.render(e,U,i),x.render(e,n,U)}else x.render(e,n,O);else if(t)t.render(e,n,O);else if(M.isPostProcShaded()){var r=M.render(e,k,O,V);w.render(e,n,r)}else w.render(e,n,O);else if(Ie.antialias)if(t)E.render(e,k,O),x.render(e,V,k),t.render(e,n,V);else if(M.isPostProcShaded()){var o=Xe();w.render(e,U,o),x.render(e,n,U)}else E.render(e,k,O),x.render(e,n,k);else if(t)E.render(e,k,O),t.render(e,n,k);else if(M.isPostProcShaded()){o=Xe();w.render(e,n,o)}else E.render(e,n,O)}},this.composeFinalFrame=function(e,t){this.computeSSAO(e),t||this.presentBuffer()},this.cleanup=function(){if(e&&e.setRenderTarget(null),O&&(O.dispose(),O=null),T&&(T.dispose(),T=null),N&&(N.dispose(),N=null),te&&(te.dispose(),te=null),Ne&&Ne.disposeTargets(),k&&(k.dispose(),k=null),B&&(B.dispose(),B=null),V&&(V.dispose(),V=null),I){for(var t=0;t<I.length;t++)I[t].dispose();I=[]}for(t=0;t<ee.length;t++)ee[t]&&ee[t].dispose();ee=[],L={},ce={},ue={}},this.setSize=function(t,n,r,o){var s,l;if(null===(s=this._renderer)||void 0===s||null===(l=s.xr)||void 0===l?void 0:l.isPresenting)console.warn("RenderContext: Can't change size while XR device is presenting.");else if(C=t,P=n,Ie.logicalWidth=t,Ie.logicalHeight=n,0===t&&0===n||!e)this.cleanup();else{var c,u=0|t*e.getPixelRatio(),h=0|n*e.getPixelRatio();Ie.deviceWidth=u,Ie.deviceHeight=h,o||(le?e.setViewport(0,0,t,n):e.setSize(t,n));var d=u,p=h;(Ie.useSSAA||M.isPostProcShaded()&&!_e&&e.getPixelRatio()<=1&&M.postProcessEdgesOn())&&(u*=2,h*=2);var f=1/u,v=1/h;if(!r&&O&&O.width==u&&O.height==h||(i.logger.log("Reallocating render targets."),this.cleanup(),(O=new a.WebGLRenderTarget(u,h,{minFilter:a.LinearFilter,magFilter:a.LinearFilter,format:a.RGBAFormat,type:Ie.useHdrTarget?a.FloatType:a.UnsignedByteType,stencilBuffer:!1})).texture.generateMipmaps=!1,O.name="colorTarget",(N=new a.WebGLRenderTarget(u,h,{minFilter:a.NearestFilter,magFilter:a.NearestFilter,format:a.RGBAFormat,stencilBuffer:!1})).texture.generateMipmaps=!1,N.name="overlayTarget",N.shareDepthFrom=O,T=null,k=null,U=null,B=null,V=null,I=[]),Ne&&Ne.updateTargets(u,h,r,Ie.useHdrTarget),je(Z)&&(!r&&k&&k.width==u&&k.height==h||((k=new a.WebGLRenderTarget(u,h,{minFilter:a.LinearFilter,magFilter:a.LinearFilter,format:a.RGBAFormat,stencilBuffer:!1,depthBuffer:!1})).texture.generateMipmaps=!1,k.name="postTarget1")),!B&&je(Q)&&((B=k.clone()).name="SSAO target"),!V&&je(J)&&((V=k.clone()).name="post target 2"),!U&&je($)&&((U=new a.WebGLRenderTarget(d,p,{minFilter:a.LinearFilter,magFilter:a.LinearFilter,format:a.RGBAFormat,stencilBuffer:!1,depthBuffer:!1})).texture.generateMipmaps=!1,U.name="postTargetNormal"),je(X)){if(r||!T||T.width!=u||T.height!=h){T=Fe(u,h,Ae,Me,O),I=[];for(var y=0;y<5;y++){var b=0|u/(2<<y),_=0|h/(2<<y),w=null;b>=1&&_>=1&&((w=new a.WebGLRenderTarget(b,_,{minFilter:a.NearestFilter,magFilter:a.NearestFilter,format:a.RGBAFormat,depthBuffer:!1,stencilBuffer:!1})).texture.generateMipmaps=!1,I.push(w),w.name="depthTarget_mipmap "+y),g.uniforms["tDepth_mip"+(y+1)].value=w}we=e.verifyMRTWorks([O,T])}g.uniforms.size.value.set(u,h),g.uniforms.resolution.value.set(f,v),g.uniforms.tDepth.value=T,m.uniforms.size.value.set(u,h),m.uniforms.resolution.value.set(f,v),M.updateUniformValue("tDepth",T),E.uniforms.tDepth.value=T}if(je(Y)){if(r||!ee[0]||ee[0].width!=u||ee[0].height!=h){for(c=0;c<ee.length;c++)ee[c]&&ee[c].dispose();for(ee=[],c=0;c<Ie.numIdTargets;c++){var S=qe(u,h);S.name="id "+c,ee.push(S)}(Se=e.verifyMRTWorks([O].concat(ee)))||i.logger.warn("ID buffer requested, but MRT is not supported. Some features will not work.")}M.updateUniformValue("tID",ee[0])}else if(ee[0]){for(c=0;c<ee.length;c++)ee[c].dispose(),ee[c]=null;ee.length=0}x.uniforms.uResolution.value.set(f,v),M.changeResolution(f,v),E.uniforms.tOverlay.value=N,E.uniforms.tAO.value=B,E.uniforms.useAO.value=Ie.sao?1:0,E.uniforms.resolution.value.set(f,v),E.uniforms.tID.value=ee[0]||null,E.uniforms.tID2.value=ee[1]||null,Ne&&Ne.updateBlendPass()}},this.getMaxAnisotropy=function(){return e?e.getMaxAnisotropy():0},this.mrtFlags=function(){return{mrtNormals:we&&je(X),mrtIdBuffer:Se&&je(Y)?Ie.numIdTargets:void 0}},this.setIdTargetCount=function(e){if(!(e>2||e<1)&&e!==Ie.numIdTargets&&(Ie.numIdTargets=e,0!==ee.length&&2===e&&1===ee.length)){var t=qe(ee[0].width,ee[0].height);return t.name="id "+ee.length,ee.push(t),E.uniforms.tID2.value=t,E.material.defines.USE_MODEL_ID="1",E.material.needsUpdate=!0,!0}},this.getAntialiasing=function(){return Ie.antialias},this.initPostPipeline=function(e,t){Ie.sao=e&&!o.isIE11&&Te,Ie.antialias=t&&!o.isIE11,Ie.haveTwoSided&&ze((function(e){e.side=a.DoubleSide})),ze((function(e){e.needsUpdate=!0})),g.material.needsUpdate=!0,m.material.needsUpdate=!0,_.material.needsUpdate=!0,v.material.needsUpdate=!0,x.material.needsUpdate=!0,M.setMaterialNeedsUpdate(),E.material.needsUpdate=!0,f.material.needsUpdate=!0,w.material.needsUpdate=!0,this.setSize(C,P)},this.setClearColors=function(e,t){(ve=t?e.equals(t)||_e?new a.Color(.5*(e.x+t.x),.5*(e.y+t.y),.5*(e.z+t.z)):void 0:e.clone())||(f.uniforms.color1.value.copy(e),f.uniforms.color2.value.copy(t))},this.useOverlayAlpha=function(e){be=e},this.setClearAlpha=function(e){ye=e},this.setAOEnabled=function(e){Ie.sao=e&&Te,Oe.sao=Ie.sao,this.setSize(C,P,!1,!0)},this.setAOOptions=function(e,t,n){void 0!==e&&(g.uniforms.radius.value=e,g.uniforms.bias.value=(0,o.isMobileDevice)()?.1:.01,m.uniforms.radius.value=e),void 0!==t&&(g.uniforms.intensity.value=t),E.uniforms.aoOpacity.value=void 0!==n?n:1,A=!1},this.getAOEnabled=function(){return Ie.sao},this.getAORadius=function(){return g.uniforms.radius.value},this.getAOIntensity=function(){return g.uniforms.intensity.value},this.setCubeMap=function(e){f.material.envMap=e,e||this.toggleEnvMapBackground(!1),e&&Ie.envMapBg&&(f.uniforms.envMapBackground.value=!0)},this.setBackgroundTexture=function(e){var t=f.material.useBackgroundTexture;f.uniforms.backgroundTexture.value=e,f.material.useBackgroundTexture=!!e,!!e!==t&&(f.material.needsUpdate=!0)},this.getCubeMap=function(){return f.material.envMap},this.setEnvRotation=function(e){re=e,f.material.envRotationSin=Math.sin(e),f.material.envRotationCos=Math.cos(e)},this.getEnvRotation=function(){return re},this.setEnvExposure=function(e){var t=f.material.envMapExposure,n=Math.pow(2,e);f.uniforms.envMapExposure.value=n,f.material.envMapExposure=n,n!==t&&(f.material.needsUpdate=!0),ne=e},this.setTonemapExposureBias=function(e){ie=e,f.uniforms.exposureBias.value=Math.pow(2,e)},this.getExposureBias=function(){return ie},this.setCamera=function(e){c=e},this.setTonemapMethod=function(t){var n=oe;oe=t,e.gammaInput=0!==t,f.material.tonemapOutput=oe,t!==n&&(f.material.needsUpdate=!0)},this.getToneMapMethod=function(){return oe},this.toggleTwoSided=function(e){Ie.haveTwoSided!=e&&t&&ze((function(t){t.side=e?a.DoubleSide:a.FrontSide,t.needsUpdate=!0})),Ie.haveTwoSided=e},this.toggleEdges=function(e){Ie.renderEdges=e,Oe.renderEdges=e},this.getRenderEdges=function(){return Ie.renderEdges},this.getRenderEdges=function(){return Ie.renderEdges},this.toggleEnvMapBackground=function(e){Ie.envMapBg=e,f.uniforms.envMapBackground.value=e&&!!f.material.envMap},this.enter2DMode=function(e,t){l=e,Oe.sao=Ie.sao,Oe.antialias=Ie.antialias,Oe.idbuffer=Ie.idbuffer,Oe.renderEdges=Ie.renderEdges,Oe.useIdBufferSelection=Ie.useIdBufferSelection,t&&(Oe.selectionColor=Ie.selectionColor,this.setSelectionColor(t)),Ie.idbuffer=!0,Ie.renderEdges=!1,E.material.defines.IS_2D="",Ve(Ie.idbuffer),this.initPostPipeline(!1,!1)},this.exit2DMode=function(){l=null,Ie.idbuffer=Oe.idbuffer,Ie.renderEdges=Oe.renderEdges,Oe.selectionColor&&this.setSelectionColor(Oe.selectionColor),delete E.material.defines.IS_2D,Ve(Oe.idbuffer),this.initPostPipeline(Oe.sao,Oe.antialias)},this.idAtPixel=function(e,t,n,i){return this.idAtPixels(e,t,1,n,i)},this.idAtPixels=function(t,n,i,r,o){if(o&&o[0]||(o=ee),!o[0])return 0;i%2==0&&(i+=1);var a=.5*(t+1)*o[0].width-.5*(i-1),s=.5*(n+1)*o[0].height-.5*(i-1);if(L[i]&&a===L[i][4]&&s===L[i][5]&&L[i][6]==o[0].name)return Ye(L[i],r),L[i][0];var l=4*i*i;ce[l]||(ce[l]=new Uint8Array(l));var c,u=ce[l];return e.readRenderTargetPixels(o[0],a,s,i,i,u),o[1]&&(ue[l]||(ue[l]=new Uint8Array(l)),c=ue[l],e.readRenderTargetPixels(o[1],a,s,i,i,c)),function(e,t,n,i,r,o,a){var s;a=a||ee;var l=0,c=0,u=0,h=-1;L[n]=[-1,-1,null,null,e,t,a[0].name];for(var d=0;d<n*n;d++){var p=l+(n-1)/2,f=c+(n-1)/2;if(p>=0&&p<=n&&f>=0&&f<=n){var m=p+f*n;if(s=(s=i[4*m+2]<<16|i[4*m+1]<<8|i[4*m])<<8>>8,L[n][0]=s,r){var g=r[4*m+1]<<8|r[4*m];L[n][1]=g<<16>>16}if(L[n][2]=2*(e+p)/a[0].width-1,L[n][3]=2*(t+f)/a[0].height-1,-1!==s)break}if(l==c||l<0&&l==-c||l>0&&l==1-c){var v=u;u=-h,h=v}l+=u,c+=h}return Ye(L[n],o),s}(a,s,i,u,c,r,o)},this.idsAtPixelsBox=function(t,n,i,r,o,a){if((a=a||ee)[0]){var s=i*a[0].width,l=r*a[0].height,c=0|.5*(t+1)*a[0].width,u=0|.5*(n+1)*a[0].height,h=new Uint8Array(4*s*l);e.readRenderTargetPixels(a[0],c,u,s,l,h);var d=void 0;o&&a[1]&&(d=new Uint8Array(4*s*l),e.readRenderTargetPixels(a[1],c,u,s,l,d));for(var p={},f=0;f<h.length;f+=4){var m=h[4*f+2]<<16|h[4*f+1]<<8|h[4*f];if((m=m<<8>>8)>0){var g=0;d&&(g=(g=d[4*f+1]<<8|d[4*f])<<16>>16);var v=m+"-"+g;p[v]||(p[v]=!0,o.push([m,g]))}}}},this.readbackTargetId=function(){if(!ee[0])return null;var t=new Uint8Array(4*ee[0].width*ee[0].height);return e.readRenderTargetPixels(ee[0],0,0,ee[0].width,ee[0].height,t),{buffer:t,width:ee[0].width,height:ee[0].height}},this.rolloverObjectViewport=function(e,t){he[1]=0;var n=this.idAtPixel(e,t,he);return this.rolloverObjectId(n,null,he[1])},this.rolloverObjectId=function(e,t,n){return Ze(e,n,!1)},this.getRollOverDbId=function(){return Pe},this.getRollOverModelId=function(){return Le},this.rollOverModelId=function(e){return Ze(1,e,!0)},this.setRollOverHighlightColor=function(e){e?E.uniforms.highlightColor.value.copy(e):E.uniforms.highlightColor.value.setRGB(1,1,1)},this.setDbIdForEdgeDetection=function(e,t){E.uniforms.edgeObjIDv4.value.set((255&e)/255,(e>>8&255)/255,(e>>16&255)/255,(e>>24&255)/255),E.uniforms.edgeModelIDv2.value.set((255&t)/255,(t>>8&255)/255)},this.setSpatialFilterForRollOver=function(e){if(!e||this.spatialFilterForRollOverSupported()){var t="SPATIAL_FILTER";E.material.defines[t]!==e&&(e&&""!==e?E.material.defines[t]=e:delete E.material.defines[t],E.material.needsUpdate=!0,E.uniforms.highlightIntensity.value=0,Ce=performance.now())}else i.logger.warn("Spatial filter for mouse-over can only be used with depth target")},this.spatialFilterForRollOverSupported=function(){return je(X)},this.setEdgeColor=function(e){fe.copy(e)},this.setSelectionColor=function(e){var t=new a.Color(e);t.r=Math.pow(t.r,2),t.g=Math.pow(t.g,2),t.b=Math.pow(t.b,2),E.uniforms.selectionColor.value.set(t),E.material.needsUpdate=!0,Ie.selectionColor=e},this.setUnitScale=function(e){ae=e},this.getUnitScale=function(){return ae},this.getBlendPass=function(){return E},this.getClearPass=function(){return f},this.getColorTarget=function(){return O},this.getIDTargets=function(){return ee},this.getDepthTarget=function(){return T},this.getIdTarget=function(){return ee[0]},this.getOverlayIdTarget=function(){return te},this.getDepthMaterial=function(){return t},this.getPostTarget=function(){return k},this.getEdgeMaterial=function(){return n},this.setCrossFade=function(e){Ne=e},this.getCrossFade=function(){return Ne},this.setOffscreenTarget=function(e){ke=e},this.getOffscreenTarget=function(){return ke},this.getNamedTarget=function(e){switch(e){case"color":return O;case"overlay":return N;case"id":return ee[0];case"post1":return k;case"post2":return V;case"postdisplay":return U;case"ssao":return B;case"depth":return T}return null},this.getCurrentFramebuffer=function(){return e.getCurrentFramebuffer()},this.getConfig=function(){return{renderEdges:Ie.renderEdges,envMapBackground:Ie.envMapBg,envMap:f.material.envMap,envExposure:ne,toneMapExposureBias:ie,envRotation:this.getEnvRotation(),tonemapMethod:oe,clearColor:ve&&ve.clone(),clearColorTop:!ve&&f.uniforms.color1.value.clone(),clearColorBottom:!ve&&f.uniforms.color2.value.clone(),clearAlpha:ye,useOverlayAlpha:be,aoEnabled:this.getAOEnabled(),aoRadius:this.getAORadius(),aoIntensity:this.getAOIntensity(),twoSided:Ie.haveTwoSided,edgeColor:fe.clone(),unitScale:this.getUnitScale(),is2D:!!E.material.defines.IS_2D,antialias:this.getAntialiasing(),idMaterial:l,selectionColor:Ie.selectionColor}},this.applyConfig=function(e){this.toggleEdges(e.renderEdges),this.toggleEnvMapBackground(e.envMapBackground),this.setCubeMap(e.envMap),this.setEnvExposure(e.envExposure),this.setTonemapExposureBias(e.toneMapExposureBias),this.setEnvRotation(e.envRotation),this.setTonemapMethod(e.tonemapMethod),this.toggleTwoSided(e.twoSided),this.setEdgeColor(e.edgeColor),this.setUnitScale(e.unitScale),e.clearColor?this.setClearColors(e.clearColor):this.setClearColors(e.clearColorTop,e.clearColorBottom),this.setClearAlpha(e.clearAlpha),this.useOverlayAlpha(e.useOverlayAlpha);var t=!!E.material.defines.IS_2D;e.is2D&&!t?this.enter2DMode(e.idMaterial,e.selectionColor):!e.is2D&&t&&(this.setSelectionColor(e.selectionColor),this.exit2DMode());var n=e.aoEnabled!=this.getAOEnabled(),i=e.antialias!=this.getAntialiasing();(n||i)&&this.initPostPipeline(e.aoEnabled,e.antialias)},this.targetToCanvas=function(t){var n=t.width,i=t.height,r=new Uint8Array(n*i*4);e.readRenderTargetPixels(t,0,0,n,i,r);var a=j.createElement("canvas");a.width=n,a.height=i;var s,l=a.getContext("2d"),c=new Uint8ClampedArray(r);return o.isIE11?(s=l.createImageData(n,i)).data.set(c):s=new ImageData(c,n,i),l.putImageData(s,0,0),l.globalCompositeOperation="copy",l.translate(0,i),l.scale(1,-1),l.drawImage(a,0,0,n,i),l.globalCompositeOperation="source-over",{canvas:a,ctx:l}}}},66199:(e,t,n)=>{"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.r(t),n.d(t,{RenderContextPostProcessExtension:()=>a,RenderContextPostProcessManager:()=>s});var a=function(){function e(t,n){i(this,e),this.viewer=n,this.renderContext=t,this.postProcPass=null,this.postProcShaded=!1,this.setGlobalManager(n.globalManager)}return o(e,[{key:"load",value:function(){}},{key:"unload",value:function(){this.viewer=null,this.renderContext=null,this.postProcPass=null}},{key:"enable",value:function(){this.setPostProcShaded(!0);var e=this.renderContext.settings;this.renderContext.initPostPipeline(e.sao,e.antialias),this.viewer.impl.fireRenderOptionChanged(),this.viewer.impl.invalidate(!0,!0,!0)}},{key:"disable",value:function(){this.setPostProcShaded(!1),this.viewer.impl.invalidate(!1,!1,!0)}},{key:"shouldRenderAfterOverlays",value:function(){return!1}},{key:"render",value:function(e,t,n,i){var r=void 0===i||i===this.shouldRenderAfterOverlays();return!(!this.isPostProcShaded()||!r)&&(this.postProcPass.render(e,t,n),!0)}},{key:"updateUniformValue",value:function(e,t,n){this.postProcPass.uniforms[e]&&(n?this.postProcPass.uniforms[e].value.copy(t):this.postProcPass.uniforms[e].value=t,this.viewer.impl.invalidate(!1,!1,!0))}},{key:"updateDefineValue",value:function(e,t){this.postProcPass.material.defines[e]!==t&&(null!==t?this.postProcPass.material.defines[e]=t:delete this.postProcPass.material.defines[e],this.setMaterialNeedsUpdate())}},{key:"getUniformValue",value:function(e){return this.postProcPass.uniforms[e].value}},{key:"getDefineValue",value:function(e){return this.postProcPass.material.defines[e]}},{key:"changeResolution",value:function(e,t){this.postProcPass.uniforms.resolution.value.set(e,t)}},{key:"setMaterialNeedsUpdate",value:function(){this.postProcPass.material.needsUpdate=!0,this.viewer.impl.invalidate(!1,!1,!0)}},{key:"postProcessEdgesOn",value:function(){return!1}},{key:"setPostProcShaded",value:function(e){this.postProcShaded=e}},{key:"isPostProcShaded",value:function(){return this.postProcShaded}},{key:"getOrder",value:function(){return 0}}]),e}(),s=function(){function e(){i(this,e),this.rcExtensions=[]}return o(e,[{key:"registerPostProcessingExtension",value:function(e){this.rcExtensions.push(e),this.rcExtensions.sort((function(e,t){return t.getOrder()-e.getOrder()}))}},{key:"removePostProcessingExtension",value:function(e){var t=this.rcExtensions.indexOf(e);-1!==t&&(e.unload(),this.rcExtensions.splice(t,1))}},{key:"render",value:function(e,t,n,i,r){for(var o=0;o<this.rcExtensions.length;o++){if(this.rcExtensions[o].render(e,t,n,r)){n=t;var a=t;t=i,i=a}}return n}},{key:"updateUniformValue",value:function(e,t,n){for(var i=0;i<this.rcExtensions.length;i++)this.rcExtensions[i].updateUniformValue(e,t,n)}},{key:"changeResolution",value:function(e,t){for(var n=0;n<this.rcExtensions.length;n++)this.rcExtensions[n].changeResolution(e,t)}},{key:"setMaterialNeedsUpdate",value:function(){for(var e=0;e<this.rcExtensions.length;e++)this.rcExtensions[e].setMaterialNeedsUpdate()}},{key:"postProcessEdgesOn",value:function(){return this.rcExtensions.some((function(e){return e.postProcessEdgesOn()}))}},{key:"isPostProcShaded",value:function(){return this.rcExtensions.some((function(e){return e.isPostProcShaded()}))}}]),e}()},97339:(e,t,n)=>{"use strict";n.r(t),n.d(t,{SAOShader:()=>c});var i=n(16453),r=n(12990),o=n(66209),a=n.n(o),s=n(6890),l=n.n(s),c={uniforms:i.UniformsUtils.merge([r.ShaderChunks.DepthTextureUniforms,{size:{type:"v2",value:new i.Vector2(512,512)},resolution:{type:"v2",value:new i.Vector2(1/512,1/512)},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},radius:{type:"f",value:12},bias:{type:"f",value:.1},projScale:{type:"f",value:500},intensity:{type:"f",value:1},tDepth_mip1:{type:"t",value:null},tDepth_mip2:{type:"t",value:null},tDepth_mip3:{type:"t",value:null},tDepth_mip4:{type:"t",value:null},tDepth_mip5:{type:"t",value:null}}]),vertexShader:a(),fragmentShader:l()}},12990:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CutPlanesUniforms:()=>me,IdUniforms:()=>ge,ThemingUniform:()=>ve,ShadowMapCommonUniforms:()=>ye,ShadowMapUniforms:()=>be,PointSizeUniforms:()=>_e,WideLinesUniforms:()=>xe,DepthTextureUniforms:()=>Ee,DepthTextureTestUniforms:()=>we,resolve:()=>Ce,PackDepthShaderChunk:()=>Pe,TonemapShaderChunk:()=>Le,OrderedDitheringShaderChunk:()=>Re,CutPlanesShaderChunk:()=>De,PackNormalsShaderChunk:()=>Ie,HatchPatternShaderChunk:()=>Oe,EnvSamplingShaderChunk:()=>Ne,IdVertexDeclaration:()=>ke,IdVertexShaderChunk:()=>Fe,IdFragmentDeclaration:()=>Ue,IdOutputShaderChunk:()=>Be,FinalOutputShaderChunk:()=>Ve,ThemingFragmentDeclaration:()=>Ge,ThemingFragmentShaderChunk:()=>ze,InstancingVertexDeclaration:()=>He,ShadowMapDeclareCommonUniforms:()=>We,ShadowMapVertexDeclaration:()=>je,ShadowMapVertexShaderChunk:()=>qe,ShadowMapFragmentDeclaration:()=>Xe,PointSizeDeclaration:()=>Ye,PointSizeShaderChunk:()=>Ke,ShaderChunks:()=>Ze});var i=n(16453),r=n(23300),o=n.n(r),a=n(25334),s=n.n(a),l=n(73985),c=n.n(l),u=n(52035),h=n.n(u),d=n(32263),p=n.n(d),f=n(15931),m=n.n(f),g=n(52698),v=n.n(g),y=n(7246),b=n.n(y),_=n(7959),x=n.n(_),E=n(61539),w=n.n(E),S=n(74610),A=n.n(S),M=n(46223),T=n.n(M),C=n(53833),P=n.n(C),L=n(94005),R=n.n(L),D=n(25759),I=n.n(D),O=n(58121),N=n.n(O),k=n(4949),F=n.n(k),U=n(11458),B=n.n(U),V=n(36238),G=n.n(V),z=n(65080),H=n.n(z),W=n(72448),j=n.n(W),q=n(81456),X=n.n(q),Y=n(65355),K=n.n(Y),Z=n(58998),J=n.n(Z),Q=n(72438),$=n.n(Q),ee=n(14227),te=n.n(ee),ne=n(16006),ie=n.n(ne),re=n(26649),oe=n.n(re),ae=n(13458),se=n.n(ae),le=n(16017),ce=n.n(le),ue=n(68643),he=n.n(ue);function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(Object(n),!0).forEach((function(t){fe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var me={cutplanes:{type:"v4v",value:[]},hatchParams:{type:"v2",value:new i.Vector2(1,10)},hatchTintColor:{type:"c",value:new i.Color(16777215)},hatchTintIntensity:{type:"f",value:1}},ge={dbId:{type:"v3",value:new i.Vector3(0,0,0)},modelId:{type:"v3",value:new i.Vector3(0,0,0)}},ve={themingColor:{type:"v4",value:new i.Vector4(0,0,0,0)}},ye={shadowESMConstant:{type:"f",value:0}},be=i.UniformsUtils.merge([{shadowMap:{type:"t",value:null},shadowMapSize:{type:"v2",value:new i.Vector2(0,0)},shadowBias:{type:"f",value:0},shadowDarkness:{type:"f",value:0},shadowMatrix:{type:"m4",value:new i.Matrix4},shadowLightDir:{type:"v3",value:new i.Vector3}},ye]),_e={point_size:{type:"f",value:1}},xe={view_size:{type:"v2",value:new i.Vector2(640,480)}},Ee={tDepth:{type:"t",value:null},projInfo:{type:"v4",value:new i.Vector4},isOrtho:{type:"f",value:0},worldMatrix_mainPass:{type:"m4",value:new i.Matrix4}},we={tDepthTest:{type:"t",value:null},tDepthResolution:{type:"v2",value:new i.Vector2(1/1024,1/1024)}},Se={};for(var Ae in i.ShaderChunk)Se[Ae]=i.ShaderChunk[Ae];Se.pack_depth=o(),Se.depth_texture=s(),Se.tonemap=c(),Se.ordered_dither=h(),Se.cutplanes=p(),Se.pack_normals=m(),Se.hatch_pattern=v(),Se.env_sample=b(),Se.id_decl_vert=x(),Se.id_vert=w(),Se.id_decl_frag=A(),Se.id_frag=T(),Se.final_frag=P(),Se.theming_decl_frag=R(),Se.theming_frag=I(),Se.instancing_decl_vert=N(),Se.shadowmap_decl_common=F(),Se.shadowmap_decl_vert=B(),Se.shadowmap_vert=G(),Se.shadowmap_decl_frag=H(),Se.float3_average=j(),Se.line_decl_common=X(),Se.prism_wood=K(),Se.prism_glazing=J(),Se.prism_transparency=$(),Se.normal_map=te(),Se.decl_point_size=ie(),Se.point_size=oe(),Se.wide_lines_decl=se(),Se.wide_lines_vert=ce(),Se.hsv=he();var Me={},Te={};for(Ae in Me)Te[Ae]=new RegExp("#"+Ae+" *<([\\w\\d., ]*)>","g");var Ce=function e(t){for(var n in Me){var i=Te[n];t=t.replace(i,(function(e,t){var i=t.split(",").map((function(e){return e.trim()}));return Me[n].apply(null,i)}))}return t.replace(/#include *<([\w\d.]+)>/g,(function(t,n){if(!Se[n])throw new Error("Cannot resolve #include<"+n+">");return e(Se[n])}))},Pe=Se.pack_depth,Le=Se.tonemap,Re=Se.ordered_dither,De=Se.cutplanes,Ie=Se.pack_normals,Oe=Se.hatch_pattern,Ne=Se.env_sample,ke=Se.id_decl_vert,Fe=Se.id_vert,Ue=Se.id_decl_frag,Be=Se.id_frag,Ve=Se.final_frag,Ge=Se.theming_decl_frag,ze=Se.theming_frag,He=Se.instancing_decl_vert,We=Se.shadowmap_decl_common,je=Se.shadowmap_decl_vert,qe=Se.shadowmap_vert,Xe=Se.shadowmap_decl_frag,Ye=Se.decl_point_size,Ke=Se.point_size,Ze=pe(pe({IdUniforms:ge,ThemingUniform:ve,CutPlanesUniforms:me,ShadowMapCommonUniforms:ye,ShadowMapUniforms:be,PointSizeUniforms:_e,WideLinesUniforms:xe,DepthTextureUniforms:Ee,DepthTextureTestUniforms:we,PackDepthShaderChunk:Pe,TonemapShaderChunk:Le,OrderedDitheringShaderChunk:Re,CutPlanesShaderChunk:De,PackNormalsShaderChunk:Ie,HatchPatternShaderChunk:Oe,EnvSamplingShaderChunk:Ne,IdVertexDeclaration:ke,IdVertexShaderChunk:Fe,IdFragmentDeclaration:Ue,IdOutputShaderChunk:Be,FinalOutputShaderChunk:Ve,ThemingFragmentDeclaration:Ge,ThemingFragmentShaderChunk:ze,InstancingVertexDeclaration:He,ShadowMapDeclareCommonUniforms:We,ShadowMapVertexDeclaration:je,ShadowMapVertexShaderChunk:qe,ShadowMapFragmentDeclaration:Xe,PointSizeDeclaration:Ye,PointSizeShaderChunk:Ke},Se),{},{resolve:Ce})},85994:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ShaderPass:()=>o});var i=n(14705),r=n(16453),o=function(e,t){this.textureID=void 0!==t?t:"tDiffuse",this.material=(0,i.createShaderMaterial)(e),this.uniforms=this.material.uniforms,this.renderToScreen=!1,this.enabled=!0,this.clear=!1,this.camera=new r.OrthographicCamera(-1,1,1,-1,0,1),this.camera.disableXr=!0;var n=new r.BufferGeometry,o=new Float32Array(9);o[0]=-1,o[1]=-1,o[2]=0,o[3]=3,o[4]=-1,o[5]=0,o[6]=-1,o[7]=3,o[8]=0;var a=new Float32Array(6);a[0]=0,a[1]=0,a[2]=2,a[3]=0,a[4]=0,a[5]=2;var s=new Float32Array(9);s[0]=0,s[1]=0,s[2]=1,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=1,n.setAttribute("position",new r.BufferAttribute(o,3)),n.setAttribute("normal",new r.BufferAttribute(s,3)),n.setAttribute("uv",new r.BufferAttribute(a,2)),this.quad=new r.Mesh(n,this.material),this.scene=new r.Scene,this.scene.add(this.quad)};o.prototype={render:function(e,t,n,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n),this.renderToScreen||!t?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)}}},14705:(e,t,n)=>{"use strict";n.r(t),n.d(t,{createShaderMaterial:()=>r,setMacro:()=>o,removeMacro:()=>a,ShaderUtils:()=>s});var i=n(16453),r=function(e){var t={vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};return e.uniforms&&(t.uniforms=i.UniformsUtils.clone(e.uniforms)),e.defines&&(t.defines=Object.assign({},e.defines)),e.extensions&&(t.extensions=Object.assign({},e.extensions)),e.attributes&&(t.attributes=e.attributes),new i.ShaderMaterial(t)},o=function(e,t,n){n=n||"",e.defines||(e.defines={}),e.defines[t]!=n&&(e.defines[t]=n,e.needsUpdate=!0)},a=function(e,t){(e.defines||e.defines[t])&&(delete e.defines[t],e.needsUpdate=!0)},s={createShaderMaterial:r,setMacro:o,removeMacro:a}},57658:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ShadowMapShader:()=>y,GroundShadowShader:()=>b,ShadowMapOverrideMaterials:()=>_,ShadowConfig:()=>x,SHADOWMAP_NEEDS_UPDATE:()=>E,SHADOWMAP_INCOMPLETE:()=>w,SHADOWMAP_VALID:()=>S,ShadowMaps:()=>T,ShadowRender:()=>C});var i=n(12990),r=n(14705),o=n(90564),a=n(83359),s=n(95708),l=n(2727),c=n(16453),u=n(47065),h=n.n(u),d=n(18214),p=n.n(d),f=n(2680),m=n.n(f),g=n(83159),v=n.n(g),y={uniforms:c.UniformsUtils.merge([i.ShaderChunks.ShadowMapCommonUniforms,{shadowMapRangeMin:{type:"f",value:0},shadowMapRangeSize:{type:"f",value:0},shadowMinOpacity:{type:"f",value:0},map:{type:"t",value:null},alphaMap:{type:"t",value:null},texMatrix:{type:"m3",value:new c.Matrix3},texMatrixAlpha:{type:"m3",value:new c.Matrix3}},(0,o.GetPrismMapUniforms)("surface_cutout_map")]),vertexShader:h(),fragmentShader:p()},b={uniforms:i.ShaderChunks.ShadowMapUniforms,vertexShader:m(),fragmentShader:v()};function _(){var e=[],t=(0,r.createShaderMaterial)(y),n=new c.Material;n.visible=!1;var i=[];var o=new function(){this.init=function(){this.isPrism=!1,this.alphaMap=!1,this.alphaClampS=!1,this.alphaClampT=!1,this.alphaInvert=!1,this.rgbaMap=!1,this.rgbaClampS=!1,this.rgbaClampT=!1,this.rgbaInvert=!1,this.instanced=!1,this.decalIndex=-1},this.init(),this.getMaterialIndex=function(){return(this.isPrism?1:0)|(this.alphaMap?2:0)|(this.alphaClampS?4:0)|(this.alphaClampT?8:0)|(this.alphaInvert?16:0)|(this.rgbaMap?32:0)|(this.rgbaClampS?64:0)|(this.rgbaClampT?128:0)|(this.rgbaInvert?256:0)|(this.instanced?512:0)|1024*(this.decalIndex+1)}};function a(i,a){if((s=i)instanceof c.MeshPhongMaterial?s.opacity<x.ShadowMinOpacity:s.isPrismMaterial?"PrismTransparent"===s.prismType||"PrismGlazing"===s.prismType:!s.visible)return n;var s,l=i instanceof c.MeshPhongMaterial,u=i.isPrismMaterial;if(!l&&!u)return null;var h=l?i.alphaMap:i.surface_cutout_map,d=l&&i.alphaTest?i.map:null;if(!h&&!d&&!i.useInstancing)return null;var p=o;p.init(),p.isPrism=u,p.alphaMap=!!h,p.rgbaMap=!!d,p.instanced=i.useInstancing,p.decalIndex=void 0===a?-1:a,h&&(p.alphaClampS=h.clampS,p.alphaClampT=h.clampT,p.alphaInvert=h.invert),d&&(p.rgbaClampS=d.clampS,p.rgbaClampT=d.clampT,p.rgbaInvert=d.invert);var f=function(n,i){var o,a,s,l,c,u=n.getMaterialIndex();if(!e[u]){var h=t.clone();n.isPrism&&n.alphaMap&&((0,r.setMacro)(h,"USE_SURFACE_CUTOUT_MAP"),h.fragmentShader=(o="surface_cutout",a=n.alphaClampS,s=n.alphaClampT,l="uv_"+o+"_map",c="",a&&s?c="if ("+l+".x < 0.0 || "+l+".x > 1.0 || "+l+".y < 0.0 || "+l+".y > 1.0) { discard; }":a?c="if ("+l+".x < 0.0 || "+l+".x > 1.0) { discard; }":s&&(c="if ("+l+".y < 0.0 || "+l+".y > 1.0) { discard; }"),"#define "+o.toUpperCase()+"_CLAMP_TEST "+c+"\n"+h.fragmentShader)),n.instanced&&(h.useInstancing=!0),e[u]=h}return e[u]}(p);return h&&(l?(f.uniforms.alphaMap.value=h,f.uniforms.texMatrixAlpha.value=h.matrix,f.alphaMap=h,f.side=i.side):(f.uniforms.surface_cutout_map.value=h,f.uniforms.surface_cutout_map_texMatrix.value.copy(h.matrix),f.uniforms.surface_cutout_map_invert.value=h.invert,f.side=c.DoubleSide)),d&&(f.uniforms.map.value=d,f.uniforms.texMatrix.value=d.matrix,f.map=d),f}this.forEachMaterial=function(n){for(var i=0;i<e.length;i++){var r=e[i];r&&n(r)}n(t)},this.getCustomOverrideMaterial=function(e){var t=a(e);if(!t)return null;if(!e.decals)return t.decals=null,t;if(e.decals){i.length=0;for(var n=0;n<e.decals.length;n++){var r=e.decals[n],o=a(r.material,n);if(!o)return null;i.push({uv:r.uv,material:o})}}return t.decals=i,t},this.dispose=function(){this.forEachMaterial((function(e){e.dispose()}))}}var x={ShadowMapSize:1024,ShadowESMConstant:80,ShadowBias:.001,ShadowDarkness:.7,ShadowMapBlurRadius:4,ShadowMinOpacity:.9,UseHardShadows:!1,BlurShadowMap:!0},E=0,w=1,S=2;function A(){this.shadowMap=void 0,this.shadowMapSize=void 0,this.shadowMatrix=void 0,this.shadowLightDir=void 0,this.init=function(e){this.shadowMap=e,this.shadowMapSize=new c.Vector2(e.width,e.height),this.shadowMatrix=new c.Matrix4,this.shadowLightDir=new c.Vector3},this.apply=function(e){e.shadowMap=this.shadowMap,e.shadowMatrix=this.shadowMatrix,e.shadowLightDir=this.shadowLightDir,this.shadowMap?((0,r.setMacro)(e,"USE_SHADOWMAP"),x.UseHardShadows&&(0,r.setMacro)(e,"USE_HARD_SHADOWS")):((0,r.removeMacro)(e,"USE_SHADOWMAP"),(0,r.removeMacro)(e,"USE_HARD_SHADOWS"))}}var M=new A;function T(e){var t=null,n=null,i=new c.OrthographicCamera,o=Math.exp(x.ShadowESMConstant),u=x.UseHardShadows?new c.Color(1,1,1):new c.Color(o,1,1),h=e,d=null,p=null,f=null,m=(0,r.createShaderMaterial)(y),g=new _;m.getCustomOverrideMaterial=g.getCustomOverrideMaterial;var v=null;function T(e,t){e.forEach((function(e){t.apply(e)}))}function C(e){var t=new c.WebGLRenderTarget(e,e,{minFilter:c.LinearFilter,magFilter:c.LinearFilter,format:c.RGBAFormat,type:c.FloatType,stencilBuffer:!1,generateMipmaps:!1});return t.texture.generateMipmaps=!1,t}function P(e){h.setRenderTarget(e),h.setClearColor(u,1),h.clear()}var L,R,D,I,O,N,k,F,U,B,V,G=(L=new c.Matrix4,R=new c.Matrix4,D=new c.Vector3(0,0,0),I=new c.Box3,O=new c.Vector3,N=new c.Vector3,function(e,t,n){e.position.copy(n),e.lookAt(D),L.makeRotationFromQuaternion(e.quaternion),R.copy(L).invert(),I.copy(t).applyMatrix4(R),N=I.getCenter(N),O.set(N.x,N.y,I.max.z),O.applyMatrix4(L),e.position.copy(O),N=I.size(N),e.left=-.5*N.x,e.right=.5*N.x,e.bottom=-.5*N.y,e.top=.5*N.y,e.near=0,e.far=N.z,e.updateMatrixWorld(),e.updateProjectionMatrix()});function z(e){e.uniforms.shadowMapRangeMin.value=i.near,e.uniforms.shadowMapRangeSize.value=i.far-i.near,e.uniforms.shadowESMConstant.value=x.ShadowESMConstant,e.uniforms.shadowMinOpacity.value=x.ShadowMinOpacity}this.init=function(){(t=new A).init(C(x.ShadowMapSize)),n=x.BlurShadowMap?new s.D(x.ShadowMapSize,x.ShadowMapSize,x.ShadowMapBlurRadius,1,{type:t.shadowMap.type,format:t.shadowMap.format}):void 0,(d=(0,r.createShaderMaterial)(b)).depthWrite=!1,d.transparent=!0,p=(0,a.createGroundShape)(d),(f=new c.Scene).add(p),this.groundShapeBox=new c.Box3,P(v=C(1))},this.init(),this.state=E,this.startUpdate=function(e,t,n,r,o){var a=e.getVisibleBounds(!0);return this.beginShadowMapUpdate(n,a,r),e.reset(i,l.RenderFlags.RENDER_SHADOWMAP,!0),this.state=w,t=this.continueUpdate(e,t,o)},this.continueUpdate=function(e,n,i){return n=e.renderSome(this.renderSceneIntoShadowMap,n),e.isDone()?(this.state=S,this.finishShadowMapUpdate(i)):function(e){var n=t.shadowMap;t.shadowMap=v,T(e,t),t.apply(d),t.shadowMap=n}(i),n},this.beginShadowMapUpdate=function(e,n,o){G(i,n,o),z(m),g.forEachMaterial(z),x.UseHardShadows&&((0,r.setMacro)(m,"USE_HARD_SHADOWS"),g.forEachMaterial((function(e){(0,r.setMacro)(e,"USE_HARD_SHADOWS")}))),P(t.shadowMap),this.renderSceneIntoShadowMap(f)},this.renderSceneIntoShadowMap=function(e){e.overrideMaterial=m,h.render(e,i,t.shadowMap),e.overrideMaterial=null},this.finishShadowMapUpdate=function(e){n&&!x.UseHardShadows&&n.render(h,t.shadowMap,t.shadowMap),t.shadowMatrix.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),t.shadowMapRangeMin=i.near,t.shadowMapRangeSize=i.far-i.near,t.shadowLightDir.copy(i.position).normalize(),T(e,t),t.apply(d),this.isValid=!0},this.cleanup=function(e){n&&n.cleanup(),t.shadowMap&&t.shadowMap.dispose(),T(e,M),m.dispose(),g.dispose(),d.dispose(),p.geometry.dispose()},this.setGroundShadowTransform=function(e,t,n,i){(0,a.setGroundShapeTransform)(p,e,t,n,i),this.groundShapeBox.setFromObject(p)},this.renderGroundShadow=function(e,t){h.render(f,e,t,!1)},this.expandByGroundShadow=(k=new c.Plane,F=new c.Ray,U=new c.Vector3,B=new c.Vector3,V=new c.Box3,function(e,t){k.normal.set(0,1,0),k.constant=-e.min.y,F.direction.copy(t).negate().normalize();var n,i,r,o=e.getCenter(U),a=100*o.distanceToSquared(e.min)*100;V.makeEmpty();for(var s=0;s<8;s++){F.origin=(n=e,i=s,r=void 0,(r=new c.Vector3).x=1&i?n.max.x:n.min.x,r.y=2&i?n.max.y:n.min.y,r.z=4&i?n.max.z:n.min.z,r);var l=F.intersectPlane(k,B);l&&(l.distanceToSquared(o)>=a||V.expandByPoint(l))}e.union(V)}),this.getShadowParams=function(){return t},this.getShadowCamera=function(){return i}}var C=function(){};C.RefreshUniformsShadow=function(e,t){e.shadowMap&&(e.shadowMap.value=t.shadowMap),e.shadowMatrix&&(e.shadowMatrix.value=t.shadowMatrix),e.shadowLightDir&&(e.shadowLightDir.value=t.shadowLightDir),e.shadowESMConstant&&(e.shadowESMConstant.value=x.ShadowESMConstant),e.shadowBias&&(e.shadowBias.value=x.ShadowBias),e.shadowMapSize&&(e.shadowMapSize.value=x.ShadowMapSize),e.shadowDarkness&&(e.shadowDarkness.value=x.ShadowDarkness)}},98603:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(70057),r=n.n(i),o=n(70125),a=n.n(o);function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=function(){function e(t,n,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewerImpl=t,this.renderContext=n,this.glRenderer=i,this.materialManager=r,this.materialName="__material_2Don3D__",this.tmpVec=new THREE.Vector3,this.tmpBox=new THREE.Box3}var t,n,i;return t=e,n=[{key:"createContext",value:function(){this.sheetContext=new Autodesk.Viewing.Private.RenderContext,this.sheetContext.init(this.glRenderer,this.renderContext.settings.logicalWidth,this.renderContext.settings.logicalHeight,{offscreen:!0});var e=this.renderContext.getConfig();e.antialias=!1,e.renderEdges=!1,e.clearAlpha=0,e.clearColor?e.clearColor.set(1,1,1):(e.clearColorBottom.set(1,1,1),e.clearColorTop.set(1,1,1)),this.sheetContext.applyConfig(e),this.prototypeScene=new THREE.Scene}},{key:"setSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.renderContext;this.sheetContext&&(this.sheetContext.setSize(e.settings.logicalWidth,e.settings.logicalHeight),this.updateMaterial())}},{key:"createScene",value:function(){this.setSize(),this.scene=new THREE.Scene,this.planeGeometry=new THREE.PlaneBufferGeometry(1,1),this.material=new THREE.ShaderMaterial({uniforms:{sheetMap:{type:"t",value:this.sheetContext.getColorTarget()},idMap:{type:"t",value:this.sheetContext.getIDTargets()[0]},modelIDv2:{type:"v3",value:new THREE.Vector3},resolution:{type:"v2",value:new THREE.Vector2},alphaTest:{type:"f",value:0}},vertexShader:r(),fragmentShader:a(),side:THREE.DoubleSide,transparent:!0}),this.scene.skipDepthTarget=!0,this.updateMaterial(),this.materialManager.addMaterialNonHDR(this.materialName,this.material),this.mesh=new THREE.Mesh(this.planeGeometry,this.material),this.mesh.matrixAutoUpdate=!1,this.scene.add(this.mesh)}},{key:"updateMaterial",value:function(){if(this.material){var e=this.sheetContext.getColorTarget();this.material.uniforms.sheetMap.value=e,this.material.uniforms.idMap.value=this.sheetContext.getIDTargets()[0],this.material.uniforms.resolution.value.set(1/(e.width||1),1/(e.height||1))}}},{key:"renderScenePart",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.renderContext;if(e.frags&&e.frags.is2d){this.sheetContext||this.createContext(),this.scene||this.createScene(),this.material.uniforms.alphaTest.value=!e.needsTwoPasses||e.isSecondPass?0:.9;var o=e.modelId,a=this.viewerImpl.modelQueue().findModel(o),s=this.tmpBox.copy(a.getBoundingBox(!0)),l=a.getViewportBounds();l&&s.intersect(l);var c=a.getModelToViewerTransform();this.material.uniforms.modelIDv2.value.set((255&o)/255,(o>>8&255)/255,(o>>16&255)/255),r.getAOEnabled()!==this.sheetContext.getAOEnabled()&&this.sheetContext.initPostPipeline(r.getAOEnabled(),!1),i=i&&a.areAllVisible(),n=!1;var u=this.lastRenderedModel===a&&e.isSecondPass;u||(this.sheetContext.beginScene(this.prototypeScene,this.viewerImpl.camera,this.viewerImpl.noLights,!0),this.sheetContext.renderScenePart(e,t,n,i,!1),this.sheetContext.presentBuffer());var h=s.getSize(new THREE.Vector3);this.mesh.matrix.makeScale(h.x,h.y,1),s.getCenter(this.tmpVec),this.mesh.matrix.setPosition(this.tmpVec),c&&this.mesh.matrix.multiplyMatrices(c,this.mesh.matrix),this.mesh.matrixWorld.copy(this.mesh.matrix),this.scene.modelId=o,r.renderScenePart(this.scene,t,n,i),this.lastRenderedModel=a}}},{key:"destroy",value:function(){this.material&&(this.material.dispose(),this.material=null),this.planeGeometry&&(this.planeGeometry.dispose(),this.planeGeometry=null),this.sheetContext&&(this.sheetContext.cleanup(),this.context=null),this.renderContext=null,this.glRenderer=null}}],n&&s(t.prototype,n),i&&s(t,i),e}()},68693:(e,t,n)=>{"use strict";n.r(t),n.d(t,{WebGLProgram:()=>p});var i,r,o,a=n(74007),s=n(12990),l=n(16453),c=n(84998),u="#version 300 es\n    #define _LMVWEBGL2_\n    #define texture2D texture\n    #define textureCube texture\n    #define attribute in\n    #define varying out\n",h="#version 300 es\n    #define _LMVWEBGL2_\n    #define texture2D texture\n    #define textureCube texture\n    #define textureCubeLodEXT textureLod\n    #define gl_FragColor outFragColor\n    #define varying in\n",d="\n    #define gl_FragDepth gl_FragDepthEXT\n    #extension GL_OES_standard_derivatives : enable\n",p=(i=0,r=function(e){return""!==e},o=function(e,t,n,i,r){var o=i?"1.0-":"",a="texture2D("+e+", (UV))",s="";return r=r||"vec4(0.0)",t&&n?s="((UV).x < 0.0 || (UV).x > 1.0 || (UV).y < 0.0 || (UV).y > 1.0) ? "+r+" : ":t?s="((UV).x < 0.0 || (UV).x > 1.0) ? "+r+" : ":n&&(s="((UV).y < 0.0 || (UV).y > 1.0) ? "+r+" : "),"#define GET_"+e.toUpperCase()+"(UV) ("+s+o+a+")"},function(e,t,n,p){var f=e,m=f.context,g=f.isWebGL2(),v=n.defines,y=n.__webglShader.uniforms,b=n.attributes,_=(0,s.resolve)(p.vertexShader),x=(0,s.resolve)(p.fragmentShader),E=n.index0AttributeName;void 0===E&&!0===p.morphTargets&&(E="position");var w,S,A="ENVMAP_MODE_REFLECTION",M=e.gammaFactor>0?e.gammaFactor:1,T=function(e){var t,n,i=[];for(var r in e)!1!==(t=e[r])&&(n="#define "+r+" "+t,i.push(n));return i.join("\n")}(v),C=m.createProgram();n instanceof l.RawShaderMaterial?((w=[g?u:"",T].filter(r).join("\n")).length>0&&(w+="\n"),(S=[g?h:d,"precision "+p.precisionFragment+" float;",T,g?"out vec4 outFragColor;":""].filter(r).join("\n")).length>0&&(S+="\n")):(w=[g?u:"","precision "+p.precision+" float;","precision "+p.precision+" int;",T,p.vertexPrefix,p.supportsVertexTextures?"#define VERTEX_TEXTURES":"",f.gammaInput?"#define GAMMA_INPUT":"",f.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+M,p.mrtNormals?"#define MRT_NORMALS":"",p.mrtIdBuffer?"#define MRT_ID_BUFFER":"","#define MAX_DIR_LIGHTS "+p.maxDirLights,"#define MAX_POINT_LIGHTS "+p.maxPointLights,"#define MAX_SPOT_LIGHTS "+p.maxSpotLights,"#define MAX_HEMI_LIGHTS "+p.maxHemiLights,"#define MAX_BONES "+p.maxBones,"#define NUM_CUTPLANES "+p.numCutplanes,p.loadingAnimationDuration>0?"#define LOADING_ANIMATION":"",p.map?"#define USE_MAP":"",p.envMap?"#define USE_ENVMAP":"",p.envMap?"#define "+A:"",p.irradianceMap?"#define USE_IRRADIANCEMAP":"",p.lightMap?"#define USE_LIGHTMAP":"",p.bumpMap?"#define USE_BUMPMAP":"",p.normalMap?"#define USE_NORMALMAP":"",p.specularMap?"#define USE_SPECULARMAP":"",p.alphaMap?"#define USE_ALPHAMAP":"",p.vertexColors?"#define USE_COLOR":"",p.vertexIds?"#define USE_VERTEX_ID":"",p.useTiling?"#define USE_TILING":"",p.useInstancing?"#define USE_INSTANCING":"",p.wideLines?"#define WIDE_LINES":"",p.skinning?"#define USE_SKINNING":"",p.useVertexTexture?"#define BONE_TEXTURE":"",p.morphTargets?"#define USE_MORPHTARGETS":"",p.morphNormals?"#define USE_MORPHNORMALS":"",p.wrapAround?"#define WRAP_AROUND":"",p.doubleSided?"#define DOUBLE_SIDED":"",p.flipSided?"#define FLIP_SIDED":"",p.sizeAttenuation?"#define USE_SIZEATTENUATION":"",p.packedNormals?"#define UNPACK_NORMALS":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","#ifdef UNPACK_NORMALS","attribute vec2 normal;","#else","attribute vec3 normal;","#endif","attribute vec2 uv;","attribute vec2 uv2;","#ifdef USE_COLOR","   attribute vec3 color;","#endif",""].join("\n"),S=[g?h:d,g||!p.bumpMap&&!p.normalMap?"":"#extension GL_OES_standard_derivatives : enable",g||!p.mrtIdBuffer&&!p.mrtNormals||c.isIE11?"":"#extension GL_EXT_draw_buffers : enable",!g&&p.mrtIdBuffer?"#define gl_FragColor gl_FragData[0]":"",p.haveTextureLod?"#define HAVE_TEXTURE_LOD":"",T,p.fragmentPrefix,"#define MAX_DIR_LIGHTS "+p.maxDirLights,"#define MAX_POINT_LIGHTS "+p.maxPointLights,"#define MAX_SPOT_LIGHTS "+p.maxSpotLights,"#define MAX_HEMI_LIGHTS "+p.maxHemiLights,"#define NUM_CUTPLANES "+p.numCutplanes,p.loadingAnimationDuration>0?"#define LOADING_ANIMATION":"",p.alphaTest?"#define ALPHATEST "+p.alphaTest:"",f.gammaInput?"#define GAMMA_INPUT":"",f.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+M,p.mrtNormals?"#define MRT_NORMALS":"",p.mrtIdBuffer?"#define MRT_ID_BUFFER":"",p.mrtIdBuffer>1?"#define MODEL_COLOR":"","#define TONEMAP_OUTPUT "+(p.tonemapOutput||0),p.useBackgroundTexture?"#define USE_BACKGROUND_TEXTURE":"",p.useFog&&p.fog?"#define USE_FOG":"",p.useFog&&p.fogExp?"#define FOG_EXP2":"",p.map?"#define USE_MAP":"",p.envMap?"#define USE_ENVMAP":"",p.envMap?"#define ENVMAP_TYPE_CUBE":"",p.envMap?"#define "+A:"",p.envMap?"#define ENVMAP_BLENDING_MULTIPLY":"",p.irradianceMap?"#define USE_IRRADIANCEMAP":"",p.envGammaEncoded?"#define ENV_GAMMA":"",p.irrGammaEncoded?"#define IRR_GAMMA":"",p.envRGBM?"#define ENV_RGBM":"",p.irrRGBM?"#define IRR_RGBM":"",p.lightMap?"#define USE_LIGHTMAP":"",p.bumpMap?"#define USE_BUMPMAP":"",p.normalMap?"#define USE_NORMALMAP":"",p.specularMap?"#define USE_SPECULARMAP":"",p.alphaMap?"#define USE_ALPHAMAP":"",p.vertexColors?"#define USE_COLOR":"",p.vertexIds?"#define USE_VERTEX_ID":"",p.metal?"#define METAL":"",p.clearcoat?"#define CLEARCOAT":"",p.wrapAround?"#define WRAP_AROUND":"",p.doubleSided?"#define DOUBLE_SIDED":"",p.flipSided?"#define FLIP_SIDED":"",p.hatchPattern?"#define HATCH_PATTERN":"",p.mapInvert?"#define MAP_INVERT":"",p.useTiling?"#define USE_TILING":"",p.useTiling?"#define TILE_RANGE_X_MIN "+p.tilingRepeatRange[0]:"",p.useTiling?"#define TILE_RANGE_Y_MIN "+p.tilingRepeatRange[1]:"",p.useTiling?"#define TILE_RANGE_X_MAX "+p.tilingRepeatRange[2]:"",p.useTiling?"#define TILE_RANGE_Y_MAX "+p.tilingRepeatRange[3]:"",p.hasRoundCorner?"#define USE_TILING_NORMAL":"",p.useRandomOffset?"#define USE_TILING_RANDOM":"",o("map",p.mapClampS,p.mapClampT),o("bumpMap",p.bumpMapClampS,p.bumpMapClampT),o("normalMap",p.normalMapClampS,p.normalMapClampT),o("specularMap",p.specularMapClampS,p.specularMapClampT),o("alphaMap",p.alphaMapClampS,p.alphaMapClampT,p.alphaMapInvert),"#ifdef USE_ENVMAP","#ifdef HAVE_TEXTURE_LOD",g?"":"#extension GL_EXT_shader_texture_lod : enable","#endif","#endif","precision "+p.precisionFragment+" float;","precision "+p.precisionFragment+" int;",g?"layout(location = 0) out vec4 outFragColor;":"","uniform highp mat4 viewMatrix;","uniform highp mat4 projectionMatrix;","uniform highp vec3 cameraPosition;","#if defined(USE_ENVMAP) || defined(USE_IRRADIANCEMAP)","uniform mat4 viewMatrixInverse;","#endif",""].join("\n"));var P=new a.WebGLShader(m,m.VERTEX_SHADER,w+_),L=new a.WebGLShader(m,m.FRAGMENT_SHADER,S+x);m.attachShader(C,P),m.attachShader(C,L),void 0!==E&&m.bindAttribLocation(C,0,E),m.linkProgram(C),"undefined"!=typeof DEBUG_SHADERS&&DEBUG_SHADERS&&(!1===m.getProgramParameter(C,m.LINK_STATUS)&&(console.error("THREE.WebGLProgram: Could not initialise shader."),console.error("gl.VALIDATE_STATUS",m.getProgramParameter(C,m.VALIDATE_STATUS)),console.error("gl.getError()",m.getError())),""!==m.getProgramInfoLog(C)&&console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",m.getProgramInfoLog(C))),m.deleteShader(P),m.deleteShader(L);var R=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","modelMatrix","cameraPosition","viewMatrixInverse","mvpMatrix","dbId"];for(var D in y)R.push(D);for(var I in this.uniforms=function(e,t,n){for(var i={},r=0,o=n.length;r<o;r++){var a=n[r];i[a]=e.getUniformLocation(t,a)}return i}(m,C,R),R=["position","normal","uv","uv2","tangent","color","lineDistance","uvw","id","instOffset","instScaling","instRotation","prev","next","side","uvp","pointScale"],b)R.push(I);return this.attributes=function(e,t,n){for(var i={},r=0,o=n.length;r<o;r++){var a=n[r];i[a]=e.getAttribLocation(t,a)}return i}(m,C,R),this.attributesKeys=Object.keys(this.attributes),this.id=i++,this.code=t,this.usedTimes=1,this.program=C,this.vertexShader=P,this.fragmentShader=L,this})},88771:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DEBUG_TEXTURE_LOAD:()=>p,WebGLRenderer:()=>v});var i=n(68693),r=n(57658),o=n(31102),a=n(44971),s=n(84998),l=n(16453),c=n(92445),u=n(94370);function h(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var p=!1,f=(0,s.getGlobal)(),m=f.document,g={WEBGL_CONTEXT_LOST:"webglcontextlost",WEBGL_CONTEXT_RESTORED:"webglcontextrestored"},v=function(e){console.log("THREE.WebGLRenderer",l.REVISION),Autodesk.Viewing.EventDispatcher.prototype.apply(this);var t=void 0!==(e=e||{}).canvas?e.canvas:m.createElement("canvas"),n=null,d=void 0!==e.precision?e.precision:"highp",v=d,y=void 0!==e.alpha&&e.alpha,b=void 0===e.premultipliedAlpha||e.premultipliedAlpha,_=void 0!==e.antialias&&e.antialias,x=void 0===e.stencil||e.stencil,E=void 0===e.preserveDrawingBuffer||e.preserveDrawingBuffer,w=new l.Color(0),S=0,A=s.isIE11,M=[],T={},C=new l.Matrix4,P=new l.Matrix3,L=0,R=[],D=[],I=-1;this.properties=new l.WebGLProperties,this.domElement=t,this.context=null,this.refCount=0,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.gammaInput=!1,this.gammaOutput=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var O,N,k,F,U,B,V,G,z,H=this,W=[],j=null,q=null,X=null,Y=-1,K=null,Z="",J=0,Q="",$="",ee=0,te=0,ne=0,ie=t.width,re=t.height,oe=new l.Vector4,ae={},se=new l.Frustum,le=new l.Matrix4,ce=new l.Matrix4,ue=new l.Vector3,he=new l.Vector3,de=!0,pe={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}};try{var fe={alpha:y,premultipliedAlpha:b,antialias:_,stencil:x,powerPreference:"high-performance",preserveDrawingBuffer:E};if((O=!1!==e.useWebGL2?t.getContext("webgl2",fe):null)?N=!0:O=t.getContext("webgl",fe)||t.getContext("experimental-webgl",fe),null===O)throw null!==t.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";var me=O.getExtension("WEBGL_debug_renderer_info");if(me){var ge=O.getParameter(me.UNMASKED_VENDOR_WEBGL),ve=O.getParameter(me.UNMASKED_RENDERER_WEBGL);console.log("WebGL Renderer: "+ve),console.log("WebGL Vendor: "+ge)}0==O.getShaderPrecisionFormat(O.FRAGMENT_SHADER,O.HIGH_FLOAT).precision&&(v="mediump"),t.addEventListener("webglcontextlost",(function(e){e.preventDefault(),xe(),_e(),T={},Ut={},Bt=0,Ee.dispose(),W.length=0,H.fireEvent({type:g.WEBGL_CONTEXT_LOST})}),!1),t.addEventListener("webglcontextrestored",(function(e){e.preventDefault(),H.enableContextRestore&&(ye(),Oe(),H.lostContextRecovery=H.lostContextRecovery||new o.ZP,H.lostContextRecovery.onContextRestored(),j=null,q=null,H.fireEvent({type:g.WEBGL_CONTEXT_RESTORED}))}))}catch(e){return void console.error(e)}function ye(){B=new l.WebGLExtensions(O),G=new l.WebGLCapabilities(O,B,e),V=new l.WebGLState(O,B,G);var t=new l.WebGLAttributes(O,G);z=new l.WebGLBindingStates(O,B,t,G),B.get("EXT_texture_filter_anisotropic"),B.get("WEBGL_compressed_texture_s3tc"),N?B.get("EXT_color_buffer_float"):(B.get("OES_texture_float"),B.get("OES_texture_float_linear"),B.get("OES_texture_half_float"),B.get("OES_texture_half_float_linear"),B.get("OES_standard_derivatives"),B.get("EXT_shader_texture_lod"),k=B.get("WEBGL_draw_buffers"),F=B.get("ANGLE_instanced_arrays"),U=B.get("OES_vertex_array_object"))}void 0===O.getShaderPrecisionFormat&&(O.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),ye();var be=function(e,t,n,i){!0===b&&(e*=i,t*=i,n*=i),O.clearColor(e,t,n,i)},_e=function(){O.clearColor(0,0,0,1),O.clearDepth(1),O.clearStencil(0),O.enable(O.DEPTH_TEST),O.depthFunc(O.LEQUAL),O.frontFace(O.CCW),O.cullFace(O.BACK),O.enable(O.CULL_FACE),O.enable(O.BLEND),O.blendEquation(O.FUNC_ADD),O.blendFunc(O.SRC_ALPHA,O.ONE_MINUS_SRC_ALPHA),O.viewport(te,ne,ie,re),be(w.r,w.g,w.b,S)},xe=function(){j=null,K=null,Z="",Y=-1,de=!0,V.setBlending(l.NoBlending),O.disable(O.BLEND)};_e(),this.context=O,this.state=V;for(var Ee,we=O.getParameter(O.MAX_TEXTURE_IMAGE_UNITS),Se=O.getParameter(O.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Ae=O.getParameter(O.MAX_TEXTURE_SIZE),Me=O.getParameter(O.MAX_CUBE_MAP_TEXTURE_SIZE),Te=Se>0,Ce=O.getShaderPrecisionFormat(O.VERTEX_SHADER,O.HIGH_FLOAT),Pe=O.getShaderPrecisionFormat(O.VERTEX_SHADER,O.MEDIUM_FLOAT),Le=O.getShaderPrecisionFormat(O.FRAGMENT_SHADER,O.HIGH_FLOAT),Re=O.getShaderPrecisionFormat(O.FRAGMENT_SHADER,O.MEDIUM_FLOAT),De=new Uint8Array(16),Ie=0;Ie<4;Ie++)p?1===Ie||2===Ie?(De[4*Ie]=246,De[4*Ie+1]=140,De[4*Ie+2]=220):(De[4*Ie]=48,De[4*Ie+1]=195,De[4*Ie+2]=3):De[4*Ie]=De[4*Ie+1]=De[4*Ie+2]=0,De[4*Ie+3]=255;function Oe(){(Ee=new l.DataTexture(De,2,2,l.RGBAFormat,l.UnsignedByteType,l.UVMapping,l.RepeatWrapping,l.RepeatWrapping,l.NearestFilter,l.NearestFilter)).needsUpdate=!0}Oe();var Ne,ke=function(){if(void 0!==Ne)return Ne;if(Ne=[],B.get("WEBGL_compressed_texture_pvrtc")||B.get("WEBGL_compressed_texture_s3tc"))for(var e=O.getParameter(O.COMPRESSED_TEXTURE_FORMATS),t=0;t<e.length;t++)Ne.push(e[t]);return Ne},Fe=Ce.precision>0,Ue=Pe.precision>0;"highp"!==d||Fe||(Ue?(d="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):(d="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp"))),"mediump"!==d||Ue||(d="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp")),Fe=Le.precision>0,Ue=Re.precision>0,"highp"!==v||Fe||(Ue?(v="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):(v="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp"))),"mediump"!==v||Ue||(v="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp")),this.xr=new l.WebXRManager(H,O);var Be,Ve=this.xr;this.getContext=function(){return O},this.isWebGL2=function(){return N},this.forceContextLoss=function(){B.get("WEBGL_lose_context").loseContext()},this.forceContextRestore=function(){B.get("WEBGL_lose_context").restoreContext()},this.supportsVertexTextures=function(){return Te},this.supportsFloatTextures=function(){return N||B.get("OES_texture_float")},this.supportsHalfFloatTextures=function(){return N||B.get("OES_texture_half_float_linear")},this.supportsStandardDerivatives=function(){return N||B.get("OES_standard_derivatives")},this.supportsCompressedTextureS3TC=function(){return N||B.get("WEBGL_compressed_texture_s3tc")},this.supportsElementIndexUint=function(){return N||B.get("OES_element_index_uint")},this.setFramebuffer=function(e){},this.supportsMRT=function(){return N||!A&&k},this.supportsInstancedArrays=function(){return N||!!F},this.supportsBlendMinMax=function(){return N||B.get("EXT_blend_minmax")},this.getMaxAnisotropy=function(){if(void 0!==Be)return Be;var e=B.get("EXT_texture_filter_anisotropic");return Be=null!==e?O.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},this.getPixelRatio=function(){return n||f.devicePixelRatio||1},this.setPixelRatio=function(e){n=e},this.getCurrentFramebuffer=function(){return q},this.setSize=function(e,n,i){if(null==Ve?void 0:Ve.isPresenting)console.warn("THREE.WebGLRenderer: Can't change size while XR device is presenting.");else{var r=this.getPixelRatio();t.width=e*r,t.height=n*r,!1!==i&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n)}},this.setViewport=function(e,t,n,i){var r=this.getPixelRatio();te=e*r,ne=t*r,ie=n*r,re=i*r,O.viewport(te,ne,ie,re)};var Ge=!1;this.enableViewportOnOffscreenTargets=function(e){Ge=e};var ze=[];function He(e){e.__webglVertexBuffer=O.createBuffer(),e.__webglNormalBuffer=O.createBuffer(),e.__webglTangentBuffer=O.createBuffer(),e.__webglColorBuffer=O.createBuffer(),e.__webglUVBuffer=O.createBuffer(),e.__webglUV2Buffer=O.createBuffer(),e.__webglSkinIndicesBuffer=O.createBuffer(),e.__webglSkinWeightsBuffer=O.createBuffer(),e.__webglFaceBuffer=O.createBuffer(),e.__webglLineBuffer=O.createBuffer(),H.info.memory.geometries++}this.pushViewport=function(){ze.push(te),ze.push(ne),ze.push(ie),ze.push(re)},this.popViewport=function(){var e=ze.length-4;te=ze[e],ne=ze[e+1],ie=ze[e+2],re=ze[e+3],O.viewport(te,ne,ie,re),ze.length=e},this.setScissor=function(e,t,n,i){var r=this.getPixelRatio();O.scissor(e*r,t*r,n*r,i*r)},this.enableScissorTest=function(e){e?O.enable(O.SCISSOR_TEST):O.disable(O.SCISSOR_TEST)},this.setLoadingAnimationDuration=function(e){I=e},this.getLoadingAnimationDuration=function(){return I},this.getClearColor=function(){return w},this.setClearColor=function(e,t){w.set(e),S=void 0!==t?t:1,be(w.r,w.g,w.b,S)},this.getClearAlpha=function(){return S},this.setClearAlpha=function(e){S=e,be(w.r,w.g,w.b,S)},this.clear=function(e,t,n){var i=0;(void 0===e||e)&&(i|=O.COLOR_BUFFER_BIT),(void 0===t||t)&&(i|=O.DEPTH_BUFFER_BIT),(void 0===n||n)&&(i|=O.STENCIL_BUFFER_BIT),O.clear(i)},this.clearColor=function(){O.clear(O.COLOR_BUFFER_BIT)},this.clearDepth=function(){O.clear(O.DEPTH_BUFFER_BIT)},this.clearStencil=function(){O.clear(O.STENCIL_BUFFER_BIT)},this.clearTarget=function(e,t,n,i){this.setRenderTarget(e),this.clear(t,n,i)},this.resetGLState=xe;var We=function e(t){t.target.traverse((function(t){t.removeEventListener("remove",e),function(e){(e instanceof l.Mesh||e instanceof l.PointCloud||e instanceof l.Line)&&delete T[e.id];delete e.__webglInit,delete e.__webglActive}(t)}))},je=function e(t){var n=t.target;n.removeEventListener("dispose",e),Ze(n)},qe=function e(t){var n=t.target;n.removeEventListener("dispose",e),Je(n),H.info.memory.textures--},Xe=function e(t){var n=t.target;n.removeEventListener("dispose",e),Qe(n),H.info.memory.textures--},Ye=function e(t){var n=t.target;n.removeEventListener("dispose",e),$e(n)},Ke=function(e){if(void 0!==e.__webglVertexBuffer&&(O.deleteBuffer(e.__webglVertexBuffer),e.__webglVertexBuffer=void 0),void 0!==e.__webglNormalBuffer&&(O.deleteBuffer(e.__webglNormalBuffer),e.__webglNormalBuffer=void 0),void 0!==e.__webglTangentBuffer&&(O.deleteBuffer(e.__webglTangentBuffer),e.__webglTangentBuffer=void 0),void 0!==e.__webglColorBuffer&&(O.deleteBuffer(e.__webglColorBuffer),e.__webglColorBuffer=void 0),void 0!==e.__webglUVBuffer&&(O.deleteBuffer(e.__webglUVBuffer),e.__webglUVBuffer=void 0),void 0!==e.__webglUV2Buffer&&(O.deleteBuffer(e.__webglUV2Buffer),e.__webglUV2Buffer=void 0),void 0!==e.__webglSkinIndicesBuffer&&(O.deleteBuffer(e.__webglSkinIndicesBuffer),e.__webglSkinIndicesBuffer=void 0),void 0!==e.__webglSkinWeightsBuffer&&(O.deleteBuffer(e.__webglSkinWeightsBuffer),e.__webglSkinWeightsBuffer=void 0),void 0!==e.__webglFaceBuffer&&(O.deleteBuffer(e.__webglFaceBuffer),e.__webglFaceBuffer=void 0),void 0!==e.__webglLineBuffer&&(O.deleteBuffer(e.__webglLineBuffer),e.__webglLineBuffer=void 0),void 0!==e.__webglLineDistanceBuffer&&(O.deleteBuffer(e.__webglLineDistanceBuffer),e.__webglLineDistanceBuffer=void 0),void 0!==e.__webglCustomAttributesList){for(var t in e.__webglCustomAttributesList)O.deleteBuffer(e.__webglCustomAttributesList[t].buffer);e.__webglCustomAttributesList=void 0}H.info.memory.geometries--},Ze=function(e){var t,n,i,r;if(e.__webglInit=void 0,e instanceof l.BufferGeometry){if(void 0!==e.vbbuffer&&(O.deleteBuffer(e.vbbuffer),e.vbbuffer=void 0),void 0!==e.ibbuffer&&(O.deleteBuffer(e.ibbuffer),e.ibbuffer=void 0),void 0!==e.iblinesbuffer&&(O.deleteBuffer(e.iblinesbuffer),e.iblinesbuffer=void 0),e.vaos){for(t=0;t<e.vaos.length;t++)dt(e.vaos[t].vao);e.vaos=void 0}var o=e.attributes;for(var a in o)void 0!==o[a].buffer&&(O.deleteBuffer(o[a].buffer),o[a].buffer=void 0);H.info.memory.geometries--}else{var s=Ut[e.id];if(void 0!==s){for(t=0,n=s.length;t<n;t++){var c=s[t];if(void 0!==c.numMorphTargets){for(i=0,r=c.numMorphTargets;i<r;i++)O.deleteBuffer(c.__webglMorphTargetsBuffers[i]);delete c.__webglMorphTargetsBuffers}if(void 0!==c.numMorphNormals){for(i=0,r=c.numMorphNormals;i<r;i++)O.deleteBuffer(c.__webglMorphNormalsBuffers[i]);delete c.__webglMorphNormalsBuffers}Ke(c)}delete Ut[e.id]}else Ke(e)}};this.deallocateGeometry=Ze;var Je=function(e){if(e.__webglTextureCube)O.deleteTexture(e.__webglTextureCube),e.__webglTextureCube=void 0;else{if(!e.__webglInit)return;O.deleteTexture(e.__webglTexture),e.__webglInit=void 0,e.__webglTexture=void 0}},Qe=function(e){e&&e.__webglTexture&&(O.deleteTexture(e.__webglTexture),O.deleteFramebuffer(e.__webglFramebuffer),void 0!==e.__webglRenderbuffer&&O.deleteRenderbuffer(e.__webglRenderbuffer),void 0!==e.__webglRenderbufferOwn&&(O.deleteRenderbuffer(e.__webglRenderbufferOwn),e.__webglRenderbufferOwn=void 0))},$e=function(e){var t=!1;e.program=void 0,e.programs.forEach((function(e){var n,i,r,o;if(void 0!==e&&null!=(n=e.program))for(i=0,r=W.length;i<r;i++)if((o=W[i])&&o.program===n){o.usedTimes--,0===o.usedTimes&&(W[i]=void 0,O.deleteProgram(n),H.info.memory.programs--,t=!0);break}}),!1),e.programs.length=0,t&&(W=W.filter((function(e){return void 0!==e})))};function et(e,t){var n=e.vertices.length,i=t.material;if(i.attributes)for(var r in void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]),i.attributes){var o=i.attributes[r];if(!o.__webglInitialized||o.createUniqueBuffers){o.__webglInitialized=!0;var a=1;"v2"===o.type?a=2:"v3"===o.type?a=3:"v4"===o.type?a=4:"c"===o.type&&(a=3),o.size=a,o.array=new Float32Array(n*a),o.buffer=O.createBuffer(),o.buffer.belongsToAttribute=r,o.needsUpdate=!0}e.__webglCustomAttributesList.push(o)}}function tt(e,t){var n=t.geometry,i=e.faces3,r=3*i.length,o=1*i.length,a=3*i.length,s=nt(t,e),l=ot(s),c=it(s),u=rt(s);e.__vertexArray=new Float32Array(3*r),c&&(e.__normalArray=new Float32Array(3*r)),n.hasTangents&&(e.__tangentArray=new Float32Array(4*r)),u&&(e.__colorArray=new Float32Array(3*r)),l&&(n.faceVertexUvs.length>0&&(e.__uvArray=new Float32Array(2*r)),n.faceVertexUvs.length>1&&(e.__uv2Array=new Float32Array(2*r))),t.geometry.skinWeights.length&&t.geometry.skinIndices.length&&(e.__skinIndexArray=new Float32Array(4*r),e.__skinWeightArray=new Float32Array(4*r));var h=(N||B.get("OES_element_index_uint"))&&o>21845?Uint32Array:Uint16Array;if(e.__typeArray=h,e.__faceArray=new h(3*o),e.__lineArray=new h(2*a),e.__webglFaceCount=3*o,e.__webglLineCount=2*a,s.attributes)for(var d in void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]),s.attributes){var p=s.attributes[d],f={};for(var m in p)f[m]=p[m];if(!f.__webglInitialized||f.createUniqueBuffers){f.__webglInitialized=!0;var g=1;"v2"===f.type?g=2:"v3"===f.type?g=3:"v4"===f.type?g=4:"c"===f.type&&(g=3),f.size=g,f.array=new Float32Array(r*g),f.buffer=O.createBuffer(),f.buffer.belongsToAttribute=d,p.needsUpdate=!0,f.__original=p}e.__webglCustomAttributesList.push(f)}e.__inittedArrays=!0}function nt(e,t){return e.material instanceof l.MeshFaceMaterial?e.material.materials[t.materialIndex]:e.material}function it(e){return!(e instanceof l.MeshBasicMaterial&&!e.envMap||e instanceof l.MeshDepthMaterial)&&(function(e){return e&&void 0!==e.shading&&e.shading===l.SmoothShading}(e)?l.SmoothShading:l.FlatShading)}function rt(e){return!!e.vertexColors&&e.vertexColors}function ot(e){return!!(e.map||e.lightMap||e.bumpMap||e.normalMap||e.specularMap||e.alphaMap||e instanceof l.ShaderMaterial)}var at=this.properties;function st(e){var t=at.get(e);return e.version>0&&e.version!==t.__version}function lt(e){at.get(e).__version=e.version}function ct(e,t,n,i,r){if(e.__inittedArrays){var o,a,s,c,u,h,d,p,f,m,g,v,y,b,_,x,E,w,S,A,M,T,C,P,L,R,D=it(r),I=rt(r),N=ot(r),k=D===l.SmoothShading,F=0,U=0,B=0,V=0,G=0,z=0,H=0,W=0,j=0,q=0,X=e.__vertexArray,Y=e.__uvArray,K=e.__uv2Array,Z=e.__normalArray,J=e.__tangentArray,Q=e.__colorArray,$=e.__webglCustomAttributesList,ee=e.__faceArray,te=e.__lineArray,ne=t.geometry,ie=ne.verticesNeedUpdate,re=ne.elementsNeedUpdate,oe=ne.uvsNeedUpdate,ae=ne.normalsNeedUpdate,se=ne.tangentsNeedUpdate,le=ne.colorsNeedUpdate,ce=ne.vertices,ue=e.faces3,he=ne.faces,de=ne.faceVertexUvs[0],pe=ne.faceVertexUvs[1];if(ie){for(o=0,a=ue.length;o<a;o++)g=ce[(s=he[ue[o]]).a],v=ce[s.b],y=ce[s.c],X[U]=g.x,X[U+1]=g.y,X[U+2]=g.z,X[U+3]=v.x,X[U+4]=v.y,X[U+5]=v.z,X[U+6]=y.x,X[U+7]=y.y,X[U+8]=y.z,U+=9;O.bindBuffer(O.ARRAY_BUFFER,e.__webglVertexBuffer),O.bufferData(O.ARRAY_BUFFER,X,n)}if(le&&I){for(o=0,a=ue.length;o<a;o++)h=(s=he[ue[o]]).vertexColors,d=s.color,3===h.length&&I===l.VertexColors?(E=h[0],w=h[1],S=h[2]):(E=d,w=d,S=d),Q[j]=E.r,Q[j+1]=E.g,Q[j+2]=E.b,Q[j+3]=w.r,Q[j+4]=w.g,Q[j+5]=w.b,Q[j+6]=S.r,Q[j+7]=S.g,Q[j+8]=S.b,j+=9;j>0&&(O.bindBuffer(O.ARRAY_BUFFER,e.__webglColorBuffer),O.bufferData(O.ARRAY_BUFFER,Q,n))}if(se&&ne.hasTangents){for(o=0,a=ue.length;o<a;o++)b=(p=(s=he[ue[o]]).vertexTangents)[0],_=p[1],x=p[2],J[H]=b.x,J[H+1]=b.y,J[H+2]=b.z,J[H+3]=b.w,J[H+4]=_.x,J[H+5]=_.y,J[H+6]=_.z,J[H+7]=_.w,J[H+8]=x.x,J[H+9]=x.y,J[H+10]=x.z,J[H+11]=x.w,H+=12;O.bindBuffer(O.ARRAY_BUFFER,e.__webglTangentBuffer),O.bufferData(O.ARRAY_BUFFER,J,n)}if(ae&&D){for(o=0,a=ue.length;o<a;o++)if(c=(s=he[ue[o]]).vertexNormals,u=s.normal,3===c.length&&k)for(A=0;A<3;A++)T=c[A],Z[z]=T.x,Z[z+1]=T.y,Z[z+2]=T.z,z+=3;else for(A=0;A<3;A++)Z[z]=u.x,Z[z+1]=u.y,Z[z+2]=u.z,z+=3;O.bindBuffer(O.ARRAY_BUFFER,e.__webglNormalBuffer),O.bufferData(O.ARRAY_BUFFER,Z,n)}if(oe&&de&&N){for(o=0,a=ue.length;o<a;o++)if(void 0!==(f=de[ue[o]]))for(A=0;A<3;A++)C=f[A],Y[B]=C.x,Y[B+1]=C.y,B+=2;B>0&&(O.bindBuffer(O.ARRAY_BUFFER,e.__webglUVBuffer),O.bufferData(O.ARRAY_BUFFER,Y,n))}if(oe&&pe&&N){for(o=0,a=ue.length;o<a;o++)if(void 0!==(m=pe[ue[o]]))for(A=0;A<3;A++)P=m[A],K[V]=P.x,K[V+1]=P.y,V+=2;V>0&&(O.bindBuffer(O.ARRAY_BUFFER,e.__webglUV2Buffer),O.bufferData(O.ARRAY_BUFFER,K,n))}if(re){for(o=0,a=ue.length;o<a;o++)ee[G]=F,ee[G+1]=F+1,ee[G+2]=F+2,G+=3,te[W]=F,te[W+1]=F+1,te[W+2]=F,te[W+3]=F+2,te[W+4]=F+1,te[W+5]=F+2,W+=6,F+=3;O.bindBuffer(O.ELEMENT_ARRAY_BUFFER,e.__webglFaceBuffer),O.bufferData(O.ELEMENT_ARRAY_BUFFER,ee,n),O.bindBuffer(O.ELEMENT_ARRAY_BUFFER,e.__webglLineBuffer),O.bufferData(O.ELEMENT_ARRAY_BUFFER,te,n)}if($)for(A=0,M=$.length;A<M;A++)if(st((R=$[A]).__original)){if(q=0,1===R.size){if(void 0===R.boundTo||"vertices"===R.boundTo)for(o=0,a=ue.length;o<a;o++)s=he[ue[o]],R.array[q]=R.value[s.a],R.array[q+1]=R.value[s.b],R.array[q+2]=R.value[s.c],q+=3;else if("faces"===R.boundTo)for(o=0,a=ue.length;o<a;o++)L=R.value[ue[o]],R.array[q]=L,R.array[q+1]=L,R.array[q+2]=L,q+=3}else if(2===R.size){if(void 0===R.boundTo||"vertices"===R.boundTo)for(o=0,a=ue.length;o<a;o++)s=he[ue[o]],g=R.value[s.a],v=R.value[s.b],y=R.value[s.c],R.array[q]=g.x,R.array[q+1]=g.y,R.array[q+2]=v.x,R.array[q+3]=v.y,R.array[q+4]=y.x,R.array[q+5]=y.y,q+=6;else if("faces"===R.boundTo)for(o=0,a=ue.length;o<a;o++)g=L=R.value[ue[o]],v=L,y=L,R.array[q]=g.x,R.array[q+1]=g.y,R.array[q+2]=v.x,R.array[q+3]=v.y,R.array[q+4]=y.x,R.array[q+5]=y.y,q+=6}else if(3===R.size){var fe;if(fe="c"===R.type?["r","g","b"]:["x","y","z"],void 0===R.boundTo||"vertices"===R.boundTo)for(o=0,a=ue.length;o<a;o++)s=he[ue[o]],g=R.value[s.a],v=R.value[s.b],y=R.value[s.c],R.array[q]=g[fe[0]],R.array[q+1]=g[fe[1]],R.array[q+2]=g[fe[2]],R.array[q+3]=v[fe[0]],R.array[q+4]=v[fe[1]],R.array[q+5]=v[fe[2]],R.array[q+6]=y[fe[0]],R.array[q+7]=y[fe[1]],R.array[q+8]=y[fe[2]],q+=9;else if("faces"===R.boundTo)for(o=0,a=ue.length;o<a;o++)g=L=R.value[ue[o]],v=L,y=L,R.array[q]=g[fe[0]],R.array[q+1]=g[fe[1]],R.array[q+2]=g[fe[2]],R.array[q+3]=v[fe[0]],R.array[q+4]=v[fe[1]],R.array[q+5]=v[fe[2]],R.array[q+6]=y[fe[0]],R.array[q+7]=y[fe[1]],R.array[q+8]=y[fe[2]],q+=9;else if("faceVertices"===R.boundTo)for(o=0,a=ue.length;o<a;o++)g=(L=R.value[ue[o]])[0],v=L[1],y=L[2],R.array[q]=g[fe[0]],R.array[q+1]=g[fe[1]],R.array[q+2]=g[fe[2]],R.array[q+3]=v[fe[0]],R.array[q+4]=v[fe[1]],R.array[q+5]=v[fe[2]],R.array[q+6]=y[fe[0]],R.array[q+7]=y[fe[1]],R.array[q+8]=y[fe[2]],q+=9}else if(4===R.size)if(void 0===R.boundTo||"vertices"===R.boundTo)for(o=0,a=ue.length;o<a;o++)s=he[ue[o]],g=R.value[s.a],v=R.value[s.b],y=R.value[s.c],R.array[q]=g.x,R.array[q+1]=g.y,R.array[q+2]=g.z,R.array[q+3]=g.w,R.array[q+4]=v.x,R.array[q+5]=v.y,R.array[q+6]=v.z,R.array[q+7]=v.w,R.array[q+8]=y.x,R.array[q+9]=y.y,R.array[q+10]=y.z,R.array[q+11]=y.w,q+=12;else if("faces"===R.boundTo)for(o=0,a=ue.length;o<a;o++)g=L=R.value[ue[o]],v=L,y=L,R.array[q]=g.x,R.array[q+1]=g.y,R.array[q+2]=g.z,R.array[q+3]=g.w,R.array[q+4]=v.x,R.array[q+5]=v.y,R.array[q+6]=v.z,R.array[q+7]=v.w,R.array[q+8]=y.x,R.array[q+9]=y.y,R.array[q+10]=y.z,R.array[q+11]=y.w,q+=12;else if("faceVertices"===R.boundTo)for(o=0,a=ue.length;o<a;o++)g=(L=R.value[ue[o]])[0],v=L[1],y=L[2],R.array[q]=g.x,R.array[q+1]=g.y,R.array[q+2]=g.z,R.array[q+3]=g.w,R.array[q+4]=v.x,R.array[q+5]=v.y,R.array[q+6]=v.z,R.array[q+7]=v.w,R.array[q+8]=y.x,R.array[q+9]=y.y,R.array[q+10]=y.z,R.array[q+11]=y.w,q+=12;O.bindBuffer(O.ARRAY_BUFFER,R.buffer),O.bufferData(O.ARRAY_BUFFER,R.array,n)}i&&(delete e.__inittedArrays,delete e.__colorArray,delete e.__normalArray,delete e.__tangentArray,delete e.__uvArray,delete e.__uv2Array,delete e.__faceArray,delete e.__vertexArray,delete e.__lineArray,delete e.__skinIndexArray,delete e.__skinWeightArray)}}function ut(e){var t;if(e.streamingDraw){if(!e.streamingIndex){var n=e.index;n&&(n.buffer=O.createBuffer(),O.bindBuffer(O.ELEMENT_ARRAY_BUFFER,n.buffer),O.bufferData(O.ELEMENT_ARRAY_BUFFER,n.array||e.ib,O.STATIC_DRAW))}}else{e.vb&&void 0===e.vbbuffer&&(e.vbbuffer=O.createBuffer(),e.vbNeedsUpdate=!0);var i=e.ib||(null===(t=e.index)||void 0===t?void 0:t.array);i&&void 0===e.ibbuffer&&(e.ibbuffer=O.createBuffer(),O.bindBuffer(O.ELEMENT_ARRAY_BUFFER,e.ibbuffer),O.bufferData(O.ELEMENT_ARRAY_BUFFER,i,O.STATIC_DRAW)),e.iblines&&void 0===e.iblinesbuffer&&(e.iblinesbuffer=O.createBuffer(),O.bindBuffer(O.ELEMENT_ARRAY_BUFFER,e.iblinesbuffer),O.bufferData(O.ELEMENT_ARRAY_BUFFER,e.iblines,O.STATIC_DRAW));for(var r=e.attributes,o=Object.keys(e.attributes),a=0,s=o.length;a<s;a++){var l=o[a],c=r[l],u="index"===l;if(c.array&&void 0===c.buffer&&(c.buffer=O.createBuffer(),c.needsUpdate=!0),st(c)){var h=u?O.ELEMENT_ARRAY_BUFFER:O.ARRAY_BUFFER;O.bindBuffer(h,c.buffer),O.bufferData(h,c.array,O.STATIC_DRAW),lt(c)}}e.vbNeedsUpdate&&(O.bindBuffer(O.ARRAY_BUFFER,e.vbbuffer),O.bufferData(O.ARRAY_BUFFER,e.vb,O.STATIC_DRAW),e.vbNeedsUpdate=!1,e.discardAfterUpload&&(e.vb=null))}}function ht(e){N?O.bindVertexArray(e):U.bindVertexArrayOES(e)}function dt(e){N?O.deleteVertexArray(e):U.deleteVertexArrayOES(e)}function pt(e,t,n){N?O.vertexAttribDivisor(e,t&&n||0):F&&F.vertexAttribDivisorANGLE(e,t&&n||0)}function ft(e,t,n,i,r){N?O.drawElementsInstanced(e,t,n,i,r):F.drawElementsInstancedANGLE(e,t,n,i,r)}function mt(e,t,n,i){var r,o,a;if(!c.USE_VAO||n.streamingDraw)return n.vaos=null,!1;if(!N&&!U)return n.vaos=null,!1;if(void 0===n.vaos&&(n.vaos=[]),a=N?O.createVertexArray():U.createVertexArrayOES(),n.vaos.push({geomhash:t.id,uv:i,vao:a}),ht(a),e.isEdgeMaterial)O.bindBuffer(O.ELEMENT_ARRAY_BUFFER,n.iblinesbuffer);else{var s=n.index;s&&O.bindBuffer(O.ELEMENT_ARRAY_BUFFER,n.ibbuffer||s.buffer)}for(var l=null,u=t.attributes,h=t.attributesKeys,d=n.vbstride,p=(null===(r=n.groups)||void 0===r?void 0:r.length)?n.groups[0].index:0,f=(null===(o=n.groups)||void 0===o?void 0:o.length)&&n.groups[0].instanceStart||0,m=0,g=h.length;m<g;m++){var v=h[m],y=u[v];if(y>=0){var b=n.attributes[v];if("uv"===v&&i&&(b=n.attributes["uv"+(i+1)]),!b){ht(null);for(var _=0;_<n.vaos.length;_++)dt(n.vaos[_].vao);return n.vaos=null,!1}var x=O.FLOAT,E=b.bytesPerItem||4;1===E?x=O.UNSIGNED_BYTE:2===E&&(x=O.UNSIGNED_SHORT),O.enableVertexAttribArray(y);var w=p;b.divisor&&(w+=f),void 0!==b.itemOffset?(l!=n.vbbuffer&&(O.bindBuffer(O.ARRAY_BUFFER,n.vbbuffer),l=n.vbbuffer),O.vertexAttribPointer(y,b.itemSize,x,b.normalized,4*d,4*(b.itemOffset+w*d))):(O.bindBuffer(O.ARRAY_BUFFER,b.buffer),l=b.buffer,O.vertexAttribPointer(y,b.itemSize,x,b.normalized,0,w*b.itemSize*E)),pt(y,n.numInstances,b.divisor)}}return!0}function gt(e,t){var n=ae[e];return n||(n=O.createBuffer(),ae[e]=n),O.bindBuffer(O.ARRAY_BUFFER,n),O.bufferData(O.ARRAY_BUFFER,t,O.DYNAMIC_DRAW),n}function vt(e,t,n,i,r,o,a){var s,l=t.attributes,c=t.attributesKeys,u=0;if(r)if(!r.buffer&&n.streamingDraw){var h=ae.index;h||(h=O.createBuffer(),ae.index=h),O.bindBuffer(O.ELEMENT_ARRAY_BUFFER,h),e.isEdgeMaterial?O.bufferData(O.ELEMENT_ARRAY_BUFFER,n.iblines,O.DYNAMIC_DRAW):O.bufferData(O.ELEMENT_ARRAY_BUFFER,r.array||n.ib,O.DYNAMIC_DRAW)}else e.isEdgeMaterial?O.bindBuffer(O.ELEMENT_ARRAY_BUFFER,n.iblinesbuffer):O.bindBuffer(O.ELEMENT_ARRAY_BUFFER,n.ibbuffer||r.buffer);for(var d=0,p=c.length;d<p;d++){var f=c[d],m=l[f];if(m>=0){var g=n.attributes[f];if("uv"===f&&o&&(g=n.attributes["uv"+(o+1)]),g){var v,y,b=void 0!==g.itemOffset;b?(v=n.vbstride,y=g.itemOffset,u!==s&&(n.streamingDraw?u=gt("interleavedVB",n.vb):(u=n.vbbuffer,O.bindBuffer(O.ARRAY_BUFFER,u)),s=u)):(v=g.itemSize,y=0,n.streamingDraw?u=gt(f,g.array):(u=g.buffer,O.bindBuffer(O.ARRAY_BUFFER,u)));var _=O.FLOAT,x=g.bytesPerItem||4;1===x?_=O.UNSIGNED_BYTE:2===x&&(_=O.UNSIGNED_SHORT),b&&(x=4),z.enableAttribute(m);var E=i;g.divisor&&(E+=a),O.vertexAttribPointer(m,g.itemSize,_,g.normalized,v*x,(y+E*v)*x),pt(m,n.numInstances,g.divisor)}else if(e.defaultAttributeValues){var w=e.defaultAttributeValues[f];w&&2===w.length?O.vertexAttrib2fv(m,e.defaultAttributeValues[f]):w&&3===w.length?O.vertexAttrib3fv(m,e.defaultAttributeValues[f]):w&&4===w.length&&O.vertexAttrib4fv(m,e.defaultAttributeValues[f])}}}z.disableUnusedAttributes()}function yt(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.z!==t.z?e.z-t.z:e.id-t.id}function bt(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?t.z-e.z:e.id-t.id}this.renderBufferDirect=function(e,t,n,i,r,o,a){var s;if(H.lostContextRecovery&&H.lostContextRecovery.refreshIfNeeded(r),!1!==i.visible&&(!i.isEdgeMaterial||r.iblines)){ut(o.geometry);var c=Xt(e,t,n,i,o),u=!1,h=i.wireframe?1:0,d="direct_"+r.id+(a?"/"+a:"")+"_"+c.id+"_"+h;d!==Z&&(Z=d,u=!0);var p,f=null===(s=r.groups)||void 0===s?void 0:s.length,m=f&&r.groups.some((function(e){return e.index>=0||e.instanceStart>=0}));m?u=!0:(p=function(e,t,n,i){var r=n.vaos;if(r)for(var o=0,a=r.length;o<a;o++){var s=r[o];if(s.geomhash===t.id&&s.uv===i)return ht(s.vao),!0}else if(null===r)return!1;return mt(e,t,n,i)}(i,c,r,a||0),u=u&&!p),u&&z.initAttributes();var g,v=r.index;if(v){var y,b,_=v.array?v.array:r.ib;i.isEdgeMaterial&&(v=r.attributes.indexlines,_=r.iblines),v.bytesPerItem?4===(b=v.bytesPerItem)&&!N&&B.get("OES_element_index_uint"):b=_ instanceof Uint32Array&&(N||B.get("OES_element_index_uint"))?4:2,y=4===b?O.UNSIGNED_INT:O.UNSIGNED_SHORT;var x=r.groups;f&&i.isEdgeMaterial&&!Object.prototype.hasOwnProperty.call(x[0],"edgeStart")&&(x=null);var E=0;do{var w,S,A,M,T;if(f){var C=x[E];w=C.index,S=i.isEdgeMaterial?C.edgeStart||0:C.start,A=i.isEdgeMaterial?C.edgeCount||_.length:C.count,M=C.instanceStart||0,T=C.numInstances||r.numInstances;var P=i.program.uniforms;if(P.themingColor&&"themingColor"in C){var L=C.themingColor;L instanceof l.Vector4?O.uniform4f(P.themingColor,L.x,L.y,L.z,L.w):O.uniform4f(P.themingColor,0,0,0,0)}}else w=0,S=0,A=_.length,M=0,T=r.numInstances;u&&(vt(i,c,r,w,v,a,M),m||(u=!1)),g=O.TRIANGLES,r.isPoints?g=O.POINTS:(r.isLines||i.isEdgeMaterial)&&(g=O.LINES),T?ft(g,A,y,S*b,T):O.drawElements(g,A,y,S*b)}while(x&&++E<x.length)}else{var R;(null===(R=r.groups)||void 0===R?void 0:R.length)>1&&console.error("Geometry with draw calls and no index buffer"),u&&vt(i,c,r,0,void 0,a,0);var D=r.attributes.position;g=O.TRIANGLES,r.isPoints?g=O.POINTS:(r.isLines||i.isEdgeMaterial)&&(g=O.LINES),r.numInstances?function(e,t,n,i){N?O.drawArraysInstanced(e,t,n,i):F.drawArraysInstancedANGLE(e,t,n,i)}(g,0,D.array.length/3,r.numInstances):O.drawArrays(g,0,D.array.length/D.itemSize)}p&&ht(null)}},this.renderBuffer=function(e,t,n,i,r,o){if(!1!==i.visible&&!i.isEdgeMaterial){!function(e){var t,n,i=e.geometry;if(i instanceof l.BufferGeometry)ut(i);else if(e instanceof l.Mesh){!0===i.groupsNeedUpdate&&Vt(e,i);for(var r=Ut[i.id],o=0,a=r.length;o<a;o++){var s=r[o];t=(n=nt(e,s)).attributes&&zt(n),(i.verticesNeedUpdate||i.morphTargetsNeedUpdate||i.elementsNeedUpdate||i.uvsNeedUpdate||i.normalsNeedUpdate||i.colorsNeedUpdate||i.tangentsNeedUpdate||t)&&ct(s,e,O.DYNAMIC_DRAW,!i.dynamic,n)}i.verticesNeedUpdate=!1,i.morphTargetsNeedUpdate=!1,i.elementsNeedUpdate=!1,i.uvsNeedUpdate=!1,i.normalsNeedUpdate=!1,i.colorsNeedUpdate=!1,i.tangentsNeedUpdate=!1,n.attributes&&Ht(n)}else e instanceof l.Line?(t=(n=nt(e,i)).attributes&&zt(n),(i.verticesNeedUpdate||i.colorsNeedUpdate||i.lineDistancesNeedUpdate||t)&&function(e,t){var n,i,r,o,a,s,l,c,u,h,d,p,f=e.vertices,m=e.colors,g=e.lineDistances,v=f.length,y=m.length,b=g.length,_=e.__vertexArray,x=e.__colorArray,E=e.__lineDistanceArray,w=e.verticesNeedUpdate,S=e.colorsNeedUpdate,A=e.lineDistancesNeedUpdate,M=e.__webglCustomAttributesList;if(w){for(n=0;n<v;n++)o=f[n],_[a=3*n]=o.x,_[a+1]=o.y,_[a+2]=o.z;O.bindBuffer(O.ARRAY_BUFFER,e.__webglVertexBuffer),O.bufferData(O.ARRAY_BUFFER,_,t)}if(S){for(i=0;i<y;i++)s=m[i],x[a=3*i]=s.r,x[a+1]=s.g,x[a+2]=s.b;O.bindBuffer(O.ARRAY_BUFFER,e.__webglColorBuffer),O.bufferData(O.ARRAY_BUFFER,x,t)}if(A){for(r=0;r<b;r++)E[r]=g[r];O.bindBuffer(O.ARRAY_BUFFER,e.__webglLineDistanceBuffer),O.bufferData(O.ARRAY_BUFFER,E,t)}if(M)for(l=0,c=M.length;l<c;l++)if(st(p=M[l])&&(void 0===p.boundTo||"vertices"===p.boundTo)){if(a=0,h=p.value.length,1===p.size)for(u=0;u<h;u++)p.array[u]=p.value[u];else if(2===p.size)for(u=0;u<h;u++)d=p.value[u],p.array[a]=d.x,p.array[a+1]=d.y,a+=2;else if(3===p.size)if("c"===p.type)for(u=0;u<h;u++)d=p.value[u],p.array[a]=d.r,p.array[a+1]=d.g,p.array[a+2]=d.b,a+=3;else for(u=0;u<h;u++)d=p.value[u],p.array[a]=d.x,p.array[a+1]=d.y,p.array[a+2]=d.z,a+=3;else if(4===p.size)for(u=0;u<h;u++)d=p.value[u],p.array[a]=d.x,p.array[a+1]=d.y,p.array[a+2]=d.z,p.array[a+3]=d.w,a+=4;O.bindBuffer(O.ARRAY_BUFFER,p.buffer),O.bufferData(O.ARRAY_BUFFER,p.array,t)}}(i,O.DYNAMIC_DRAW),i.verticesNeedUpdate=!1,i.colorsNeedUpdate=!1,i.lineDistancesNeedUpdate=!1,n.attributes&&Ht(n)):e instanceof l.PointCloud&&(t=(n=nt(e,i)).attributes&&zt(n),(i.verticesNeedUpdate||i.colorsNeedUpdate||t)&&function(e,t){var n,i,r,o,a,s,l,c,u,h,d,p=e.vertices,f=e.colors,m=p.length,g=f.length,v=e.__vertexArray,y=e.__colorArray,b=e.verticesNeedUpdate,_=e.colorsNeedUpdate,x=e.__webglCustomAttributesList;if(b){for(n=0;n<m;n++)r=p[n],v[o=3*n]=r.x,v[o+1]=r.y,v[o+2]=r.z;O.bindBuffer(O.ARRAY_BUFFER,e.__webglVertexBuffer),O.bufferData(O.ARRAY_BUFFER,v,t)}if(_){for(i=0;i<g;i++)a=f[i],y[o=3*i]=a.r,y[o+1]=a.g,y[o+2]=a.b;O.bindBuffer(O.ARRAY_BUFFER,e.__webglColorBuffer),O.bufferData(O.ARRAY_BUFFER,y,t)}if(x)for(s=0,l=x.length;s<l;s++)if(st(d=x[s])&&(void 0===d.boundTo||"vertices"===d.boundTo)){if(o=0,u=d.value.length,1===d.size)for(c=0;c<u;c++)d.array[c]=d.value[c];else if(2===d.size)for(c=0;c<u;c++)h=d.value[c],d.array[o]=h.x,d.array[o+1]=h.y,o+=2;else if(3===d.size)if("c"===d.type)for(c=0;c<u;c++)h=d.value[c],d.array[o]=h.r,d.array[o+1]=h.g,d.array[o+2]=h.b,o+=3;else for(c=0;c<u;c++)h=d.value[c],d.array[o]=h.x,d.array[o+1]=h.y,d.array[o+2]=h.z,o+=3;else if(4===d.size)for(c=0;c<u;c++)h=d.value[c],d.array[o]=h.x,d.array[o+1]=h.y,d.array[o+2]=h.z,d.array[o+3]=h.w,o+=4;O.bindBuffer(O.ARRAY_BUFFER,d.buffer),O.bufferData(O.ARRAY_BUFFER,d.array,t)}}(i,O.DYNAMIC_DRAW),i.verticesNeedUpdate=!1,i.colorsNeedUpdate=!1,n.attributes&&Ht(n))}(o);var a=Xt(e,t,n,i,o),s=a.attributes,c=!1,u=i.wireframe?1:0,h=r.id+"_"+a.id+"_"+u;if(h!==Z&&(Z=h,c=!0),c&&z.initAttributes(),!i.morphTargets&&s.position>=0&&c&&(O.bindBuffer(O.ARRAY_BUFFER,r.__webglVertexBuffer),z.enableAttribute(s.position),v(s.position,3,O.FLOAT,!1,0,0)),c){if(r.__webglCustomAttributesList)for(var d=0,p=r.__webglCustomAttributesList.length;d<p;d++){var f=r.__webglCustomAttributesList[d];s[f.buffer.belongsToAttribute]>=0&&(O.bindBuffer(O.ARRAY_BUFFER,f.buffer),z.enableAttribute(s[f.buffer.belongsToAttribute]),v(s[f.buffer.belongsToAttribute],f.size,O.FLOAT,!1,0,0))}s.color>=0&&(o.geometry.colors.length>0||o.geometry.faces.length>0?(O.bindBuffer(O.ARRAY_BUFFER,r.__webglColorBuffer),z.enableAttribute(s.color),v(s.color,3,O.FLOAT,!1,0,0)):i.defaultAttributeValues&&O.vertexAttrib3fv(s.color,i.defaultAttributeValues.color)),s.normal>=0&&(O.bindBuffer(O.ARRAY_BUFFER,r.__webglNormalBuffer),z.enableAttribute(s.normal),v(s.normal,3,O.FLOAT,!1,0,0)),s.tangent>=0&&(O.bindBuffer(O.ARRAY_BUFFER,r.__webglTangentBuffer),z.enableAttribute(s.tangent),v(s.tangent,4,O.FLOAT,!1,0,0)),s.uv>=0&&(o.geometry.faceVertexUvs[0]?(O.bindBuffer(O.ARRAY_BUFFER,r.__webglUVBuffer),z.enableAttribute(s.uv),v(s.uv,2,O.FLOAT,!1,0,0)):i.defaultAttributeValues&&O.vertexAttrib2fv(s.uv,i.defaultAttributeValues.uv)),s.uv2>=0&&(o.geometry.faceVertexUvs[1]?(O.bindBuffer(O.ARRAY_BUFFER,r.__webglUV2Buffer),z.enableAttribute(s.uv2),v(s.uv2,2,O.FLOAT,!1,0,0)):i.defaultAttributeValues&&O.vertexAttrib2fv(s.uv2,i.defaultAttributeValues.uv2)),s.lineDistance>=0&&(O.bindBuffer(O.ARRAY_BUFFER,r.__webglLineDistanceBuffer),z.enableAttribute(s.lineDistance),v(s.lineDistance,1,O.FLOAT,!1,0,0))}if(z.disableUnusedAttributes(),o instanceof l.Mesh){var m=r.__typeArray===Uint32Array?O.UNSIGNED_INT:O.UNSIGNED_SHORT;i.wireframe?(V.setLineWidth(i.wireframeLinewidth*this.getPixelRatio()),c&&O.bindBuffer(O.ELEMENT_ARRAY_BUFFER,r.__webglLineBuffer),O.drawElements(O.LINES,r.__webglLineCount,m,0)):(c&&O.bindBuffer(O.ELEMENT_ARRAY_BUFFER,r.__webglFaceBuffer),O.drawElements(O.TRIANGLES,r.__webglFaceCount,m,0))}else if(o instanceof l.Line){var g=o.mode===l.LineStrip?O.LINE_STRIP:O.LINES;V.setLineWidth(i.linewidth*this.getPixelRatio()),O.drawArrays(g,0,r.__webglLineCount)}else o instanceof l.PointCloud&&O.drawArrays(O.POINTS,0,r.__webglPointCount)}function v(e,t,n,i,r,o){O.vertexAttribPointer(e,t,n,i,r,o),F&&F.vertexAttribDivisorANGLE(e,0)}};var _t=null,xt=[];var Et,wt,St,At,Mt=new l.WebGLAnimation;function Tt(e){Pt(e,!0)}function Ct(e){Pt(e,!1)}function Pt(e,t,n){var i,r;if(n||!1!==e.visible){if(e instanceof l.Scene||e instanceof l.Group);else if(e instanceof a.RenderBatch)e.forEach(t?Tt:Ct);else if(function(e){H.lostContextRecovery&&H.lostContextRecovery.refreshIfNeeded(e),void 0===e.__webglInit&&(e.__webglInit=!0,e.addEventListener("removed",We));var t=e.geometry;void 0===t||void 0===t.__webglInit&&(t.__webglInit=!0,t.addEventListener("dispose",je),t instanceof l.BufferGeometry||(e instanceof l.Mesh?Vt(e,t):e instanceof l.Line?void 0===t.__webglVertexBuffer&&(!function(e){e.__webglVertexBuffer=O.createBuffer(),e.__webglColorBuffer=O.createBuffer(),e.__webglLineDistanceBuffer=O.createBuffer(),H.info.memory.geometries++}(t),function(e,t){var n=e.vertices.length;e.__vertexArray=new Float32Array(3*n),e.__colorArray=new Float32Array(3*n),e.__lineDistanceArray=new Float32Array(1*n),e.__webglLineCount=n,et(e,t)}(t,e),t.verticesNeedUpdate=!0,t.colorsNeedUpdate=!0,t.lineDistancesNeedUpdate=!0):e instanceof l.PointCloud&&void 0===t.__webglVertexBuffer&&(!function(e){e.__webglVertexBuffer=O.createBuffer(),e.__webglColorBuffer=O.createBuffer(),H.info.memory.geometries++}(t),function(e,t){var n=e.vertices.length;e.__vertexArray=new Float32Array(3*n),e.__colorArray=new Float32Array(3*n),e.__webglPointCount=n,et(e,t)}(t,e),t.verticesNeedUpdate=!0,t.colorsNeedUpdate=!0)));if(void 0===e.__webglActive)if(e.__webglActive=!0,e instanceof l.Mesh){if(t instanceof l.BufferGeometry)Gt(T,t,e);else if(t instanceof l.Geometry)for(var n=Ut[t.id],i=0,r=n.length;i<r;i++)Gt(T,n[i],e)}else(e instanceof l.Line||e instanceof l.PointCloud)&&Gt(T,t,e)}(e),e instanceof l.Light)M.push(e);else{var o=T[e.id];if(o&&(!1===e.frustumCulled||!0===se.intersectsObject(e)))for(i=0,r=o.length;i<r;i++){var s=o[i];Ft(s),s.render=!0,!0===t&&(ue.setFromMatrixPosition(e.matrixWorld),ue=(0,u.r)(ue,le),s.z=ue.z)}}if(e.children)for(i=0,r=e.children.length;i<r;i++)Pt(e.children[i],t,n)}}function Lt(e,t){if(!t.getCustomOverrideMaterial)return t;var n=t.getCustomOverrideMaterial(e);return n||t}function Rt(e,t,n,i,r,o,a){if(e.twoPassTransparency){var s=e.side;e.side=l.BackSide,It(e,t,n,i,r,o,a),e.side=l.FrontSide,It(e,t,n,i,r,o,a),e.side=s}else It(e,t,n,i,r,o,a)}function Dt(e,t,n,i,r){for(var o,a=0,s=e.length;a<s;a++){var l=e[a],c=l.object,u=l.buffer;if(r)o=Lt(l.material,r);else{if(!(o=l.material))continue;qt(o)}if(t.isArrayCamera)for(var h=t.cameras,d=0,p=h.length;d<p;d++){var f=h[d];c.layers.test(f.layers)&&(V.viewport(oe.copy(f.viewport)),O.viewport(oe.x,oe.y,oe.z,oe.w),Rt(o,f,n,i,u,r,c))}else Rt(o,t,n,i,u,r,c)}}function It(e,t,n,i,r,o,a){if(H.setMaterialFaces(e),r instanceof l.BufferGeometry?H.renderBufferDirect(t,n,i,e,r,a):H.renderBuffer(t,n,i,e,r,a),e.decals)for(var s=e.decals,c=0,u=s.length;c<u;c++){var h=s[c];qt(e=h.material),H.setMaterialFaces(e),r instanceof l.BufferGeometry&&H.renderBufferDirect(t,n,i,e,r,a,h.uv)}}function Ot(e,t){if(e.visible&&!e.hide){var n;if(At)n=Lt(e.material,At);else{if(!(n=e.material))return;qt(n)}if(n.twoPassTransparency){var i=n.side;n.side=l.BackSide,Nt(e,n),n.side=l.FrontSide,Nt(e,n),n.side=i}else Nt(e,n)}}function Nt(e,t){if(H.setMaterialFaces(t),H.renderBufferDirect(Et,wt,St,t,e.geometry,e),t.decals)for(var n=t.decals,i=0,r=n.length;i<r;i++){var o=n[i];qt(t=o.material),H.setMaterialFaces(t),H.renderBufferDirect(Et,wt,St,t,e.geometry,e,o.uv)}}function kt(e,t,n,i,r,o){if(wt=i,St=r,At=o||null,n.isArrayCamera)for(var a=0;a<n.cameras.length;a++)Et=n.cameras[a],V.viewport(oe.copy(Et.viewport)),O.viewport(oe.x,oe.y,oe.z,oe.w),e.forEach(Ot,e.forceVisible?1:32,!1);else Et=n,e.forEach(Ot,e.forceVisible?1:32,!1)}function Ft(e){var t=e.object,n=e.buffer,i=t.geometry,r=t.material;if(r instanceof l.MeshFaceMaterial){var o=i instanceof l.BufferGeometry?0:n.materialIndex;r=r.materials[o],e.material=r,r.transparent?D.push(e):R.push(e)}else r&&(e.material=r,r.transparent?D.push(e):R.push(e))}Mt.setAnimationLoop((function(e){(null==Ve?void 0:Ve.isPresenting)||_t&&_t(e)})),"undefined"!=typeof window&&Mt.setContext(window),this.setAnimationLoop=function(e){_t=e,null==Ve||Ve.setAnimationLoop(e),null===e?Mt.stop():Mt.start()},this.addAnimationLoop=function(e){xt.push(e),this.setAnimationLoop((function(e,t){var n,i=h(xt);try{for(i.s();!(n=i.n()).done;){(0,n.value)(e,t)}}catch(e){i.e(e)}finally{i.f()}}))},this.removeAnimationLoop=function(e){for(var t=0;t<xt.length;++t)if(xt[t]===e){xt.splice(t,1);break}0===xt.length&&this.setAnimationLoop(null)},null==Ve||Ve.addEventListener("sessionstart",(function(){Mt.stop()})),null==Ve||Ve.addEventListener("sessionend",(function(){Mt.start()})),this.render=function(e,t,n,i,r){var o;if(t instanceof l.Camera!=!1){if(!O.isContextLost()){Z="",Y=-1,K=null,void 0!==r&&(M.length=0,de=!0);var s=e.fog;!0===e.autoUpdate&&e.updateMatrixWorld(),void 0!==t.parent&&null!==t.parent||t.updateMatrixWorld(),Ve&&!0===Ve.enabled&&!0===Ve.isPresenting&&!t.disableXr&&(!0===Ve.cameraAutoUpdate&&Ve.updateCamera(t),t=Ve.getCamera()),t.worldUpTransform?ce.multiplyMatrices(t.worldUpTransform,t.matrixWorld):ce.copy(t.matrixWorld),le.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),se.setFromProjectionMatrix(le);var c=e instanceof a.RenderBatch&&e.renderImmediate;if(c||(R.length=0,D.length=0,Pt(e,!0===H.sortObjects,!0===e.forceVisible),!0===H.sortObjects&&(R.sort(bt),D.sort(yt))),de&&(r&&r.length&&(M=r.slice()),en(M)),this.setRenderTarget(n),this.resetGLState(),(this.autoClear||i)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),e.overrideMaterial){var u=e.overrideMaterial;qt(u),c?kt(e,"",t,M,s,u):(Dt(R,t,M,s,u),Dt(D,t,M,s,u))}else c?kt(e,"",t,M,s,null):(V.setBlending(l.NoBlending),Dt(R,t,M,s,null),Dt(D,t,M,s,null));if(e.edgeMaterial){O.depthFunc(O.LESS);var h=e.edgeMaterial;qt(h),c?kt(e,"",t,M,s,h):(Dt(R,t,M,s,h),Dt(D,t,M,s,h)),O.depthFunc(O.LEQUAL)}(null==n||null===(o=n.texture)||void 0===o?void 0:o.generateMipmaps)&&n.texture.minFilter!==l.NearestFilter&&n.texture.minFilter!==l.LinearFilter&&function(e){O.bindTexture(O.TEXTURE_2D,e.__webglTexture),O.generateMipmap(O.TEXTURE_2D),O.bindTexture(O.TEXTURE_2D,null)}(n),this.resetGLState(),V.buffers.depth.setTest(!0),V.buffers.depth.setMask(!0)}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.clearBlend=function(){V.setBlending(l.NoBlending)},this.setProgramPrefix=function(e,t,n){J=e,Q=t,$=n},this.getProgramPrefix=function(){return{programPrefix:J,vertexPrefix:Q,fragmentPrefix:$}},this.updateTimestamp=function(e){L=e};var Ut={},Bt=0;function Vt(e,t){var n=e.material,i=!1;void 0!==Ut[t.id]&&!0!==t.groupsNeedUpdate||(delete T[e.id],Ut[t.id]=function(e,t){for(var n,i,r=N||B.get("OES_element_index_uint")?4294967296:65535,o={},a=e.morphTargets?e.morphTargets.length:0,s=e.morphNormals?e.morphNormals.length:0,l={},c=[],u=0,h=e.faces.length;u<h;u++){var d=e.faces[u],p=t?d.materialIndex:0;p in o||(o[p]={hash:p,counter:0}),(n=o[p].hash+"_"+o[p].counter)in l||(i={id:Bt++,faces3:[],materialIndex:p,vertices:0,numMorphTargets:a,numMorphNormals:s},l[n]=i,c.push(i)),l[n].vertices+3>r&&(o[p].counter+=1,(n=o[p].hash+"_"+o[p].counter)in l||(i={id:Bt++,faces3:[],materialIndex:p,vertices:0,numMorphTargets:a,numMorphNormals:s},l[n]=i,c.push(i))),l[n].faces3.push(u),l[n].vertices+=3}return c}(t,n instanceof l.MeshFaceMaterial),t.groupsNeedUpdate=!1);for(var r=Ut[t.id],o=0,a=r.length;o<a;o++){var s=r[o];void 0===s.__webglVertexBuffer?(He(s),tt(s,e),t.verticesNeedUpdate=!0,t.morphTargetsNeedUpdate=!0,t.elementsNeedUpdate=!0,t.uvsNeedUpdate=!0,t.normalsNeedUpdate=!0,t.tangentsNeedUpdate=!0,t.colorsNeedUpdate=!0,i=!0):i=!1,(i||void 0===e.__webglActive)&&Gt(T,s,e)}e.__webglActive=!0}function Gt(e,t,n){var i=n.id;e[i]=e[i]||[],e[i].push({id:i,buffer:t,object:n,material:null,z:0})}function zt(e){for(var t in e.attributes)if(st(e.attributes[t]))return!0;return!1}function Ht(e){for(var t in e.attributes)lt(e.attributes[t])}var Wt={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"firefly_basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"firefly_phong",LineBasicMaterial:"firefly_basic",LineDashedMaterial:"dashed",PointCloudMaterial:"firefly_basic",PointsMaterial:"firefly_basic"};function jt(e,t,n,r){e.addEventListener("dispose",Ye);var o=Wt[e.type];if(o){var a=l.ShaderLib[o],s=l.UniformsUtils.clone(a.uniforms);e.uniforms&&(s=l.UniformsUtils.merge([s,e.uniforms])),e.__webglShader={uniforms:s,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader}}else e.__webglShader={uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};var c,u,h=function(e){for(var t=0,n=0,i=0,r=0,o=0,a=e.length;o<a;o++){var s=e[o];s.onlyShadow||(s instanceof l.DirectionalLight&&t++,s instanceof l.PointLight&&n++,s instanceof l.SpotLight&&i++,s instanceof l.HemisphereLight&&r++)}return{directional:t,point:n,spot:i,hemi:r}}(t),p={vertexShader:e.__webglShader.vertexShader,fragmentShader:e.__webglShader.fragmentShader,precision:d,precisionFragment:v,supportsVertexTextures:Te,haveTextureLod:N||!!B.get("EXT_shader_texture_lod"),loadingAnimationDuration:I,map:!!e.map,envMap:!!e.envMap,irradianceMap:!!e.irradianceMap,envIsSpherical:e.envMap&&e.envMap.mapping==l.SphericalReflectionMapping,envGammaEncoded:e.envMap&&e.envMap.GammaEncoded,irrGammaEncoded:e.irradianceMap&&e.irradianceMap.GammaEncoded,envRGBM:e.envMap&&e.envMap.RGBM,irrRGBM:e.irradianceMap&&e.irradianceMap.RGBM,lightMap:!!e.lightMap,bumpMap:(N||B.get("OES_standard_derivatives"))&&!!e.bumpMap,normalMap:(N||B.get("OES_standard_derivatives"))&&!!e.normalMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,vertexColors:e.vertexColors,vertexIds:e.vertexIds,useInstancing:e.useInstancing,wideLines:e.wideLines,fog:n,useFog:e.fog,useBackgroundTexture:e.useBackgroundTexture,sizeAttenuation:e.sizeAttenuation,maxDirLights:h.directional,maxPointLights:h.point,maxSpotLights:h.spot,maxHemiLights:h.hemi,alphaTest:e.alphaTest,metal:e.metal,clearcoat:e.clearcoat,doubleSided:e.side===l.DoubleSide,flipSided:e.side===l.BackSide,mrtNormals:e.mrtNormals,mrtIdBuffer:e.mrtIdBuffer,vertexPrefix:Q,fragmentPrefix:$,tonemapOutput:e.tonemapOutput,packedNormals:e.packedNormals,hatchPattern:!!e.hatchParams,numCutplanes:e.cutplanes?e.cutplanes.length:0,useTiling:e.useTiling,tilingRepeatRange:e.useTiling&&e.tilingRepeatRange,hasRoundCorner:e.hasRoundCorner,useRandomOffset:e.useRandomOffset,mapInvert:e.map&&e.map.invert,mapClampS:e.map&&e.map.clampS,mapClampT:e.map&&e.map.clampT,bumpMapClampS:e.bumpMap&&e.bumpMap.clampS,bumpMapClampT:e.bumpMap&&e.bumpMap.clampT,normalMapClampS:e.normalMap&&e.normalMap.clampS,normalMapClampT:e.normalMap&&e.normalMap.clampT,specularMapClampS:e.specularMap&&e.specularMap.clampS,specularMapClampT:e.specularMap&&e.specularMap.clampT,alphaMapInvert:e.alphaMap&&e.alphaMap.invert,alphaMapClampS:e.alphaMap&&e.alphaMap.clampS,alphaMapClampT:e.alphaMap&&e.alphaMap.clampT},f=[];for(var m in o?f.push(o):(f.push(e.fragmentShader),f.push(e.vertexShader)),e.defines)f.push(m),f.push(e.defines[m]);for(c in p)f.push(c),f.push(p[c]);var g,y=f.join();for(c=0,u=W.length;c<u;c++){var b=W[c];if(b.code===y){(g=b).usedTimes++;break}}for(var _ in void 0===g&&(e.onBeforeCompile(p,H),g=new i.WebGLProgram(H,y,e,p),W.push(g),H.info.memory.programs=W.length),e.programs||(e.programs=[]),e.programs[J]=g,e.uniformsLists||(e.uniformsLists=[]),e.uniformsList=e.uniformsLists[J]=[],e.__webglShader.uniforms){var x=g.uniforms[_];x&&e.uniformsList.push([e.__webglShader.uniforms[_],x])}}function qt(e){!0===e.transparent?V.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha):V.setBlending(l.NoBlending),V.buffers.depth.setTest(e.depthTest),V.buffers.depth.setTest(e.depthWrite),V.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)}function Xt(e,t,n,i,o){ee=0,H.lostContextRecovery&&H.lostContextRecovery.refreshIfNeeded(i),i.needsUpdate?(i.program&&$e(i),jt(i,t,n),i.needsUpdate=!1):i.programs&&i.programs[J]||jt(i,t,n);var a=!1,s=!1,c=!1;i.uniformsList=i.uniformsLists[J];var u,h=i.program=i.programs[J],d=h.uniforms,p=i.__webglShader.uniforms;if(h.id!==j&&(O.useProgram(h.program),j=h.id,a=!0,s=!0,c=!0),i.id!==Y&&(-1===Y&&(c=!0),Y=i.id,s=!0),d.meshAnimTime){var m=1;o.geometry.creationTime&&I>0&&(m=Math.min((L-o.geometry.creationTime)/I,1)),O.uniform1f(d.meshAnimTime,m)}if((a||e!==K)&&(O.uniformMatrix4fv(d.projectionMatrix,!1,e.projectionMatrix.elements),e!==K&&(K=e),(i instanceof l.ShaderMaterial||i instanceof l.MeshPhongMaterial||i.envMap)&&null!==d.cameraPosition&&(ue.setFromMatrixPosition(e.matrixWorld),O.uniform3f(d.cameraPosition,ue.x,ue.y,ue.z)),(i instanceof l.MeshPhongMaterial||i instanceof l.MeshLambertMaterial||i instanceof l.ShaderMaterial||i.skinning)&&(null!==d.viewMatrix&&O.uniformMatrix4fv(d.viewMatrix,!1,e.matrixWorldInverse.elements),null!==d.viewMatrixInverse&&O.uniformMatrix4fv(d.viewMatrixInverse,!1,ce.elements),d.mvpMatrix&&O.uniformMatrix4fv(d.mvpMatrix,!1,le.elements),c?(Kt(p,i),Zt(p,!0)):Zt(p,!1))),d.unpackXform){var g=o.geometry,v=g.unpackXform;if(v?O.uniform4f(d.unpackXform,v.x,v.y,v.z,v.w):O.uniform4f(d.unpackXform,1,1,0,0),d.tIdColor){O.uniform2f(d.vIdColorTexSize,g.vIdColorTexSize.x,g.vIdColorTexSize.y);var y=Qt();O.uniform1i(d.tIdColor,y),H.setTexture(g.tIdColor,y)}}if(s){if((i instanceof l.MeshPhongMaterial||i instanceof l.MeshLambertMaterial||i.lights)&&(de&&(c=!0,en(t),de=!1),c?(!function(e,t){e.ambientLightColor.value=t.ambient,e.directionalLightColor.value=t.directional.colors,e.directionalLightDirection.value=t.directional.positions,e.pointLightColor.value=t.point.colors,e.pointLightPosition.value=t.point.positions,e.pointLightDistance.value=t.point.distances,e.spotLightColor.value=t.spot.colors,e.spotLightPosition.value=t.spot.positions,e.spotLightDistance.value=t.spot.distances,e.spotLightDirection.value=t.spot.directions,e.spotLightAngleCos.value=t.spot.anglesCos,e.spotLightExponent.value=t.spot.exponents,e.hemisphereLightSkyColor.value=t.hemi.skyColors,e.hemisphereLightGroundColor.value=t.hemi.groundColors,e.hemisphereLightDirection.value=t.hemi.positions}(p,pe),Jt(p,!0)):Jt(p,!1)),(i instanceof l.MeshBasicMaterial||i instanceof l.MeshLambertMaterial||i instanceof l.MeshPhongMaterial)&&(!function(e,t){e.opacity.value=t.opacity,e.diffuse.value.copy(t.color),e.map.value=t.map,e.lightMap.value=t.lightMap,e.specularMap.value=t.specularMap,e.alphaMap.value=t.alphaMap,t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale);t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale));function n(e,t,n){var i=n.offset,r=n.repeat;if(t){var o=t.value;n.matrix?o.copy(n.matrix):o.identity(),o.elements[6]+=i.x,o.elements[7]+=i.y,o.elements[0]*=r.x,o.elements[3]*=r.x,o.elements[1]*=r.y,o.elements[4]*=r.y}else e.offsetRepeat.value.set(i.x,i.y,r.x,r.y)}t.alphaMap&&n(e,e.texMatrixAlpha,t.alphaMap);var i,r;t.normalMap?i=t.normalMap:t.bumpMap&&(i=t.bumpMap);void 0!==i&&n(e,e.texMatrixBump,i);t.map?r=t.map:t.specularMap&&(r=t.specularMap);void 0!==r&&n(e,e.texMatrix,r);e.envMap.value=t.envMap,e.irradianceMap&&(e.irradianceMap.value=t.irradianceMap);e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio}(p,i),Kt(p,i)),i instanceof l.PointCloudMaterial||i instanceof l.PointsMaterial?function(e,t){Yt(e,t),e.point_size.value=t.size,e.map.value=t.map}(p,i):i instanceof l.LineBasicMaterial?Yt(p,i):i instanceof l.LineDashedMaterial?(Yt(p,i),function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(p,i)):i instanceof l.MeshPhongMaterial?function(e,t){if(e.shininess.value=t.shininess,e.reflMipIndex){var n=Math.log(Math.max(1+1e-10,t.shininess));e.reflMipIndex.value=Math.max(0,-.72134752*n+5.5)}e.emissive&&e.emissive.value.copy(t.emissive);e.specular.value.copy(t.specular),e.exposureBias&&(e.exposureBias.value=t.exposureBias)}(p,i):i instanceof l.MeshLambertMaterial?function(e,t){e.emissive.value.copy(t.emissive),t.wrapAround&&e.wrapRGB.value.copy(t.wrapRGB)}(p,i):i instanceof l.MeshDepthMaterial?(p.mNear.value=e.near,p.mFar.value=e.far,p.opacity.value=i.opacity):i instanceof l.MeshNormalMaterial?p.opacity.value=i.opacity:"function"==typeof i.refreshUniforms&&i.refreshUniforms(p),i.wideLines){var b=o.geometry.lineWidth;void 0!==i.linewidth&&(b=i.linewidth),p.view_size.value=new l.Vector2(f.innerWidth/b,f.innerHeight/b)}r.ShadowRender&&i.shadowMap&&r.ShadowRender.RefreshUniformsShadow(p,i);var _=p.cutplanes;i.cutplanes&&i.cutplanes.length>0&&_&&(_.value=i.cutplanes,_._array&&_._array.length!=4*i.cutplanes&&(_._array=void 0)),i.hatchParams&&p.hatchParams&&(p.hatchParams.value.copy(i.hatchParams),p.hatchTintColor.value.copy(i.hatchTintColor),p.hatchTintIntensity.value=i.hatchTintIntensity),function(e){for(var t,n,i,r=0,o=e.length;r<o;r++){var a=e[r][0];if(!1!==a.needsUpdate&&!a.perObject){var s,c,u=a.type,h=a.value,d=e[r][1];switch(u){case"1i":case"i":O.uniform1i(d,h);break;case"1f":case"f":O.uniform1f(d,h);break;case"2f":O.uniform2f(d,h[0],h[1]);break;case"3f":O.uniform3f(d,h[0],h[1],h[2]);break;case"4f":O.uniform4f(d,h[0],h[1],h[2],h[3]);break;case"1iv":case"iv1":O.uniform1iv(d,h);break;case"3iv":case"iv":O.uniform3iv(d,h);break;case"1fv":case"fv1":O.uniform1fv(d,h);break;case"2fv":O.uniform2fv(d,h);break;case"3fv":case"fv":O.uniform3fv(d,h);break;case"4fv":O.uniform4fv(d,h);break;case"Matrix3fv":O.uniformMatrix3fv(d,!1,h);break;case"Matrix4fv":O.uniformMatrix4fv(d,!1,h);break;case"v2":O.uniform2f(d,h.x,h.y);break;case"v3":O.uniform3f(d,h.x,h.y,h.z);break;case"v4":O.uniform4f(d,h.x,h.y,h.z,h.w);break;case"c":O.uniform3f(d,h.r,h.g,h.b);break;case"v2v":for(void 0===a._array&&(a._array=new Float32Array(2*h.length)),s=0,c=h.length;s<c;s++)i=2*s,a._array[i]=h[s].x,a._array[i+1]=h[s].y;O.uniform2fv(d,a._array);break;case"v3v":for(void 0===a._array&&(a._array=new Float32Array(3*h.length)),s=0,c=h.length;s<c;s++)i=3*s,a._array[i]=h[s].x,a._array[i+1]=h[s].y,a._array[i+2]=h[s].z;O.uniform3fv(d,a._array);break;case"v4v":for(void 0===a._array&&(a._array=new Float32Array(4*h.length)),s=0,c=h.length;s<c;s++)i=4*s,a._array[i]=h[s].x,a._array[i+1]=h[s].y,a._array[i+2]=h[s].z,a._array[i+3]=h[s].w;O.uniform4fv(d,a._array);break;case"m3":O.uniformMatrix3fv(d,!1,h.elements);break;case"m3v":for(void 0===a._array&&(a._array=new Float32Array(9*h.length)),s=0,c=h.length;s<c;s++)h[s].flattenToArrayOffset(a._array,9*s);O.uniformMatrix3fv(d,!1,a._array);break;case"m4":O.uniformMatrix4fv(d,!1,h.elements);break;case"m4v":for(void 0===a._array&&(a._array=new Float32Array(16*h.length)),s=0,c=h.length;s<c;s++)h[s].flattenToArrayOffset(a._array,16*s);O.uniformMatrix4fv(d,!1,a._array);break;case"t":if(t=h,n=Qt(),O.uniform1i(d,n),!t){O.activeTexture(O.TEXTURE0+n),O.bindTexture(O.TEXTURE_2D,Ee.__webglTexture);continue}H.lostContextRecovery&&H.lostContextRecovery.refreshIfNeeded(t),Array.isArray(t.image)&&6===t.image.length||t instanceof l.CubeTexture?st(t)?rn(t,n):(O.activeTexture(O.TEXTURE0+n),O.bindTexture(O.TEXTURE_CUBE_MAP,t.__webglTextureCube)):t instanceof l.WebGLRenderTargetCube?on(t,n):H.setTexture(t,n);break;case"tv":for(void 0===a._array&&(a._array=[]),s=0,c=a.value.length;s<c;s++)a._array[s]=Qt();for(O.uniform1iv(d,a._array),s=0,c=a.value.length;s<c;s++)t=a.value[s],n=a._array[s],t&&(H.lostContextRecovery&&H.lostContextRecovery.refreshIfNeeded(t),H.setTexture(t,n));break;default:console.warn("THREE.WebGLRenderer: Unknown uniform type: "+u)}}}}(i.uniformsList)}if(function(e,t,n){C.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),O.uniformMatrix4fv(e.modelViewMatrix,!1,C.elements),e.normalMatrix&&(P.getNormalMatrix(C),O.uniformMatrix3fv(e.normalMatrix,!1,P.elements));null!==e.modelMatrix&&O.uniformMatrix4fv(e.modelMatrix,!1,t.matrixWorld.elements);e.modelLocalMatrix&&O.uniformMatrix4fv(e.modelLocalMatrix,!1,t.matrix.elements)}(d,o,e),d.modelId){d.dbId&&(u=o.dbId||o.fragId||0,O.uniform3f(d.dbId,(255&u)/255,(u>>8&255)/255,(u>>16&255)/255));var x=o.modelId;O.uniform3f(d.modelId,(255&x)/255,(x>>8&255)/255,(u>>24&255)/255)}else null!==d.dbId&&(u=o.dbId||o.fragId||0,O.uniform3f(d.dbId,(255&u)/255,(u>>8&255)/255,(u>>16&255)/255));if(d.themingColor){var E=o.themingColor;E instanceof l.Vector4?O.uniform4f(d.themingColor,E.x,E.y,E.z,E.w):O.uniform4f(d.themingColor,0,0,0,0)}return h}function Yt(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}function Kt(e,t){e.envMap&&(e.envMap.value=t.envMap),e.irradianceMap&&(e.irradianceMap.value=t.irradianceMap),e.envMapExposure&&(e.envMapExposure.value=t.envMapExposure),e.envRotationSin&&e.envRotationCos&&(e.envRotationSin.value=t.envRotationSin,e.envRotationCos.value=t.envRotationCos)}function Zt(e,t){e.envMap&&(e.envMap.needsUpdate=t),e.irradianceMap&&(e.irradianceMap.needsUpdate=t),e.envMapExposure&&(e.envMapExposure.needsUpdate=t)}function Jt(e,t){e.ambientLightColor.needsUpdate=t,e.directionalLightColor.needsUpdate=t,e.directionalLightDirection.needsUpdate=t,e.pointLightColor.needsUpdate=t,e.pointLightPosition.needsUpdate=t,e.pointLightDistance.needsUpdate=t,e.spotLightColor.needsUpdate=t,e.spotLightPosition.needsUpdate=t,e.spotLightDistance.needsUpdate=t,e.spotLightDirection.needsUpdate=t,e.spotLightAngleCos.needsUpdate=t,e.spotLightExponent.needsUpdate=t,e.hemisphereLightSkyColor.needsUpdate=t,e.hemisphereLightGroundColor.needsUpdate=t,e.hemisphereLightDirection.needsUpdate=t}function Qt(){var e=ee;return e>=we&&console.warn("WebGLRenderer: trying to use "+e+" texture units while this GPU supports only "+we),ee+=1,e}function $t(e,t,n,i){e[t]=n.r*i,e[t+1]=n.g*i,e[t+2]=n.b*i}function en(e){var t,n,i,r,o,a,s,c,u=0,h=0,d=0,p=pe,f=p.directional.colors,m=p.directional.positions,g=p.point.colors,v=p.point.positions,y=p.point.distances,b=p.spot.colors,_=p.spot.positions,x=p.spot.distances,E=p.spot.directions,w=p.spot.anglesCos,S=p.spot.exponents,A=p.hemi.skyColors,M=p.hemi.groundColors,T=p.hemi.positions,C=0,P=0,L=0,R=0,D=0,I=0,O=0,N=0,k=0,F=0,U=0,B=0;for(t=0,n=e.length;t<n;t++)if(!(i=e[t]).onlyShadow)if(r=i.color,s=i.intensity,c=i.distance,i instanceof l.AmbientLight){if(!i.visible)continue;u+=r.r,h+=r.g,d+=r.b}else if(i instanceof l.DirectionalLight){if(D+=1,!i.visible)continue;he.setFromMatrixPosition(i.matrixWorld),ue.setFromMatrixPosition(i.target.matrixWorld),he.sub(ue),he.normalize(),m[k=3*C]=he.x,m[k+1]=he.y,m[k+2]=he.z,$t(f,k,r,s),C+=1}else if(i instanceof l.PointLight){if(I+=1,!i.visible)continue;$t(g,F=3*P,r,s),ue.setFromMatrixPosition(i.matrixWorld),v[F]=ue.x,v[F+1]=ue.y,v[F+2]=ue.z,y[P]=c,P+=1}else if(i instanceof l.SpotLight){if(O+=1,!i.visible)continue;$t(b,U=3*L,r,s),ue.setFromMatrixPosition(i.matrixWorld),_[U]=ue.x,_[U+1]=ue.y,_[U+2]=ue.z,x[L]=c,he.copy(ue),ue.setFromMatrixPosition(i.target.matrixWorld),he.sub(ue),he.normalize(),E[U]=he.x,E[U+1]=he.y,E[U+2]=he.z,w[L]=Math.cos(i.angle),S[L]=i.exponent,L+=1}else if(i instanceof l.HemisphereLight){if(N+=1,!i.visible)continue;he.setFromMatrixPosition(i.matrixWorld),he.normalize(),T[B=3*R]=he.x,T[B+1]=he.y,T[B+2]=he.z,o=i.color,a=i.groundColor,$t(A,B,o,s),$t(M,B,a,s),R+=1}for(t=3*C,n=Math.max(f.length,3*D);t<n;t++)f[t]=0;for(t=3*P,n=Math.max(g.length,3*I);t<n;t++)g[t]=0;for(t=3*L,n=Math.max(b.length,3*O);t<n;t++)b[t]=0;for(t=3*R,n=Math.max(A.length,3*N);t<n;t++)A[t]=0;for(t=3*R,n=Math.max(M.length,3*N);t<n;t++)M[t]=0;p.directional.length=C,p.point.length=P,p.spot.length=L,p.hemi.length=R,p.ambient[0]=u,p.ambient[1]=h,p.ambient[2]=d}function tn(e,t,n){var i;n?(O.texParameteri(e,O.TEXTURE_WRAP_S,un(t.wrapS)),O.texParameteri(e,O.TEXTURE_WRAP_T,un(t.wrapT)),O.texParameteri(e,O.TEXTURE_MAG_FILTER,un(t.magFilter)),O.texParameteri(e,O.TEXTURE_MIN_FILTER,un(t.minFilter))):(O.texParameteri(e,O.TEXTURE_WRAP_S,O.CLAMP_TO_EDGE),O.texParameteri(e,O.TEXTURE_WRAP_T,O.CLAMP_TO_EDGE),t.wrapS===l.ClampToEdgeWrapping&&t.wrapT===l.ClampToEdgeWrapping||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping. ( "+t.sourceFile+" )"),O.texParameteri(e,O.TEXTURE_MAG_FILTER,ln(t.magFilter)),O.texParameteri(e,O.TEXTURE_MIN_FILTER,ln(t.minFilter)),t.minFilter!==l.NearestFilter&&t.minFilter!==l.LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter. ( "+t.sourceFile+" )")),(i=B.get("EXT_texture_filter_anisotropic"))&&t.type!==l.FloatType&&t.type!==l.HalfFloatType&&(t.anisotropy>1||t.__oldAnisotropy)&&(O.texParameterf(e,i.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,H.getMaxAnisotropy())),t.__oldAnisotropy=t.anisotropy)}function nn(e,t){if(e.width<=t&&e.height<=t)return e;if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var n=t/Math.max(e.width,e.height),i=Math.max(Math.floor(e.width*n),1),r=Math.max(Math.floor(e.height*n),1),o=m.createElement("canvas");return o.width=i,o.height=r,o.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,i,r),o}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}function rn(e,t){if(6===e.image.length)if(st(e)){e.__webglTextureCube||(e.addEventListener("dispose",qe),e.__webglTextureCube=O.createTexture(),H.info.memory.textures++),O.activeTexture(O.TEXTURE0+t),O.bindTexture(O.TEXTURE_CUBE_MAP,e.__webglTextureCube),O.pixelStorei(O.UNPACK_FLIP_Y_WEBGL,e.flipY);var n,i=e instanceof l.CompressedTexture,r=e.image[0]instanceof l.DataTexture,o=[];for(n=0;n<6;n++)!H.autoScaleCubemaps||i||r?o[n]=r?e.image[n].image:e.image[n]:o[n]=nn(e.image[n],Me);var a=o[0],s=l.Math.isPowerOfTwo(a.width)&&l.Math.isPowerOfTwo(a.height),c=un(e.format),u=un(e.type);for(tn(O.TEXTURE_CUBE_MAP,e,s),n=0;n<6;n++)if(i)for(var h,d=o[n].mipmaps,p=0,f=d.length;p<f;p++)h=d[p],e.format!==l.RGBAFormat&&e.format!==l.RGBFormat?ke().indexOf(c)>-1?O.compressedTexImage2D(O.TEXTURE_CUBE_MAP_POSITIVE_X+n,p,c,h.width,h.height,0,h.data):console.warn("Attempt to load unsupported compressed texture format"):O.texImage2D(O.TEXTURE_CUBE_MAP_POSITIVE_X+n,p,c,h.width,h.height,0,c,u,h.data);else r?O.texImage2D(O.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,c,o[n].width,o[n].height,0,c,u,o[n].data):O.texImage2D(O.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,c,c,u,o[n]);e.generateMipmaps&&s&&O.generateMipmap(O.TEXTURE_CUBE_MAP),lt(e),e.onUpdate&&e.onUpdate()}else O.activeTexture(O.TEXTURE0+t),O.bindTexture(O.TEXTURE_CUBE_MAP,e.__webglTextureCube)}function on(e,t){O.activeTexture(O.TEXTURE0+t),O.bindTexture(O.TEXTURE_CUBE_MAP,e.__webglTexture)}function an(e){var t=N?O.COLOR_ATTACHMENT0:k.COLOR_ATTACHMENT0_WEBGL,n=[t];for(Ie=1;Ie<e.length;Ie++)n.push(t+Ie);N?O.drawBuffers(n):k.drawBuffersWEBGL(n)}function sn(e){var t=l.Math.isPowerOfTwo(e.width)&&l.Math.isPowerOfTwo(e.height),n=un(e.texture.format),i=un(e.texture.type),r=cn(e.texture.format,e.texture.type);e.addEventListener("dispose",Xe),e.__webglTexture=O.createTexture(),H.info.memory.textures++,O.bindTexture(O.TEXTURE_2D,e.__webglTexture),tn(O.TEXTURE_2D,e.texture,t),O.texImage2D(O.TEXTURE_2D,0,r,e.width,e.height,0,n,i,null),t&&e.texture.generateMipmaps&&O.generateMipmap(O.TEXTURE_2D)}function ln(e){return e===l.NearestFilter||e===l.NearestMipMapNearestFilter||e===l.NearestMipMapLinearFilter?O.NEAREST:O.LINEAR}function cn(e,t){if(N){if(e===l.RGBFormat)switch(t){case l.UnsignedByteType:return O.RGB8;case l.FloatType:return O.RGB32F;case l.HalfFloatType:return O.RGB16F}else if(e===l.RGBAFormat)switch(t){case l.UnsignedByteType:return O.RGBA8;case l.FloatType:return O.RGBA32F;case l.HalfFloatType:return O.RGBA16F}else if(e===l.LuminanceFormat&&t===l.UnsignedByteType)return O.LUMINANCE;console.error("failed to map texture format and type to internalformat")}return un(e)}function un(e){var t;if(e===l.RepeatWrapping)return O.REPEAT;if(e===l.ClampToEdgeWrapping)return O.CLAMP_TO_EDGE;if(e===l.MirroredRepeatWrapping)return O.MIRRORED_REPEAT;if(e===l.NearestFilter)return O.NEAREST;if(e===l.NearestMipMapNearestFilter)return O.NEAREST_MIPMAP_NEAREST;if(e===l.NearestMipMapLinearFilter)return O.NEAREST_MIPMAP_LINEAR;if(e===l.LinearFilter)return O.LINEAR;if(e===l.LinearMipMapNearestFilter)return O.LINEAR_MIPMAP_NEAREST;if(e===l.LinearMipMapLinearFilter)return O.LINEAR_MIPMAP_LINEAR;if(e===l.UnsignedByteType)return O.UNSIGNED_BYTE;if(e===l.UnsignedShort4444Type)return O.UNSIGNED_SHORT_4_4_4_4;if(e===l.UnsignedShort5551Type)return O.UNSIGNED_SHORT_5_5_5_1;if(e===l.UnsignedShort565Type)return O.UNSIGNED_SHORT_5_6_5;if(e===l.ByteType)return O.BYTE;if(e===l.ShortType)return O.SHORT;if(e===l.UnsignedShortType)return O.UNSIGNED_SHORT;if(e===l.IntType)return O.INT;if(e===l.UnsignedIntType)return O.UNSIGNED_INT;if(e===l.FloatType)return O.FLOAT;if(e===l.HalfFloatType)return N?O.HALF_FLOAT:36193;if(e===l.AlphaFormat)return O.ALPHA;if(e===l.RGBFormat)return O.RGB;if(e===l.RGBAFormat)return O.RGBA;if(e===l.LuminanceFormat)return O.LUMINANCE;if(e===l.LuminanceAlphaFormat)return O.LUMINANCE_ALPHA;if(e===l.AddEquation)return O.FUNC_ADD;if(e===l.MinEquation)return O.MIN;if(e===l.MaxEquation)return O.MAX;if(e===l.SubtractEquation)return O.FUNC_SUBTRACT;if(e===l.ReverseSubtractEquation)return O.FUNC_REVERSE_SUBTRACT;if(e===l.ZeroFactor)return O.ZERO;if(e===l.OneFactor)return O.ONE;if(e===l.SrcColorFactor)return O.SRC_COLOR;if(e===l.OneMinusSrcColorFactor)return O.ONE_MINUS_SRC_COLOR;if(e===l.SrcAlphaFactor)return O.SRC_ALPHA;if(e===l.OneMinusSrcAlphaFactor)return O.ONE_MINUS_SRC_ALPHA;if(e===l.DstAlphaFactor)return O.DST_ALPHA;if(e===l.OneMinusDstAlphaFactor)return O.ONE_MINUS_DST_ALPHA;if(e===l.DstColorFactor)return O.DST_COLOR;if(e===l.OneMinusDstColorFactor)return O.ONE_MINUS_DST_COLOR;if(e===l.SrcAlphaSaturateFactor)return O.SRC_ALPHA_SATURATE;if(null!==(t=B.get("WEBGL_compressed_texture_s3tc"))){if(e===l.RGB_S3TC_DXT1_Format)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===l.RGBA_S3TC_DXT1_Format)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===l.RGBA_S3TC_DXT3_Format)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===l.RGBA_S3TC_DXT5_Format)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(null!==(t=B.get("WEBGL_compressed_texture_pvrtc"))){if(e===l.RGB_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===l.RGB_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===l.RGBA_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===l.RGBA_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(null!==(t=B.get("EXT_blend_minmax"))){if(e===l.MinEquation)return t.MIN_EXT;if(e===l.MaxEquation)return t.MAX_EXT}return 0}this.setMaterialFaces=function(e){V.setMaterial(e)},this.uploadTexture=function(e){void 0===e.__webglInit&&(e.__webglInit=!0,e.addEventListener("dispose",qe),e.__webglTexture=O.createTexture(),H.info.memory.textures++),O.bindTexture(O.TEXTURE_2D,e.__webglTexture),O.pixelStorei(O.UNPACK_FLIP_Y_WEBGL,e.flipY),O.pixelStorei(O.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),O.pixelStorei(O.UNPACK_ALIGNMENT,e.unpackAlignment),e.image=nn(e.image,Ae);var t=e.image,n=l.Math.isPowerOfTwo(t.width)&&l.Math.isPowerOfTwo(t.height),i=un(e.format),r=un(e.type),o=cn(e.format,e.type);tn(O.TEXTURE_2D,e,n);var a,s,c,u=e.mipmaps;if(e instanceof l.DataTexture)if(u.length>0&&n){for(s=0,c=u.length;s<c;s++)a=u[s],O.texImage2D(O.TEXTURE_2D,s,o,a.width,a.height,0,i,r,a.data);e.generateMipmaps=!1}else O.texImage2D(O.TEXTURE_2D,0,o,t.width,t.height,0,i,r,t.data);else if(e instanceof l.CompressedTexture){for(s=0,c=u.length;s<c;s++)a=u[s],e.format!==l.RGBAFormat&&e.format!==l.RGBFormat?ke().indexOf(i)>-1?O.compressedTexImage2D(O.TEXTURE_2D,s,o,a.width,a.height,0,a.data):console.warn("Attempt to load unsupported compressed texture format"):O.texImage2D(O.TEXTURE_2D,s,o,a.width,a.height,0,i,r,a.data);if(u.length>1&&ke().indexOf(i)>-1)for(var h,d=a.width>>1,p=a.height>>1,f=u.length;d>=1||p>=1;)h=4==a.width&&4==a.height?a.data:new DataView(a.data.buffer,a.data.byteOffset,a.data.byteLength*(Math.max(d,4)*Math.max(p,4))/(a.width*a.height)),O.compressedTexImage2D(O.TEXTURE_2D,f,o,Math.max(d,1),Math.max(p,1),0,h),d>>=1,p>>=1,++f}else if(u.length>0&&n){for(s=0,c=u.length;s<c;s++)O.texImage2D(O.TEXTURE_2D,s,o,i,r,u[s]);e.generateMipmaps=!1}else O.texImage2D(O.TEXTURE_2D,0,o,i,r,e.image);e.generateMipmaps&&n&&O.generateMipmap(O.TEXTURE_2D),lt(e),e.onUpdate&&e.onUpdate()},this.setTexture=function(e,t){O.activeTexture(O.TEXTURE0+t),st(e)?H.uploadTexture(e):e.__webglTexture?O.bindTexture(O.TEXTURE_2D,e.__webglTexture):O.bindTexture(O.TEXTURE_2D,Ee.__webglTexture)},H.uploadTexture(Ee),this.initFrameBufferMRT=function(e,t){var n,i=e[0],r=!1;i&&!i.__webglFramebuffer?(void 0===i.depthBuffer&&(i.depthBuffer=!0),void 0===i.stencilBuffer&&(i.stencilBuffer=!0),i.__webglFramebuffer=O.createFramebuffer(),O.bindFramebuffer(O.FRAMEBUFFER,i.__webglFramebuffer),i.shareDepthFrom?(n=i.__webglRenderbuffer=i.shareDepthFrom.__webglRenderbuffer,i.__isUsingShared=!0):(n=i.__webglRenderbuffer,i.__isUsingShared=!1,i.depthBuffer&&!i.stencilBuffer?(n||(n=i.__webglRenderbuffer=O.createRenderbuffer(),i.__webglRenderbufferOwn=n),O.bindRenderbuffer(O.RENDERBUFFER,n),O.renderbufferStorage(O.RENDERBUFFER,N?O.DEPTH_COMPONENT32F:O.DEPTH_COMPONENT16,i.width,i.height)):i.depthBuffer&&i.stencilBuffer&&(n||(n=i.__webglRenderbuffer=O.createRenderbuffer(),i.__webglRenderbufferOwn=n),O.bindRenderbuffer(O.RENDERBUFFER,n),O.renderbufferStorage(O.RENDERBUFFER,N?O.DEPTH24_STENCIL8:O.DEPTH_STENCIL,i.width,i.height))),i.depthBuffer&&!i.stencilBuffer?O.framebufferRenderbuffer(O.FRAMEBUFFER,O.DEPTH_ATTACHMENT,O.RENDERBUFFER,n):i.depthBuffer&&i.stencilBuffer&&O.framebufferRenderbuffer(O.FRAMEBUFFER,O.DEPTH_STENCIL_ATTACHMENT,O.RENDERBUFFER,n),r=!0):i&&(i.shareDepthFrom&&0==i.__isUsingShared?(n=i.shareDepthFrom.__webglRenderbuffer,i.__isUsingShared=!0,i.depthBuffer&&!i.stencilBuffer?O.framebufferRenderbuffer(O.FRAMEBUFFER,O.DEPTH_ATTACHMENT,O.RENDERBUFFER,n):i.depthBuffer&&i.stencilBuffer&&O.framebufferRenderbuffer(O.FRAMEBUFFER,O.DEPTH_STENCIL_ATTACHMENT,O.RENDERBUFFER,n)):null==i.shareDepthFrom&&1==i.__isUsingShared&&(n=i.__webglRenderbufferOwn,i.__isUsingShared=!1,null==n&&(i.depthBuffer&&!i.stencilBuffer?(n=i.__webglRenderbuffer=O.createRenderbuffer(),i.__webglRenderbufferOwn=n,O.bindRenderbuffer(O.RENDERBUFFER,n),O.renderbufferStorage(O.RENDERBUFFER,N?O.DEPTH_COMPONENT32F:O.DEPTH_COMPONENT16,i.width,i.height)):i.depthBuffer&&i.stencilBuffer&&(n=i.__webglRenderbuffer=O.createRenderbuffer(),i.__webglRenderbufferOwn=n,O.bindRenderbuffer(O.RENDERBUFFER,n),O.renderbufferStorage(O.RENDERBUFFER,N?O.DEPTH24_STENCIL8:O.DEPTH_STENCIL,i.width,i.height))),i.depthBuffer&&!i.stencilBuffer?O.framebufferRenderbuffer(O.FRAMEBUFFER,O.DEPTH_ATTACHMENT,O.RENDERBUFFER,n):i.depthBuffer&&i.stencilBuffer&&O.framebufferRenderbuffer(O.FRAMEBUFFER,O.DEPTH_STENCIL_ATTACHMENT,O.RENDERBUFFER,n)));var o=q;if(O.bindFramebuffer(O.FRAMEBUFFER,i.__webglFramebuffer),function(e,t){var n=e.__webglBoundBuffers;if(!n)return!0;if(n.length!==t.length)return!0;for(var i=0;i<t.length;i++)if(t[i]!==n[i])return!0;return!1}(i,e)){var a;for(a=0;a<e.length;a++){var s=e[a];s&&!s.__webglTexture&&sn(s),O.framebufferTexture2D(O.FRAMEBUFFER,O.COLOR_ATTACHMENT0+a,O.TEXTURE_2D,s&&s.__webglTexture,0)}a=e.length;for(var l=i.__webglBoundBuffers&&i.__webglBoundBuffers.length||a;a<l;)O.framebufferTexture2D(O.FRAMEBUFFER,O.COLOR_ATTACHMENT0+a,O.TEXTURE_2D,null,0),a++;i.__webglBoundBuffers=e.slice()}if(this.supportsMRT()&&an(e),t){var c=O.checkFramebufferStatus(O.FRAMEBUFFER);c!==O.FRAMEBUFFER_COMPLETE&&(console.log("Can't use multiple render targets. Falling back to two passes. "+c),o===i.__webglFramebuffer&&(o=q=null),O.bindFramebuffer(O.FRAMEBUFFER,o),O.deleteFramebuffer(i.__webglFramebuffer),delete i.__webglFramebuffer,t=!1)}return O.bindFramebuffer(O.FRAMEBUFFER,o),r&&(O.bindTexture(O.TEXTURE_2D,null),O.bindRenderbuffer(O.RENDERBUFFER,null),O.bindFramebuffer(O.FRAMEBUFFER,null)),t},this.getRenderTarget=function(){return X},this.setRenderTarget=function(e){var t,n,i,r,o,a;if(X=Array.isArray(e)&&e.length>0?e[0]:e,H.lostContextRecovery&&H.lostContextRecovery.refreshTargetsIfNeeded(e),Array.isArray(e))this.initFrameBufferMRT(e),(t=e[0]).initForMRT=!0;else if(e){var s=e.__webglFramebuffer;Ve&&Ve.isPresenting&&s===Ve.getSession().renderState.baseLayer.framebuffer||s&&q===s&&!e.initForMRT&&null!=e.shareDepthFrom==!!e.__isUsingShared||this.initFrameBufferMRT([e]),(t=e).initForMRT=!1}!t||Ge?(i=ie,r=re,o=te,a=ne):(i=t.width,r=t.height,o=0,a=0),(n=t?t.__webglFramebuffer:null)!==q&&(O.bindFramebuffer(O.FRAMEBUFFER,n),q=n),O.viewport(o,a,i,r)},this.verifyMRTWorks=function(e){return!!this.supportsMRT()&&this.initFrameBufferMRT(e,!0)},this.readRenderTargetPixels=function(e,t,n,i,r,o){if(e instanceof l.WebGLRenderTarget){if(H.lostContextRecovery&&H.lostContextRecovery.refreshTargetsIfNeeded(e),e.__webglFramebuffer){if(e.texture.format!==l.RGBAFormat&&e.texture.format!==l.RGBFormat||e.texture.type!==l.UnsignedByteType)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not a readable format.");var a=!1;e.__webglFramebuffer!==q&&(O.bindFramebuffer(O.FRAMEBUFFER,e.__webglFramebuffer),a=!0),e.canReadPixels||O.checkFramebufferStatus(O.FRAMEBUFFER)===O.FRAMEBUFFER_COMPLETE?O.readPixels(t,n,i,r,O.RGBA,O.UNSIGNED_BYTE,o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."),a&&O.bindFramebuffer(O.FRAMEBUFFER,q)}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyDepthBuffer=function(e,t){return N&&(O.bindFramebuffer(O.READ_FRAMEBUFFER,e.__webglFramebuffer),O.bindFramebuffer(O.DRAW_FRAMEBUFFER,t.__webglFramebuffer),O.blitFramebuffer(0,0,ie,re,0,0,ie,re,O.DEPTH_BUFFER_BIT,O.NEAREST)),N}};v.Events=g},74007:(e,t,n)=>{"use strict";n.r(t),n.d(t,{WebGLShader:()=>i});function i(e,t,n){var i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),"undefined"!=typeof DEBUG_SHADERS&&DEBUG_SHADERS&&(!1===e.getShaderParameter(i,e.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(i)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e.getShaderInfoLog(i),function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(n))),i}},26245:(e,t,n)=>{"use strict";function i(e,t){var n,i;this.bytes_per_node=t?32:36,e instanceof ArrayBuffer?(n=e.byteLength/this.bytes_per_node,i=e,this.nodeCount=n):(n=0|e,i=new ArrayBuffer(this.bytes_per_node*n),this.nodeCount=0),this.nodeCapacity=n,this.nodesRaw=i,this.is_lean_node=t,this.node_stride=this.bytes_per_node/4,this.node_stride_short=this.bytes_per_node/2,this.nodesF=new Float32Array(this.nodesRaw),this.nodesI=new Int32Array(this.nodesRaw),this.nodesS=new Uint16Array(this.nodesRaw)}n.r(t),n.d(t,{NodeArray:()=>i,BVHBuilder:()=>a}),i.prototype.setLeftChild=function(e,t){this.nodesI[e*this.node_stride+6]=t},i.prototype.getLeftChild=function(e){return this.nodesI[e*this.node_stride+6]},i.prototype.setPrimStart=function(e,t){this.is_lean_node?this.nodesI[e*this.node_stride+6]=t:this.nodesI[e*this.node_stride+8]=t},i.prototype.getPrimStart=function(e){return this.is_lean_node?this.nodesI[e*this.node_stride+6]:this.nodesI[e*this.node_stride+8]},i.prototype.setPrimCount=function(e,t){this.nodesS[e*this.node_stride_short+14]=t},i.prototype.getPrimCount=function(e){return this.nodesS[e*this.node_stride_short+14]},i.prototype.setFlags=function(e,t,n,i){this.nodesS[e*this.node_stride_short+15]=i<<3|n<<2|3&t},i.prototype.getFlags=function(e){return this.nodesS[e*this.node_stride_short+15]},i.prototype.setBox0=function(e,t){var n=e*this.node_stride,i=this.nodesF;i[n]=t[0],i[n+1]=t[1],i[n+2]=t[2],i[n+3]=t[3],i[n+4]=t[4],i[n+5]=t[5]},i.prototype.getBoxThree=function(e,t){var n=e*this.node_stride,i=this.nodesF;t.min.x=i[n],t.min.y=i[n+1],t.min.z=i[n+2],t.max.x=i[n+3],t.max.y=i[n+4],t.max.z=i[n+5]},i.prototype.getBoxArray=function(e,t,n){var i=e*this.node_stride,r=this.nodesF;t[0+(n=n||0)]=r[i],t[1+n]=r[i+1],t[2+n]=r[i+2],t[3+n]=r[i+3],t[4+n]=r[i+4],t[5+n]=r[i+5]},i.prototype.setBoxThree=function(e,t){var n=e*this.node_stride,i=this.nodesF;i[n]=t.min.x,i[n+1]=t.min.y,i[n+2]=t.min.z,i[n+3]=t.max.x,i[n+4]=t.max.y,i[n+5]=t.max.z},i.prototype.makeEmpty=function(e){var t=e*this.node_stride,n=this.nodesI;n[t+6]=-1,n[t+7]=0,this.is_lean_node||(n[t+8]=-1)},i.prototype.realloc=function(e){if(this.nodeCount+e>this.nodeCapacity){var t=0|3*this.nodeCapacity/2;t<this.nodeCount+e&&(t=this.nodeCount+e);var n=new ArrayBuffer(t*this.bytes_per_node),i=new Int32Array(n);i.set(this.nodesI),this.nodeCapacity=t,this.nodesRaw=n,this.nodesF=new Float32Array(n),this.nodesI=i,this.nodesS=new Uint16Array(n)}},i.prototype.nextNodes=function(e){this.realloc(e);var t=this.nodeCount;this.nodeCount+=e;for(var n=0;n<e;n++)this.makeEmpty(t+n);return t},i.prototype.getRawData=function(){return this.nodesRaw.slice(0,this.nodeCount*this.bytes_per_node)};var r=function(){function e(e,t,n){e[0]>t[n]&&(e[0]=t[n]),e[3]<t[n]&&(e[3]=t[n]),e[1]>t[n+1]&&(e[1]=t[n+1]),e[4]<t[n+1]&&(e[4]=t[n+1]),e[2]>t[n+2]&&(e[2]=t[n+2]),e[5]<t[n+2]&&(e[5]=t[n+2])}function t(e,t,n){e[0]>t[n]&&(e[0]=t[n]),e[1]>t[n+1]&&(e[1]=t[n+1]),e[2]>t[n+2]&&(e[2]=t[n+2]),e[3]<t[n+3]&&(e[3]=t[n+3]),e[4]<t[n+4]&&(e[4]=t[n+4]),e[5]<t[n+5]&&(e[5]=t[n+5])}function n(e,t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]>t[2]&&(e[2]=t[2]),e[3]<t[3]&&(e[3]=t[3]),e[4]<t[4]&&(e[4]=t[4]),e[5]<t[5]&&(e[5]=t[5])}function i(e,t,n,i){for(var r=0;r<3;r++)e[t+r]=n[i+3+r]-n[i+r]}function r(e,t){e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5]}var o=1/0;function a(e){e[0]=o,e[1]=o,e[2]=o,e[3]=-1/0,e[4]=-1/0,e[5]=-1/0}function s(e){var t=e[3]-e[0],n=e[4]-e[1],i=e[5]-e[2];return t<0||n<0||i<0?0:2*(t*n+n*i+i*t)}function l(){this.vb_left=new Float32Array(6),this.vb_right=new Float32Array(6),this.cb_left=new Float32Array(6),this.cb_right=new Float32Array(6),this.num_left=0,this.best_split=-1,this.best_cost=-1,this.num_bins=-1}function c(){this.box_bbox=new Float32Array(6),this.box_centroid=new Float32Array(6),this.num_prims=0}function u(){this.BL=new Float32Array(6),this.CL=new Float32Array(6),this.NL=0,this.AL=0}l.prototype.reset=function(){this.num_left=0,this.best_split=-1,this.best_cost=-1,this.num_bins=-1},c.prototype.reset=function(){this.num_prims=0,a(this.box_bbox),a(this.box_centroid)},u.prototype.reset=function(){this.NL=0,this.AL=0,a(this.BL),a(this.CL)};var h,d=[];for(h=0;h<16;h++)d.push(new c);var p=[];for(h=0;h<15;h++)p.push(new u);var f=new Float32Array(6),m=new Float32Array(6);function g(i,o,a,l,c,u,h){if(u[l]<i.scene_epsilon)h.best_cost=1/0;else{var g,v,y=16;for(y>a-o+1&&(y=a-o+1),g=0;g<y;g++)d[g].reset();for(g=0;g<y-1;g++)p[g].reset();for(h.num_bins=y,function(n,i,r,o,a,s,l){for(var c=n.centroids,u=n.primitives,h=n.finfo.boxes,p=n.finfo.boxStride,f=.99999*l/s[o],m=a[o],g=n.sort_prims,v=i;v<=r;v++){var y=0|u[v],b=0|f*(c[3*y+o]-m);b<0?b=0:b>=l&&(b=l-1),g[v]=b,d[b].num_prims++,t(d[b].box_bbox,h,y*p),e(d[b].box_centroid,c,3*y)}}(i,o,a,l,c,u,y),r(p[0].BL,d[0].box_bbox),r(p[0].CL,d[0].box_centroid),p[0].AL=s(p[0].BL),p[0].NL=d[0].num_prims,g=1;g<y-1;g++){v=d[g];var b=p[g];r(b.BL,p[g-1].BL),n(b.BL,v.box_bbox),b.AL=s(b.BL),r(b.CL,p[g-1].CL),n(b.CL,v.box_centroid),b.NL=p[g-1].NL+v.num_prims}r(f,d[g=y-1].box_bbox),r(m,d[g].box_centroid);var _=s(f),x=d[g].num_prims,E=g,w=_*x+p[g-1].AL*p[g-1].NL;for(r(h.vb_right,f),r(h.cb_right,d[g].box_centroid),r(h.vb_left,p[g-1].BL),r(h.cb_left,p[g-1].CL),h.num_left=p[g-1].NL,g-=1;g>=1;g--){v=d[g],n(f,v.box_bbox),n(m,v.box_centroid);var S=(_=s(f))*(x+=v.num_prims)+p[g-1].AL*p[g-1].NL;S<=w&&(w=S,E=g,r(h.vb_right,f),r(h.cb_right,m),r(h.vb_left,p[g-1].BL),r(h.cb_left,p[g-1].CL),h.num_left=p[g-1].NL)}h.best_split=E,h.best_cost=w}}var v=new Float32Array(3);return{bvh_subdivide:function(t,n,r,o,s,c,u,h){i(v,0,c,0);var d=t.nodes,p=u?t.frags_per_leaf_node_transparent:t.frags_per_leaf_node,f=u?t.frags_per_inner_node_transparent:t.frags_per_inner_node,m=t.max_polys_per_node,y=0;v[1]>v[0]&&(y=1),v[2]>v[y]&&(y=2),d.setBox0(n,s);var b=0,_=0,x=o-r+1;if(t.finfo.hasPolygonCounts&&t.frags_per_inner_node)for(var E=x<=t.frags_per_inner_node?o:r+t.frags_per_inner_node-1,w=r;w<=E&&(_++,!((b+=t.finfo.getPolygonCount(t.primitives[w]))>m));w++);if(x<=p&&b<m||1===x||h>15||v[y]<t.scene_epsilon)return d.setLeftChild(n,-1),d.setPrimStart(n,r),d.setPrimCount(n,o-r+1),void d.setFlags(n,0,0,u?1:0);f&&(y=function(t,n,r,o,s,l,c,u){var h=t.primitives,d=t.centroids,p=s-o+1;p>t.frags_per_inner_node&&(p=t.frags_per_inner_node),p>u&&(p=u),n.setPrimStart(r,o),n.setPrimCount(r,p),o+=p,a(l);for(var f=o;f<=s;f++)e(l,d,3*h[f]);i(c,0,l,0);var m=0;return c[1]>c[0]&&(m=1),c[2]>c[m]&&(m=2),m}(t,d,n,r,o,c,v,_),r+=d.getPrimCount(n));var S=new l;if(g(t,r,o,y,c,v,S),S.num_bins<0)d.setPrimCount(n,d.getPrimCount(n)+o-r+1);else{!function(e,t,n,i,r,o,a){var s,l,c=e.primitives,u=e.sort_prims,h=0,d=0|t,p=0|a.best_split;for(s=t;s<=n;s++){var f=0|c[s];u[s]<p?c[d++]=f:u[h++]=f}for(l=0;l<h;l++)c[d+l]=u[l]}(t,r,o,0,0,0,S);var A=d.nextNodes(2),M=.5*(S.vb_left[3+y]+S.vb_left[y]),T=.5*(S.vb_right[3+y]+S.vb_right[y]);d.setFlags(n,y,M<T?0:1,u?1:0),d.setLeftChild(n,A),t.recursion_stack.push([t,A+1,r+S.num_left,o,S.vb_right,S.cb_right,u,h+1]),t.recursion_stack.push([t,A,r,r+S.num_left-1,S.vb_left,S.cb_left,u,h+1])}},compute_boxes:function(n){var r=n.boxv_o,o=n.boxc_o,s=n.boxv_t,l=n.boxc_t;a(r),a(o),a(s),a(l);for(var c,u,h,d,p=n.centroids,f=n.finfo.boxes,m=n.finfo.boxStride,g=0,y=n.prim_count;g<y;g++){var b=n.primitives[g];h=f,d=m*b,(c=p)[u=3*b]=.5*(h[d]+h[d+3]),c[u+1]=.5*(h[d+1]+h[d+4]),c[u+2]=.5*(h[d+2]+h[d+5]),g>=n.first_transparent?(e(l,p,3*b),t(s,f,m*b)):(e(o,p,3*b),t(r,f,m*b))}i(v,0,n.boxv_o,0);var _=Math.max(v[0],v[1],v[2]);n.scene_epsilon=1e-5*_},box_area:function(e,t){var n=e[t+3]-e[t],i=e[t+4]-e[t+1],r=e[t+5]-e[t+2];return n<0||i<0||r<0?0:2*(n*i+i*r+r*n)}}}();function o(e,t){this.boxes=e.boxes,this.polygonCounts=e.polygonCounts,this.hasPolygonCounts=!!this.polygonCounts,this.materials=e.materials,this.materialDefs=t,this.count=e.length,this.boxStride=6,this.wantSort=!0}function a(e,t,n){this.finfo=n||new o(e,t),this.prim_count=this.finfo.getCount(),this.frags_per_leaf_node=-1,this.frags_per_inner_node=-1,this.nodes=null,this.work_buf=new ArrayBuffer(4*this.prim_count),this.sort_prims=new Int32Array(this.work_buf),this.primitives=new Int32Array(this.prim_count),this.centroids=new Float32Array(3*this.prim_count),this.boxv_o=new Float32Array(6),this.boxc_o=new Float32Array(6),this.boxv_t=new Float32Array(6),this.boxc_t=new Float32Array(6),this.recursion_stack=[]}o.prototype.getCount=function(){return this.count},o.prototype.isTransparent=function(e){return!(!this.materialDefs||!this.materialDefs[this.materials[e]])&&this.materialDefs[this.materials[e]].transparent},o.prototype.getPolygonCount=function(e){return this.polygonCounts[e]},a.prototype.sortPrimitives=function(e){var t,n,i=new Float32Array(this.work_buf),o=this.primitives,a=0,s=e;for(t=0,n=this.prim_count;t<n;t++){o[t]=t;var l=this.finfo.isTransparent(t);l&&a++,s?(i[t]=r.box_area(this.finfo.boxes,this.finfo.boxStride*t),l&&(i[t]=-i[t])):i[t]=l?-1:1}if(s)Array.prototype.sort.call(this.primitives,(function(e,t){return i[t]-i[e]}));else if(a&&a<this.prim_count){var c=new Int32Array(a),u=0,h=0;for(t=0,n=this.prim_count;t<n;t++)i[t]>=0?o[u++]=o[t]:c[h++]=o[t];o.set(c,this.prim_count-a)}this.first_transparent=this.prim_count-a},a.prototype.build=function(e){var t=e&&!!e.useSlimNodes,n=this;function o(t,i){e.hasOwnProperty(t)?n[t]=e[t]:n[t]=i}if(t)o("frags_per_leaf_node",1),o("frags_per_inner_node",0),o("frags_per_leaf_node_transparent",1),o("frags_per_inner_node_transparent",0),o("max_polys_per_node",1/0);else{var a=e.isWeakDevice?.5:1;o("frags_per_leaf_node",0|256*a),o("frags_per_inner_node",0|this.frags_per_leaf_node),o("frags_per_leaf_node_transparent",this.frags_per_leaf_node),o("frags_per_inner_node_transparent",0),o("max_polys_per_node",0|2e4*a)}if(this.nodes&&this.nodes.is_lean_node==t)this.nodes.nodeCount=0;else{for(var s=this.prim_count/this.frags_per_leaf_node,l=1;l<s;)l*=2;this.nodes=new i(l,!!e&&e.useSlimNodes)}this.sortPrimitives(this.finfo.wantSort),r.compute_boxes(this);var c,u=this.nodes.nextNodes(2);for(r.bvh_subdivide(this,u,0,this.first_transparent-1,this.boxv_o,this.boxc_o,!1,0);this.recursion_stack.length;)c=this.recursion_stack.pop(),r.bvh_subdivide(c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7]);for(r.bvh_subdivide(this,u+1,this.first_transparent,this.prim_count-1,this.boxv_t,this.boxc_t,!0,0);this.recursion_stack.length;)c=this.recursion_stack.pop(),r.bvh_subdivide(c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7])}},25131:(e,t,n)=>{"use strict";n.r(t),n.d(t,{createBufferGeometry:()=>f,meshToGeometry:()=>m,BufferGeometryUtils:()=>g});var i=n(92445),r=n(84998),o=n(16453),a=n(98926),s={};function l(e,t,n){var i,r=t.normalize||t.normalized;if(t.array)i=new o.BufferAttribute(t.array,t.itemSize);else{var l=e+"|"+t.bytesPerItem+"|"+r+"|"+t.isPattern+"|"+t.divisor+"|"+t.offset;if(i=s[l])return i;i=new o.BufferAttribute(void 0,t.itemSize),s[l]=i}return i.bytesPerItem=t.bytesPerItem,i.normalized=r,i.isPattern=t.isPattern,n&&(i.divisor=t.divisor),t.array||(t.hasOwnProperty("offset")?i.itemOffset=t.offset:a.logger.warn("VB attribute is neither interleaved nor separate. Something is wrong with the buffer specificaiton.")),i}var c,u,h,d={};var p=1;function f(){return h||((c=new o.BufferAttribute(void 0,1)).bytesPerItem=2,(u=new o.BufferAttribute(void 0,1)).bytesPerItem=4,(h=function(){this.id=p++,this.attributes={},this.__webglInit=void 0,this.morphAttributes={}}).prototype=Object.create(o.BufferGeometry.prototype),h.prototype.constructor=h),new h}function m(e){var t=e.mesh,n=f();for(var a in(0,r.isNodeJS)()&&(n.packId=e.packId,n.meshIndex=e.meshIndex),n.byteSize=0,n.vb=t.vb,n.vbbuffer=void 0,n.vbNeedsUpdate=!0,n.byteSize+=t.vb.byteLength,n.hash=e.hash,n.vbstride=t.vbstride,t.isLines&&(n.isLines=t.isLines),t.isWideLines&&(n.isWideLines=!0,n.lineWidth=t.lineWidth),t.isPoints&&(n.isPoints=t.isPoints,n.pointSize=t.pointSize),e.is2d&&(n.is2d=!0),n.numInstances=t.numInstances,t.vblayout){var s=t.vblayout[a];n.attributes[a]=l(a,s,n.numInstances)}if(i.memoryOptimizedLoading)n.index=t.indices instanceof Uint32Array?u:c,n.ib=t.indices,n.ibbuffer=void 0,t.iblines&&(n.attributes.indexlines=t.iblines instanceof Uint32Array?u:c,n.iblines=t.iblines,n.iblinesbuffer=void 0);else{var h=new o.BufferAttribute(t.indices,1);h.bytesPerItem=t.indices instanceof Uint32Array?4:2,n.setIndex(h)}n.attributesKeys=function(e){var t="";for(var n in e.attributes)t+=n+"|";var i=d[t];return i||(i=Object.keys(e.attributes),d[t]=i,i)}(n),n.byteSize+=t.indices.byteLength,n.boundingBox=(new o.Box3).copy(t.boundingBox),n.boundingSphere=(new o.Sphere).copy(t.boundingSphere),e.geometry=n,e.mesh=null}var g={meshToGeometry:m,createBufferGeometry:f,findBufferAttribute:l}},76543:(e,t,n)=>{"use strict";n.r(t),n.d(t,{MeshAccessor:()=>g,createWireframe:()=>v});var i=n(36757),r=n(73075),o=n(22585),a=1e-6;function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l={x:0,y:0,z:0},c=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getVertex=t,this.bbox=n,this.boxSize=this.bbox.getSize().length(),i||(i=a),i>0?(this.precisionTolerance=i,this.scale=1/this.precisionTolerance):(this.precisionTolerance=-i*this.boxSize,this.scale=1/this.precisionTolerance),this.snapBaseX=this.bbox.min.x,this.snapBaseY=this.bbox.min.y,this.snapBaseZ=this.bbox.min.z,this.xymap={}}var t,n,i;return t=e,(n=[{key:"findOrAddPoint",value:function(e,t,n,i){for(var r,o=0|(e-this.snapBaseX)*this.scale,a=0|(t-this.snapBaseY)*this.scale,s=0|(n-this.snapBaseZ)*this.scale,c=1/0,u=o-1;u<=o+1;u++){var h=this.xymap[u];if(h)for(var d=a-1;d<=a+1;d++){var p=h[d];if(p)for(var f=s-1;f<=s+1;f++){var m=p[f];if(void 0!==m){this.getVertex(m,l);var g=(l.x-e)*(l.x-e)+(l.y-t)*(l.y-t)+(l.z-n)*(l.z-n);g<c&&(r=m,c=g)}}}}if(Math.sqrt(c)>this.precisionTolerance&&(r=void 0),void 0===r){var v=this.xymap[o];v||(v=this.xymap[o]={});var y=v[a];return y||(y=v[a]={}),y[s]=i,i}return r}}])&&s(t.prototype,n),i&&s(t,i),e}();function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var h=new r.LmvVector3,d=new r.LmvVector3,p=new r.LmvVector3,f=new r.LmvVector3,m=new r.LmvVector3,g=function(){function e(t,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var s=t.boundingBox||a,l=new o.LmvBox3;s&&l.copy(s),this.geom=t,this.myVerts=function(e,t){var n=new Float32Array(3*(0,i.getVertexCount)(e));return(0,i.enumMeshVertices)(e,(function(e,i,r,o){t&&t.expandByPoint(e),n[3*o]=e.x,n[3*o+1]=e.y,n[3*o+2]=e.z})),n}(t,s?null:l);var u=new c(this.getV.bind(this),l,-1/65536);this.remap=new Array((0,i.getVertexCount)(t));for(var h=0,d=0;h<this.myVerts.length;h+=3,d++)this.remap[d]=u.findOrAddPoint(this.myVerts[h],this.myVerts[h+1],this.myVerts[h+2],d);n&&function(e,t){for(var n=new r.LmvVector3,i=0;i<e.length;i+=3)n.x=e[i],n.y=e[i+1],n.z=e[i+2],n.applyMatrix4(t),e[i]=n.x,e[i+1]=n.y,e[i+2]=n.z}(this.myVerts,n)}var t,n,a;return t=e,(n=[{key:"getV",value:function(e,t){t.x=this.myVerts[3*e],t.y=this.myVerts[3*e+1],t.z=this.myVerts[3*e+2]}},{key:"getNormal",value:function(e,t,n,i){this.getV(e,h),this.getV(t,d),this.getV(n,p),d.sub(h),p.sub(h),d.cross(p),i.copy(d).normalize()}}])&&u(t.prototype,n),a&&u(t,a),e}();function v(e,t,n,r){if(!e.isLines&&!e.iblines){var o=new g(e,t,n),a={},s=[];for(var l in(0,i.enumMeshTriangles)(e,(function(e,t,n,i,r,o){u(i,r,o),u(r,o,i),u(o,i,r)})),a)for(var c in a[l])s.push(parseInt(l)),s.push(parseInt(c));s.length>1&&(e.iblines=new Uint16Array(s.length),e.iblines.set(s))}function u(e,t,n){var i=o.remap[e],l=o.remap[t],c=o.remap[n];if(i!==l&&i!==c&&l!==c){var u=!1;if(i>l){var h=i;i=l,l=h,u=!0}var d=a[i];if(d){var p=d[l];if(void 0===p)d[l]=u?-n-1:n;else{if(r)s.push(e),s.push(t);else{o.getNormal(e,t,n,f),p<0?o.getNormal(l,i,o.remap[-p-1],m):o.getNormal(i,l,o.remap[p],m);var g=f.dot(m);Math.abs(g)<.25&&(s.push(e),s.push(t))}delete d[l]}}else a[i]={},a[i][l]=n}}}},282:(e,t,n)=>{"use strict";n.r(t),n.d(t,{FragmentList:()=>g,FragmentPointer:()=>M});var i=n(92445),r=n(16453),o=n(46759),a=n(98926),s=n(59481),l=n(89812),c=new Uint32Array(1);function u(e){var t,n,i=this;this.geometry=e,this.vb=e.vb.buffer,this.vbi=new Int32Array(this.vb),this.vbs=new Uint16Array(this.vb),this.stride=e.vbstride,this.vcount=this.vbi.length/this.stride,this.useCompactBuffers=e.unpackXform,this.texData=this.useCompactBuffers&&(null===(t=e.tIdColor)||void 0===t||null===(n=t.image)||void 0===n?void 0:n.data)&&new Uint32Array(e.tIdColor.image.data.buffer),this.texColMap=function(){if(!i.texData)return null;for(var e={},t=new Set,n=0;n<i.vcount;++n){var r=i.vbs[n*i.stride*2+6];t.has(r)||(e[i.texData[r]]=r,t.add(r))}return e}()}u.prototype.setColorAt=function(e,t){if(this.texData){if(o=t,c[0]=o,!((t=c[0])in this.texColMap)){var n=this.texData;if(n.length+1>65536)return void a.logger.warn("setColorAt() cannot add new color as size limit reached");var i=new Uint32Array(n.length+1);i.set(n,0),i[n.length]=t,this.texColMap[t]=n.length;var r=new THREE.DataTexture(new Uint8Array(i.buffer),i.length,1,THREE.RGBAFormat,THREE.UnsignedByteType,THREE.UVMapping,THREE.ClampToEdgeWrapping,THREE.ClampToEdgeWrapping,THREE.NearestFilter,THREE.NearestFilter,0);r.generateMipmaps=!1,r.flipY=!1,r.needsUpdate=!0,this.geometry.tIdColor.dispose(),this.geometry.tIdColor=r,this.texData=new Uint32Array(r.image.data.buffer),this.geometry.vIdColorTexSize=new THREE.Vector2(i.length,1)}this.vbs[e*this.stride*2+6]=this.texColMap[t]}else this.vbi[e*this.stride+6]=t;var o},u.prototype.setVertexFlagsAt=function(e,t){this.texData?this.vbi[e*this.stride+4]=t:this.vbi[e*this.stride+8]=t};var h=new r.Matrix4,d=new r.Box3,p=new r.Quaternion,f=new r.Vector3,m=new r.Vector3;function g(e){this.is2d=e.is2d(),this.modelId=e.getModelId(),this.fragments=e.getData().fragments,this.geoms=e.getGeometryList(),this.isFixedSize=this.fragments.length>0,this.isFixedSize?(this.boxes=this.fragments.boxes,this.transforms=this.fragments.transforms,this.useThreeMesh=!i.memoryOptimizedLoading):(this.boxes=null,this.transforms=null,this.useThreeMesh=!0);var t=this.fragments.length;if(this.vizflags=new Uint16Array(t),this.useThreeMesh&&(this.vizmeshes=new Array(t)),e.isOTG()){var n=e.getData().metadata.stats,r=n.num_materials,o=n.num_geoms;this.materialids=(0,s.R)(t,r),this.geomids=(0,s.R)(t,o)}else this.geomids=new Int32Array(t),this.materialids=new Int32Array(t);this.materialmap={},this.materialIdMap={},this.nextMaterialId=1,this.db2ThemingColor=[],this.originalColors=[],this.themingOrGhostingNeedsUpdate={},this.themingOrGhostingNeedsUpdateByDbId={},this.dbIdOpacity=[],this.dbIdIsGhosted=[],this.animxforms=null;for(var a=0;a<t;a++)this.vizflags[a]=1;!e.isOTG()&&this.fragments.visibilityFlags&&this.vizflags.set(this.fragments.visibilityFlags),this.allVisible=!0,this.allVisibleDirty=!0,this.nextAvailableFragID=t,this.linesHidden=!1,this.pointsHidden=!1,this.matrix=null,this.viewBounds=null}function v(e){var t=e.r;return e.r=e.b,e.b=t,e}g.prototype.getNextAvailableFragmentId=function(){return this.nextAvailableFragID++},g.prototype.fragmentsHaveBeenAdded=function(){return this.vizflags.length>this.fragments.length},g.prototype.getSvfMaterialId=function(e){var t=this.getMaterial(e);return t?t.svfMatId:void 0},g.prototype.setMesh=function(e,t,n,i){if(this.vizmeshes){var s=this.vizmeshes[e];s&&s.parent&&s.parent.remove(s)}if(this.vizflags.length<=e){this.isFixedSize&&(a.logger.warn("Attempting to resize a fragments list that was initialized with fixed data. This will have a performance impact."),this.isFixedSize=!1);var l=Math.ceil(1.5*Math.max(this.vizflags.length,e))||1;this.useThreeMesh&&l<this.vizmeshes.length&&(l=this.vizmeshes.length);var c=new Uint16Array(l);if(c.set(this.vizflags),this.vizflags=c,this.transforms){var u=new Float32Array(12*l);u.set(this.transforms),this.transforms=u}if(this.boxes){var h=new Float32Array(6*l);h.set(this.boxes),this.boxes=h}if(this.geomids){var p=new Int32Array(l);p.set(this.geomids),this.geomids=p}if(this.materialids){var f=new Int32Array(l);f.set(this.materialids),this.materialids=f}}if(this.useThreeMesh){var m;i&&t instanceof r.Mesh?(m=t,t.matrix&&m.matrixWorld.copy(t.matrix),m.dbId=m.dbId||0):(m=new r.Mesh(t.geometry,t.material),t.matrix&&(m.matrix&&m.matrix.copy(t.matrix),m.matrixWorld.copy(t.matrix)),m.is2d=t.is2d,m.isLine=t.isLine,m.isWideLine=t.isWideLine,m.isPoint=t.isPoint,m.dbId=0|this.fragments.fragId2dbId[e]),m.matrixAutoUpdate=!1,m.frustumCulled=!1,m.fragId=e,m.modelId=this.modelId,this.matrix&&m.matrixWorld.multiplyMatrices(this.matrix,m.matrix),this.vizmeshes[e]=m}else{var g=void 0;t.geometry.hash?(void 0===t.geomId&&console.error("meshInfo must provide geomId"),g=t.geomId):g=t.geometry.svfid,this.geomids[e]=g,this.setMaterial(e,t.material)}var v=0;if(t.isLine?v=o.MeshFlags.MESH_ISLINE:t.isWideLine?v=o.MeshFlags.MESH_ISWIDELINE:t.isPoint&&(v=o.MeshFlags.MESH_ISPOINT),this.isFixedSize?this.vizflags[e]|=v:this.vizflags[e]|=o.MeshFlags.MESH_VISIBLE|v,n&&this.transforms&&this.boxes){var y=t.matrix,b=12*e,_=y.elements,x=this.transforms;if(x[b]=_[0],x[b+1]=_[1],x[b+2]=_[2],x[b+3]=_[4],x[b+4]=_[5],x[b+5]=_[6],x[b+6]=_[8],x[b+7]=_[9],x[b+8]=_[10],x[b+9]=_[12],x[b+10]=_[13],x[b+11]=_[14],!this.fragments.boxesLoaded){t.bbox?d.copy(t.bbox):(t.geometry&&t.geometry.boundingBox?d.copy(t.geometry.boundingBox):this.geoms.getModelBox(this.geomids[e],d),d.isEmpty()||d.applyMatrix4(y));var E=6*e,S=this.boxes;S[E]=d.min.x,S[E+1]=d.min.y,S[E+2]=d.min.z,S[E+3]=d.max.x,S[E+4]=d.max.y,S[E+5]=d.max.z}}!function(e,t){if(e.is2d&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.themingOrGhostingNeedsUpdateByDbId)){var n=e.getDbIds(t);(n=(n=Array.isArray(n)?n:[n]).filter((function(t){return e.themingOrGhostingNeedsUpdateByDbId[t]}))).length&&(w(e,t),n.forEach((function(t){delete e.themingOrGhostingNeedsUpdateByDbId[t]})))}}(this,e)},g.prototype.isFlagSet=function(e,t){return!!(this.vizflags[e]&t)},g.prototype.setFlagFragment=function(e,t,n){var i=this.vizflags[e];return!!(i&t)!=n&&(this.vizflags[e]=n?i|t:i&~t,!0)},g.prototype.setFlagGlobal=function(e,t){var n=this.vizflags,i=0,r=n.length;if(t)for(;i<r;i++)n[i]=n[i]|e;else for(var o=~e;i<r;i++)n[i]=n[i]&o},g.prototype.hideLines=function(e){this.linesHidden=e},g.prototype.hidePoints=function(e){this.pointsHidden=e},g.prototype.hideFragments=function(e,t){var n=o.MeshFlags.MESH_HIDE,i=this.vizflags,r=0,a=i.length;if(t)for(;r<a;r++)i[r]&e&&(i[r]=i[r]|n);else for(var s=~n;r<a;r++)i[r]&e&&(i[r]=i[r]&s);this.allVisibleDirty=!0},g.prototype.isFragVisible=function(e){var t=this.linesHidden&&(this.isLine(e)||this.isWideLine(e)),n=this.pointsHidden&&this.isPoint(e);return 1==(7&this.vizflags[e])&&!t&&!n},g.prototype.isFragOff=function(e){return!!(this.vizflags[e]&o.MeshFlags.MESH_HIDE)},g.prototype.isNotLoaded=function(e){return this.vizflags[e]&o.MeshFlags.MESH_NOTLOADED},g.prototype.isLine=function(e){return!!(this.vizflags[e]&o.MeshFlags.MESH_ISLINE)},g.prototype.isWideLine=function(e){return this.isFlagSet(e,o.MeshFlags.MESH_ISWIDELINE)},g.prototype.isPoint=function(e){return this.isFlagSet(e,o.MeshFlags.MESH_ISPOINT)},g.prototype.areAllVisible=function(){if(this.allVisibleDirty){for(var e=this.vizflags,t=!0,n=0,i=e.length;n<i;n++)if(0==(1&e[n])){t=!1;break}this.allVisible=t,this.allVisibleDirty=!1}return this.allVisible};var y,b,_,x,E=(y=null,b=null,_=parseInt("00FFFFFF",16),x=parseInt("FF000000",16),function(e,t){return y||(y=new r.Color,b=new r.Color),y.set(e&_),v(y),t&&(b.setRGB(t.x,t.y,t.z),y.lerp(b,t.w)),v(y).getHex()|e&x});function w(e,t){var n=e.originalColors[t],i=e.getGeometry(t);if(i&&i.vb){var r=new l.VertexBufferReader(i),o=new u(i);if(r.isInterleavedVb){for(var a=!1,s=r.vcount,c=0;c<s;c++){var h=r.getDbIdAt(c),d=n?n[c]:r.getColorAt(c),p=r.getLayerIndexAt(c),f=-1===(h=h<<8>>8)&&0===p,m=e.db2ThemingColor[h],g=0===e.dbIdOpacity[h];if(m||g){if(!n){n=new Uint32Array(s);for(var v=0;v<s;v++)n[v]=r.getColorAt(v);e.originalColors[t]=n}d=g?0:E(d,m),a=!0}else n&&(d=n[c]);if(!g){var y=e.dbIdOpacity[h];if(!isNaN(y))d=d&parseInt("00FFFFFF",16)|(y=255*y<<24)}o.setColorAt(c,d);var b=e.dbIdIsGhosted[h]&&!f,_=r.getVertexFlagsAt(c);b?_|=255<<24:_&=16777215,o.setVertexFlagsAt(c,_)}a||(e.originalColors[t]=null),i.vbNeedsUpdate=!0}}}var S;function A(e,t){if(e.is2d){var n=e.fragments.dbId2fragId[t];if(Array.isArray(n))for(var i=0;i<n.length;i++)e.themingOrGhostingNeedsUpdate[n[i]]=!0;else"number"==typeof n?e.themingOrGhostingNeedsUpdate[n]=!0:e.themingOrGhostingNeedsUpdateByDbId[t]=!0}}function M(e,t){this.frags=e,this.fragId=t,this.scale=null,this.quaternion=null,this.position=null}g.prototype.getVizmesh=function(e){if(this.is2d&&function(e,t){e.themingOrGhostingNeedsUpdate[t]&&(w(e,t),e.themingOrGhostingNeedsUpdate[t]=!1)}(this,e),this.useThreeMesh){var t=this.vizmeshes[e];return t&&(t.themingColor=this.db2ThemingColor[t.dbId]),t}var n=this.scratchMesh=this.scratchMesh||function(){var e=new r.Mesh(void 0,new r.MeshBasicMaterial);return e.isTemp=!0,e.dbId=0,e.modelId=0,e.fragId=-1,e.hide=!1,e.isLine=!1,e.isWideLine=!1,e.isPoint=!1,e}();return n.geometry=this.getGeometry(e),n.material=this.getMaterial(e),n.dbId=this.getDbIds(e),n.modelId=this.modelId,n.fragId=e,n.visible=!0,n.isLine=this.isLine(e),n.isWideLine=this.isWideLine(e),n.isPoint=this.isPoint(e),n.hide=this.isFragOff(e),n.themingColor=this.db2ThemingColor[n.dbId],this.getWorldMatrix(e,n.matrixWorld),n},g.prototype.getMaterialId=function(e){var t=this.getMaterial(e);return t?t.id:0},g.prototype.getMaterial=function(e){return this.useThreeMesh?this.vizmeshes[e].material:this.materialIdMap[this.materialids[e]]},g.prototype.getGeometry=function(e){var t;return this.useThreeMesh?(t=this.vizmeshes[e])?t.geometry:null:this.geoms.getGeometry(this.geomids[e])},g.prototype.getGeometryId=function(e){return this.useThreeMesh?e:this.geomids[e]},g.prototype.setMaterial=function(e,t){if(this.useThreeMesh)this.vizmeshes[e].material=t;else{var n=this.materialmap[t.id];n||(n=this.nextMaterialId++,this.materialids=(0,s.W)(this.materialids,n),this.materialIdMap[n]=t,this.materialmap[t.id]=n),this.materialids[e]=n}},g.prototype.getCount=function(){return this.vizmeshes?this.vizmeshes.length:this.vizflags.length},g.prototype.getDbIds=function(e){return this.fragments.fragId2dbId[e]},g.prototype.dispose=function(e){if(this.useThreeMesh)for(var t={type:"dispose"},n={type:"removed"},i=0;i<this.vizmeshes.length;i++){var r=this.vizmeshes[i];r&&(r.dispatchEvent(n),r.geometry.dispatchEvent(t))}else this.geoms.dispose(e)},g.prototype.dtor=function(e){this.dispose(e),this.scratchMesh=null,this.fragments=null,this.geoms=null,this.boxes=null,this.transforms=null,this.vizflags=null,this.vizmeshes=null,this.geomids=null,this.materialids=null,this.materialmap=null,this.materialIdMap=null,this.db2ThemingColor=null,this.originalColors=null,this.themingOrGhostingNeedsUpdate=null,this.themingOrGhostingNeedsUpdateByDbId=null,this.dbIdOpacity=null,this.dbIdIsGhosted=null,this.animxforms=null,this.matrix=null,this.viewBounds=null},g.prototype.setVisibility=function(e,t){this.setFlagFragment(e,o.MeshFlags.MESH_VISIBLE,t),this.allVisibleDirty=!0},g.prototype.setFragOff=function(e,t){this.setFlagFragment(e,o.MeshFlags.MESH_HIDE,t),this.allVisibleDirty=!0},g.prototype.setAllVisibility=function(e){if(this.is2d){var t=this.fragments;if(t&&t.dbId2fragId)for(var n in t.dbId2fragId)this.setObject2DGhosted(parseInt(n),!e)}else this.setFlagGlobal(o.MeshFlags.MESH_VISIBLE,e);this.allVisible=e,this.allVisibleDirty=!1},g.prototype.updateAnimTransform=function(e,t,n,i){var r,a=this.animxforms;if(!a){var s=this.getCount();a=this.animxforms=new Float32Array(10*s);for(var l=0;l<s;l++)a[r=10*l]=1,a[r+1]=1,a[r+2]=1,a[r+3]=0,a[r+4]=0,a[r+5]=0,a[r+6]=1,a[r+7]=0,a[r+8]=0,a[r+9]=0}r=10*e;var c=!1;t&&(a[r]=t.x,a[r+1]=t.y,a[r+2]=t.z,c=!0),n&&(a[r+3]=n.x,a[r+4]=n.y,a[r+5]=n.z,a[r+6]=n.w,c=!0),i&&(a[r+7]=i.x,a[r+8]=i.y,a[r+9]=i.z,c=!0),this.setFlagFragment(e,o.MeshFlags.MESH_MOVED,c),c||(a[r]=1,a[r+1]=1,a[r+2]=1,a[r+3]=0,a[r+4]=0,a[r+5]=0,a[r+6]=1,a[r+7]=0,a[r+8]=0,a[r+9]=0)},g.prototype.getAnimTransform=function(e,t,n,i){if(!this.animxforms)return!1;if(!this.isFlagSet(e,o.MeshFlags.MESH_MOVED))return!1;var r=10*e,a=this.animxforms;return t&&(t.x=a[r],t.y=a[r+1],t.z=a[r+2]),n&&(n.x=a[r+3],n.y=a[r+4],n.z=a[r+5],n.w=a[r+6]),i&&(i.x=a[r+7],i.y=a[r+8],i.z=a[r+9]),!0},g.prototype.getOriginalWorldMatrix=function(e,t){var n=12*e,i=t.elements,r=this.transforms;if(r)i[0]=r[n],i[1]=r[n+1],i[2]=r[n+2],i[3]=0,i[4]=r[n+3],i[5]=r[n+4],i[6]=r[n+5],i[7]=0,i[8]=r[n+6],i[9]=r[n+7],i[10]=r[n+8],i[11]=0,i[12]=r[n+9],i[13]=r[n+10],i[14]=r[n+11],i[15]=1;else if(this.useThreeMesh){var o=this.vizmeshes[e];o?t.copy(o.matrix):t.identity()}else t.identity()},g.prototype.getWorldMatrix=(S=new r.Matrix4,function(e,t){this.getOriginalWorldMatrix(e,t),this.isFlagSet(e,o.MeshFlags.MESH_MOVED)&&(this.getAnimTransform(e,m,p,f),S.compose(f,p,m),t.multiplyMatrices(S,t)),this.matrix&&t.multiplyMatrices(this.matrix,t)}),g.prototype.setModelMatrix=function(e){var t=this;e?(this.matrix=this.matrix||new r.Matrix4,this.matrix.copy(e),this.useThreeMesh&&this.vizmeshes.forEach((function(e){e.matrixWorld.multiplyMatrices(t.matrix,e.matrix)}))):(this.matrix=null,this.useThreeMesh&&this.vizmeshes.forEach((function(e){e.matrixWorld.copy(e.matrix)}))),this.invMatrix=null},g.prototype.getInverseModelMatrix=function(){return this.matrix?(this.invMatrix||(this.invMatrix=this.matrix.clone().invert()),this.invMatrix):null},g.prototype.getWorldBounds=function(e,t){if(this.boxes&&!this.isFlagSet(e,o.MeshFlags.MESH_MOVED)){var n=this.boxes,i=6*e;return t.min.x=n[i],t.min.y=n[i+1],t.min.z=n[i+2],t.max.x=n[i+3],t.max.y=n[i+4],t.max.z=n[i+5],void(this.matrix&&t.applyMatrix4(this.matrix))}if(this.useThreeMesh){var r=this.vizmeshes[e];r&&r.geometry&&t.copy(r.geometry.boundingBox)}else this.geoms.getModelBox(this.geomids[e],t);this.viewBounds&&t.intersect(this.viewBounds),t.isEmpty()||(this.getWorldMatrix(e,h),t.applyMatrix4(h))},g.prototype.getOriginalWorldBounds=function(e,t){if(this.boxes){var n=this.boxes,i=6*e;return t[0]=n[i],t[1]=n[i+1],t[2]=n[i+2],t[3]=n[i+3],t[4]=n[i+4],void(t[5]=n[i+5])}if(this.useThreeMesh){var r=this.vizmeshes[e];r&&r.geometry&&d.copy(r.geometry.boundingBox)}else this.geoms.getModelBox(this.geomids[e],d);d.isEmpty()||(this.getOriginalWorldMatrix(e,h),d.applyMatrix4(h)),t[0]=d.min.x,t[1]=d.min.y,t[2]=d.min.z,t[3]=d.max.x,t[4]=d.max.y,t[5]=d.max.z},g.prototype.setThemingColor=function(e,t){var n=this.db2ThemingColor[e];n===t||n&&t&&n.equals(t)||(this.db2ThemingColor[e]=t||void 0,A(this,e))},g.prototype.clearThemingColors=function(){if(this.is2d){for(var e in this.fragments.dbId2fragId)A(this,parseInt(e));delete this.db2ThemingColor[-1]}this.db2ThemingColor.length=0},g.prototype.setObject2DGhosted=function(e,t){!!t!=!!this.dbIdIsGhosted[e]&&(this.dbIdIsGhosted[e]=t,A(this,e))},g.prototype.setObject2DOpacity=function(e,t){t!==this.dbIdOpacity[e]&&(this.dbIdOpacity[e]=t,A(this,e))},g.prototype.setObject2DVisible=function(e,t){t!==(0!==this.dbIdOpacity[e])&&(this.dbIdOpacity[e]=0|t,A(this,e))},g.prototype.getViewBounds=function(){return this.viewBounds},g.prototype.setViewBounds=function(e){e?(this.viewBounds=this.viewBounds||new r.Box3,this.viewBounds.copy(e),e.max.hasOwnProperty("z")||(this.viewBounds.max.z=1/0,this.viewBounds.min.z=-1/0)):this.viewBounds=null},g.prototype.getDoNotCut=function(){return this.doNotCut},g.prototype.setDoNotCut=function(e){this.doNotCut=e},M.prototype.getWorldMatrix=function(e){this.frags.getWorldMatrix(this.fragId,e)},M.prototype.getOriginalWorldMatrix=function(e){this.frags.getOriginalWorldMatrix(this.fragId,e)},M.prototype.getWorldBounds=function(e){return this.frags.getWorldBounds(this.fragId,e)},M.prototype.getAnimTransform=function(){return this.scale||(this.scale=new r.Vector3(1,1,1),this.quaternion=new r.Quaternion(0,0,0,1),this.position=new r.Vector3(0,0,0)),this.frags.getAnimTransform(this.fragId,this.scale,this.quaternion,this.position)},M.prototype.updateAnimTransform=function(){this.scale||(this.scale=new r.Vector3(1,1,1),this.quaternion=new r.Quaternion(0,0,0,1),this.position=new r.Vector3(0,0,0)),this.frags.updateAnimTransform(this.fragId,this.scale,this.quaternion,this.position)},M.prototype.getMaterial=function(){return this.frags.getMaterial(this.fragId)},M.prototype.setMaterial=function(e){return this.frags.setMaterial(this.fragId,e)}},29747:(e,t,n)=>{"use strict";n.r(t),n.d(t,{FrustumIntersector:()=>o,OUTSIDE:()=>l,INTERSECTS:()=>c,CONTAINS:()=>u,CONTAINMENT_UNKNOWN:()=>h});var i=n(16453),r=[[1,5,4,7,3,2,6],[0,3,2,1,5,4,6],[0,3,2,6,5,4,6],[0,4,7,3,2,1,6],[0,3,2,1,-1,-1,4],[0,3,2,6,5,1,6],[0,4,7,6,2,1,6],[0,3,7,6,2,1,6],[0,3,7,6,5,1,6],[0,1,5,4,7,3,6],[0,1,5,4,-1,-1,4],[0,1,2,6,5,4,6],[0,4,7,3,-1,-1,4],[-1,-1,-1,-1,-1,-1,0],[1,2,6,5,-1,-1,4],[0,4,7,6,2,3,6],[2,3,7,6,-1,-1,4],[1,2,3,7,6,5,6],[0,1,5,6,7,3,6],[0,1,5,6,7,4,6],[0,1,2,6,7,4,6],[0,4,5,6,7,3,6],[4,5,6,7,-1,-1,4],[1,2,6,7,4,5,6],[0,4,5,6,2,3,6],[2,3,7,4,5,6,6],[1,2,3,7,4,5,6]];function o(){this.frustum=new i.Frustum,this.viewProj=new i.Matrix4,this.viewDir=[0,0,1],this.ar=1,this.viewport=new i.Vector3(1,1,1),this.areaConv=1,this.areaCullThreshold=1,this.eye=new i.Vector3,this.perspective=!1}var a,s,l=0,c=1,u=2,h=-1;function d(e,t,n){return n.x=1&t?e.max.x:e.min.x,n.y=2&t?e.max.y:e.min.y,n.z=4&t?e.max.z:e.min.z,n}o.OUTSIDE=l,o.INTERSECTS=c,o.CONTAINS=u,o.CONTAINMENT_UNKNOWN=h,o.prototype.reset=function(e,t){this.viewProj.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this.perspective=e.isPerspective,this.frustum.setFromProjectionMatrix(this.viewProj);var n=e.matrixWorldInverse.elements;this.ar=e.aspect,this.viewDir[0]=-n[2],this.viewDir[1]=-n[6],this.viewDir[2]=-n[10],this.eye.x=e.position.x,this.eye.y=e.position.y,this.eye.z=e.position.z,this.areaConv=e.clientWidth*e.clientHeight/4,this.cutPlanes=t},o.prototype.projectedArea=function(){var e=[new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3],t=new i.Box2;function n(e,t){var n=e.x,i=e.y,r=e.z,o=t.elements,a=o[3]*n+o[7]*i+o[11]*r+o[15];a<0&&(a=-a);var s=1/a;e.x=(o[0]*n+o[4]*i+o[8]*r+o[12])*s,e.y=(o[1]*n+o[5]*i+o[9]*r+o[13])*s}return function(i){if(i.isEmpty())return 0;var r=this.viewProj;e[0].set(i.min.x,i.min.y,i.min.z),e[1].set(i.min.x,i.min.y,i.max.z),e[2].set(i.min.x,i.max.y,i.min.z),e[3].set(i.min.x,i.max.y,i.max.z),e[4].set(i.max.x,i.min.y,i.min.z),e[5].set(i.max.x,i.min.y,i.max.z),e[6].set(i.max.x,i.max.y,i.min.z),e[7].set(i.max.x,i.max.y,i.max.z);for(var o=0;o<8;o++)n(e[o],r);return t.makeEmpty(),t.setFromPoints(e),t.min.x<-1&&(t.min.x=-1),t.min.x>1&&(t.min.x=1),t.min.y<-1&&(t.min.y=-1),t.min.y>1&&(t.min.y=1),t.max.x>1&&(t.max.x=1),t.max.x<-1&&(t.max.x=-1),t.max.y>1&&(t.max.y=1),t.max.y<-1&&(t.max.y=-1),(t.max.x-t.min.x)*(t.max.y-t.min.y)}}(),o.prototype.projectedBoxArea=function(){for(var e,t=[],n=[],o=0;o<10;o++)t.push(new i.Vector3),n.push(new i.Vector3);function a(e,t){var n=e.x,i=e.y,r=e.z,o=t.elements,a=o[3]*n+o[7]*i+o[11]*r+o[15];a<0&&(a=-a);var s=1/a;e.x=(o[0]*n+o[4]*i+o[8]*r+o[12])*s,e.y=(o[1]*n+o[5]*i+o[9]*r+o[13])*s}return function(i,o){if(i.isEmpty())return 0;var s,l=this.viewProj;if(this.perspective?(s=this.eye.x>=i.min.x?this.eye.x>i.max.x?2:1:0,this.eye.y>=i.min.y&&(s+=this.eye.y>i.max.y?6:3),this.eye.z>=i.min.z&&(s+=this.eye.z>i.max.z?18:9)):(s=this.viewDir[0]<=0?this.viewDir[0]<0?2:1:0,this.viewDir[1]<=0&&(s+=this.viewDir[1]<0?6:3),this.viewDir[2]<=0&&(s+=this.viewDir[2]<0?18:9)),13===s)return 4;var c,u=r[s][6];for(c=0;c<u;c++){var h=r[s][c];t[c].set((h+1)%4<2?i.min.x:i.max.x,h%4<2?i.min.y:i.max.y,h<4?i.min.z:i.max.z),a(t[c],l)}var d=0;if(o)for(d=(t[u-1].x-t[0].x)*(t[u-1].y+t[0].y),c=0;c<u-1;c++)d+=(t[c].x-t[c+1].x)*(t[c].y+t[c+1].y);else{var p=function(t,i){var r,o,a,s,l,c,u,h,d=t,p=n,f=function(e){switch(u){case 0:return e.x>=-1;case 1:return e.x<=1;case 2:return e.y>=-1;case 3:return e.y<=1}},m=function(e){p[h].x=e.x,p[h++].y=e.y},g=function(){var e,t;switch(u){case 0:e=-1,t=o.y+(a.y-o.y)*(e-o.x)/(a.x-o.x);break;case 1:e=1,t=o.y+(a.y-o.y)*(e-o.x)/(a.x-o.x);break;case 2:t=-1,e=o.x+(a.x-o.x)*(t-o.y)/(a.y-o.y);break;case 3:t=1,e=o.x+(a.x-o.x)*(t-o.y)/(a.y-o.y)}p[h].x=e,p[h++].y=t};for(u=0;u<4&&i>2;u++){for(h=0,s=f(o=d[i-1]),c=0;c<i;c++)l=f(a=d[c]),s?l?m(a):g():l&&(g(),m(a)),o=a,s=l;i=h,r=d,d=p,p=r}return e=i,d}(t,u);if(e>=3)for(d=(p[e-1].x-p[0].x)*(p[e-1].y+p[0].y),c=0;c<e-1;c++)d+=(p[c].x-p[c+1].x)*(p[c].y+p[c+1].y)}return Math.abs(.5*d)}}(),o.prototype.estimateDepth=function(e){var t=this.viewProj.elements,n=(e.min.x+e.max.x)/2,i=(e.min.y+e.max.y)/2,r=(e.min.z+e.max.z)/2,o=1/(t[3]*n+t[7]*i+t[11]*r+t[15]);return(t[2]*n+t[6]*i+t[10]*r+t[14])*o},o.prototype.intersectsBox=(a=new i.Vector3,s=new i.Vector3,function(e){for(var t=this.frustum.planes,n=0,i=0;i<6;i++){var r=t[i];a.x=r.normal.x>0?e.min.x:e.max.x,s.x=r.normal.x>0?e.max.x:e.min.x,a.y=r.normal.y>0?e.min.y:e.max.y,s.y=r.normal.y>0?e.max.y:e.min.y,a.z=r.normal.z>0?e.min.z:e.max.z,s.z=r.normal.z>0?e.max.z:e.min.z;var l=r.distanceToPoint(a),c=r.distanceToPoint(s);if(l<0&&c<0)return o.OUTSIDE;l>0&&c>0&&n++}return 6==n?o.CONTAINS:o.INTERSECTS});var p,f=function(e,t){p||(p=new i.Vector3);for(var n=0;n<8;n++){var r=d(e,n,p);if(a=t,!((o=r).x*a.x+o.y*a.y+o.z*a.z+a.w>1e-6))return!1}var o,a;return!0};o.prototype.boxOutsideCutPlanes=function(e){if(!this.cutPlanes)return!1;for(var t=0;t<this.cutPlanes.length;t++){var n=this.cutPlanes[t];if(f(e,n))return!0}return!1}},25920:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GeometryList:()=>a});var i=n(92445),r=n(84998),o=n(16453);function a(e,t,n,i){this.geoms=[null],this.numGeomsInMemory=0,this.geomMemory=0,this.gpuMeshMemory=0,this.gpuNumMeshes=0,this.geomPolyCount=0,this.instancePolyCount=0,this.is2d=t,this.geomBoxes=i?null:new Float32Array(6*Math.max(1,e+1)),this.numObjects=e,this.disableStreaming=!!n}a.prototype.getGeometry=function(e){return this.geoms[e]},a.prototype.chooseMemoryType=function(e,t,n,r){var o=i.GPU_MEMORY_LIMIT,a=2*o,s=i.GPU_OBJECT_LIMIT;if(0===o)return e.streamingDraw=!0,void(e.streamingIndex=!0);if(this.disableStreaming||r<o&&n<s)e.streamingDraw=!1,e.streamingIndex=!1;else if(r>=a)e.streamingDraw=!0,e.streamingIndex=!0;else{(this.is2d?100001:e.byteSize*(t||1))<1e5&&(e.streamingDraw=!0,e.streamingIndex=!0)}},a.prototype.addGeometry=function(e,t,n){var a;this.chooseMemoryType(e,t,this.gpuNumMeshes,this.gpuMeshMemory);var s=e.byteSize+i.GEOMETRY_OVERHEAD;if(e.streamingDraw||((0,r.isMobileDevice)()&&(s+=e.byteSize),this.gpuMeshMemory+=e.byteSize,this.gpuNumMeshes+=1),this.numGeomsInMemory++,(void 0===n||n<=0)&&(n=this.geoms.length),this.geoms[n]=e,this.geomBoxes){var l=this.geomBoxes.length/6|0;if(l<this.geoms.length){var c=3*this.geoms.length/2|0,u=new Float32Array(6*c);u.set(this.geomBoxes);var h=new o.Box3;for(h.makeEmpty();l<c;)u[6*l]=h.min.x,u[6*l+1]=h.min.y,u[6*l+2]=h.min.z,u[6*l+3]=h.max.x,u[6*l+4]=h.max.y,u[6*l+++5]=h.max.z;this.geomBoxes=u}var d=e.boundingBox;d?(this.geomBoxes[6*n]=d.min.x,this.geomBoxes[6*n+1]=d.min.y,this.geomBoxes[6*n+2]=d.min.z,this.geomBoxes[6*n+3]=d.max.x,this.geomBoxes[6*n+4]=d.max.y,this.geomBoxes[6*n+5]=d.max.z):(e.hash||console.error("Mesh without bbox and without hash should not be."),this.geomBoxes[6*n]=-.5,this.geomBoxes[6*n+1]=-.5,this.geomBoxes[6*n+2]=-.5,this.geomBoxes[6*n+3]=.5,this.geomBoxes[6*n+4]=.5,this.geomBoxes[6*n+5]=.5)}i.memoryOptimizedLoading&&!this.is2d&&(e.boundingBox=null,e.boundingSphere=null),this.geomMemory+=s;var p,f=(null===(a=e.index)||void 0===a?void 0:a.array)||e.ib,m=e.isLines?2:3;return p=f?f.length/m:e.vb?e.vb.length/(m*e.stride):e.attributes.position.length/(3*m),this.geomPolyCount+=p,this.instancePolyCount+=p*(t||1),e.polyCount=p,e.instanceCount=t||1,e.svfid=n,n},a.prototype.removeGeometry=function(e,t){var n=this.getGeometry(e);if(!n)return 0;var o=n.byteSize+i.GEOMETRY_OVERHEAD;return t&&t.deallocateGeometry(n),n.streamingDraw||((0,r.isMobileDevice)()&&(o+=n.byteSize),this.gpuMeshMemory-=n.byteSize,this.gpuNumMeshes-=1),this.geoms[e]=null,this.geomMemory-=o,this.numGeomsInMemory--,this.geomPolyCount-=n.polyCount,this.instancePolyCount-=n.instanceCount*n.polyCount,o},a.prototype.getModelBox=function(e,t){if(this.geomBoxes)if(0===e||this.geomBoxes.length/6<=e)t.makeEmpty();else{var n=6*e,i=this.geomBoxes;t.min.x=i[n],t.min.y=i[n+1],t.min.z=i[n+2],t.max.x=i[n+3],t.max.y=i[n+4],t.max.z=i[n+5]}else e>=1&&e<=this.numObjects?(t.min.x=-.5,t.min.y=-.5,t.min.z=-.5,t.max.x=.5,t.max.y=.5,t.max.z=.5):t.makeEmpty()},a.prototype.dispose=function(e){if(e)for(var t=0,n=this.geoms.length;t<n;t++)this.geoms[t]&&e.deallocateGeometry(this.geoms[t])},a.prototype.printStats=function(){console.log("Total geometry size: "+this.geomMemory/1048576+" MB"),console.log("Number of meshes: "+(this.geoms.length-1)),console.log("Num Meshes on GPU: "+this.gpuNumMeshes),console.log("Net GPU geom memory used: "+this.gpuMeshMemory)}},1840:(e,t,n)=>{"use strict";n.r(t),n.d(t,{InstanceTree:()=>s});var i=n(82197),r=n(98926),o=1073741824,a=2147483648;function s(e,t,n){this.nodeAccess=e,this.maxDepth=n,this.objectCount=t,this.numHidden=0,this.numOff=0,this.fragList=null}s.prototype.dtor=function(){this.nodeAccess.dtor(),this.nodeAccess=null,this.fragList=null},s.prototype.setFlagNode=function(e,t,n){var i=this.nodeAccess.getNodeFlags(e);return!!(i&t)!=n&&(n?this.nodeAccess.setNodeFlags(e,i|t):this.nodeAccess.setNodeFlags(e,i&~t),!0)},s.prototype.setFlagGlobal=function(e,t){var n=this.nodeAccess,i=0,r=n.numNodes;if(t)for(;i<r;i++)n.setNodeFlags(i,n.getNodeFlags(i)|e);else for(var o=~e;i<r;i++)n.setNodeFlags(i,n.getNodeFlags(i)&o)},s.prototype.setNodeOff=function(e,t){var n=this.setFlagNode(e,o,t);return n&&(t?this.numOff++:this.numOff--),n},s.prototype.isNodeOff=function(e){return!!(this.nodeAccess.getNodeFlags(e)&o)},s.prototype.setNodeHidden=function(e,t){var n=this.setFlagNode(e,a,t);return n&&(t?this.numHidden++:this.numHidden--),n},s.prototype.isNodeHidden=function(e){return!!(this.nodeAccess.getNodeFlags(e)&a)},s.prototype.lockNodeSelection=function(e,t){return this.setFlagNode(e,16384,t)},s.prototype.isNodeSelectionLocked=function(e){return!!(16384&this.nodeAccess.getNodeFlags(e))},s.prototype.lockNodeVisible=function(e,t){return this.setFlagNode(e,4096,t)},s.prototype.isNodeVisibleLocked=function(e){return!!(4096&this.nodeAccess.getNodeFlags(e))},s.prototype.isNodeExplodeLocked=function(e){return!!(8192&this.nodeAccess.getNodeFlags(e))},s.prototype.lockNodeExplode=function(e,t){return this.setFlagNode(e,8192,t)},s.prototype.getNodeType=function(e){return 7&this.nodeAccess.getNodeFlags(e)},s.prototype.isNodeSelectable=function(e){return!(536870912&this.nodeAccess.getNodeFlags(e))},s.prototype.getNodeParentId=function(e){return this.nodeAccess.getParentId(e)},s.prototype.getRootId=function(){return this.nodeAccess.rootId},s.prototype.getNodeName=function(e,t){return this.nodeAccess.name(e,t)},s.prototype.getChildCount=function(e){return this.nodeAccess.getNumChildren(e)};var l=new Array(6);s.prototype.getNodeBox=function(e,t){var n=this;if(!this.nodeAccess.nodeBoxes)return this.fragList?(t[0]=t[1]=t[2]=1/0,t[3]=t[4]=t[5]=-1/0,void this.enumNodeFragments(e,(function(e){n.fragList.getOriginalWorldBounds(e,l),t[0]=Math.min(t[0],l[0]),t[1]=Math.min(t[1],l[1]),t[2]=Math.min(t[2],l[2]),t[3]=Math.max(t[3],l[3]),t[4]=Math.max(t[4],l[4]),t[5]=Math.max(t[5],l[5])}),!0)):void r.logger.error("getNodeBox() requires fragBoxes or nodeBoxes");this.nodeAccess.getNodeBox(e,t)},s.prototype.getNodeIndex=function(e){return this.nodeAccess.getIndex(e)},s.prototype.enumNodeFragments=function(e,t,n){var i,r=this;"number"==typeof e?i=e:e&&(i=e.dbId);return function e(i){var o=r.nodeAccess.enumNodeFragments(i,t);return o||(n&&(o=r.enumNodeChildren(i,(function(t){return e(t)})))?o:void 0)}(i)},s.prototype.enumNodeChildren=function(e,t,n){var i,r=this;if("number"==typeof e?i=e:e&&(i=e.dbId),n&&t(i))return i;return function e(i){var o=r.nodeAccess.enumNodeChildren(i,(function(i){return t(i)?i:n?e(i):void 0}));if(o)return o}(i)},s.prototype.findNodeForSelection=function(e,t){if(t===i.SelectionMode.LEAF_OBJECT)return e;var n,r,o=e;if(t===i.SelectionMode.FIRST_OBJECT){var a=[];for(n=e;n;)a.push(n),n=this.getNodeParentId(n);for(var s=a.length-1;s>=0;s--)if(5!==(r=this.getNodeType(a[s]))&&2!==r&&3!==r){o=a[s];break}}else if(t===i.SelectionMode.LAST_OBJECT)for(n=e;n;){if(4===(r=this.getNodeType(n))){o=n;break}n=this.getNodeParentId(n)}return o},s.prototype.setFragmentList=function(e){this.fragList=e}},6420:(e,t,n)=>{"use strict";n.r(t),n.d(t,{FlatStringStorage:()=>o,InstanceTreeStorage:()=>a,InstanceTreeAccess:()=>l});var i=n(7913);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t?(this.buf=t.buf,this.idx=t.idx,this.next=t.next):(this.buf=new Uint8Array(256),this.next=0,this.idx=[0])}var t,n,o;return t=e,(n=[{key:"allocate",value:function(e){if(this.buf.length-this.next<e){var t=Math.max(3*this.buf.length/2,this.buf.length+e),n=new Uint8Array(t);n.set(this.buf),this.buf=n}}},{key:"add",value:function(e){if(null==e)return 0;if(!e.length)return this.idx.push(this.next),this.idx.length-1;var t=(0,i.Ss)(e,null);return this.allocate(t),this.next+=(0,i.Ss)(e,this.buf,this.next),this.idx.push(this.next),this.idx.length-1}},{key:"get",value:function(e){if(e){var t=this.idx[e-1],n=this.idx[e];return t===n?"":(0,i.MA)(this.buf,t,n-t)}}},{key:"flatten",value:function(){this.idx=s(this.idx)}}])&&r(t.prototype,n),o&&r(t,o),e}();function a(){this.nodes=[],this.nextNode=0,this.children=[],this.nextChild=0,this.dbIdToIndex={},this.names=[],this.s2i={},this.strings=new o,this.nameSuffixes=[],this.getIndex(0)}function s(e){var t=new Int32Array(e.length);return t.set(e),t}function l(e,t,n){this.nodes=e.nodes,this.children=e.children,this.dbIdToIndex=e.dbIdToIndex,this.names=e.names,this.nameSuffixes=e.nameSuffixes,this.strings=new o(e.strings),this.rootId=t,this.numNodes=this.nodes.length/5,this.visibleIds=null,this.nodeBoxes=n}a.prototype.getIndex=function(e){var t=this.dbIdToIndex[e];if(t)return t;t=this.nextNode++,this.nodes.push(e);for(var n=1;n<5;n++)this.nodes.push(0);return this.dbIdToIndex[e]=t,t},a.prototype.setNode=function(e,t,n,i,r,o){var a,s=this.getIndex(e),l=5*s,c=r.length,u=o&&o.length;for(u&&(c+=o.length),this.nodes[l+1]=t,this.nodes[l+2]=this.nextChild,this.nodes[l+3]=u?-c:c,this.nodes[l+4]=i,a=0;a<r.length;a++)this.children[this.nextChild++]=this.getIndex(r[a]);if(u)for(a=0;a<o.length;a++)this.children[this.nextChild++]=-o[a]-1;this.nextChild>this.children.length&&console.error("Child index out of bounds -- should not happen"),this.processName(s,n)},a.prototype.processName=function(e,t){var n,i,r=-1,o=-1;if(t&&(o=t.lastIndexOf("]"),-1!==(r=t.lastIndexOf("["))&&-1!==o||(r=t.lastIndexOf(":"),o=t.length)),r>=0&&o>r){n=t.slice(0,r+1);var a=t.slice(r+1,o);(i=parseInt(a,10))&&i+""===a||(n=t,i=0)}else n=t,i=0;var s=this.s2i[n];void 0===s&&(s=this.strings.add(n),this.s2i[n]=s),this.names[e]=s,this.nameSuffixes[e]=i},a.prototype.flatten=function(){this.nodes=s(this.nodes),this.children=s(this.children),this.names=s(this.names),this.nameSuffixes=s(this.nameSuffixes),this.strings.flatten(),this.s2i=null},l.prototype.dtor=function(){this.nodes=null,this.children=null,this.dbIdToIndex=null,this.names=null,this.nameSuffixes=null,this.strings=null,this.visibleIds=null,this.nodeBoxes=null},l.prototype.getNumNodes=function(){return this.numNodes},l.prototype.getIndex=function(e){return this.dbIdToIndex[e]},l.prototype.name=function(e,t){var n,i=this.dbIdToIndex[e],r=this.strings.get(this.names[i]),o=this.nameSuffixes[i];o?n="["===r.charAt(r.length-1)?r+o+"]":r+o:n=r;return t&&(this.childCounts||this.computeChildCounts(),this.childCounts[e]>0&&(n+=" ("+this.childCounts[e]+")")),n},l.prototype.getParentId=function(e){var t=this.dbIdToIndex[e];return this.nodes[5*t+1]},l.prototype.getNodeFlags=function(e){var t=this.dbIdToIndex[e];return this.nodes[5*t+4]},l.prototype.setNodeFlags=function(e,t){var n=this.dbIdToIndex[e];n&&(this.nodes[5*n+4]=t)},l.prototype.getNumChildren=function(e){var t=this.dbIdToIndex[e],n=this.nodes[5*t+3];if(n>=0)return n;var i=this.nodes[5*t+2];n=Math.abs(n);for(var r=0,o=0;o<n;o++){if(this.children[i+o]<0)break;r++}return r},l.prototype.getNumFragments=function(e){var t=this.dbIdToIndex[e],n=this.nodes[5*t+3];if(n>=0)return 0;for(var i=this.nodes[5*t+2],r=0,o=(n=Math.abs(n))-1;o>=0;o--){if(this.children[i+o]>=0)break;r++}return r},l.prototype.getNodeBox=function(e,t){for(var n=6*this.getIndex(e),i=0;i<6;i++)t[i]=this.nodeBoxes[n+i]},l.prototype.getVisibleIds=function(){return this.visibleIds||(this.visibleIds=Object.keys(this.dbIdToIndex).map((function(e){return parseInt(e)}))),this.visibleIds},l.prototype.enumNodeChildren=function(e,t){var n=this.dbIdToIndex[e],i=this.nodes[5*n+2],r=this.nodes[5*n+3];r=Math.abs(r);for(var o=0;o<r;o++){var a=this.children[i+o];if(a<0)break;if(t(this.nodes[5*a+0],e,n))return e}},l.prototype.enumNodeFragments=function(e,t){var n=this.dbIdToIndex[e],i=this.nodes[5*n+2],r=this.nodes[5*n+3];if(r<0){r=-r;for(var o=0;o<r;o++){var a=this.children[i+o];if(!(a>0)&&t(-a-1,e,n))return e}}},l.prototype.computeBoxes=function(e){this.nodeBoxes||(this.nodeBoxes=new Float32Array(6*this.numNodes));var t=this,n=t.getIndex(t.rootId),i=t.nodeBoxes;function r(e,n,r){var o=t.getIndex(e);a(e,o);for(var s=6*r,l=6*o,c=0;c<3;c++)i[s+c]>i[l+c]&&(i[s+c]=i[l+c]),i[s+c+3]<i[l+c+3]&&(i[s+c+3]=i[l+c+3])}function o(t,n,r){for(var o=6*t,a=6*r,s=0;s<3;s++)i[a+s]>e[o+s]&&(i[a+s]=e[o+s]),i[a+s+3]<e[o+s+3]&&(i[a+s+3]=e[o+s+3])}function a(e,n){var a=6*n;i[a]=i[a+1]=i[a+2]=1/0,i[a+3]=i[a+4]=i[a+5]=-1/0,t.getNumChildren(e)&&t.enumNodeChildren(e,r,!0),t.getNumFragments(e)&&t.enumNodeFragments(e,o)}a(t.rootId,n)},l.prototype.computeChildCounts=function(){this.childCounts||(this.childCounts=new Uint32Array(this.numNodes));var e=this,t=(e.getIndex(e.rootId),e.childCounts);function n(n,r,o){var a=i(n,e.getIndex(n));t[r]+=a}function i(i,r){var o=0;return 4===e.getNodeFlags(i)?o=1:(e.getNumChildren(i)&&e.enumNodeChildren(i,n,!0),e.getNumFragments(i)&&(o=1)),o+t[i]}i(e.rootId)}},59481:(e,t,n)=>{"use strict";function i(e,t){return t<=255?new Uint8Array(e):t<=65535?new Uint16Array(e):new Uint32Array(e)}function r(e,t){if(t<=255)return e;if(t<=65535&&e instanceof Uint8Array){var n=new Uint16Array(e.length);return n.set(e),n}if(!e instanceof Uint32Array){var i=new Uint32Array(e.length);return i.set(e),i}return e}n.d(t,{R:()=>i,W:()=>r})},22585:(e,t,n)=>{"use strict";n.r(t),n.d(t,{LmvBox3:()=>a});var i,r,o=n(73075),a=function(e,t){this.min=void 0!==e?e:new o.LmvVector3(1/0,1/0,1/0),this.max=void 0!==t?t:new o.LmvVector3(-1/0,-1/0,-1/0)};a.prototype={constructor:a,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromArray:function(e,t){return this.min.x=e[t],this.min.y=e[t+1],this.min.z=e[t+2],this.max.x=e[t+3],this.max.y=e[t+4],this.max.z=e[t+5],this},copyToArray:function(e,t){e[t]=this.min.x,e[t+1]=this.min.y,e[t+2]=this.min.z,e[t+3]=this.max.x,e[t+4]=this.max.y,e[t+5]=this.max.z},setFromCenterAndSize:(r=new o.LmvVector3,function(e,t){var n=r.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},isEmpty:function(){return this.empty()},center:function(e){return console.warn("LmvBox3.center() is deprecated. Use LmvBox3.getCenter() instead."),this.getCenter(e)},getCenter:function(e){return(e||new o.LmvVector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){return(e||new o.LmvVector3).subVectors(this.max,this.min)},getSize:function(e){return(e||new o.LmvVector3).subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return(t||new o.LmvVector3).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsBox:function(e){return this.isIntersectionBox(e)},clampPoint:function(e,t){return(t||new o.LmvVector3).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new o.LmvVector3;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:(i=[new o.LmvVector3,new o.LmvVector3,new o.LmvVector3,new o.LmvVector3,new o.LmvVector3,new o.LmvVector3,new o.LmvVector3,new o.LmvVector3],function(e){return i[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),i[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),i[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),i[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),i[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),i[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),i[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),i[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.makeEmpty(),this.setFromPoints(i),this}),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}},43586:(e,t,n)=>{"use strict";n.r(t),n.d(t,{LmvMatrix4:()=>r});var i=n(73075),r=function(e){this.elements=e?new Float64Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]):new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.isDoublePrecision=!!e};r.prototype={constructor:r,set:function(e,t,n,i,r,o,a,s,l,c,u,h,d,p,f,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=i,g[1]=r,g[5]=o,g[9]=a,g[13]=s,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(e){return this.elements.set(e.elements),this},makeRotationFromQuaternion:function(e){var t=this.elements,n=e.x,i=e.y,r=e.z,o=e.w,a=n+n,s=i+i,l=r+r,c=n*a,u=n*s,h=n*l,d=i*s,p=i*l,f=r*l,m=o*a,g=o*s,v=o*l;return t[0]=1-(d+f),t[4]=u-v,t[8]=h+g,t[1]=u+v,t[5]=1-(c+f),t[9]=p-m,t[2]=h-g,t[6]=p+m,t[10]=1-(c+d),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},multiply:function(e){return this.multiplyMatrices(this,e)},multiplyMatrices:function(e,t){var n=e.elements,i=t.elements,r=this.elements,o=n[0],a=n[4],s=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],v=n[3],y=n[7],b=n[11],_=n[15],x=i[0],E=i[4],w=i[8],S=i[12],A=i[1],M=i[5],T=i[9],C=i[13],P=i[2],L=i[6],R=i[10],D=i[14],I=i[3],O=i[7],N=i[11],k=i[15];return r[0]=o*x+a*A+s*P+l*I,r[4]=o*E+a*M+s*L+l*O,r[8]=o*w+a*T+s*R+l*N,r[12]=o*S+a*C+s*D+l*k,r[1]=c*x+u*A+h*P+d*I,r[5]=c*E+u*M+h*L+d*O,r[9]=c*w+u*T+h*R+d*N,r[13]=c*S+u*C+h*D+d*k,r[2]=p*x+f*A+m*P+g*I,r[6]=p*E+f*M+m*L+g*O,r[10]=p*w+f*T+m*R+g*N,r[14]=p*S+f*C+m*D+g*k,r[3]=v*x+y*A+b*P+_*I,r[7]=v*E+y*M+b*L+_*O,r[11]=v*w+y*T+b*R+_*N,r[15]=v*S+y*C+b*D+_*k,this},multiplyToArray:function(e,t,n){var i=this.elements;return this.multiplyMatrices(e,t),n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],o=e[1],a=e[5],s=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+r*s*u-i*l*u-r*a*h+n*l*h+i*a*d-n*s*d)+e[7]*(+t*s*d-t*l*h+r*o*h-i*o*d+i*l*c-r*s*c)+e[11]*(+t*l*u-t*a*d-r*o*u+n*o*d+r*a*c-n*l*c)+e[15]*(-i*a*c-t*s*u+t*a*h+i*o*u-n*o*h+n*s*c)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},flattenToArrayOffset:function(e,t){var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},invert:function(e){var t=this.elements,n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],v=t[15],y=h*g*c-m*d*c+m*l*p-s*g*p-h*l*v+s*d*v,b=f*d*c-u*g*c-f*l*p+a*g*p+u*l*v-a*d*v,_=u*m*c-f*h*c+f*s*p-a*m*p-u*s*v+a*h*v,x=f*h*l-u*m*l-f*s*d+a*m*d+u*s*g-a*h*g,E=n*y+i*b+r*_+o*x;if(0===E)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var w=1/E;return t[0]=y*w,t[1]=(m*d*o-h*g*o-m*r*p+i*g*p+h*r*v-i*d*v)*w,t[2]=(s*g*o-m*l*o+m*r*c-i*g*c-s*r*v+i*l*v)*w,t[3]=(h*l*o-s*d*o-h*r*c+i*d*c+s*r*p-i*l*p)*w,t[4]=b*w,t[5]=(u*g*o-f*d*o+f*r*p-n*g*p-u*r*v+n*d*v)*w,t[6]=(f*l*o-a*g*o-f*r*c+n*g*c+a*r*v-n*l*v)*w,t[7]=(a*d*o-u*l*o+u*r*c-n*d*c-a*r*p+n*l*p)*w,t[8]=_*w,t[9]=(f*h*o-u*m*o-f*i*p+n*m*p+u*i*v-n*h*v)*w,t[10]=(a*m*o-f*s*o+f*i*c-n*m*c-a*i*v+n*s*v)*w,t[11]=(u*s*o-a*h*o-u*i*c+n*h*c+a*i*p-n*s*p)*w,t[12]=x*w,t[13]=(u*m*r-f*h*r+f*i*d-n*m*d-u*i*g+n*h*g)*w,t[14]=(f*s*r-a*m*r-f*i*l+n*m*l+a*i*g-n*s*g)*w,t[15]=(a*h*r-u*s*r+u*i*l-n*h*l-a*i*d+n*s*d)*w,this},getInverse:function(e,t){if(console.warn("LmvMatrix4.getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert(),0===this.determinant()){var n="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(n);console.warn(n),this.identity()}return this},scale:function(e){var t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,Math.max(n,i)))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),i=Math.sin(t),r=1-n,o=e.x,a=e.y,s=e.z,l=r*o,c=r*a;return this.set(l*o+n,l*a-i*s,l*s+i*a,0,l*a+i*s,c*a+n,c*s-i*o,0,l*s-i*a,c*s+i*o,r*s*s+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},compose:function(e,t,n){return this.makeRotationFromQuaternion(t),this.scale(n),this.setPosition(e),this},decompose:function(){var e=new i.LmvVector3,t=new r(!0);return function(n,i,r){var o=this.elements,a=e.set(o[0],o[1],o[2]).length(),s=e.set(o[4],o[5],o[6]).length(),l=e.set(o[8],o[9],o[10]).length();this.determinant()<0&&(a=-a),n.x=o[12],n.y=o[13],n.z=o[14],t.elements.set(this.elements);var c=1/a,u=1/s,h=1/l;return t.elements[0]*=c,t.elements[1]*=c,t.elements[2]*=c,t.elements[4]*=u,t.elements[5]*=u,t.elements[6]*=u,t.elements[8]*=h,t.elements[9]*=h,t.elements[10]*=h,i.setFromRotationMatrix(t),r.x=a,r.y=s,r.z=l,this}}(),transformPoint:function(e){var t=e.x,n=e.y,i=e.z,r=this.elements;return e.x=r[0]*t+r[4]*n+r[8]*i+r[12],e.y=r[1]*t+r[5]*n+r[9]*i+r[13],e.z=r[2]*t+r[6]*n+r[10]*i+r[14],e},transformDirection:function(e){var t=e.x,n=e.y,i=e.z,r=this.elements;e.x=r[0]*t+r[4]*n+r[8]*i,e.y=r[1]*t+r[5]*n+r[9]*i,e.z=r[2]*t+r[6]*n+r[10]*i;var o=Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z);if(o>0){var a=1/o;e.x*=a,e.y*=a,e.z*=a}return e},equals:function(e){for(var t=this.elements,n=e.elements,i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0},fromArray:function(e){return this.elements.set(e),this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},clone:function(){return new r(this.isDoublePrecision).fromArray(this.elements)}}},73075:(e,t,n)=>{"use strict";n.r(t),n.d(t,{LmvVector3:()=>s});var i,r,o,a,s=function(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0};s.prototype={constructor:s,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyMatrix3:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this},applyMatrix4:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i+r[12],this.y=r[1]*t+r[5]*n+r[9]*i+r[13],this.z=r[2]*t+r[6]*n+r[10]*i+r[14],this},applyProjection:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements,o=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*o,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*o,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*o,this},applyQuaternion:function(e){var t=this.x,n=this.y,i=this.z,r=e.x,o=e.y,a=e.z,s=e.w,l=s*t+o*i-a*n,c=s*n+a*t-r*i,u=s*i+r*n-o*t,h=-r*t-o*n-a*i;return this.x=l*s+h*-r+c*-a-u*-o,this.y=c*s+h*-o+u*-r-l*-a,this.z=u*s+h*-a+l*-o-c*-r,this},transformDirection:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize(),this},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t}else this.x=0,this.y=0,this.z=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this},clampScalar:function(e,t){return void 0===o&&(o=new s,a=new s),o.set(e,e,e),a.set(t,t,t),this.clamp(o,a)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e),this},cross:function(e,t){if(void 0!==t)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var n=this.x,i=this.y,r=this.z;return this.x=i*e.z-r*e.y,this.y=r*e.x-n*e.z,this.z=n*e.y-i*e.x,this},crossVectors:function(e,t){var n=e.x,i=e.y,r=e.z,o=t.x,a=t.y,s=t.z;return this.x=i*s-r*a,this.y=r*o-n*s,this.z=n*a-i*o,this},projectOnVector:function(e){return void 0===i&&(i=new s),i.copy(e).normalize(),r=this.dot(i),this.copy(i).multiplyScalar(r)},projectOnPlane:function(){var e;return function(t){return void 0===e&&(e=new s),e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e;return function(t){return void 0===e&&(e=new s),this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i},setEulerFromRotationMatrix:function(e,t){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(e,t){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},setFromMatrixPosition:function(e){return this.x=e.elements[12],this.y=e.elements[13],this.z=e.elements[14],this},setFromMatrixScale:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),n=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),i=this.set(e.elements[8],e.elements[9],e.elements[10]).length();return this.x=t,this.y=n,this.z=i,this},setFromMatrixColumn:function(e,t){var n=4*e,i=t.elements;return this.x=i[n],this.y=i[n+1],this.z=i[n+2],this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromAttribute:function(e,t,n){return void 0===n&&(n=0),t=t*e.itemSize+n,this.x=e.array[t],this.y=e.array[t+1],this.z=e.array[t+2],this}}},46759:(e,t,n)=>{"use strict";n.r(t),n.d(t,{MeshFlags:()=>i});var i={MESH_VISIBLE:1,MESH_HIGHLIGHTED:2,MESH_HIDE:4,MESH_ISLINE:8,MESH_MOVED:16,MESH_RENDERFLAG:32,MESH_NOTLOADED:64,MESH_ISPOINT:128,MESH_ISWIDELINE:256,MESH_TRAVERSED:512,MESH_DRAWN:1024}},44669:(e,t,n)=>{"use strict";n.d(t,{i:()=>c});var i=n(16453);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=new i.Vector3,a=new Float32Array(6),s="hierarchy",l=s,c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,c;return t=e,c=[{key:"setStrategy",value:function(e){if(l!==e)return l=e,!0}},{key:"getStrategy",value:function(){return l}},{key:"explode",value:function(e,t){var n=e.getData().instanceTree,r=e.getFragmentList(),c=e.getVisibleBounds(!0).getCenter(new i.Vector3);l===s&&n&&0!==t?function(e,t,n,i){var r=(n*=2)*(e.maxDepth-1)+1;1===e.maxDepth&&(r=n);var s=0|r,l=r-s;function c(i,r,u,h,d,p,f,m){var g=2*n;r==s&&(g*=l),e.getNodeBox(i,a);var v=.5*(a[0]+a[3]),y=.5*(a[1]+a[4]),b=.5*(a[2]+a[5]);r>0&&r<=s&&(p+=(v-u)*g,f+=(y-h)*g,m+=(b-d)*g),e.isNodeExplodeLocked(i)&&(p=f=m=0),e.enumNodeChildren(i,(function(e){c(e,r+1,v,y,b,p,f,m)}),!1),o.x=p,o.y=f,o.z=m,e.enumNodeFragments(i,(function(e){t.updateAnimTransform(e,null,null,o)}),!1)}c(e.getRootId(),0,i.x,i.y,i.z,0,0,0)}(n,r,t,c):function(e,t,n,i){var r,a,s=e.fragments.boxes;e.useThreeMesh?r=e.vizmeshes:a=e.fragments.fragId2dbId;for(var l=0,c=e.getCount();l<c;l++)if(0==n||t&&t.isNodeExplodeLocked(r?r[l]&&r[l].dbId:a[l]))e.updateAnimTransform(l);else{var u=6*l,h=.5*(s[u]+s[u+3]),d=.5*(s[u+1]+s[u+4]),p=.5*(s[u+2]+s[u+5]);o.x=n*(h-i.x),o.y=n*(d-i.y),o.z=n*(p-i.z),e.updateAnimTransform(l,null,null,o)}}(r,n,t,c)}}],(n=null)&&r(t.prototype,n),c&&r(t,c),e}()},18187:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ModelIteratorBVH:()=>o});var i=n(29747),r=n(16453);function o(){var e,t,n,a,s,l=null,c=null,u=null,h=null,d=null,p=null,f=!0,m=!1,g=!1,v=new r.Box3,y=new r.Box3,b=!1,_=!0,x=null,E=null;function w(e){var i=p[e],r=n;for(1;r>t&&p[d[r-1]]>i;)d[r]=d[r-1],r--;d[r]=e,n++}function S(e){var t=l.getLeftChild(e);-1!==t&&(S(t),S(t+1)),v.makeEmpty(),-1!==t&&(l.getBoxThree(t,y),v.union(y),l.getBoxThree(t+1,y),v.union(y)),l.getPrimCount(e)&&(v.union(u[e].getBoundingBox()),v.union(u[e].getBoundingBoxHidden())),l.setBoxThree(e,v)}this.initialize=function(t,n,i,r){x=t,E=r,e=t.getFragmentList(),s=t.RenderBatch,r&&r.hasOwnProperty("prioritize_screen_size")&&(f=r.prioritize_screen_size),c=i,u=new Array(n.nodeCount),h=new Int8Array(n.nodeCount),l=n,d=new Int32Array(n.nodeCount+1),p=new Float32Array(n.nodeCount);for(var o=0;o<n.nodeCount;o++){var a=n.getPrimCount(o);a&&(u[o]=new s(e,c,n.getPrimStart(o),a),u[o].lastItem=u[o].start+a,u[o].numAdded=a,u[o].nodeIndex=o,8&n.getFlags(o)&&(u[o].sortObjects=!0),n.getBoxArray(o,u[o].bboxes))}},this.dtor=function(){s=null,e=null,x=null},this.addFragment=function(e,t){},this.reset=function(e){if(a=e,t=0,n=0,h[0]=h[1]=i.FrustumIntersector.CONTAINMENT_UNKNOWN,d[n++]=0,m=!1,g=!1,b=!1,_){for(var r=u,o=r.length,s=0;s<o;++s){var l=r[s];l&&l.resetVisStatus&&l.resetVisStatus()}_=!1}},this.nextBatch=function(){for(g||m||t!==n||(d[n++]=1,m=!0);t!==n;){var e=d[--n],r=h[e];if(r!==i.FrustumIntersector.CONTAINS&&(l.getBoxThree(e,v),r=a.intersectsBox(v)),r!==i.FrustumIntersector.OUTSIDE){var o,s,c=l.getLeftChild(e);if(-1!==c){var y=l.getFlags(e),_=a.viewDir[3&y]<0?1:0,x=y>>2&1,E=y>>3&1,S=0,A=0;f&&!m?(o=c+x,s=c+1-x,l.getBoxThree(o,v),p[o]=S=a.projectedBoxArea(v,r===i.FrustumIntersector.CONTAINS),l.getBoxThree(s,v),p[s]=A=a.projectedBoxArea(v,r===i.FrustumIntersector.CONTAINS),h[o]=h[s]=r,S>0&&w(o),A>0&&w(s)):(1^_^E&&(x=1-x),o=c+x,s=c+1-x,d[n++]=o,p[o]=-1,d[n++]=s,p[s]=-1,h[o]=h[s]=r)}if(0!==l.getPrimCount(e)){var M=u[e];return M.renderImportance=a.projectedBoxArea(M.getBoundingBox(),r===i.FrustumIntersector.CONTAINS),M}}m||g||t!==n||(d[n++]=1,m=!0)}return b=!0,null},this.skipOpaqueShapes=function(){m||g||(t=0,n=0,d[n++]=1,g=!0)},this.getVisibleBounds=function(e,t){for(var n=0;n<u.length;n++){var i=u[n];if(i){i.calculateBounds();var r=i.getBoundingBox();e.union(r),t.union(r),t.union(i.getBoundingBoxHidden())}}S(0),S(1)},this.rayCast=function(e,t,n){for(var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=[1,0],a=new r.Vector3;o.length;){var s=o.pop();if(l.getBoxThree(s,v),v.expandByScalar(.5),!(i.maxDistance&&v.distanceToPoint(e.ray.origin)>i.maxDistance)){var c=e.ray.intersectBox(v,a);if(null!==c){var h=l.getLeftChild(s);-1!==h&&(o.push(h),o.push(h+1));var d=l.getPrimCount(s);if(0!==d){var p=u[s];p.raycast(e,t,n)}}}}},this.intersectFrustum=function(e,t){for(var n=[1,i.FrustumIntersector.CONTAINMENT_UNKNOWN,0,i.FrustumIntersector.CONTAINMENT_UNKNOWN];n.length;){var r,o=n.pop(),a=n.pop();if(o===i.FrustumIntersector.CONTAINS?r=i.FrustumIntersector.CONTAINS:(l.getBoxThree(a,v),r=e.intersectsBox(v)),r!==i.FrustumIntersector.OUTSIDE){var s=l.getLeftChild(a);if(-1!==s&&(n.push(s),n.push(r),n.push(s+1),n.push(r)),0!==l.getPrimCount(a)){var c=u[a];c&&c.intersectFrustum(e,t,r===i.FrustumIntersector.CONTAINS)}}}},this.getSceneCount=function(){return u.length},this.getGeomScenes=function(){return u},this.done=function(){return b},this.resetVisStatus=function(){_=!0},this.clone=function(){var e=new o;return e.initialize(x,l,c,E),e}}},73080:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ModelIteratorLinear:()=>l});n(44971);var i=n(84998),r=n(29747);function o(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw o}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=function(){function e(t){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._frags=t.getFragmentList(),this._RenderBatch=t.RenderBatch,this._model=t,this._is2d=this._model.is2d(),this._fragsPerScene=(n=t.is2d(),r=500,n&&(r/=6),(0,i.isMobileDevice)()&&(r/=3),(r=Math.floor(r))>0?r:500),this._fragOrder=[],this._geomScenes=[],this._secondPassIndex=null;var o=this._frags.getCount();this._currentScene=0;for(var a=new Int32Array(o),s=0;s<o;s++)a[s]=s;this.setFragmentOrder(a,o)}var t,n,a;return t=e,(n=[{key:"dtor",value:function(){this.model=null,this._RenderBatch=null,this._frags=null}},{key:"setFragmentOrder",value:function(e,t){this._fragCount=t,this._fragOrder[0]=e;var n=Math.floor((this._fragCount+this._fragsPerScene-1)/this._fragsPerScene);this._geomScenes.length=n;for(var i=0;i<n;i++){var r=i*this._fragsPerScene,o=this._geomScenes[i]=new this._RenderBatch(this._frags,this._fragOrder,r,this._fragsPerScene),a=r+this._fragsPerScene;a>this._fragCount&&(a=this._fragCount),o.lastItem=a}}},{key:"addFragment",value:function(e){if(this._fragOrder[0].length<=e){var t=2*this._fragOrder[0].length;t<=e&&(t=e+1);var n=new Int32Array(t);n.set(this._fragOrder[0]),this._fragOrder[0]=n,this.visibleBoundsDirty=!0}this._fragOrder[0][e]=e;var i=Math.floor(e/this._fragsPerScene);if(this._geomScenes){var r=this._geomScenes[i];r&&!r.isSecondPass||(r=new this._RenderBatch(this._frags,this._fragOrder,i*this._fragsPerScene,this._fragsPerScene),null===this._secondPassIndex?this._geomScenes[i]=r:this.insertSceneToSecondPass(i,r)),r&&(r.onFragmentAdded(e),null!==this._secondPassIndex&&this._geomScenes[this._secondPassIndex+i].onFragmentAdded(e))}}},{key:"insertSceneToSecondPass",value:function(e,t){var n=this._geomScenes.slice(0,this._secondPassIndex),i=this._geomScenes.slice(this._secondPassIndex);n[e]=t,i[e]=this.cloneForSecondPass(t),this._secondPassIndex=n.length,this._geomScenes=n.concat(i)}},{key:"reset",value:function(e,t){if(this._currentScene=0,this._is2d&&this._geomScenes[0]&&(this._geomScenes[0].drawEnd=0,null!==this._secondPassIndex&&(this._geomScenes[this._secondPassIndex].drawEnd=0)),this._resetVisStatus){for(var n=this._geomScenes,i=n.length,r=0;r<i;++r){var o=n[r];o&&o.resetVisStatus&&o.resetVisStatus()}this._resetVisStatus=!1}}},{key:"getSceneCount",value:function(){return this._geomScenes.length}},{key:"getGeomScenes",value:function(){return this._geomScenes}},{key:"resetVisStatus",value:function(){this._resetVisStatus=!0}},{key:"done",value:function(){return!(this._is2d&&!this._model.isLoadDone())&&this._currentScene>=this._geomScenes.length-1&&(!(e=this._geomScenes[this._currentScene])||e.drawStart>=e.lastItem);var e}},{key:"nextBatch",value:function(){if(this._currentScene>=this.getSceneCount())return null;var e=this._geomScenes[this._currentScene];if(this._is2d){var t=this.areTwoPassesNeeded();if(e.lastItem>=e.start+e.count&&(++this._currentScene,this._geomScenes[this._currentScene]&&(this._geomScenes[this._currentScene].drawEnd=this._geomScenes[this._currentScene].start)),e.drawStart=e.drawEnd,e.drawEnd=e.lastItem,e.hasOwnProperty("drawStart")&&e.lastItem<=e.drawStart)return t&&!this._isSecondPass?(this._currentScene=this._secondPassIndex,this.nextBatch()):null;var n=!this._model.areAllVisible()||this._isSecondPass;e.renderImportance=n?-1:1e20,e.needsTwoPasses=t}else e.renderImportance=0,++this._currentScene;return e}},{key:"areTwoPassesNeeded",value:function(){var e=this._model.hasPaperTransparency();return e&&null===this._secondPassIndex&&this.addSecondPassScenes(),this._isSecondPass=!!(e&&this._currentScene>=this._secondPassIndex),e}},{key:"cloneForSecondPass",value:function(e){if(e){var t=e.clone();return t.isSecondPass=!0,t}}},{key:"addSecondPassScenes",value:function(){var e=this._geomScenes.length;e&&(this._geomScenes=this._geomScenes.concat(this._geomScenes.map(this.cloneForSecondPass)),this._secondPassIndex=e)}},{key:"getVisibleBounds",value:function(e,t){for(var n=this.getSceneCount(),i=0;i<n;i++){this._geomScenes[i].calculateBounds();var r=this._geomScenes[i].getBoundingBox();e.union(r),t.union(r),t.union(this._geomScenes[i].getBoundingBoxHidden())}}},{key:"rayCast",value:function(e,t,n){for(var i=this.getSceneCount(),r=0;r<i;r++)this._geomScenes[r].raycast(e,t,n)}},{key:"intersectFrustum",value:function(e,t){var n,i=o(this._geomScenes);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a){var s=e.intersectsBox(a.getBoundingBox());s!==r.FrustumIntersector.OUTSIDE&&a.intersectFrustum(e,t,s===r.FrustumIntersector.CONTAINS)}}}catch(e){i.e(e)}finally{i.f()}}},{key:"clone",value:function(){return new e(this._model)}}])&&s(t.prototype,n),a&&s(t,a),e}()},44971:(e,t,n)=>{"use strict";n.r(t),n.d(t,{RenderBatch:()=>u});var i=n(48862),r=n(29747),o=n(46759),a=n(2727),s=n(98926),l=new(n(22585).LmvBox3),c=null;function u(e,t,n,i){this.frags=e,this.indices=t,this.start=n,this.count=i,this.lastItem=n,this.overrideMaterial=null,this.sortDone=!1,this.numAdded=0,this.avgFrameTime=void 0,this.nodeIndex=void 0,this.bboxes=new Array(12),this.bboxes[0]=this.bboxes[1]=this.bboxes[2]=1/0,this.bboxes[3]=this.bboxes[4]=this.bboxes[5]=-1/0,this.bboxes[6]=this.bboxes[7]=this.bboxes[8]=1/0,this.bboxes[9]=this.bboxes[10]=this.bboxes[11]=-1/0,this.sortObjects=!1,this.sortDone=!1,this.sortByShaderDone=!1,this.frustumCulled=!0,this.forceVisible=!1,this.renderImmediate=!e.useThreeMesh,this.renderImportance=0}function h(e,t,n,i,r){var s,l=o.MeshFlags.MESH_RENDERFLAG,c=t[n]&~l;switch(e){case a.RenderFlags.RENDER_HIDDEN:s=!(c&o.MeshFlags.MESH_VISIBLE);break;case a.RenderFlags.RENDER_HIGHLIGHTED:s=c&o.MeshFlags.MESH_HIGHLIGHTED;break;default:s=1==(c&(o.MeshFlags.MESH_VISIBLE|o.MeshFlags.MESH_HIGHLIGHTED|o.MeshFlags.MESH_HIDE))}if(i){var u=c&(o.MeshFlags.MESH_ISLINE|o.MeshFlags.MESH_ISWIDELINE);s=s&&!u}if(r){var h=c&o.MeshFlags.MESH_ISPOINT;s=s&&!h}return t[n]=c|(s?l:0),s}function d(e,t,n,i,r){var o=!1;return n.getWorldBounds(i,l),e&&!t.intersectsBox(l)&&(o=!0),o||r||!t.boxOutsideCutPlanes(l)||(o=!0),o}u.prototype.clone=function(){var e=new u(this.frags,this.indices,this.start,this.count);return e.sortDone=this.sortDone,e.sortByShaderDone=this.sortByShaderDone,e.lastItem=this.lastItem,e.visibleStats=this.visibleStats,e.numAdded=this.numAdded,e.bboxes=this.bboxes.slice(),e},u.prototype.getIndices=function(){return Array.isArray(this.indices)?this.indices[0]:this.indices},u.prototype.sortByMaterial=function(){if(!(this.numAdded<this.count)){var e=this.frags,t=this.getIndices();if(t){var n=t.subarray(this.start,this.start+this.count);Array.prototype.sort.call(n,(function(t,n){var i=e.getMaterialId(t),r=e.getMaterialId(n);return void 0===i?r?1:0:void 0===r?-1:i-r})),this.numAdded=0,this.sortDone=!0}else s.logger.warn("Only indexed RenderSubsets can be sorted.")}},u.prototype.sortByShader=function(){if(this.sortDone&&!this.sortByShaderDone){var e=this.frags,t=this.getIndices().subarray(this.start,this.start+this.count);Array.prototype.sort.call(t,(function(t,n){var i=e.getMaterial(t),r=e.getMaterial(n),o=i.program.id-r.program.id;return o||i.id-r.id})),this.numAdded=0,this.sortByShaderDone=!0}},u.prototype.sortByDepth=function(e){var t=this.frags,n=this.getIndices(),i=e,r=l;if(n){(!c||c.length<this.count)&&(c=new Float32Array(this.count));var o,a,u=c,h=this.start;this.forEachNoMesh((function(e,n){t.getGeometry(e)?(t.getWorldBounds(e,r),u[n]=i.estimateDepth(r)):u[n]=-1/0}));for(var d=1;d<this.count;d++)for(var p=d;p>0&&u[p-1]<u[p];)o=u[p-1],u[p-1]=u[p],u[p]=o,a=n[h+p-1],n[h+p-1]=n[h+p],n[h+p]=a,p--}else s.logger.warn("Only indexed RenderSubsets can be sorted.")},u.prototype.addToBox=function(e,t){var n=t?6:0,i=this.bboxes;i[0+n]=Math.min(i[0+n],e.min.x),i[1+n]=Math.min(i[1+n],e.min.y),i[2+n]=Math.min(i[2+n],e.min.z),i[3+n]=Math.max(i[3+n],e.max.x),i[4+n]=Math.max(i[4+n],e.max.y),i[5+n]=Math.max(i[5+n],e.max.z)},u.prototype.getBoundingBox=function(e){e=e||l;var t=this.bboxes;return e.min.x=t[0],e.min.y=t[1],e.min.z=t[2],e.max.x=t[3],e.max.y=t[4],e.max.z=t[5],e},u.prototype.getBoundingBoxHidden=function(e){e=e||l;var t=this.bboxes;return e.min.x=t[6],e.min.y=t[7],e.min.z=t[8],e.max.x=t[9],e.max.y=t[10],e.max.z=t[11],e},u.prototype.onFragmentAdded=function(e){this.frags.getWorldBounds(e,l),this.addToBox(l,!1),this.sortDone=!1,this.lastItem<=e&&(this.lastItem=e+1,void 0!==this.visibleStats&&(this.visibleStats=0),this.numAdded++)},u.prototype.forEach=function(e,t,n){var i,r,a,s=this.getIndices(),l=this.frags,c=!this.sortByShaderDone;if(t||n||c)for(i=t===o.MeshFlags.MESH_RENDERFLAG&&this.hasOwnProperty("drawStart")?this.drawStart:this.start,r=this.lastItem;i<r;i++){a=s?s[i]:i;u=l.getVizmesh(a);!c||u&&u.material&&u.material.program&&!u.geometry_proxy||(c=!1),!(n||u&&u.geometry)||t&&!l.isFlagSet(a,t)||e(u,a)}else for(i=this.start,r=this.lastItem;i<r;i++){var u;a=s?s[i]:i,(u=l.getVizmesh(a))&&u.geometry&&e(u,a)}c&&this.sortByShader()},u.prototype.forEachNoMesh=function(e,t,n){for(var i=this.getIndices(),r=this.frags,o=this.start,a=this.lastItem;o<a;o++){var s,l=i?i[o]:o;if(r.useThreeMesh){var c=r.getVizmesh(l);c&&(s=c.geometry)}else s=r.getGeometry(l);!n&&!s||t&&!r.isFlagSet(l,t)||e(l,o-this.start)}},u.prototype.raycast=function(e,t,n){var r=this;!1!==e.ray.intersectsBox(this.getBoundingBox())&&this.forEach((function(a,s){if(!r.frags.isFlagSet(s,o.MeshFlags.MESH_HIDE)){if(n&&n.length){var c=0|r.frags.getDbIds(s);if(-1===n.indexOf(c))return}r.frags.getWorldBounds(s,l),l.expandByScalar(.5),e.ray.intersectsBox(l)&&i.VBIntersector.rayCast(a,e,t)}}),o.MeshFlags.MESH_VISIBLE)},u.prototype.intersectFrustum=function(e,t,n){var i=this;if(!n){var a=e.intersectsBox(this.getBoundingBox());if(a===r.FrustumIntersector.OUTSIDE)return;a===r.FrustumIntersector.CONTAINS&&(n=!0)}this.forEach((function(a,s){if(!i.frags.isFlagSet(s,o.MeshFlags.MESH_HIDE))if(n)t(s,n);else{i.frags.getWorldBounds(s,l);var c=e.intersectsBox(l);c!==r.FrustumIntersector.OUTSIDE&&t(s,c===r.FrustumIntersector.CONTAINS)}}),o.MeshFlags.MESH_VISIBLE)},u.prototype.calculateBounds=function(){var e=this;this.bboxes[0]=this.bboxes[1]=this.bboxes[2]=1/0,this.bboxes[3]=this.bboxes[4]=this.bboxes[5]=-1/0,this.bboxes[6]=this.bboxes[7]=this.bboxes[8]=1/0,this.bboxes[9]=this.bboxes[10]=this.bboxes[11]=-1/0,this.forEachNoMesh((function(t){e.frags.getWorldBounds(t,l);var n=e.frags.vizflags[t];e.addToBox(l,!(1&n))}),0,!0)},u.prototype.applyVisibility=function(){var e,t,n,i,l,c,u;function p(r,a){if((r||!e.useThreeMesh)&&r.geometry){if(d(l,n,e,a,u))return r?r.visible=!1:s.logger.warn("Unexpected null mesh"),void(t[a]=t[a]&~o.MeshFlags.MESH_RENDERFLAG);var p=h(i,t,a,e.linesHidden,e.pointsHidden);r&&(r.visible=!!p),c=c&&!p}}function f(r){if(e.getGeometryId(r))if(d(l,n,e,r,u))t[r]=t[r]&~o.MeshFlags.MESH_RENDERFLAG;else{var a=h(i,t,r,e.linesHidden,e.pointsHidden);c=c&&!a}}return function(o,s){c=!0,n=s;var h=(i=o)===a.RenderFlags.RENDER_HIDDEN?this.getBoundingBoxHidden():this.getBoundingBox(),d=n.intersectsBox(h);return d===r.FrustumIntersector.OUTSIDE||!(u=this.frags.doNotCut)&&s.boxOutsideCutPlanes(h)||(t=this.frags.vizflags,e=this.frags,l=d!==r.FrustumIntersector.CONTAINS,e.useThreeMesh?this.forEach(p,null):this.forEachNoMesh(f,0,!1),e=null),c}}()},2727:(e,t,n)=>{"use strict";n.r(t),n.d(t,{RenderFlags:()=>i});var i={RENDER_NORMAL:0,RENDER_HIGHLIGHTED:1,RENDER_HIDDEN:2,RENDER_SHADOWMAP:3,RENDER_FINISHED:4}},30190:(e,t,n)=>{"use strict";n.r(t),n.d(t,{RenderModel:()=>x});var i=n(92445),r=n(25920),o=n(282),a=n(44971),s=n(95920),l=n(45451),c=n(73080),u=n(18187),h=n(48862),d=n(16453),p=n(46759),f=n(2727),m=n(98926),g=n(43586),v=n(7724);var y,b=(y=new d.Vector4,function(e,t){y.copy(e);for(var n=0;n<t.length;n++)if(t[n].dot(y)>1e-6)return!0;return!1}),_=1;function x(){var e=this,t=new d.Box3,n=new d.Box3,y=new d.Box3;this.visibleBoundsDirty=!1,this.enforceBvh=!1;var x=0;this.id=_++;var E=null,w=null,S=null,A=null,M=null,T=null,C=null,P=null,L=0,R=null,D=f.RenderFlags.RENDER_NORMAL,I=!1,O=null,N=null,k=null;this._placementTransform,this._globalOffset,this._invPlacementWithOffset,this.getGeometryList=function(){return E},this.getFragmentList=function(){return w},this.getModelId=function(){return this.id},this.RenderBatch=a.RenderBatch;var F,U,B=!1;this.initialize=function(){var e=this.getData(),a=e.numGeoms||0,s=!function(e,t,n){return!(e&&e-3*t*2<=i.GPU_MEMORY_LIMIT&&n<i.GPU_OBJECT_LIMIT)}(e.packFileTotalSize,e.primitiveCount,a);E=new r.GeometryList(a,this.is2d(),s,this.isOTG()),w=new o.FragmentList(this);var l=this.getBoundingBox();l&&(t.copy(l),n.copy(l)),M=S=new c.ModelIteratorLinear(this)},this.getIterator=function(){return M},this.initFromCustomIterator=function(e){M=e,this.visibleBoundsDirty=!0},this.dtor=function(e){E=null,w&&(w.dtor(e),w=null),M&&M.dtor&&(M.dtor(),M=null),S&&(S.dtor(),S=null),C&&(C.dispose(),C=null),this.dispose()},this.activateFragment=function(e,i,r){w&&(w.setMesh(e,i,r),M.addFragment(e),w.getWorldBounds(e,y),t.union(y),n.union(y))},this.setFragment=function(e,i,r){return void 0===e&&(e=this.getFragmentList().getNextAvailableFragmentId()),w.setMesh(e,i,!0,r),S&&S.addFragment(e),A&&!w.fragmentsHaveBeenAdded()&&A.addFragment(e),w.getWorldBounds(e,y),t.union(y),n.union(y),e},this.setBVH=function(e,t,n){var i;(M=A=new u.ModelIteratorBVH).initialize(this,e,t,n),(null===(i=w)||void 0===i?void 0:i.matrix)&&this.invalidateBBoxes()},this.resetIterator=function(e,t,n){return I=!1,A&&!w.fragmentsHaveBeenAdded()&&(I=!0),I?M=A:S&&(M=S),L=0,D=n,R=t,M.reset(t,e),C&&C.reset(),M},this.setRaycastIterator=function(e){T=e},this.nextBatch=function(){for(;;){var e=M.nextBatch();if(L++,!e)return null;if(C&&e instanceof a.RenderBatch&&(e=C.consolidateNextBatch(e,R,D)),e.modelId=this.id,e instanceof d.Scene)return e;if(!this.applyVisibility(e,D,R))return e}},this.applyVisibility=function(e,t,n){var i=e.applyVisibility(t,n);return i||this.is2d()||(e.sortObjects&&!this.getFragmentList().useThreeMesh?e.sortByDepth(n):e.sortDone||e.sortByMaterial()),i},this.trimPageShadowGeometry=function(e){if(this.hasPageShadow()){var t=Autodesk.Viewing.Private.F2dShadowRatio;e=e.clone();var n=this.getMetadata("page_dimensions","page_width");e.max.x-=n*t,e.min.y+=n*t}return e},this.getVisibleBounds=function(e,i){var r;this.visibleBoundsDirty&&(t.makeEmpty(),n.makeEmpty(),M.getVisibleBounds(t,n,e),null===(r=T)||void 0===r||r.getVisibleBounds(t,n,e),this.visibleBoundsDirty=!1);var o=e?n:t;return i&&(o=this.trimPageShadowGeometry(o)),o},this.rayIntersect2D=(F=new d.Plane,U=new d.Vector3,function(t,n,i,r){var o=e.getBoundingBox(!0),a=o.getCenter(new d.Vector3),s=new d.Vector3;F.normal.set(0,0,1),F.constant=-a.z;var l=e.getModelToViewerTransform();if(l&&F.applyMatrix4(l),s=t.ray.intersectPlane(F,s)){U.copy(s);var c=e.getInverseModelToViewerTransform();if(c&&(U.applyMatrix4(c),U.z=a.z),o.containsPoint(U)){var u,h,p=null===(u=w)||void 0===u||null===(h=u.getMaterial(0))||void 0===h?void 0:h.cutplanes;if(p&&b(s,p))return;var f,m,g=t.ray.origin.distanceTo(s);if(g<t.near||g>t.far)return;if(r){var v=r(s);if(f=v[0],n&&n.length>0&&!n.includes(f))return;var y,_=v[1];if(0!==_&&_!==e.id)return;m=null===(y=w)||void 0===y?void 0:y.fragments.dbId2fragId[f]}var x={intersectPoint:s,point:s,distance:g,dbId:f&&e.remapDbIdFor2D(f),fragId:m,model:e};return i&&i.push(x),x}}}),this.rayIntersect=function(e,t,n,i,r,o){if(this.ignoreRayIntersect)return null;if(this.is2d())return this.rayIntersect2D(e,n,i,r);this.visibleBoundsDirty&&this.getVisibleBounds();var a,s=[];if(n&&n.length>0){var l=this.getInstanceTree(),c=[];if(l)for(a=0;a<n.length;a++)l.enumNodeFragments(n[a],(function(e){c.push(e)}),!0);else c=n;if(c.length>2)(T||M).rayCast(e,s,n);else for(a=0;a<c.length;a++){var u=w.getVizmesh(c[a]);if(u){var d=h.VBIntersector.rayCast(u,e,s,o);d&&s.push(d)}}}else{(T||M).rayCast(e,s,void 0,o)}if(!s.length)return null;s.sort((function(e,t){return e.distance-t.distance}));var p=!!i;for(i=i||[],a=0;a<s.length;a++){var f=s[a].fragId;if(this.isFragVisible(f)){var m=w.getMaterial(f);if(t&&m.transparent)continue;var g=s[a],v=!1;if(m&&m.cutplanes&&(v=b(g.point,m.cutplanes)),v||i.push(g),g.model=this,!p&&i.length>0)break}}var y=i[0]||null;return y&&(y.model=this),y},this.setHighlighted=function(e,t){if(!w)return!1;var n=w.setFlagFragment(e,p.MeshFlags.MESH_HIGHLIGHTED,t);return n&&(t?x++:x--),n},this.setVisibility=function(e,t){w?w.setVisibility(e,t):this.isLeaflet()&&M.setVisibility(t),this.invalidateBBoxes()},this.setAllVisibility=function(e){w?w.setAllVisibility(e):this.isLeaflet()&&M.setVisibility(e),this.invalidateBBoxes()},this.hideLines=function(e){w&&w.hideLines(e)},this.hidePoints=function(e){w&&w.hidePoints(e)},this.hasHighlighted=function(){return!!x},this.isFragVisible=function(e){return w.isFragVisible(e)},this.areAllVisible=function(){return!w||w.areAllVisible()},this.getGeomScenes=function(){return M&&M.getGeomScenes?M.getGeomScenes():[]},this.getRenderProgress=function(){var e=L/M.getSceneCount();return e>1?1:e},this.update=function(e){return!(!M||!M.update)&&M.update(e)},this.setThemingColor=function(e,t,n){if(w){e=this.reverseMapDbIdFor2D(e);var i=this.getInstanceTree();n&&i?i.enumNodeChildren(e,(function(e){w.setThemingColor(e,t)}),!0):w.setThemingColor(e,t)}else M.isModelIteratorTexQuad?M.setThemingColor(t):m.logger.warn("Theming colors are not supported by this model type.")},this.clearThemingColors=function(){w?w.clearThemingColors():M.isModelIteratorTexQuad&&M.clearThemingColor()},this.getLeaflet=function(){return M.isModelIteratorTexQuad?M:null},this.consolidate=function(e,t,n){var i=(0,s.consolidateFragmentList)(this,e,t,n,P);C=new l.ConsolidationIterator(w,i),P=i.consolidationMap},this.unconsolidate=function(){C&&(C.dispose(),C=null)},this.isConsolidated=function(){return!!C},this.getConsolidation=function(){return C?C.getConsolidation():null},this.setDbIdRemap=function(e){this.idRemap=e},this.remapDbId=function(e){return this.idRemap&&e>0&&e<this.idRemap.length?this.idRemap[e]:e},this.remapDbIdFor2D=function(e){return this.is2d()?this.remapDbId(e):e},this.reverseMapDbId=function(e){if(!this.idRemap||e<=0)return e;if(!this.reverseMap){this.reverseMap={};for(var t=0;t<this.idRemap.length;t++)this.reverseMap[this.idRemap[t]]=t}return this.reverseMap[e]},this.reverseMapDbIdFor2D=function(e){return this.is2d()?this.reverseMapDbId(e):e},this.updateRenderProxy=function(e,t){C&&C.updateRenderProxy(e,t)},this.skipOpaqueShapes=function(){M&&M.skipOpaqueShapes&&M.skipOpaqueShapes()},this.invalidateBBoxes=function(){this.visibleBoundsDirty=!0},this.changePaperVisibility=function(e){var t;this.is2d()&&(null===(t=w)||void 0===t||t.setObject2DVisible(-1,e))},this.hasPaperTransparency=function(){var e,t;if(!this.is2d())return!1;var n=null!==(e=null===(t=w)||void 0===t?void 0:t.dbIdOpacity[-1])&&void 0!==e?e:1;return n>0&&n<1},this.setModelTransform=function(e){M.isModelIteratorTexQuad?M.setModelMatrix(e):(w.setModelMatrix(e),C&&C.modelMatrixChanged()),this.invalidateBBoxes(),this.getVisibleBounds(!0),N=null,k=null},this.getModelTransform=function(){var e,t;return(null===(e=M)||void 0===e?void 0:e.isModelIteratorTexQuad)?M.getModelMatrix():null===(t=w)||void 0===t?void 0:t.matrix},this.getInverseModelTransform=function(){var e,t;return(null===(e=M)||void 0===e?void 0:e.isModelIteratorTexQuad)?M.getInverseModelMatrix():null===(t=w)||void 0===t?void 0:t.getInverseModelMatrix()},this.getPlacementTransform=function(){return O=O||new g.LmvMatrix4(!0),this._placementTransform||this.getData().placementTransform||O},this.getGlobalOffset=function(){return this._globalOffset||this.getData().globalOffset},this.setPlacementTransform=function(e){this._placementTransform=(this._placementTransform||new g.LmvMatrix4(!0)).copy(e),v.DynamicGlobalOffset.updateModelMatrix(this,e,this.getGlobalOffset())},this.setGlobalOffset=function(e){this._globalOffset=this._globalOffset||new d.Vector3,this._globalOffset.copy(e);var t=this.getPlacementTransform();v.DynamicGlobalOffset.updateModelMatrix(this,t,e)},this.getModelToViewerTransform=function(){var e;if(N)return N;var t=this.getModelTransform(),n=null===(e=this.getData())||void 0===e?void 0:e.placementWithOffset;return(t||n)&&(N=new d.Matrix4,t&&N.multiply(t),n&&N.multiply(n)),N},this.getInverseModelToViewerTransform=function(){if(k)return k;var e=this.getModelToViewerTransform();return e&&(k=e.clone().invert()),k},this.getInversePlacementWithOffset=function(){return this.myData.placementWithOffset?(this._invPlacementWithOffset||(this._invPlacementWithOffset=new g.LmvMatrix4(!0).copy(this.myData.placementWithOffset).invert()),this._invPlacementWithOffset):null},this.setInnerAttributes=function(e){var i;(this.id=e._id,t=e._visibleBounds,n=e._visibleBoundsWithHidden,y=e._tmpBox,this.enforceBvh=e._enforceBvh,x=e._numHighlighted,E=e._geoms,w=e._frags,C=e._consolidationIterator,P=e._consolidationMap,L=e._renderCounter,R=e._frustum,D=e._drawMode,I=e._bvhOn,this.idRemap=e._idRemap,this._reverseMap=e._reverseMap,!S&&e._linearIterator&&(S=e._linearIterator.clone(),e._linearIterator===e._iterator&&(M=S)),!A&&e._bvhIterator&&(A=e._bvhIterator.clone(),e._bvhIterator===e._iterator&&(M=A)),M)||(M=(null===(i=e._iterator)||void 0===i?void 0:i.clone)?e._iterator.clone():e._iterator)},this.getInnerAttributes=function(){return{_id:this.id,_visibleBounds:t,_visibleBoundsWithHidden:n,_tmpBox:y,_enforceBvh:this.enforceBvh,_numHighlighted:x,_geoms:E,_frags:w,_linearIterator:S,_bvhIterator:A,_iterator:M,_consolidationIterator:C,_consolidationMap:P,_renderCounter:L,_frustum:R,_drawMode:D,_bvhOn:I,_idRemap:this.idRemap,_reverseMap:this.reverseMap}},this.setDoNotCut=function(e,t){if(B!==t){B=t,w?w.setDoNotCut(t):this.isLeaflet()&&M.setDoNotCut(t);e.forEachInModel(this,!1,(function(n){var i;n.doNotCut=t,(null===(i=n.cutplanes)||void 0===i?void 0:i.length)>0===t&&(e._applyCutPlanes(n),n.needsUpdate=!0)}))}},this.getDoNotCut=function(){return B},this.setViewportBounds=function(e,t){this.isLeaflet()?M.setViewBounds(t):w&&(t=t||this.isPdf()&&this.getBoundingBox(!0,!0),w.setViewBounds(t),e.setViewportBoundsForModel(this,t)),this.invalidateBBoxes()},this.getViewportBounds=function(){var e;return this.isLeaflet()?M.getViewBounds():null===(e=w)||void 0===e?void 0:e.getViewBounds()}}},23305:(e,t,n)=>{"use strict";n.r(t),n.d(t,{RenderScene:()=>c});var i=n(92445),r=n(29747),o=n(16453),a=n(2727),s=n(25119),l=n(44669);function c(){var e=!1,t=!1,n=[],c=[],u=[],h=new o.Box3,d=[],p=new r.FrustumIntersector,f=new o.Raycaster,m=performance;this.enableNonResumableFrames=!1,this.budgetForTransparent=.1;var g=!1,v=[],y=null;function b(e,t){for(var n=0;n<e.length;n++){var i=e[n];if(i&&i.id===t)return i}return null}function _(e,t){void 0===e.avgFrameTime?e.avgFrameTime=t:e.avgFrameTime=.8*e.avgFrameTime+.2*t}this.frustum=function(){return p},this.findModel=function(e){return b(n,e)},this.findHiddenModel=function(e){return b(d,e)},this.addModel=function(e){-1===n.indexOf(e)&&(n.push(e),c.length=n.length,u.length=n.length,this.recomputeLinePrecision())},this.removeModel=function(e){var t=n.indexOf(e);return t>=0&&n.splice(t,1),c.length=n.length,u.length=n.length,this.recomputeLinePrecision(),t>=0},this.addHiddenModel=function(e){var t=d.indexOf(e);return t<0&&d.push(e),t<0},this.removeHiddenModel=function(e){var t=d.indexOf(e);return t>=0&&d.splice(t,1),t>=0},this.isEmpty=function(){return 0===n.length},this.needsRender=function(){return e},this.resetNeedsRender=function(){e=!1},this.recomputeLinePrecision=function(){for(var e=1,t=0,i=n.length;t<i;++t){var r=n[t].getData().bbox,a=.001*o.Box3.prototype.getBoundingSphere.call(r,new o.Sphere).radius;e=Math.min(e,a)}f.params.Line.threshold=e},this.frameResumePossible=function(){return!g},this.renderSome=function(e,i){for(var r,o,a=m.now(),s=this.budgetForTransparent*i;;){for(var l=0,u=null,h=0;h<c.length;h++){var d=c[h];if(o=n[h],d||(c[h]=d=o.nextBatch()),g&&i<s)d&&!d.sortObjects&&(o.skipOpaqueShapes(),d=o.nextBatch());null!==d&&(u||(l=h,u=d),d.renderImportance>u.renderImportance&&(l=h,u=d))}if(!u){t=!0;break}if(c[l]=n[l].nextBatch(),u.sortObjects&&g)v.push(u),i-=void 0===u.avgFrameTime?.05:u.avgFrameTime;else{e(u),u.hasOwnProperty("drawEnd")&&(u.drawEnd=u.lastItem);var p=(r=m.now())-a;a=r,_(u,p),i-=u.avgFrameTime}p=(r=m.now())-a;if(a=r,_(u,p),(i-=u.avgFrameTime)<=0)break}return v.length>0&&(!function(e,t,n){var i,r;for(i=0;i<e.length;i++){var o=(r=e[i]).boundingBox||r.getBoundingBox();r.cameraDistance=o.distanceToPoint(t.position)}e.sort((function(e,t){return t.cameraDistance-e.cameraDistance}));var a=performance.now();for(i=0;i<e.length;i++){n(r=e[i]);var s=performance.now(),l=s-a;a=s,_(r,l)}}(v,y,e),v.length=0),i},this.reset=function(e,r,o,l){if(t=!1,this.resetNeedsRender(),p.reset(e,l),p.areaCullThreshold=i.PIXEL_CULLING_THRESHOLD,n.length){g=this.enableNonResumableFrames&&o==s.ResetFlags.RESET_RELOAD&&r===a.RenderFlags.RENDER_NORMAL,y=e;for(var h=0;h<n.length;h++)n[h].resetIterator(e,p,r,o),c[h]=n[h].nextBatch(),u[h]=null}},this.isDone=function(){return t||this.isEmpty()},this.setAllVisibility=function(e){for(var t=0;t<n.length;t++)n[t].setAllVisibility(e)},this.hideLines=function(e){for(var t=0;t<n.length;t++)n[t].hideLines(e)},this.hidePoints=function(e){for(var t=0;t<n.length;t++)n[t].hidePoints(e)},this.hasHighlighted=function(){for(var e=0;e<n.length;e++)if(n[e].hasHighlighted())return!0;return!1},this.areAllVisible=function(){for(var e=0;e<n.length;e++)if(!n[e].areAllVisible())return!1;return!0},this.areAll2D=function(){for(var e=0;e<n.length;e++)if(!n[e].is2d())return!1;return!0},this.areAll3D=function(){for(var e=0;e<n.length;e++)if(!n[e].is3d())return!1;return!0},this.invalidateVisibleBounds=function(){for(var e=0;e<n.length;e++)n[e].visibleBoundsDirty=!0},this.getVisibleBounds=function(e,t,i){h.makeEmpty();for(var r=0;r<n.length;r++){var o=n[r].getVisibleBounds(e,i);t&&!t(o)||h.union(o)}return h},this.rayIntersect=function(e,t,i,r,o,a,s,l){if(f.set(e,t),n.length>1){var c=[];if(o)for(var u=0;u<o.length;u++){var h=this.findModel(o[u]);if(h){var d=r&&r[u],p=h.rayIntersect(f,i,d,a,s,l);p&&c.push(p)}}else for(var m=0;m<n.length;m++){var g=n[m].rayIntersect(f,i,r,a,s,l);g&&c.push(g)}return c.length?(c.sort((function(e,t){return e.distance-t.distance})),c[0]):null}if(!n.length)return null;var v=n[0];return o&&-1===o.indexOf(v.id)?null:v.rayIntersect(f,i,r,a,s,l)},this.getRenderProgress=function(){return n[0].getRenderProgress()},this.getModels=function(){return n},this.getHiddenModels=function(){return d},this.getAllModels=function(){return n.concat(d)},this.getFragmentList=function(){return n[0].getFragmentList()},this.getGeometryList=function(){return n[0].getGeometryList()},this.getSceneCount=function(){return n[0].getSceneCount()},this.getGeomScenes=function(){for(var e=[],t=0;t<n.length;t++)for(var i=n[t].getGeomScenes(),r=0;r<i.length;r++){var o=i[r];o&&e.push(o)}return e},this.getGeomScenesPerModel=function(){return n.reduce((function(e,t){return e.push(t.getGeomScenes()),e}),[])},this.explode=function(e){if(n.length){for(var t=0;t<n.length;t++){var i=n[t];l.i.explode(i,e)}this.invalidateVisibleBounds()}},this.update=function(e){for(var t=!1,i=0;i<n.length;i++){var r=n[i];t=t||r.update(e)}return t},this.hideModel=function(e){for(var t=0;t<n.length;t++){var i=n[t];if(i&&i.id===e)return this.removeModel(i),d.push(i),!0}return!1},this.showModel=function(e){for(var t=0;t<d.length;++t){var n=d[t];if(n&&n.id===e)return this.addModel(n),d.splice(t,1),!0}return!1}}},25119:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ResetFlags:()=>i});var i={RESET_NORMAL:0,RESET_REDRAW:1,RESET_RELOAD:2}},27820:(e,t,n)=>{"use strict";n.r(t),n.d(t,{SceneMath:()=>c});var i=n(16453),r=[new i.Vector3(1,0,0),new i.Vector3(0,1,0),new i.Vector3(0,0,1),new i.Vector3(-1,0,0),new i.Vector3(0,-1,0),new i.Vector3(0,0,-1)],o=new i.Plane;new i.Vector3;function a(e,t,n,r){var o=e;o.z=-1;var a=new i.Vector3(o.x,o.y,1);o=o.unproject(t),(a=a.unproject(t)).sub(o).normalize();var s,l=a;if(Math.abs(l[n])<1e-6)return null;s=t.isPerspective?t.position:o;var c=((r?r.min[n]:0)-s[n])/l[n];return l.multiplyScalar(c),l.add(s),l}function s(e,t,n){var i=e.clone();return i.max(t),i.min(n),i.distanceToSquared(e)}function l(e,t){return s(e,t.min,t.max)}var c={box2CutPlanes:function(e,t){for(var n=[],a=0;a<r.length;a++){o.normal.copy(r[a]);var s=a<3?e.max:e.min;o.constant=-o.normal.dot(s),t&&o.applyMatrix4(t),n.push(new i.Vector4(o.normal.x,o.normal.y,o.normal.z,o.constant))}return n},getPixelsPerUnit:function(e,t,n,r,o,s){if(!e.isPerspective)return r/e.orthoScale;var c,u=n.getCenter(new i.Vector3);if(t)if(s)c=Math.sqrt(l(e.position,s));else{var h=a(new i.Vector3(0,0,1),e,"z");h&&(u=h),c=e.position.distanceTo(u)}else{if(o){var d=o,p=e.target.clone().sub(e.position).normalize(),f=p.dot(d);if(0!==f){var m=-(e.position.clone().dot(d)+d.w)/f;u=n.clampPoint(p.multiplyScalar(m).add(e.position),u)}}c=e.position.distanceTo(u)}return r/(2*c*Math.tan(i.Math.degToRad(.5*e.fov)))},intersectGroundViewport:a,getNormalizingMatrix:function(e,t){t=t||e.getData().bbox;var n=new i.Matrix4;n.makeTranslation(-t.min.x,-t.min.y,-t.min.z);var r=new i.Vector3(0,0,0).subVectors(t.max,t.min),o=new i.Matrix4;o.makeScale(1/r.x,1/r.y,1);var a=new i.Matrix4;return a.multiplyMatrices(o,n),a},pointToMinMaxBoxDistance2:s,pointToBoxDistance2:l}},82197:(e,t,n)=>{"use strict";n.r(t),n.d(t,{SelectionMode:()=>i});var i={LEAF_OBJECT:0,FIRST_OBJECT:1,LAST_OBJECT:2}},79175:(e,t,n)=>{"use strict";function i(e){var t=e||function(e,t){return e<t},n=[],i=[];function r(e,o,a){if(o||(o=0),a||(a=i.length),o>=a)return a;if(a===o+1){var s=n[i[o]];return t(s,e)?a:o}var l=parseInt(o+(a-o)/2),c=n[i[l-1]];return t(e,c)?r(e,o,l):t(c,e)?r(e,l,a):l-1}this.add=function(e){var t=r(e);if(t==i.length)return n.push(e),void i.push(n.length-1);n.push(e),i.splice(t,0,n.length-1)},this.size=function(){return i.length},this.get=function(e){return n[i[e]]},this.removeAt=function(e){var t=i[e];n[t]=void 0,i.splice(e,1)},this.toString=function(){for(var e="",t=0,n=this.size();t<n;++t)e+=this.get(t),t<n-1&&(e+=", ");return e}}n.r(t),n.d(t,{SortedList:()=>i})},48862:(e,t,n)=>{"use strict";n.r(t),n.d(t,{VBIntersector:()=>m});var i,r,o,a,s=n(36757),l=n(16453);function c(){i||(i=new l.Matrix4,r=new l.Ray,new l.Vector3,new l.Vector3,new l.Vector3,o=new l.Vector3,a=new l.Vector3)}function u(e,t,n){c();var u=e.geometry;if(u){var h=e.material,d=h?h.side:l.FrontSide;i.copy(e.matrixWorld).invert(),r.copy(t.ray).applyMatrix4(i);var p,f,m=t.precision||1e-4;(0,s.enumMeshTriangles)(u,(function(i,s,c,u,h,g,v,y,b,_){null!==(p=d===l.BackSide?r.intersectTriangle(c,s,i,!0,o):r.intersectTriangle(i,s,c,d!==l.DoubleSide,o))&&(p.applyMatrix4(e.matrixWorld),(f=t.ray.origin.distanceTo(p))<m||f<t.near||f>t.far||(l.Triangle.getNormal(i,s,c,a),n.push({distance:f,point:p.clone(),face:new l.Face3(u,h,g,a.clone()),faceIndex:_,fragId:e.fragId,dbId:e.dbId,object:e})))}))}}function h(e,t,n,o){c();var a=e.geometry;if(a){var u=t.params.Line.threshold;e.isWideLine&&(e.material.linewidth?u=e.material.linewidth:e.geometry.lineWidth&&(u=e.geometry.lineWidth));var h=u*u;i.copy(e.matrixWorld).invert(),r.copy(t.ray).applyMatrix4(i);var d=new l.Vector3,p=new l.Vector3;a instanceof l.BufferGeometry&&(0,s.enumMeshLines)(a,(function(i,a,s,l,c){var u,f;if(r.distanceSqToSegment(i,a,p,d),d.applyMatrix4(e.matrixWorld),p.applyMatrix4(e.matrixWorld),!((f=d.distanceToSquared(p))>h||(u=t.ray.origin.distanceTo(d))<t.near||u>t.far)){var m={distance:u,point:d.clone(),face:{a:s,b:l},faceIndex:c,fragId:e.fragId,dbId:e.dbId,object:e,distanceToRay:Math.sqrt(f)};o&&o.filter&&!o.filter(m)||n.push(m)}}))}}function d(e,t,n,o){e.isLine||e.isWideLine?h(e,t,n,o):e.isPoint?function(e,t,n){c();var o=e.geometry;if(o){i.copy(e.matrixWorld).invert(),r.copy(t.ray).applyMatrix4(i);var a=t.precision||1e-4,u=t.params.PointCloud.threshold;u||(u=1),u*=Math.max(3,o.pointSize),u/=4,o instanceof l.BufferGeometry&&(0,s.enumMeshVertices)(o,(function(i,o,s,l){if(!(r.distanceToPoint(i)>u)){var c=r.closestPointToPoint(i);if(null!==c){c.applyMatrix4(e.matrixWorld);var h=t.ray.origin.distanceTo(c);h<a||h<t.near||h>t.far||n.push({distance:h,point:i,face:{a:l},faceIndex:l,fragId:e.fragId,dbId:e.dbId,object:e})}}}))}}(e,t,n):u(e,t,n)}function p(e,t,n,i){if(e instanceof l.Mesh?d(e,t,n):e.raycast(t,n),!0===i)for(var r=e.children,o=0,a=r.length;o<a;o++)p(r[o],t,n,!0)}var f=function(e,t){return e.distance-t.distance};var m={meshRayCast:u,lineRayCast:h,rayCast:d,intersectObject:function(e,t,n,i){p(e,t,n,i),n.sort(f)}}},89812:(e,t,n)=>{"use strict";n.r(t),n.d(t,{VertexBufferReader:()=>o,BoundsCallback:()=>a});var i=n(16453),r=2*Math.PI;function o(e){var t,n,i=this;this.vb=e.vb.buffer,this.vbf=new Float32Array(this.vb),this.vbi=new Int32Array(this.vb),this.vbs=new Uint16Array(this.vb),this.ib=e.ib,this.stride=e.vbstride,this.vcount=this.vbf.length/this.stride,this.useInstancing=e.numInstances>0,this.useCompactBuffers=e.unpackXform,this.texData=this.useCompactBuffers&&(null===(t=e.tIdColor)||void 0===t||null===(n=t.image)||void 0===n?void 0:n.data)&&new Uint32Array(e.tIdColor.image.data.buffer),this.isInterleavedVb=function(){var t=e.attributes;if(!t)return!1;var n=t.layerVp4b,r=t.flags4b;if(i.useCompactBuffers)return t.uvIdColor&&n&&r;var o=t.color4b,a=t.dbId4b;return o&&a&&n&&r}()}function a(e){this.bounds=e,this.point=new i.Vector4,this.point.z=0,this.point.w=1}o.prototype.getDbIdAt=function(e){return this.texData?this.texData[this.vbs[e*this.stride*2+7]]:this.vbi[e*this.stride+7]},o.prototype.getColorAt=function(e){return this.texData?this.texData[this.vbs[e*this.stride*2+6]]:this.vbi[e*this.stride+6]},o.prototype.getVertexFlagsAt=function(e){return this.texData?this.vbi[e*this.stride+4]:this.vbi[e*this.stride+8]},o.prototype.getLayerIndexAt=function(e){return this.texData?65535&this.vbi[e*this.stride+5]:65535&this.vbi[e*this.stride+9]},o.prototype.getViewportIndexAt=function(e){return this.texData?this.vbi[e*this.stride+5]>>16&65535:this.vbi[e*this.stride+9]>>16&65535},o.prototype.decodeLineAt=function(e,t,n,i){if(i.onLineSegment){if(this.useCompactBuffers)var o=this.stride*e*2,a=this.useCompactBuffers.x*this.vbs[o]/65535+this.useCompactBuffers.z,s=this.useCompactBuffers.y*this.vbs[o+1]/65535+this.useCompactBuffers.w,l=this.vbs[o+2]/65535*r-Math.PI,c=this.vbs[o+3]/65535*Math.max(this.useCompactBuffers.x,this.useCompactBuffers.y),u=this.vbs[o+4]/32767*Math.max(this.useCompactBuffers.x,this.useCompactBuffers.y)*2;else{var h=this.stride*e;a=this.vbf[h],s=this.vbf[h+1],l=this.vbf[h+2]*r-Math.PI,c=this.vbf[h+3],u=2*this.vbf[h+4]}var d=a+c*Math.cos(l),p=s+c*Math.sin(l);i.onLineSegment(a,s,d,p,n,u)}},o.prototype.decodeCircularArcAt=function(e,t,n,i){if(i.onCircularArc){if(this.useCompactBuffers)var o=this.stride*e*2,a=this.useCompactBuffers.x*this.vbs[o]/65535+this.useCompactBuffers.z,s=this.useCompactBuffers.y*this.vbs[o+1]/65535+this.useCompactBuffers.w,l=this.vbs[o+2]/65535*r,c=this.vbs[o+3]/65535*r,u=this.vbs[o+5]/65535*Math.max(this.useCompactBuffers.x,this.useCompactBuffers.y);else{var h=this.stride*e;a=this.vbf[h],s=this.vbf[h+1],l=this.vbf[h+2]*r,c=this.vbf[h+3]*r,u=this.vbf[h+5]}i.onCircularArc(a,s,l,c,u,n)}},o.prototype.decodeEllipticalArcAt=function(e,t,n,i){if(i.onEllipticalArc){var o=this.stride*e,a=this.vbf[o],s=this.vbf[o+1],l=this.vbf[o+2]*r,c=this.vbf[o+3]*r,u=this.vbf[o+5],h=this.vbf[o+10],d=this.vbf[o+11];i.onEllipticalArc(a,s,l,c,u,h,d,n)}},o.prototype.decodeTexQuadAt=function(e,t,n,i){if(i.onTexQuad){if(this.useCompactBuffers)var o=this.stride*e*2,a=this.useCompactBuffers.x*this.vbs[o]/65535+this.useCompactBuffers.z,s=this.useCompactBuffers.y*this.vbs[o+1]/65535+this.useCompactBuffers.w,l=this.vbs[o+2]/65535*r,c=this.vbs[o+3]/65535*Math.max(this.useCompactBuffers.x,this.useCompactBuffers.y),u=this.vbs[o+4]/65535*Math.max(this.useCompactBuffers.x,this.useCompactBuffers.y);else{var h=this.stride*e;a=this.vbf[h],s=this.vbf[h+1],l=this.vbf[h+2]*r,c=this.vbf[h+3],u=this.vbf[h+4]}i.onTexQuad(a,s,c,u,l,n)}},o.prototype.decodeOneTriangleAt=function(e,t,n,i){if(i.onOneTriangle){if(this.useCompactBuffers)var r=this.stride*e*2,o=this.useCompactBuffers.x*this.vbs[r]/65535+this.useCompactBuffers.z,a=this.useCompactBuffers.y*this.vbs[r+1]/65535+this.useCompactBuffers.w,s=this.useCompactBuffers.x*this.vbs[r+2]/65535+this.useCompactBuffers.z,l=this.useCompactBuffers.y*this.vbs[r+3]/65535+this.useCompactBuffers.w,c=this.useCompactBuffers.x*this.vbs[r+4]/65535+this.useCompactBuffers.z,u=this.useCompactBuffers.y*this.vbs[r+5]/65535+this.useCompactBuffers.w;else{var h=this.stride*e;o=this.vbf[h],a=this.vbf[h+1],s=this.vbf[h+2],l=this.vbf[h+3],c=this.vbf[h+4],u=this.vbf[h+5]}i.onOneTriangle(o,a,s,l,c,u,n)}},o.prototype.decodeTriangleIndexed=function(e,t,n,i,r,o){if(o.onOneTriangle){if(this.useCompactBuffers){var a=this.stride*e*2,s=this.useCompactBuffers.x*this.vbs[a]/65535+this.useCompactBuffers.z,l=this.useCompactBuffers.y*this.vbs[a+1]/65535+this.useCompactBuffers.w;a=this.stride*t*2;var c=this.useCompactBuffers.x*this.vbs[a]/65535+this.useCompactBuffers.z,u=this.useCompactBuffers.y*this.vbs[a+1]/65535+this.useCompactBuffers.w;a=this.stride*n*2;var h=this.useCompactBuffers.x*this.vbs[a]/65535+this.useCompactBuffers.z,d=this.useCompactBuffers.y*this.vbs[a+1]/65535+this.useCompactBuffers.w}else{var p=this.stride*e;s=this.vbf[p],l=this.vbf[p+1];p=this.stride*t;c=this.vbf[p],u=this.vbf[p+1];p=this.stride*n;h=this.vbf[p],d=this.vbf[p+1]}o.onOneTriangle(s,l,c,u,h,d,r)}},o.prototype.enumGeomsForObject=function(e,t){if(this.useInstancing)for(var n=0;n<this.vcount;){var i=this.getVertexFlagsAt(n)>>8&255,r=this.getLayerIndexAt(n),o=this.getViewportIndexAt(n);if(s=this.getDbIdAt(n)===e)switch(i){case 1:this.decodeLineAt(n,r,o,t);break;case 2:this.decodeCircularArcAt(n,r,o,t);break;case 3:this.decodeEllipticalArcAt(n,r,o,t);break;case 4:this.decodeTexQuadAt(n,r,o,t);break;case 5:this.decodeOneTriangleAt(n,r,o,t)}n+=1}else for(n=0;n<this.ib.length;){var a=this.ib[n],s=(i=this.getVertexFlagsAt(a)>>8&255,r=this.getLayerIndexAt(a),o=this.getViewportIndexAt(a),this.getDbIdAt(a)===e);if(0===i)s&&this.decodeTriangleIndexed(this.ib[n],this.ib[n+1],this.ib[n+2],r,o,t),n+=3;else{if(s)switch(i){case 1:this.decodeLineAt(a,r,o,t);break;case 2:this.decodeCircularArcAt(a,r,o,t);break;case 3:this.decodeEllipticalArcAt(a,r,o,t);break;case 4:this.decodeTexQuadAt(a,r,o,t);break;case 5:this.decodeOneTriangleAt(a,r,o,t)}n+=6}}},o.prototype.enumGeomsForVisibleLayer=function(e,t){this.enumGeoms((function(t,n,i){return!e||0!==n&&-1!==e.indexOf(n)}),t)},o.prototype.enumGeoms=function(e,t){if(this.useInstancing)for(var n=0;n<this.vcount;){var i=this.getVertexFlagsAt(n)>>8&255,r=this.getLayerIndexAt(n),o=this.getViewportIndexAt(n),a=this.getDbIdAt(n);if(l=!e||e(a,r,o))switch(i){case 1:this.decodeLineAt(n,r,o,t);break;case 2:this.decodeCircularArcAt(n,r,o,t);break;case 3:this.decodeEllipticalArcAt(n,r,o,t);break;case 4:this.decodeTexQuadAt(n,r,o,t);break;case 5:this.decodeOneTriangleAt(n,r,o,t)}n+=1}else for(n=0;n<this.ib.length;){var s=this.ib[n],l=(i=this.getVertexFlagsAt(s)>>8&255,r=this.getLayerIndexAt(s),o=this.getViewportIndexAt(s),a=this.getDbIdAt(s),!e||e(a,r,o));if(0===i)l&&this.decodeTriangleIndexed(this.ib[n],this.ib[n+1],this.ib[n+2],r,o,t),n+=3;else{if(l)switch(i){case 1:this.decodeLineAt(s,r,o,t);break;case 2:this.decodeCircularArcAt(s,r,o,t);break;case 3:this.decodeEllipticalArcAt(s,r,o,t);break;case 4:this.decodeTexQuadAt(s,r,o,t);break;case 5:this.decodeOneTriangleAt(s,r,o,t)}n+=6}}},a.prototype.onVertex=function(e,t,n){this.point.x=e,this.point.y=t,this.bounds.expandByPoint(this.point)},a.prototype.onLineSegment=function(e,t,n,i,r){this.onVertex(e,t),this.onVertex(n,i)},a.prototype.onCircularArc=function(e,t,n,i,r,o){this.onEllipticalArc(e,t,n,i,r,r,0,o)},a.prototype.onEllipticalArc=function(e,t,n,i,r,o,a,s){0==a?n<=0&&i>=2*Math.PI-1e-5?this.onTexQuad(e,t,2*r,2*o,a,s):(this.point.x=e+Math.cos(n)*r,this.point.y=t+Math.sin(n)*o,this.bounds.expandByPoint(this.point),this.point.x=e+Math.cos(i)*r,this.point.y=t+Math.sin(i)*o,this.bounds.expandByPoint(this.point),n>i&&(this.point.x=e+r,this.point.y=t,this.bounds.expandByPoint(this.point),n-=2*Math.PI),n<.5*Math.PI&&i>.5*Math.PI&&(this.point.x=e,this.point.y=t+o,this.bounds.expandByPoint(this.point)),n<Math.PI&&i>Math.PI&&(this.point.x=e-r,this.point.y=t,this.bounds.expandByPoint(this.point)),n<1.5*Math.PI&&i>1.5*Math.PI&&(this.point.x=e,this.point.y=t-o,this.bounds.expandByPoint(this.point))):this.onTexQuad(e,t,2*r,2*o,a,s)},a.prototype.onTexQuad=function(e,t,n,r,o,a){var s=.5*n,l=.5*n;if(0==o)this.onVertex(e-s,t-l),this.onVertex(e+s,t+l);else{var c=new i.Matrix4,u=new i.Matrix4;c.makeRotationZ(o),u.makeTranslation(e,t,0),u.multiply(c);for(var h=0;h<4;h++)this.point.x=h%2==1?s:-s,this.point.y=h>=2?l:-l,this.point.applyMatrix4(u),this.bounds.expandByPoint(this.point)}},a.prototype.onOneTriangle=function(e,t,n,i,r,o,a){this.onVertex(e,t),this.onVertex(n,i),this.onVertex(r,o)}},36757:(e,t,n)=>{"use strict";n.r(t),n.d(t,{getVertexCount:()=>m,getIndicesCount:()=>g,enumMeshVertices:()=>v,enumMeshIndices:()=>y,enumMeshTriangles:()=>b,enumMeshLines:()=>_,enumMeshEdges:()=>x,VertexEnumerator:()=>E});var i,r,o,a,s,l,c,u,h,d,p,f=n(73075);function m(e){return e.vb?e.vb.length/e.vbstride:e.attributes.position?e.attributes.position.array.length/3:0}function g(e){e.attributes;var t=e.ib||e.indices||(e.index?e.index.array:null);if(t){var n=e.groups;if(!n||0===n.length)return t.length;for(var i=0,r=0,o=n.length;r<o;++r)i+=n[r].count;return i}return m(e)}function v(e,t,n){var a=e.attributes;i||(i=new f.LmvVector3,r=new f.LmvVector3,new f.LmvVector3),n&&(o||(o=new THREE.Matrix3),o.getNormalMatrix(n));var s,l=e.vb||a.position.array,c=e.vb||a.normal&&a.normal.array,u=e.vb?e.vbstride:3;if(e.vblayout){if(!e.vblayout.position)return;s=e.vblayout.position.offset}else{if(!a.position)return;s=a.position.itemOffset||0}var h=0,d=e.vblayout?e.vblayout.normal:a.normal||null;d?h=d.offset||d.itemOffset||0:c=null,!d||d.array||3===d.itemSize&&4===d.bytesPerItem||(c=null);for(var p=m(e),g=s,v=h,y=0;y<p;y++,g+=u,v+=u)i.set(l[g],l[g+1],l[g+2]),n&&i.applyMatrix4(n),c&&(r.set(c[v],c[v+1],c[v+2]),n&&r.applyMatrix3(o)),t(i,c?r:null,null,y)}function y(e,t){var n=e.ib||e.indices||(e.index?e.index.array:null);if(n){var i=e.groups;i&&0!==i.length||(i=[{start:0,count:n.length,index:0}]);for(var r=0,o=i.length;r<o;++r)for(var a=i[r].start,s=i[r].count,l=i[r].index,c=a,u=a+s;c<u;c+=3){t(l+n[c],l+n[c+1],l+n[c+2])}}else for(var h=m(e),d=0;d<h;d++){t(3*d,3*d+1,3*d+2)}}function b(e,t){var n,i,r,o=e.attributes;a||(a=new f.LmvVector3,s=new f.LmvVector3,l=new f.LmvVector3,c=new f.LmvVector3,u=new f.LmvVector3,h=new f.LmvVector3);var d,p=e.vb||o.position.array,g=e.vb||o.normal&&o.normal.array,v=e.vb?e.vbstride:3;if(e.vblayout){if(!e.vblayout.position)return;d=e.vblayout.position.offset}else{if(!o.position)return;d=o.position.itemOffset||0}var y=0,b=e.vblayout?e.vblayout.normal:o.normal||null;b?y=b.offset||b.itemOffset||0:g=null,!b||b.array||3===b.itemSize&&4===b.bytesPerItem||(g=null);var _=e.ib||e.indices||(e.index?e.index.array:null);if(_){var x=e.groups;x&&0!==x.length||(x=[{start:0,count:_.length,index:0}]);for(var E=0,w=x.length;E<w;++E)for(var S=x[E].start,A=x[E].count,M=x[E].index,T=S,C=S+A;T<C;T+=3){var P=(n=M+_[T])*v+d,L=(i=M+_[T+1])*v+d,R=(r=M+_[T+2])*v+d;if(a.x=p[P],a.y=p[P+1],a.z=p[P+2],s.x=p[L],s.y=p[L+1],s.z=p[L+2],l.x=p[R],l.y=p[R+1],l.z=p[R+2],g){var D=n*v+y,I=i*v+y,O=r*v+y;c.x=g[D],c.y=g[D+1],c.z=g[D+2],u.x=g[I],u.y=g[I+1],u.z=g[I+2],h.x=g[O],h.y=g[O+1],h.z=g[O+2],t(a,s,l,n,i,r,c,u,h,T/3)}else t(a,s,l,n,i,r,null,null,null,T/3)}}else{var N=m(e);for(T=0;T<N;T+=3){P=(n=T)*v+d,L=(i=T+1)*v+d,R=(r=T+2)*v+d;if(a.x=p[P],a.y=p[P+1],a.z=p[P+2],s.x=p[L],s.y=p[L+1],s.z=p[L+2],l.x=p[R],l.y=p[R+1],l.z=p[R+2],g){D=n*v+y,I=i*v+y,O=r*v+y;c.x=g[D],c.y=g[D+1],c.z=g[D+2],u.x=g[I],u.y=g[I+1],u.z=g[I+2],h.x=g[O],h.y=g[O+1],h.z=g[O+2],t(a,s,l,n,i,r,c,u,h,T/3)}else t(a,s,l,n,i,r,null,null,null,T/3)}}}function _(e,t){var n,i,r=e.attributes;d||(d=new f.LmvVector3,p=new f.LmvVector3);var o=2;e.lineWidth&&(o=6);var a=e.ib||e.indices||(e.index?e.index.array:null);if(a){var s=e.vb?e.vb:r.position.array,l=e.vb?e.vbstride:3,c=e.groups;c&&0!==c.length||(c=[{start:0,count:a.length,index:0}]);for(var u=0,h=c.length;u<h;++u)for(var m=c[u].start,g=c[u].count,v=c[u].index,y=m,b=m+g,_=m/o;y<b;y+=o,_++)n=v+a[y],i=v+a[y+1],d.x=s[n*l],d.y=s[n*l+1],d.z=s[n*l+2],p.x=s[i*l],p.y=s[i*l+1],p.z=s[i*l+2],t(d,p,n,i,_)}else for(s=e.vb?e.vb:r.position.array,l=e.vb?e.vbstride:3,y=0,b=s.length/l,_=0;y<b;y+=o,_++)n=y,i=y+1,d.x=s[n*l],d.y=s[n*l+1],d.z=s[n*l+2],p.x=s[i*l],p.y=s[i*l+1],p.z=s[i*l+2],t(d,p,n,i,_)}function x(e,t){var n,i,r=e.attributes;d||(d=new f.LmvVector3,p=new f.LmvVector3);var o=e.iblines;if(o){var a=e.vb?e.vb:r.position.array,s=e.vb?e.vbstride:3,l=e.groups;l&&0!==l.length||(l=[{start:0,count:o.length,index:0}]);for(var c=0,u=l.length;c<u;++c)for(var h=l[c].start,m=l[c].count,g=l[c].index,v=h,y=h+m;v<y;v+=2)n=g+o[v],i=g+o[v+1],d.x=a[n*s],d.y=a[n*s+1],d.z=a[n*s+2],p.x=a[i*s],p.y=a[i*s+1],p.z=a[i*s+2],t(d,p,n,i)}}var E={getVertexCount:m,enumMeshVertices:v,enumMeshIndices:y,enumMeshTriangles:b,enumMeshLines:_,enumMeshEdges:x}},87289:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Consolidation:()=>U,ConsolidationBuilder:()=>B,copyPrimitiveProps:()=>N,copyVertexFormat:()=>O,isVisible:()=>R,mergeGeometries:()=>k});var i=n(16453),r=n(36757),o=n(25131),a=n(96610),s=n(58092),l=n(43586),c=n(73075);function u(e,t,n,i){var o=function(e){for(var t=new Uint16Array(e.length+1),n=0,i=0;i<e.length;i++)t[i]=n,n+=(0,r.getVertexCount)(e[i]);return t[i]=n,t}(e),s=new a.GeomMergeTask;return s.vb=t.vb,s.vbstride=t.vbstride,s.posOffset=t.attributes.position.itemOffset,s.normalOffset=t.attributes.normal?t.attributes.normal.itemOffset:-1,s.matrices=n,s.ranges=o,s.dbIds=i,s}function h(e,t){t.vb=e.vb,t.attributes.id.array=e.vertexIds,t.needsUpdate=!0}function d(e){var t=0,n={},i=[],r=e,o=new Array(2);function a(e){for(var i=e.data,a=0;a<i.length;a++){var s=i[a],l=s.taskId;h(s,n[l]),delete n[l]}if(0===--t)for(r.inProgress=!1,a=0;a<o.length;a++)o[a].clearAllEventListenerWithIntercept(),o[a].terminate(),o[a]=null}this.addMergeTask=function(e,t,r,o){var a=u(e,t,r,o);i.push(a),n[a.id]=t},this.runTasks=function(){for(var e=0;e<2;e++)o[e]=d.createWorker(),o[e].addEventListenerWithIntercept(a);for(var n=i.length,s=Math.floor(n/2),l=0;l<2;l++){var c=l*s,u=1===l?n:c+s,h=[],p=new Array(4*(u-c)),f=0;for(e=c;e<u;e++){var m=i[e];p[f++]=m.vb.buffer,p[f++]=m.matrices.buffer,p[f++]=m.ranges.buffer,p[f++]=m.dbIds.buffer,h.push(m)}var g={operation:"MERGE_GEOMETRY",tasks:h};o[l].doOperation(g,p),t++}r.inProgress=!0}}d.createWorker=s.createWorkerWithIntercept;var p=n(98926),f=n(9140),m=n(46759),g=n(2727),v=1,y=2,b=3,_=4;function x(e){return e.isLines?y:e.isPoints?_:e.isWideLines?b:v}function E(e,t){switch(!0===e.isLines&&(e.isLines=void 0),!0===e.isWideLines&&(e.isWideLines=void 0),!0===e.isPoints&&(e.isPoints=void 0),t){case y:e.isLines=!0;break;case b:e.isWideLines=!0;break;case _:e.isPoints=!0}}var w=m.MeshFlags.MESH_HIGHLIGHTED,S=m.MeshFlags.MESH_VISIBLE|m.MeshFlags.MESH_HIDE|w,A=m.MeshFlags.MESH_VISIBLE,M=m.MeshFlags.MESH_VISIBLE|m.MeshFlags.MESH_HIDE,T=m.MeshFlags.MESH_HIGHLIGHTED|m.MeshFlags.MESH_HIDE,C=m.MeshFlags.MESH_HIGHLIGHTED,P=g.RenderFlags.RENDER_HIDDEN,L=g.RenderFlags.RENDER_HIGHLIGHTED;function R(e,t){switch(t){case P:return 0==(e&M);case L:return(e&T)===C}return(e&S)==A}var D=new i.Matrix4;function I(e){this.geoms=[],this.matrices=[],this.vertexCount=0,this.material=e,this.fragIds=[],this.worldBox=new i.Box3}function O(e,t){for(var n in e.vb&&e.vbstride||p.logger.warn("copyVertexFormat() supports only interleaved buffers"),e.attributes)t.attributes[n]=e.attributes[n];t.index=e.index,t.attributesKeys=e.attributesKeys.slice(0),t.vbstride=e.vbstride}function N(e,t){E(t,x(e)),t.lineWidth=e.lineWidth,t.pointSize=e.pointSize}function k(e,t,n,a,s){var d=function(e){for(var t=e[0].vbstride,n=0,a=0,s=0,l=0;l<e.length;l++){var c=e[l];n+=e[l].ib.length,a+=(0,r.getVertexCount)(c),e[l].iblines&&(s+=e[l].iblines.length)}var u=(0,o.createBufferGeometry)();u.vb=new Float32Array(a*t),u.ib=new Uint16Array(n),s&&(u.iblines=new Uint16Array(s)),u.byteSize=u.vb.byteLength+u.ib.byteLength,u.iblines&&(u.byteSize+=u.iblines.byteLength),N(e[0],u),O(e[0],u),u.setIndex(e[0].index),u.indexlines=e[0].indexlines;var h=new i.BufferAttribute(new Float32Array,3);h.normalized=!0,h.bytesPerItem=1,u.setAttribute("id",h);var d=e[0];return E(u,x(d)),d.isPoints&&(u=d.pointSize),d.isWideLines&&(u=d.lineWidth),u}(e);return d.boundingBox=a.clone(),function(e,t){for(var n=0,i=0,o=0,a=0,s=0;s<e.length;s++){for(var l=e[s],c=(0,r.getVertexCount)(l),u=0;u<l.ib.length;u++)t.ib[o+u]=l.ib[u]+i;if(l.iblines){for(u=0;u<l.iblines.length;u++)t.iblines[a+u]=l.iblines[u]+i;a+=l.iblines.length}t.vb.set(l.vb,n),n+=l.vb.length,i+=c,o+=l.ib.length}}(e,d),s?s.addMergeTask(e,d,t,n):function(e,t,n,i){var r=u(e,t,n,i),o=new c.LmvVector3,a=new l.LmvMatrix4;h(r.run(a,o),t)}(e,d,t,n),d}function F(e,t){if(e.vbstride!=t.vbstride)return!1;if(x(e)!==x(t))return!1;if(e.isPoints&&e.pointSize!==t.pointSize)return!1;if(e.isWideLines&&e.lineWidth!==t.lineWidth)return!1;if(e.attributesKeys.length!=t.attributesKeys.length)return!1;for(var n=0,i=e.attributesKeys.length;n<i;n++){var r=e.attributesKeys[n],o=e.attributes[r],a=t.attributes[r];if(!a)return!1;if(o!==a&&(o.itemOffset!==a.itemOffset||o.normalized!==a.normalized||o.itemSize!==a.itemSize||o.bytesPerItem!==a.bytesPerItem||o.isPattern!==a.isPattern))return!1}return!0}function U(e){this.meshes=[],this.fragId2MeshIndex=new Int32Array(e);for(var t=0;t<this.fragId2MeshIndex.length;t++)this.fragId2MeshIndex[t]=-1;this.byteSize=0,this.consolidationMap=null}function B(){this.buckets={},this.bucketCount=0,this.costs=0}function V(e,t){this.fragOrder=new Uint32Array(e),this.ranges=new Uint32Array(t),this.boxes=new Array(t),this.numConsolidated=-1}I.prototype={constructor:I,addGeom:function(e,t,n){this.geoms.push(e),this.fragIds.push(n),this.worldBox.union(t),this.vertexCount+=(0,r.getVertexCount)(e);var i=this.geoms.length;return 1==i?0:(void 0===e.byteSize&&p.logger.warn("Error in consolidation: Geometry must contain byteSize."),e.byteSize+(2==i?this.geoms[0].byteSize:0))}},U.prototype={constructor:U,addContainerMesh:function(e,t,n,r,o){var a=new i.Mesh(e,t);this.meshes.push(a),this.byteSize+=e.byteSize;var s=r||0,l=s+(o||n.length);a.frustumCulled=!1;for(var c=this.meshes.length-1,u=s;u<l;u++){var h=n[u];this.fragId2MeshIndex[h]=c}},addSingleMesh:function(e,t,n,r,o){var a=new i.Mesh(e,t);a.matrix.copy(r),a.matrixAutoUpdate=!1,a.dbId=o,a.fragId=n,this.meshes.push(a),a.frustumCulled=!1,this.fragId2MeshIndex[n]=this.meshes.length-1},addSingleFragment:function(e,t){var n=e.getVizmesh(t);e.getOriginalWorldMatrix(t,D),this.addSingleMesh(n.geometry,n.material,t,D,n.dbId)},applyAttributes:function(e,t,n,i){var r,o,a=this.meshes[e],s=a.geometry,l=t.vizflags,c=this.consolidationMap,u=c.fragOrder,h=s.numInstances,d=t.db2ThemingColor,p=d.length>0||void 0;if(h?o=(r=a.rangeStart)+a.geometry.numInstances:s.attributes.id?(r=c.ranges[e],o=e+1>=c.ranges.length?c.numConsolidated:c.ranges[e+1]):w=a.fragId,!i||void 0!==w)return s.groups&&void 0===w&&(s.groups=void 0),a.visible=R(l[void 0===w?u[r]:w],n),a.themingColor=p&&d[t.fragments.fragId2dbId[w]],a;var f,m,g=0,v=0,y=0,b=0,_=0;function x(){if(f){s.groups=s.groups||[];var e=s.groups[_]||{index:0};s.groups[_++]=e,h?(e.start=0,e.count=s.ib.length,s.iblines&&(e.edgeStart=0,e.edgeCount=s.iblines.length),e.instanceStart=g,e.numInstances=v-g):(e.start=g,e.count=v-g,s.iblines&&(e.edgeStart=y,e.edgeCount=b-y)),e.themingColor=m}}for(var E=r;E<o;++E){var w,S=R(l[w=u[E]],n),A=p&&t.db2ThemingColor[t.fragments.fragId2dbId[w]];if((S!==f||S&&A!==m)&&(v>g&&x(),g=v,y=b,f=S,m=A),h)v+=1;else{var M=t.getGeometry(w);v+=M.ib.length,M.iblines&&(b+=M.iblines.length)}}return 0===g?(a.themingColor=m,a.visible=f):(a.visible=!0,x()),s.groups&&(s.groups.length=_),a}},B.prototype={addGeom:function(e,t,n,i){var o=null,a=this.buckets[t.id];if(a)for(var s=0;s<a.length;s++){var l=a[s];if(F(l.geoms[0],e))if(!((0,r.getVertexCount)(e)+l.vertexCount>65535)){o=l;break}}o||(o=new I(t),this.bucketCount++,this.buckets[t.id]?this.buckets[t.id].push(o):this.buckets[t.id]=[o]),this.costs+=o.addGeom(e,n,i)},createConsolidationMap:function(e,t){var n=new V(e.length,this.bucketCount),i=0,r=0;for(var o in this.buckets)for(var a=this.buckets[o],s=0;s<a.length;s++){var l=a[s];n.ranges[r]=i,n.boxes[r]=l.worldBox,n.fragOrder.set(l.fragIds,i),i+=l.fragIds.length,r++}n.numConsolidated=t;for(var c=t;c<e.length;c++)n.fragOrder[c]=e[c];return n}},V.prototype={buildConsolidation:function(e,t,n){var r=this.fragOrder,o=e.getCount(),a=this.ranges.length,s=new U(o),l=null;d.createWorker&&(l=new d(s));for(var c=[],u=new i.Matrix4,h=0;h<a;h++){var p=this.ranges[h],m=(h===a-1?this.numConsolidated:this.ranges[h+1])-p;if(1!==m){c.length=m;for(var g=new Float32Array(16*m),v=new Uint32Array(m),y=0;y<m;y++)S=r[p+y],c[y]=e.getGeometry(S),e.getOriginalWorldMatrix(S,u),g.set(u.elements,16*y),v[y]=e.getDbIds(S);var b=this.boxes[h],_=r[p],x=e.getMaterial(_),E=k(c,g,v,b,l),w=t.getMaterialVariant(x,f.MATERIAL_VARIANT.VERTEX_IDS,n);s.addContainerMesh(E,w,r,p,m)}else{var S=r[p];s.addSingleFragment(e,S,s)}}return l&&l.runTasks(),s.consolidationMap=this,s}},U.applyBVHDefaults=function(e){e.frags_per_leaf_node=512,e.max_polys_per_node=1e5},U.getDefaultBVHOptions=function(){var e={};return U.applyBVHDefaults(e),e}},45451:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ConsolidationIterator:()=>l});var i=n(87289),r=n(23406),o=n(16453),a=n(46759),s=n(98926);function l(e,t){var n=e,l=t,c=[],u=!1,h=[],d=[],p=new o.Matrix4,f=new o.Box3;function m(e){var t=n.matrix;t?(e.matrixWorld.copy(t),e.matrixAutoUpdate=!1):e.matrixWorld.identity()}function g(){for(var e=l.meshes,t=0;t<e.length;t++)e[t].matrixWorldNeedsUpdate=!0}g(),this.modelMatrixChanged=function(){for(var e=0;e<h.length;e++){var t=h[e];t&&m(t)}g()},this.getConsolidation=function(){return l},this.reset=function(){c.length=null,d.length=0;var e=n.getCount(),t=a.MeshFlags.MESH_MOVED,i=a.MeshFlags.MESH_VISIBLE,r=i|a.MeshFlags.MESH_HIDE|a.MeshFlags.MESH_HIGHLIGHTED,o=n.vizflags,s=l.fragId2MeshIndex;l.meshes;u=!1;for(var h=n.db2ThemingColor.length>0,p=0;p<e;p++){var f,m=o[p];if(m&t){u=!0;break}if(h){var g=n.fragments.fragId2dbId[p];f=n.db2ThemingColor[g]}var v=s[p];d[v]=d[v]||!!(f||m&r^i)}},this.dispose=function(){for(var e={type:"dispose"},t={type:"removed"},n=0;n<l.meshes.length;n++){var i=l.meshes[n],r=i.geometry;r&&(i.dispatchEvent(t),r.dispatchEvent(e),r.needsUpdate=!0)}},this.consolidateNextBatch=function(e,t,i){var r=e.nodeIndex;if(u||void 0===r)return e;if(l.inProgress)return e;for(var a=function(e){h[e]||(h[e]=new o.Scene,m(h[e]));var t=h[e];return t.children.length=0,t}(r),p=e.start;p<e.lastItem;p++){var g,v=e.indices?e.indices[p]:p,y=l.fragId2MeshIndex[v];if(-1===y){if(!n.getGeometry(v))continue;return s.logger.warn("Warning: Missing fragment in consolidation. Consolidation disabled."),e}if(!c[y]&&(n.getWorldBounds(v,f),t.intersectsBox(f)&&(c[y]=!0,(g=l.applyAttributes(y,n,i,d[y])).visible))){var b=g&&g.geometry,_=b&&(b.isLines||b.isWideLines),x=b&&b.isPoints;n.linesHidden&&_||n.pointsHidden&&x||a.add(g)}}return a.boundingBox||(a.boundingBox=new o.Box3),e.getBoundingBox(a.boundingBox),a.renderImportance=e.renderImportance,a.sortObjects=e.sortObjects,a};var v=1,y=2,b=3;function _(e){return e.numInstances?y:e.attributes.id?v:b}this.updateRenderProxy=function(e,t){if(e.geometry&&e.geometry.attributes){var o=function(e){if(u)return b;var t=l.fragId2MeshIndex[e];return _(l.meshes[t].geometry)}(t),a=_(e.geometry);if(e.needsUpdate||a!=o){var s=n.getGeometry(t),c=l.fragId2MeshIndex[t],h=l.meshes[c];if(o===b)e.geometry=s,e.material=n.getMaterial(t),n.getWorldMatrix(t,e.matrix);else if(o===y){n.getWorldMatrix(t,p);var d=n.fragments.fragId2dbId[t],m=new r.InstanceBufferBuilder(s,1);m.addInstance(p,d),e.geometry=m.finish(),e.material=h.material,e.matrix.identity()}else n.getWorldMatrix(t,p),n.getWorldBounds(t,f),d=n.fragments.fragId2dbId[t],e.geometry=(0,i.mergeGeometries)([s],p.elements,[d],f),e.material=h.material,e.matrix.identity();e.needsUpdate=!1,e.dispatchEvent({type:"removed"})}}}}},95920:(e,t,n)=>{"use strict";n.r(t),n.d(t,{consolidateFragmentList:()=>c});var i=n(87289),r=n(23406),o=n(9140),a=n(16453);var s,l=(s=null,function(e,t,n,i,l,c){var u=e.getFragmentList();s||(s=new a.Matrix4);var h=n[i],d=u.getGeometry(h),p=u.getMaterial(h),f=l-i;if(1!=f){for(var m=l-1,g=new r.InstanceBufferBuilder(d,f),v=i;v<=m;v++){var y=n[v];u.getOriginalWorldMatrix(y,s);var b=u.fragments.fragId2dbId[y];if(!g.addInstance(s,b)){var _=n[m];n[m]=y,n[v]=_,--v,--m}}var x=g.finish();if(x){var E=t.getMaterialVariant(p,o.MATERIAL_VARIANT.INSTANCED,e);c.addContainerMesh(x,E,n,i,f),c.meshes[c.meshes.length-1].rangeStart=i}for(v=m+1;v<l;v++)y=n[v],c.addSingleFragment(u,y)}else c.addSingleFragment(u,h)});function c(e,t,n,r,o){var s=e.getFragmentList(),c=r.supportsInstancedArrays();n=n||100<<20;var u=function(e){for(var t=e.getCount(),n=[],i=0;i<t;i++){var r=e.getGeometryId(i),o=0|n[r];n[r]=o+1}return n}(s);if(!o){var h=function(e,t){function n(n,i){var r=e.getGeometry(n),o=e.getGeometry(i),a=e.getGeometryId(n),s=e.getGeometryId(i),l=t[a],c=t[s],u=l*r.byteSize,h=c*o.byteSize;return u!=h?u-h:r.id!=o.id?r.id-o.id:e.getMaterialId(n)-e.getMaterialId(i)}for(var i=0,r=e.getCount(),o=new Int32Array(r),a=0;a<r;a++)e.getGeometry(a)&&(o[i]=a,i++);if(i<r&&(o=new Int32Array(o.buffer,o.byteOffset,i)),o.sort)o.sort(n);else{var s=new Array(r);for(a=0;a<r;a++)s[a]=o[a];for(s.sort(n),a=0;a<o.length;a++)o[a]=s[a]}return o}(s,u);o=function(e,t,n,r){for(var o=new a.Box3,s=new i.ConsolidationBuilder,l=0;l<n.length&&!(s.costs>=r);l++){var c=n[l];e.getWorldBounds(c,o);var u=e.getGeometry(c),h=e.getMaterial(c);s.addGeom(u,h,o,c)}return s.createConsolidationMap(n,l)}(s,0,h,n)}var d=o.buildConsolidation(s,t,e),p=o.fragOrder,f=o.numConsolidated;if(c)!function(e,t,n,i,r){var o=e.getFragmentList();if(!(i>=n.length)){for(var a=i,s=-1,c=-1,u=i;u<n.length;u++){var h=n[u],d=o.getGeometryId(h),p=o.getMaterialId(h);d==s&&p==c||(u!=i&&l(e,t,n,a,u,r),a=u,s=d,c=p)}l(e,t,n,a,n.length,r)}}(e,t,p,f,d);else for(var m=f;m<p.length;m++){var g=p[m];d.addSingleFragment(s,g)}!function(e,t,n,i){for(var r=e.geoms,o=[],a=0,s=0,l=0;l<t.meshes.length;l++){var c=t.meshes[l],u=c.geometry;u.byteSize||(u.byteSize=(u.vb.byteLength||0)+(u.ib.byteLength||0));var h=Number.isInteger(c.fragId);r.chooseMemoryType(u,u.numInstances,a,s),u.streamingDraw||(s+=u.byteSize,a+=1,h||(u.discardAfterUpload=!0)),h&&(o[u.id]=!0)}for(l=1;l<r.geoms.length;l++)if((u=r.geoms[l])&&!o[l]){var d=n[l];r.chooseMemoryType(u,d,a,s),u.streamingDraw&&i.deallocateGeometry(u),u.streamingDraw||(s+=u.byteSize,a+=1)}}(s,d,u,r);var v=e.getModelId();for(m=0;m<d.meshes.length;m++){d.meshes[m].modelId=v}return d}},96610:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GeomMergeTask:()=>r,writeIdToBuffer:()=>a});var i=1;function r(){this.vb=null,this.vbstride=0,this.posOffset=0,this.normalOffset=0,this.matrices=null,this.ranges=null,this.dbIds=null,this.id=i++}function o(e){e.x=.5*(1+Math.atan2(e.y,e.x)/Math.PI),e.y=.5*(1+e.z),e.z=0}function a(e,t,n){t[n++]=255&e,t[n++]=e>>8&255,t[n++]=e>>16&255,t[n]=0}var s=function(e,t,n,i,r,a,s){for(var l,c,u,h,d,p,f,m=e.posOffset,g=i;g<r;g++){var v=g*e.vbstride+m;s.set(e.vb[v],e.vb[v+1],e.vb[v+2]),s.applyMatrix4(n),e.vb[v]=s.x,e.vb[v+1]=s.y,e.vb[v+2]=s.z}if(-1!==e.normalOffset){var y=2*e.vbstride,b=2*e.normalOffset,_=function(e,t){return t.copy(e),t[12]=0,t[13]=0,t[14]=0,t.invert().transpose()}(n,a);for(g=i;g<r;g++){var x=g*y+b;s.set(t[x],t[x+1],0),s.divideScalar(65535),c=void 0,u=void 0,h=void 0,d=void 0,p=void 0,f=void 0,c=2*(l=s).x-1,u=2*l.y-1,h=Math.sin(c*Math.PI),d=Math.cos(c*Math.PI),p=Math.sqrt(1-u*u),f=u,l.x=d*p,l.y=h*p,l.z=f,s.applyMatrix4(_),s.normalize(),o(s),s.multiplyScalar(65535),t[x]=s.x,t[x+1]=s.y}}};function l(e,t,n){for(var i=16*e,r=0;r<16;r++)n.elements[r]=t[r+i]}r.prototype.run=function(e,t){for(var n=this.vb,i=n.length/this.vbstride,r=e.clone(),o=new Uint8Array(3*i),c=-1!==this.normalOffset?new Uint16Array(n.buffer,n.byteOffset,2*n.length):null,u=this.ranges,h=this.matrices,d=u.length-1,p=0;p<d;p++){var f=u[p],m=u[p+1];l(p,h,e),s(this,c,e,f,m,r,t);for(var g=3*f,v=m-f,y=this.dbIds[p],b=0;b<v;b++)a(y,o,g),g+=3}return{taskId:this.id,vb:this.vb,vertexIds:o}}},23406:(e,t,n)=>{"use strict";n.r(t),n.d(t,{InstanceBufferBuilder:()=>l});var i=n(87289),r=n(96610),o=n(25131),a=n(98926),s=n(16453);function l(e,t){var n=(0,o.createBufferGeometry)();n.ib=e.ib,n.vb=e.vb,n.iblines=e.iblines,(0,i.copyVertexFormat)(e,n),(0,i.copyPrimitiveProps)(e,n);this.offsets=new Float32Array(3*t),this.rotations=new Float32Array(4*t),this.scalings=new Float32Array(3*t),this.ids=new Uint8Array(3*t);var l=new s.Vector3,c=new s.Quaternion,u=new s.Vector3,h=new s.Matrix4,d=0,p=t;this.addInstance=function(e,t){return d>=p?(a.logger.warn("Instance buffer is already full."),!1):(e.decompose(l,c,u),!!function(e,t,n,i){h.compose(t,n,i);for(var r=e.elements,o=h.elements,a=0;a<16;a++){var s=r[a],l=o[a];if(Math.abs(l-s)>1e-5)return!1}return!0}(e,l,c,u)&&(this.offsets[3*d]=l.x,this.offsets[3*d+1]=l.y,this.offsets[3*d+2]=l.z,this.rotations[4*d]=c.x,this.rotations[4*d+1]=c.y,this.rotations[4*d+2]=c.z,this.rotations[4*d+3]=c.w,this.scalings[3*d]=u.x,this.scalings[3*d+1]=u.y,this.scalings[3*d+2]=u.z,(0,r.writeIdToBuffer)(t,this.ids,3*d),d++,!0))},this.finish=function(){if(0==d)return null;d<p&&(this.offsets=new Float32Array(this.offsets.buffer,0,3*d),this.rotations=new Float32Array(this.rotations.buffer,0,4*d),this.scalings=new Float32Array(this.scalings.buffer,0,3*d),this.ids=new Uint8Array(this.ids.buffer,0,3*d));var e=new s.BufferAttribute(this.offsets,3),t=new s.BufferAttribute(this.rotations,4),i=new s.BufferAttribute(this.scalings,3),r=new s.BufferAttribute(this.ids,3);return r.normalized=!0,r.bytesPerItem=1,e.divisor=1,t.divisor=1,i.divisor=1,r.divisor=1,n.setAttribute("instOffset",e),n.setAttribute("instRotation",t),n.setAttribute("instScaling",i),n.setAttribute("id",r),n.numInstances=d,n.byteSize=n.vb.byteLength+n.ib.byteLength+this.offsets.byteLength+this.rotations.byteLength+this.scalings.byteLength,n}}},35313:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ModelIteratorTexQuad:()=>E,TexQuadConfig:()=>x});var i=n(84998),r=n(67317),o=n(79175),a=n(43586),s=n(16453);function l(){this.offsetX=0,this.offsetY=0,this.scaleX=1,this.scaleY=1}function c(){var e=[],t=0,n=new l;function i(e,t){var i=t||n,r=[i.offsetX,i.offsetY,i.offsetX+i.scaleX,i.offsetY,i.offsetX+i.scaleX,i.offsetY+i.scaleY,i.offsetX,i.offsetY+i.scaleY],o=e.getAttribute("uv");if(o){for(var a=0;a<r.length;a+=2){var l=a/2;o.setXY(l,r[a],r[a+1])}o.needsUpdate=!0}else e.setAttribute("uv",new s.BufferAttribute(new Float32Array(r),2))}this.acquireQuadGeom=function(n){var r=e[t];return r?i(r,n):(r=this.createQuadGeom(n),e[t]=r),t++,r},this.createQuadGeom=function(e){var t=new s.BufferGeometry;return t.setAttribute("position",new s.BufferAttribute(new Float32Array([0,0,0,1,0,0,1,1,0,0,1,0]),3)),t.setIndex([0,1,2,0,2,3]),t.computeVertexNormals(),i(t,e),t},this.reset=function(){t=0},this.dispose=function(){for(var t=0;t<e.length;t++){var n=e[t];n&&(n.dispose(),n.needsUpdate=!0)}e=[]}}l.prototype.toVec4=function(){return new s.Vector4(this.offsetX,this.offsetY,this.scaleX,this.scaleY)},l.prototype.copyTo=function(e){e.offsetX=this.offsetX,e.offsetY=this.offsetY,e.scaleX=this.scaleX,e.scaleY=this.scaleY};var u=n(98926),h=n(27820),d=n(14705),p=n(34722),f=n.n(p),m=n(13518),g=n.n(m),v=n(12990),y={uniforms:s.UniformsUtils.merge([s.UniformsLib.common,v.ShaderChunks.CutPlanesUniforms,v.ShaderChunks.IdUniforms,v.ShaderChunks.ThemingUniform,{selectionColor:{type:"v4",value:new s.Vector4(0,0,1,0)},viewportBounds:{type:"v4",value:new s.Vector4(0,0,1,1)},modelLocalMatrix:{type:"m4",value:new s.Matrix4}}]),vertexShader:f(),fragmentShader:g()},b=(0,i.getGlobal)().document,_=function(e,t){this.timeStamps=e,this.mesh=t,this.state=0};function x(){this.urlPattern=null,this.tileSize=null,this.maxLevel=null,this.skippedLevels=[],this.textureLoader=null,this.texWidth=0,this.texHeight=0,this.maxActiveTiles=(0,i.isMobileDevice)()?0:400,this.cacheSize=(0,i.isMobileDevice)()?0:150,this.onRootLoaded=null,this.levelOffset=0,this.getRootTileSize=function(){return 1*(this.tileSize<<this.maxLevel)},this.getQuadWidth=function(){return this.scale*this.texWidth/this.getRootTileSize()},this.getQuadHeight=function(){return this.scale*this.texHeight/this.getRootTileSize()},this.getPageToModelTransform=function(e,t){var n=e/this.getQuadWidth(),i=t/this.getQuadHeight();return new a.LmvMatrix4(!0).set(n,0,0,0,0,i,0,0,0,0,1,0,0,0,0,1)},this.getBBox=function(){var e=this.getQuadWidth(),t=this.getQuadHeight();if(this.fitPaperSize)return new s.Box3(new s.Vector3,new s.Vector3(e,t,0));var n=1-t;return new s.Box3(new s.Vector3(0,n,0),new s.Vector3(e,1,0))},this.valid=function(){return"string"==typeof this.urlPattern&&this.urlPattern.length>0&&"number"==typeof this.tileSize&&this.tileSize>0&&"number"==typeof this.maxLevel&&this.maxLevel>0&&"number"==typeof this.texWidth&&this.texWidth>0&&"number"==typeof this.texHeight&&this.texHeight>0},this.initForSimpleImage=function(e){this.urlPattern=decodeURIComponent(e),this.maxLevel=0,this.levelOffset=0,this.scale=1,this.tileSize=-1,this.texWidth=-1,this.texHeight=-1,this.isSimpleImage=!0},this.isLevelPresent=function(e){return!this.skippedLevels[e]},this.initFromLoadOptions=function(e,t,n){if(this.urlPattern=decodeURIComponent(e),this.textureLoader=n,t){this.tileSize=t.tileSize,this.maxLevel=(r=t.texWidth,o=t.texHeight,a=t.tileSize,s=Math.ceil(Math.log2(r)),l=Math.ceil(Math.log2(o)),Math.max(s,l)-Math.log2(a)),this.texWidth=t.texWidth,this.texHeight=t.texHeight,this.levelOffset=t.levelOffset,this.zips=t.zips;var i=!(!t.paperWidth||!t.paperHeight);this.fitPaperSize=t.fitPaperSize&&i,this.paperHeight=t.paperHeight,this.scale=this.fitPaperSize?t.paperWidth*this.getRootTileSize()/this.texWidth:1,this.skippedLevels=function(e){var t=[];if(e.zips){n=(n=(n=(n=e.urlPattern.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")).replace(/\\{x\\}/,"[0-9]+")).replace(/\\{y\\}/,"[0-9]+")).replace(/\\{z\\}/,"([0-9]+)");var n=new RegExp("^"+n+"$");t.length=e.maxLevel+1,t.fill(!0);var i=0;e.zips.forEach((function(r){Object.keys(r.fileTable).forEach((function(r){var o=n.exec(r);if(o&&o[1]){var a=parseInt(o[1])-e.levelOffset;a>=0&&a<=e.maxLevel&&(t[a]=!1,++i)}}))})),0===i&&(t.length=0,u.logger.info("No leaflet levels found - assume all are present"))}return t}(this),"number"==typeof t.maxLevel&&function(e,t,n){for(;n>0&&e.skippedLevels[n];)--n;var i=t-n;i>0&&(e.texWidth>>=i,e.texHeight>>=i,e.maxLevel=n)}(this,this.maxLevel,t.maxLevel),this.maxActiveTiles=t.maxActiveTiles||this.maxActiveTiles,this.cacheSize=t.cacheSize||this.cacheSize}var r,o,a,s,l}}function E(e,t){this.isModelIteratorTexQuad=!0;var n,i=e,a=1,u=e.getBBox(),p=[],f=null,m=null,g=new s.Matrix4,v=new s.Matrix4,x=new s.Matrix4,E=new s.Vector3,w=new s.Quaternion,S=new s.Vector3,A=new Autodesk.Viewing.Private.FrustumIntersector,M=1,T=1,C=new s.Vector4(0,0,0,0),P=(new s.Vector4).copy(C),L=0,R=t,D=null,I=!1,O=!1,N=!1,k=new s.Color,F=[],U=[],B=[];this.registerView=function(){var e=p.indexOf(void 0);-1===e&&(e=p.length);var t=new s.Scene;return t.ignoreFadeMaterial=!0,i.placementTransform&&t.matrix.copy(i.placementTransform),t.matrixAutoUpdate=!1,p[e]=t,B[e]=0,F[e]=!0,e},this.registerView();var V=0,G=0,z=!1,H=[],W=null,j=!1,q=new c;function X(e){var t=i.maxLevel-e;return i.texWidth>>t}function Y(e){var t=i.maxLevel-e;return i.texHeight>>t}function K(e){var t=X(e.level),n=Y(e.level),r=e.x*i.tileSize,o=e.y*i.tileSize;return r>=t||o>=n}function Z(e){var t=X(e.level),n=Y(e.level),r=e.x*i.tileSize,o=e.y*i.tileSize,a=Math.max(0,Math.min(i.tileSize,t-r)),l=Math.max(0,Math.min(i.tileSize,n-o)),c=1*i.tileSize;return new s.Vector2(a/c,l/c)}function J(e){return i.scale/(1<<e)}function Q(e){return J(e.level)*e.x*a}function $(e){var t=J(e.level);return(i.fitPaperSize?i.paperHeight:1)-(e.y+1)*t*a}function ee(e){return U[(0,r.tile2Index)(e)]}function te(e){var t=ee(e);return t instanceof _&&2===t.state}function ne(e,t,n){var i;if(t)W||(W=q.createQuadGeom()),i=W;else{var r=function(e,t){for(var n=e.getParent();n;){var i=ee(n),r=i&&2===i.state;if(r&&t&&i.mesh.material.map.needsUpdate&&n.level>0&&(r=!1),r)break;n=n.getParent()}return n}(e);t=oe(r).material;var o=function(e,t){var n=1<<e.level-t.level,i=1/n,r=i,o=Z(t);i/=o.x,r/=o.y;var a=t.x*n,s=t.y*n,c=e.x-a,u=e.y-s,h=Z(e);c*=i,u=1-(u*=r)-r*h.y;var d=new l;return d.offsetX=c,d.offsetY=u,d.scaleX=i*h.x,d.scaleY=r*h.y,d}(e,r);i=q.acquireQuadGeom(o)}var c=new s.Mesh(i,t);c.tile=e,c.modelId=L,c.themingColor=P;var u=J(e.level),h=Z(e),d=(1-h.y)*u*a,p=Q(e),f=$(e);return c.position.set(p,f+d,0),c.scale.set(u*h.x*a,u*h.y*a,1),t.uniforms.offsetRepeat.value.set(t.map.offset.x,t.map.offset.y,t.map.repeat.x,t.map.repeat.y),c}this.setAggressivePrefetching=function(e){j=e},this.getScene=function(e){return p[e=e||0]},this.getModelMatrix=function(){return f},this.getInverseModelMatrix=function(){return f?(m||(m=f.clone().invert()),m):null},this.setModelMatrix=function(e){e?(f=f||new s.Matrix4).copy(e):f=null,m=null},this.nextBatch=function(e){return F[e=e||0]?null:(F[e]=!0,p[0].renderImportance=O?-1:void 0,p[0])},this.getSceneCount=function(){return 1},this.done=function(e){return F[e||0]},this.rayCast=function(e,t){return null},this.getVisibleBounds=function(e,t){var n=u;D&&(n=n.clone().intersect(D)),e&&(e.copy(n),i.placementTransform&&e.applyMatrix4(i.placementTransform),f&&e.applyMatrix4(f)),t&&(t.copy(n),i.placementTransform&&t.applyMatrix4(i.placementTransform),f&&t.applyMatrix4(f))},this.setViewBounds=function(e){D=e,R.setViewportBoundsForModel(L,D)},this.getViewBounds=function(){return D},this.setDoNotCut=function(e){return I=e},this.getDoNotCut=function(){return I};var ie=this;function re(t){var n=(0,r.tile2Index)(t),o=U[n];if(!o||0===o.state){o||(o=new _(B.slice()),U[n]=o),o.state=1;var a=function(e){var t=i.levelOffset?i.levelOffset:0;return i.urlPattern.replace("{x}",e.x).replace("{y}",e.y).replace("{z}",e.level+t)}(t),l=function(n){if(ie&&n){0===i.maxLevel&&(-1===i.texWidth&&(i.texWidth=n.image.width),-1===i.texHeight&&(i.texHeight=n.image.height),-1===i.tileSize&&(i.tileSize=Math.max(n.image.width,n.image.height)),u=e.getBBox()),function(e){for(var t=e.image,n=1;(n*=2)<t.width;);for(var i=1;(i*=2)<t.height;);if(n!==t.width||i!==t.height){var r=b.createElement("canvas");r.width=n,r.height=i;var o=r.getContext("2d");o.drawImage(t,0,0);var a,s,l=o.getImageData(0,0,n,i),c=new Uint32Array(l.data.buffer,0,n*i);if(t.height<i){var u=t.height*n;for(a=t.height;a<i;++a,u+=n)for(s=0;s<t.width;++s)c[u+s]=c[u+s-n]}if(t.width<n){var h=0;for(a=0;a<i;++a,h+=n)for(s=t.width;s<n;++s)c[h+s]=c[h+s-1]}o.putImageData(l,0,0),e.image=r,e.flipY&&e.offset.set(0,1-t.height/i),e.repeat.set(t.width/n,t.height/i)}}(n),n.minFilter=s.LinearMipMapLinearFilter,n.magFilter=s.LinearFilter,n.anisotropy=Math.min(4,Math.max(i.maxAnisotropy,1));var r=(0,d.createShaderMaterial)(y);r.supportsMrtNormals=!0,r.supportsViewportBounds=!0,r.map=r.uniforms.map.value=n,r.side=s.DoubleSide,r.doNotCut=ie.getDoNotCut(),r.tile=t,r.disableEnvMap=!0,-1!==a.toLowerCase().indexOf(".png")&&(r.transparent=!0,r.alphaTest=.01);var l=ne(t,r);o.mesh=l,o.state=2,G--,z=!0;var c=n&&n.image?n.image.src:null;c&&s.Cache&&s.Cache.get(c)&&s.Cache.remove(c),0===t.level&&i.onRootLoaded&&(L=i.onRootLoaded()),l.themingColor=P,l.modelId=L,r.name="model:".concat(L,"|").concat(a),R.addMaterial(r.name,r,!0),R.setMaterialViewportBounds(r,D),ie._updateMaterialVisibility(r),ie._updateMaterialSelection(r)}};G++,i.textureLoader(a,(function(e,t){l(e)}),(function(e){i.onDone(e,null),console.error(e)}))}}function oe(e){var t=(0,r.tile2Index)(e),n=U[t];return n&&2===n.state?n.mesh:null}function ae(e,t){var n=Q(e)*M,i=$(e)*T;t.set(n,i,0)}function se(e,t){var n=J(e.level),i=(Q(e)+n)*M,r=($(e)+n)*T;t.set(i,r,0)}this.requestRootTile=function(){re(new r.TileCoords(0,0,0))};var le,ce,ue,he=(le=new s.Vector3,ce=new s.Vector3,ue=new s.Box3,function(e,t){return ae(e,le),se(e,ce),ue.set(le,ce),t.intersectsBox(ue)>0}),de=function(){var e=new s.Vector3,t=new s.Vector3;return function(n,i,r){var o=J(n.level);ae(n,e),se(n,t);var a=h.SceneMath.pointToMinMaxBoxDistance2(r,e,t);return(he(n,i)?100:1)*(o*o)/(a=Math.max(a,1e-4))}}(),pe=function(){var e=new s.Vector3,t=new s.Vector3;return function(n,r,o){ae(n,e),se(n,t);var a=Math.abs(function(e,t,n,i){var r=e.clone();return r.max(n),r.min(i),r.sub(e).dot(t)}(r.position,o,e,t)),s=i.getPixelRatio(),l=r.pixelsPerUnitAtDistance(a)*s;return(t.y-e.y)*l}}();function fe(e,t){this.tile=e,this.prio=t}function me(e,t){return e.prio>t.prio}function ge(e,t){var n=U[(0,r.tile2Index)(e)];n&&n.timeStamps[t]!==B[t]&&(n.timeStamps[t]=B[t],V++)}function ve(e,t,n){e.sort((function(e,i){var r=de(e,t,n);return de(i,t,n)-r}));for(var i=0,r=0;r<e.length;r++){var o=ee(e[r]);if(!o||1!==o.state){if(G>=5)break;re(e[r]),i++}}return i}function ye(e){if(e&&e.mesh&&e.mesh.material){var t=e.mesh.material;R.removeMaterial(t.name),t.map.dispose(),t.map.needsUpdate=!0;t.dispatchEvent({type:"dispose"}),t.needsUpdate=!0}}function be(e){for(var t=0;t<B.length;t++){if(!!p[t]&&e.timeStamps[t]===B[t])return!0}return!1}this.dispose=function(){var e;for(e in U)ye(U[e]);W&&(W.dispose(),W.needsUpdate=!0),q.dispose()},this.dtor=function(){this.dispose(),ie=null,R=null},this.reset=function(e,t,a){var l,c,u=(a=a||0)>0,h=p[a],d=function(e,t,i){var r=e.matrixWorld;return f?r.multiplyMatrices(f,e.matrix):r.copy(e.matrix),r.equals(x)?(M=1,T=1):(r.decompose(E,w,S),g.makeRotationFromQuaternion(w),g.setPosition(E),M=S.x,T=S.y,n=i.clone(n),v.copy(g).invert(),n.applyMatrix4(v),n.updateCameraMatrices(),(t=A).reset(n),i=n),{camera:i,frustum:t}}(h,e,t);for(t=d.camera,e=d.frustum,l=0;l<h.children.length;l++){h.children[l].dispatchEvent({type:"removed"})}if(h.children.length=0,B[a]++,V=0,q.reset(),!te(new r.TileCoords(0,0,0)))return F[a]=!0,!1;var m=new o.SortedList(me),y=new r.TileCoords(0,0,0),b=de(y,e,t.position);m.add(new fe(y,b));for(var _=t.getWorldDirection(new s.Vector3),C=[],P=[],L=[];m.size()>0;){if(c=m.get(0).tile,m.removeAt(0),!K(c)){var R=!0;c.level===i.maxLevel&&(R=!1),pe(c,t,_)<i.tileSize&&i.isLevelPresent(c.level)&&(R=!1);var D=he(c,e);if(D&&(!te(c)&&i.isLevelPresent(c.level)&&L.push(c),ge(c,a)),!D&&C.length+P.length>i.maxActiveTiles&&(R=!1),R)for(var I=0;I<4;I++){var O=c.getChild(I);b=de(O,e,t.position),m.add(new fe(O,b))}else D?C.push(c):P.push(c)}}var N=0;z=!1;var k=!0;for(l=0;l<C.length;++l){var W=oe(c=C[l]);W&&W.material.map.needsUpdate&&!j&&(N<5||u?N++:(W=ne(c,null),z=!0,k=!1)),W||(W=ne(c,null),k=!1),h.add(W)}F[a]=!1;var X=ve(L,e,t.position);V+=G;var Y=[];for(l=0;l<P.length&&!(V>=i.maxActiveTiles);l++)if(te(c=P[l]))for(var Z=0;Z<=c.level;Z++){if(ge(c.getParentAtLevel(Z),a),V>i.maxActiveTiles)break}else Y.push(c),V++;if(X+=ve(Y,e,t.position),j){for(Y=[],l=0;l<C.length;++l)if((c=C[l]).level!==i.maxLevel&&i.isLevelPresent(c.level+1))for(var J=0;J<4;J++){var Q=c.getChild(J);!K(Q)&&he(Q,e)&&(te(Q)||(Y.push(Q),V++))}X+=ve(Y,e,t.position)}if(u||function(e,t,n){var o=Object.keys(U),a=o.length,s=e-(i.cacheSize-a);if(!(s<=0)){o.sort((function(e,i){var o=U[e].timeStamps[0],a=U[i].timeStamps[0];if(o!==a)return o-a;var s=(0,r.index2Tile)(e),l=(0,r.index2Tile)(i);return de(s,t,n)-de(l,t,n)}));for(var l=Math.min(s,o.length),c=0;c<l;c++){var u=o[c];if(0!==(0,r.index2Tile)(u).level){var h=U[u];if(2===h.state){if(be(h))break;ye(h),delete U[u]}}}}}(X,e,t.position),k&&H.length>0){var $=H.splice(0,H.length);setTimeout((function(){for(var e=0;e<$.length;e++)$[e](a)}),1)}return k},this.callWhenRefined=function(e){H.push(e)},this.update=function(){return z},this.setDpiScale=function(e){a=e},this.getDpiScale=function(){return a},this.setThemingColor=function(e){P.copy(e)},this.clearThemingColor=function(){P.copy(C)},this.unregisterView=function(e){p[e]=void 0,B[e]=void 0,F[e]=void 0;for(var t=p.length;t>0&&!p[t-1];)t--;p.length=t,B.length=t,F.length=t},this._updateMaterialVisibility=function(e){!e.defines.GHOSTED^!O&&(O?e.defines.GHOSTED=1:delete e.defines.GHOSTED,e.needsUpdate=!0)},this.setVisibility=function(e){var t=this;O=!e,R.forEachInModel(L,!1,(function(e){t._updateMaterialVisibility(e)}))},this._updateMaterialSelection=function(e){e.uniforms.selectionColor.value.set(k.r,k.g,k.b,N?.6:0)},this.highlightSelection=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k;N=e,k=n,R.forEachInModel(L,!1,(function(e){t._updateMaterialSelection(e)}))}}},67317:(e,t,n)=>{"use strict";function i(e,t,n){this.level=e,this.x=t,this.y=n}function r(e){var t=((1<<2*e.level)-1)/3,n=1<<e.level;return t+e.y*n+e.x}function o(e){for(var t=new i(0,0,0);r(t)<=e;)t.level++;t.level--;var n=e-r(t),o=1<<t.level;return t.y=Math.floor(n/o),t.x=n%o,t}n.r(t),n.d(t,{TileCoords:()=>i,tile2Index:()=>r,index2Tile:()=>o}),i.prototype={constructor:i,copy:function(){return new i(this.level,this.x,this.y)},isValid:function(){return Number.isInteger(this.level)&&this.level>=0&&Number.isInteger(this.x)&&Number.isInteger(this.y)},getChild:function(e){var t=1&e?1:0,n=2&e?1:0;return new i(this.level+1,2*this.x+t,2*this.y+n)},getParent:function(){return 0===this.level?null:new i(this.level-1,Math.floor(this.x/2),Math.floor(this.y/2))},getParentAtLevel:function(e){if(e<0||e>this.level)return null;var t=this.level-e;return new i(e,Math.floor(this.x>>t),Math.floor(this.y>>t))},toString:function(){return"("+this.level+", "+this.x+", "+this.y+")"},equals:function(e,t,n){return e instanceof i?this.equals(e.level,e.x,e.y):this.level===e&&this.x===t&&this.y===n}}},41145:(e,t,n)=>{var i;function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}
/*! Hammer.JS - v2.0.8 - 2016-04-23
                                                                                                                                                                                                                                                                                                                                                                                * http://hammerjs.github.io/
                                                                                                                                                                                                                                                                                                                                                                                *
                                                                                                                                                                                                                                                                                                                                                                                * Copyright (c) 2016 Jorik Tangelder;
                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the MIT license */!function(o,a,s,l){"use strict";var c=["","webkit","Moz","MS","ms","o"],u=a.createElement("div"),h=Math.round,d=Math.abs,p=Date.now;function f(e,t,n){return setTimeout(E(e,n),t)}function m(e,t,n){return!!Array.isArray(e)&&(g(e,n[t],n),!0)}function g(e,t,n){var i;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==l)for(i=0;i<e.length;)t.call(n,e[i],i,e),i++;else for(i in e)e.hasOwnProperty(i)&&t.call(n,e[i],i,e)}function v(e,t,n){var i="DEPRECATED METHOD: "+t+"\n"+n+" AT \n";return function(){var t=new Error("get-stack-trace"),n=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",r=o.console&&(o.console.warn||o.console.log);return r&&r.call(o.console,i,n),e.apply(this,arguments)}}var y=function(e){if(e===l||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(i!==l&&null!==i)for(var r in i)i.hasOwnProperty(r)&&(t[r]=Array.isArray(i[r])?i[r].slice(0):i[r])}return t},b=v((function(e,t,n){for(var i=Object.keys(t),r=0;r<i.length;)(!n||n&&e[i[r]]===l)&&(e[i[r]]=t[i[r]]),r++;return e}),"extend","Use `assign`."),_=v((function(e,t){return b(e,t,!0)}),"merge","Use `assign`.");function x(e,t,n){var i,r=t.prototype;(i=e.prototype=Object.create(r)).constructor=e,i._super=r,n&&y(i,n)}function E(e,t){return function(){return e.apply(t,arguments)}}function w(e,t){return"function"==r(e)?e.apply(t&&t[0]||l,t):e}function S(e,t){return e===l?t:e}function A(e,t,n){g(P(t),(function(t){e.addEventListener(t,n,!1)}))}function M(e,t,n){g(P(t),(function(t){e.removeEventListener(t,n,!1)}))}function T(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function C(e,t){return e.indexOf(t)>-1}function P(e){return e.trim().split(/\s+/g)}function L(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var i=0;i<e.length;){if(n&&e[i][n]==t||!n&&e[i]===t)return i;i++}return-1}function R(e){return Array.prototype.slice.call(e,0)}function D(e,t,n){for(var i=[],r=[],o=0;o<e.length;){var a=t?e[o][t]:e[o];L(r,a)<0&&i.push(e[o]),r[o]=a,o++}return n&&(i=t?i.sort((function(e,n){return e[t]>n[t]})):i.sort()),i}function I(e,t){for(var n,i,r=t[0].toUpperCase()+t.slice(1),o=0;o<c.length;){if((i=(n=c[o])?n+r:t)in e)return i;o++}return l}var O=1;function N(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||o}var k="ontouchstart"in o,F=I(o,"PointerEvent")!==l,U=k&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),B="touch",V="mouse",G=24,z=["x","y"],H=["clientX","clientY"];function W(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){w(e.options.enable,[e])&&n.handler(t)},this.init()}function j(e,t,n){var i=n.pointers.length,r=n.changedPointers.length,o=1&t&&i-r==0,a=12&t&&i-r==0;n.isFirst=!!o,n.isFinal=!!a,o&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,i=t.pointers,r=i.length;n.firstInput||(n.firstInput=q(t));r>1&&!n.firstMultiple?n.firstMultiple=q(t):1===r&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,s=a?a.center:o.center,c=t.center=X(i);t.timeStamp=p(),t.deltaTime=t.timeStamp-o.timeStamp,t.angle=J(s,c),t.distance=Z(s,c),function(e,t){var n=t.center,i=e.offsetDelta||{},r=e.prevDelta||{},o=e.prevInput||{};1!==t.eventType&&4!==o.eventType||(r=e.prevDelta={x:o.deltaX||0,y:o.deltaY||0},i=e.offsetDelta={x:n.x,y:n.y});t.deltaX=r.x+(n.x-i.x),t.deltaY=r.y+(n.y-i.y)}(n,t),t.offsetDirection=K(t.deltaX,t.deltaY);var u=Y(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=u.x,t.overallVelocityY=u.y,t.overallVelocity=d(u.x)>d(u.y)?u.x:u.y,t.scale=a?(h=a.pointers,f=i,Z(f[0],f[1],H)/Z(h[0],h[1],H)):1,t.rotation=a?function(e,t){return J(t[1],t[0],H)-J(e[1],e[0],H)}(a.pointers,i):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,i,r,o,a=e.lastInterval||t,s=t.timeStamp-a.timeStamp;if(8!=t.eventType&&(s>25||a.velocity===l)){var c=t.deltaX-a.deltaX,u=t.deltaY-a.deltaY,h=Y(s,c,u);i=h.x,r=h.y,n=d(h.x)>d(h.y)?h.x:h.y,o=K(c,u),e.lastInterval=t}else n=a.velocity,i=a.velocityX,r=a.velocityY,o=a.direction;t.velocity=n,t.velocityX=i,t.velocityY=r,t.direction=o}(n,t);var h,f;var m=e.element;T(t.srcEvent.target,m)&&(m=t.srcEvent.target);t.target=m}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function q(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:h(e.pointers[n].clientX),clientY:h(e.pointers[n].clientY)},n++;return{timeStamp:p(),pointers:t,center:X(t),deltaX:e.deltaX,deltaY:e.deltaY}}function X(e){var t=e.length;if(1===t)return{x:h(e[0].clientX),y:h(e[0].clientY)};for(var n=0,i=0,r=0;r<t;)n+=e[r].clientX,i+=e[r].clientY,r++;return{x:h(n/t),y:h(i/t)}}function Y(e,t,n){return{x:t/e||0,y:n/e||0}}function K(e,t){return e===t?1:d(e)>=d(t)?e<0?2:4:t<0?8:16}function Z(e,t,n){n||(n=z);var i=t[n[0]]-e[n[0]],r=t[n[1]]-e[n[1]];return Math.sqrt(i*i+r*r)}function J(e,t,n){n||(n=z);var i=t[n[0]]-e[n[0]],r=t[n[1]]-e[n[1]];return 180*Math.atan2(r,i)/Math.PI}W.prototype={handler:function(){},init:function(){this.evEl&&A(this.element,this.evEl,this.domHandler),this.evTarget&&A(this.target,this.evTarget,this.domHandler),this.evWin&&A(N(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&M(this.element,this.evEl,this.domHandler),this.evTarget&&M(this.target,this.evTarget,this.domHandler),this.evWin&&M(N(this.element),this.evWin,this.domHandler)}};var Q={mousedown:1,mousemove:2,mouseup:4},$="mousedown",ee="mousemove mouseup";function te(){this.evEl=$,this.evWin=ee,this.pressed=!1,W.apply(this,arguments)}x(te,W,{handler:function(e){var t=Q[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:V,srcEvent:e}))}});var ne={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},ie={2:B,3:"pen",4:V,5:"kinect"},re="pointerdown",oe="pointermove pointerup pointercancel";function ae(){this.evEl=re,this.evWin=oe,W.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}o.MSPointerEvent&&!o.PointerEvent&&(re="MSPointerDown",oe="MSPointerMove MSPointerUp MSPointerCancel"),x(ae,W,{handler:function(e){var t=this.store,n=!1,i=e.type.toLowerCase().replace("ms",""),r=ne[i],o=ie[e.pointerType]||e.pointerType,a=o===B,s=o===V,l=L(t,e.pointerId,"pointerId");1&r&&(0===e.button||a)?l<0&&(t.push(e),l=t.length-1):12&r&&(n=!0),l<0||(t[l]=e,s&&!this.manager.options.handlePointerEventMouse||this.callback(this.manager,r,{pointers:t,changedPointers:[e],pointerType:o,srcEvent:e}),n&&t.splice(l,1))}});var se={touchstart:1,touchmove:2,touchend:4,touchcancel:8},le="touchstart",ce="touchstart touchmove touchend touchcancel";function ue(){this.evTarget=le,this.evWin=ce,this.started=!1,W.apply(this,arguments)}function he(e,t){var n=R(e.touches),i=R(e.changedTouches);return 12&t&&(n=D(n.concat(i),"identifier",!0)),[n,i]}x(ue,W,{handler:function(e){var t=se[e.type];if(1===t&&(this.started=!0),this.started){var n=he.call(this,e,t);12&t&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:B,srcEvent:e})}}});var de={touchstart:1,touchmove:2,touchend:4,touchcancel:8},pe="touchstart touchmove touchend touchcancel";function fe(){this.evTarget=pe,this.targetIds={},W.apply(this,arguments)}function me(e,t){var n=R(e.touches),i=this.targetIds;if(3&t&&1===n.length)return i[n[0].identifier]=!0,[n,n];var r,o,a=R(e.changedTouches),s=[],l=this.target;if(o=n.filter((function(e){return T(e.target,l)})),1===t)for(r=0;r<o.length;)i[o[r].identifier]=!0,r++;for(r=0;r<a.length;)i[a[r].identifier]&&s.push(a[r]),12&t&&delete i[a[r].identifier],r++;return s.length?[D(o.concat(s),"identifier",!0),s]:void 0}x(fe,W,{handler:function(e){var t=de[e.type],n=me.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:B,srcEvent:e})}});function ge(){W.apply(this,arguments);var e=E(this.handler,this);this.touch=new fe(this.manager,e),this.mouse=new te(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function ve(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,ye.call(this,t)):12&e&&ye.call(this,t)}function ye(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var i=this.lastTouches;setTimeout((function(){var e=i.indexOf(n);e>-1&&i.splice(e,1)}),2500)}}function be(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var r=this.lastTouches[i],o=Math.abs(t-r.x),a=Math.abs(n-r.y);if(o<=25&&a<=25)return!0}return!1}x(ge,W,{handler:function(e,t,n){var i=n.pointerType==B,r=n.pointerType==V;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(i)ve.call(this,t,n);else if(r&&be.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var _e=I(u.style,"touchAction"),xe=_e!==l,Ee="compute",we="auto",Se="manipulation",Ae="none",Me="pan-x",Te="pan-y",Ce=function(){if(!xe)return!1;var e={},t=o.CSS&&o.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){e[n]=!t||o.CSS.supports("touch-action",n)})),e}();function Pe(e,t){this.manager=e,this.set(t)}Pe.prototype={set:function(e){e==Ee&&(e=this.compute()),xe&&this.manager.element.style&&Ce[e]&&(this.manager.element.style[_e]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return g(this.manager.recognizers,(function(t){w(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))})),function(e){if(C(e,Ae))return Ae;var t=C(e,Me),n=C(e,Te);if(t&&n)return Ae;if(t||n)return t?Me:Te;if(C(e,Se))return Se;return we}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var i=this.actions,r=C(i,Ae)&&!Ce.none,o=C(i,Te)&&!Ce["pan-y"],a=C(i,Me)&&!Ce["pan-x"];if(r){var s=1===e.pointers.length,l=e.distance<2,c=e.deltaTime<250;if(s&&l&&c)return}if(!a||!o)return r||o&&6&n||a&&n&G?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Le=32;function Re(e){this.options=y({},this.defaults,e||{}),this.id=O++,this.manager=null,this.options.enable=S(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function De(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function Ie(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function Oe(e,t){var n=t.manager;return n?n.get(e):e}function Ne(){Re.apply(this,arguments)}function ke(){Ne.apply(this,arguments),this.pX=null,this.pY=null}function Fe(){Ne.apply(this,arguments)}function Ue(){Re.apply(this,arguments),this._timer=null,this._input=null}function Be(){Ne.apply(this,arguments)}function Ve(){Ne.apply(this,arguments)}function Ge(){Re.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ze(e,t){return(t=t||{}).recognizers=S(t.recognizers,ze.defaults.preset),new He(e,t)}Re.prototype={defaults:{},set:function(e){return y(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(m(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Oe(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return m(e,"dropRecognizeWith",this)||(e=Oe(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(m(e,"requireFailure",this))return this;var t=this.requireFail;return-1===L(t,e=Oe(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(m(e,"dropRequireFailure",this))return this;e=Oe(e,this);var t=L(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function i(n){t.manager.emit(n,e)}n<8&&i(t.options.event+De(n)),i(t.options.event),e.additionalEvent&&i(e.additionalEvent),n>=8&&i(t.options.event+De(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Le},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=y({},e);if(!w(this.options.enable,[this,t]))return this.reset(),void(this.state=Le);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},x(Ne,Re,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,i=6&t,r=this.attrTest(e);return i&&(8&n||!r)?16|t:i||r?4&n?8|t:2&t?4|t:2:Le}}),x(ke,Ne,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(Te),e&G&&t.push(Me),t},directionTest:function(e){var t=this.options,n=!0,i=e.distance,r=e.direction,o=e.deltaX,a=e.deltaY;return r&t.direction||(6&t.direction?(r=0===o?1:o<0?2:4,n=o!=this.pX,i=Math.abs(e.deltaX)):(r=0===a?1:a<0?8:16,n=a!=this.pY,i=Math.abs(e.deltaY))),e.direction=r,n&&i>t.threshold&&r&t.direction},attrTest:function(e){return Ne.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Ie(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),x(Fe,Ne,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ae]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),x(Ue,Re,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[we]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,r=e.deltaTime>t.time;if(this._input=e,!i||!n||12&e.eventType&&!r)this.reset();else if(1&e.eventType)this.reset(),this._timer=f((function(){this.state=8,this.tryEmit()}),t.time,this);else if(4&e.eventType)return 8;return Le},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}}),x(Be,Ne,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ae]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),x(Ve,Ne,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return ke.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return 30&n?t=e.overallVelocity:6&n?t=e.overallVelocityX:n&G&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&d(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=Ie(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),x(Ge,Re,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Se]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,r=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(i&&r&&n){if(4!=e.eventType)return this.failTimeout();var o=!this.pTime||e.timeStamp-this.pTime<t.interval,a=!this.pCenter||Z(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,a&&o?this.count+=1:this.count=1,this._input=e,0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=f((function(){this.state=8,this.tryEmit()}),t.interval,this),2):8}return Le},failTimeout:function(){return this._timer=f((function(){this.state=Le}),this.options.interval,this),Le},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ze.VERSION="2.0.8",ze.defaults={domEvents:!1,touchAction:Ee,enable:!0,handlePointerEventMouse:!0,inputTarget:null,inputClass:null,preset:[[Be,{enable:!1}],[Fe,{enable:!1},["rotate"]],[Ve,{direction:6}],[ke,{direction:6},["swipe"]],[Ge],[Ge,{event:"doubletap",taps:2},["tap"]],[Ue]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function He(e,t){var n;this.options=y({},ze.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((n=this).options.inputClass||(F?ae:U?fe:k?ge:te))(n,j),this.touchAction=new Pe(this,this.options.touchAction),We(this,!0),g(this.options.recognizers,(function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])}),this)}function We(e,t){var n,i=e.element;i.style&&(g(e.options.cssProps,(function(r,o){n=I(i.style,o),t?(e.oldCssProps[n]=i.style[n],i.style[n]=r):i.style[n]=e.oldCssProps[n]||""})),t||(e.oldCssProps={}))}He.prototype={set:function(e){return y(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var i=this.recognizers,r=t.curRecognizer;(!r||r&&8&r.state)&&(r=t.curRecognizer=null);for(var o=0;o<i.length;)n=i[o],2===t.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(e),!r&&14&n.state&&(r=t.curRecognizer=n),o++}},get:function(e){if(e instanceof Re)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(m(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(m(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=L(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==l&&t!==l){var n=this.handlers;return g(P(e),(function(e){n[e]=n[e]||[],n[e].push(t)})),this}},off:function(e,t){if(e!==l){var n=this.handlers;return g(P(e),(function(e){t?n[e]&&n[e].splice(L(n[e],t),1):delete n[e]})),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var n=a.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()},t.stopPropagation=function(){t.srcEvent.stopPropagation()};for(var i=0;i<n.length;)n[i](t),i++}},destroy:function(){this.element&&We(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},y(ze,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Le,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:G,DIRECTION_ALL:30,Manager:He,Input:W,TouchAction:Pe,TouchInput:fe,MouseInput:te,PointerEventInput:ae,TouchMouseInput:ge,SingleTouchInput:ue,Recognizer:Re,AttrRecognizer:Ne,Tap:Ge,Pan:ke,Swipe:Ve,Pinch:Fe,Rotate:Be,Press:Ue,on:A,off:M,each:g,merge:_,extend:b,assign:y,inherit:x,bindFn:E,prefixed:I}),(void 0!==o?o:"undefined"!=typeof self?self:{}).Hammer=ze,(i=function(){return ze}.call(t,n,t,e))===l||(e.exports=i)}(window,document)},90050:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DDSLoader:()=>r});var i=n(16453),r=function e(){this.parse=e.parse};r.prototype=Object.create(i.CompressedTextureLoader.prototype),r.prototype.constructor=r,r.parse=function(e,t){var n={mipmaps:[],width:0,height:0,format:null,mipmapCount:1};function r(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function o(e,t,n,i){for(var r=n*i*4,o=new Uint8Array(e,t,r),a=new Uint8Array(r),s=0,l=0,c=0;c<i;c++)for(var u=0;u<n;u++){var h=o[l],d=o[++l],p=o[++l],f=o[++l];l++,a[s]=p,a[++s]=d,a[++s]=h,a[++s]=f,s++}return a}var a=r("DXT1"),s=r("DXT3"),l=r("DXT5");if(e.byteLength<124)return console.error("THREE.DDSLoader.parse: File is empty or incomplete."),n;var c,u=new Int32Array(e,0,31);if(542327876!==u[0])return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),n;if(4&!u[20])return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),n;var h,d=u[21],p=!1;switch(d){case a:c=8,n.format=i.RGB_S3TC_DXT1_Format;break;case s:c=16,n.format=i.RGBA_S3TC_DXT3_Format;break;case l:c=16,n.format=i.RGBA_S3TC_DXT5_Format;break;default:if(!(32==u[22]&&16711680&u[23]&&65280&u[24]&&255&u[25]&&4278190080&u[26]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",(h=d,String.fromCharCode(255&h,h>>8&255,h>>16&255,h>>24&255))),n;p=!0,c=64,n.format=i.RGBAFormat}n.mipmapCount=1,u[7]>0&&!1!==t&&(n.mipmapCount=Math.max(1,u[7])),n.isCubemap=!!(512&u[28]),n.width=u[4],n.height=u[3];for(var f=u[1]+4,m=n.width,g=n.height,v=n.isCubemap?6:1,y=0;y<v;y++){for(var b=0;b<n.mipmapCount;b++){if(p)var _=(x=o(e,f,m,g)).length;else{_=Math.max(4,m)/4*Math.max(4,g)/4*c;var x=new Uint8Array(e,f,_)}var E={data:x,width:m,height:g};n.mipmaps.push(E),f+=_,m=Math.max(.5*m,1),g=Math.max(.5*g,1)}m=n.width,g=n.height}return n}},85212:(e,t,n)=>{"use strict";
/*!
MIT License

Copyright (c) 2019 Fyrestar

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
*/
function i(e,t){for(var n in t){var i=t[n];if("@"===n[0]){var r=n.substr(1);e=e.replace(r,i)}else if("?"===n[0]){var o=n.substr(1);e=e.replace(o,i+"\n"+o)}else e=e.replace(n,n+"\n"+i)}return e}function r(e,t){var n=(t.header||"")+"\n",r=(t.vertexHeader||"")+"\n"+e.vertexShader,o=(t.fragmentHeader||"")+"\n"+e.fragmentShader;return t.vertexEnd&&(r=r.replace(/\}(?=[^\}]*$)/g,t.vertexEnd+"\n}")),t.fragmentEnd&&(o=o.replace(/\}(?=[^\}]*$)/g,t.fragmentEnd+"\n}")),void 0!==t.vertex&&(r=i(r,t.vertex)),void 0!==t.fragment&&(o=i(o,t.fragment)),e.vertexShader=n+r,e.fragmentShader=n+o,e}n.r(t),n.d(t,{patchShader:()=>r})},16453:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ACESFilmicToneMapping:()=>se,AddEquation:()=>L,AddOperation:()=>ne,AdditiveAnimationBlendMode:()=>Jt,AdditiveBlending:()=>M,AlphaFormat:()=>Ge,AlwaysDepth:()=>X,AlwaysStencilFunc:()=>Pn,AmbientLight:()=>Xh,AmbientLightProbe:()=>md,AnimationClip:()=>Ku,AnimationLoader:()=>ih,AnimationMixer:()=>Xd,AnimationObjectGroup:()=>jd,AnimationUtils:()=>ku,ArcCurve:()=>hh,ArrayCamera:()=>ul,ArrowHelper:()=>Fp,Audio:()=>Md,AudioAnalyser:()=>Dd,AudioContext:()=>dd,AudioListener:()=>Ad,AudioLoader:()=>pd,AxesHelper:()=>Up,AxisHelper:()=>Bf,BackSide:()=>_,BasicDepthPacking:()=>un,BasicShadowMap:()=>m,BinaryTextureLoader:()=>Wf,Bone:()=>Kl,BooleanKeyframeTrack:()=>zu,BoundingBoxHelper:()=>Vf,Box2:()=>ip,Box3:()=>Ti,Box3Helper:()=>Dp,BoxBufferGeometry:()=>zo,BoxGeometry:()=>zo,BoxHelper:()=>Rp,BufferAttribute:()=>eo,BufferGeometry:()=>Eo,BufferGeometryLoader:()=>td,ByteType:()=>Le,Cache:()=>Ju,Camera:()=>Xo,CameraHelper:()=>Cp,CanvasRenderer:()=>qf,CanvasTexture:()=>Ac,CatmullRomCurve3:()=>vh,CineonToneMapping:()=>ae,CircleBufferGeometry:()=>Tc,CircleGeometry:()=>Tc,ClampToEdgeWrapping:()=>ve,Clock:()=>bd,Color:()=>Zr,ColorKeyframeTrack:()=>Hu,CompressedTexture:()=>Sc,CompressedTextureLoader:()=>rh,ConeBufferGeometry:()=>Pc,ConeGeometry:()=>Pc,CubeCamera:()=>Zo,CubeReflectionMapping:()=>ue,CubeRefractionMapping:()=>he,CubeTexture:()=>Jo,CubeTextureLoader:()=>ah,CubeUVReflectionMapping:()=>fe,CubeUVRefractionMapping:()=>me,CubicBezierCurve:()=>xh,CubicBezierCurve3:()=>Eh,CubicInterpolant:()=>Uu,CullFaceBack:()=>d,CullFaceFront:()=>p,CullFaceFrontBack:()=>f,CullFaceNone:()=>h,Curve:()=>ch,CurvePath:()=>Ch,CustomBlending:()=>P,CustomToneMapping:()=>le,CylinderBufferGeometry:()=>Cc,CylinderGeometry:()=>Cc,Cylindrical:()=>tp,DataTexture:()=>Zl,DataTexture2DArray:()=>Ea,DataTexture3D:()=>wa,DataTextureLoader:()=>sh,DataUtils:()=>Gp,DecrementStencilOp:()=>yn,DecrementWrapStencilOp:()=>_n,DefaultLoadingManager:()=>$u,DepthFormat:()=>Xe,DepthStencilFormat:()=>Ye,DepthTexture:()=>Mc,DirectionalLight:()=>qh,DirectionalLightHelper:()=>Ap,DiscreteInterpolant:()=>Vu,DodecahedronBufferGeometry:()=>Rc,DodecahedronGeometry:()=>Rc,DoubleSide:()=>x,DstAlphaFactor:()=>G,DstColorFactor:()=>H,DynamicBufferAttribute:()=>Pf,DynamicCopyUsage:()=>Fn,DynamicDrawUsage:()=>Rn,DynamicReadUsage:()=>On,EdgesGeometry:()=>kc,EdgesHelper:()=>Gf,EllipseCurve:()=>uh,EqualDepth:()=>Z,EqualStencilFunc:()=>Sn,EquirectangularReflectionMapping:()=>de,EquirectangularRefractionMapping:()=>pe,Euler:()=>hr,EventDispatcher:()=>Gn,ExtrudeBufferGeometry:()=>hu,ExtrudeGeometry:()=>hu,Face3:()=>tm,FaceColors:()=>yf,FileLoader:()=>nh,FlatShading:()=>E,Float16BufferAttribute:()=>lo,Float32Attribute:()=>Ff,Float32BufferAttribute:()=>co,Float64Attribute:()=>Uf,Float64BufferAttribute:()=>uo,FloatType:()=>Ne,Fog:()=>bl,FogExp2:()=>yl,Font:()=>ld,FontLoader:()=>ud,FrontSide:()=>b,Frustum:()=>ta,GLBufferAttribute:()=>Zd,GLSL1:()=>Bn,GLSL3:()=>Vn,GammaEncoding:()=>rn,Geometry:()=>$f,GreaterDepth:()=>Q,GreaterEqualDepth:()=>J,GreaterEqualStencilFunc:()=>Cn,GreaterStencilFunc:()=>Mn,GridHelper:()=>_p,Group:()=>hl,HalfFloatType:()=>ke,HemisphereLight:()=>Dh,HemisphereLightHelper:()=>bp,HemisphereLightProbe:()=>fd,IcosahedronBufferGeometry:()=>pu,IcosahedronGeometry:()=>pu,ImageBitmapLoader:()=>ad,ImageLoader:()=>oh,ImageUtils:()=>mi,ImmediateRenderObject:()=>sp,IncrementStencilOp:()=>vn,IncrementWrapStencilOp:()=>bn,InstancedBufferAttribute:()=>ed,InstancedBufferGeometry:()=>$h,InstancedInterleavedBuffer:()=>Kd,InstancedMesh:()=>rc,Int16Attribute:()=>If,Int16BufferAttribute:()=>ro,Int32Attribute:()=>Nf,Int32BufferAttribute:()=>ao,Int8Attribute:()=>Lf,Int8BufferAttribute:()=>to,IntType:()=>Ie,InterleavedBuffer:()=>xl,InterleavedBufferAttribute:()=>wl,Interpolant:()=>Fu,InterpolateDiscrete:()=>Wt,InterpolateLinear:()=>jt,InterpolateSmooth:()=>qt,InvertStencilOp:()=>xn,JSONLoader:()=>Xf,KeepStencilOp:()=>mn,KeyframeTrack:()=>Gu,LOD:()=>zl,LatheBufferGeometry:()=>fu,LatheGeometry:()=>fu,Layers:()=>dr,LensFlare:()=>Kf,LessDepth:()=>Y,LessEqualDepth:()=>K,LessEqualStencilFunc:()=>An,LessStencilFunc:()=>wn,Light:()=>Rh,LightProbe:()=>Zh,Line:()=>hc,Line3:()=>ap,LineBasicMaterial:()=>Im,LineCurve:()=>wh,LineCurve3:()=>Sh,LineDashedMaterial:()=>Nu,LineLoop:()=>mc,LinePieces:()=>gf,LineSegments:()=>fc,LineStrip:()=>mf,LinearEncoding:()=>tn,LinearFilter:()=>Se,LinearInterpolant:()=>Bu,LinearMipMapLinearFilter:()=>Ce,LinearMipMapNearestFilter:()=>Me,LinearMipmapLinearFilter:()=>Te,LinearMipmapNearestFilter:()=>Ae,LinearToneMapping:()=>re,Loader:()=>eh,LoaderUtils:()=>Qh,LoadingManager:()=>Qu,LogLuvEncoding:()=>an,LoopOnce:()=>Gt,LoopPingPong:()=>Ht,LoopRepeat:()=>zt,LuminanceAlphaFormat:()=>je,LuminanceFormat:()=>We,MOUSE:()=>c,Material:()=>cm,MaterialLoader:()=>Jh,Math:()=>i,MathUtils:()=>i,Matrix3:()=>pi,Matrix4:()=>tr,MaxEquation:()=>O,Mesh:()=>Vo,MeshBasicMaterial:()=>Am,MeshDepthMaterial:()=>rl,MeshDistanceMaterial:()=>ol,MeshFaceMaterial:()=>_f,MeshLambertMaterial:()=>Iu,MeshMatcapMaterial:()=>Ou,MeshNormalMaterial:()=>Du,MeshPhongMaterial:()=>vm,MeshPhysicalMaterial:()=>Pu,MeshStandardMaterial:()=>Cu,MeshToonMaterial:()=>Ru,MinEquation:()=>I,MirroredRepeatWrapping:()=>ye,MixOperation:()=>te,MultiMaterial:()=>xf,MultiplyBlending:()=>C,MultiplyOperation:()=>ee,NearestFilter:()=>be,NearestMipMapLinearFilter:()=>we,NearestMipMapNearestFilter:()=>xe,NearestMipmapLinearFilter:()=>Ee,NearestMipmapNearestFilter:()=>_e,NeverDepth:()=>q,NeverStencilFunc:()=>En,NoBlending:()=>S,NoColors:()=>vf,NoToneMapping:()=>ie,NormalAnimationBlendMode:()=>Zt,NormalBlending:()=>A,NotEqualDepth:()=>$,NotEqualStencilFunc:()=>Tn,NumberKeyframeTrack:()=>Wu,Object3D:()=>Mr,ObjectLoader:()=>nd,ObjectSpaceNormalMap:()=>pn,OctahedronBufferGeometry:()=>mu,OctahedronGeometry:()=>mu,OneFactor:()=>k,OneMinusDstAlphaFactor:()=>z,OneMinusDstColorFactor:()=>W,OneMinusSrcAlphaFactor:()=>V,OneMinusSrcColorFactor:()=>U,OrthographicCamera:()=>Wh,PCFShadowMap:()=>g,PCFSoftShadowMap:()=>v,PMREMGenerator:()=>af,ParametricBufferGeometry:()=>gu,ParametricGeometry:()=>gu,Particle:()=>wf,ParticleBasicMaterial:()=>Mf,ParticleSystem:()=>Sf,ParticleSystemMaterial:()=>Tf,Path:()=>Ph,PerspectiveCamera:()=>Yo,Plane:()=>Lr,PlaneBufferGeometry:()=>ra,PlaneGeometry:()=>ra,PlaneHelper:()=>Ip,PointCloud:()=>Ef,PointCloudMaterial:()=>Af,PointLight:()=>Hh,PointLightHelper:()=>mp,Points:()=>xc,PointsMaterial:()=>gc,PolarGridHelper:()=>xp,PolyhedronBufferGeometry:()=>Lc,PolyhedronGeometry:()=>Lc,PositionalAudio:()=>Rd,PropertyBinding:()=>Wd,PropertyMixer:()=>Id,QuadraticBezierCurve:()=>Ah,QuadraticBezierCurve3:()=>Mh,Quaternion:()=>wi,QuaternionKeyframeTrack:()=>qu,QuaternionLinearInterpolant:()=>ju,REVISION:()=>l,RGBADepthPacking:()=>hn,RGBAFormat:()=>He,RGBAIntegerFormat:()=>et,RGBA_ASTC_10x10_Format:()=>wt,RGBA_ASTC_10x5_Format:()=>_t,RGBA_ASTC_10x6_Format:()=>xt,RGBA_ASTC_10x8_Format:()=>Et,RGBA_ASTC_12x10_Format:()=>St,RGBA_ASTC_12x12_Format:()=>At,RGBA_ASTC_4x4_Format:()=>dt,RGBA_ASTC_5x4_Format:()=>pt,RGBA_ASTC_5x5_Format:()=>ft,RGBA_ASTC_6x5_Format:()=>mt,RGBA_ASTC_6x6_Format:()=>gt,RGBA_ASTC_8x5_Format:()=>vt,RGBA_ASTC_8x6_Format:()=>yt,RGBA_ASTC_8x8_Format:()=>bt,RGBA_BPTC_Format:()=>Mt,RGBA_ETC2_EAC_Format:()=>ht,RGBA_PVRTC_2BPPV1_Format:()=>lt,RGBA_PVRTC_4BPPV1_Format:()=>st,RGBA_S3TC_DXT1_Format:()=>nt,RGBA_S3TC_DXT3_Format:()=>it,RGBA_S3TC_DXT5_Format:()=>rt,RGBDEncoding:()=>cn,RGBEEncoding:()=>on,RGBEFormat:()=>qe,RGBFormat:()=>ze,RGBIntegerFormat:()=>$e,RGBM16Encoding:()=>ln,RGBM7Encoding:()=>sn,RGB_ETC1_Format:()=>ct,RGB_ETC2_Format:()=>ut,RGB_PVRTC_2BPPV1_Format:()=>at,RGB_PVRTC_4BPPV1_Format:()=>ot,RGB_S3TC_DXT1_Format:()=>tt,RGFormat:()=>Je,RGIntegerFormat:()=>Qe,RawShaderMaterial:()=>Ym,Ray:()=>er,Raycaster:()=>Jd,RectAreaLight:()=>Yh,RedFormat:()=>Ke,RedIntegerFormat:()=>Ze,ReinhardToneMapping:()=>oe,RepeatWrapping:()=>ge,ReplaceStencilOp:()=>gn,ReverseSubtractEquation:()=>D,RingBufferGeometry:()=>vu,RingGeometry:()=>vu,SRGB8_ALPHA8_ASTC_10x10_Format:()=>Ut,SRGB8_ALPHA8_ASTC_10x5_Format:()=>Nt,SRGB8_ALPHA8_ASTC_10x6_Format:()=>kt,SRGB8_ALPHA8_ASTC_10x8_Format:()=>Ft,SRGB8_ALPHA8_ASTC_12x10_Format:()=>Bt,SRGB8_ALPHA8_ASTC_12x12_Format:()=>Vt,SRGB8_ALPHA8_ASTC_4x4_Format:()=>Tt,SRGB8_ALPHA8_ASTC_5x4_Format:()=>Ct,SRGB8_ALPHA8_ASTC_5x5_Format:()=>Pt,SRGB8_ALPHA8_ASTC_6x5_Format:()=>Lt,SRGB8_ALPHA8_ASTC_6x6_Format:()=>Rt,SRGB8_ALPHA8_ASTC_8x5_Format:()=>Dt,SRGB8_ALPHA8_ASTC_8x6_Format:()=>It,SRGB8_ALPHA8_ASTC_8x8_Format:()=>Ot,Scene:()=>_l,SceneUtils:()=>Yf,ShaderChunk:()=>Jm,ShaderLib:()=>Qm,ShaderMaterial:()=>Vm,ShadowMaterial:()=>Mu,Shape:()=>Lh,ShapeBufferGeometry:()=>yu,ShapeGeometry:()=>yu,ShapePath:()=>sd,ShapeUtils:()=>lu,ShortType:()=>Re,Skeleton:()=>$l,SkeletonHelper:()=>pp,SkinnedMesh:()=>Yl,SmoothShading:()=>w,Sphere:()=>qi,SphereBufferGeometry:()=>bu,SphereGeometry:()=>bu,Spherical:()=>ep,SphericalHarmonics3:()=>Kh,SphericalReflectionMapping:()=>$m,SplineCurve:()=>Th,SpotLight:()=>Uh,SpotLightHelper:()=>cp,Sprite:()=>Ul,SpriteMaterial:()=>Sl,SrcAlphaFactor:()=>B,SrcAlphaSaturateFactor:()=>j,SrcColorFactor:()=>F,StaticCopyUsage:()=>kn,StaticDrawUsage:()=>Ln,StaticReadUsage:()=>In,StereoCamera:()=>yd,StreamCopyUsage:()=>Un,StreamDrawUsage:()=>Dn,StreamReadUsage:()=>Nn,StringKeyframeTrack:()=>Xu,SubtractEquation:()=>R,SubtractiveBlending:()=>T,TOUCH:()=>u,TangentSpaceNormalMap:()=>dn,TetrahedronBufferGeometry:()=>_u,TetrahedronGeometry:()=>_u,TextBufferGeometry:()=>xu,TextGeometry:()=>xu,Texture:()=>vi,TextureLoader:()=>lh,TorusBufferGeometry:()=>Eu,TorusGeometry:()=>Eu,TorusKnotBufferGeometry:()=>wu,TorusKnotGeometry:()=>wu,Triangle:()=>Gr,TriangleFanDrawMode:()=>en,TriangleStripDrawMode:()=>$t,TrianglesDrawMode:()=>Qt,TubeBufferGeometry:()=>Su,TubeGeometry:()=>Su,UVMapping:()=>ce,Uint16Attribute:()=>Of,Uint16BufferAttribute:()=>oo,Uint32Attribute:()=>kf,Uint32BufferAttribute:()=>so,Uint8Attribute:()=>Rf,Uint8BufferAttribute:()=>no,Uint8ClampedAttribute:()=>Df,Uint8ClampedBufferAttribute:()=>io,Uniform:()=>Yd,UniformsLib:()=>Km,UniformsUtils:()=>jo,UnsignedByteType:()=>Pe,UnsignedInt248Type:()=>Ve,UnsignedIntType:()=>Oe,UnsignedShort4444Type:()=>Fe,UnsignedShort5551Type:()=>Ue,UnsignedShort565Type:()=>Be,UnsignedShortType:()=>De,VSMShadowMap:()=>y,Vector2:()=>di,Vector3:()=>Si,Vector4:()=>bi,VectorKeyframeTrack:()=>Yu,Vertex:()=>Cf,VertexColors:()=>bf,VideoTexture:()=>wc,WebGL1Renderer:()=>vl,WebGLAnimation:()=>na,WebGLAttributes:()=>ia,WebGLBindingStates:()=>ca,WebGLCapabilities:()=>ha,WebGLCubeRenderTarget:()=>Qo,WebGLExtensions:()=>fa,WebGLMultipleRenderTargets:()=>xi,WebGLMultisampleRenderTarget:()=>Ei,WebGLProperties:()=>Xs,WebGLRenderTarget:()=>_i,WebGLRenderTargetCube:()=>jf,WebGLRenderer:()=>gl,WebGLState:()=>sl,WebGLUtils:()=>cl,WebXRManager:()=>fl,WireframeGeometry:()=>Au,WireframeHelper:()=>zf,WrapAroundEnding:()=>Kt,XHRLoader:()=>Hf,ZeroCurvatureEnding:()=>Xt,ZeroFactor:()=>N,ZeroSlopeEnding:()=>Yt,ZeroStencilOp:()=>fn,sRGBEncoding:()=>nn});var i={};n.r(i),n.d(i,{DEG2RAD:()=>Wn,RAD2DEG:()=>jn,ceilPowerOfTwo:()=>ci,clamp:()=>Xn,damp:()=>Qn,degToRad:()=>ai,euclideanModulo:()=>Yn,floorPowerOfTwo:()=>ui,generateUUID:()=>qn,inverseLerp:()=>Zn,isPowerOfTwo:()=>li,lerp:()=>Jn,mapLinear:()=>Kn,pingpong:()=>$n,radToDeg:()=>si,randFloat:()=>ii,randFloatSpread:()=>ri,randInt:()=>ni,seededRandom:()=>oi,setQuaternionFromProperEuler:()=>hi,smootherstep:()=>ti,smoothstep:()=>ei});var r={};n.r(r),n.d(r,{BoxBufferGeometry:()=>zo,BoxGeometry:()=>zo,CircleBufferGeometry:()=>Tc,CircleGeometry:()=>Tc,ConeBufferGeometry:()=>Pc,ConeGeometry:()=>Pc,CylinderBufferGeometry:()=>Cc,CylinderGeometry:()=>Cc,DodecahedronBufferGeometry:()=>Rc,DodecahedronGeometry:()=>Rc,EdgesGeometry:()=>kc,ExtrudeBufferGeometry:()=>hu,ExtrudeGeometry:()=>hu,IcosahedronBufferGeometry:()=>pu,IcosahedronGeometry:()=>pu,LatheBufferGeometry:()=>fu,LatheGeometry:()=>fu,OctahedronBufferGeometry:()=>mu,OctahedronGeometry:()=>mu,ParametricBufferGeometry:()=>gu,ParametricGeometry:()=>gu,PlaneBufferGeometry:()=>ra,PlaneGeometry:()=>ra,PolyhedronBufferGeometry:()=>Lc,PolyhedronGeometry:()=>Lc,RingBufferGeometry:()=>vu,RingGeometry:()=>vu,ShapeBufferGeometry:()=>yu,ShapeGeometry:()=>yu,SphereBufferGeometry:()=>bu,SphereGeometry:()=>bu,TetrahedronBufferGeometry:()=>_u,TetrahedronGeometry:()=>_u,TextBufferGeometry:()=>xu,TextGeometry:()=>xu,TorusBufferGeometry:()=>Eu,TorusGeometry:()=>Eu,TorusKnotBufferGeometry:()=>wu,TorusKnotGeometry:()=>wu,TubeBufferGeometry:()=>Su,TubeGeometry:()=>Su,WireframeGeometry:()=>Au});var o={};n.r(o),n.d(o,{LineBasicMaterial:()=>oc,LineDashedMaterial:()=>Nu,Material:()=>Hr,MeshBasicMaterial:()=>Jr,MeshDepthMaterial:()=>rl,MeshDistanceMaterial:()=>ol,MeshLambertMaterial:()=>Iu,MeshMatcapMaterial:()=>Ou,MeshNormalMaterial:()=>Du,MeshPhongMaterial:()=>Lu,MeshPhysicalMaterial:()=>Pu,MeshStandardMaterial:()=>Cu,MeshToonMaterial:()=>Ru,PointsMaterial:()=>gc,RawShaderMaterial:()=>Tu,ShaderMaterial:()=>qo,ShadowMaterial:()=>Mu,SpriteMaterial:()=>Sl});var a={};n.r(a),n.d(a,{ArcCurve:()=>hh,CatmullRomCurve3:()=>vh,CubicBezierCurve:()=>xh,CubicBezierCurve3:()=>Eh,EllipseCurve:()=>uh,LineCurve:()=>wh,LineCurve3:()=>Sh,QuadraticBezierCurve:()=>Ah,QuadraticBezierCurve3:()=>Mh,SplineCurve:()=>Th});var s={};n.r(s),n.d(s,{LY2:()=>se,bGH:()=>L,NDo:()=>ne,gSk:()=>Jt,WMw:()=>M,OTo:()=>Ge,Se2:()=>X,cum:()=>Pn,Mig:()=>Xh,i_9:()=>md,m7l:()=>Ku,sYA:()=>ih,Xcj:()=>Xd,mzJ:()=>jd,ZZA:()=>ku,T__:()=>hh,HkE:()=>ul,tGC:()=>Fp,BbS:()=>Md,kqm:()=>Dd,Hmr:()=>dd,SJI:()=>Ad,mTL:()=>pd,y8_:()=>Up,Iis:()=>Bf,_Li:()=>_,z81:()=>un,_MY:()=>m,tvf:()=>Wf,N$j:()=>Kl,_YM:()=>zu,W3U:()=>Vf,TUj:()=>ip,ZzF:()=>Ti,GQ:()=>Dp,nvb:()=>zo,DvJ:()=>zo,fQA:()=>Rp,TlE:()=>eo,u9r:()=>Eo,s4_:()=>td,T95:()=>Le,CtF:()=>Ju,V1s:()=>Xo,Rki:()=>Cp,uKt:()=>qf,ROQ:()=>Ac,YT8:()=>vh,YGz:()=>ae,trn:()=>Tc,zf8:()=>Tc,uWy:()=>ve,SUY:()=>bd,Ilk:()=>Zr,R2R:()=>Hu,EB7:()=>Sc,DqL:()=>rh,_3:()=>Pc,b_z:()=>Pc,_am:()=>Zo,fY$:()=>ue,vxC:()=>he,BtG:()=>Jo,cBK:()=>ah,g8_:()=>fe,SVc:()=>me,AXT:()=>xh,yj7:()=>Eh,dYG:()=>Uu,tm_:()=>d,S2y:()=>p,B02:()=>f,PeU:()=>h,Hyl:()=>ch,Wqd:()=>Ch,Xaj:()=>P,dZ3:()=>le,m_w:()=>Cc,fHI:()=>Cc,LBq:()=>tp,IEO:()=>Zl,CN8:()=>Ea,zob:()=>wa,yxD:()=>sh,A5E:()=>Gp,jfJ:()=>yn,T_J:()=>_n,tEQ:()=>$u,qkB:()=>Xe,brP:()=>Ye,$YQ:()=>Mc,Ox3:()=>qh,cBI:()=>Ap,cU9:()=>Vu,DT1:()=>Rc,Kgo:()=>Rc,ehD:()=>x,fSK:()=>G,Vdb:()=>H,a4C:()=>Pf,l8J:()=>Fn,dj0:()=>Rn,QM0:()=>On,TOt:()=>kc,qBC:()=>Gf,Ny0:()=>uh,eD:()=>Z,jwo:()=>Sn,dSO:()=>de,Bf4:()=>pe,USm:()=>hr,pBf:()=>Gn,$Vf:()=>hu,O7d:()=>hu,eyy:()=>yf,hH6:()=>nh,esl:()=>E,e62:()=>lo,hsR:()=>Ff,a$l:()=>co,uH:()=>Uf,OM3:()=>uo,VzW:()=>Ne,ybr:()=>bl,yo9:()=>yl,Zxw:()=>ld,JfN:()=>ud,Wl3:()=>b,iWj:()=>ta,ylh:()=>Zd,v9Y:()=>Bn,LSk:()=>Vn,pMV:()=>rn,w$m:()=>Q,ksN:()=>J,j4z:()=>Cn,OAl:()=>Mn,VLJ:()=>_p,ZAu:()=>hl,cLu:()=>ke,vmT:()=>Dh,Qpg:()=>bp,So8:()=>fd,Wjw:()=>pu,cJO:()=>pu,QRU:()=>ad,S3k:()=>oh,PpQ:()=>mi,AHu:()=>sp,ZRs:()=>vn,oqc:()=>bn,lb7:()=>ed,L5s:()=>$h,$TI:()=>Kd,SPe:()=>rc,WVE:()=>If,aVm:()=>ro,pMG:()=>Nf,j87:()=>ao,dp:()=>Lf,RNb:()=>to,Kz5:()=>Ie,vpT:()=>xl,kB5:()=>wl,_C8:()=>Fu,Syv:()=>Wt,NMF:()=>jt,pIN:()=>qt,eMJ:()=>xn,Hto:()=>Xf,x5V:()=>mn,tUh:()=>Gu,z8B:()=>zl,GZb:()=>fu,p7y:()=>fu,S9g:()=>dr,EPC:()=>Kf,Zr5:()=>Y,vCF:()=>K,yt0:()=>An,uXU:()=>wn,_kC:()=>Rh,lk7:()=>Zh,x12:()=>hc,Zzh:()=>ap,g_z:()=>wh,U7:()=>Sh,FT0:()=>Nu,blk:()=>mc,huj:()=>gf,ejS:()=>fc,Ucf:()=>mf,rnI:()=>tn,wem:()=>Se,lfu:()=>Bu,FDw:()=>Ce,lRj:()=>Me,D1R:()=>Te,qyh:()=>Ae,EoG:()=>re,aNw:()=>eh,Zp0:()=>Qh,lLk:()=>Qu,M6c:()=>an,jAl:()=>Gt,uEv:()=>Ht,YKA:()=>zt,cRx:()=>je,Y8D:()=>We,RsA:()=>c,u7G:()=>Jh,ZX$:()=>i,M8C:()=>i,Vkp:()=>pi,yGw:()=>tr,Sm8:()=>O,Kj0:()=>Vo,lRF:()=>rl,Lun:()=>ol,c54:()=>_f,YBo:()=>Iu,kaV:()=>Ou,RSm:()=>Du,EJi:()=>Pu,Wid:()=>Cu,IKL:()=>Ru,r_:()=>I,OoA:()=>ye,qhX:()=>te,G2s:()=>xf,M5h:()=>C,Ns1:()=>ee,TyD:()=>be,vZf:()=>we,HTd:()=>xe,aH4:()=>Ee,YLQ:()=>_e,BVF:()=>q,MyG:()=>En,jFi:()=>S,XeA:()=>vf,uL9:()=>ie,IFH:()=>Zt,bdR:()=>A,M6v:()=>$,RvT:()=>Tn,dUE:()=>Wu,Tme:()=>Mr,Gql:()=>nd,PA7:()=>pn,REq:()=>mu,pQR:()=>mu,ghN:()=>k,Hy8:()=>z,Wpd:()=>W,LgZ:()=>V,iWC:()=>U,iKG:()=>Wh,_iA:()=>g,ntZ:()=>v,anP:()=>af,vmS:()=>gu,jjw:()=>gu,hpZ:()=>wf,ldL:()=>Mf,pcH:()=>Sf,Vjf:()=>Tf,y$t:()=>Ph,cPb:()=>Yo,JOQ:()=>Lr,BKK:()=>ra,_12:()=>ra,tJx:()=>Ip,ayZ:()=>Ef,LRR:()=>Af,cek:()=>Hh,xG9:()=>mp,woe:()=>xc,UY4:()=>gc,aq0:()=>xp,ujx:()=>Lc,Uol:()=>Lc,VYz:()=>Rd,iUV:()=>Wd,tf:()=>Id,ZQ6:()=>Ah,mXe:()=>Mh,_fP:()=>wi,iLg:()=>qu,zbs:()=>ju,UZH:()=>l,mSO:()=>hn,wk1:()=>He,E2K:()=>et,FUD:()=>wt,pKu:()=>_t,GG6:()=>xt,Gih:()=>Et,iiP:()=>St,SvJ:()=>At,ptH:()=>dt,jZA:()=>pt,y2t:()=>ft,gi4:()=>mt,Djp:()=>gt,BG$:()=>vt,NYV:()=>yt,xJs:()=>bt,bsb:()=>Mt,ekQ:()=>ht,CaW:()=>lt,eaV:()=>st,BFQ:()=>nt,v3W:()=>it,ILR:()=>rt,gMp:()=>cn,KC9:()=>on,aoB:()=>qe,UCm:()=>ze,F5G:()=>$e,Inb:()=>ln,LgE:()=>sn,fto:()=>ct,l0P:()=>ut,vCx:()=>at,_AM:()=>ot,wuA:()=>tt,av9:()=>Je,CtA:()=>Qe,zHn:()=>er,iMs:()=>Jd,T_f:()=>Yh,hEm:()=>Ke,D9w:()=>Ze,CdI:()=>oe,rpg:()=>ge,ce8:()=>gn,rOj:()=>D,V4E:()=>vu,o8S:()=>vu,Yjz:()=>Ut,Wso:()=>Nt,p1$:()=>kt,I0h:()=>Ft,ePn:()=>Bt,HBG:()=>Vt,APR:()=>Tt,Abz:()=>Ct,v6B:()=>Pt,pnl:()=>Lt,OS$:()=>Rt,_wO:()=>Dt,bcs:()=>It,Y5S:()=>Ot,xsS:()=>_l,pGF:()=>Yf,Tn7:()=>Mu,bnF:()=>Lh,HW6:()=>yu,oa8:()=>yu,T_1:()=>sd,iDF:()=>lu,iAb:()=>Re,OdW:()=>$l,_YX:()=>pp,TUv:()=>Yl,wcA:()=>w,aLr:()=>qi,Aip:()=>bu,xo$:()=>bu,$V:()=>ep,lDi:()=>Kh,gti:()=>Th,PMe:()=>Uh,FvO:()=>cp,jyi:()=>Ul,xeV:()=>Sl,k74:()=>B,RlZ:()=>j,KhW:()=>F,HgB:()=>kn,W2J:()=>Ln,JWc:()=>In,u37:()=>yd,Z6B:()=>Un,QZ1:()=>Dn,Ir4:()=>Nn,NwF:()=>Xu,Wbm:()=>R,N4l:()=>T,QmN:()=>u,IOt:()=>dn,L5g:()=>_u,H$k:()=>_u,R9B:()=>xu,MP$:()=>xu,xEZ:()=>vi,dpR:()=>lh,Cne:()=>Eu,XvJ:()=>Eu,XZw:()=>wu,FE5:()=>wu,CJI:()=>Gr,z$h:()=>en,UlW:()=>$t,WwZ:()=>Qt,Lcc:()=>Su,WXh:()=>Su,xfE:()=>ce,in$:()=>Of,qlB:()=>oo,amr:()=>kf,lCJ:()=>so,qqW:()=>Rf,WTc:()=>no,RLs:()=>Df,rAo:()=>io,xWb:()=>Yd,rDY:()=>jo,ywz:()=>Pe,wJv:()=>Ve,JQ4:()=>Oe,k0A:()=>Fe,irR:()=>Ue,XNv:()=>Be,LsT:()=>De,dwk:()=>y,FM8:()=>di,Pa4:()=>Si,Ltg:()=>bi,yC1:()=>Yu,Xzd:()=>Cf,jSK:()=>bf,fO1:()=>wc,b5g:()=>vl,oAp:()=>Qo,kFz:()=>xi,p7A:()=>Ei,dd2:()=>_i,OVw:()=>jf,CP7:()=>gl,fQK:()=>cl,Uk6:()=>Au,rD0:()=>zf,_sL:()=>Kt,iUn:()=>Hf,Pnf:()=>Xt,c8b:()=>N,_lf:()=>Yt,ad5:()=>fn,knz:()=>nn});const l="129",c={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},u={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},h=0,d=1,p=2,f=3,m=0,g=1,v=2,y=3,b=0,_=1,x=2,E=1,w=2,S=0,A=1,M=2,T=3,C=4,P=5,L=100,R=101,D=102,I=103,O=104,N=200,k=201,F=202,U=203,B=204,V=205,G=206,z=207,H=208,W=209,j=210,q=0,X=1,Y=2,K=3,Z=4,J=5,Q=6,$=7,ee=0,te=1,ne=2,ie=0,re=1,oe=2,ae=3,se=4,le=5,ce=300,ue=301,he=302,de=303,pe=304,fe=306,me=307,ge=1e3,ve=1001,ye=1002,be=1003,_e=1004,xe=1004,Ee=1005,we=1005,Se=1006,Ae=1007,Me=1007,Te=1008,Ce=1008,Pe=1009,Le=1010,Re=1011,De=1012,Ie=1013,Oe=1014,Ne=1015,ke=1016,Fe=1017,Ue=1018,Be=1019,Ve=1020,Ge=1021,ze=1022,He=1023,We=1024,je=1025,qe=He,Xe=1026,Ye=1027,Ke=1028,Ze=1029,Je=1030,Qe=1031,$e=1032,et=1033,tt=33776,nt=33777,it=33778,rt=33779,ot=35840,at=35841,st=35842,lt=35843,ct=36196,ut=37492,ht=37496,dt=37808,pt=37809,ft=37810,mt=37811,gt=37812,vt=37813,yt=37814,bt=37815,_t=37816,xt=37817,Et=37818,wt=37819,St=37820,At=37821,Mt=36492,Tt=37840,Ct=37841,Pt=37842,Lt=37843,Rt=37844,Dt=37845,It=37846,Ot=37847,Nt=37848,kt=37849,Ft=37850,Ut=37851,Bt=37852,Vt=37853,Gt=2200,zt=2201,Ht=2202,Wt=2300,jt=2301,qt=2302,Xt=2400,Yt=2401,Kt=2402,Zt=2500,Jt=2501,Qt=0,$t=1,en=2,tn=3e3,nn=3001,rn=3007,on=3002,an=3003,sn=3004,ln=3005,cn=3006,un=3200,hn=3201,dn=0,pn=1,fn=0,mn=7680,gn=7681,vn=7682,yn=7683,bn=34055,_n=34056,xn=5386,En=512,wn=513,Sn=514,An=515,Mn=516,Tn=517,Cn=518,Pn=519,Ln=35044,Rn=35048,Dn=35040,In=35045,On=35049,Nn=35041,kn=35046,Fn=35050,Un=35042,Bn="100",Vn="300 es";class Gn{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,i=n.length;t<i;t++)n[t].call(this,e);e.target=null}}}const zn=[];for(let e=0;e<256;e++)zn[e]=(e<16?"0":"")+e.toString(16);let Hn=1234567;const Wn=Math.PI/180,jn=180/Math.PI;function qn(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(zn[255&e]+zn[e>>8&255]+zn[e>>16&255]+zn[e>>24&255]+"-"+zn[255&t]+zn[t>>8&255]+"-"+zn[t>>16&15|64]+zn[t>>24&255]+"-"+zn[63&n|128]+zn[n>>8&255]+"-"+zn[n>>16&255]+zn[n>>24&255]+zn[255&i]+zn[i>>8&255]+zn[i>>16&255]+zn[i>>24&255]).toUpperCase()}function Xn(e,t,n){return Math.max(t,Math.min(n,e))}function Yn(e,t){return(e%t+t)%t}function Kn(e,t,n,i,r){return i+(e-t)*(r-i)/(n-t)}function Zn(e,t,n){return e!==t?(n-e)/(t-e):0}function Jn(e,t,n){return(1-n)*e+n*t}function Qn(e,t,n,i){return Jn(e,t,1-Math.exp(-n*i))}function $n(e,t=1){return t-Math.abs(Yn(e,2*t)-t)}function ei(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)}function ti(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)}function ni(e,t){return e+Math.floor(Math.random()*(t-e+1))}function ii(e,t){return e+Math.random()*(t-e)}function ri(e){return e*(.5-Math.random())}function oi(e){return void 0!==e&&(Hn=e%2147483647),Hn=16807*Hn%2147483647,(Hn-1)/2147483646}function ai(e){return e*Wn}function si(e){return e*jn}function li(e){return 0==(e&e-1)&&0!==e}function ci(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function ui(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function hi(e,t,n,i,r){const o=Math.cos,a=Math.sin,s=o(n/2),l=a(n/2),c=o((t+i)/2),u=a((t+i)/2),h=o((t-i)/2),d=a((t-i)/2),p=o((i-t)/2),f=a((i-t)/2);switch(r){case"XYX":e.set(s*u,l*h,l*d,s*c);break;case"YZY":e.set(l*d,s*u,l*h,s*c);break;case"ZXZ":e.set(l*h,l*d,s*u,s*c);break;case"XZX":e.set(s*u,l*f,l*p,s*c);break;case"YXY":e.set(l*p,s*u,l*f,s*c);break;case"ZYZ":e.set(l*f,l*p,s*u,s*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}class di{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),r=this.x-e.x,o=this.y-e.y;return this.x=r*n-o*i+e.x,this.y=r*i+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}di.prototype.isVector2=!0;class pi{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,i,r,o,a,s,l){const c=this.elements;return c[0]=e,c[1]=i,c[2]=a,c[3]=t,c[4]=r,c[5]=s,c[6]=n,c[7]=o,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,o=n[0],a=n[3],s=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],p=n[8],f=i[0],m=i[3],g=i[6],v=i[1],y=i[4],b=i[7],_=i[2],x=i[5],E=i[8];return r[0]=o*f+a*v+s*_,r[3]=o*m+a*y+s*x,r[6]=o*g+a*b+s*E,r[1]=l*f+c*v+u*_,r[4]=l*m+c*y+u*x,r[7]=l*g+c*b+u*E,r[2]=h*f+d*v+p*_,r[5]=h*m+d*y+p*x,r[8]=h*g+d*b+p*E,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],s=e[6],l=e[7],c=e[8];return t*o*c-t*a*l-n*r*c+n*a*s+i*r*l-i*o*s}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],s=e[6],l=e[7],c=e[8],u=c*o-a*l,h=a*s-c*r,d=l*r-o*s,p=t*u+n*h+i*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return e[0]=u*f,e[1]=(i*l-c*n)*f,e[2]=(a*n-i*o)*f,e[3]=h*f,e[4]=(c*t-i*s)*f,e[5]=(i*r-a*t)*f,e[6]=d*f,e[7]=(n*s-l*t)*f,e[8]=(o*t-n*r)*f,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,r,o,a){const s=Math.cos(r),l=Math.sin(r);return this.set(n*s,n*l,-n*(s*o+l*a)+o+e,-i*l,i*s,-i*(-l*o+s*a)+a+t,0,0,1),this}scale(e,t){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),i=this.elements,r=i[0],o=i[3],a=i[6],s=i[1],l=i[4],c=i[7];return i[0]=t*r+n*s,i[3]=t*o+n*l,i[6]=t*a+n*c,i[1]=-n*r+t*s,i[4]=-n*o+t*l,i[7]=-n*a+t*c,this}translate(e,t){const n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}equals(e){const t=this.elements,n=e.elements;for(let e=0;e<9;e++)if(t[e]!==n[e])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}let fi;pi.prototype.isMatrix3=!0;class mi{static getDataURL(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===fi&&(fi=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),fi.width=e.width,fi.height=e.height;const n=fi.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=fi}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}}let gi=0;class vi extends Gn{constructor(e=vi.DEFAULT_IMAGE,t=vi.DEFAULT_MAPPING,n=ve,i=ve,r=Se,o=Te,a=He,s=Pe,l=1,c=tn){super(),Object.defineProperty(this,"id",{value:gi++}),this.uuid=qn(),this.name="",this.image=e,this.mipmaps=[],this.mapping=t,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=o,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=s,this.offset=new di(0,0),this.repeat=new di(1,1),this.center=new di(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new pi,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.version=0,this.onUpdate=null}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const i=this.image;if(void 0===i.uuid&&(i.uuid=qn()),!t&&void 0===e.images[i.uuid]){let t;if(Array.isArray(i)){t=[];for(let e=0,n=i.length;e<n;e++)i[e].isDataTexture?t.push(yi(i[e].image)):t.push(yi(i[e]))}else t=yi(i);e.images[i.uuid]={uuid:i.uuid,url:t}}n.image=i.uuid}return t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==ce)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case ge:e.x=e.x-Math.floor(e.x);break;case ve:e.x=e.x<0?0:1;break;case ye:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case ge:e.y=e.y-Math.floor(e.y);break;case ve:e.y=e.y<0?0:1;break;case ye:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&this.version++}}function yi(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?mi.getDataURL(e):e.data?{data:Array.prototype.slice.call(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}vi.DEFAULT_IMAGE=void 0,vi.DEFAULT_MAPPING=ce,vi.prototype.isTexture=!0;class bi{constructor(e=0,t=0,n=0,i=1){this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*i+o[12]*r,this.y=o[1]*t+o[5]*n+o[9]*i+o[13]*r,this.z=o[2]*t+o[6]*n+o[10]*i+o[14]*r,this.w=o[3]*t+o[7]*n+o[11]*i+o[15]*r,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,r;const o=.01,a=.1,s=e.elements,l=s[0],c=s[4],u=s[8],h=s[1],d=s[5],p=s[9],f=s[2],m=s[6],g=s[10];if(Math.abs(c-h)<o&&Math.abs(u-f)<o&&Math.abs(p-m)<o){if(Math.abs(c+h)<a&&Math.abs(u+f)<a&&Math.abs(p+m)<a&&Math.abs(l+d+g-3)<a)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,s=(d+1)/2,v=(g+1)/2,y=(c+h)/4,b=(u+f)/4,_=(p+m)/4;return e>s&&e>v?e<o?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(e),i=y/n,r=b/n):s>v?s<o?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(s),n=y/i,r=_/i):v<o?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(v),n=b/r,i=_/r),this.set(n,i,r,t),this}let v=Math.sqrt((m-p)*(m-p)+(u-f)*(u-f)+(h-c)*(h-c));return Math.abs(v)<.001&&(v=1),this.x=(m-p)/v,this.y=(u-f)/v,this.z=(h-c)/v,this.w=Math.acos((l+d+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}bi.prototype.isVector4=!0;class _i extends Gn{constructor(e,t,n){super(),this.width=e,this.height=t,this.depth=1,this.scissor=new bi(0,0,e,t),this.scissorTest=!1,this.viewport=new bi(0,0,e,t),n=n||{},this.texture=new vi(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:Se,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,t,n=1){this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image={...this.texture.image},this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}_i.prototype.isWebGLRenderTarget=!0;class xi extends _i{constructor(e,t,n){super(e,t);const i=this.texture;this.texture=[];for(let e=0;e<n;e++)this.texture[e]=i.clone()}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,r=this.texture.length;i<r;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone();return this}}xi.prototype.isWebGLMultipleRenderTargets=!0;class Ei extends _i{constructor(e,t,n){super(e,t,n),this.samples=4}copy(e){return super.copy.call(this,e),this.samples=e.samples,this}}Ei.prototype.isWebGLMultisampleRenderTarget=!0;class wi{constructor(e=0,t=0,n=0,i=1){this._x=e,this._y=t,this._z=n,this._w=i}static slerp(e,t,n,i){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,i)}static slerpFlat(e,t,n,i,r,o,a){let s=n[i+0],l=n[i+1],c=n[i+2],u=n[i+3];const h=r[o+0],d=r[o+1],p=r[o+2],f=r[o+3];if(0===a)return e[t+0]=s,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(1===a)return e[t+0]=h,e[t+1]=d,e[t+2]=p,void(e[t+3]=f);if(u!==f||s!==h||l!==d||c!==p){let e=1-a;const t=s*h+l*d+c*p+u*f,n=t>=0?1:-1,i=1-t*t;if(i>Number.EPSILON){const r=Math.sqrt(i),o=Math.atan2(r,t*n);e=Math.sin(e*o)/r,a=Math.sin(a*o)/r}const r=a*n;if(s=s*e+h*r,l=l*e+d*r,c=c*e+p*r,u=u*e+f*r,e===1-a){const e=1/Math.sqrt(s*s+l*l+c*c+u*u);s*=e,l*=e,c*=e,u*=e}}e[t]=s,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,n,i,r,o){const a=n[i],s=n[i+1],l=n[i+2],c=n[i+3],u=r[o],h=r[o+1],d=r[o+2],p=r[o+3];return e[t]=a*p+c*u+s*d-l*h,e[t+1]=s*p+c*h+l*u-a*d,e[t+2]=l*p+c*d+a*h-s*u,e[t+3]=c*p-a*u-s*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=e._x,i=e._y,r=e._z,o=e._order,a=Math.cos,s=Math.sin,l=a(n/2),c=a(i/2),u=a(r/2),h=s(n/2),d=s(i/2),p=s(r/2);switch(o){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],r=t[8],o=t[1],a=t[5],s=t[9],l=t[2],c=t[6],u=t[10],h=n+a+u;if(h>0){const e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(c-s)*e,this._y=(r-l)*e,this._z=(o-i)*e}else if(n>a&&n>u){const e=2*Math.sqrt(1+n-a-u);this._w=(c-s)/e,this._x=.25*e,this._y=(i+o)/e,this._z=(r+l)/e}else if(a>u){const e=2*Math.sqrt(1+a-n-u);this._w=(r-l)/e,this._x=(i+o)/e,this._y=.25*e,this._z=(s+c)/e}else{const e=2*Math.sqrt(1+u-n-a);this._w=(o-i)/e,this._x=(r+l)/e,this._y=(s+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Xn(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,r=e._z,o=e._w,a=t._x,s=t._y,l=t._z,c=t._w;return this._x=n*c+o*a+i*l-r*s,this._y=i*c+o*s+r*a-n*l,this._z=r*c+o*l+n*s-i*a,this._w=o*c-n*a-i*s-r*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,i=this._y,r=this._z,o=this._w;let a=o*e._w+n*e._x+i*e._y+r*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=i,this._z=r,this;const s=1-a*a;if(s<=Number.EPSILON){const e=1-t;return this._w=e*o+t*this._w,this._x=e*n+t*this._x,this._y=e*i+t*this._y,this._z=e*r+t*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(s),c=Math.atan2(l,a),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=o*u+this._w*h,this._x=n*u+this._x*h,this._y=i*u+this._y*h,this._z=r*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,n){this.copy(e).slerp(t,n)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}wi.prototype.isQuaternion=!0;class Si{constructor(e=0,t=0,n=0){this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Mi.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Mi.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=e.elements,o=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*o,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*o,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,r=e.x,o=e.y,a=e.z,s=e.w,l=s*t+o*i-a*n,c=s*n+a*t-r*i,u=s*i+r*n-o*t,h=-r*t-o*n-a*i;return this.x=l*s+h*-r+c*-a-u*-o,this.y=c*s+h*-o+u*-r-l*-a,this.z=u*s+h*-a+l*-o-c*-r,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,r=e.z,o=t.x,a=t.y,s=t.z;return this.x=i*s-r*a,this.y=r*o-n*s,this.z=n*a-i*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Ai.copy(this).projectOnVector(e),this.sub(Ai)}reflect(e){return this.sub(Ai.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Xn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}Si.prototype.isVector3=!0;const Ai=new Si,Mi=new wi;class Ti{constructor(e=new Si(1/0,1/0,1/0),t=new Si(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,a=-1/0;for(let s=0,l=e.length;s<l;s+=3){const l=e[s],c=e[s+1],u=e[s+2];l<t&&(t=l),c<n&&(n=c),u<i&&(i=u),l>r&&(r=l),c>o&&(o=c),u>a&&(a=u)}return this.min.set(t,n,i),this.max.set(r,o,a),this}setFromBufferAttribute(e){let t=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,a=-1/0;for(let s=0,l=e.count;s<l;s++){const l=e.getX(s),c=e.getY(s),u=e.getZ(s);l<t&&(t=l),c<n&&(n=c),u<i&&(i=u),l>r&&(r=l),c>o&&(o=c),u>a&&(a=u)}return this.min.set(t,n,i),this.max.set(r,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Pi.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e){return this.makeEmpty(),this.expandByObject(e)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new Si),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new Si),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){e.updateWorldMatrix(!1,!1);const t=e.geometry;void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),Li.copy(t.boundingBox),Li.applyMatrix4(e.matrixWorld),this.union(Li));const n=e.children;for(let e=0,t=n.length;e<t;e++)this.expandByObject(n[e]);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new Si),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Pi),Pi.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Fi),Ui.subVectors(this.max,Fi),Ri.subVectors(e.a,Fi),Di.subVectors(e.b,Fi),Ii.subVectors(e.c,Fi),Oi.subVectors(Di,Ri),Ni.subVectors(Ii,Di),ki.subVectors(Ri,Ii);let t=[0,-Oi.z,Oi.y,0,-Ni.z,Ni.y,0,-ki.z,ki.y,Oi.z,0,-Oi.x,Ni.z,0,-Ni.x,ki.z,0,-ki.x,-Oi.y,Oi.x,0,-Ni.y,Ni.x,0,-ki.y,ki.x,0];return!!Gi(t,Ri,Di,Ii,Ui)&&(t=[1,0,0,0,1,0,0,0,1],!!Gi(t,Ri,Di,Ii,Ui)&&(Bi.crossVectors(Oi,Ni),t=[Bi.x,Bi.y,Bi.z],Gi(t,Ri,Di,Ii,Ui)))}clampPoint(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new Si),t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Pi.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return void 0===e&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(Pi).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Ci[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ci[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ci[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ci[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ci[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ci[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ci[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ci[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ci)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Ti.prototype.isBox3=!0;const Ci=[new Si,new Si,new Si,new Si,new Si,new Si,new Si,new Si],Pi=new Si,Li=new Ti,Ri=new Si,Di=new Si,Ii=new Si,Oi=new Si,Ni=new Si,ki=new Si,Fi=new Si,Ui=new Si,Bi=new Si,Vi=new Si;function Gi(e,t,n,i,r){for(let o=0,a=e.length-3;o<=a;o+=3){Vi.fromArray(e,o);const a=r.x*Math.abs(Vi.x)+r.y*Math.abs(Vi.y)+r.z*Math.abs(Vi.z),s=t.dot(Vi),l=n.dot(Vi),c=i.dot(Vi);if(Math.max(-Math.max(s,l,c),Math.min(s,l,c))>a)return!1}return!0}const zi=new Ti,Hi=new Si,Wi=new Si,ji=new Si;class qi{constructor(e=new Si,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):zi.setFromPoints(e).getCenter(n);let i=0;for(let t=0,r=e.length;t<r;t++)i=Math.max(i,n.distanceToSquared(e[t]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new Si),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new Ti),this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){ji.subVectors(e,this.center);const t=ji.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.add(ji.multiplyScalar(n/e)),this.radius+=n}return this}union(e){return Wi.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(Hi.copy(e.center).add(Wi)),this.expandByPoint(Hi.copy(e.center).sub(Wi)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Xi=new Si,Yi=new Si,Ki=new Si,Zi=new Si,Ji=new Si,Qi=new Si,$i=new Si;class er{constructor(e=new Si,t=new Si(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new Si),t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Xi)),this}closestPointToPoint(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new Si),t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Xi.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Xi.copy(this.direction).multiplyScalar(t).add(this.origin),Xi.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){Yi.copy(e).add(t).multiplyScalar(.5),Ki.copy(t).sub(e).normalize(),Zi.copy(this.origin).sub(Yi);const r=.5*e.distanceTo(t),o=-this.direction.dot(Ki),a=Zi.dot(this.direction),s=-Zi.dot(Ki),l=Zi.lengthSq(),c=Math.abs(1-o*o);let u,h,d,p;if(c>0)if(u=o*s-a,h=o*a-s,p=r*c,u>=0)if(h>=-p)if(h<=p){const e=1/c;u*=e,h*=e,d=u*(u+o*h+2*a)+h*(o*u+h+2*s)+l}else h=r,u=Math.max(0,-(o*h+a)),d=-u*u+h*(h+2*s)+l;else h=-r,u=Math.max(0,-(o*h+a)),d=-u*u+h*(h+2*s)+l;else h<=-p?(u=Math.max(0,-(-o*r+a)),h=u>0?-r:Math.min(Math.max(-r,-s),r),d=-u*u+h*(h+2*s)+l):h<=p?(u=0,h=Math.min(Math.max(-r,-s),r),d=h*(h+2*s)+l):(u=Math.max(0,-(o*r+a)),h=u>0?r:Math.min(Math.max(-r,-s),r),d=-u*u+h*(h+2*s)+l);else h=o>0?-r:r,u=Math.max(0,-(o*h+a)),d=-u*u+h*(h+2*s)+l;return n&&n.copy(this.direction).multiplyScalar(u).add(this.origin),i&&i.copy(Ki).multiplyScalar(h).add(Yi),d}intersectSphere(e,t){Xi.subVectors(e.center,this.origin);const n=Xi.dot(this.direction),i=Xi.dot(Xi)-n*n,r=e.radius*e.radius;if(i>r)return null;const o=Math.sqrt(r-i),a=n-o,s=n+o;return a<0&&s<0?null:a<0?this.at(s,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,r,o,a,s;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,i=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,i=(e.min.x-h.x)*l),c>=0?(r=(e.min.y-h.y)*c,o=(e.max.y-h.y)*c):(r=(e.max.y-h.y)*c,o=(e.min.y-h.y)*c),n>o||r>i?null:((r>n||n!=n)&&(n=r),(o<i||i!=i)&&(i=o),u>=0?(a=(e.min.z-h.z)*u,s=(e.max.z-h.z)*u):(a=(e.max.z-h.z)*u,s=(e.min.z-h.z)*u),n>s||a>i?null:((a>n||n!=n)&&(n=a),(s<i||i!=i)&&(i=s),i<0?null:this.at(n>=0?n:i,t)))}intersectsBox(e){return null!==this.intersectBox(e,Xi)}intersectTriangle(e,t,n,i,r){Ji.subVectors(t,e),Qi.subVectors(n,e),$i.crossVectors(Ji,Qi);let o,a=this.direction.dot($i);if(a>0){if(i)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}Zi.subVectors(this.origin,e);const s=o*this.direction.dot(Qi.crossVectors(Zi,Qi));if(s<0)return null;const l=o*this.direction.dot(Ji.cross(Zi));if(l<0)return null;if(s+l>a)return null;const c=-o*Zi.dot($i);return c<0?null:this.at(c/a,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class tr{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,i,r,o,a,s,l,c,u,h,d,p,f,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=i,g[1]=r,g[5]=o,g[9]=a,g[13]=s,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new tr).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/nr.setFromMatrixColumn(e,0).length(),r=1/nr.setFromMatrixColumn(e,1).length(),o=1/nr.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,n=e.x,i=e.y,r=e.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(i),l=Math.sin(i),c=Math.cos(r),u=Math.sin(r);if("XYZ"===e.order){const e=o*c,n=o*u,i=a*c,r=a*u;t[0]=s*c,t[4]=-s*u,t[8]=l,t[1]=n+i*l,t[5]=e-r*l,t[9]=-a*s,t[2]=r-e*l,t[6]=i+n*l,t[10]=o*s}else if("YXZ"===e.order){const e=s*c,n=s*u,i=l*c,r=l*u;t[0]=e+r*a,t[4]=i*a-n,t[8]=o*l,t[1]=o*u,t[5]=o*c,t[9]=-a,t[2]=n*a-i,t[6]=r+e*a,t[10]=o*s}else if("ZXY"===e.order){const e=s*c,n=s*u,i=l*c,r=l*u;t[0]=e-r*a,t[4]=-o*u,t[8]=i+n*a,t[1]=n+i*a,t[5]=o*c,t[9]=r-e*a,t[2]=-o*l,t[6]=a,t[10]=o*s}else if("ZYX"===e.order){const e=o*c,n=o*u,i=a*c,r=a*u;t[0]=s*c,t[4]=i*l-n,t[8]=e*l+r,t[1]=s*u,t[5]=r*l+e,t[9]=n*l-i,t[2]=-l,t[6]=a*s,t[10]=o*s}else if("YZX"===e.order){const e=o*s,n=o*l,i=a*s,r=a*l;t[0]=s*c,t[4]=r-e*u,t[8]=i*u+n,t[1]=u,t[5]=o*c,t[9]=-a*c,t[2]=-l*c,t[6]=n*u+i,t[10]=e-r*u}else if("XZY"===e.order){const e=o*s,n=o*l,i=a*s,r=a*l;t[0]=s*c,t[4]=-u,t[8]=l*c,t[1]=e*u+r,t[5]=o*c,t[9]=n*u-i,t[2]=i*u-n,t[6]=a*c,t[10]=r*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(rr,e,or)}lookAt(e,t,n){const i=this.elements;return lr.subVectors(e,t),0===lr.lengthSq()&&(lr.z=1),lr.normalize(),ar.crossVectors(n,lr),0===ar.lengthSq()&&(1===Math.abs(n.z)?lr.x+=1e-4:lr.z+=1e-4,lr.normalize(),ar.crossVectors(n,lr)),ar.normalize(),sr.crossVectors(lr,ar),i[0]=ar.x,i[4]=sr.x,i[8]=lr.x,i[1]=ar.y,i[5]=sr.y,i[9]=lr.y,i[2]=ar.z,i[6]=sr.z,i[10]=lr.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,o=n[0],a=n[4],s=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],v=n[3],y=n[7],b=n[11],_=n[15],x=i[0],E=i[4],w=i[8],S=i[12],A=i[1],M=i[5],T=i[9],C=i[13],P=i[2],L=i[6],R=i[10],D=i[14],I=i[3],O=i[7],N=i[11],k=i[15];return r[0]=o*x+a*A+s*P+l*I,r[4]=o*E+a*M+s*L+l*O,r[8]=o*w+a*T+s*R+l*N,r[12]=o*S+a*C+s*D+l*k,r[1]=c*x+u*A+h*P+d*I,r[5]=c*E+u*M+h*L+d*O,r[9]=c*w+u*T+h*R+d*N,r[13]=c*S+u*C+h*D+d*k,r[2]=p*x+f*A+m*P+g*I,r[6]=p*E+f*M+m*L+g*O,r[10]=p*w+f*T+m*R+g*N,r[14]=p*S+f*C+m*D+g*k,r[3]=v*x+y*A+b*P+_*I,r[7]=v*E+y*M+b*L+_*O,r[11]=v*w+y*T+b*R+_*N,r[15]=v*S+y*C+b*D+_*k,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],o=e[1],a=e[5],s=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+r*s*u-i*l*u-r*a*h+n*l*h+i*a*d-n*s*d)+e[7]*(+t*s*d-t*l*h+r*o*h-i*o*d+i*l*c-r*s*c)+e[11]*(+t*l*u-t*a*d-r*o*u+n*o*d+r*a*c-n*l*c)+e[15]*(-i*a*c-t*s*u+t*a*h+i*o*u-n*o*h+n*s*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],s=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],f=e[13],m=e[14],g=e[15],v=u*m*l-f*h*l+f*s*d-a*m*d-u*s*g+a*h*g,y=p*h*l-c*m*l-p*s*d+o*m*d+c*s*g-o*h*g,b=c*f*l-p*u*l+p*a*d-o*f*d-c*a*g+o*u*g,_=p*u*s-c*f*s-p*a*h+o*f*h+c*a*m-o*u*m,x=t*v+n*y+i*b+r*_;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const E=1/x;return e[0]=v*E,e[1]=(f*h*r-u*m*r-f*i*d+n*m*d+u*i*g-n*h*g)*E,e[2]=(a*m*r-f*s*r+f*i*l-n*m*l-a*i*g+n*s*g)*E,e[3]=(u*s*r-a*h*r-u*i*l+n*h*l+a*i*d-n*s*d)*E,e[4]=y*E,e[5]=(c*m*r-p*h*r+p*i*d-t*m*d-c*i*g+t*h*g)*E,e[6]=(p*s*r-o*m*r-p*i*l+t*m*l+o*i*g-t*s*g)*E,e[7]=(o*h*r-c*s*r+c*i*l-t*h*l-o*i*d+t*s*d)*E,e[8]=b*E,e[9]=(p*u*r-c*f*r-p*n*d+t*f*d+c*n*g-t*u*g)*E,e[10]=(o*f*r-p*a*r+p*n*l-t*f*l-o*n*g+t*a*g)*E,e[11]=(c*a*r-o*u*r-c*n*l+t*u*l+o*n*d-t*a*d)*E,e[12]=_*E,e[13]=(c*f*i-p*u*i+p*n*h-t*f*h-c*n*m+t*u*m)*E,e[14]=(p*a*i-o*f*i-p*n*s+t*f*s+o*n*m-t*a*m)*E,e[15]=(o*u*i-c*a*i+c*n*s-t*u*s-o*n*h+t*a*h)*E,this}scale(e){const t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),r=1-n,o=e.x,a=e.y,s=e.z,l=r*o,c=r*a;return this.set(l*o+n,l*a-i*s,l*s+i*a,0,l*a+i*s,c*a+n,c*s-i*o,0,l*s-i*a,c*s+i*o,r*s*s+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,r,o){return this.set(1,n,r,0,e,1,o,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,r=t._x,o=t._y,a=t._z,s=t._w,l=r+r,c=o+o,u=a+a,h=r*l,d=r*c,p=r*u,f=o*c,m=o*u,g=a*u,v=s*l,y=s*c,b=s*u,_=n.x,x=n.y,E=n.z;return i[0]=(1-(f+g))*_,i[1]=(d+b)*_,i[2]=(p-y)*_,i[3]=0,i[4]=(d-b)*x,i[5]=(1-(h+g))*x,i[6]=(m+v)*x,i[7]=0,i[8]=(p+y)*E,i[9]=(m-v)*E,i[10]=(1-(h+f))*E,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let r=nr.set(i[0],i[1],i[2]).length();const o=nr.set(i[4],i[5],i[6]).length(),a=nr.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),e.x=i[12],e.y=i[13],e.z=i[14],ir.copy(this);const s=1/r,l=1/o,c=1/a;return ir.elements[0]*=s,ir.elements[1]*=s,ir.elements[2]*=s,ir.elements[4]*=l,ir.elements[5]*=l,ir.elements[6]*=l,ir.elements[8]*=c,ir.elements[9]*=c,ir.elements[10]*=c,t.setFromRotationMatrix(ir),n.x=r,n.y=o,n.z=a,this}makePerspective(e,t,n,i,r,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,s=2*r/(t-e),l=2*r/(n-i),c=(t+e)/(t-e),u=(n+i)/(n-i),h=-(o+r)/(o-r),d=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=l,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,n,i,r,o){const a=this.elements,s=1/(t-e),l=1/(n-i),c=1/(o-r),u=(t+e)*s,h=(n+i)*l,d=(o+r)*c;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let e=0;e<16;e++)if(t[e]!==n[e])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}tr.prototype.isMatrix4=!0;const nr=new Si,ir=new tr,rr=new Si(0,0,0),or=new Si(1,1,1),ar=new Si,sr=new Si,lr=new Si,cr=new tr,ur=new wi;class hr{constructor(e=0,t=0,n=0,i=hr.DefaultOrder){this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._order=i||this._order,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t,n){const i=e.elements,r=i[0],o=i[4],a=i[8],s=i[1],l=i[5],c=i[9],u=i[2],h=i[6],d=i[10];switch(t=t||this._order){case"XYZ":this._y=Math.asin(Xn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-o,r)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Xn(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-u,r),this._z=0);break;case"ZXY":this._x=Math.asin(Xn(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-o,l)):(this._y=0,this._z=Math.atan2(s,r));break;case"ZYX":this._y=Math.asin(-Xn(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(s,r)):(this._x=0,this._z=Math.atan2(-o,l));break;case"YZX":this._z=Math.asin(Xn(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,r)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-Xn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!1!==n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return cr.makeRotationFromQuaternion(e),this.setFromRotationMatrix(cr,t,n)}setFromVector3(e,t){return this.set(e.x,e.y,e.z,t||this._order)}reorder(e){return ur.setFromEuler(this),this.setFromQuaternion(ur,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}toVector3(e){return e?e.set(this._x,this._y,this._z):new Si(this._x,this._y,this._z)}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}hr.prototype.isEuler=!0,hr.DefaultOrder="XYZ",hr.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class dr{constructor(){this.mask=1}set(e){this.mask=1<<e|0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}}let pr=0;const fr=new Si,mr=new wi,gr=new tr,vr=new Si,yr=new Si,br=new Si,_r=new wi,xr=new Si(1,0,0),Er=new Si(0,1,0),wr=new Si(0,0,1),Sr={type:"added"},Ar={type:"removed"};class Mr extends Gn{constructor(){super(),Object.defineProperty(this,"id",{value:pr++}),this.uuid=qn(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Mr.DefaultUp.clone();const e=new Si,t=new hr,n=new wi,i=new Si(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new tr},normalMatrix:{value:new pi}}),this.matrix=new tr,this.matrixWorld=new tr,this.matrixAutoUpdate=Mr.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new dr,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return mr.setFromAxisAngle(e,t),this.quaternion.multiply(mr),this}rotateOnWorldAxis(e,t){return mr.setFromAxisAngle(e,t),this.quaternion.premultiply(mr),this}rotateX(e){return this.rotateOnAxis(xr,e)}rotateY(e){return this.rotateOnAxis(Er,e)}rotateZ(e){return this.rotateOnAxis(wr,e)}translateOnAxis(e,t){return fr.copy(e).applyQuaternion(this.quaternion),this.position.add(fr.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(xr,e)}translateY(e){return this.translateOnAxis(Er,e)}translateZ(e){return this.translateOnAxis(wr,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(gr.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?vr.copy(e):vr.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),yr.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?gr.lookAt(yr,vr,this.up):gr.lookAt(vr,yr,this.up),this.quaternion.setFromRotationMatrix(gr),i&&(gr.extractRotation(i.matrixWorld),mr.setFromRotationMatrix(gr),this.quaternion.premultiply(mr.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Sr)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Ar)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(Ar)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),gr.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),gr.multiply(e.parent.matrixWorld)),e.applyMatrix4(gr),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}}getWorldPosition(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new Si),this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new wi),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(yr,e,br),e}getWorldScale(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new Si),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(yr,_r,e),e}getWorldDirection(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new Si),this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++)e[t].updateWorldMatrix(!1,!0)}}toJSON(e){const t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};function r(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isMesh||this.isLine||this.isPoints){i.geometry=r(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,i=n.length;t<i;t++){const i=n[t];r(e.shapes,i)}else r(e.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,i=this.material.length;n<i;n++)t.push(r(e.materials,this.material[n]));i.material=t}else i.material=r(e.materials,this.material);if(this.children.length>0){i.children=[];for(let t=0;t<this.children.length;t++)i.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];i.animations.push(r(e.animations,n))}}if(t){const t=o(e.geometries),i=o(e.materials),r=o(e.textures),a=o(e.images),s=o(e.shapes),l=o(e.skeletons),c=o(e.animations);t.length>0&&(n.geometries=t),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),a.length>0&&(n.images=a),s.length>0&&(n.shapes=s),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c)}return n.object=i,n;function o(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let t=0;t<e.children.length;t++){const n=e.children[t];this.add(n.clone())}return this}}Mr.DefaultUp=new Si(0,1,0),Mr.DefaultMatrixAutoUpdate=!0,Mr.prototype.isObject3D=!0;const Tr=new Si,Cr=new Si,Pr=new pi;class Lr{constructor(e=new Si(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=Tr.subVectors(n,t).cross(Cr.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new Si),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new Si);const n=e.delta(Tr),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:t.copy(n).multiplyScalar(r).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new Si),e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||Pr.getNormalMatrix(e),i=this.coplanarPoint(Tr).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}Lr.prototype.isPlane=!0;const Rr=new Si,Dr=new Si,Ir=new Si,Or=new Si,Nr=new Si,kr=new Si,Fr=new Si,Ur=new Si,Br=new Si,Vr=new Si;class Gr{constructor(e=new Si,t=new Si,n=new Si){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){void 0===i&&(console.warn("THREE.Triangle: .getNormal() target is now required"),i=new Si),i.subVectors(n,t),Rr.subVectors(e,t),i.cross(Rr);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(e,t,n,i,r){Rr.subVectors(i,t),Dr.subVectors(n,t),Ir.subVectors(e,t);const o=Rr.dot(Rr),a=Rr.dot(Dr),s=Rr.dot(Ir),l=Dr.dot(Dr),c=Dr.dot(Ir),u=o*l-a*a;if(void 0===r&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),r=new Si),0===u)return r.set(-2,-1,-1);const h=1/u,d=(l*s-a*c)*h,p=(o*c-a*s)*h;return r.set(1-d-p,p,d)}static containsPoint(e,t,n,i){return this.getBarycoord(e,t,n,i,Or),Or.x>=0&&Or.y>=0&&Or.x+Or.y<=1}static getUV(e,t,n,i,r,o,a,s){return this.getBarycoord(e,t,n,i,Or),s.set(0,0),s.addScaledVector(r,Or.x),s.addScaledVector(o,Or.y),s.addScaledVector(a,Or.z),s}static isFrontFacing(e,t,n,i){return Rr.subVectors(n,t),Dr.subVectors(e,t),Rr.cross(Dr).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Rr.subVectors(this.c,this.b),Dr.subVectors(this.a,this.b),.5*Rr.cross(Dr).length()}getMidpoint(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new Si),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Gr.getNormal(this.a,this.b,this.c,e)}getPlane(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new Lr),e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Gr.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,i,r){return Gr.getUV(e,this.a,this.b,this.c,t,n,i,r)}containsPoint(e){return Gr.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Gr.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new Si);const n=this.a,i=this.b,r=this.c;let o,a;Nr.subVectors(i,n),kr.subVectors(r,n),Ur.subVectors(e,n);const s=Nr.dot(Ur),l=kr.dot(Ur);if(s<=0&&l<=0)return t.copy(n);Br.subVectors(e,i);const c=Nr.dot(Br),u=kr.dot(Br);if(c>=0&&u<=c)return t.copy(i);const h=s*u-c*l;if(h<=0&&s>=0&&c<=0)return o=s/(s-c),t.copy(n).addScaledVector(Nr,o);Vr.subVectors(e,r);const d=Nr.dot(Vr),p=kr.dot(Vr);if(p>=0&&d<=p)return t.copy(r);const f=d*l-s*p;if(f<=0&&l>=0&&p<=0)return a=l/(l-p),t.copy(n).addScaledVector(kr,a);const m=c*p-d*u;if(m<=0&&u-c>=0&&d-p>=0)return Fr.subVectors(r,i),a=(u-c)/(u-c+(d-p)),t.copy(i).addScaledVector(Fr,a);const g=1/(m+f+h);return o=f*g,a=h*g,t.copy(n).addScaledVector(Nr,o).addScaledVector(kr,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let zr=0;class Hr extends Gn{constructor(){super(),Object.defineProperty(this,"id",{value:zr++}),this.uuid=qn(),this.name="",this.type="Material",this.fog=!0,this.blending=A,this.side=b,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=B,this.blendDst=V,this.blendEquation=L,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=K,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Pn,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=mn,this.stencilZFail=mn,this.stencilZPass=mn,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}onBuild(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===E;continue}const i=this[t];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==A&&(n.blending=this.blending),this.side!==b&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){const t=i(e.textures),r=i(e.images);t.length>0&&(n.textures=t),r.length>0&&(n.images=r)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let i=0;i!==e;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}Hr.prototype.isMaterial=!0;const Wr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},jr={h:0,s:0,l:0},qr={h:0,s:0,l:0};function Xr(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function Yr(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Kr(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}class Zr{constructor(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}setRGB(e,t,n){return this.r=e,this.g=t,this.b=n,this}setHSL(e,t,n){if(e=Yn(e,1),t=Xn(t,0,1),n=Xn(n,0,1),0===t)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,r=2*n-i;this.r=Xr(r,i,e+1/3),this.g=Xr(r,i,e),this.b=Xr(r,i,e-1/3)}return this}setStyle(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let e;const i=n[1],r=n[2];switch(i){case"rgb":case"rgba":if(e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r))return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,t(e[4]),this;if(e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r))return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,t(e[4]),this;break;case"hsl":case"hsla":if(e=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r)){const n=parseFloat(e[1])/360,i=parseInt(e[2],10)/100,r=parseInt(e[3],10)/100;return t(e[4]),this.setHSL(n,i,r)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){const e=n[1],t=e.length;if(3===t)return this.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,this.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,this.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,this;if(6===t)return this.r=parseInt(e.charAt(0)+e.charAt(1),16)/255,this.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,this.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}setColorName(e){const t=Wr[e.toLowerCase()];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copyGammaToLinear(e,t=2){return this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this}copyLinearToGamma(e,t=2){const n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this}convertGammaToLinear(e){return this.copyGammaToLinear(this,e),this}convertLinearToGamma(e){return this.copyLinearToGamma(this,e),this}copySRGBToLinear(e){return this.r=Yr(e.r),this.g=Yr(e.g),this.b=Yr(e.b),this}copyLinearToSRGB(e){return this.r=Kr(e.r),this.g=Kr(e.g),this.b=Kr(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});const t=this.r,n=this.g,i=this.b,r=Math.max(t,n,i),o=Math.min(t,n,i);let a,s;const l=(o+r)/2;if(o===r)a=0,s=0;else{const e=r-o;switch(s=l<=.5?e/(r+o):e/(2-r-o),r){case t:a=(n-i)/e+(n<i?6:0);break;case n:a=(i-t)/e+2;break;case i:a=(t-n)/e+4}a/=6}return e.h=a,e.s=s,e.l=l,e}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(e,t,n){return this.getHSL(jr),jr.h+=e,jr.s+=t,jr.l+=n,this.setHSL(jr.h,jr.s,jr.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(jr),e.getHSL(qr);const n=Jn(jr.h,qr.h,t),i=Jn(jr.s,qr.s,t),r=Jn(jr.l,qr.l,t);return this.setHSL(n,i,r),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Zr.NAMES=Wr,Zr.prototype.isColor=!0,Zr.prototype.r=1,Zr.prototype.g=1,Zr.prototype.b=1;class Jr extends Hr{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new Zr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ee,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.morphTargets=e.morphTargets,this}}Jr.prototype.isMeshBasicMaterial=!0;const Qr=new Si,$r=new di;class eo{constructor(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=Ln,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let n=0;for(let i=0,r=e.length;i<r;i++){let r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),r=new Zr),t[n++]=r.r,t[n++]=r.g,t[n++]=r.b}return this}copyVector2sArray(e){const t=this.array;let n=0;for(let i=0,r=e.length;i<r;i++){let r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),r=new di),t[n++]=r.x,t[n++]=r.y}return this}copyVector3sArray(e){const t=this.array;let n=0;for(let i=0,r=e.length;i<r;i++){let r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),r=new Si),t[n++]=r.x,t[n++]=r.y,t[n++]=r.z}return this}copyVector4sArray(e){const t=this.array;let n=0;for(let i=0,r=e.length;i<r;i++){let r=e[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),r=new bi),t[n++]=r.x,t[n++]=r.y,t[n++]=r.z,t[n++]=r.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)$r.fromBufferAttribute(this,t),$r.applyMatrix3(e),this.setXY(t,$r.x,$r.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)Qr.fromBufferAttribute(this,t),Qr.applyMatrix3(e),this.setXYZ(t,Qr.x,Qr.y,Qr.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Qr.x=this.getX(t),Qr.y=this.getY(t),Qr.z=this.getZ(t),Qr.applyMatrix4(e),this.setXYZ(t,Qr.x,Qr.y,Qr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Qr.x=this.getX(t),Qr.y=this.getY(t),Qr.z=this.getZ(t),Qr.applyNormalMatrix(e),this.setXYZ(t,Qr.x,Qr.y,Qr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Qr.x=this.getX(t),Qr.y=this.getY(t),Qr.z=this.getZ(t),Qr.transformDirection(e),this.setXYZ(t,Qr.x,Qr.y,Qr.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Ln&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}}eo.prototype.isBufferAttribute=!0;class to extends eo{constructor(e,t,n){super(new Int8Array(e),t,n)}}class no extends eo{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class io extends eo{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class ro extends eo{constructor(e,t,n){super(new Int16Array(e),t,n)}}class oo extends eo{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class ao extends eo{constructor(e,t,n){super(new Int32Array(e),t,n)}}class so extends eo{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class lo extends eo{constructor(e,t,n){super(new Uint16Array(e),t,n)}}lo.prototype.isFloat16BufferAttribute=!0;class co extends eo{constructor(e,t,n){super(new Float32Array(e),t,n)}}class uo extends eo{constructor(e,t,n){super(new Float64Array(e),t,n)}}function ho(e){if(0===e.length)return-1/0;let t=e[0];for(let n=1,i=e.length;n<i;++n)e[n]>t&&(t=e[n]);return t}const po={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function fo(e,t){return new po[e](t)}let mo=0;const go=new tr,vo=new Mr,yo=new Si,bo=new Ti,_o=new Ti,xo=new Si;class Eo extends Gn{constructor(){super(),Object.defineProperty(this,"id",{value:mo++}),this.uuid=qn(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(ho(e)>65535?so:oo)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new pi).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return go.makeRotationFromQuaternion(e),this.applyMatrix4(go),this}rotateX(e){return go.makeRotationX(e),this.applyMatrix4(go),this}rotateY(e){return go.makeRotationY(e),this.applyMatrix4(go),this}rotateZ(e){return go.makeRotationZ(e),this.applyMatrix4(go),this}translate(e,t,n){return go.makeTranslation(e,t,n),this.applyMatrix4(go),this}scale(e,t,n){return go.makeScale(e,t,n),this.applyMatrix4(go),this}lookAt(e){return vo.lookAt(e),vo.updateMatrix(),this.applyMatrix4(vo.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(yo).negate(),this.translate(yo.x,yo.y,yo.z),this}setFromPoints(e){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new co(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Ti);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Si(-1/0,-1/0,-1/0),new Si(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){const n=t[e];bo.setFromBufferAttribute(n),this.morphTargetsRelative?(xo.addVectors(this.boundingBox.min,bo.min),this.boundingBox.expandByPoint(xo),xo.addVectors(this.boundingBox.max,bo.max),this.boundingBox.expandByPoint(xo)):(this.boundingBox.expandByPoint(bo.min),this.boundingBox.expandByPoint(bo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new qi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Si,1/0);if(e){const n=this.boundingSphere.center;if(bo.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){const n=t[e];_o.setFromBufferAttribute(n),this.morphTargetsRelative?(xo.addVectors(bo.min,_o.min),bo.expandByPoint(xo),xo.addVectors(bo.max,_o.max),bo.expandByPoint(xo)):(bo.expandByPoint(_o.min),bo.expandByPoint(_o.max))}bo.getCenter(n);let i=0;for(let t=0,r=e.count;t<r;t++)xo.fromBufferAttribute(e,t),i=Math.max(i,n.distanceToSquared(xo));if(t)for(let r=0,o=t.length;r<o;r++){const o=t[r],a=this.morphTargetsRelative;for(let t=0,r=o.count;t<r;t++)xo.fromBufferAttribute(o,t),a&&(yo.fromBufferAttribute(e,t),xo.add(yo)),i=Math.max(i,n.distanceToSquared(xo))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeFaceNormals(){}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,i=t.position.array,r=t.normal.array,o=t.uv.array,a=i.length/3;void 0===t.tangent&&this.setAttribute("tangent",new eo(new Float32Array(4*a),4));const s=t.tangent.array,l=[],c=[];for(let e=0;e<a;e++)l[e]=new Si,c[e]=new Si;const u=new Si,h=new Si,d=new Si,p=new di,f=new di,m=new di,g=new Si,v=new Si;function y(e,t,n){u.fromArray(i,3*e),h.fromArray(i,3*t),d.fromArray(i,3*n),p.fromArray(o,2*e),f.fromArray(o,2*t),m.fromArray(o,2*n),h.sub(u),d.sub(u),f.sub(p),m.sub(p);const r=1/(f.x*m.y-m.x*f.y);isFinite(r)&&(g.copy(h).multiplyScalar(m.y).addScaledVector(d,-f.y).multiplyScalar(r),v.copy(d).multiplyScalar(f.x).addScaledVector(h,-m.x).multiplyScalar(r),l[e].add(g),l[t].add(g),l[n].add(g),c[e].add(v),c[t].add(v),c[n].add(v))}let b=this.groups;0===b.length&&(b=[{start:0,count:n.length}]);for(let e=0,t=b.length;e<t;++e){const t=b[e],i=t.start;for(let e=i,r=i+t.count;e<r;e+=3)y(n[e+0],n[e+1],n[e+2])}const _=new Si,x=new Si,E=new Si,w=new Si;function S(e){E.fromArray(r,3*e),w.copy(E);const t=l[e];_.copy(t),_.sub(E.multiplyScalar(E.dot(t))).normalize(),x.crossVectors(w,t);const n=x.dot(c[e])<0?-1:1;s[4*e]=_.x,s[4*e+1]=_.y,s[4*e+2]=_.z,s[4*e+3]=n}for(let e=0,t=b.length;e<t;++e){const t=b[e],i=t.start;for(let e=i,r=i+t.count;e<r;e+=3)S(n[e+0]),S(n[e+1]),S(n[e+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new eo(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const i=new Si,r=new Si,o=new Si,a=new Si,s=new Si,l=new Si,c=new Si,u=new Si;if(e)for(let h=0,d=e.count;h<d;h+=3){const d=e.getX(h+0),p=e.getX(h+1),f=e.getX(h+2);i.fromBufferAttribute(t,d),r.fromBufferAttribute(t,p),o.fromBufferAttribute(t,f),c.subVectors(o,r),u.subVectors(i,r),c.cross(u),a.fromBufferAttribute(n,d),s.fromBufferAttribute(n,p),l.fromBufferAttribute(n,f),a.add(c),s.add(c),l.add(c),n.setXYZ(d,a.x,a.y,a.z),n.setXYZ(p,s.x,s.y,s.z),n.setXYZ(f,l.x,l.y,l.z)}else for(let e=0,a=t.count;e<a;e+=3)i.fromBufferAttribute(t,e+0),r.fromBufferAttribute(t,e+1),o.fromBufferAttribute(t,e+2),c.subVectors(o,r),u.subVectors(i,r),c.cross(u),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const i in n){if(void 0===e.attributes[i])continue;const r=n[i].array,o=e.attributes[i],a=o.array,s=o.itemSize*t,l=Math.min(a.length,r.length-s);for(let e=0,t=s;e<l;e++,t++)r[t]=a[e]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)xo.fromBufferAttribute(e,t),xo.normalize(),e.setXYZ(t,xo.x,xo.y,xo.z)}toNonIndexed(){function e(e,t){const n=e.array,i=e.itemSize,r=e.normalized,o=new n.constructor(t.length*i);let a=0,s=0;for(let e=0,r=t.length;e<r;e++){a=t[e]*i;for(let e=0;e<i;e++)o[s++]=n[a++]}return new eo(o,i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Eo,n=this.index.array,i=this.attributes;for(const r in i){const o=e(i[r],n);t.setAttribute(r,o)}const r=this.morphAttributes;for(const i in r){const o=[],a=r[i];for(let t=0,i=a.length;t<i;t++){const i=e(a[t],n);o.push(i)}t.morphAttributes[i]=o}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let e=0,n=o.length;e<n;e++){const n=o[e];t.addGroup(n.start,n.count,n.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const t in n){const i=n[t];e.data.attributes[t]=i.toJSON(e.data)}const i={};let r=!1;for(const t in this.morphAttributes){const n=this.morphAttributes[t],o=[];for(let t=0,i=n.length;t<i;t++){const i=n[t];o.push(i.toJSON(e.data))}o.length>0&&(i[t]=o,r=!0)}r&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new Eo).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const i=e.attributes;for(const e in i){const n=i[e];this.setAttribute(e,n.clone(t))}const r=e.morphAttributes;for(const e in r){const n=[],i=r[e];for(let e=0,r=i.length;e<r;e++)n.push(i[e].clone(t));this.morphAttributes[e]=n}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let e=0,t=o.length;e<t;e++){const t=o[e];this.addGroup(t.start,t.count,t.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const s=e.boundingSphere;return null!==s&&(this.boundingSphere=s.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}Eo.prototype.isBufferGeometry=!0;const wo=new tr,So=new er,Ao=new qi,Mo=new Si,To=new Si,Co=new Si,Po=new Si,Lo=new Si,Ro=new Si,Do=new Si,Io=new Si,Oo=new Si,No=new di,ko=new di,Fo=new di,Uo=new Si,Bo=new Si;class Vo extends Mr{constructor(e=new Eo,t=new Jr){super(),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const e=t[n[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,n=e.length;t<n;t++){const n=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,t){const n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0===i)return;if(null===n.boundingSphere&&n.computeBoundingSphere(),Ao.copy(n.boundingSphere),Ao.applyMatrix4(r),!1===e.ray.intersectsSphere(Ao))return;if(wo.copy(r).invert(),So.copy(e.ray).applyMatrix4(wo),null!==n.boundingBox&&!1===So.intersectsBox(n.boundingBox))return;let o;if(n.isBufferGeometry){const r=n.index,a=n.attributes.position,s=n.morphAttributes.position,l=n.morphTargetsRelative,c=n.attributes.uv,u=n.attributes.uv2,h=n.groups,d=n.drawRange;if(null!==r)if(Array.isArray(i))for(let n=0,p=h.length;n<p;n++){const p=h[n],f=i[p.materialIndex];for(let n=Math.max(p.start,d.start),i=Math.min(p.start+p.count,d.start+d.count);n<i;n+=3){const i=r.getX(n),h=r.getX(n+1),d=r.getX(n+2);o=Go(this,f,e,So,a,s,l,c,u,i,h,d),o&&(o.faceIndex=Math.floor(n/3),o.face.materialIndex=p.materialIndex,t.push(o))}}else{for(let n=Math.max(0,d.start),h=Math.min(r.count,d.start+d.count);n<h;n+=3){const h=r.getX(n),d=r.getX(n+1),p=r.getX(n+2);o=Go(this,i,e,So,a,s,l,c,u,h,d,p),o&&(o.faceIndex=Math.floor(n/3),t.push(o))}}else if(void 0!==a)if(Array.isArray(i))for(let n=0,r=h.length;n<r;n++){const r=h[n],p=i[r.materialIndex];for(let n=Math.max(r.start,d.start),i=Math.min(r.start+r.count,d.start+d.count);n<i;n+=3){o=Go(this,p,e,So,a,s,l,c,u,n,n+1,n+2),o&&(o.faceIndex=Math.floor(n/3),o.face.materialIndex=r.materialIndex,t.push(o))}}else{for(let n=Math.max(0,d.start),r=Math.min(a.count,d.start+d.count);n<r;n+=3){o=Go(this,i,e,So,a,s,l,c,u,n,n+1,n+2),o&&(o.faceIndex=Math.floor(n/3),t.push(o))}}}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function Go(e,t,n,i,r,o,a,s,l,c,u,h){Mo.fromBufferAttribute(r,c),To.fromBufferAttribute(r,u),Co.fromBufferAttribute(r,h);const d=e.morphTargetInfluences;if(t.morphTargets&&o&&d){Do.set(0,0,0),Io.set(0,0,0),Oo.set(0,0,0);for(let e=0,t=o.length;e<t;e++){const t=d[e],n=o[e];0!==t&&(Po.fromBufferAttribute(n,c),Lo.fromBufferAttribute(n,u),Ro.fromBufferAttribute(n,h),a?(Do.addScaledVector(Po,t),Io.addScaledVector(Lo,t),Oo.addScaledVector(Ro,t)):(Do.addScaledVector(Po.sub(Mo),t),Io.addScaledVector(Lo.sub(To),t),Oo.addScaledVector(Ro.sub(Co),t)))}Mo.add(Do),To.add(Io),Co.add(Oo)}e.isSkinnedMesh&&(e.boneTransform(c,Mo),e.boneTransform(u,To),e.boneTransform(h,Co));const p=function(e,t,n,i,r,o,a,s){let l;if(l=t.side===_?i.intersectTriangle(a,o,r,!0,s):i.intersectTriangle(r,o,a,t.side!==x,s),null===l)return null;Bo.copy(s),Bo.applyMatrix4(e.matrixWorld);const c=n.ray.origin.distanceTo(Bo);return c<n.near||c>n.far?null:{distance:c,point:Bo.clone(),object:e}}(e,t,n,i,Mo,To,Co,Uo);if(p){s&&(No.fromBufferAttribute(s,c),ko.fromBufferAttribute(s,u),Fo.fromBufferAttribute(s,h),p.uv=Gr.getUV(Uo,Mo,To,Co,No,ko,Fo,new di)),l&&(No.fromBufferAttribute(l,c),ko.fromBufferAttribute(l,u),Fo.fromBufferAttribute(l,h),p.uv2=Gr.getUV(Uo,Mo,To,Co,No,ko,Fo,new di));const e={a:c,b:u,c:h,normal:new Si,materialIndex:0};Gr.getNormal(Mo,To,Co,e.normal),p.face=e}return p}Vo.prototype.isMesh=!0;class zo extends Eo{constructor(e=1,t=1,n=1,i=1,r=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:o};const a=this;i=Math.floor(i),r=Math.floor(r),o=Math.floor(o);const s=[],l=[],c=[],u=[];let h=0,d=0;function p(e,t,n,i,r,o,p,f,m,g,v){const y=o/m,b=p/g,_=o/2,x=p/2,E=f/2,w=m+1,S=g+1;let A=0,M=0;const T=new Si;for(let o=0;o<S;o++){const a=o*b-x;for(let s=0;s<w;s++){const h=s*y-_;T[e]=h*i,T[t]=a*r,T[n]=E,l.push(T.x,T.y,T.z),T[e]=0,T[t]=0,T[n]=f>0?1:-1,c.push(T.x,T.y,T.z),u.push(s/m),u.push(1-o/g),A+=1}}for(let e=0;e<g;e++)for(let t=0;t<m;t++){const n=h+t+w*e,i=h+t+w*(e+1),r=h+(t+1)+w*(e+1),o=h+(t+1)+w*e;s.push(n,i,o),s.push(i,r,o),M+=6}a.addGroup(d,M,v),d+=M,h+=A}p("z","y","x",-1,-1,n,t,e,o,r,0),p("z","y","x",1,-1,n,t,-e,o,r,1),p("x","z","y",1,1,e,n,t,i,o,2),p("x","z","y",1,-1,e,n,-t,i,o,3),p("x","y","z",1,-1,e,t,n,i,r,4),p("x","y","z",-1,-1,e,t,-n,i,r,5),this.setIndex(s),this.setAttribute("position",new co(l,3)),this.setAttribute("normal",new co(c,3)),this.setAttribute("uv",new co(u,2))}}function Ho(e){const t={};for(const n in e){t[n]={};for(const i in e[n]){const r=e[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?t[n][i]=r.clone():Array.isArray(r)?t[n][i]=r.slice():t[n][i]=r}}return t}function Wo(e){const t={};for(let n=0;n<e.length;n++){const i=Ho(e[n]);for(const e in i)t[e]=i[e]}return t}const jo={clone:Ho,merge:Wo};class qo extends Hr{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="\nvoid main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",this.fragmentShader="\nvoid main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}\n",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ho(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const n in this.uniforms){const i=this.uniforms[n].value;i&&i.isTexture?t.uniforms[n]={type:"t",value:i.toJSON(e).uuid}:i&&i.isColor?t.uniforms[n]={type:"c",value:i.getHex()}:i&&i.isVector2?t.uniforms[n]={type:"v2",value:i.toArray()}:i&&i.isVector3?t.uniforms[n]={type:"v3",value:i.toArray()}:i&&i.isVector4?t.uniforms[n]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?t.uniforms[n]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?t.uniforms[n]={type:"m4",value:i.toArray()}:t.uniforms[n]={value:i}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const e in this.extensions)!0===this.extensions[e]&&(n[e]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}qo.prototype.isShaderMaterial=!0;class Xo extends Mr{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new tr,this.projectionMatrix=new tr,this.projectionMatrixInverse=new tr}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new Si),this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}Xo.prototype.isCamera=!0;class Yo extends Xo{constructor(e=50,t=1,n=.1,i=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*jn*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Wn*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*jn*Math.atan(Math.tan(.5*Wn*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,i,r,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Wn*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i;const o=this.view;if(null!==this.view&&this.view.enabled){const e=o.fullWidth,a=o.fullHeight;r+=o.offsetX*i/e,t-=o.offsetY*n/a,i*=o.width/e,n*=o.height/a}const a=this.filmOffset;0!==a&&(r+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}Yo.prototype.isPerspectiveCamera=!0;const Ko=90;class Zo extends Mr{constructor(e,t,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const i=new Yo(Ko,1,e,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new Si(1,0,0)),this.add(i);const r=new Yo(Ko,1,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new Si(-1,0,0)),this.add(r);const o=new Yo(Ko,1,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new Si(0,1,0)),this.add(o);const a=new Yo(Ko,1,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new Si(0,-1,0)),this.add(a);const s=new Yo(Ko,1,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new Si(0,0,1)),this.add(s);const l=new Yo(Ko,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new Si(0,0,-1)),this.add(l)}update(e,t){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[i,r,o,a,s,l]=this.children,c=e.xr.enabled,u=e.getRenderTarget();e.xr.enabled=!1;const h=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,i),e.setRenderTarget(n,1),e.render(t,r),e.setRenderTarget(n,2),e.render(t,o),e.setRenderTarget(n,3),e.render(t,a),e.setRenderTarget(n,4),e.render(t,s),n.texture.generateMipmaps=h,e.setRenderTarget(n,5),e.render(t,l),e.setRenderTarget(u),e.xr.enabled=c}}class Jo extends vi{constructor(e,t,n,i,r,o,a,s,l,c){super(e=void 0!==e?e:[],t=void 0!==t?t:ue,n,i,r,o,a=void 0!==a?a:ze,s,l,c),this._needsFlipEnvMap=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}Jo.prototype.isCubeTexture=!0;class Qo extends _i{constructor(e,t,n){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=n),super(e,e,t),t=t||{},this.texture=new Jo(void 0,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Se,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.format=He,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},i=new zo(5,5,5),r=new qo({name:"CubemapFromEquirect",uniforms:Ho(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:_,blending:S});r.uniforms.tEquirect.value=t;const o=new Vo(i,r),a=t.minFilter;t.minFilter===Te&&(t.minFilter=Se);return new Zo(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,i){const r=e.getRenderTarget();for(let r=0;r<6;r++)e.setRenderTarget(this,r),e.clear(t,n,i);e.setRenderTarget(r)}}Qo.prototype.isWebGLCubeRenderTarget=!0;const $o=new qi,ea=new Si;class ta{constructor(e=new Lr,t=new Lr,n=new Lr,i=new Lr,r=new Lr,o=new Lr){this.planes=[e,t,n,i,r,o]}set(e,t,n,i,r,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],l=n[5],c=n[6],u=n[7],h=n[8],d=n[9],p=n[10],f=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return t[0].setComponents(a-i,u-s,f-h,y-m).normalize(),t[1].setComponents(a+i,u+s,f+h,y+m).normalize(),t[2].setComponents(a+r,u+l,f+d,y+g).normalize(),t[3].setComponents(a-r,u-l,f-d,y-g).normalize(),t[4].setComponents(a-o,u-c,f-p,y-v).normalize(),t[5].setComponents(a+o,u+c,f+p,y+v).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),$o.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere($o)}intersectsSprite(e){return $o.center.set(0,0,0),$o.radius=.7071067811865476,$o.applyMatrix4(e.matrixWorld),this.intersectsSphere($o)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let e=0;e<6;e++){if(t[e].distanceToPoint(n)<i)return!1}return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(ea.x=i.normal.x>0?e.max.x:e.min.x,ea.y=i.normal.y>0?e.max.y:e.min.y,ea.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(ea)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function na(){let e=null,t=!1,n=null,i=null;function r(t,o){n(t,o),i=e.requestAnimationFrame(r)}return{start:function(){!0!==t&&null!==n&&(i=e.requestAnimationFrame(r),t=!0)},stop:function(){e.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function ia(e,t){const n=t.isWebGL2,i=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),i.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);const n=i.get(t);n&&(e.deleteBuffer(n.buffer),i.delete(t))},update:function(t,r){if(t.isGLBufferAttribute){const e=i.get(t);return void((!e||e.version<t.version)&&i.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version}))}t.isInterleavedBufferAttribute&&(t=t.data);const o=i.get(t);void 0===o?i.set(t,function(t,i){const r=t.array,o=t.usage,a=e.createBuffer();e.bindBuffer(i,a),e.bufferData(i,r,o),t.onUploadCallback();let s=e.FLOAT;return r instanceof Float32Array?s=e.FLOAT:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?t.isFloat16BufferAttribute?n?s=e.HALF_FLOAT:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):s=e.UNSIGNED_SHORT:r instanceof Int16Array?s=e.SHORT:r instanceof Uint32Array?s=e.UNSIGNED_INT:r instanceof Int32Array?s=e.INT:r instanceof Int8Array?s=e.BYTE:(r instanceof Uint8Array||r instanceof Uint8ClampedArray)&&(s=e.UNSIGNED_BYTE),{buffer:a,type:s,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version}}(t,r)):o.version<t.version&&(!function(t,i,r){const o=i.array,a=i.updateRange;e.bindBuffer(r,t),-1===a.count?e.bufferSubData(r,0,o):(n?e.bufferSubData(r,a.offset*o.BYTES_PER_ELEMENT,o,a.offset,a.count):e.bufferSubData(r,a.offset*o.BYTES_PER_ELEMENT,o.subarray(a.offset,a.offset+a.count)),a.count=-1)}(o.buffer,t,r),o.version=t.version)}}}class ra extends Eo{constructor(e=1,t=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const r=e/2,o=t/2,a=Math.floor(n),s=Math.floor(i),l=a+1,c=s+1,u=e/a,h=t/s,d=[],p=[],f=[],m=[];for(let e=0;e<c;e++){const t=e*h-o;for(let n=0;n<l;n++){const i=n*u-r;p.push(i,-t,0),f.push(0,0,1),m.push(n/a),m.push(1-e/s)}}for(let e=0;e<s;e++)for(let t=0;t<a;t++){const n=t+l*e,i=t+l*(e+1),r=t+1+l*(e+1),o=t+1+l*e;d.push(n,i,o),d.push(i,r,o)}this.setIndex(d),this.setAttribute("position",new co(p,3)),this.setAttribute("normal",new co(f,3)),this.setAttribute("uv",new co(m,2))}}const oa={alphamap_fragment:"\n#ifdef USE_ALPHAMAP\n\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n",alphamap_pars_fragment:"\n#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n",alphatest_fragment:"\n#ifdef ALPHATEST\n\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n\n#endif\n",aomap_fragment:"\n#ifdef USE_AOMAP\n\n\t// reads channel R, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\n\t#endif\n\n#endif\n",aomap_pars_fragment:"\n#ifdef USE_AOMAP\n\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n\n#endif\n",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n\n#ifdef USE_TANGENT\n\n\tvec3 objectTangent = vec3( tangent.xyz );\n\n#endif\n",bsdfs:'\n\n// Analytical approximation of the DFG LUT, one half of the\n// split-sum approximation used in indirect specular lighting.\n// via \'environmentBRDF\' from "Physically Based Shading on Mobile"\n// https://www.unrealengine.com/blog/physically-based-shading-on-mobile - environmentBRDF for GGX on mobile\nvec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\n\tvec4 r = roughness * c0 + c1;\n\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n\n}\n\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\n\t// based upon Frostbite 3 Moving to Physically-based Rendering\n\t// page 32, equation 26: E[window1]\n\t// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\n\t// this is intended to be used on spot and point lights who are represented as luminous intensity\n\t// but who must be converted to luminous irradiance for surface lighting calculation\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\n\tif( cutoffDistance > 0.0 ) {\n\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\n\t}\n\n\treturn distanceFalloff;\n\n#else\n\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\n\t}\n\n\treturn 1.0;\n\n#endif\n\n}\n\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\n\treturn RECIPROCAL_PI * diffuseColor;\n\n} // validated\n\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\n\t// Original approximation by Christophe Schlick \'94\n\t// float fresnel = pow( 1.0 - dotLH, 5.0 );\n\n\t// Optimized variant (presented by Epic at SIGGRAPH \'13)\n\t// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n\n} // validated\n\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\n\t// See F_Schlick\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\n\treturn Fr * fresnel + F0;\n\n}\n\n\n// Microfacet Models for Refraction through Rough Surfaces - equation (34)\n// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html\n// alpha is "roughness squared" in Disneys reparameterization\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\n\t// geometry term (normalized) = G(l)G(v) / 4(nl)(nv)\n\t// also see #12151\n\n\tfloat a2 = pow2( alpha );\n\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\n\treturn 1.0 / ( gl * gv );\n\n} // validated\n\n// Moving Frostbite to Physically Based Rendering 3.0 - page 12, listing 2\n// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\n\tfloat a2 = pow2( alpha );\n\n\t// dotNL and dotNV are explicitly swapped. This is not a mistake.\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\n\treturn 0.5 / max( gv + gl, EPSILON );\n\n}\n\n// Microfacet Models for Refraction through Rough Surfaces - equation (33)\n// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html\n// alpha is "roughness squared" in Disneys reparameterization\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\n\tfloat a2 = pow2( alpha );\n\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; // avoid alpha = 0 with dotNH = 1\n\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n\n}\n\n// GGX Distribution, Schlick Fresnel, GGX-Smith Visibility\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\n\tfloat alpha = pow2( roughness ); // UE4\'s roughness\n\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\n\tfloat D = D_GGX( alpha, dotNH );\n\n\treturn F * ( G * D );\n\n} // validated\n\n// Rect Area Light\n\n// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines\n// by Eric Heitz, Jonathan Dupuy, Stephen Hill and David Neubelt\n// code: https://github.com/selfshadow/ltc_code/\n\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\n\tfloat dotNV = saturate( dot( N, V ) );\n\n\t// texture parameterized by sqrt( GGX alpha ) and sqrt( 1 - cos( theta ) )\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\n\treturn uv;\n\n}\n\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\n\t// Real-Time Area Lighting: a Journey from Research to Production (p.102)\n\t// An approximation of the form factor of a horizon-clipped rectangle.\n\n\tfloat l = length( f );\n\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n\n}\n\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\n\tfloat x = dot( v1, v2 );\n\n\tfloat y = abs( x );\n\n\t// rational polynomial approximation to theta / sin( theta ) / 2PI\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\n\treturn cross( v1, v2 ) * theta_sintheta;\n\n}\n\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\n\t// bail if point is on back side of plane of light\n\t// assumes ccw winding order of light vertices\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\n\t// construct orthonormal basis around N\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 ); // negated from paper; possibly due to a different handedness of world coordinate system\n\n\t// compute transform\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\n\t// transform rect\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\n\t// project rect onto sphere\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\n\t// calculate vector form factor\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\n\t// adjust for horizon clipping\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\n/*\n\t// alternate method of adjusting for horizon clipping (see referece)\n\t// refactoring required\n\tfloat len = length( vectorFormFactor );\n\tfloat z = vectorFormFactor.z / len;\n\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\n\t// tabulated horizon-clipped sphere, apparently...\n\tvec2 uv = vec2( z * 0.5 + 0.5, len );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\n\tfloat scale = texture2D( ltc_2, uv ).w;\n\n\tfloat result = len * scale;\n*/\n\n\treturn vec3( result );\n\n}\n\n// End Rect Area Light\n\n// ref: https://www.unrealengine.com/blog/physically-based-shading-on-mobile - environmentBRDF for GGX on mobile\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\n\treturn specularColor * brdf.x + brdf.y;\n\n} // validated\n\n// Fdez-Agera\'s "Multiple-Scattering Microfacet Model for Real-Time Image Based Lighting"\n// Approximates multiscattering in order to preserve energy.\n// http://www.jcgt.org/published/0008/01/03/\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619; // 1/21\n\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n\n}\n\nfloat G_BlinnPhong_Implicit( /* const in float dotNL, const in float dotNV */ ) {\n\n\t// geometry term is (n dot l)(n dot v) / 4(n dot l)(n dot v)\n\treturn 0.25;\n\n}\n\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n\n}\n\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\n\t//float dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\t//float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\n\tfloat G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );\n\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\n\treturn F * ( G * D );\n\n} // validated\n\n// source: http://simonstechblog.blogspot.ca/2011/12/microfacet-brdf.html\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\n\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n\n#if defined( USE_SHEEN )\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs#L94\nfloat D_Charlie(float roughness, float NoH) {\n\t// Estevez and Kulla 2017, "Production Friendly Microfacet Sheen BRDF"\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125); // 2^(-14/2), so sin2h^2 > 0 in fp16\n\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs#L136\nfloat V_Neubelt(float NoV, float NoL) {\n\t// Neubelt and Pettineo 2013, "Crafting a Next-gen Material Pipeline for The Order: 1886"\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\n\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n\n}\n\n#endif\n',bumpmap_pars_fragment:"\n#ifdef USE_BUMPMAP\n\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\n\t// Bump Mapping Unparametrized Surfaces on the GPU by Morten S. Mikkelsen\n\t// http://api.unrealengine.com/attachments/Engine/Rendering/LightingAndShadows/BumpMappingWithoutTangentSpace/mm_sfgrad_bump.pdf\n\n\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n\tvec2 dHdxy_fwd() {\n\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n\t\treturn vec2( dBx, dBy );\n\n\t}\n\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\n\t\t// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\n\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\t\t// normalized\n\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\n\t}\n\n#endif\n",clipping_planes_fragment:"\n#if NUM_CLIPPING_PLANES > 0\n\n\tvec4 plane;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\n\t\tbool clipped = true;\n\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\n\t\t}\n\t\t#pragma unroll_loop_end\n\n\t\tif ( clipped ) discard;\n\n\t#endif\n\n#endif\n",clipping_planes_pars_fragment:"\n#if NUM_CLIPPING_PLANES > 0\n\n\tvarying vec3 vClipPosition;\n\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n\n#endif\n",clipping_planes_pars_vertex:"\n#if NUM_CLIPPING_PLANES > 0\n\n\tvarying vec3 vClipPosition;\n\n#endif\n",clipping_planes_vertex:"\n#if NUM_CLIPPING_PLANES > 0\n\n\tvClipPosition = - mvPosition.xyz;\n\n#endif\n",color_fragment:"\n#if defined( USE_COLOR_ALPHA )\n\n\tdiffuseColor *= vColor;\n\n#elif defined( USE_COLOR )\n\n\tdiffuseColor.rgb *= vColor;\n\n#endif\n",color_pars_fragment:"\n#if defined( USE_COLOR_ALPHA )\n\n\tvarying vec4 vColor;\n\n#elif defined( USE_COLOR )\n\n\tvarying vec3 vColor;\n\n#endif\n",color_pars_vertex:"\n#if defined( USE_COLOR_ALPHA )\n\n\tvarying vec4 vColor;\n\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\n\tvarying vec3 vColor;\n\n#endif\n",color_vertex:"\n#if defined( USE_COLOR_ALPHA )\n\n\tvColor = vec4( 1.0 );\n\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\n\tvColor = vec3( 1.0 );\n\n#endif\n\n#ifdef USE_COLOR\n\n\tvColor *= color;\n\n#endif\n\n#ifdef USE_INSTANCING_COLOR\n\n\tvColor.xyz *= instanceColor.xyz;\n\n#endif\n",common:"\n#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n\n#ifndef saturate\n// <tonemapping_pars_fragment> may have defined saturate() already\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\n\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\n// expects values in the range of [0,1]x[0,1], returns values in the [0,1] range.\n// do not collapse into a single function per: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\n\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\n\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\n\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n}\n\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t// dir can be either a direction vector or a normal vector\n\t// upper-left 3x3 of matrix is assumed to be orthogonal\n\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n\n}\n\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\n\treturn - distance * planeNormal + point;\n\n}\n\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n\n}\n\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n\n}\n\nmat3 transposeMat3( const in mat3 m ) {\n\n\tmat3 tmp;\n\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\n\treturn tmp;\n\n}\n\n// https://en.wikipedia.org/wiki/Relative_luminance\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\n\treturn dot( weights, color.rgb );\n\n}\n\nbool isPerspectiveMatrix( mat4 m ) {\n\n\treturn m[ 2 ][ 3 ] == - 1.0;\n\n}\n\nvec2 equirectUv( in vec3 dir ) {\n\n\t// dir is assumed to be unit length\n\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\n\treturn vec2( u, v );\n\n}\n",cube_uv_reflection_fragment:"\n#ifdef ENVMAP_TYPE_CUBE_UV\n\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\n\t// These shader functions convert between the UV coordinates of a single face of\n\t// a cubemap, the 0-5 integer index of a cube face, and the direction vector for\n\t// sampling a textureCube (not generally normalized ).\n\n\tfloat getFace( vec3 direction ) {\n\n\t\tvec3 absDirection = abs( direction );\n\n\t\tfloat face = - 1.0;\n\n\t\tif ( absDirection.x > absDirection.z ) {\n\n\t\t\tif ( absDirection.x > absDirection.y )\n\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\n\t\t\telse\n\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\n\t\t} else {\n\n\t\t\tif ( absDirection.z > absDirection.y )\n\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\n\t\t\telse\n\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\n\t\t}\n\n\t\treturn face;\n\n\t}\n\n\t// RH coordinate system; PMREM face-indexing convention\n\tvec2 getUV( vec3 direction, float face ) {\n\n\t\tvec2 uv;\n\n\t\tif ( face == 0.0 ) {\n\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x ); // pos x\n\n\t\t} else if ( face == 1.0 ) {\n\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y ); // pos y\n\n\t\t} else if ( face == 2.0 ) {\n\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z ); // pos z\n\n\t\t} else if ( face == 3.0 ) {\n\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x ); // neg x\n\n\t\t} else if ( face == 4.0 ) {\n\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y ); // neg y\n\n\t\t} else {\n\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z ); // neg z\n\n\t\t}\n\n\t\treturn 0.5 * ( uv + 1.0 );\n\n\t}\n\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\n\t\tfloat face = getFace( direction );\n\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\n\t\tfloat faceSize = exp2( mipInt );\n\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\n\t\tvec2 f = fract( uv );\n\n\t\tuv += 0.5 - f;\n\n\t\tif ( face > 2.0 ) {\n\n\t\t\tuv.y += faceSize;\n\n\t\t\tface -= 3.0;\n\n\t\t}\n\n\t\tuv.x += face * faceSize;\n\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\n\t\t}\n\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\n\t\tuv *= texelSize;\n\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\n\t\tuv.x += texelSize;\n\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\n\t\tuv.y += texelSize;\n\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\n\t\tuv.x -= texelSize;\n\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\n\t\tvec3 tm = mix( tl, tr, f.x );\n\n\t\tvec3 bm = mix( bl, br, f.x );\n\n\t\treturn mix( tm, bm, f.y );\n\n\t}\n\n\t// These defines must match with PMREMGenerator\n\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\n\tfloat roughnessToMip( float roughness ) {\n\n\t\tfloat mip = 0.0;\n\n\t\tif ( roughness >= r1 ) {\n\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\n\t\t} else if ( roughness >= r4 ) {\n\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\n\t\t} else if ( roughness >= r5 ) {\n\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\n\t\t} else if ( roughness >= r6 ) {\n\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\n\t\t} else {\n\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness ); // 1.16 = 1.79^0.25\n\t\t}\n\n\t\treturn mip;\n\n\t}\n\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\n\t\tfloat mipF = fract( mip );\n\n\t\tfloat mipInt = floor( mip );\n\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\n\t\tif ( mipF == 0.0 ) {\n\n\t\t\treturn vec4( color0, 1.0 );\n\n\t\t} else {\n\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\n\t\t}\n\n\t}\n\n#endif\n",defaultnormal_vertex:"\nvec3 transformedNormal = objectNormal;\n\n#ifdef USE_INSTANCING\n\n\t// this is in lieu of a per-instance normal-matrix\n\t// shear transforms in the instance matrix are not supported\n\n\tmat3 m = mat3( instanceMatrix );\n\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\n\ttransformedNormal = m * transformedNormal;\n\n#endif\n\ntransformedNormal = normalMatrix * transformedNormal;\n\n#ifdef FLIP_SIDED\n\n\ttransformedNormal = - transformedNormal;\n\n#endif\n\n#ifdef USE_TANGENT\n\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\n\t#ifdef FLIP_SIDED\n\n\t\ttransformedTangent = - transformedTangent;\n\n\t#endif\n\n#endif\n",displacementmap_pars_vertex:"\n#ifdef USE_DISPLACEMENTMAP\n\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n\n#endif\n",displacementmap_vertex:"\n#ifdef USE_DISPLACEMENTMAP\n\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n\n#endif\n",emissivemap_fragment:"\n#ifdef USE_EMISSIVEMAP\n\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n\n#endif\n",emissivemap_pars_fragment:"\n#ifdef USE_EMISSIVEMAP\n\n\tuniform sampler2D emissiveMap;\n\n#endif\n",encodings_fragment:"\ngl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\n// For a discussion of what this is, please read this: http://lousodrome.net/blog/light/2013/05/26/gamma-correct-and-hdr-rendering-in-a-32-bits-buffer/\n\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\n\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\n\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\n\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\n\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\n\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\n\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n\t// return vec4( value.brg, ( 3.0 + 128.0 ) / 256.0 );\n}\n\n// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\n\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\n\n// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\n\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\t// NOTE: The implementation with min causes the shader to not compile on\n\t// a common Alcatel A502DL in Chrome 78/Android 8.1. Some research suggests \n\t// that the chipset is Mediatek MT6739 w/ IMG PowerVR GE8100 GPU.\n\t// D = min( floor( D ) / 255.0, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\n\n// LogLuv reference: http://graphicrants.blogspot.ca/2009/04/rgbm-color-encoding.html\n\n// M matrix, for encoding\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\n\n// Inverse M matrix, for decoding\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}\n",envmap_fragment:"\n#ifdef USE_ENVMAP\n\n\t#ifdef ENV_WORLDPOS\n\n\t\tvec3 cameraToFrag;\n\n\t\tif ( isOrthographic ) {\n\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\n\t\t} else {\n\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\n\t\t}\n\n\t\t// Transforming Normal Vectors with the Inverse Transformation\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\n\t\t#else\n\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#else\n\n\t\tvec3 reflectVec = vReflect;\n\n\t#endif\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\n\t#else\n\n\t\tvec4 envColor = vec4( 0.0 );\n\n\t#endif\n\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\n\t\tenvColor = envMapTexelToLinear( envColor );\n\n\t#endif\n\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\n\t#endif\n\n#endif\n",envmap_common_pars_fragment:"\n#ifdef USE_ENVMAP\n\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif\n",envmap_pars_fragment:"\n#ifdef USE_ENVMAP\n\n\tuniform float reflectivity;\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\t#define ENV_WORLDPOS\n\n\t#endif\n\n\t#ifdef ENV_WORLDPOS\n\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n\n#endif\n",envmap_pars_vertex:"\n#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\n\t\t#define ENV_WORLDPOS\n\n\t#endif\n\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\n\t#else\n\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\n\t#endif\n\n#endif\n",envmap_physical_pars_fragment:"\n#if defined( USE_ENVMAP )\n\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\n\tvec3 getLightProbeIndirectIrradiance( /*const in SpecularLightProbe specularLightProbe,*/ const in GeometricContext geometry, const in int maxMIPLevel ) {\n\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\n\t\t\t// TODO: replace with properly filtered cubemaps and access the irradiance LOD level, be it the last LOD level\n\t\t\t// of a specular cubemap, or just the default level of a specially created irradiance cubemap.\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\n\t\t\t#else\n\n\t\t\t\t// force the bias high to get the last LOD level as it is the most blurred.\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\n\t\t#else\n\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\n\t\t#endif\n\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\n\t}\n\n\t// Trowbridge-Reitz distribution to Mip level, following the logic of http://casual-effects.blogspot.ca/2011/08/plausible-environment-lighting-in-two.html\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\n\t\t// clamp to allowable LOD ranges.\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\n\t}\n\n\tvec3 getLightProbeIndirectRadiance( /*const in SpecularLightProbe specularLightProbe,*/ const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvec3 reflectVec = reflect( -viewDir, normal );\n\n\t\t\t// Mixing the reflection with the normal is more accurate and keeps rough objects from gathering light from behind their tangent plane.\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\n\t\t#else\n\n\t\t\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\n\t\t#endif\n\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\n\t\t\t#else\n\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\n\t\t#endif\n\n\t\treturn envMapColor.rgb * envMapIntensity;\n\n\t}\n\n#endif\n",envmap_vertex:"\n#ifdef USE_ENVMAP\n\n\t#ifdef ENV_WORLDPOS\n\n\t\tvWorldPosition = worldPosition.xyz;\n\n\t#else\n\n\t\tvec3 cameraToVertex;\n\n\t\tif ( isOrthographic ) {\n\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\n\t\t} else {\n\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n\t\t}\n\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\n\t\t#else\n\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#endif\n\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\n\n\tfogDepth = - mvPosition.z;\n\n#endif\n",fog_pars_vertex:"\n#ifdef USE_FOG\n\n\tvarying float fogDepth;\n\n#endif\n",fog_fragment:"\n#ifdef USE_FOG\n\n\t#ifdef FOG_EXP2\n\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\n\t#else\n\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\n\t#endif\n\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n\n#endif\n",fog_pars_fragment:"\n#ifdef USE_FOG\n\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\n\t#ifdef FOG_EXP2\n\n\t\tuniform float fogDensity;\n\n\t#else\n\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\n\t#endif\n\n#endif\n",gradientmap_pars_fragment:"\n\n#ifdef USE_GRADIENTMAP\n\n\tuniform sampler2D gradientMap;\n\n#endif\n\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\n\t// dotNL will be from -1.0 to 1.0\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\n\t#ifdef USE_GRADIENTMAP\n\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\n\t#else\n\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\n\t#endif\n\n}\n",lightmap_fragment:"\n#ifdef USE_LIGHTMAP\n\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity; // factor of PI should not be present; included here to prevent breakage\n\n#endif\n",lightmap_pars_fragment:"\n#ifdef USE_LIGHTMAP\n\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n\n#endif\n",lights_lambert_vertex:"\nvec3 diffuse = vec3( 1.0 );\n\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\n\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\n\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\n\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\n\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n\n#ifdef DOUBLE_SIDED\n\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n\n#endif\n\n#if NUM_POINT_LIGHTS > 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if NUM_SPOT_LIGHTS > 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n/*\n#if NUM_RECT_AREA_LIGHTS > 0\n\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\n\t\t// TODO (abelnation): implement\n\n\t}\n\n#endif\n*/\n\n#if NUM_DIR_LIGHTS > 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if NUM_HEMI_LIGHTS > 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\n\t\t#endif\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n",lights_pars_begin:"\nuniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\n\n// get the irradiance (radiance convolved with cosine lobe) at the point 'normal' on the unit sphere\n// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\n\t// normal is assumed to have unit length\n\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\n\t// band 0\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\n\t// band 1\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\n\t// band 2\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\n\treturn result;\n\n}\n\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\n\treturn irradiance;\n\n}\n\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\n\tvec3 irradiance = ambientLightColor;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI;\n\n\t#endif\n\n\treturn irradiance;\n\n}\n\n#if NUM_DIR_LIGHTS > 0\n\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\n\t}\n\n#endif\n\n\n#if NUM_POINT_LIGHTS > 0\n\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\n\t// directLight is an out parameter as having it as a return value caused compiler errors on some devices\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\n\t\tfloat lightDistance = length( lVector );\n\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\n\t}\n\n#endif\n\n\n#if NUM_SPOT_LIGHTS > 0\n\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\n\t// directLight is an out parameter as having it as a return value caused compiler errors on some devices\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\n\t\tif ( angleCos > spotLight.coneCos ) {\n\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\n\t\t} else {\n\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\n\t\t}\n\t}\n\n#endif\n\n\n#if NUM_RECT_AREA_LIGHTS > 0\n\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\n\t// Pre-computed values of LinearTransformedCosine approximation of BRDF\n\t// BRDF approximation Texture is 64x64\n\tuniform sampler2D ltc_1; // RGBA Float\n\tuniform sampler2D ltc_2; // RGBA Float\n\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n\n#endif\n\n\n#if NUM_HEMI_LIGHTS > 0\n\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tirradiance *= PI;\n\n\t\t#endif\n\n\t\treturn irradiance;\n\n\t}\n\n#endif\n",lights_toon_fragment:"\nToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\n",lights_toon_pars_fragment:"\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n\nstruct ToonMaterial {\n\n\tvec3 diffuseColor;\n\n};\n\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI; // punctual light\n\n\t#endif\n\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n\n#define Material_LightProbeLOD( material )\t(0)\n",lights_phong_fragment:"\nBlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n\nstruct BlinnPhongMaterial {\n\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n\n};\n\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI; // punctual light\n\n\t#endif\n\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n\n}\n\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"\nPhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\n\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\n\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.\nmaterial.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n\n#ifdef REFLECTIVITY\n\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), rawDiffuseColor, metalnessFactor );\n\n#else\n\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), rawDiffuseColor, metalnessFactor );\n\n#endif\n\n#ifdef CLEARCOAT\n\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\n\t#ifdef USE_CLEARCOATMAP\n\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\n\t#endif\n\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\n\t#endif\n\n\tmaterial.clearcoat = saturate( material.clearcoat ); // Burley clearcoat model\n\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n\n#endif\n\n#ifdef USE_SHEEN\n\n\tmaterial.sheenColor = sheen;\n\n#endif\n",lights_physical_pars_fragment:"\nstruct PhysicalMaterial {\n\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n\n};\n\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\n\n// Clear coat directional hemishperical reflectance (this approximation should be improved)\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n\n}\n\n#if NUM_RECT_AREA_LIGHTS > 0\n\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight; // counterclockwise; light shines in local neg z direction\n\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\n\t\t// LTC Fresnel Approximation by Stephen Hill\n\t\t// http://blog.selfshadow.com/publications/s2016-advances/s2016_ltc_fresnel.pdf\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\n\t}\n\n#endif\n\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\n\tvec3 irradiance = dotNL * directLight.color;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI; // punctual light\n\n\t#endif\n\n\t#ifdef CLEARCOAT\n\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tccIrradiance *= PI; // punctual light\n\n\t\t#endif\n\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\n\t#else\n\n\t\tfloat clearcoatDHR = 0.0;\n\n\t#endif\n\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\n\t#ifdef CLEARCOAT\n\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\n\t#else\n\n\t\tfloat clearcoatDHR = 0.0;\n\n\t#endif\n\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\n\t// Both indirect specular and indirect diffuse light accumulate here\n\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n\n// ref: https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n\n}\n",lights_fragment_begin:"\n/**\n * This is a template that can be used to light a material, it uses pluggable\n * RenderEquations (RE)for specific lighting scenarios.\n *\n * Instructions for use:\n * - Ensure that both RE_Direct, RE_IndirectDiffuse and RE_IndirectSpecular are defined\n * - If you have defined an RE_IndirectSpecular, you need to also provide a Material_LightProbeLOD. <---- ???\n * - Create a material parameter that is to be passed as the third parameter to your lighting functions.\n *\n * TODO:\n * - Add area light support.\n * - Add sphere light support.\n * - Add diffuse light probe (irradiance cubemap) support.\n */\n\nGeometricContext geometry;\n\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n\n#ifdef CLEARCOAT\n\n\tgeometry.clearcoatNormal = clearcoatNormal;\n\n#endif\n\nIncidentLight directLight;\n\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tpointLight = pointLights[ i ];\n\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tspotLight = spotLights[ i ];\n\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tdirectionalLight = directionalLights[ i ];\n\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\n\tRectAreaLight rectAreaLight;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if defined( RE_IndirectDiffuse )\n\n\tvec3 iblIrradiance = vec3( 0.0 );\n\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\n\t\t}\n\t\t#pragma unroll_loop_end\n\n\t#endif\n\n#endif\n\n#if defined( RE_IndirectSpecular )\n\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n\n#endif\n",lights_fragment_maps:"\n#if defined( RE_IndirectDiffuse )\n\n\t#ifdef USE_LIGHTMAP\n\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tlightMapIrradiance *= PI; // factor of PI should not be present; included here to prevent breakage\n\n\t\t#endif\n\n\t\tirradiance += lightMapIrradiance;\n\n\t#endif\n\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( /*lightProbe,*/ geometry, maxMipLevel );\n\n\t#endif\n\n#endif\n\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\n\tradiance += getLightProbeIndirectRadiance( /*specularLightProbe,*/ geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\n\t#ifdef CLEARCOAT\n\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( /*specularLightProbe,*/ geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\n\t#endif\n\n#endif\n",lights_fragment_end:"\n#if defined( RE_IndirectDiffuse )\n\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n\n#endif\n\n#if defined( RE_IndirectSpecular )\n\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n\n#endif\n",logdepthbuf_fragment:"\n#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\n\t// Doing a strict comparison with == 1.0 can cause noise artifacts\n\t// on some platforms. See issue #17623.\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n\n#endif\n",logdepthbuf_pars_fragment:"\n#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n\n#endif\n",logdepthbuf_pars_vertex:"\n#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\n\t#else\n\n\t\tuniform float logDepthBufFC;\n\n\t#endif\n\n#endif\n",logdepthbuf_vertex:"\n#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\n\t#else\n\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\n\t\t\tgl_Position.z *= gl_Position.w;\n\n\t\t}\n\n\t#endif\n\n#endif\n",map_fragment:"\n#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n\n#endif\n",map_pars_fragment:"\n#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif\n",map_particle_fragment:"\n#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\n#endif\n\n#ifdef USE_MAP\n\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n\n#endif\n\n#ifdef USE_ALPHAMAP\n\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n\n#endif\n",map_particle_pars_fragment:"\n#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\n\tuniform mat3 uvTransform;\n\n#endif\n\n#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif\n\n#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n",metalnessmap_fragment:"\nfloat metalnessFactor = metalness;\n\n#ifdef USE_METALNESSMAP\n\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\n\t// reads channel B, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n\tmetalnessFactor *= texelMetalness.b;\n\n#endif\n",metalnessmap_pars_fragment:"\n#ifdef USE_METALNESSMAP\n\n\tuniform sampler2D metalnessMap;\n\n#endif\n",morphnormal_vertex:"\n#ifdef USE_MORPHNORMALS\n\n\t// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:\n\t// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in normal = sum((target - base) * influence)\n\t// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\n#endif\n",morphtarget_pars_vertex:"\n#ifdef USE_MORPHTARGETS\n\n\tuniform float morphTargetBaseInfluence;\n\n\t#ifndef USE_MORPHNORMALS\n\n\t\tuniform float morphTargetInfluences[ 8 ];\n\n\t#else\n\n\t\tuniform float morphTargetInfluences[ 4 ];\n\n\t#endif\n\n#endif\n",morphtarget_vertex:"\n#ifdef USE_MORPHTARGETS\n\n\t// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:\n\t// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in position = sum((target - base) * influence)\n\t// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\n\t#ifndef USE_MORPHNORMALS\n\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\n\t#endif\n\n#endif\n",normal_fragment_begin:"\nfloat faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n\n#ifdef FLAT_SHADED\n\n\t// Workaround for Adreno GPUs not able to do dFdx( vViewPosition )\n\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n\n#else\n\n\tvec3 normal = normalize( vNormal );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tnormal = normal * faceDirection;\n\n\t#endif\n\n\t#ifdef USE_TANGENT\n\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\n\t\t#endif\n\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\n\t\t#endif\n\n\t#endif\n\n#endif\n\n// non perturbed normal for clearcoat among others\n\nvec3 geometryNormal = normal;\n\n",normal_fragment_maps:"\n\n#ifdef OBJECTSPACE_NORMALMAP\n\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0; // overrides both flatShading and attribute normals\n\n\t#ifdef FLIP_SIDED\n\n\t\tnormal = - normal;\n\n\t#endif\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tnormal = normal * faceDirection;\n\n\t#endif\n\n\tnormal = normalize( normalMatrix * normal );\n\n#elif defined( TANGENTSPACE_NORMALMAP )\n\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\n\t#ifdef USE_TANGENT\n\n\t\tnormal = normalize( vTBN * mapN );\n\n\t#else\n\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );\n\n\t#endif\n\n#elif defined( USE_BUMPMAP )\n\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );\n\n#endif\n",normalmap_pars_fragment:"\n#ifdef USE_NORMALMAP\n\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\n#endif\n\n#ifdef OBJECTSPACE_NORMALMAP\n\n\tuniform mat3 normalMatrix;\n\n#endif\n\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\n\t// Normal Mapping Without Precomputed Tangents\n\t// http://www.thetenthplanet.de/archives/1180\n\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\n\t\t// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\n\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\n\t\tvec3 N = surf_norm; // normalized\n\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\n\t}\n\n#endif\n",clearcoat_normal_fragment_begin:"\n#ifdef CLEARCOAT\n\n\tvec3 clearcoatNormal = geometryNormal;\n\n#endif\n",clearcoat_normal_fragment_maps:"\n#ifdef USE_CLEARCOAT_NORMALMAP\n\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\n\t#ifdef USE_TANGENT\n\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\n\t#else\n\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\n\t#endif\n\n#endif\n",clearcoat_pars_fragment:"\n\n#ifdef USE_CLEARCOATMAP\n\n\tuniform sampler2D clearcoatMap;\n\n#endif\n\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\n\tuniform sampler2D clearcoatRoughnessMap;\n\n#endif\n\n#ifdef USE_CLEARCOAT_NORMALMAP\n\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n\n#endif\n",packing:"\nvec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\n\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\n\nconst float PackUpscale = 256. / 255.; // fraction -> 0..1 (including 1)\nconst float UnpackDownscale = 255. / 256.; // 0..1 -> fraction (excluding 1)\n\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\n\nconst float ShiftRight8 = 1. / 256.;\n\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8; // tidy overflow\n\treturn r * PackUpscale;\n}\n\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\n\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\n\n// NOTE: viewZ/eyeZ is < 0 when in front of the camera per OpenGL conventions\n\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\n\n// NOTE: https://twitter.com/gonnavis/status/1377183786949959682\n\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"\n#ifdef PREMULTIPLIED_ALPHA\n\n\t// Get get normal blending with premultipled, use with CustomBlending, OneFactor, OneMinusSrcAlphaFactor, AddEquation.\n\tgl_FragColor.rgb *= gl_FragColor.a;\n\n#endif\n",project_vertex:"\nvec4 mvPosition = vec4( transformed, 1.0 );\n\n#ifdef USE_INSTANCING\n\n\tmvPosition = instanceMatrix * mvPosition;\n\n#endif\n\nmvPosition = modelViewMatrix * mvPosition;\n\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"\n#ifdef DITHERING\n\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n\n#endif\n",dithering_pars_fragment:"\n#ifdef DITHERING\n\n\t// based on https://www.shadertoy.com/view/MslGR8\n\tvec3 dithering( vec3 color ) {\n\t\t//Calculate grid position\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\n\t\t//Shift the individual colors differently, thus making it even harder to see the dithering pattern\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\n\t\t//modify shift acording to grid position.\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\n\t\t//shift the color by dither_shift\n\t\treturn color + dither_shift_RGB;\n\t}\n\n#endif\n",roughnessmap_fragment:"\nfloat roughnessFactor = roughness;\n\n#ifdef USE_ROUGHNESSMAP\n\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\n\t// reads channel G, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n\troughnessFactor *= texelRoughness.g;\n\n#endif\n",roughnessmap_pars_fragment:"\n#ifdef USE_ROUGHNESSMAP\n\n\tuniform sampler2D roughnessMap;\n\n#endif\n",shadowmap_pars_fragment:"\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): create uniforms for area light shadows\n\n\t#endif\n\t*/\n\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\n\t}\n\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\n\t}\n\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\n\t\tfloat occlusion = 1.0;\n\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\n\t\tfloat hard_shadow = step( compare , distribution.x ); // Hard Shadow\n\n\t\tif (hard_shadow != 1.0 ) {\n\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality\n\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed\n\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\n\t\t}\n\t\treturn occlusion;\n\n\t}\n\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\n\t\tfloat shadow = 1.0;\n\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\n\t\t// if ( something && something ) breaks ATI OpenGL shader compiler\n\t\t// if ( all( something, something ) ) using this instead\n\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n\t\tbool frustumTest = all( frustumTestVec );\n\n\t\tif ( frustumTest ) {\n\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n\t\t#else // no percentage-closer filtering:\n\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n\t\t#endif\n\n\t\t}\n\n\t\treturn shadow;\n\n\t}\n\n\t// cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D\n\t// vector suitable for 2D texture mapping. This code uses the following layout for the\n\t// 2D texture:\n\t//\n\t// xzXZ\n\t//  y Y\n\t//\n\t// Y - Positive y direction\n\t// y - Negative y direction\n\t// X - Positive x direction\n\t// x - Negative x direction\n\t// Z - Positive z direction\n\t// z - Negative z direction\n\t//\n\t// Source and test bed:\n\t// https://gist.github.com/tschw/da10c43c467ce8afd0c4\n\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\n\t\t// Number of texels to avoid at the edge of each square\n\n\t\tvec3 absV = abs( v );\n\n\t\t// Intersect unit cube\n\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\n\t\t// Apply scale to avoid seams\n\n\t\t// two texels less per square (one texel will do for NEAREST)\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\n\t\t// Unwrap\n\n\t\t// space: -1 ... 1 range for each square\n\t\t//\n\t\t// #X##\t\tdim    := ( 4 , 2 )\n\t\t//  # #\t\tcenter := ( 1 , 1 )\n\n\t\tvec2 planar = v.xy;\n\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\n\t\tif ( absV.z >= almostOne ) {\n\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\n\t\t} else if ( absV.x >= almostOne ) {\n\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\n\t\t} else if ( absV.y >= almostOne ) {\n\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\n\t\t}\n\n\t\t// Transform to UV space\n\n\t\t// scale := 0.5 / dim\n\t\t// translate := ( center + 0.5 ) / dim\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\n\t}\n\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\n\t\t// for point lights, the uniform @vShadowCoord is re-purposed to hold\n\t\t// the vector from the light to the world-space position of the fragment.\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\n\t\t// dp = normalized distance from light to fragment position\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?\n\t\tdp += shadowBias;\n\n\t\t// bd3D = base direction 3D\n\t\tvec3 bd3D = normalize( lightToPosition );\n\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\n\t\t#else // no percentage-closer filtering\n\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\n\t\t#endif\n\n\t}\n\n#endif\n",shadowmap_pars_vertex:"\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): uniforms for area light shadows\n\n\t#endif\n\t*/\n\n#endif\n",shadowmap_vertex:"\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\n\t\t// Offsetting the position used for querying occlusion along the world normal can be used to reduce shadow acne.\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\n\t#endif\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): update vAreaShadowCoord with area light info\n\n\t#endif\n\t*/\n\n#endif\n",shadowmask_pars_fragment:"\nfloat getShadowMask() {\n\n\tfloat shadow = 1.0;\n\n\t#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\tDirectionalLightShadow directionalLight;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\tSpotLightShadow spotLight;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\tPointLightShadow pointLight;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): update shadow for Area light\n\n\t#endif\n\t*/\n\n\t#endif\n\n\treturn shadow;\n\n}\n",skinbase_vertex:"\n#ifdef USE_SKINNING\n\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif\n",skinning_pars_vertex:"\n#ifdef USE_SKINNING\n\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\n\t#ifdef BONE_TEXTURE\n\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\n\t\t\ty = dy * ( y + 0.5 );\n\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\n\t\t\treturn bone;\n\n\t\t}\n\n\t#else\n\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\n\t\t}\n\n\t#endif\n\n#endif\n",skinning_vertex:"\n#ifdef USE_SKINNING\n\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n\n#endif\n",skinnormal_vertex:"\n#ifdef USE_SKINNING\n\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\n\t#ifdef USE_TANGENT\n\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\n\t#endif\n\n#endif\n",specularmap_fragment:"\nfloat specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n\n#else\n\n\tspecularStrength = 1.0;\n\n#endif\n",specularmap_pars_fragment:"\n#ifdef USE_SPECULARMAP\n\n\tuniform sampler2D specularMap;\n\n#endif\n",tonemapping_fragment:"\n#if defined( TONE_MAPPING )\n\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n\n#endif\n",tonemapping_pars_fragment:"\n#ifndef saturate\n// <common> may have defined saturate() already\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n\nuniform float toneMappingExposure;\n\n// exposure only\nvec3 LinearToneMapping( vec3 color ) {\n\n\treturn toneMappingExposure * color;\n\n}\n\n// source: https://www.cs.utah.edu/~reinhard/cdrom/\nvec3 ReinhardToneMapping( vec3 color ) {\n\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n\n}\n\n// source: http://filmicworlds.com/blog/filmic-tonemapping-operators/\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\n\t// optimized filmic operator by Jim Hejl and Richard Burgess-Dawson\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n\n}\n\n// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs\nvec3 RRTAndODTFit( vec3 v ) {\n\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n\n}\n\n// this implementation of ACES is modified to accommodate a brighter viewing environment.\n// the scale factor of 1/0.6 is subjective. see discussion in #19621.\n\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\n\t// sRGB => XYZ => D65_2_D60 => AP1 => RRT_SAT\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ), // transposed from source\n\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\n\t// ODT_SAT => XYZ => D60_2_D65 => sRGB\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ), // transposed from source\n\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\n\tcolor *= toneMappingExposure / 0.6;\n\n\tcolor = ACESInputMat * color;\n\n\t// Apply RRT and ODT\n\tcolor = RRTAndODTFit( color );\n\n\tcolor = ACESOutputMat * color;\n\n\t// Clamp to [0, 1]\n\treturn saturate( color );\n\n}\n\nvec3 CustomToneMapping( vec3 color ) { return color; }\n",transmission_fragment:"\n#ifdef USE_TRANSMISSION\n\n\t#ifdef USE_TRANSMISSIONMAP\n\n\t\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n\n\t#endif\n\n\t#ifdef USE_THICKNESSNMAP\n\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\n\t#endif\n\n\tvec3 pos = vWorldPosition.xyz / vWorldPosition.w;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n\tfloat ior = ( 1.0 + 0.4 * reflectivity ) / ( 1.0 - 0.4 * reflectivity );\n\n\t// From https://google.github.io/filament/Filament.html#materialsystem/parameterization/remapping\n\tvec3 f0 = vec3( pow( ior - 1.0, 2.0 ) / pow( ior + 1.0, 2.0 ) );\n\tvec3 f90 = vec3( 1.0 );\n\n\tvec3 f_transmission = totalTransmission * getIBLVolumeRefraction(\n\t\tnormal, v, viewDir, roughnessFactor, diffuseColor.rgb, f0, f90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance);\n\n\tdiffuseColor.rgb = mix( diffuseColor.rgb, f_transmission, totalTransmission );\n\n#endif\n",transmission_pars_fragment:"\n#ifdef USE_TRANSMISSION\n\n\t// Transmission code is based on glTF-Sampler-Viewer\n\t// https://github.com/KhronosGroup/glTF-Sample-Viewer\n\n\t#ifdef USE_TRANSMISSIONMAP\n\n\t\tuniform sampler2D transmissionMap;\n\n\t#endif\n\n\t#ifdef USE_THICKNESSMAP\n\n\t\tuniform sampler2D thicknessMap;\n\n\t#endif\n\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\n\tvarying vec4 vWorldPosition;\n\n\tvec3 getVolumeTransmissionRay(vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix) {\n\t\t// Direction of refracted light.\n\t\tvec3 refractionVector = refract(-v, normalize(n), 1.0 / ior);\n\n\t\t// Compute rotation-independant scaling of the model matrix.\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length(vec3(modelMatrix[0].xyz));\n\t\tmodelScale.y = length(vec3(modelMatrix[1].xyz));\n\t\tmodelScale.z = length(vec3(modelMatrix[2].xyz));\n\n\t\t// The thickness is specified in local space.\n\t\treturn normalize(refractionVector) * thickness * modelScale;\n\t}\n\n\tfloat applyIorToRoughness(float roughness, float ior) {\n\t\t// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and\n\t\t// an IOR of 1.5 results in the default amount of microfacet refraction.\n\t\treturn roughness * clamp(ior * 2.0 - 2.0, 0.0, 1.0);\n\t}\n\n\tvec3 getTransmissionSample(vec2 fragCoord, float roughness, float ior) {\n\t\tfloat framebufferLod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness, ior);\n\t\treturn texture2DLodEXT(transmissionSamplerMap, fragCoord.xy, framebufferLod).rgb;\n\t}\n\n\tvec3 applyVolumeAttenuation(vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance) {\n\t\tif (attenuationDistance == 0.0) {\n\t\t\t// Attenuation distance is + (which we indicate by zero), i.e. the transmitted color is not attenuated at all.\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\t// Compute light attenuation using Beer's law.\n\t\t\tvec3 attenuationCoefficient = -log(attenuationColor) / attenuationDistance;\n\t\t\tvec3 transmittance = exp(-attenuationCoefficient * transmissionDistance); // Beer's law\n\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\n\tvec3 getIBLVolumeRefraction(vec3 n, vec3 v, vec3 viewDir, float perceptualRoughness, vec3 baseColor, vec3 f0, vec3 f90,\n\t\tvec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec3 attenuationColor, float attenuationDistance) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay(n, v, thickness, ior, modelMatrix);\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\n\t\t// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4(refractedRayExit, 1.0);\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\n\t\t// Sample framebuffer to get pixel the refracted ray hits.\n\t\tvec3 transmittedLight = getTransmissionSample(refractionCoords, perceptualRoughness, ior);\n\n\t\tvec3 attenuatedColor = applyVolumeAttenuation(transmittedLight, length(transmissionRay), attenuationColor, attenuationDistance);\n\n\t\tfloat NdotV = saturate(dot(n, viewDir));\n\t\tvec2 brdf = integrateSpecularBRDF(NdotV, perceptualRoughness);\n\t\tvec3 specularColor = f0 * brdf.x + f90 * brdf.y;\n\n\t\treturn (1.0 - specularColor) * attenuatedColor * baseColor;\n\t}\n#endif\n",uv_pars_fragment:"\n#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\n\tvarying vec2 vUv;\n\n#endif\n",uv_pars_vertex:"\n#ifdef USE_UV\n\n\t#ifdef UVS_VERTEX_ONLY\n\n\t\tvec2 vUv;\n\n\t#else\n\n\t\tvarying vec2 vUv;\n\n\t#endif\n\n\tuniform mat3 uvTransform;\n\n#endif\n",uv_vertex:"\n#ifdef USE_UV\n\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\n#endif\n",uv2_pars_fragment:"\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvarying vec2 vUv2;\n\n#endif\n",uv2_pars_vertex:"\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\n\tuniform mat3 uv2Transform;\n\n#endif\n",uv2_vertex:"\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n\n#endif\n",worldpos_vertex:"\n#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\n\t#ifdef USE_INSTANCING\n\n\t\tworldPosition = instanceMatrix * worldPosition;\n\n\t#endif\n\n\tworldPosition = modelMatrix * worldPosition;\n\n#endif\n",background_frag:"\nuniform sampler2D t2D;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n\tvec4 texColor = texture2D( t2D, vUv );\n\n\tgl_FragColor = mapTexelToLinear( texColor );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n",background_vert:"\nvarying vec2 vUv;\nuniform mat3 uvTransform;\n\nvoid main() {\n\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n\n}\n",cube_frag:"\n#include <envmap_common_pars_fragment>\nuniform float opacity;\n\nvarying vec3 vWorldDirection;\n\n#include <cube_uv_reflection_fragment>\n\nvoid main() {\n\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n",cube_vert:"\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\n\tgl_Position.z = gl_Position.w; // set z to camera.far\n\n}\n",depth_frag:"\n#if DEPTH_PACKING == 3200\n\n\tuniform float opacity;\n\n#endif\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvarying vec2 vHighPrecisionZW;\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tdiffuseColor.a = opacity;\n\n\t#endif\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\t#include <logdepthbuf_fragment>\n\n\t// Higher precision equivalent of gl_FragCoord.z. This assumes depthRange has been left to its default values.\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\n\t#elif DEPTH_PACKING == 3201\n\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\n\t#endif\n\n}\n",depth_vert:"\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\n// This is used for computing an equivalent of gl_FragCoord.z that is as high precision as possible.\n// Some platforms compute gl_FragCoord at a lower precision which makes the manually computed value better for\n// depth-based postprocessing effects. Reproduced on iPad with A10 processor / iPadOS 13.3.1.\nvarying vec2 vHighPrecisionZW;\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_DISPLACEMENTMAP\n\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvHighPrecisionZW = gl_Position.zw;\n\n}\n",distanceRGBA_frag:"\n#define DISTANCE\n\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main () {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist ); // clamp to [ 0, 1 ]\n\n\tgl_FragColor = packDepthToRGBA( dist );\n\n}\n",distanceRGBA_vert:"\n#define DISTANCE\n\nvarying vec3 vWorldPosition;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_DISPLACEMENTMAP\n\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvWorldPosition = worldPosition.xyz;\n\n}\n",equirect_frag:"\nuniform sampler2D tEquirect;\n\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvec3 direction = normalize( vWorldDirection );\n\n\tvec2 sampleUV = equirectUv( direction );\n\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\n\tgl_FragColor = mapTexelToLinear( texColor );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n",equirect_vert:"\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\n}\n",linedashed_frag:"\nuniform vec3 diffuse;\nuniform float opacity;\n\nuniform float dashSize;\nuniform float totalSize;\n\nvarying float vLineDistance;\n\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\n\t\tdiscard;\n\n\t}\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\n\toutgoingLight = diffuseColor.rgb; // simple shader\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\n}\n",linedashed_vert:"\nuniform float scale;\nattribute float lineDistance;\n\nvarying float vLineDistance;\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\tvLineDistance = scale * lineDistance;\n\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n}\n",meshbasic_frag:"\nuniform vec3 diffuse;\nuniform float opacity;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\n\t// accumulation (baked indirect lighting only)\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\n\t#else\n\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\n\t#endif\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",meshbasic_vert:"\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_ENVMAP\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n\n}\n",meshlambert_frag:"\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\n\t#ifdef DOUBLE_SIDED\n\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\n\t#else\n\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\n\t#endif\n\n\t#include <lightmap_fragment>\n\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\n\t#else\n\n\t\treflectedLight.directDiffuse = vLightFront;\n\n\t#endif\n\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\n\t// modulation\n\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"\n#define LAMBERT\n\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshmatcap_frag:"\n#define MATCAP\n\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks\n\n\t#ifdef USE_MATCAP\n\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\n\t#else\n\n\t\tvec4 matcapColor = vec4( 1.0 );\n\n\t#endif\n\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",meshmatcap_vert:"\n#define MATCAP\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\t\tvNormal = normalize( transformedNormal );\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n}\n",meshtoon_frag:"\n#define TOON\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",meshtoon_vert:"\n#define TOON\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",meshphong_frag:"\n#define PHONG\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",meshphong_vert:"\n#define PHONG\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",meshphysical_frag:"\n#define STANDARD\n\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n#endif\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform vec3 attenuationColor;\n\tuniform float attenuationDistance;\n#endif\n\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <transmission_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#ifdef USE_TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t\tfloat thicknessFactor = thickness;\n\t#endif\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\tvec3 rawDiffuseColor = diffuseColor.rgb;\n\n\t#include <transmission_fragment>\n\n\t// accumulation\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",meshphysical_vert:"\n#define STANDARD\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#ifdef USE_TRANSMISSION\n\n\tvarying vec4 vWorldPosition;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n#ifdef USE_TRANSMISSION\n\n\tvWorldPosition = worldPosition;\n\n#endif\n}\n",normal_frag:"\n#define NORMAL\n\nuniform float opacity;\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\n\tvarying vec3 vViewPosition;\n\n#endif\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\n}\n",normal_vert:"\n#define NORMAL\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\n\tvarying vec3 vViewPosition;\n\n#endif\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\n\tvViewPosition = - mvPosition.xyz;\n\n#endif\n\n}\n",points_frag:"\nuniform vec3 diffuse;\nuniform float opacity;\n\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\n\toutgoingLight = diffuseColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\n}\n",points_vert:"\nuniform float size;\nuniform float scale;\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\n\tgl_PointSize = size;\n\n\t#ifdef USE_SIZEATTENUATION\n\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\n\t#endif\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n\n}\n",shadow_frag:"\nuniform vec3 color;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n\nvoid main() {\n\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n",shadow_vert:"\n#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n\nvoid main() {\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",sprite_frag:"\nuniform vec3 diffuse;\nuniform float opacity;\n\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\toutgoingLight = diffuseColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n",sprite_vert:"\nuniform float rotation;\nuniform vec2 center;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n\t#ifndef USE_SIZEATTENUATION\n\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\n\t#endif\n\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\n\tmvPosition.xy += rotatedPosition;\n\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n}\n"},aa={common:{diffuse:{value:new Zr(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new pi},uv2Transform:{value:new pi},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new di(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Zr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Zr(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new pi}},sprite:{diffuse:{value:new Zr(16777215)},opacity:{value:1},center:{value:new di(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new pi}}},sa={basic:{uniforms:Wo([aa.common,aa.specularmap,aa.envmap,aa.aomap,aa.lightmap,aa.fog]),vertexShader:oa.meshbasic_vert,fragmentShader:oa.meshbasic_frag},lambert:{uniforms:Wo([aa.common,aa.specularmap,aa.envmap,aa.aomap,aa.lightmap,aa.emissivemap,aa.fog,aa.lights,{emissive:{value:new Zr(0)}}]),vertexShader:oa.meshlambert_vert,fragmentShader:oa.meshlambert_frag},phong:{uniforms:Wo([aa.common,aa.specularmap,aa.envmap,aa.aomap,aa.lightmap,aa.emissivemap,aa.bumpmap,aa.normalmap,aa.displacementmap,aa.fog,aa.lights,{emissive:{value:new Zr(0)},specular:{value:new Zr(1118481)},shininess:{value:30}}]),vertexShader:oa.meshphong_vert,fragmentShader:oa.meshphong_frag},standard:{uniforms:Wo([aa.common,aa.envmap,aa.aomap,aa.lightmap,aa.emissivemap,aa.bumpmap,aa.normalmap,aa.displacementmap,aa.roughnessmap,aa.metalnessmap,aa.fog,aa.lights,{emissive:{value:new Zr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:oa.meshphysical_vert,fragmentShader:oa.meshphysical_frag},toon:{uniforms:Wo([aa.common,aa.aomap,aa.lightmap,aa.emissivemap,aa.bumpmap,aa.normalmap,aa.displacementmap,aa.gradientmap,aa.fog,aa.lights,{emissive:{value:new Zr(0)}}]),vertexShader:oa.meshtoon_vert,fragmentShader:oa.meshtoon_frag},matcap:{uniforms:Wo([aa.common,aa.bumpmap,aa.normalmap,aa.displacementmap,aa.fog,{matcap:{value:null}}]),vertexShader:oa.meshmatcap_vert,fragmentShader:oa.meshmatcap_frag},points:{uniforms:Wo([aa.points,aa.fog]),vertexShader:oa.points_vert,fragmentShader:oa.points_frag},dashed:{uniforms:Wo([aa.common,aa.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:oa.linedashed_vert,fragmentShader:oa.linedashed_frag},depth:{uniforms:Wo([aa.common,aa.displacementmap]),vertexShader:oa.depth_vert,fragmentShader:oa.depth_frag},normal:{uniforms:Wo([aa.common,aa.bumpmap,aa.normalmap,aa.displacementmap,{opacity:{value:1}}]),vertexShader:oa.normal_vert,fragmentShader:oa.normal_frag},sprite:{uniforms:Wo([aa.sprite,aa.fog]),vertexShader:oa.sprite_vert,fragmentShader:oa.sprite_frag},background:{uniforms:{uvTransform:{value:new pi},t2D:{value:null}},vertexShader:oa.background_vert,fragmentShader:oa.background_frag},cube:{uniforms:Wo([aa.envmap,{opacity:{value:1}}]),vertexShader:oa.cube_vert,fragmentShader:oa.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:oa.equirect_vert,fragmentShader:oa.equirect_frag},distanceRGBA:{uniforms:Wo([aa.common,aa.displacementmap,{referencePosition:{value:new Si},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:oa.distanceRGBA_vert,fragmentShader:oa.distanceRGBA_frag},shadow:{uniforms:Wo([aa.lights,aa.fog,{color:{value:new Zr(0)},opacity:{value:1}}]),vertexShader:oa.shadow_vert,fragmentShader:oa.shadow_frag}};function la(e,t,n,i,r){const o=new Zr(0);let a,s,l=0,c=null,u=0,h=null;function d(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,r)}return{getClearColor:function(){return o},setClearColor:function(e,t=1){o.set(e),l=t,d(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(e){l=e,d(o,l)},render:function(n,r){let p=!1,f=!0===r.isScene?r.background:null;f&&f.isTexture&&(f=t.get(f));const m=e.xr,g=m.getSession&&m.getSession();g&&"additive"===g.environmentBlendMode&&(f=null),null===f?d(o,l):f&&f.isColor&&(d(f,1),p=!0),(e.autoClear||p)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),f&&(f.isCubeTexture||f.mapping===fe)?(void 0===s&&(s=new Vo(new zo(1,1,1),new qo({name:"BackgroundCubeMaterial",uniforms:Ho(sa.cube.uniforms),vertexShader:sa.cube.vertexShader,fragmentShader:sa.cube.fragmentShader,side:_,depthTest:!1,depthWrite:!1,fog:!1})),s.geometry.deleteAttribute("normal"),s.geometry.deleteAttribute("uv"),s.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(s.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(s)),s.material.uniforms.envMap.value=f,s.material.uniforms.flipEnvMap.value=f.isCubeTexture&&f._needsFlipEnvMap?-1:1,c===f&&u===f.version&&h===e.toneMapping||(s.material.needsUpdate=!0,c=f,u=f.version,h=e.toneMapping),n.unshift(s,s.geometry,s.material,0,0,null)):f&&f.isTexture&&(void 0===a&&(a=new Vo(new ra(2,2),new qo({name:"BackgroundMaterial",uniforms:Ho(sa.background.uniforms),vertexShader:sa.background.vertexShader,fragmentShader:sa.background.fragmentShader,side:b,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(a)),a.material.uniforms.t2D.value=f,!0===f.matrixAutoUpdate&&f.updateMatrix(),a.material.uniforms.uvTransform.value.copy(f.matrix),c===f&&u===f.version&&h===e.toneMapping||(a.material.needsUpdate=!0,c=f,u=f.version,h=e.toneMapping),n.unshift(a,a.geometry,a.material,0,0,null))}}}function ca(e,t,n,i){const r=e.getParameter(e.MAX_VERTEX_ATTRIBS),o=i.isWebGL2?null:t.get("OES_vertex_array_object"),a=i.isWebGL2||null!==o,s={},l=d(null);let c=l;function u(t){return i.isWebGL2?e.bindVertexArray(t):o.bindVertexArrayOES(t)}function h(t){return i.isWebGL2?e.deleteVertexArray(t):o.deleteVertexArrayOES(t)}function d(e){const t=[],n=[],i=[];for(let e=0;e<r;e++)t[e]=0,n[e]=0,i[e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:i,object:e,attributes:{},index:null}}function p(){const e=c.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function f(e){m(e,0)}function m(n,r){const o=c.newAttributes,a=c.enabledAttributes,s=c.attributeDivisors;if(o[n]=1,0===a[n]&&(e.enableVertexAttribArray(n),a[n]=1),s[n]!==r){(i.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,r),s[n]=r}}function g(){const t=c.newAttributes,n=c.enabledAttributes;for(let i=0,r=n.length;i<r;i++)n[i]!==t[i]&&(e.disableVertexAttribArray(i),n[i]=0)}function v(t,n,r,o,a,s){!0!==i.isWebGL2||r!==e.INT&&r!==e.UNSIGNED_INT?e.vertexAttribPointer(t,n,r,o,a,s):e.vertexAttribIPointer(t,n,r,a,s)}function y(){b(),c!==l&&(c=l,u(c.object))}function b(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(r,l,h,y,b){let _=!1;if(a){const t=function(t,n,r){const a=!0===r.wireframe;let l=s[t.id];void 0===l&&(l={},s[t.id]=l);let c=l[n.id];void 0===c&&(c={},l[n.id]=c);let u=c[a];void 0===u&&(u=d(i.isWebGL2?e.createVertexArray():o.createVertexArrayOES()),c[a]=u);return u}(y,h,l);c!==t&&(c=t,u(c.object)),_=function(e,t){const n=c.attributes,i=e.attributes;let r=0;for(const e in i){const t=n[e],o=i[e];if(void 0===t)return!0;if(t.attribute!==o)return!0;if(t.data!==o.data)return!0;r++}return c.attributesNum!==r||c.index!==t}(y,b),_&&function(e,t){const n={},i=e.attributes;let r=0;for(const e in i){const t=i[e],o={};o.attribute=t,t.data&&(o.data=t.data),n[e]=o,r++}c.attributes=n,c.attributesNum=r,c.index=t}(y,b)}else{const e=!0===l.wireframe;c.geometry===y.id&&c.program===h.id&&c.wireframe===e||(c.geometry=y.id,c.program=h.id,c.wireframe=e,_=!0)}!0===r.isInstancedMesh&&(_=!0),null!==b&&n.update(b,e.ELEMENT_ARRAY_BUFFER),_&&(!function(r,o,a,s){if(!1===i.isWebGL2&&(r.isInstancedMesh||s.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;p();const l=s.attributes,c=a.getAttributes(),u=o.defaultAttributeValues;for(const t in c){const i=c[t];if(i>=0){const o=l[t];if(void 0!==o){const t=o.normalized,r=o.itemSize,a=n.get(o);if(void 0===a)continue;const l=a.buffer,c=a.type,u=a.bytesPerElement;if(o.isInterleavedBufferAttribute){const n=o.data,a=n.stride,h=o.offset;n&&n.isInstancedInterleavedBuffer?(m(i,n.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=n.meshPerAttribute*n.count)):f(i),e.bindBuffer(e.ARRAY_BUFFER,l),v(i,r,c,t,a*u,h*u)}else o.isInstancedBufferAttribute?(m(i,o.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=o.meshPerAttribute*o.count)):f(i),e.bindBuffer(e.ARRAY_BUFFER,l),v(i,r,c,t,0,0)}else if("instanceMatrix"===t){const t=n.get(r.instanceMatrix);if(void 0===t)continue;const o=t.buffer,a=t.type;m(i+0,1),m(i+1,1),m(i+2,1),m(i+3,1),e.bindBuffer(e.ARRAY_BUFFER,o),e.vertexAttribPointer(i+0,4,a,!1,64,0),e.vertexAttribPointer(i+1,4,a,!1,64,16),e.vertexAttribPointer(i+2,4,a,!1,64,32),e.vertexAttribPointer(i+3,4,a,!1,64,48)}else if("instanceColor"===t){const t=n.get(r.instanceColor);if(void 0===t)continue;const o=t.buffer,a=t.type;m(i,1),e.bindBuffer(e.ARRAY_BUFFER,o),e.vertexAttribPointer(i,3,a,!1,12,0)}else if(void 0!==u){const n=u[t];if(void 0!==n)switch(n.length){case 2:e.vertexAttrib2fv(i,n);break;case 3:e.vertexAttrib3fv(i,n);break;case 4:e.vertexAttrib4fv(i,n);break;default:e.vertexAttrib1fv(i,n)}}}}g()}(r,l,h,y),null!==b&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n.get(b).buffer))},reset:y,resetDefaultState:b,dispose:function(){y();for(const e in s){const t=s[e];for(const e in t){const n=t[e];for(const e in n)h(n[e].object),delete n[e];delete t[e]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0===s[e.id])return;const t=s[e.id];for(const e in t){const n=t[e];for(const e in n)h(n[e].object),delete n[e];delete t[e]}delete s[e.id]},releaseStatesOfProgram:function(e){for(const t in s){const n=s[t];if(void 0===n[e.id])continue;const i=n[e.id];for(const e in i)h(i[e].object),delete i[e];delete n[e.id]}},initAttributes:p,enableAttribute:f,disableUnusedAttributes:g}}function ua(e,t,n,i){const r=i.isWebGL2;let o;this.setMode=function(e){o=e},this.render=function(t,i){e.drawArrays(o,t,i),n.update(i,o,1)},this.renderInstances=function(i,a,s){if(0===s)return;let l,c;if(r)l=e,c="drawArraysInstanced";else if(l=t.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](o,i,a,s),n.update(a,o,s)}}function ha(e,t,n){let i;function r(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext;let a=void 0!==n.precision?n.precision:"highp";const s=r(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);const l=o||t.has("WEBGL_draw_buffers"),c=!0===n.logarithmicDepthBuffer,u=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),d=e.getParameter(e.MAX_TEXTURE_SIZE),p=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),f=e.getParameter(e.MAX_VERTEX_ATTRIBS),m=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),g=e.getParameter(e.MAX_VARYING_VECTORS),v=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),y=h>0,b=o||t.has("OES_texture_float");return{isWebGL2:o,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:r,precision:a,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:v,vertexTextures:y,floatFragmentTextures:b,floatVertexTextures:y&&b,maxSamples:o?e.getParameter(e.MAX_SAMPLES):0}}function da(e){const t=this;let n=null,i=0,r=!1,o=!1;const a=new Lr,s=new pi,l={value:null,needsUpdate:!1};function c(){l.value!==n&&(l.value=n,l.needsUpdate=i>0),t.numPlanes=i,t.numIntersection=0}function u(e,n,i,r){const o=null!==e?e.length:0;let c=null;if(0!==o){if(c=l.value,!0!==r||null===c){const t=i+4*o,r=n.matrixWorldInverse;s.getNormalMatrix(r),(null===c||c.length<t)&&(c=new Float32Array(t));for(let t=0,n=i;t!==o;++t,n+=4)a.copy(e[t]).applyMatrix4(r,s),a.normal.toArray(c,n),c[n+3]=a.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=o,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,o){const a=0!==e.length||t||0!==i||r;return r=t,n=u(e,o,0),i=e.length,a},this.beginShadows=function(){o=!0,u(null)},this.endShadows=function(){o=!1,c()},this.setState=function(t,a,s){const h=t.clippingPlanes,d=t.clipIntersection,p=t.clipShadows,f=e.get(t);if(!r||null===h||0===h.length||o&&!p)o?u(null):c();else{const e=o?0:i,t=4*e;let r=f.clippingState||null;l.value=r,r=u(h,a,t,s);for(let e=0;e!==t;++e)r[e]=n[e];f.clippingState=r,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=e}}}function pa(e){let t=new WeakMap;function n(e,t){return t===de?e.mapping=ue:t===pe&&(e.mapping=he),e}function i(e){const n=e.target;n.removeEventListener("dispose",i);const r=t.get(n);void 0!==r&&(t.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){const o=r.mapping;if(o===de||o===pe){if(t.has(r)){return n(t.get(r).texture,r.mapping)}{const o=r.image;if(o&&o.height>0){const a=e.getRenderTarget(),s=new Qo(o.height/2);return s.fromEquirectangularTexture(e,r),t.set(r,s),e.setRenderTarget(a),r.addEventListener("dispose",i),n(s.texture,r.mapping)}return null}}}return r},dispose:function(){t=new WeakMap}}}function fa(e){const t={};function n(n){if(void 0!==t[n])return t[n];let i;switch(n){case"WEBGL_depth_texture":i=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(n)}return t[n]=i,i}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float")},get:function(e){const t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function ma(e,t,n,i){const r={},o=new WeakMap;function a(e){const s=e.target;null!==s.index&&t.remove(s.index);for(const e in s.attributes)t.remove(s.attributes[e]);s.removeEventListener("dispose",a),delete r[s.id];const l=o.get(s);l&&(t.remove(l),o.delete(s)),i.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(e){const n=[],i=e.index,r=e.attributes.position;let a=0;if(null!==i){const e=i.array;a=i.version;for(let t=0,i=e.length;t<i;t+=3){const i=e[t+0],r=e[t+1],o=e[t+2];n.push(i,r,r,o,o,i)}}else{const e=r.array;a=r.version;for(let t=0,i=e.length/3-1;t<i;t+=3){const e=t+0,i=t+1,r=t+2;n.push(e,i,i,r,r,e)}}const s=new(ho(n)>65535?so:oo)(n,1);s.version=a;const l=o.get(e);l&&t.remove(l),o.set(e,s)}return{get:function(e,t){return!0===r[t.id]||(t.addEventListener("dispose",a),r[t.id]=!0,n.memory.geometries++),t},update:function(n){const i=n.attributes;for(const n in i)t.update(i[n],e.ARRAY_BUFFER);const r=n.morphAttributes;for(const n in r){const i=r[n];for(let n=0,r=i.length;n<r;n++)t.update(i[n],e.ARRAY_BUFFER)}},getWireframeAttribute:function(e){const t=o.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&s(e)}else s(e);return o.get(e)}}}function ga(e,t,n,i){const r=i.isWebGL2;let o,a,s;this.setMode=function(e){o=e},this.setIndex=function(e){a=e.type,s=e.bytesPerElement},this.render=function(t,i){e.drawElements(o,i,a,t*s),n.update(i,o,1)},this.renderInstances=function(i,l,c){if(0===c)return;let u,h;if(r)u=e,h="drawElementsInstanced";else if(u=t.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===u)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[h](o,l,a,i*s,c),n.update(l,o,c)}}function va(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,i,r){switch(t.calls++,i){case e.TRIANGLES:t.triangles+=r*(n/3);break;case e.LINES:t.lines+=r*(n/2);break;case e.LINE_STRIP:t.lines+=r*(n-1);break;case e.LINE_LOOP:t.lines+=r*n;break;case e.POINTS:t.points+=r*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",i)}}}}function ya(e,t){return e[0]-t[0]}function ba(e,t){return Math.abs(t[1])-Math.abs(e[1])}function _a(e){const t={},n=new Float32Array(8),i=[];for(let e=0;e<8;e++)i[e]=[e,0];return{update:function(r,o,a,s){const l=r.morphTargetInfluences,c=void 0===l?0:l.length;let u=t[o.id];if(void 0===u){u=[];for(let e=0;e<c;e++)u[e]=[e,0];t[o.id]=u}for(let e=0;e<c;e++){const t=u[e];t[0]=e,t[1]=l[e]}u.sort(ba);for(let e=0;e<8;e++)e<c&&u[e][1]?(i[e][0]=u[e][0],i[e][1]=u[e][1]):(i[e][0]=Number.MAX_SAFE_INTEGER,i[e][1]=0);i.sort(ya);const h=a.morphTargets&&o.morphAttributes.position,d=a.morphNormals&&o.morphAttributes.normal;let p=0;for(let e=0;e<8;e++){const t=i[e],r=t[0],a=t[1];r!==Number.MAX_SAFE_INTEGER&&a?(h&&o.getAttribute("morphTarget"+e)!==h[r]&&o.setAttribute("morphTarget"+e,h[r]),d&&o.getAttribute("morphNormal"+e)!==d[r]&&o.setAttribute("morphNormal"+e,d[r]),n[e]=a,p+=a):(h&&!0===o.hasAttribute("morphTarget"+e)&&o.deleteAttribute("morphTarget"+e),d&&!0===o.hasAttribute("morphNormal"+e)&&o.deleteAttribute("morphNormal"+e),n[e]=0)}const f=o.morphTargetsRelative?1:1-p;s.getUniforms().setValue(e,"morphTargetBaseInfluence",f),s.getUniforms().setValue(e,"morphTargetInfluences",n)}}}function xa(e,t,n,i){let r=new WeakMap;function o(e){const t=e.target;t.removeEventListener("dispose",o),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(a){const s=i.render.frame,l=a.geometry,c=t.get(a,l);return r.get(c)!==s&&(t.update(c),r.set(c,s)),a.isInstancedMesh&&(!1===a.hasEventListener("dispose",o)&&a.addEventListener("dispose",o),n.update(a.instanceMatrix,e.ARRAY_BUFFER),null!==a.instanceColor&&n.update(a.instanceColor,e.ARRAY_BUFFER)),c},dispose:function(){r=new WeakMap}}}sa.physical={uniforms:Wo([sa.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new di(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Zr(0)},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new di},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Zr(0)}}]),vertexShader:oa.meshphysical_vert,fragmentShader:oa.meshphysical_frag};class Ea extends vi{constructor(e=null,t=1,n=1,i=1){super(null),this.image={data:e,width:t,height:n,depth:i},this.magFilter=be,this.minFilter=be,this.wrapR=ve,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Ea.prototype.isDataTexture2DArray=!0;class wa extends vi{constructor(e=null,t=1,n=1,i=1){super(null),this.image={data:e,width:t,height:n,depth:i},this.magFilter=be,this.minFilter=be,this.wrapR=ve,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}wa.prototype.isDataTexture3D=!0;const Sa=new vi,Aa=new Ea,Ma=new wa,Ta=new Jo,Ca=[],Pa=[],La=new Float32Array(16),Ra=new Float32Array(9),Da=new Float32Array(4);function Ia(e,t,n){const i=e[0];if(i<=0||i>0)return e;const r=t*n;let o=Ca[r];if(void 0===o&&(o=new Float32Array(r),Ca[r]=o),0!==t){i.toArray(o,0);for(let i=1,r=0;i!==t;++i)r+=n,e[i].toArray(o,r)}return o}function Oa(e,t){if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(e[n]!==t[n])return!1;return!0}function Na(e,t){for(let n=0,i=t.length;n<i;n++)e[n]=t[n]}function ka(e,t){let n=Pa[t];void 0===n&&(n=new Int32Array(t),Pa[t]=n);for(let i=0;i!==t;++i)n[i]=e.allocateTextureUnit();return n}function Fa(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Ua(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Oa(n,t))return;e.uniform2fv(this.addr,t),Na(n,t)}}function Ba(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(Oa(n,t))return;e.uniform3fv(this.addr,t),Na(n,t)}}function Va(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Oa(n,t))return;e.uniform4fv(this.addr,t),Na(n,t)}}function Ga(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(Oa(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Na(n,t)}else{if(Oa(n,i))return;Da.set(i),e.uniformMatrix2fv(this.addr,!1,Da),Na(n,i)}}function za(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(Oa(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Na(n,t)}else{if(Oa(n,i))return;Ra.set(i),e.uniformMatrix3fv(this.addr,!1,Ra),Na(n,i)}}function Ha(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(Oa(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Na(n,t)}else{if(Oa(n,i))return;La.set(i),e.uniformMatrix4fv(this.addr,!1,La),Na(n,i)}}function Wa(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function ja(e,t){const n=this.cache;Oa(n,t)||(e.uniform2iv(this.addr,t),Na(n,t))}function qa(e,t){const n=this.cache;Oa(n,t)||(e.uniform3iv(this.addr,t),Na(n,t))}function Xa(e,t){const n=this.cache;Oa(n,t)||(e.uniform4iv(this.addr,t),Na(n,t))}function Ya(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function Ka(e,t){const n=this.cache;Oa(n,t)||(e.uniform2uiv(this.addr,t),Na(n,t))}function Za(e,t){const n=this.cache;Oa(n,t)||(e.uniform3uiv(this.addr,t),Na(n,t))}function Ja(e,t){const n=this.cache;Oa(n,t)||(e.uniform4uiv(this.addr,t),Na(n,t))}function Qa(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.safeSetTexture2D(t||Sa,r)}function $a(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(t||Ma,r)}function es(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.safeSetTextureCube(t||Ta,r)}function ts(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(t||Aa,r)}function ns(e,t){e.uniform1fv(this.addr,t)}function is(e,t){const n=Ia(t,this.size,2);e.uniform2fv(this.addr,n)}function rs(e,t){const n=Ia(t,this.size,3);e.uniform3fv(this.addr,n)}function os(e,t){const n=Ia(t,this.size,4);e.uniform4fv(this.addr,n)}function as(e,t){const n=Ia(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function ss(e,t){const n=Ia(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function ls(e,t){const n=Ia(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function cs(e,t){e.uniform1iv(this.addr,t)}function us(e,t){e.uniform2iv(this.addr,t)}function hs(e,t){e.uniform3iv(this.addr,t)}function ds(e,t){e.uniform4iv(this.addr,t)}function ps(e,t){e.uniform1uiv(this.addr,t)}function fs(e,t){e.uniform2uiv(this.addr,t)}function ms(e,t){e.uniform3uiv(this.addr,t)}function gs(e,t){e.uniform4uiv(this.addr,t)}function vs(e,t,n){const i=t.length,r=ka(n,i);e.uniform1iv(this.addr,r);for(let e=0;e!==i;++e)n.safeSetTexture2D(t[e]||Sa,r[e])}function ys(e,t,n){const i=t.length,r=ka(n,i);e.uniform1iv(this.addr,r);for(let e=0;e!==i;++e)n.safeSetTextureCube(t[e]||Ta,r[e])}function bs(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return Fa;case 35664:return Ua;case 35665:return Ba;case 35666:return Va;case 35674:return Ga;case 35675:return za;case 35676:return Ha;case 5124:case 35670:return Wa;case 35667:case 35671:return ja;case 35668:case 35672:return qa;case 35669:case 35673:return Xa;case 5125:return Ya;case 36294:return Ka;case 36295:return Za;case 36296:return Ja;case 35678:case 36198:case 36298:case 36306:case 35682:return Qa;case 35679:case 36299:case 36307:return $a;case 35680:case 36300:case 36308:case 36293:return es;case 36289:case 36303:case 36311:case 36292:return ts}}(t.type)}function _s(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return ns;case 35664:return is;case 35665:return rs;case 35666:return os;case 35674:return as;case 35675:return ss;case 35676:return ls;case 5124:case 35670:return cs;case 35667:case 35671:return us;case 35668:case 35672:return hs;case 35669:case 35673:return ds;case 5125:return ps;case 36294:return fs;case 36295:return ms;case 36296:return gs;case 35678:case 36198:case 36298:case 36306:case 35682:return vs;case 35680:case 36300:case 36308:case 36293:return ys}}(t.type)}function xs(e){this.id=e,this.seq=[],this.map={}}_s.prototype.updateCache=function(e){const t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),Na(t,e)},xs.prototype.setValue=function(e,t,n){const i=this.seq;for(let r=0,o=i.length;r!==o;++r){const o=i[r];o.setValue(e,t[o.id],n)}};const Es=/(\w+)(\])?(\[|\.)?/g;function ws(e,t){e.seq.push(t),e.map[t.id]=t}function Ss(e,t,n){const i=e.name,r=i.length;for(Es.lastIndex=0;;){const o=Es.exec(i),a=Es.lastIndex;let s=o[1];const l="]"===o[2],c=o[3];if(l&&(s|=0),void 0===c||"["===c&&a+2===r){ws(n,void 0===c?new bs(s,e,t):new _s(s,e,t));break}{let e=n.map[s];void 0===e&&(e=new xs(s),ws(n,e)),n=e}}}function As(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){const n=e.getActiveUniform(t,i);Ss(n,e.getUniformLocation(t,n.name),this)}}function Ms(e,t,n){const i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),i}As.prototype.setValue=function(e,t,n,i){const r=this.map[t];void 0!==r&&r.setValue(e,n,i)},As.prototype.setOptional=function(e,t,n){const i=t[n];void 0!==i&&this.setValue(e,n,i)},As.upload=function(e,t,n,i){for(let r=0,o=t.length;r!==o;++r){const o=t[r],a=n[o.id];!1!==a.needsUpdate&&o.setValue(e,a.value,i)}},As.seqWithValue=function(e,t){const n=[];for(let i=0,r=e.length;i!==r;++i){const r=e[i];r.id in t&&n.push(r)}return n};let Ts=0;function Cs(e){switch(e){case tn:return["Linear","( value )"];case nn:return["sRGB","( value )"];case on:return["RGBE","( value )"];case sn:return["RGBM","( value, 7.0 )"];case ln:return["RGBM","( value, 16.0 )"];case cn:return["RGBD","( value, 256.0 )"];case rn:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case an:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function Ps(e,t,n){const i=e.getShaderParameter(t,e.COMPILE_STATUS),r=e.getShaderInfoLog(t).trim();if(i&&""===r)return"";return"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+r+function(e){const t=e.split("\n");for(let e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join("\n")}(e.getShaderSource(t))}function Ls(e,t){const n=Cs(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Rs(e,t){const n=Cs(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function Ds(e,t){let n;switch(t){case re:n="Linear";break;case oe:n="Reinhard";break;case ae:n="OptimizedCineon";break;case se:n="ACESFilmic";break;case le:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Is(e){return""!==e}function Os(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Ns(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const ks=/^[ \t]*#include +<([\w\d./]+)>/gm;function Fs(e){return e.replace(ks,Us)}function Us(e,t){const n=oa[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Fs(n)}const Bs=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Vs=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Gs(e){return e.replace(Vs,Hs).replace(Bs,zs)}function zs(e,t,n,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Hs(e,t,n,i)}function Hs(e,t,n,i){let r="";for(let e=parseInt(t);e<parseInt(n);e++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return r}function Ws(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function js(e,t,n,i){const r=e.getContext(),o=n.defines;let a=n.vertexShader,s=n.fragmentShader;const l=function(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===g?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===v?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===y&&(t="SHADOWMAP_TYPE_VSM"),t}(n),c=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case ue:case he:t="ENVMAP_TYPE_CUBE";break;case fe:case me:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),u=function(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case he:case me:t="ENVMAP_MODE_REFRACTION"}return t}(n),h=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case ee:t="ENVMAP_BLENDING_MULTIPLY";break;case te:t="ENVMAP_BLENDING_MIX";break;case ne:t="ENVMAP_BLENDING_ADD"}return t}(n),d=e.gammaFactor>0?e.gammaFactor:1,p=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission>0)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Is).join("\n")}(n),f=function(e){const t=[];for(const n in e){const i=e[n];!1!==i&&t.push("#define "+n+" "+i)}return t.join("\n")}(o),m=r.createProgram();let b,_,x=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(b=[f].filter(Is).join("\n"),b.length>0&&(b+="\n"),_=[p,f].filter(Is).join("\n"),_.length>0&&(_+="\n")):(b=[Ws(n),"#define SHADER_NAME "+n.shaderName,f,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+d,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Is).join("\n"),_=[p,Ws(n),"#define SHADER_NAME "+n.shaderName,f,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+d,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==ie?"#define TONE_MAPPING":"",n.toneMapping!==ie?oa.tonemapping_pars_fragment:"",n.toneMapping!==ie?Ds("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",oa.encodings_pars_fragment,n.map?Ls("mapTexelToLinear",n.mapEncoding):"",n.matcap?Ls("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?Ls("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?Ls("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMap?Ls("lightMapTexelToLinear",n.lightMapEncoding):"",Rs("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Is).join("\n")),a=Fs(a),a=Os(a,n),a=Ns(a,n),s=Fs(s),s=Os(s,n),s=Ns(s,n),a=Gs(a),s=Gs(s),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(x="#version 300 es\n",b=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+b,_=["#define varying in",n.glslVersion===Vn?"":"out highp vec4 pc_fragColor;",n.glslVersion===Vn?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+_);const E=x+b+a,w=x+_+s,S=Ms(r,r.VERTEX_SHADER,E),A=Ms(r,r.FRAGMENT_SHADER,w);if(r.attachShader(m,S),r.attachShader(m,A),void 0!==n.index0AttributeName?r.bindAttribLocation(m,0,n.index0AttributeName):!0===n.morphTargets&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),e.debug.checkShaderErrors){const e=r.getProgramInfoLog(m).trim(),t=r.getShaderInfoLog(S).trim(),n=r.getShaderInfoLog(A).trim();let i=!0,o=!0;if(!1===r.getProgramParameter(m,r.LINK_STATUS)){i=!1;const t=Ps(r,S,"vertex"),n=Ps(r,A,"fragment");console.error("THREE.WebGLProgram: shader error: ",r.getError(),"gl.VALIDATE_STATUS",r.getProgramParameter(m,r.VALIDATE_STATUS),"gl.getProgramInfoLog",e,t,n)}else""!==e?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",e):""!==t&&""!==n||(o=!1);o&&(this.diagnostics={runnable:i,programLog:e,vertexShader:{log:t,prefix:b},fragmentShader:{log:n,prefix:_}})}let M,T;return r.deleteShader(S),r.deleteShader(A),this.getUniforms=function(){return void 0===M&&(M=new As(r,m)),M},this.getAttributes=function(){return void 0===T&&(T=function(e,t){const n={},i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const i=e.getActiveAttrib(t,r).name;n[i]=e.getAttribLocation(t,i)}return n}(r,m)),T},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.name=n.shaderName,this.id=Ts++,this.cacheKey=t,this.usedTimes=1,this.program=m,this.vertexShader=S,this.fragmentShader=A,this}function qs(e,t,n,i,r,o){const a=[],s=i.isWebGL2,l=i.logarithmicDepthBuffer,c=i.floatVertexTextures,u=i.maxVertexUniforms,h=i.vertexTextures;let d=i.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},f=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmission","transmissionMap","thicknessMap"];function m(e){let t;return e&&e.isTexture?t=e.encoding:e&&e.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=tn,t}return{getParameters:function(r,a,f,g,v){const y=g.fog,b=r.isMeshStandardMaterial?g.environment:null,E=t.get(r.envMap||b),w=p[r.type],S=v.isSkinnedMesh?function(e){const t=e.skeleton.bones;if(c)return 1024;{const e=u,n=Math.floor((e-20)/4),i=Math.min(n,t.length);return i<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+i+"."),0):i}}(v):0;let A,M;if(null!==r.precision&&(d=i.getMaxPrecision(r.precision),d!==r.precision&&console.warn("THREE.WebGLProgram.getParameters:",r.precision,"not supported, using",d,"instead.")),w){const e=sa[w];A=e.vertexShader,M=e.fragmentShader}else A=r.vertexShader,M=r.fragmentShader;const T=e.getRenderTarget();return{isWebGL2:s,shaderID:w,shaderName:r.type,vertexShader:A,fragmentShader:M,defines:r.defines,isRawShaderMaterial:!0===r.isRawShaderMaterial,glslVersion:r.glslVersion,precision:d,instancing:!0===v.isInstancedMesh,instancingColor:!0===v.isInstancedMesh&&null!==v.instanceColor,supportsVertexTextures:h,outputEncoding:null!==T?m(T.texture):e.outputEncoding,map:!!r.map,mapEncoding:m(r.map),matcap:!!r.matcap,matcapEncoding:m(r.matcap),envMap:!!E,envMapMode:E&&E.mapping,envMapEncoding:m(E),envMapCubeUV:!!E&&(E.mapping===fe||E.mapping===me),lightMap:!!r.lightMap,lightMapEncoding:m(r.lightMap),aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,emissiveMapEncoding:m(r.emissiveMap),bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,objectSpaceNormalMap:r.normalMapType===pn,tangentSpaceNormalMap:r.normalMapType===dn,clearcoatMap:!!r.clearcoatMap,clearcoatRoughnessMap:!!r.clearcoatRoughnessMap,clearcoatNormalMap:!!r.clearcoatNormalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,gradientMap:!!r.gradientMap,sheen:!!r.sheen,transmission:!!r.transmission,transmissionMap:!!r.transmissionMap,thicknessMap:!!r.thicknessMap,combine:r.combine,vertexTangents:r.normalMap&&r.vertexTangents,vertexColors:r.vertexColors,vertexAlphas:!0===r.vertexColors&&v.geometry&&v.geometry.attributes.color&&4===v.geometry.attributes.color.itemSize,vertexUvs:!!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatMap||r.clearcoatRoughnessMap||r.clearcoatNormalMap||r.displacementMap||r.transmission||r.transmissionMap||r.thicknessMap),uvsVertexOnly:!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatNormalMap||r.transmission||r.transmissionMap||r.thicknessMap||!r.displacementMap),fog:!!y,useFog:r.fog,fogExp2:y&&y.isFogExp2,flatShading:!!r.flatShading,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:l,skinning:!0===v.isSkinnedMesh&&S>0,maxBones:S,useVertexTexture:c,morphTargets:r.morphTargets,morphNormals:r.morphNormals,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numDirLightShadows:a.directionalShadowMap.length,numPointLightShadows:a.pointShadowMap.length,numSpotLightShadows:a.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:r.dithering,shadowMapEnabled:e.shadowMap.enabled&&f.length>0,shadowMapType:e.shadowMap.type,toneMapping:r.toneMapped?e.toneMapping:ie,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:r.premultipliedAlpha,alphaTest:r.alphaTest,doubleSided:r.side===x,flipSided:r.side===_,depthPacking:void 0!==r.depthPacking&&r.depthPacking,index0AttributeName:r.index0AttributeName,extensionDerivatives:r.extensions&&r.extensions.derivatives,extensionFragDepth:r.extensions&&r.extensions.fragDepth,extensionDrawBuffers:r.extensions&&r.extensions.drawBuffers,extensionShaderTextureLOD:r.extensions&&r.extensions.shaderTextureLOD,rendererExtensionFragDepth:s||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:s||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:s||n.has("EXT_shader_texture_lod"),customProgramCacheKey:r.customProgramCacheKey()}},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);if(!1===t.isRawShaderMaterial){for(let e=0;e<f.length;e++)n.push(t[f[e]]);n.push(e.outputEncoding),n.push(e.gammaFactor)}return n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=p[e.type];let n;if(t){const e=sa[t];n=jo.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let i;for(let e=0,t=a.length;e<t;e++){const t=a[e];if(t.cacheKey===n){i=t,++i.usedTimes;break}}return void 0===i&&(i=new js(e,n,t,r),a.push(i)),i},releaseProgram:function(e){if(0==--e.usedTimes){const t=a.indexOf(e);a[t]=a[a.length-1],a.pop(),e.destroy()}},programs:a}}function Xs(){let e=new WeakMap;return{get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,i){e.get(t)[n]=i},dispose:function(){e=new WeakMap}}}function Ys(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Ks(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Zs(e){const t=[];let n=0;const i=[],r=[],o=[],a={id:-1};function s(i,r,o,s,l,c){let u=t[n];const h=e.get(o);return void 0===u?(u={id:i.id,object:i,geometry:r,material:o,program:h.program||a,groupOrder:s,renderOrder:i.renderOrder,z:l,group:c},t[n]=u):(u.id=i.id,u.object=i,u.geometry=r,u.material=o,u.program=h.program||a,u.groupOrder=s,u.renderOrder=i.renderOrder,u.z=l,u.group=c),n++,u}return{opaque:i,transmissive:r,transparent:o,init:function(){n=0,i.length=0,r.length=0,o.length=0},push:function(e,t,n,a,l,c){const u=s(e,t,n,a,l,c);n.transmission>0?r.push(u):!0===n.transparent?o.push(u):i.push(u)},unshift:function(e,t,n,a,l,c){const u=s(e,t,n,a,l,c);n.transmission>0?r.unshift(u):!0===n.transparent?o.unshift(u):i.unshift(u)},finish:function(){for(let e=n,i=t.length;e<i;e++){const n=t[e];if(null===n.id)break;n.id=null,n.object=null,n.geometry=null,n.material=null,n.program=null,n.group=null}},sort:function(e,t){i.length>1&&i.sort(e||Ys),r.length>1&&r.sort(t||Ks),o.length>1&&o.sort(t||Ks)}}}function Js(e){let t=new WeakMap;return{get:function(n,i){let r;return!1===t.has(n)?(r=new Zs(e),t.set(n,[r])):i>=t.get(n).length?(r=new Zs(e),t.get(n).push(r)):r=t.get(n)[i],r},dispose:function(){t=new WeakMap}}}function Qs(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new Si,color:new Zr};break;case"SpotLight":n={position:new Si,direction:new Si,color:new Zr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Si,color:new Zr,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Si,skyColor:new Zr,groundColor:new Zr};break;case"RectAreaLight":n={color:new Zr,position:new Si,halfWidth:new Si,halfHeight:new Si}}return e[t.id]=n,n}}}let $s=0;function el(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function tl(e,t){const n=new Qs,i=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new di};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new di,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let e=0;e<9;e++)r.probe.push(new Si);const o=new Si,a=new tr,s=new tr;return{setup:function(o){let a=0,s=0,l=0;for(let e=0;e<9;e++)r.probe[e].set(0,0,0);let c=0,u=0,h=0,d=0,p=0,f=0,m=0,g=0;o.sort(el);for(let e=0,t=o.length;e<t;e++){const t=o[e],v=t.color,y=t.intensity,b=t.distance,_=t.shadow&&t.shadow.map?t.shadow.map.texture:null;if(t.isAmbientLight)a+=v.r*y,s+=v.g*y,l+=v.b*y;else if(t.isLightProbe)for(let e=0;e<9;e++)r.probe[e].addScaledVector(t.sh.coefficients[e],y);else if(t.isDirectionalLight){const e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity),t.castShadow){const e=t.shadow,n=i.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,r.directionalShadow[c]=n,r.directionalShadowMap[c]=_,r.directionalShadowMatrix[c]=t.shadow.matrix,f++}r.directional[c]=e,c++}else if(t.isSpotLight){const e=n.get(t);if(e.position.setFromMatrixPosition(t.matrixWorld),e.color.copy(v).multiplyScalar(y),e.distance=b,e.coneCos=Math.cos(t.angle),e.penumbraCos=Math.cos(t.angle*(1-t.penumbra)),e.decay=t.decay,t.castShadow){const e=t.shadow,n=i.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,r.spotShadow[h]=n,r.spotShadowMap[h]=_,r.spotShadowMatrix[h]=t.shadow.matrix,g++}r.spot[h]=e,h++}else if(t.isRectAreaLight){const e=n.get(t);e.color.copy(v).multiplyScalar(y),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),r.rectArea[d]=e,d++}else if(t.isPointLight){const e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity),e.distance=t.distance,e.decay=t.decay,t.castShadow){const e=t.shadow,n=i.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,n.shadowCameraNear=e.camera.near,n.shadowCameraFar=e.camera.far,r.pointShadow[u]=n,r.pointShadowMap[u]=_,r.pointShadowMatrix[u]=t.shadow.matrix,m++}r.point[u]=e,u++}else if(t.isHemisphereLight){const e=n.get(t);e.skyColor.copy(t.color).multiplyScalar(y),e.groundColor.copy(t.groundColor).multiplyScalar(y),r.hemi[p]=e,p++}}d>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(r.rectAreaLTC1=aa.LTC_FLOAT_1,r.rectAreaLTC2=aa.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=aa.LTC_HALF_1,r.rectAreaLTC2=aa.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=a,r.ambient[1]=s,r.ambient[2]=l;const v=r.hash;v.directionalLength===c&&v.pointLength===u&&v.spotLength===h&&v.rectAreaLength===d&&v.hemiLength===p&&v.numDirectionalShadows===f&&v.numPointShadows===m&&v.numSpotShadows===g||(r.directional.length=c,r.spot.length=h,r.rectArea.length=d,r.point.length=u,r.hemi.length=p,r.directionalShadow.length=f,r.directionalShadowMap.length=f,r.pointShadow.length=m,r.pointShadowMap.length=m,r.spotShadow.length=g,r.spotShadowMap.length=g,r.directionalShadowMatrix.length=f,r.pointShadowMatrix.length=m,r.spotShadowMatrix.length=g,v.directionalLength=c,v.pointLength=u,v.spotLength=h,v.rectAreaLength=d,v.hemiLength=p,v.numDirectionalShadows=f,v.numPointShadows=m,v.numSpotShadows=g,r.version=$s++)},setupView:function(e,t){let n=0,i=0,l=0,c=0,u=0;const h=t.matrixWorldInverse;for(let t=0,d=e.length;t<d;t++){const d=e[t];if(d.isDirectionalLight){const e=r.directional[n];e.direction.setFromMatrixPosition(d.matrixWorld),o.setFromMatrixPosition(d.target.matrixWorld),e.direction.sub(o),e.direction.transformDirection(h),n++}else if(d.isSpotLight){const e=r.spot[l];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),e.direction.setFromMatrixPosition(d.matrixWorld),o.setFromMatrixPosition(d.target.matrixWorld),e.direction.sub(o),e.direction.transformDirection(h),l++}else if(d.isRectAreaLight){const e=r.rectArea[c];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),s.identity(),a.copy(d.matrixWorld),a.premultiply(h),s.extractRotation(a),e.halfWidth.set(.5*d.width,0,0),e.halfHeight.set(0,.5*d.height,0),e.halfWidth.applyMatrix4(s),e.halfHeight.applyMatrix4(s),c++}else if(d.isPointLight){const e=r.point[i];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),i++}else if(d.isHemisphereLight){const e=r.hemi[u];e.direction.setFromMatrixPosition(d.matrixWorld),e.direction.transformDirection(h),e.direction.normalize(),u++}}},state:r}}function nl(e,t){const n=new tl(e,t),i=[],r=[];return{init:function(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:function(){n.setup(i)},setupLightsView:function(e){n.setupView(i,e)},pushLight:function(e){i.push(e)},pushShadow:function(e){r.push(e)}}}function il(e,t){let n=new WeakMap;return{get:function(i,r=0){let o;return!1===n.has(i)?(o=new nl(e,t),n.set(i,[o])):r>=n.get(i).length?(o=new nl(e,t),n.get(i).push(o)):o=n.get(i)[r],o},dispose:function(){n=new WeakMap}}}class rl extends Hr{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=un,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}rl.prototype.isMeshDepthMaterial=!0;class ol extends Hr{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new Si,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}ol.prototype.isMeshDistanceMaterial=!0;function al(e,t,n){let i=new ta;const r=new di,o=new di,a=new bi,s=[],l=[],c={},u=n.maxTextureSize,h={0:_,1:b,2:x},d=new qo({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new di},radius:{value:4}},vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}\n",fragmentShader:"\nuniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n\n#include <packing>\n\nvoid main() {\n\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\n\t// This seems totally useless but it's a crazy work around for a Adreno compiler bug\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\n\t\t#ifdef HORIZONTAL_PASS\n\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\n\t\t#else\n\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\n\t\t#endif\n\n\t}\n\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n\n}\n"}),p=d.clone();p.defines.HORIZONTAL_PASS=1;const f=new Eo;f.setAttribute("position",new eo(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new Vo(f,d),v=this;function E(n,i){const r=t.update(m);d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(i,null,r,d,m,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(i,null,r,p,m,null)}function w(e){const t=e<<0;let n=s[t];return void 0===n&&(n=new rl({depthPacking:hn,morphTargets:e}),s[t]=n),n}function A(e){const t=e<<0;let n=l[t];return void 0===n&&(n=new ol({morphTargets:e}),l[t]=n),n}function M(t,n,i,r,o,a,s){let l=null,u=w,d=t.customDepthMaterial;if(!0===r.isPointLight&&(u=A,d=t.customDistanceMaterial),void 0===d){let e=!1;!0===i.morphTargets&&(e=n.morphAttributes&&n.morphAttributes.position&&n.morphAttributes.position.length>0),l=u(e)}else l=d;if(e.localClippingEnabled&&!0===i.clipShadows&&0!==i.clippingPlanes.length){const e=l.uuid,t=i.uuid;let n=c[e];void 0===n&&(n={},c[e]=n);let r=n[t];void 0===r&&(r=l.clone(),n[t]=r),l=r}return l.visible=i.visible,l.wireframe=i.wireframe,l.side=s===y?null!==i.shadowSide?i.shadowSide:i.side:null!==i.shadowSide?i.shadowSide:h[i.side],l.clipShadows=i.clipShadows,l.clippingPlanes=i.clippingPlanes,l.clipIntersection=i.clipIntersection,l.wireframeLinewidth=i.wireframeLinewidth,l.linewidth=i.linewidth,!0===r.isPointLight&&!0===l.isMeshDistanceMaterial&&(l.referencePosition.setFromMatrixPosition(r.matrixWorld),l.nearDistance=o,l.farDistance=a),l}function T(n,r,o,a,s){if(!1===n.visible)return;if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&s===y)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);const i=t.update(n),r=n.material;if(Array.isArray(r)){const t=i.groups;for(let l=0,c=t.length;l<c;l++){const c=t[l],u=r[c.materialIndex];if(u&&u.visible){const t=M(n,i,u,a,o.near,o.far,s);e.renderBufferDirect(o,null,i,t,n,c)}}}else if(r.visible){const t=M(n,i,r,a,o.near,o.far,s);e.renderBufferDirect(o,null,i,t,n,null)}}const l=n.children;for(let e=0,t=l.length;e<t;e++)T(l[e],r,o,a,s)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=g,this.render=function(t,n,s){if(!1===v.enabled)return;if(!1===v.autoUpdate&&!1===v.needsUpdate)return;if(0===t.length)return;const l=e.getRenderTarget(),c=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),d=e.state;d.setBlending(S),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(let l=0,c=t.length;l<c;l++){const c=t[l],h=c.shadow;if(void 0===h){console.warn("THREE.WebGLShadowMap:",c,"has no shadow.");continue}if(!1===h.autoUpdate&&!1===h.needsUpdate)continue;r.copy(h.mapSize);const p=h.getFrameExtents();if(r.multiply(p),o.copy(h.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(o.x=Math.floor(u/p.x),r.x=o.x*p.x,h.mapSize.x=o.x),r.y>u&&(o.y=Math.floor(u/p.y),r.y=o.y*p.y,h.mapSize.y=o.y)),null===h.map&&!h.isPointLightShadow&&this.type===y){const e={minFilter:Se,magFilter:Se,format:He};h.map=new _i(r.x,r.y,e),h.map.texture.name=c.name+".shadowMap",h.mapPass=new _i(r.x,r.y,e),h.camera.updateProjectionMatrix()}if(null===h.map){const e={minFilter:be,magFilter:be,format:He};h.map=new _i(r.x,r.y,e),h.map.texture.name=c.name+".shadowMap",h.camera.updateProjectionMatrix()}e.setRenderTarget(h.map),e.clear();const f=h.getViewportCount();for(let e=0;e<f;e++){const t=h.getViewport(e);a.set(o.x*t.x,o.y*t.y,o.x*t.z,o.y*t.w),d.viewport(a),h.updateMatrices(c,e),i=h.getFrustum(),T(n,s,h.camera,c,this.type)}h.isPointLightShadow||this.type!==y||E(h,s),h.needsUpdate=!1}v.needsUpdate=!1,e.setRenderTarget(l,c,h)}}function sl(e,t,n){const i=n.isWebGL2;const r=new function(){let t=!1;const n=new bi;let i=null;const r=new bi(0,0,0,0);return{setMask:function(n){i===n||t||(e.colorMask(n,n,n,n),i=n)},setLocked:function(e){t=e},setClear:function(t,i,o,a,s){!0===s&&(t*=a,i*=a,o*=a),n.set(t,i,o,a),!1===r.equals(n)&&(e.clearColor(t,i,o,a),r.copy(n))},reset:function(){t=!1,i=null,r.set(-1,0,0,0)}}},o=new function(){let t=!1,n=null,i=null,r=null;return{setTest:function(t){t?ye(e.DEPTH_TEST):be(e.DEPTH_TEST)},setMask:function(i){n===i||t||(e.depthMask(i),n=i)},setFunc:function(t){if(i!==t){if(t)switch(t){case q:e.depthFunc(e.NEVER);break;case X:e.depthFunc(e.ALWAYS);break;case Y:e.depthFunc(e.LESS);break;default:e.depthFunc(e.LEQUAL);break;case Z:e.depthFunc(e.EQUAL);break;case J:e.depthFunc(e.GEQUAL);break;case Q:e.depthFunc(e.GREATER);break;case $:e.depthFunc(e.NOTEQUAL)}else e.depthFunc(e.LEQUAL);i=t}},setLocked:function(e){t=e},setClear:function(t){r!==t&&(e.clearDepth(t),r=t)},reset:function(){t=!1,n=null,i=null,r=null}}},a=new function(){let t=!1,n=null,i=null,r=null,o=null,a=null,s=null,l=null,c=null;return{setTest:function(n){t||(n?ye(e.STENCIL_TEST):be(e.STENCIL_TEST))},setMask:function(i){n===i||t||(e.stencilMask(i),n=i)},setFunc:function(t,n,a){i===t&&r===n&&o===a||(e.stencilFunc(t,n,a),i=t,r=n,o=a)},setOp:function(t,n,i){a===t&&s===n&&l===i||(e.stencilOp(t,n,i),a=t,s=n,l=i)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,i=null,r=null,o=null,a=null,s=null,l=null,c=null}}};let s={},l=null,c={},u=null,f=!1,m=null,g=null,v=null,y=null,b=null,E=null,w=null,ee=!1,te=null,ne=null,ie=null,re=null,oe=null;const ae=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let se=!1,le=0;const ce=e.getParameter(e.VERSION);-1!==ce.indexOf("WebGL")?(le=parseFloat(/^WebGL (\d)/.exec(ce)[1]),se=le>=1):-1!==ce.indexOf("OpenGL ES")&&(le=parseFloat(/^OpenGL ES (\d)/.exec(ce)[1]),se=le>=2);let ue=null,he={};const de=e.getParameter(e.SCISSOR_BOX),pe=e.getParameter(e.VIEWPORT),fe=(new bi).fromArray(de),me=(new bi).fromArray(pe);function ge(t,n,i){const r=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let t=0;t<i;t++)e.texImage2D(n+t,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,r);return o}const ve={};function ye(t){!0!==s[t]&&(e.enable(t),s[t]=!0)}function be(t){!1!==s[t]&&(e.disable(t),s[t]=!1)}ve[e.TEXTURE_2D]=ge(e.TEXTURE_2D,e.TEXTURE_2D,1),ve[e.TEXTURE_CUBE_MAP]=ge(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),r.setClear(0,0,0,1),o.setClear(1),a.setClear(0),ye(e.DEPTH_TEST),o.setFunc(K),we(!1),Se(d),ye(e.CULL_FACE),Ee(S);const _e={[L]:e.FUNC_ADD,[R]:e.FUNC_SUBTRACT,[D]:e.FUNC_REVERSE_SUBTRACT};if(i)_e[I]=e.MIN,_e[O]=e.MAX;else{const e=t.get("EXT_blend_minmax");null!==e&&(_e[I]=e.MIN_EXT,_e[O]=e.MAX_EXT)}const xe={[N]:e.ZERO,[k]:e.ONE,[F]:e.SRC_COLOR,[B]:e.SRC_ALPHA,[j]:e.SRC_ALPHA_SATURATE,[H]:e.DST_COLOR,[G]:e.DST_ALPHA,[U]:e.ONE_MINUS_SRC_COLOR,[V]:e.ONE_MINUS_SRC_ALPHA,[W]:e.ONE_MINUS_DST_COLOR,[z]:e.ONE_MINUS_DST_ALPHA};function Ee(t,n,i,r,o,a,s,l){if(t!==S){if(!1===f&&(ye(e.BLEND),f=!0),t===P)o=o||n,a=a||i,s=s||r,n===g&&o===b||(e.blendEquationSeparate(_e[n],_e[o]),g=n,b=o),i===v&&r===y&&a===E&&s===w||(e.blendFuncSeparate(xe[i],xe[r],xe[a],xe[s]),v=i,y=r,E=a,w=s),m=t,ee=null;else if(t!==m||l!==ee){if(g===L&&b===L||(e.blendEquation(e.FUNC_ADD),g=L,b=L),l)switch(t){case A:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case M:e.blendFunc(e.ONE,e.ONE);break;case T:e.blendFuncSeparate(e.ZERO,e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ONE_MINUS_SRC_ALPHA);break;case C:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case A:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case M:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case T:e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR);break;case C:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}v=null,y=null,E=null,w=null,m=t,ee=l}}else!0===f&&(be(e.BLEND),f=!1)}function we(t){te!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),te=t)}function Se(t){t!==h?(ye(e.CULL_FACE),t!==ne&&(t===d?e.cullFace(e.BACK):t===p?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):be(e.CULL_FACE),ne=t}function Ae(t,n,i){t?(ye(e.POLYGON_OFFSET_FILL),re===n&&oe===i||(e.polygonOffset(n,i),re=n,oe=i)):be(e.POLYGON_OFFSET_FILL)}function Me(t){void 0===t&&(t=e.TEXTURE0+ae-1),ue!==t&&(e.activeTexture(t),ue=t)}return{buffers:{color:r,depth:o,stencil:a},enable:ye,disable:be,bindFramebuffer:function(t,n){return null===n&&null!==l&&(n=l),c[t]!==n&&(e.bindFramebuffer(t,n),c[t]=n,i&&(t===e.DRAW_FRAMEBUFFER&&(c[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(c[e.DRAW_FRAMEBUFFER]=n)),!0)},bindXRFramebuffer:function(t){t!==l&&(e.bindFramebuffer(e.FRAMEBUFFER,t),l=t)},useProgram:function(t){return u!==t&&(e.useProgram(t),u=t,!0)},setBlending:Ee,setMaterial:function(t,n){t.side===x?be(e.CULL_FACE):ye(e.CULL_FACE);let i=t.side===_;n&&(i=!i),we(i),t.blending===A&&!1===t.transparent?Ee(S):Ee(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),o.setFunc(t.depthFunc),o.setTest(t.depthTest),o.setMask(t.depthWrite),r.setMask(t.colorWrite);const s=t.stencilWrite;a.setTest(s),s&&(a.setMask(t.stencilWriteMask),a.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),a.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),Ae(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?ye(e.SAMPLE_ALPHA_TO_COVERAGE):be(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:we,setCullFace:Se,setLineWidth:function(t){t!==ie&&(se&&e.lineWidth(t),ie=t)},setPolygonOffset:Ae,setScissorTest:function(t){t?ye(e.SCISSOR_TEST):be(e.SCISSOR_TEST)},activeTexture:Me,bindTexture:function(t,n){null===ue&&Me();let i=he[ue];void 0===i&&(i={type:void 0,texture:void 0},he[ue]=i),i.type===t&&i.texture===n||(e.bindTexture(t,n||ve[t]),i.type=t,i.texture=n)},unbindTexture:function(){const t=he[ue];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===fe.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),fe.copy(t))},viewport:function(t){!1===me.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),me.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),!0===i&&(e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),s={},ue=null,he={},l=null,c={},u=null,f=!1,m=null,g=null,v=null,y=null,b=null,E=null,w=null,ee=!1,te=null,ne=null,ie=null,re=null,oe=null,fe.set(0,0,e.canvas.width,e.canvas.height),me.set(0,0,e.canvas.width,e.canvas.height),r.reset(),o.reset(),a.reset()}}}function ll(e,t,n,i,r,o,a){const s=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,h=r.maxSamples,d=new WeakMap;let p,f=!1;try{f="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function m(e,t){return f?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function g(e,t,n,i){let r=1;if((e.width>i||e.height>i)&&(r=i/Math.max(e.width,e.height)),r<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const i=t?ui:Math.floor,o=i(r*e.width),a=i(r*e.height);void 0===p&&(p=m(o,a));const s=n?m(o,a):p;s.width=o,s.height=a;return s.getContext("2d").drawImage(e,0,0,o,a),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+o+"x"+a+")."),s}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function v(e){return li(e.width)&&li(e.height)}function y(e,t){return e.generateMipmaps&&t&&e.minFilter!==be&&e.minFilter!==Se}function b(t,n,r,o){e.generateMipmap(t);i.get(n).__maxMipLevel=Math.log2(Math.max(r,o))}function _(n,i,r){if(!1===s)return i;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let o=i;return i===e.RED&&(r===e.FLOAT&&(o=e.R32F),r===e.HALF_FLOAT&&(o=e.R16F),r===e.UNSIGNED_BYTE&&(o=e.R8)),i===e.RGB&&(r===e.FLOAT&&(o=e.RGB32F),r===e.HALF_FLOAT&&(o=e.RGB16F),r===e.UNSIGNED_BYTE&&(o=e.RGB8)),i===e.RGBA&&(r===e.FLOAT&&(o=e.RGBA32F),r===e.HALF_FLOAT&&(o=e.RGBA16F),r===e.UNSIGNED_BYTE&&(o=e.RGBA8)),o!==e.R16F&&o!==e.R32F&&o!==e.RGBA16F&&o!==e.RGBA32F||t.get("EXT_color_buffer_float"),o}function x(t){return t===be||t===_e||t===Ee?e.NEAREST:e.LINEAR}function E(t){const n=t.target;n.removeEventListener("dispose",E),function(t){const n=i.get(t);if(void 0===n.__webglInit)return;e.deleteTexture(n.__webglTexture),i.remove(t)}(n),n.isVideoTexture&&d.delete(n),a.memory.textures--}function w(t){const n=t.target;n.removeEventListener("dispose",w),function(t){const n=t.texture,r=i.get(t),o=i.get(n);if(!t)return;void 0!==o.__webglTexture&&(e.deleteTexture(o.__webglTexture),a.memory.textures--);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(let t=0;t<6;t++)e.deleteFramebuffer(r.__webglFramebuffer[t]),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer[t]);else e.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&e.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer&&e.deleteRenderbuffer(r.__webglColorRenderbuffer),r.__webglDepthRenderbuffer&&e.deleteRenderbuffer(r.__webglDepthRenderbuffer);if(t.isWebGLMultipleRenderTargets)for(let t=0,r=n.length;t<r;t++){const r=i.get(n[t]);r.__webglTexture&&(e.deleteTexture(r.__webglTexture),a.memory.textures--),i.remove(n[t])}i.remove(n),i.remove(t)}(n)}let S=0;function A(t,r){const o=i.get(t);if(t.isVideoTexture&&function(e){const t=a.render.frame;d.get(e)!==t&&(d.set(e,t),e.update())}(t),t.version>0&&o.__version!==t.version){const e=t.image;if(void 0===e)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==e.complete)return void R(o,t,r);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(e.TEXTURE0+r),n.bindTexture(e.TEXTURE_2D,o.__webglTexture)}function M(t,r){const a=i.get(t);t.version>0&&a.__version!==t.version?function(t,i,r){if(6!==i.image.length)return;L(t,i),n.activeTexture(e.TEXTURE0+r),n.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,i.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE);const a=i&&(i.isCompressedTexture||i.image[0].isCompressedTexture),l=i.image[0]&&i.image[0].isDataTexture,u=[];for(let e=0;e<6;e++)u[e]=a||l?l?i.image[e].image:i.image[e]:g(i.image[e],!1,!0,c);const h=u[0],d=v(h)||s,p=o.convert(i.format),f=o.convert(i.type),m=_(i.internalFormat,p,f);let x;if(P(e.TEXTURE_CUBE_MAP,i,d),a){for(let t=0;t<6;t++){x=u[t].mipmaps;for(let r=0;r<x.length;r++){const o=x[r];i.format!==He&&i.format!==ze?null!==p?n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,m,o.width,o.height,0,o.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,m,o.width,o.height,0,p,f,o.data)}}t.__maxMipLevel=x.length-1}else{x=i.mipmaps;for(let t=0;t<6;t++)if(l){n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,m,u[t].width,u[t].height,0,p,f,u[t].data);for(let i=0;i<x.length;i++){const r=x[i].image[t].image;n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,m,r.width,r.height,0,p,f,r.data)}}else{n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,m,p,f,u[t]);for(let i=0;i<x.length;i++){const r=x[i];n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,m,p,f,r.image[t])}}t.__maxMipLevel=x.length}y(i,d)&&b(e.TEXTURE_CUBE_MAP,i,h.width,h.height);t.__version=i.version,i.onUpdate&&i.onUpdate(i)}(a,t,r):(n.activeTexture(e.TEXTURE0+r),n.bindTexture(e.TEXTURE_CUBE_MAP,a.__webglTexture))}const T={[ge]:e.REPEAT,[ve]:e.CLAMP_TO_EDGE,[ye]:e.MIRRORED_REPEAT},C={[be]:e.NEAREST,[_e]:e.NEAREST_MIPMAP_NEAREST,[Ee]:e.NEAREST_MIPMAP_LINEAR,[Se]:e.LINEAR,[Ae]:e.LINEAR_MIPMAP_NEAREST,[Te]:e.LINEAR_MIPMAP_LINEAR};function P(n,o,a){if(a?(e.texParameteri(n,e.TEXTURE_WRAP_S,T[o.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,T[o.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,T[o.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,C[o.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,C[o.minFilter])):(e.texParameteri(n,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(n,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,e.CLAMP_TO_EDGE),o.wrapS===ve&&o.wrapT===ve||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,e.TEXTURE_MAG_FILTER,x(o.magFilter)),e.texParameteri(n,e.TEXTURE_MIN_FILTER,x(o.minFilter)),o.minFilter!==be&&o.minFilter!==Se&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){const a=t.get("EXT_texture_filter_anisotropic");if(o.type===Ne&&!1===t.has("OES_texture_float_linear"))return;if(!1===s&&o.type===ke&&!1===t.has("OES_texture_half_float_linear"))return;(o.anisotropy>1||i.get(o).__currentAnisotropy)&&(e.texParameterf(n,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,r.getMaxAnisotropy())),i.get(o).__currentAnisotropy=o.anisotropy)}}function L(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",E),t.__webglTexture=e.createTexture(),a.memory.textures++)}function R(t,i,r){let a=e.TEXTURE_2D;i.isDataTexture2DArray&&(a=e.TEXTURE_2D_ARRAY),i.isDataTexture3D&&(a=e.TEXTURE_3D),L(t,i),n.activeTexture(e.TEXTURE0+r),n.bindTexture(a,t.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,i.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE);const l=function(e){return!s&&(e.wrapS!==ve||e.wrapT!==ve||e.minFilter!==be&&e.minFilter!==Se)}(i)&&!1===v(i.image),c=g(i.image,l,!1,u),h=v(c)||s,d=o.convert(i.format);let p,f=o.convert(i.type),m=_(i.internalFormat,d,f);P(a,i,h);const x=i.mipmaps;if(i.isDepthTexture)m=e.DEPTH_COMPONENT,s?m=i.type===Ne?e.DEPTH_COMPONENT32F:i.type===Oe?e.DEPTH_COMPONENT24:i.type===Ve?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT16:i.type===Ne&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),i.format===Xe&&m===e.DEPTH_COMPONENT&&i.type!==De&&i.type!==Oe&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=De,f=o.convert(i.type)),i.format===Ye&&m===e.DEPTH_COMPONENT&&(m=e.DEPTH_STENCIL,i.type!==Ve&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=Ve,f=o.convert(i.type))),n.texImage2D(e.TEXTURE_2D,0,m,c.width,c.height,0,d,f,null);else if(i.isDataTexture)if(x.length>0&&h){for(let t=0,i=x.length;t<i;t++)p=x[t],n.texImage2D(e.TEXTURE_2D,t,m,p.width,p.height,0,d,f,p.data);i.generateMipmaps=!1,t.__maxMipLevel=x.length-1}else n.texImage2D(e.TEXTURE_2D,0,m,c.width,c.height,0,d,f,c.data),t.__maxMipLevel=0;else if(i.isCompressedTexture){for(let t=0,r=x.length;t<r;t++)p=x[t],i.format!==He&&i.format!==ze?null!==d?n.compressedTexImage2D(e.TEXTURE_2D,t,m,p.width,p.height,0,p.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(e.TEXTURE_2D,t,m,p.width,p.height,0,d,f,p.data);t.__maxMipLevel=x.length-1}else if(i.isDataTexture2DArray)n.texImage3D(e.TEXTURE_2D_ARRAY,0,m,c.width,c.height,c.depth,0,d,f,c.data),t.__maxMipLevel=0;else if(i.isDataTexture3D)n.texImage3D(e.TEXTURE_3D,0,m,c.width,c.height,c.depth,0,d,f,c.data),t.__maxMipLevel=0;else if(x.length>0&&h){for(let t=0,i=x.length;t<i;t++)p=x[t],n.texImage2D(e.TEXTURE_2D,t,m,d,f,p);i.generateMipmaps=!1,t.__maxMipLevel=x.length-1}else n.texImage2D(e.TEXTURE_2D,0,m,d,f,c),t.__maxMipLevel=0;y(i,h)&&b(a,i,c.width,c.height),t.__version=i.version,i.onUpdate&&i.onUpdate(i)}function D(t,r,a,s,l){const c=o.convert(a.format),u=o.convert(a.type),h=_(a.internalFormat,c,u);l===e.TEXTURE_3D||l===e.TEXTURE_2D_ARRAY?n.texImage3D(l,0,h,r.width,r.height,r.depth,0,c,u,null):n.texImage2D(l,0,h,r.width,r.height,0,c,u,null),n.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,s,l,i.get(a).__webglTexture,0),n.bindFramebuffer(e.FRAMEBUFFER,null)}function I(t,n,i){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer&&!n.stencilBuffer){let r=e.DEPTH_COMPONENT16;if(i){const t=n.depthTexture;t&&t.isDepthTexture&&(t.type===Ne?r=e.DEPTH_COMPONENT32F:t.type===Oe&&(r=e.DEPTH_COMPONENT24));const i=N(n);e.renderbufferStorageMultisample(e.RENDERBUFFER,i,r,n.width,n.height)}else e.renderbufferStorage(e.RENDERBUFFER,r,n.width,n.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)}else if(n.depthBuffer&&n.stencilBuffer){if(i){const t=N(n);e.renderbufferStorageMultisample(e.RENDERBUFFER,t,e.DEPTH24_STENCIL8,n.width,n.height)}else e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,n.width,n.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)}else{const t=!0===n.isWebGLMultipleRenderTargets?n.texture[0]:n.texture,r=o.convert(t.format),a=o.convert(t.type),s=_(t.internalFormat,r,a);if(i){const t=N(n);e.renderbufferStorageMultisample(e.RENDERBUFFER,t,s,n.width,n.height)}else e.renderbufferStorage(e.RENDERBUFFER,s,n.width,n.height)}e.bindRenderbuffer(e.RENDERBUFFER,null)}function O(t){const r=i.get(t),o=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(o)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(e.FRAMEBUFFER,t),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),A(r.depthTexture,0);const o=i.get(r.depthTexture).__webglTexture;if(r.depthTexture.format===Xe)e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,o,0);else{if(r.depthTexture.format!==Ye)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,o,0)}}(r.__webglFramebuffer,t)}else if(o){r.__webglDepthbuffer=[];for(let i=0;i<6;i++)n.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer[i]),r.__webglDepthbuffer[i]=e.createRenderbuffer(),I(r.__webglDepthbuffer[i],t,!1)}else n.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer),r.__webglDepthbuffer=e.createRenderbuffer(),I(r.__webglDepthbuffer,t,!1);n.bindFramebuffer(e.FRAMEBUFFER,null)}function N(e){return s&&e.isWebGLMultisampleRenderTarget?Math.min(h,e.samples):0}let k=!1,F=!1;this.allocateTextureUnit=function(){const e=S;return e>=l&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+l),S+=1,e},this.resetTextureUnits=function(){S=0},this.setTexture2D=A,this.setTexture2DArray=function(t,r){const o=i.get(t);t.version>0&&o.__version!==t.version?R(o,t,r):(n.activeTexture(e.TEXTURE0+r),n.bindTexture(e.TEXTURE_2D_ARRAY,o.__webglTexture))},this.setTexture3D=function(t,r){const o=i.get(t);t.version>0&&o.__version!==t.version?R(o,t,r):(n.activeTexture(e.TEXTURE0+r),n.bindTexture(e.TEXTURE_3D,o.__webglTexture))},this.setTextureCube=M,this.setupRenderTarget=function(t){const l=t.texture,c=i.get(t),u=i.get(l);t.addEventListener("dispose",w),!0!==t.isWebGLMultipleRenderTargets&&(u.__webglTexture=e.createTexture(),u.__version=l.version,a.memory.textures++);const h=!0===t.isWebGLCubeRenderTarget,d=!0===t.isWebGLMultipleRenderTargets,p=!0===t.isWebGLMultisampleRenderTarget,f=l.isDataTexture3D||l.isDataTexture2DArray,m=v(t)||s;if(!s||l.format!==ze||l.type!==Ne&&l.type!==ke||(l.format=He,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),h){c.__webglFramebuffer=[];for(let t=0;t<6;t++)c.__webglFramebuffer[t]=e.createFramebuffer()}else if(c.__webglFramebuffer=e.createFramebuffer(),d)if(r.drawBuffers){const n=t.texture;for(let t=0,r=n.length;t<r;t++){const r=i.get(n[t]);void 0===r.__webglTexture&&(r.__webglTexture=e.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(p)if(s){c.__webglMultisampledFramebuffer=e.createFramebuffer(),c.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,c.__webglColorRenderbuffer);const i=o.convert(l.format),r=o.convert(l.type),a=_(l.internalFormat,i,r),s=N(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,s,a,t.width,t.height),n.bindFramebuffer(e.FRAMEBUFFER,c.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,c.__webglColorRenderbuffer),e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(c.__webglDepthRenderbuffer=e.createRenderbuffer(),I(c.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(h){n.bindTexture(e.TEXTURE_CUBE_MAP,u.__webglTexture),P(e.TEXTURE_CUBE_MAP,l,m);for(let n=0;n<6;n++)D(c.__webglFramebuffer[n],t,l,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n);y(l,m)&&b(e.TEXTURE_CUBE_MAP,l,t.width,t.height),n.bindTexture(e.TEXTURE_CUBE_MAP,null)}else if(d){const r=t.texture;for(let o=0,a=r.length;o<a;o++){const a=r[o],s=i.get(a);n.bindTexture(e.TEXTURE_2D,s.__webglTexture),P(e.TEXTURE_2D,a,m),D(c.__webglFramebuffer,t,a,e.COLOR_ATTACHMENT0+o,e.TEXTURE_2D),y(a,m)&&b(e.TEXTURE_2D,a,t.width,t.height)}n.bindTexture(e.TEXTURE_2D,null)}else{let i=e.TEXTURE_2D;if(f)if(s){i=l.isDataTexture3D?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY}else console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.");n.bindTexture(i,u.__webglTexture),P(i,l,m),D(c.__webglFramebuffer,t,l,e.COLOR_ATTACHMENT0,i),y(l,m)&&b(e.TEXTURE_2D,l,t.width,t.height),n.bindTexture(e.TEXTURE_2D,null)}t.depthBuffer&&O(t)},this.updateRenderTargetMipmap=function(t){const r=v(t)||s,o=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture];for(let a=0,s=o.length;a<s;a++){const s=o[a];if(y(s,r)){const r=t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,o=i.get(s).__webglTexture;n.bindTexture(r,o),b(r,s,t.width,t.height),n.bindTexture(r,null)}}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(s){const r=t.width,o=t.height;let a=e.COLOR_BUFFER_BIT;t.depthBuffer&&(a|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&(a|=e.STENCIL_BUFFER_BIT);const s=i.get(t);n.bindFramebuffer(e.READ_FRAMEBUFFER,s.__webglMultisampledFramebuffer),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,s.__webglFramebuffer),e.blitFramebuffer(0,0,r,o,0,0,r,o,a,e.NEAREST),n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,s.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===k&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),k=!0),e=e.texture),A(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===F&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),F=!0),e=e.texture),M(e,t)}}function cl(e,t,n){const i=n.isWebGL2;return{convert:function(n){let r;if(n===Pe)return e.UNSIGNED_BYTE;if(n===Fe)return e.UNSIGNED_SHORT_4_4_4_4;if(n===Ue)return e.UNSIGNED_SHORT_5_5_5_1;if(n===Be)return e.UNSIGNED_SHORT_5_6_5;if(n===Le)return e.BYTE;if(n===Re)return e.SHORT;if(n===De)return e.UNSIGNED_SHORT;if(n===Ie)return e.INT;if(n===Oe)return e.UNSIGNED_INT;if(n===Ne)return e.FLOAT;if(n===ke)return i?e.HALF_FLOAT:(r=t.get("OES_texture_half_float"),null!==r?r.HALF_FLOAT_OES:null);if(n===Ge)return e.ALPHA;if(n===ze)return e.RGB;if(n===He)return e.RGBA;if(n===We)return e.LUMINANCE;if(n===je)return e.LUMINANCE_ALPHA;if(n===Xe)return e.DEPTH_COMPONENT;if(n===Ye)return e.DEPTH_STENCIL;if(n===Ke)return e.RED;if(n===Ze)return e.RED_INTEGER;if(n===Je)return e.RG;if(n===Qe)return e.RG_INTEGER;if(n===$e)return e.RGB_INTEGER;if(n===et)return e.RGBA_INTEGER;if(n===tt||n===nt||n===it||n===rt){if(r=t.get("WEBGL_compressed_texture_s3tc"),null===r)return null;if(n===tt)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===nt)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===it)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===rt)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===ot||n===at||n===st||n===lt){if(r=t.get("WEBGL_compressed_texture_pvrtc"),null===r)return null;if(n===ot)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===at)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===st)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===lt)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===ct)return r=t.get("WEBGL_compressed_texture_etc1"),null!==r?r.COMPRESSED_RGB_ETC1_WEBGL:null;if((n===ut||n===ht)&&(r=t.get("WEBGL_compressed_texture_etc"),null!==r)){if(n===ut)return r.COMPRESSED_RGB8_ETC2;if(n===ht)return r.COMPRESSED_RGBA8_ETC2_EAC}return n===dt||n===pt||n===ft||n===mt||n===gt||n===vt||n===yt||n===bt||n===_t||n===xt||n===Et||n===wt||n===St||n===At||n===Tt||n===Ct||n===Pt||n===Lt||n===Rt||n===Dt||n===It||n===Ot||n===Nt||n===kt||n===Ft||n===Ut||n===Bt||n===Vt?(r=t.get("WEBGL_compressed_texture_astc"),null!==r?n:null):n===Mt?(r=t.get("EXT_texture_compression_bptc"),null!==r?n:null):n===Ve?i?e.UNSIGNED_INT_24_8:(r=t.get("WEBGL_depth_texture"),null!==r?r.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}class ul extends Yo{constructor(e=[]){super(),this.cameras=e}}ul.prototype.isArrayCamera=!0;class hl extends Mr{constructor(){super(),this.type="Group"}}hl.prototype.isGroup=!0;const dl={type:"move"};class pl{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new hl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new hl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Si,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Si),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new hl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Si,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Si),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let i=null,r=null,o=null;const a=this._targetRay,s=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==a&&(i=t.getPose(e.targetRaySpace,n),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(dl))),l&&e.hand){o=!0;for(const i of e.hand.values()){const e=t.getJointPose(i,n);if(void 0===l.joints[i.jointName]){const e=new hl;e.matrixAutoUpdate=!1,e.visible=!1,l.joints[i.jointName]=e,l.add(e)}const r=l.joints[i.jointName];null!==e&&(r.matrix.fromArray(e.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.jointRadius=e.radius),r.visible=null!==e}const i=l.joints["index-finger-tip"],r=l.joints["thumb-tip"],a=i.position.distanceTo(r.position),s=.02,c=.005;l.inputState.pinching&&a>s+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&a<=s-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==s&&e.gripSpace&&(r=t.getPose(e.gripSpace,n),null!==r&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1));return null!==a&&(a.visible=null!==i),null!==s&&(s.visible=null!==r),null!==l&&(l.visible=null!==o),this}}class fl extends Gn{constructor(e,t){super();const n=this,i=e.state;let r=null,o=1,a=null,s="local-floor",l=null;const c=[],u=new Map,h=new Yo;h.layers.enable(1),h.viewport=new bi;const d=new Yo;d.layers.enable(2),d.viewport=new bi;const p=[h,d],f=new ul;f.layers.enable(1),f.layers.enable(2);let m=null,g=null;function v(e){const t=u.get(e.inputSource);t&&t.dispatchEvent({type:e.type,data:e.inputSource})}function y(){u.forEach((function(e,t){e.disconnect(t)})),u.clear(),m=null,g=null,i.bindXRFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),S.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function b(e){const t=r.inputSources;for(let e=0;e<c.length;e++)u.set(t[e],c[e]);for(let t=0;t<e.removed.length;t++){const n=e.removed[t],i=u.get(n);i&&(i.dispatchEvent({type:"disconnected",data:n}),u.delete(n))}for(let t=0;t<e.added.length;t++){const n=e.added[t],i=u.get(n);i&&i.dispatchEvent({type:"connected",data:n})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=c[e];return void 0===t&&(t=new pl,c[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=c[e];return void 0===t&&(t=new pl,c[e]=t),t.getGripSpace()},this.getHand=function(e){let t=c[e];return void 0===t&&(t=new pl,c[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){o=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){s=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return a},this.getSession=function(){return r},this.setSession=async function(e){if(r=e,null!==r){r.addEventListener("select",v),r.addEventListener("selectstart",v),r.addEventListener("selectend",v),r.addEventListener("squeeze",v),r.addEventListener("squeezestart",v),r.addEventListener("squeezeend",v),r.addEventListener("end",y),r.addEventListener("inputsourceschange",b);const e=t.getContextAttributes();!0!==e.xrCompatible&&await t.makeXRCompatible();const i={antialias:e.antialias,alpha:e.alpha,depth:e.depth,stencil:e.stencil,framebufferScaleFactor:o},l=new XRWebGLLayer(r,t,i);r.updateRenderState({baseLayer:l}),a=await r.requestReferenceSpace(s),S.setContext(r),S.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const _=new Si,x=new Si;function E(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===r)return;f.near=d.near=h.near=e.near,f.far=d.far=h.far=e.far,m===f.near&&g===f.far||(r.updateRenderState({depthNear:f.near,depthFar:f.far}),m=f.near,g=f.far);const t=e.parent,n=f.cameras;E(f,t);for(let e=0;e<n.length;e++)E(n[e],t);e.matrixWorld.copy(f.matrixWorld),e.matrix.copy(f.matrix),e.matrix.decompose(e.position,e.quaternion,e.scale);const i=e.children;for(let e=0,t=i.length;e<t;e++)i[e].updateMatrixWorld(!0);2===n.length?function(e,t,n){_.setFromMatrixPosition(t.matrixWorld),x.setFromMatrixPosition(n.matrixWorld);const i=_.distanceTo(x),r=t.projectionMatrix.elements,o=n.projectionMatrix.elements,a=r[14]/(r[10]-1),s=r[14]/(r[10]+1),l=(r[9]+1)/r[5],c=(r[9]-1)/r[5],u=(r[8]-1)/r[0],h=(o[8]+1)/o[0],d=a*u,p=a*h,f=i/(-u+h),m=f*-u;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();const g=a+f,v=s+f,y=d-m,b=p+(i-m),E=l*s/v*g,w=c*s/v*g;e.projectionMatrix.makePerspective(y,b,E,w,g,v)}(f,h,d):f.projectionMatrix.copy(h.projectionMatrix)},this.getCamera=function(){return f};let w=null;const S=new na;S.setAnimationLoop((function(e,t){if(l=t.getViewerPose(a),null!==l){const e=l.views,t=r.renderState.baseLayer;i.bindXRFramebuffer(t.framebuffer);let n=!1;e.length!==f.cameras.length&&(f.cameras.length=0,n=!0);for(let i=0;i<e.length;i++){const r=e[i],o=t.getViewport(r),a=p[i];a.matrix.fromArray(r.transform.matrix),a.projectionMatrix.fromArray(r.projectionMatrix),a.viewport.set(o.x,o.y,o.width,o.height),0===i&&f.matrix.copy(a.matrix),!0===n&&f.cameras.push(a)}}const n=r.inputSources;for(let e=0;e<c.length;e++){const i=c[e],r=n[e];i.update(r,t,a)}w&&w(e,t)})),this.setAnimationLoop=function(e){w=e},this.dispose=function(){}}}function ml(e){function t(t,n){t.opacity.value=n.opacity,n.color&&t.diffuse.value.copy(n.color),n.emissive&&t.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(t.map.value=n.map),n.alphaMap&&(t.alphaMap.value=n.alphaMap),n.specularMap&&(t.specularMap.value=n.specularMap);const i=e.get(n).envMap;if(i){t.envMap.value=i,t.flipEnvMap.value=i.isCubeTexture&&i._needsFlipEnvMap?-1:1,t.reflectivity.value=n.reflectivity,t.refractionRatio.value=n.refractionRatio;const r=e.get(i).__maxMipLevel;void 0!==r&&(t.maxMipLevel.value=r)}let r,o;n.lightMap&&(t.lightMap.value=n.lightMap,t.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(t.aoMap.value=n.aoMap,t.aoMapIntensity.value=n.aoMapIntensity),n.map?r=n.map:n.specularMap?r=n.specularMap:n.displacementMap?r=n.displacementMap:n.normalMap?r=n.normalMap:n.bumpMap?r=n.bumpMap:n.roughnessMap?r=n.roughnessMap:n.metalnessMap?r=n.metalnessMap:n.alphaMap?r=n.alphaMap:n.emissiveMap?r=n.emissiveMap:n.clearcoatMap?r=n.clearcoatMap:n.clearcoatNormalMap?r=n.clearcoatNormalMap:n.clearcoatRoughnessMap&&(r=n.clearcoatRoughnessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix)),n.aoMap?o=n.aoMap:n.lightMap&&(o=n.lightMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),t.uv2Transform.value.copy(o.matrix))}function n(t,n){t.roughness.value=n.roughness,t.metalness.value=n.metalness,n.roughnessMap&&(t.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(t.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(t.emissiveMap.value=n.emissiveMap),n.bumpMap&&(t.bumpMap.value=n.bumpMap,t.bumpScale.value=n.bumpScale,n.side===_&&(t.bumpScale.value*=-1)),n.normalMap&&(t.normalMap.value=n.normalMap,t.normalScale.value.copy(n.normalScale),n.side===_&&t.normalScale.value.negate()),n.displacementMap&&(t.displacementMap.value=n.displacementMap,t.displacementScale.value=n.displacementScale,t.displacementBias.value=n.displacementBias);e.get(n).envMap&&(t.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,i,r,o,a){i.isMeshBasicMaterial?t(e,i):i.isMeshLambertMaterial?(t(e,i),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(e,i)):i.isMeshToonMaterial?(t(e,i),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap);t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===_&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===_&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,i)):i.isMeshPhongMaterial?(t(e,i),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===_&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===_&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,i)):i.isMeshStandardMaterial?(t(e,i),i.isMeshPhysicalMaterial?function(e,t,i){n(e,t),e.reflectivity.value=t.reflectivity,e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.sheen&&e.sheen.value.copy(t.sheen);t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap);t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap);t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,t.side===_&&e.clearcoatNormalScale.value.negate());e.transmission.value=t.transmission,t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap);t.transmission>0&&(e.transmissionSamplerMap.value=i.texture,e.transmissionSamplerSize.value.set(i.width,i.height));e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap);e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor)}(e,i,a):n(e,i)):i.isMeshMatcapMaterial?(t(e,i),function(e,t){t.matcap&&(e.matcap.value=t.matcap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===_&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===_&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,i)):i.isMeshDepthMaterial?(t(e,i),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,i)):i.isMeshDistanceMaterial?(t(e,i),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,i)):i.isMeshNormalMaterial?(t(e,i),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===_&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===_&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,i)):i.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,i),i.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,i)):i.isPointsMaterial?function(e,t,n,i){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*i,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);let r;t.map?r=t.map:t.alphaMap&&(r=t.alphaMap);void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix))}(e,i,r,o):i.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);let n;t.map?n=t.map:t.alphaMap&&(n=t.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,i):i.isShadowMaterial?(e.color.value.copy(i.color),e.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function gl(e){const t=void 0!==(e=e||{}).canvas?e.canvas:function(){const e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return e.style.display="block",e}(),n=void 0!==e.context?e.context:null,i=void 0!==e.alpha&&e.alpha,r=void 0===e.depth||e.depth,o=void 0===e.stencil||e.stencil,a=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=void 0!==e.powerPreference?e.powerPreference:"default",u=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat;let h=null,d=null;const p=[],f=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=tn,this.physicallyCorrectLights=!1,this.toneMapping=ie,this.toneMappingExposure=1;const m=this;let g=!1,v=0,y=0,b=null,_=-1,x=null;const E=new bi,w=new bi;let S=null,A=t.width,M=t.height,T=1,C=null,P=null;const L=new bi(0,0,A,M),R=new bi(0,0,A,M);let D=!1;const I=[],O=new ta;let N=!1,k=!1,F=null;const U=new tr,B=new Si,V={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function G(){return null===b?T:1}let z,H,W,j,q,X,Y,K,Z,J,Q,$,ee,te,ne,re,oe,ae,se,le,ce,ue,he=n;function de(e,n){for(let i=0;i<e.length;i++){const r=e[i],o=t.getContext(r,n);if(null!==o)return o}return null}try{const e={alpha:i,depth:r,stencil:o,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if(t.addEventListener("webglcontextlost",me,!1),t.addEventListener("webglcontextrestored",ge,!1),null===he){const t=["webgl2","webgl","experimental-webgl"];if(!0===m.isWebGL1Renderer&&t.shift(),he=de(t,e),null===he)throw de(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===he.getShaderPrecisionFormat&&(he.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function pe(){z=new fa(he),H=new ha(he,z,e),z.init(H),ce=new cl(he,z,H),W=new sl(he,z,H),I[0]=he.BACK,j=new va(he),q=new Xs,X=new ll(he,z,W,q,H,ce,j),Y=new pa(m),K=new ia(he,H),ue=new ca(he,z,K,H),Z=new ma(he,K,j,ue),J=new xa(he,Z,K,j),ae=new _a(he),ne=new da(q),Q=new qs(m,Y,z,H,ue,ne),$=new ml(q),ee=new Js(q),te=new il(z,H),oe=new la(m,Y,W,J,s),re=new al(m,J,H),se=new ua(he,z,j,H),le=new ga(he,z,j,H),j.programs=Q.programs,m.capabilities=H,m.extensions=z,m.properties=q,m.renderLists=ee,m.shadowMap=re,m.state=W,m.info=j}pe();const fe=new fl(m,he);function me(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function ge(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const e=j.autoReset,t=re.enabled,n=re.autoUpdate,i=re.needsUpdate,r=re.type;pe(),j.autoReset=e,re.enabled=t,re.autoUpdate=n,re.needsUpdate=i,re.type=r}function ye(e){const t=e.target;t.removeEventListener("dispose",ye),function(e){(function(e){const t=q.get(e).programs;void 0!==t&&t.forEach((function(e){Q.releaseProgram(e)}))})(e),q.remove(e)}(t)}this.xr=fe,this.getContext=function(){return he},this.getContextAttributes=function(){return he.getContextAttributes()},this.forceContextLoss=function(){const e=z.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=z.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return T},this.setPixelRatio=function(e){void 0!==e&&(T=e,this.setSize(A,M,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new di),e.set(A,M)},this.setSize=function(e,n,i){fe.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(A=e,M=n,t.width=Math.floor(e*T),t.height=Math.floor(n*T),!1!==i&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new di),e.set(A*T,M*T).floor()},this.setDrawingBufferSize=function(e,n,i){A=e,M=n,T=i,t.width=Math.floor(e*i),t.height=Math.floor(n*i),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new bi),e.copy(E)},this.getViewport=function(e){return e.copy(L)},this.setViewport=function(e,t,n,i){e.isVector4?L.set(e.x,e.y,e.z,e.w):L.set(e,t,n,i),W.viewport(E.copy(L).multiplyScalar(T).floor())},this.getScissor=function(e){return e.copy(R)},this.setScissor=function(e,t,n,i){e.isVector4?R.set(e.x,e.y,e.z,e.w):R.set(e,t,n,i),W.scissor(w.copy(R).multiplyScalar(T).floor())},this.getScissorTest=function(){return D},this.setScissorTest=function(e){W.setScissorTest(D=e)},this.setOpaqueSort=function(e){C=e},this.setTransparentSort=function(e){P=e},this.getClearColor=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),e=new Zr),e.copy(oe.getClearColor())},this.setClearColor=function(){oe.setClearColor.apply(oe,arguments)},this.getClearAlpha=function(){return oe.getClearAlpha()},this.setClearAlpha=function(){oe.setClearAlpha.apply(oe,arguments)},this.clear=function(e,t,n){let i=0;(void 0===e||e)&&(i|=he.COLOR_BUFFER_BIT),(void 0===t||t)&&(i|=he.DEPTH_BUFFER_BIT),(void 0===n||n)&&(i|=he.STENCIL_BUFFER_BIT),he.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.disposeBindingStates=function(){ue.dispose()},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",me,!1),t.removeEventListener("webglcontextrestored",ge,!1),ee.dispose(),te.dispose(),q.dispose(),Y.dispose(),J.dispose(),ue.dispose(),fe.dispose(),fe.removeEventListener("sessionstart",xe),fe.removeEventListener("sessionend",Ee),F&&(F.dispose(),F=null),we.stop()},this.renderBufferImmediate=function(e,t){ue.initAttributes();const n=q.get(e);e.hasPositions&&!n.position&&(n.position=he.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=he.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=he.createBuffer()),e.hasColors&&!n.color&&(n.color=he.createBuffer());const i=t.getAttributes();e.hasPositions&&(he.bindBuffer(he.ARRAY_BUFFER,n.position),he.bufferData(he.ARRAY_BUFFER,e.positionArray,he.DYNAMIC_DRAW),ue.enableAttribute(i.position),he.vertexAttribPointer(i.position,3,he.FLOAT,!1,0,0)),e.hasNormals&&(he.bindBuffer(he.ARRAY_BUFFER,n.normal),he.bufferData(he.ARRAY_BUFFER,e.normalArray,he.DYNAMIC_DRAW),ue.enableAttribute(i.normal),he.vertexAttribPointer(i.normal,3,he.FLOAT,!1,0,0)),e.hasUvs&&(he.bindBuffer(he.ARRAY_BUFFER,n.uv),he.bufferData(he.ARRAY_BUFFER,e.uvArray,he.DYNAMIC_DRAW),ue.enableAttribute(i.uv),he.vertexAttribPointer(i.uv,2,he.FLOAT,!1,0,0)),e.hasColors&&(he.bindBuffer(he.ARRAY_BUFFER,n.color),he.bufferData(he.ARRAY_BUFFER,e.colorArray,he.DYNAMIC_DRAW),ue.enableAttribute(i.color),he.vertexAttribPointer(i.color,3,he.FLOAT,!1,0,0)),ue.disableUnusedAttributes(),he.drawArrays(he.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,i,r,o){null===t&&(t=V);const a=r.isMesh&&r.matrixWorld.determinant()<0,s=Re(e,t,i,r);W.setMaterial(i,a);let l=n.index;const c=n.attributes.position;if(null===l){if(void 0===c||0===c.count)return}else if(0===l.count)return;let u,h=1;!0===i.wireframe&&(l=Z.getWireframeAttribute(n),h=2),(i.morphTargets||i.morphNormals)&&ae.update(r,n,i,s),ue.setup(r,i,s,n,l);let d=se;null!==l&&(u=K.get(l),d=le,d.setIndex(u));const p=null!==l?l.count:c.count,f=n.drawRange.start*h,m=n.drawRange.count*h,g=null!==o?o.start*h:0,v=null!==o?o.count*h:1/0,y=Math.max(f,g),b=Math.min(p,f+m,g+v)-1,_=Math.max(0,b-y+1);if(0!==_){if(r.isMesh)!0===i.wireframe?(W.setLineWidth(i.wireframeLinewidth*G()),d.setMode(he.LINES)):d.setMode(he.TRIANGLES);else if(r.isLine){let e=i.linewidth;void 0===e&&(e=1),W.setLineWidth(e*G()),r.isLineSegments?d.setMode(he.LINES):r.isLineLoop?d.setMode(he.LINE_LOOP):d.setMode(he.LINE_STRIP)}else r.isPoints?d.setMode(he.POINTS):r.isSprite&&d.setMode(he.TRIANGLES);if(r.isInstancedMesh)d.renderInstances(y,_,r.count);else if(n.isInstancedBufferGeometry){const e=Math.min(n.instanceCount,n._maxInstanceCount);d.renderInstances(y,_,e)}else d.render(y,_)}},this.compile=function(e,t){d=te.get(e),d.init(),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(d.pushLight(e),e.castShadow&&d.pushShadow(e))})),d.setupLights(),e.traverse((function(t){const n=t.material;if(n)if(Array.isArray(n))for(let i=0;i<n.length;i++){Ce(n[i],e,t)}else Ce(n,e,t)}))};let _e=null;function xe(){we.stop()}function Ee(){we.start()}const we=new na;function Se(e,t,n,i){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)d.pushLight(e),e.castShadow&&d.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||O.intersectsSprite(e)){i&&B.setFromMatrixPosition(e.matrixWorld).applyMatrix4(U);const t=J.update(e),r=e.material;r.visible&&h.push(e,t,r,n,B.z,null)}}else if(e.isImmediateRenderObject)i&&B.setFromMatrixPosition(e.matrixWorld).applyMatrix4(U),h.push(e,null,e.material,n,B.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==j.render.frame&&(e.skeleton.update(),e.skeleton.frame=j.render.frame),!e.frustumCulled||O.intersectsObject(e))){i&&B.setFromMatrixPosition(e.matrixWorld).applyMatrix4(U);const t=J.update(e),r=e.material;if(Array.isArray(r)){const i=t.groups;for(let o=0,a=i.length;o<a;o++){const a=i[o],s=r[a.materialIndex];s&&s.visible&&h.push(e,t,s,n,B.z,a)}}else r.visible&&h.push(e,t,r,n,B.z,null)}const r=e.children;for(let e=0,o=r.length;e<o;e++)Se(r[e],t,n,i)}function Ae(e,t,n){const i=!0===t.isScene?t.overrideMaterial:null;for(let r=0,o=e.length;r<o;r++){const o=e[r],a=o.object,s=o.geometry,l=null===i?o.material:i,c=o.group;if(n.isArrayCamera){const e=n.cameras;for(let n=0,i=e.length;n<i;n++){const i=e[n];a.layers.test(i.layers)&&(W.viewport(E.copy(i.viewport)),d.setupLightsView(i),Me(a,t,i,s,l,c))}}else Me(a,t,n,s,l,c)}}function Me(e,t,n,i,r,o){if(e.onBeforeRender(m,t,n,i,r,o),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){const i=Re(n,t,r,e);W.setMaterial(r),ue.reset(),function(e,t){e.render((function(e){m.renderBufferImmediate(e,t)}))}(e,i)}else m.renderBufferDirect(n,t,i,r,e,o);e.onAfterRender(m,t,n,i,r,o)}function Ce(e,t,n){!0!==t.isScene&&(t=V);const i=q.get(e),r=d.state.lights,o=d.state.shadowsArray,a=r.state.version,s=Q.getParameters(e,r.state,o,t,n),l=Q.getProgramCacheKey(s);let c=i.programs;i.environment=e.isMeshStandardMaterial?t.environment:null,i.fog=t.fog,i.envMap=Y.get(e.envMap||i.environment),void 0===c&&(e.addEventListener("dispose",ye),c=new Map,i.programs=c);let u=c.get(l);if(void 0!==u){if(i.currentProgram===u&&i.lightsStateVersion===a)return Le(e,s),u}else s.uniforms=Q.getUniforms(e),e.onBuild(s,m),e.onBeforeCompile(s,m),u=Q.acquireProgram(s,l),c.set(l,u),i.uniforms=s.uniforms;const h=i.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(h.clippingPlanes=ne.uniform),Le(e,s),i.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),i.lightsStateVersion=a,i.needsLights&&(h.ambientLightColor.value=r.state.ambient,h.lightProbe.value=r.state.probe,h.directionalLights.value=r.state.directional,h.directionalLightShadows.value=r.state.directionalShadow,h.spotLights.value=r.state.spot,h.spotLightShadows.value=r.state.spotShadow,h.rectAreaLights.value=r.state.rectArea,h.ltc_1.value=r.state.rectAreaLTC1,h.ltc_2.value=r.state.rectAreaLTC2,h.pointLights.value=r.state.point,h.pointLightShadows.value=r.state.pointShadow,h.hemisphereLights.value=r.state.hemi,h.directionalShadowMap.value=r.state.directionalShadowMap,h.directionalShadowMatrix.value=r.state.directionalShadowMatrix,h.spotShadowMap.value=r.state.spotShadowMap,h.spotShadowMatrix.value=r.state.spotShadowMatrix,h.pointShadowMap.value=r.state.pointShadowMap,h.pointShadowMatrix.value=r.state.pointShadowMatrix);const p=u.getUniforms(),f=As.seqWithValue(p.seq,h);return i.currentProgram=u,i.uniformsList=f,u}function Le(e,t){const n=q.get(e);n.outputEncoding=t.outputEncoding,n.instancing=t.instancing,n.skinning=t.skinning,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas}function Re(e,t,n,i){!0!==t.isScene&&(t=V),X.resetTextureUnits();const r=t.fog,o=n.isMeshStandardMaterial?t.environment:null,a=null===b?m.outputEncoding:b.texture.encoding,s=Y.get(n.envMap||o),l=!0===n.vertexColors&&i.geometry&&i.geometry.attributes.color&&4===i.geometry.attributes.color.itemSize,c=q.get(n),u=d.state.lights;if(!0===N&&(!0===k||e!==x)){const t=e===x&&n.id===_;ne.setState(n,e,t)}let h=!1;n.version===c.__version?c.needsLights&&c.lightsStateVersion!==u.state.version||c.outputEncoding!==a||i.isInstancedMesh&&!1===c.instancing?h=!0:i.isInstancedMesh||!0!==c.instancing?i.isSkinnedMesh&&!1===c.skinning?h=!0:i.isSkinnedMesh||!0!==c.skinning?c.envMap!==s||n.fog&&c.fog!==r?h=!0:void 0===c.numClippingPlanes||c.numClippingPlanes===ne.numPlanes&&c.numIntersection===ne.numIntersection?c.vertexAlphas!==l&&(h=!0):h=!0:h=!0:h=!0:(h=!0,c.__version=n.version);let p=c.currentProgram;!0===h&&(p=Ce(n,t,i));let f=!1,g=!1,v=!1;const y=p.getUniforms(),E=c.uniforms;if(W.useProgram(p.program)&&(f=!0,g=!0,v=!0),n.id!==_&&(_=n.id,g=!0),f||x!==e){if(y.setValue(he,"projectionMatrix",e.projectionMatrix),H.logarithmicDepthBuffer&&y.setValue(he,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),x!==e&&(x=e,g=!0,v=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){const t=y.map.cameraPosition;void 0!==t&&t.setValue(he,B.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&y.setValue(he,"isOrthographic",!0===e.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||i.isSkinnedMesh)&&y.setValue(he,"viewMatrix",e.matrixWorldInverse)}if(i.isSkinnedMesh){y.setOptional(he,i,"bindMatrix"),y.setOptional(he,i,"bindMatrixInverse");const e=i.skeleton;e&&(H.floatVertexTextures?(null===e.boneTexture&&e.computeBoneTexture(),y.setValue(he,"boneTexture",e.boneTexture,X),y.setValue(he,"boneTextureSize",e.boneTextureSize)):y.setOptional(he,e,"boneMatrices"))}var w,S;return(g||c.receiveShadow!==i.receiveShadow)&&(c.receiveShadow=i.receiveShadow,y.setValue(he,"receiveShadow",i.receiveShadow)),g&&(y.setValue(he,"toneMappingExposure",m.toneMappingExposure),c.needsLights&&(S=v,(w=E).ambientLightColor.needsUpdate=S,w.lightProbe.needsUpdate=S,w.directionalLights.needsUpdate=S,w.directionalLightShadows.needsUpdate=S,w.pointLights.needsUpdate=S,w.pointLightShadows.needsUpdate=S,w.spotLights.needsUpdate=S,w.spotLightShadows.needsUpdate=S,w.rectAreaLights.needsUpdate=S,w.hemisphereLights.needsUpdate=S),r&&n.fog&&$.refreshFogUniforms(E,r),$.refreshMaterialUniforms(E,n,T,M,F),As.upload(he,c.uniformsList,E,X)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(As.upload(he,c.uniformsList,E,X),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&y.setValue(he,"center",i.center),y.setValue(he,"modelViewMatrix",i.modelViewMatrix),y.setValue(he,"normalMatrix",i.normalMatrix),y.setValue(he,"modelMatrix",i.matrixWorld),p}we.setAnimationLoop((function(e){_e&&_e(e)})),"undefined"!=typeof window&&we.setContext(window),this.setAnimationLoop=function(e){_e=e,fe.setAnimationLoop(e),null===e?we.stop():we.start()},fe.addEventListener("sessionstart",xe),fe.addEventListener("sessionend",Ee),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===g)return;!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===fe.enabled&&!0===fe.isPresenting&&(!0===fe.cameraAutoUpdate&&fe.updateCamera(t),t=fe.getCamera()),!0===e.isScene&&e.onBeforeRender(m,e,t,b),d=te.get(e,f.length),d.init(),f.push(d),U.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),O.setFromProjectionMatrix(U),k=this.localClippingEnabled,N=ne.init(this.clippingPlanes,k,t),h=ee.get(e,p.length),h.init(),p.push(h),Se(e,t,0,m.sortObjects),h.finish(),!0===m.sortObjects&&h.sort(C,P),!0===N&&ne.beginShadows();const n=d.state.shadowsArray;re.render(n,e,t),d.setupLights(),d.setupLightsView(t),!0===N&&ne.endShadows(),!0===this.info.autoReset&&this.info.reset(),oe.render(h,e);const i=h.opaque,r=h.transmissive,o=h.transparent;i.length>0&&Ae(i,e,t),r.length>0&&function(e,t,n,i){null===F&&(F=new _i(1024,1024,{generateMipmaps:!0,minFilter:Te,magFilter:be,wrapS:ve,wrapT:ve}));const r=m.getRenderTarget();m.setRenderTarget(F),m.clear(),Ae(e,n,i),X.updateRenderTargetMipmap(F),m.setRenderTarget(r),Ae(t,n,i)}(i,r,e,t),o.length>0&&Ae(o,e,t),null!==b&&(X.updateRenderTargetMipmap(b),X.updateMultisampleRenderTarget(b)),!0===e.isScene&&e.onAfterRender(m,e,t),W.buffers.depth.setTest(!0),W.buffers.depth.setMask(!0),W.buffers.color.setMask(!0),W.setPolygonOffset(!1),ue.resetDefaultState(),_=-1,x=null,f.pop(),d=f.length>0?f[f.length-1]:null,p.pop(),h=p.length>0?p[p.length-1]:null},this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return b},this.setRenderTarget=function(e,t=0,n=0){b=e,v=t,y=n,e&&void 0===q.get(e).__webglFramebuffer&&X.setupRenderTarget(e);let i=null,r=!1,o=!1;if(e){const n=e.texture;(n.isDataTexture3D||n.isDataTexture2DArray)&&(o=!0);const a=q.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i=a[t],r=!0):i=e.isWebGLMultisampleRenderTarget?q.get(e).__webglMultisampledFramebuffer:a,E.copy(e.viewport),w.copy(e.scissor),S=e.scissorTest}else E.copy(L).multiplyScalar(T).floor(),w.copy(R).multiplyScalar(T).floor(),S=D;if(W.bindFramebuffer(he.FRAMEBUFFER,i)&&H.drawBuffers){let t=!1;if(e)if(e.isWebGLMultipleRenderTargets){const n=e.texture;if(I.length!==n.length||I[0]!==he.COLOR_ATTACHMENT0){for(let e=0,t=n.length;e<t;e++)I[e]=he.COLOR_ATTACHMENT0+e;I.length=n.length,t=!0}}else 1===I.length&&I[0]===he.COLOR_ATTACHMENT0||(I[0]=he.COLOR_ATTACHMENT0,I.length=1,t=!0);else 1===I.length&&I[0]===he.BACK||(I[0]=he.BACK,I.length=1,t=!0);t&&(H.isWebGL2?he.drawBuffers(I):z.get("WEBGL_draw_buffers").drawBuffersWEBGL(I))}if(W.viewport(E),W.scissor(w),W.setScissorTest(S),r){const i=q.get(e.texture);he.framebufferTexture2D(he.FRAMEBUFFER,he.COLOR_ATTACHMENT0,he.TEXTURE_CUBE_MAP_POSITIVE_X+t,i.__webglTexture,n)}else if(o){const i=q.get(e.texture),r=t||0;he.framebufferTextureLayer(he.FRAMEBUFFER,he.COLOR_ATTACHMENT0,i.__webglTexture,n||0,r)}},this.readRenderTargetPixels=function(e,t,n,i,r,o,a){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let s=q.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==a&&(s=s[a]),s){W.bindFramebuffer(he.FRAMEBUFFER,s);try{const a=e.texture,s=a.format,l=a.type;if(s!==He&&ce.convert(s)!==he.getParameter(he.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const c=l===ke&&(z.has("EXT_color_buffer_half_float")||H.isWebGL2&&z.has("EXT_color_buffer_float"));if(!(l===Pe||ce.convert(l)===he.getParameter(he.IMPLEMENTATION_COLOR_READ_TYPE)||l===Ne&&(H.isWebGL2||z.has("OES_texture_float")||z.has("WEBGL_color_buffer_float"))||c))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");he.checkFramebufferStatus(he.FRAMEBUFFER)===he.FRAMEBUFFER_COMPLETE?t>=0&&t<=e.width-i&&n>=0&&n<=e.height-r&&he.readPixels(t,n,i,r,ce.convert(s),ce.convert(l),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const e=null!==b?q.get(b).__webglFramebuffer:null;W.bindFramebuffer(he.FRAMEBUFFER,e)}}},this.copyFramebufferToTexture=function(e,t,n=0){const i=Math.pow(2,-n),r=Math.floor(t.image.width*i),o=Math.floor(t.image.height*i);let a=ce.convert(t.format);H.isWebGL2&&(a===he.RGB&&(a=he.RGB8),a===he.RGBA&&(a=he.RGBA8)),X.setTexture2D(t,0),he.copyTexImage2D(he.TEXTURE_2D,n,a,e.x,e.y,r,o,0),W.unbindTexture()},this.copyTextureToTexture=function(e,t,n,i=0){const r=t.image.width,o=t.image.height,a=ce.convert(n.format),s=ce.convert(n.type);X.setTexture2D(n,0),he.pixelStorei(he.UNPACK_FLIP_Y_WEBGL,n.flipY),he.pixelStorei(he.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),he.pixelStorei(he.UNPACK_ALIGNMENT,n.unpackAlignment),t.isDataTexture?he.texSubImage2D(he.TEXTURE_2D,i,e.x,e.y,r,o,a,s,t.image.data):t.isCompressedTexture?he.compressedTexSubImage2D(he.TEXTURE_2D,i,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,a,t.mipmaps[0].data):he.texSubImage2D(he.TEXTURE_2D,i,e.x,e.y,a,s,t.image),0===i&&n.generateMipmaps&&he.generateMipmap(he.TEXTURE_2D),W.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,i,r=0){if(m.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const{width:o,height:a,data:s}=n.image,l=ce.convert(i.format),c=ce.convert(i.type);let u;if(i.isDataTexture3D)X.setTexture3D(i,0),u=he.TEXTURE_3D;else{if(!i.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");X.setTexture2DArray(i,0),u=he.TEXTURE_2D_ARRAY}he.pixelStorei(he.UNPACK_FLIP_Y_WEBGL,i.flipY),he.pixelStorei(he.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),he.pixelStorei(he.UNPACK_ALIGNMENT,i.unpackAlignment);const h=he.getParameter(he.UNPACK_ROW_LENGTH),d=he.getParameter(he.UNPACK_IMAGE_HEIGHT),p=he.getParameter(he.UNPACK_SKIP_PIXELS),f=he.getParameter(he.UNPACK_SKIP_ROWS),g=he.getParameter(he.UNPACK_SKIP_IMAGES);he.pixelStorei(he.UNPACK_ROW_LENGTH,o),he.pixelStorei(he.UNPACK_IMAGE_HEIGHT,a),he.pixelStorei(he.UNPACK_SKIP_PIXELS,e.min.x),he.pixelStorei(he.UNPACK_SKIP_ROWS,e.min.y),he.pixelStorei(he.UNPACK_SKIP_IMAGES,e.min.z),he.texSubImage3D(u,r,t.x,t.y,t.z,e.max.x-e.min.x+1,e.max.y-e.min.y+1,e.max.z-e.min.z+1,l,c,s),he.pixelStorei(he.UNPACK_ROW_LENGTH,h),he.pixelStorei(he.UNPACK_IMAGE_HEIGHT,d),he.pixelStorei(he.UNPACK_SKIP_PIXELS,p),he.pixelStorei(he.UNPACK_SKIP_ROWS,f),he.pixelStorei(he.UNPACK_SKIP_IMAGES,g),0===r&&i.generateMipmaps&&he.generateMipmap(u),W.unbindTexture()},this.initTexture=function(e){X.setTexture2D(e,0),W.unbindTexture()},this.resetState=function(){v=0,y=0,b=null,W.reset(),ue.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class vl extends gl{}vl.prototype.isWebGL1Renderer=!0;class yl{constructor(e,t=25e-5){this.name="",this.color=new Zr(e),this.density=t}clone(){return new yl(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}yl.prototype.isFogExp2=!0;class bl{constructor(e,t=1,n=1e3){this.name="",this.color=new Zr(e),this.near=t,this.far=n}clone(){return new bl(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}bl.prototype.isFog=!0;class _l extends Mr{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.environment&&(t.object.environment=this.environment.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}_l.prototype.isScene=!0;class xl{constructor(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Ln,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=qn()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,r=this.stride;i<r;i++)this.array[e+i]=t.array[n+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=qn()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=qn()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}xl.prototype.isInterleavedBuffer=!0;const El=new Si;class wl{constructor(e,t,n,i){this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)El.x=this.getX(t),El.y=this.getY(t),El.z=this.getZ(t),El.applyMatrix4(e),this.setXYZ(t,El.x,El.y,El.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)El.x=this.getX(t),El.y=this.getY(t),El.z=this.getZ(t),El.applyNormalMatrix(e),this.setXYZ(t,El.x,El.y,El.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)El.x=this.getX(t),El.y=this.getY(t),El.z=this.getZ(t),El.transformDirection(e),this.setXYZ(t,El.x,El.y,El.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=r,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new eo(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new wl(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}wl.prototype.isInterleavedBufferAttribute=!0;class Sl extends Hr{constructor(e){super(),this.type="SpriteMaterial",this.color=new Zr(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}let Al;Sl.prototype.isSpriteMaterial=!0;const Ml=new Si,Tl=new Si,Cl=new Si,Pl=new di,Ll=new di,Rl=new tr,Dl=new Si,Il=new Si,Ol=new Si,Nl=new di,kl=new di,Fl=new di;class Ul extends Mr{constructor(e){if(super(),this.type="Sprite",void 0===Al){Al=new Eo;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new xl(e,5);Al.setIndex([0,1,2,0,2,3]),Al.setAttribute("position",new wl(t,3,0,!1)),Al.setAttribute("uv",new wl(t,2,3,!1))}this.geometry=Al,this.material=void 0!==e?e:new Sl,this.center=new di(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Tl.setFromMatrixScale(this.matrixWorld),Rl.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Cl.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Tl.multiplyScalar(-Cl.z);const n=this.material.rotation;let i,r;0!==n&&(r=Math.cos(n),i=Math.sin(n));const o=this.center;Bl(Dl.set(-.5,-.5,0),Cl,o,Tl,i,r),Bl(Il.set(.5,-.5,0),Cl,o,Tl,i,r),Bl(Ol.set(.5,.5,0),Cl,o,Tl,i,r),Nl.set(0,0),kl.set(1,0),Fl.set(1,1);let a=e.ray.intersectTriangle(Dl,Il,Ol,!1,Ml);if(null===a&&(Bl(Il.set(-.5,.5,0),Cl,o,Tl,i,r),kl.set(0,1),a=e.ray.intersectTriangle(Dl,Ol,Il,!1,Ml),null===a))return;const s=e.ray.origin.distanceTo(Ml);s<e.near||s>e.far||t.push({distance:s,point:Ml.clone(),uv:Gr.getUV(Ml,Dl,Il,Ol,Nl,kl,Fl,new di),face:null,object:this})}copy(e){return super.copy(e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function Bl(e,t,n,i,r,o){Pl.subVectors(e,n).addScalar(.5).multiply(i),void 0!==r?(Ll.x=o*Pl.x-r*Pl.y,Ll.y=r*Pl.x+o*Pl.y):Ll.copy(Pl),e.copy(t),e.x+=Ll.x,e.y+=Ll.y,e.applyMatrix4(Rl)}Ul.prototype.isSprite=!0;const Vl=new Si,Gl=new Si;class zl extends Mr{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let e=0,n=t.length;e<n;e++){const n=t[e];this.addLevel(n.object.clone(),n.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0){t=Math.abs(t);const n=this.levels;let i;for(i=0;i<n.length&&!(t<n[i].distance);i++);return n.splice(i,0,{distance:t,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,i;for(n=1,i=t.length;n<i&&!(e<t[n].distance);n++);return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){Vl.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(Vl);this.getObjectForDistance(n).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Vl.setFromMatrixPosition(e.matrixWorld),Gl.setFromMatrixPosition(this.matrixWorld);const n=Vl.distanceTo(Gl)/e.zoom;let i,r;for(t[0].object.visible=!0,i=1,r=t.length;i<r&&n>=t[i].distance;i++)t[i-1].object.visible=!1,t[i].object.visible=!0;for(this._currentLevel=i-1;i<r;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let e=0,i=n.length;e<i;e++){const i=n[e];t.object.levels.push({object:i.object.uuid,distance:i.distance})}return t}}const Hl=new Si,Wl=new bi,jl=new bi,ql=new Si,Xl=new tr;class Yl extends Vo{constructor(e,t){super(e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new tr,this.bindMatrixInverse=new tr}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new bi,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);const i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,i=this.geometry;Wl.fromBufferAttribute(i.attributes.skinIndex,e),jl.fromBufferAttribute(i.attributes.skinWeight,e),Hl.fromBufferAttribute(i.attributes.position,e).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let e=0;e<4;e++){const i=jl.getComponent(e);if(0!==i){const r=Wl.getComponent(e);Xl.multiplyMatrices(n.bones[r].matrixWorld,n.boneInverses[r]),t.addScaledVector(ql.copy(Hl).applyMatrix4(Xl),i)}}return t.applyMatrix4(this.bindMatrixInverse)}}Yl.prototype.isSkinnedMesh=!0;class Kl extends Mr{constructor(){super(),this.type="Bone"}}Kl.prototype.isBone=!0;class Zl extends vi{constructor(e,t,n,i,r,o,a,s,l,c,u,h){super(null,o,a,s,l,c,i,r,u,h),this.image={data:e||null,width:t||1,height:n||1},this.magFilter=void 0!==l?l:be,this.minFilter=void 0!==c?c:be,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Zl.prototype.isDataTexture=!0;const Jl=new tr,Ql=new tr;class $l{constructor(e=[],t=[]){this.uuid=qn(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new tr)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const t=new tr;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let i=0,r=e.length;i<r;i++){const r=e[i]?e[i].matrixWorld:Ql;Jl.multiplyMatrices(r,t[i]),Jl.toArray(n,16*i)}null!==i&&(i.needsUpdate=!0)}clone(){return new $l(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=ci(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Zl(t,e,e,He,Ne);return this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const n=this.bones[t];if(n.name===e)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){const i=e.bones[n];let r=t[i];void 0===r&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),r=new Kl),this.bones.push(r),this.boneInverses.push((new tr).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let i=0,r=t.length;i<r;i++){const r=t[i];e.bones.push(r.uuid);const o=n[i];e.boneInverses.push(o.toArray())}return e}}const ec=new tr,tc=new tr,nc=[],ic=new Vo;class rc extends Vo{constructor(e,t,n){super(e,t),this.instanceMatrix=new eo(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const n=this.matrixWorld,i=this.count;if(ic.geometry=this.geometry,ic.material=this.material,void 0!==ic.material)for(let r=0;r<i;r++){this.getMatrixAt(r,ec),tc.multiplyMatrices(n,ec),ic.matrixWorld=tc,ic.raycast(e,nc);for(let e=0,n=nc.length;e<n;e++){const n=nc[e];n.instanceId=r,n.object=this,t.push(n)}nc.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new eo(new Float32Array(3*this.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}rc.prototype.isInstancedMesh=!0;class oc extends Hr{constructor(e){super(),this.type="LineBasicMaterial",this.color=new Zr(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this}}oc.prototype.isLineBasicMaterial=!0;const ac=new Si,sc=new Si,lc=new tr,cc=new er,uc=new qi;class hc extends Mr{constructor(e=new Eo,t=new oc){super(),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,n=[0];for(let e=1,i=t.count;e<i;e++)ac.fromBufferAttribute(t,e-1),sc.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=ac.distanceTo(sc);e.setAttribute("lineDistance",new co(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,r=e.params.Line.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),uc.copy(n.boundingSphere),uc.applyMatrix4(i),uc.radius+=r,!1===e.ray.intersectsSphere(uc))return;lc.copy(i).invert(),cc.copy(e.ray).applyMatrix4(lc);const a=r/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a,l=new Si,c=new Si,u=new Si,h=new Si,d=this.isLineSegments?2:1;if(n.isBufferGeometry){const i=n.index,r=n.attributes.position;if(null!==i){for(let n=Math.max(0,o.start),a=Math.min(i.count,o.start+o.count)-1;n<a;n+=d){const o=i.getX(n),a=i.getX(n+1);l.fromBufferAttribute(r,o),c.fromBufferAttribute(r,a);if(cc.distanceSqToSegment(l,c,h,u)>s)continue;h.applyMatrix4(this.matrixWorld);const d=e.ray.origin.distanceTo(h);d<e.near||d>e.far||t.push({distance:d,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else{for(let n=Math.max(0,o.start),i=Math.min(r.count,o.start+o.count)-1;n<i;n+=d){l.fromBufferAttribute(r,n),c.fromBufferAttribute(r,n+1);if(cc.distanceSqToSegment(l,c,h,u)>s)continue;h.applyMatrix4(this.matrixWorld);const i=e.ray.origin.distanceTo(h);i<e.near||i>e.far||t.push({distance:i,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const e=t[n[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,n=e.length;t<n;t++){const n=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}hc.prototype.isLine=!0;const dc=new Si,pc=new Si;class fc extends hc{constructor(e,t){super(e,t),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,n=[];for(let e=0,i=t.count;e<i;e+=2)dc.fromBufferAttribute(t,e),pc.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+dc.distanceTo(pc);e.setAttribute("lineDistance",new co(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}fc.prototype.isLineSegments=!0;class mc extends hc{constructor(e,t){super(e,t),this.type="LineLoop"}}mc.prototype.isLineLoop=!0;class gc extends Hr{constructor(e){super(),this.type="PointsMaterial",this.color=new Zr(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this}}gc.prototype.isPointsMaterial=!0;const vc=new tr,yc=new er,bc=new qi,_c=new Si;class xc extends Mr{constructor(e=new Eo,t=new gc){super(),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,r=e.params.Points.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),bc.copy(n.boundingSphere),bc.applyMatrix4(i),bc.radius+=r,!1===e.ray.intersectsSphere(bc))return;vc.copy(i).invert(),yc.copy(e.ray).applyMatrix4(vc);const a=r/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a;if(n.isBufferGeometry){const r=n.index,a=n.attributes.position;if(null!==r){for(let n=Math.max(0,o.start),l=Math.min(r.count,o.start+o.count);n<l;n++){const o=r.getX(n);_c.fromBufferAttribute(a,o),Ec(_c,o,s,i,e,t,this)}}else{for(let n=Math.max(0,o.start),r=Math.min(a.count,o.start+o.count);n<r;n++)_c.fromBufferAttribute(a,n),Ec(_c,n,s,i,e,t,this)}}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const e=t[n[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,n=e.length;t<n;t++){const n=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function Ec(e,t,n,i,r,o,a){const s=yc.distanceSqToPoint(e);if(s<n){const n=new Si;yc.closestPointToPoint(e,n),n.applyMatrix4(i);const l=r.ray.origin.distanceTo(n);if(l<r.near||l>r.far)return;o.push({distance:l,distanceToRay:Math.sqrt(s),point:n,index:t,face:null,object:a})}}xc.prototype.isPoints=!0;class wc extends vi{constructor(e,t,n,i,r,o,a,s,l){super(e,t,n,i,r,o,a,s,l),this.format=void 0!==a?a:ze,this.minFilter=void 0!==o?o:Se,this.magFilter=void 0!==r?r:Se,this.generateMipmaps=!1;const c=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){c.needsUpdate=!0,e.requestVideoFrameCallback(t)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!1==="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}wc.prototype.isVideoTexture=!0;class Sc extends vi{constructor(e,t,n,i,r,o,a,s,l,c,u,h){super(null,o,a,s,l,c,i,r,u,h),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}Sc.prototype.isCompressedTexture=!0;class Ac extends vi{constructor(e,t,n,i,r,o,a,s,l){super(e,t,n,i,r,o,a,s,l),this.needsUpdate=!0}}Ac.prototype.isCanvasTexture=!0;class Mc extends vi{constructor(e,t,n,i,r,o,a,s,l,c){if((c=void 0!==c?c:Xe)!==Xe&&c!==Ye)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===Xe&&(n=De),void 0===n&&c===Ye&&(n=Ve),super(null,i,r,o,a,s,c,n,l),this.image={width:e,height:t},this.magFilter=void 0!==a?a:be,this.minFilter=void 0!==s?s:be,this.flipY=!1,this.generateMipmaps=!1}}Mc.prototype.isDepthTexture=!0;class Tc extends Eo{constructor(e=1,t=8,n=0,i=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},t=Math.max(3,t);const r=[],o=[],a=[],s=[],l=new Si,c=new di;o.push(0,0,0),a.push(0,0,1),s.push(.5,.5);for(let r=0,u=3;r<=t;r++,u+=3){const h=n+r/t*i;l.x=e*Math.cos(h),l.y=e*Math.sin(h),o.push(l.x,l.y,l.z),a.push(0,0,1),c.x=(o[u]/e+1)/2,c.y=(o[u+1]/e+1)/2,s.push(c.x,c.y)}for(let e=1;e<=t;e++)r.push(e,e+1,0);this.setIndex(r),this.setAttribute("position",new co(o,3)),this.setAttribute("normal",new co(a,3)),this.setAttribute("uv",new co(s,2))}}class Cc extends Eo{constructor(e=1,t=1,n=1,i=8,r=1,o=!1,a=0,s=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s};const l=this;i=Math.floor(i),r=Math.floor(r);const c=[],u=[],h=[],d=[];let p=0;const f=[],m=n/2;let g=0;function v(n){const r=p,o=new di,f=new Si;let v=0;const y=!0===n?e:t,b=!0===n?1:-1;for(let e=1;e<=i;e++)u.push(0,m*b,0),h.push(0,b,0),d.push(.5,.5),p++;const _=p;for(let e=0;e<=i;e++){const t=e/i*s+a,n=Math.cos(t),r=Math.sin(t);f.x=y*r,f.y=m*b,f.z=y*n,u.push(f.x,f.y,f.z),h.push(0,b,0),o.x=.5*n+.5,o.y=.5*r*b+.5,d.push(o.x,o.y),p++}for(let e=0;e<i;e++){const t=r+e,i=_+e;!0===n?c.push(i,i+1,t):c.push(i+1,i,t),v+=3}l.addGroup(g,v,!0===n?1:2),g+=v}!function(){const o=new Si,v=new Si;let y=0;const b=(t-e)/n;for(let l=0;l<=r;l++){const c=[],g=l/r,y=g*(t-e)+e;for(let e=0;e<=i;e++){const t=e/i,r=t*s+a,l=Math.sin(r),f=Math.cos(r);v.x=y*l,v.y=-g*n+m,v.z=y*f,u.push(v.x,v.y,v.z),o.set(l,b,f).normalize(),h.push(o.x,o.y,o.z),d.push(t,1-g),c.push(p++)}f.push(c)}for(let e=0;e<i;e++)for(let t=0;t<r;t++){const n=f[t][e],i=f[t+1][e],r=f[t+1][e+1],o=f[t][e+1];c.push(n,i,o),c.push(i,r,o),y+=6}l.addGroup(g,y,0),g+=y}(),!1===o&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(c),this.setAttribute("position",new co(u,3)),this.setAttribute("normal",new co(h,3)),this.setAttribute("uv",new co(d,2))}}class Pc extends Cc{constructor(e=1,t=1,n=8,i=1,r=!1,o=0,a=2*Math.PI){super(0,e,t,n,i,r,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:o,thetaLength:a}}}class Lc extends Eo{constructor(e,t,n=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i};const r=[],o=[];function a(e,t,n,i){const r=i+1,o=[];for(let i=0;i<=r;i++){o[i]=[];const a=e.clone().lerp(n,i/r),s=t.clone().lerp(n,i/r),l=r-i;for(let e=0;e<=l;e++)o[i][e]=0===e&&i===r?a:a.clone().lerp(s,e/l)}for(let e=0;e<r;e++)for(let t=0;t<2*(r-e)-1;t++){const n=Math.floor(t/2);t%2==0?(s(o[e][n+1]),s(o[e+1][n]),s(o[e][n])):(s(o[e][n+1]),s(o[e+1][n+1]),s(o[e+1][n]))}}function s(e){r.push(e.x,e.y,e.z)}function l(t,n){const i=3*t;n.x=e[i+0],n.y=e[i+1],n.z=e[i+2]}function c(e,t,n,i){i<0&&1===e.x&&(o[t]=e.x-1),0===n.x&&0===n.z&&(o[t]=i/2/Math.PI+.5)}function u(e){return Math.atan2(e.z,-e.x)}function h(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}!function(e){const n=new Si,i=new Si,r=new Si;for(let o=0;o<t.length;o+=3)l(t[o+0],n),l(t[o+1],i),l(t[o+2],r),a(n,i,r,e)}(i),function(e){const t=new Si;for(let n=0;n<r.length;n+=3)t.x=r[n+0],t.y=r[n+1],t.z=r[n+2],t.normalize().multiplyScalar(e),r[n+0]=t.x,r[n+1]=t.y,r[n+2]=t.z}(n),function(){const e=new Si;for(let t=0;t<r.length;t+=3){e.x=r[t+0],e.y=r[t+1],e.z=r[t+2];const n=u(e)/2/Math.PI+.5,i=h(e)/Math.PI+.5;o.push(n,1-i)}(function(){const e=new Si,t=new Si,n=new Si,i=new Si,a=new di,s=new di,l=new di;for(let h=0,d=0;h<r.length;h+=9,d+=6){e.set(r[h+0],r[h+1],r[h+2]),t.set(r[h+3],r[h+4],r[h+5]),n.set(r[h+6],r[h+7],r[h+8]),a.set(o[d+0],o[d+1]),s.set(o[d+2],o[d+3]),l.set(o[d+4],o[d+5]),i.copy(e).add(t).add(n).divideScalar(3);const p=u(i);c(a,d+0,e,p),c(s,d+2,t,p),c(l,d+4,n,p)}})(),function(){for(let e=0;e<o.length;e+=6){const t=o[e+0],n=o[e+2],i=o[e+4],r=Math.max(t,n,i),a=Math.min(t,n,i);r>.9&&a<.1&&(t<.2&&(o[e+0]+=1),n<.2&&(o[e+2]+=1),i<.2&&(o[e+4]+=1))}}()}(),this.setAttribute("position",new co(r,3)),this.setAttribute("normal",new co(r.slice(),3)),this.setAttribute("uv",new co(o,2)),0===i?this.computeVertexNormals():this.normalizeNormals()}}class Rc extends Lc{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}}const Dc=new Si,Ic=new Si,Oc=new Si,Nc=new Gr;class kc extends Eo{constructor(e,t){if(super(),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1,!0===e.isGeometry)return void console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const n=Math.pow(10,4),i=Math.cos(Wn*t),r=e.getIndex(),o=e.getAttribute("position"),a=r?r.count:o.count,s=[0,0,0],l=["a","b","c"],c=new Array(3),u={},h=[];for(let e=0;e<a;e+=3){r?(s[0]=r.getX(e),s[1]=r.getX(e+1),s[2]=r.getX(e+2)):(s[0]=e,s[1]=e+1,s[2]=e+2);const{a:t,b:a,c:d}=Nc;if(t.fromBufferAttribute(o,s[0]),a.fromBufferAttribute(o,s[1]),d.fromBufferAttribute(o,s[2]),Nc.getNormal(Oc),c[0]=`${Math.round(t.x*n)},${Math.round(t.y*n)},${Math.round(t.z*n)}`,c[1]=`${Math.round(a.x*n)},${Math.round(a.y*n)},${Math.round(a.z*n)}`,c[2]=`${Math.round(d.x*n)},${Math.round(d.y*n)},${Math.round(d.z*n)}`,c[0]!==c[1]&&c[1]!==c[2]&&c[2]!==c[0])for(let e=0;e<3;e++){const t=(e+1)%3,n=c[e],r=c[t],o=Nc[l[e]],a=Nc[l[t]],d=`${n}_${r}`,p=`${r}_${n}`;p in u&&u[p]?(Oc.dot(u[p].normal)<=i&&(h.push(o.x,o.y,o.z),h.push(a.x,a.y,a.z)),u[p]=null):d in u||(u[d]={index0:s[e],index1:s[t],normal:Oc.clone()})}}for(const e in u)if(u[e]){const{index0:t,index1:n}=u[e];Dc.fromBufferAttribute(o,t),Ic.fromBufferAttribute(o,n),h.push(Dc.x,Dc.y,Dc.z),h.push(Ic.x,Ic.y,Ic.z)}this.setAttribute("position",new co(h,3))}}const Fc=function(e,t,n){n=n||2;const i=t&&t.length,r=i?t[0]*n:e.length;let o=Uc(e,0,r,n,!0);const a=[];if(!o||o.next===o.prev)return a;let s,l,c,u,h,d,p;if(i&&(o=function(e,t,n,i){const r=[];let o,a,s,l,c;for(o=0,a=t.length;o<a;o++)s=t[o]*i,l=o<a-1?t[o+1]*i:e.length,c=Uc(e,s,l,i,!1),c===c.next&&(c.steiner=!0),r.push(Kc(c));for(r.sort(jc),o=0;o<r.length;o++)qc(r[o],n),n=Bc(n,n.next);return n}(e,t,o,n)),e.length>80*n){s=c=e[0],l=u=e[1];for(let t=n;t<r;t+=n)h=e[t],d=e[t+1],h<s&&(s=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);p=Math.max(c-s,u-l),p=0!==p?1/p:0}return Vc(o,a,n,s,l,p),a};function Uc(e,t,n,i,r){let o,a;if(r===function(e,t,n,i){let r=0;for(let o=t,a=n-i;o<n;o+=i)r+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return r}(e,t,n,i)>0)for(o=t;o<n;o+=i)a=ou(o,e[o],e[o+1],a);else for(o=n-i;o>=t;o-=i)a=ou(o,e[o],e[o+1],a);return a&&$c(a,a.next)&&(au(a),a=a.next),a}function Bc(e,t){if(!e)return e;t||(t=e);let n,i=e;do{if(n=!1,i.steiner||!$c(i,i.next)&&0!==Qc(i.prev,i,i.next))i=i.next;else{if(au(i),i=t=i.prev,i===i.next)break;n=!0}}while(n||i!==t);return t}function Vc(e,t,n,i,r,o,a){if(!e)return;!a&&o&&function(e,t,n,i){let r=e;do{null===r.z&&(r.z=Yc(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){let t,n,i,r,o,a,s,l,c=1;do{for(n=e,e=null,o=null,a=0;n;){for(a++,i=n,s=0,t=0;t<c&&(s++,i=i.nextZ,i);t++);for(l=c;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:e=r,r.prevZ=o,o=r;n=i}o.nextZ=null,c*=2}while(a>1)}(r)}(e,i,r,o);let s,l,c=e;for(;e.prev!==e.next;)if(s=e.prev,l=e.next,o?zc(e,i,r,o):Gc(e))t.push(s.i/n),t.push(e.i/n),t.push(l.i/n),au(e),e=l.next,c=l.next;else if((e=l)===c){a?1===a?Vc(e=Hc(Bc(e),t,n),t,n,i,r,o,2):2===a&&Wc(e,t,n,i,r,o):Vc(Bc(e),t,n,i,r,o,1);break}}function Gc(e){const t=e.prev,n=e,i=e.next;if(Qc(t,n,i)>=0)return!1;let r=e.next.next;for(;r!==e.prev;){if(Zc(t.x,t.y,n.x,n.y,i.x,i.y,r.x,r.y)&&Qc(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function zc(e,t,n,i){const r=e.prev,o=e,a=e.next;if(Qc(r,o,a)>=0)return!1;const s=r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,l=r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,c=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,u=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,h=Yc(s,l,t,n,i),d=Yc(c,u,t,n,i);let p=e.prevZ,f=e.nextZ;for(;p&&p.z>=h&&f&&f.z<=d;){if(p!==e.prev&&p!==e.next&&Zc(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Qc(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,f!==e.prev&&f!==e.next&&Zc(r.x,r.y,o.x,o.y,a.x,a.y,f.x,f.y)&&Qc(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;p&&p.z>=h;){if(p!==e.prev&&p!==e.next&&Zc(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Qc(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=d;){if(f!==e.prev&&f!==e.next&&Zc(r.x,r.y,o.x,o.y,a.x,a.y,f.x,f.y)&&Qc(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function Hc(e,t,n){let i=e;do{const r=i.prev,o=i.next.next;!$c(r,o)&&eu(r,i,i.next,o)&&iu(r,o)&&iu(o,r)&&(t.push(r.i/n),t.push(i.i/n),t.push(o.i/n),au(i),au(i.next),i=e=o),i=i.next}while(i!==e);return Bc(i)}function Wc(e,t,n,i,r,o){let a=e;do{let e=a.next.next;for(;e!==a.prev;){if(a.i!==e.i&&Jc(a,e)){let s=ru(a,e);return a=Bc(a,a.next),s=Bc(s,s.next),Vc(a,t,n,i,r,o),void Vc(s,t,n,i,r,o)}e=e.next}a=a.next}while(a!==e)}function jc(e,t){return e.x-t.x}function qc(e,t){if(t=function(e,t){let n=t;const i=e.x,r=e.y;let o,a=-1/0;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const e=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=i&&e>a){if(a=e,e===i){if(r===n.y)return n;if(r===n.next.y)return n.next}o=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!o)return null;if(i===a)return o;const s=o,l=o.x,c=o.y;let u,h=1/0;n=o;do{i>=n.x&&n.x>=l&&i!==n.x&&Zc(r<c?i:a,r,l,c,r<c?a:i,r,n.x,n.y)&&(u=Math.abs(r-n.y)/(i-n.x),iu(n,e)&&(u<h||u===h&&(n.x>o.x||n.x===o.x&&Xc(o,n)))&&(o=n,h=u)),n=n.next}while(n!==s);return o}(e,t),t){const n=ru(t,e);Bc(t,t.next),Bc(n,n.next)}}function Xc(e,t){return Qc(e.prev,e,t.prev)<0&&Qc(t.next,e,e.next)<0}function Yc(e,t,n,i,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Kc(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function Zc(e,t,n,i,r,o,a,s){return(r-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(i-s)-(n-a)*(t-s)>=0&&(n-a)*(o-s)-(r-a)*(i-s)>=0}function Jc(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&eu(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(iu(e,t)&&iu(t,e)&&function(e,t){let n=e,i=!1;const r=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)&&(Qc(e.prev,e,t.prev)||Qc(e,t.prev,t))||$c(e,t)&&Qc(e.prev,e,e.next)>0&&Qc(t.prev,t,t.next)>0)}function Qc(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function $c(e,t){return e.x===t.x&&e.y===t.y}function eu(e,t,n,i){const r=nu(Qc(e,t,n)),o=nu(Qc(e,t,i)),a=nu(Qc(n,i,e)),s=nu(Qc(n,i,t));return r!==o&&a!==s||(!(0!==r||!tu(e,n,t))||(!(0!==o||!tu(e,i,t))||(!(0!==a||!tu(n,e,i))||!(0!==s||!tu(n,t,i)))))}function tu(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function nu(e){return e>0?1:e<0?-1:0}function iu(e,t){return Qc(e.prev,e,e.next)<0?Qc(e,t,e.next)>=0&&Qc(e,e.prev,t)>=0:Qc(e,t,e.prev)<0||Qc(e,e.next,t)<0}function ru(e,t){const n=new su(e.i,e.x,e.y),i=new su(t.i,t.x,t.y),r=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function ou(e,t,n,i){const r=new su(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function au(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function su(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class lu{static area(e){const t=e.length;let n=0;for(let i=t-1,r=0;r<t;i=r++)n+=e[i].x*e[r].y-e[r].x*e[i].y;return.5*n}static isClockWise(e){return lu.area(e)<0}static triangulateShape(e,t){const n=[],i=[],r=[];cu(e),uu(n,e);let o=e.length;t.forEach(cu);for(let e=0;e<t.length;e++)i.push(o),o+=t[e].length,uu(n,t[e]);const a=Fc(n,i);for(let e=0;e<a.length;e+=3)r.push(a.slice(e,e+3));return r}}function cu(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function uu(e,t){for(let n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}class hu extends Eo{constructor(e,t){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,i=[],r=[];for(let t=0,n=e.length;t<n;t++){o(e[t])}function o(e){const o=[],a=void 0!==t.curveSegments?t.curveSegments:12,s=void 0!==t.steps?t.steps:1;let l=void 0!==t.depth?t.depth:100,c=void 0===t.bevelEnabled||t.bevelEnabled,u=void 0!==t.bevelThickness?t.bevelThickness:6,h=void 0!==t.bevelSize?t.bevelSize:u-2,d=void 0!==t.bevelOffset?t.bevelOffset:0,p=void 0!==t.bevelSegments?t.bevelSegments:3;const f=t.extrudePath,m=void 0!==t.UVGenerator?t.UVGenerator:du;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=t.amount);let g,v,y,b,_,x=!1;f&&(g=f.getSpacedPoints(s),x=!0,c=!1,v=f.computeFrenetFrames(s,!1),y=new Si,b=new Si,_=new Si),c||(p=0,u=0,h=0,d=0);const E=e.extractPoints(a);let w=E.shape;const S=E.holes;if(!lu.isClockWise(w)){w=w.reverse();for(let e=0,t=S.length;e<t;e++){const t=S[e];lu.isClockWise(t)&&(S[e]=t.reverse())}}const A=lu.triangulateShape(w,S),M=w;for(let e=0,t=S.length;e<t;e++){const t=S[e];w=w.concat(t)}function T(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}const C=w.length,P=A.length;function L(e,t,n){let i,r,o;const a=e.x-t.x,s=e.y-t.y,l=n.x-e.x,c=n.y-e.y,u=a*a+s*s,h=a*c-s*l;if(Math.abs(h)>Number.EPSILON){const h=Math.sqrt(u),d=Math.sqrt(l*l+c*c),p=t.x-s/h,f=t.y+a/h,m=((n.x-c/d-p)*c-(n.y+l/d-f)*l)/(a*c-s*l);i=p+a*m-e.x,r=f+s*m-e.y;const g=i*i+r*r;if(g<=2)return new di(i,r);o=Math.sqrt(g/2)}else{let e=!1;a>Number.EPSILON?l>Number.EPSILON&&(e=!0):a<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(s)===Math.sign(c)&&(e=!0),e?(i=-s,r=a,o=Math.sqrt(u)):(i=a,r=s,o=Math.sqrt(u/2))}return new di(i/o,r/o)}const R=[];for(let e=0,t=M.length,n=t-1,i=e+1;e<t;e++,n++,i++)n===t&&(n=0),i===t&&(i=0),R[e]=L(M[e],M[n],M[i]);const D=[];let I,O=R.concat();for(let e=0,t=S.length;e<t;e++){const t=S[e];I=[];for(let e=0,n=t.length,i=n-1,r=e+1;e<n;e++,i++,r++)i===n&&(i=0),r===n&&(r=0),I[e]=L(t[e],t[i],t[r]);D.push(I),O=O.concat(I)}for(let e=0;e<p;e++){const t=e/p,n=u*Math.cos(t*Math.PI/2),i=h*Math.sin(t*Math.PI/2)+d;for(let e=0,t=M.length;e<t;e++){const t=T(M[e],R[e],i);F(t.x,t.y,-n)}for(let e=0,t=S.length;e<t;e++){const t=S[e];I=D[e];for(let e=0,r=t.length;e<r;e++){const r=T(t[e],I[e],i);F(r.x,r.y,-n)}}}const N=h+d;for(let e=0;e<C;e++){const t=c?T(w[e],O[e],N):w[e];x?(b.copy(v.normals[0]).multiplyScalar(t.x),y.copy(v.binormals[0]).multiplyScalar(t.y),_.copy(g[0]).add(b).add(y),F(_.x,_.y,_.z)):F(t.x,t.y,0)}for(let e=1;e<=s;e++)for(let t=0;t<C;t++){const n=c?T(w[t],O[t],N):w[t];x?(b.copy(v.normals[e]).multiplyScalar(n.x),y.copy(v.binormals[e]).multiplyScalar(n.y),_.copy(g[e]).add(b).add(y),F(_.x,_.y,_.z)):F(n.x,n.y,l/s*e)}for(let e=p-1;e>=0;e--){const t=e/p,n=u*Math.cos(t*Math.PI/2),i=h*Math.sin(t*Math.PI/2)+d;for(let e=0,t=M.length;e<t;e++){const t=T(M[e],R[e],i);F(t.x,t.y,l+n)}for(let e=0,t=S.length;e<t;e++){const t=S[e];I=D[e];for(let e=0,r=t.length;e<r;e++){const r=T(t[e],I[e],i);x?F(r.x,r.y+g[s-1].y,g[s-1].x+n):F(r.x,r.y,l+n)}}}function k(e,t){let n=e.length;for(;--n>=0;){const i=n;let r=n-1;r<0&&(r=e.length-1);for(let e=0,n=s+2*p;e<n;e++){const n=C*e,o=C*(e+1);B(t+i+n,t+r+n,t+r+o,t+i+o)}}}function F(e,t,n){o.push(e),o.push(t),o.push(n)}function U(e,t,r){V(e),V(t),V(r);const o=i.length/3,a=m.generateTopUV(n,i,o-3,o-2,o-1);G(a[0]),G(a[1]),G(a[2])}function B(e,t,r,o){V(e),V(t),V(o),V(t),V(r),V(o);const a=i.length/3,s=m.generateSideWallUV(n,i,a-6,a-3,a-2,a-1);G(s[0]),G(s[1]),G(s[3]),G(s[1]),G(s[2]),G(s[3])}function V(e){i.push(o[3*e+0]),i.push(o[3*e+1]),i.push(o[3*e+2])}function G(e){r.push(e.x),r.push(e.y)}!function(){const e=i.length/3;if(c){let e=0,t=C*e;for(let e=0;e<P;e++){const n=A[e];U(n[2]+t,n[1]+t,n[0]+t)}e=s+2*p,t=C*e;for(let e=0;e<P;e++){const n=A[e];U(n[0]+t,n[1]+t,n[2]+t)}}else{for(let e=0;e<P;e++){const t=A[e];U(t[2],t[1],t[0])}for(let e=0;e<P;e++){const t=A[e];U(t[0]+C*s,t[1]+C*s,t[2]+C*s)}}n.addGroup(e,i.length/3-e,0)}(),function(){const e=i.length/3;let t=0;k(M,t),t+=M.length;for(let e=0,n=S.length;e<n;e++){const n=S[e];k(n,t),t+=n.length}n.addGroup(e,i.length/3-e,1)}()}this.setAttribute("position",new co(i,3)),this.setAttribute("uv",new co(r,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(let t=0,i=e.length;t<i;t++){const i=e[t];n.shapes.push(i.uuid)}else n.shapes.push(e.uuid);void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,e)}}const du={generateTopUV:function(e,t,n,i,r){const o=t[3*n],a=t[3*n+1],s=t[3*i],l=t[3*i+1],c=t[3*r],u=t[3*r+1];return[new di(o,a),new di(s,l),new di(c,u)]},generateSideWallUV:function(e,t,n,i,r,o){const a=t[3*n],s=t[3*n+1],l=t[3*n+2],c=t[3*i],u=t[3*i+1],h=t[3*i+2],d=t[3*r],p=t[3*r+1],f=t[3*r+2],m=t[3*o],g=t[3*o+1],v=t[3*o+2];return Math.abs(s-u)<Math.abs(a-c)?[new di(a,1-l),new di(c,1-h),new di(d,1-f),new di(m,1-v)]:[new di(s,1-l),new di(u,1-h),new di(p,1-f),new di(g,1-v)]}};class pu extends Lc{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}}class fu extends Eo{constructor(e,t=12,n=0,i=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t),i=Xn(i,0,2*Math.PI);const r=[],o=[],a=[],s=1/t,l=new Si,c=new di;for(let r=0;r<=t;r++){const u=n+r*s*i,h=Math.sin(u),d=Math.cos(u);for(let n=0;n<=e.length-1;n++)l.x=e[n].x*h,l.y=e[n].y,l.z=e[n].x*d,o.push(l.x,l.y,l.z),c.x=r/t,c.y=n/(e.length-1),a.push(c.x,c.y)}for(let n=0;n<t;n++)for(let t=0;t<e.length-1;t++){const i=t+n*e.length,o=i,a=i+e.length,s=i+e.length+1,l=i+1;r.push(o,a,l),r.push(a,s,l)}if(this.setIndex(r),this.setAttribute("position",new co(o,3)),this.setAttribute("uv",new co(a,2)),this.computeVertexNormals(),i===2*Math.PI){const n=this.attributes.normal.array,i=new Si,r=new Si,o=new Si,a=t*e.length*3;for(let t=0,s=0;t<e.length;t++,s+=3)i.x=n[s+0],i.y=n[s+1],i.z=n[s+2],r.x=n[a+s+0],r.y=n[a+s+1],r.z=n[a+s+2],o.addVectors(i,r).normalize(),n[s+0]=n[a+s+0]=o.x,n[s+1]=n[a+s+1]=o.y,n[s+2]=n[a+s+2]=o.z}}}class mu extends Lc{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}}class gu extends Eo{constructor(e,t,n){super(),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n};const i=[],r=[],o=[],a=[],s=1e-5,l=new Si,c=new Si,u=new Si,h=new Si,d=new Si;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const p=t+1;for(let i=0;i<=n;i++){const p=i/n;for(let n=0;n<=t;n++){const i=n/t;e(i,p,c),r.push(c.x,c.y,c.z),i-s>=0?(e(i-s,p,u),h.subVectors(c,u)):(e(i+s,p,u),h.subVectors(u,c)),p-s>=0?(e(i,p-s,u),d.subVectors(c,u)):(e(i,p+s,u),d.subVectors(u,c)),l.crossVectors(h,d).normalize(),o.push(l.x,l.y,l.z),a.push(i,p)}}for(let e=0;e<n;e++)for(let n=0;n<t;n++){const t=e*p+n,r=e*p+n+1,o=(e+1)*p+n+1,a=(e+1)*p+n;i.push(t,r,a),i.push(r,o,a)}this.setIndex(i),this.setAttribute("position",new co(r,3)),this.setAttribute("normal",new co(o,3)),this.setAttribute("uv",new co(a,2))}}class vu extends Eo{constructor(e=.5,t=1,n=8,i=1,r=0,o=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},n=Math.max(3,n);const a=[],s=[],l=[],c=[];let u=e;const h=(t-e)/(i=Math.max(1,i)),d=new Si,p=new di;for(let e=0;e<=i;e++){for(let e=0;e<=n;e++){const i=r+e/n*o;d.x=u*Math.cos(i),d.y=u*Math.sin(i),s.push(d.x,d.y,d.z),l.push(0,0,1),p.x=(d.x/t+1)/2,p.y=(d.y/t+1)/2,c.push(p.x,p.y)}u+=h}for(let e=0;e<i;e++){const t=e*(n+1);for(let e=0;e<n;e++){const i=e+t,r=i,o=i+n+1,s=i+n+2,l=i+1;a.push(r,o,l),a.push(o,s,l)}}this.setIndex(a),this.setAttribute("position",new co(s,3)),this.setAttribute("normal",new co(l,3)),this.setAttribute("uv",new co(c,2))}}class yu extends Eo{constructor(e,t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],i=[],r=[],o=[];let a=0,s=0;if(!1===Array.isArray(e))l(e);else for(let t=0;t<e.length;t++)l(e[t]),this.addGroup(a,s,t),a+=s,s=0;function l(e){const a=i.length/3,l=e.extractPoints(t);let c=l.shape;const u=l.holes;!1===lu.isClockWise(c)&&(c=c.reverse());for(let e=0,t=u.length;e<t;e++){const t=u[e];!0===lu.isClockWise(t)&&(u[e]=t.reverse())}const h=lu.triangulateShape(c,u);for(let e=0,t=u.length;e<t;e++){const t=u[e];c=c.concat(t)}for(let e=0,t=c.length;e<t;e++){const t=c[e];i.push(t.x,t.y,0),r.push(0,0,1),o.push(t.x,t.y)}for(let e=0,t=h.length;e<t;e++){const t=h[e],i=t[0]+a,r=t[1]+a,o=t[2]+a;n.push(i,r,o),s+=3}}this.setIndex(n),this.setAttribute("position",new co(i,3)),this.setAttribute("normal",new co(r,3)),this.setAttribute("uv",new co(o,2))}toJSON(){const e=super.toJSON();return function(e,t){if(t.shapes=[],Array.isArray(e))for(let n=0,i=e.length;n<i;n++){const i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}}class bu extends Eo{constructor(e=1,t=8,n=6,i=0,r=2*Math.PI,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const s=Math.min(o+a,Math.PI);let l=0;const c=[],u=new Si,h=new Si,d=[],p=[],f=[],m=[];for(let d=0;d<=n;d++){const g=[],v=d/n;let y=0;0==d&&0==o?y=.5/t:d==n&&s==Math.PI&&(y=-.5/t);for(let n=0;n<=t;n++){const s=n/t;u.x=-e*Math.cos(i+s*r)*Math.sin(o+v*a),u.y=e*Math.cos(o+v*a),u.z=e*Math.sin(i+s*r)*Math.sin(o+v*a),p.push(u.x,u.y,u.z),h.copy(u).normalize(),f.push(h.x,h.y,h.z),m.push(s+y,1-v),g.push(l++)}c.push(g)}for(let e=0;e<n;e++)for(let i=0;i<t;i++){const t=c[e][i+1],r=c[e][i],a=c[e+1][i],l=c[e+1][i+1];(0!==e||o>0)&&d.push(t,r,l),(e!==n-1||s<Math.PI)&&d.push(r,a,l)}this.setIndex(d),this.setAttribute("position",new co(p,3)),this.setAttribute("normal",new co(f,3)),this.setAttribute("uv",new co(m,2))}}class _u extends Lc{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}}class xu extends hu{constructor(e,t={}){const n=t.font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Eo;const i=n.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),super(i,t),this.type="TextGeometry"}}class Eu extends Eo{constructor(e=1,t=.4,n=8,i=6,r=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},n=Math.floor(n),i=Math.floor(i);const o=[],a=[],s=[],l=[],c=new Si,u=new Si,h=new Si;for(let o=0;o<=n;o++)for(let d=0;d<=i;d++){const p=d/i*r,f=o/n*Math.PI*2;u.x=(e+t*Math.cos(f))*Math.cos(p),u.y=(e+t*Math.cos(f))*Math.sin(p),u.z=t*Math.sin(f),a.push(u.x,u.y,u.z),c.x=e*Math.cos(p),c.y=e*Math.sin(p),h.subVectors(u,c).normalize(),s.push(h.x,h.y,h.z),l.push(d/i),l.push(o/n)}for(let e=1;e<=n;e++)for(let t=1;t<=i;t++){const n=(i+1)*e+t-1,r=(i+1)*(e-1)+t-1,a=(i+1)*(e-1)+t,s=(i+1)*e+t;o.push(n,r,s),o.push(r,a,s)}this.setIndex(o),this.setAttribute("position",new co(a,3)),this.setAttribute("normal",new co(s,3)),this.setAttribute("uv",new co(l,2))}}class wu extends Eo{constructor(e=1,t=.4,n=64,i=8,r=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:o},n=Math.floor(n),i=Math.floor(i);const a=[],s=[],l=[],c=[],u=new Si,h=new Si,d=new Si,p=new Si,f=new Si,m=new Si,g=new Si;for(let a=0;a<=n;++a){const y=a/n*r*Math.PI*2;v(y,r,o,e,d),v(y+.01,r,o,e,p),m.subVectors(p,d),g.addVectors(p,d),f.crossVectors(m,g),g.crossVectors(f,m),f.normalize(),g.normalize();for(let e=0;e<=i;++e){const r=e/i*Math.PI*2,o=-t*Math.cos(r),p=t*Math.sin(r);u.x=d.x+(o*g.x+p*f.x),u.y=d.y+(o*g.y+p*f.y),u.z=d.z+(o*g.z+p*f.z),s.push(u.x,u.y,u.z),h.subVectors(u,d).normalize(),l.push(h.x,h.y,h.z),c.push(a/n),c.push(e/i)}}for(let e=1;e<=n;e++)for(let t=1;t<=i;t++){const n=(i+1)*(e-1)+(t-1),r=(i+1)*e+(t-1),o=(i+1)*e+t,s=(i+1)*(e-1)+t;a.push(n,r,s),a.push(r,o,s)}function v(e,t,n,i,r){const o=Math.cos(e),a=Math.sin(e),s=n/t*e,l=Math.cos(s);r.x=i*(2+l)*.5*o,r.y=i*(2+l)*a*.5,r.z=i*Math.sin(s)*.5}this.setIndex(a),this.setAttribute("position",new co(s,3)),this.setAttribute("normal",new co(l,3)),this.setAttribute("uv",new co(c,2))}}class Su extends Eo{constructor(e,t=64,n=1,i=8,r=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r};const o=e.computeFrenetFrames(t,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new Si,s=new Si,l=new di;let c=new Si;const u=[],h=[],d=[],p=[];function f(r){c=e.getPointAt(r/t,c);const l=o.normals[r],d=o.binormals[r];for(let e=0;e<=i;e++){const t=e/i*Math.PI*2,r=Math.sin(t),o=-Math.cos(t);s.x=o*l.x+r*d.x,s.y=o*l.y+r*d.y,s.z=o*l.z+r*d.z,s.normalize(),h.push(s.x,s.y,s.z),a.x=c.x+n*s.x,a.y=c.y+n*s.y,a.z=c.z+n*s.z,u.push(a.x,a.y,a.z)}}!function(){for(let e=0;e<t;e++)f(e);f(!1===r?t:0),function(){for(let e=0;e<=t;e++)for(let n=0;n<=i;n++)l.x=e/t,l.y=n/i,d.push(l.x,l.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=i;t++){const n=(i+1)*(e-1)+(t-1),r=(i+1)*e+(t-1),o=(i+1)*e+t,a=(i+1)*(e-1)+t;p.push(n,r,a),p.push(r,o,a)}}()}(),this.setIndex(p),this.setAttribute("position",new co(u,3)),this.setAttribute("normal",new co(h,3)),this.setAttribute("uv",new co(d,2))}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}}class Au extends Eo{constructor(e){if(super(),this.type="WireframeGeometry",!0===e.isGeometry)return void console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const t=[],n=[0,0],i={},r=new Si;if(null!==e.index){const o=e.attributes.position,a=e.index;let s=e.groups;0===s.length&&(s=[{start:0,count:a.count,materialIndex:0}]);for(let e=0,t=s.length;e<t;++e){const t=s[e],r=t.start;for(let e=r,o=r+t.count;e<o;e+=3)for(let t=0;t<3;t++){const r=a.getX(e+t),o=a.getX(e+(t+1)%3);n[0]=Math.min(r,o),n[1]=Math.max(r,o);const s=n[0]+","+n[1];void 0===i[s]&&(i[s]={index1:n[0],index2:n[1]})}}for(const e in i){const n=i[e];r.fromBufferAttribute(o,n.index1),t.push(r.x,r.y,r.z),r.fromBufferAttribute(o,n.index2),t.push(r.x,r.y,r.z)}}else{const n=e.attributes.position;for(let e=0,i=n.count/3;e<i;e++)for(let i=0;i<3;i++){const o=3*e+i;r.fromBufferAttribute(n,o),t.push(r.x,r.y,r.z);const a=3*e+(i+1)%3;r.fromBufferAttribute(n,a),t.push(r.x,r.y,r.z)}}this.setAttribute("position",new co(t,3))}}class Mu extends Hr{constructor(e){super(),this.type="ShadowMaterial",this.color=new Zr(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}Mu.prototype.isShadowMaterial=!0;class Tu extends qo{constructor(e){super(e),this.type="RawShaderMaterial"}}Tu.prototype.isRawShaderMaterial=!0;class Cu extends Hr{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Zr(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Zr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=dn,this.normalScale=new di(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.vertexTangents=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this.vertexTangents=e.vertexTangents,this}}Cu.prototype.isMeshStandardMaterial=!0;class Pu extends Cu{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new di(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(e){this.reflectivity=Xn(2.5*(e-1)/(e+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.thickness=.01,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Zr(1,1,1),this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,e.sheen?this.sheen=(this.sheen||new Zr).copy(e.sheen):this.sheen=null,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this}}Pu.prototype.isMeshPhysicalMaterial=!0;class Lu extends Hr{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new Zr(16777215),this.specular=new Zr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Zr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=dn,this.normalScale=new di(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ee,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}Lu.prototype.isMeshPhongMaterial=!0;class Ru extends Hr{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Zr(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Zr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=dn,this.normalScale=new di(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this}}Ru.prototype.isMeshToonMaterial=!0;class Du extends Hr{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=dn,this.normalScale=new di(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}Du.prototype.isMeshNormalMaterial=!0;class Iu extends Hr{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new Zr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Zr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ee,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this}}Iu.prototype.isMeshLambertMaterial=!0;class Ou extends Hr{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Zr(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=dn,this.normalScale=new di(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}Ou.prototype.isMeshMatcapMaterial=!0;class Nu extends oc{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}Nu.prototype.isLineDashedMaterial=!0;const ku={arraySlice:function(e,t,n){return ku.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){const t=e.length,n=new Array(t);for(let e=0;e!==t;++e)n[e]=e;return n.sort((function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){const i=e.length,r=new e.constructor(i);for(let o=0,a=0;a!==i;++o){const i=n[o]*t;for(let n=0;n!==t;++n)r[a++]=e[i+n]}return r},flattenJSON:function(e,t,n,i){let r=1,o=e[0];for(;void 0!==o&&void 0===o[i];)o=e[r++];if(void 0===o)return;let a=o[i];if(void 0!==a)if(Array.isArray(a))do{a=o[i],void 0!==a&&(t.push(o.time),n.push.apply(n,a)),o=e[r++]}while(void 0!==o);else if(void 0!==a.toArray)do{a=o[i],void 0!==a&&(t.push(o.time),a.toArray(n,n.length)),o=e[r++]}while(void 0!==o);else do{a=o[i],void 0!==a&&(t.push(o.time),n.push(a)),o=e[r++]}while(void 0!==o)},subclip:function(e,t,n,i,r=30){const o=e.clone();o.name=t;const a=[];for(let e=0;e<o.tracks.length;++e){const t=o.tracks[e],s=t.getValueSize(),l=[],c=[];for(let e=0;e<t.times.length;++e){const o=t.times[e]*r;if(!(o<n||o>=i)){l.push(t.times[e]);for(let n=0;n<s;++n)c.push(t.values[e*s+n])}}0!==l.length&&(t.times=ku.convertArray(l,t.times.constructor),t.values=ku.convertArray(c,t.values.constructor),a.push(t))}o.tracks=a;let s=1/0;for(let e=0;e<o.tracks.length;++e)s>o.tracks[e].times[0]&&(s=o.tracks[e].times[0]);for(let e=0;e<o.tracks.length;++e)o.tracks[e].shift(-1*s);return o.resetDuration(),o},makeClipAdditive:function(e,t=0,n=e,i=30){i<=0&&(i=30);const r=n.tracks.length,o=t/i;for(let t=0;t<r;++t){const i=n.tracks[t],r=i.ValueTypeName;if("bool"===r||"string"===r)continue;const a=e.tracks.find((function(e){return e.name===i.name&&e.ValueTypeName===r}));if(void 0===a)continue;let s=0;const l=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(s=l/3);let c=0;const u=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);const h=i.times.length-1;let d;if(o<=i.times[0]){const e=s,t=l-s;d=ku.arraySlice(i.values,e,t)}else if(o>=i.times[h]){const e=h*l+s,t=e+l-s;d=ku.arraySlice(i.values,e,t)}else{const e=i.createInterpolant(),t=s,n=l-s;e.evaluate(o),d=ku.arraySlice(e.resultBuffer,t,n)}if("quaternion"===r){(new wi).fromArray(d).normalize().conjugate().toArray(d)}const p=a.times.length;for(let e=0;e<p;++e){const t=e*u+c;if("quaternion"===r)wi.multiplyQuaternionsFlat(a.values,t,d,0,a.values,t);else{const e=u-2*c;for(let n=0;n<e;++n)a.values[t+n]-=d[n]}}}return e.blendMode=Jt,e}};class Fu{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{let o;n:{i:if(!(e<i)){for(let o=n+2;;){if(void 0===i){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,r)}if(n===o)break;if(r=i,i=t[++n],e<i)break t}o=t.length;break n}if(e>=r)break e;{const a=t[1];e<a&&(n=2,r=a);for(let o=n-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(n===o)break;if(i=r,r=t[--n-1],e>=r)break t}o=n,n=0}}for(;n<o;){const i=n+o>>>1;e<t[i]?o=i:n=i+1}if(i=t[n],r=t[n-1],void 0===r)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(void 0===i)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,r,e)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i;for(let e=0;e!==i;++e)t[e]=n[r+e];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Fu.prototype.beforeStart_=Fu.prototype.copySampleValue_,Fu.prototype.afterEnd_=Fu.prototype.copySampleValue_;class Uu extends Fu{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Xt,endingEnd:Xt}}intervalChanged_(e,t,n){const i=this.parameterPositions;let r=e-2,o=e+1,a=i[r],s=i[o];if(void 0===a)switch(this.getSettings_().endingStart){case Yt:r=e,a=2*t-n;break;case Kt:r=i.length-2,a=t+i[r]-i[r+1];break;default:r=e,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case Yt:o=e,s=2*n-t;break;case Kt:o=1,s=n+i[1]-i[0];break;default:o=e-1,s=t}const l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(s-n),this._offsetPrev=r*c,this._offsetNext=o*c}interpolate_(e,t,n,i){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=s-a,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-t)/(i-t),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,v=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,b=d*m-d*f;for(let e=0;e!==a;++e)r[e]=g*o[c+e]+v*o[l+e]+y*o[s+e]+b*o[u+e];return r}}class Bu extends Fu{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=s-a,c=(n-t)/(i-t),u=1-c;for(let e=0;e!==a;++e)r[e]=o[l+e]*u+o[s+e]*c;return r}}class Vu extends Fu{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class Gu{constructor(e,t,n,i){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ku.convertArray(t,this.TimeBufferType),this.values=ku.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:ku.convertArray(e.times,Array),values:ku.convertArray(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Vu(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Bu(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Uu(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Wt:t=this.InterpolantFactoryMethodDiscrete;break;case jt:t=this.InterpolantFactoryMethodLinear;break;case qt:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Wt;case this.InterpolantFactoryMethodLinear:return jt;case this.InterpolantFactoryMethodSmooth:return qt}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let r=0,o=i-1;for(;r!==i&&n[r]<e;)++r;for(;-1!==o&&n[o]>t;)--o;if(++o,0!==r||o!==i){r>=o&&(o=Math.max(o,1),r=o-1);const e=this.getValueSize();this.times=ku.arraySlice(n,r,o),this.values=ku.arraySlice(this.values,r*e,o*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let t=0;t!==r;t++){const i=n[t];if("number"==typeof i&&isNaN(i)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,t,i),e=!1;break}if(null!==o&&o>i){console.error("THREE.KeyframeTrack: Out of order keys.",this,t,i,o),e=!1;break}o=i}if(void 0!==i&&ku.isTypedArray(i))for(let t=0,n=i.length;t!==n;++t){const n=i[t];if(isNaN(n)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,t,n),e=!1;break}}return e}optimize(){const e=ku.arraySlice(this.times),t=ku.arraySlice(this.values),n=this.getValueSize(),i=this.getInterpolation()===qt,r=e.length-1;let o=1;for(let a=1;a<r;++a){let r=!1;const s=e[a];if(s!==e[a+1]&&(1!==a||s!==e[0]))if(i)r=!0;else{const e=a*n,i=e-n,o=e+n;for(let a=0;a!==n;++a){const n=t[e+a];if(n!==t[i+a]||n!==t[o+a]){r=!0;break}}}if(r){if(a!==o){e[o]=e[a];const i=a*n,r=o*n;for(let e=0;e!==n;++e)t[r+e]=t[i+e]}++o}}if(r>0){e[o]=e[r];for(let e=r*n,i=o*n,a=0;a!==n;++a)t[i+a]=t[e+a];++o}return o!==e.length?(this.times=ku.arraySlice(e,0,o),this.values=ku.arraySlice(t,0,o*n)):(this.times=e,this.values=t),this}clone(){const e=ku.arraySlice(this.times,0),t=ku.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}Gu.prototype.TimeBufferType=Float32Array,Gu.prototype.ValueBufferType=Float32Array,Gu.prototype.DefaultInterpolation=jt;class zu extends Gu{}zu.prototype.ValueTypeName="bool",zu.prototype.ValueBufferType=Array,zu.prototype.DefaultInterpolation=Wt,zu.prototype.InterpolantFactoryMethodLinear=void 0,zu.prototype.InterpolantFactoryMethodSmooth=void 0;class Hu extends Gu{}Hu.prototype.ValueTypeName="color";class Wu extends Gu{}Wu.prototype.ValueTypeName="number";class ju extends Fu{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(n-t)/(i-t);let l=e*a;for(let e=l+a;l!==e;l+=4)wi.slerpFlat(r,0,o,l-a,o,l,s);return r}}class qu extends Gu{InterpolantFactoryMethodLinear(e){return new ju(this.times,this.values,this.getValueSize(),e)}}qu.prototype.ValueTypeName="quaternion",qu.prototype.DefaultInterpolation=jt,qu.prototype.InterpolantFactoryMethodSmooth=void 0;class Xu extends Gu{}Xu.prototype.ValueTypeName="string",Xu.prototype.ValueBufferType=Array,Xu.prototype.DefaultInterpolation=Wt,Xu.prototype.InterpolantFactoryMethodLinear=void 0,Xu.prototype.InterpolantFactoryMethodSmooth=void 0;class Yu extends Gu{}Yu.prototype.ValueTypeName="vector";class Ku{constructor(e,t=-1,n,i=Zt){this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=qn(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,i=1/(e.fps||1);for(let e=0,r=n.length;e!==r;++e)t.push(Zu(n[e]).scale(i));const r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r}static toJSON(e){const t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let e=0,i=n.length;e!==i;++e)t.push(Gu.toJSON(n[e]));return i}static CreateFromMorphTargetSequence(e,t,n,i){const r=t.length,o=[];for(let e=0;e<r;e++){let a=[],s=[];a.push((e+r-1)%r,e,(e+1)%r),s.push(0,1,0);const l=ku.getKeyframeOrder(a);a=ku.sortedArray(a,1,l),s=ku.sortedArray(s,1,l),i||0!==a[0]||(a.push(r),s.push(s[0])),o.push(new Wu(".morphTargetInfluences["+t[e].name+"]",a,s).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const t=e;n=t.geometry&&t.geometry.animations||t.animations}for(let e=0;e<n.length;e++)if(n[e].name===t)return n[e];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const i={},r=/^([\w-]*?)([\d]+)$/;for(let t=0,n=e.length;t<n;t++){const n=e[t],o=n.name.match(r);if(o&&o.length>1){const e=o[1];let t=i[e];t||(i[e]=t=[]),t.push(n)}}const o=[];for(const e in i)o.push(this.CreateFromMorphTargetSequence(e,i[e],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(e,t,n,i,r){if(0!==n.length){const o=[],a=[];ku.flattenJSON(n,o,a,i),0!==o.length&&r.push(new e(t,o,a))}},i=[],r=e.name||"default",o=e.fps||30,a=e.blendMode;let s=e.length||-1;const l=e.hierarchy||[];for(let e=0;e<l.length;e++){const r=l[e].keys;if(r&&0!==r.length)if(r[0].morphTargets){const e={};let t;for(t=0;t<r.length;t++)if(r[t].morphTargets)for(let n=0;n<r[t].morphTargets.length;n++)e[r[t].morphTargets[n]]=-1;for(const n in e){const e=[],o=[];for(let i=0;i!==r[t].morphTargets.length;++i){const i=r[t];e.push(i.time),o.push(i.morphTarget===n?1:0)}i.push(new Wu(".morphTargetInfluence["+n+"]",e,o))}s=e.length*(o||1)}else{const o=".bones["+t[e].name+"]";n(Yu,o+".position",r,"pos",i),n(qu,o+".quaternion",r,"rot",i),n(Yu,o+".scale",r,"scl",i)}}if(0===i.length)return null;return new this(r,s,i,a)}resetDuration(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){const n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Zu(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Wu;case"vector":case"vector2":case"vector3":case"vector4":return Yu;case"color":return Hu;case"quaternion":return qu;case"bool":case"boolean":return zu;case"string":return Xu}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],n=[];ku.flattenJSON(e.keys,t,n,"value"),e.times=t,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}const Ju={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class Qu{constructor(e,t,n){const i=this;let r,o=!1,a=0,s=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){s++,!1===o&&void 0!==i.onStart&&i.onStart(e,a,s),o=!0},this.itemEnd=function(e){a++,void 0!==i.onProgress&&i.onProgress(e,a,s),a===s&&(o=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return r?r(e):e},this.setURLModifier=function(e){return r=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){const n=l[t],i=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return i}return null}}}const $u=new Qu;class eh{constructor(e){this.manager=void 0!==e?e:$u,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise((function(i,r){n.load(e,i,t,r)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const th={};class nh extends eh{constructor(e){super(e)}load(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=Ju.get(e);if(void 0!==o)return r.manager.itemStart(e),setTimeout((function(){t&&t(o),r.manager.itemEnd(e)}),0),o;if(void 0!==th[e])return void th[e].push({onLoad:t,onProgress:n,onError:i});const a=e.match(/^data:(.*?)(;base64)?,(.*)$/);let s;if(a){const n=a[1],o=!!a[2];let s=a[3];s=decodeURIComponent(s),o&&(s=atob(s));try{let i;const o=(this.responseType||"").toLowerCase();switch(o){case"arraybuffer":case"blob":const e=new Uint8Array(s.length);for(let t=0;t<s.length;t++)e[t]=s.charCodeAt(t);i="blob"===o?new Blob([e.buffer],{type:n}):e.buffer;break;case"document":const t=new DOMParser;i=t.parseFromString(s,n);break;case"json":i=JSON.parse(s);break;default:i=s}setTimeout((function(){t&&t(i),r.manager.itemEnd(e)}),0)}catch(t){setTimeout((function(){i&&i(t),r.manager.itemError(e),r.manager.itemEnd(e)}),0)}}else{th[e]=[],th[e].push({onLoad:t,onProgress:n,onError:i}),s=new XMLHttpRequest,s.open("GET",e,!0),s.addEventListener("load",(function(t){const n=this.response,i=th[e];if(delete th[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Ju.add(e,n);for(let e=0,t=i.length;e<t;e++){const t=i[e];t.onLoad&&t.onLoad(n)}r.manager.itemEnd(e)}else{for(let e=0,n=i.length;e<n;e++){const n=i[e];n.onError&&n.onError(t)}r.manager.itemError(e),r.manager.itemEnd(e)}}),!1),s.addEventListener("progress",(function(t){const n=th[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onProgress&&i.onProgress(t)}}),!1),s.addEventListener("error",(function(t){const n=th[e];delete th[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onError&&i.onError(t)}r.manager.itemError(e),r.manager.itemEnd(e)}),!1),s.addEventListener("abort",(function(t){const n=th[e];delete th[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onError&&i.onError(t)}r.manager.itemError(e),r.manager.itemEnd(e)}),!1),void 0!==this.responseType&&(s.responseType=this.responseType),void 0!==this.withCredentials&&(s.withCredentials=this.withCredentials),s.overrideMimeType&&s.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const e in this.requestHeader)s.setRequestHeader(e,this.requestHeader[e]);s.send(null)}return r.manager.itemStart(e),s}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class ih extends eh{constructor(e){super(e)}load(e,t,n,i){const r=this,o=new nh(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){try{t(r.parse(JSON.parse(n)))}catch(t){i?i(t):console.error(t),r.manager.itemError(e)}}),n,i)}parse(e){const t=[];for(let n=0;n<e.length;n++){const i=Ku.parse(e[n]);t.push(i)}return t}}class rh extends eh{constructor(e){super(e)}load(e,t,n,i){const r=this,o=[],a=new Sc,s=new nh(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(r.withCredentials);let l=0;function c(c){s.load(e[c],(function(e){const n=r.parse(e,!0);o[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},l+=1,6===l&&(1===n.mipmapCount&&(a.minFilter=Se),a.image=o,a.format=n.format,a.needsUpdate=!0,t&&t(a))}),n,i)}if(Array.isArray(e))for(let t=0,n=e.length;t<n;++t)c(t);else s.load(e,(function(e){const n=r.parse(e,!0);if(n.isCubemap){const e=n.mipmaps.length/n.mipmapCount;for(let t=0;t<e;t++){o[t]={mipmaps:[]};for(let e=0;e<n.mipmapCount;e++)o[t].mipmaps.push(n.mipmaps[t*n.mipmapCount+e]),o[t].format=n.format,o[t].width=n.width,o[t].height=n.height}a.image=o}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=Se),a.format=n.format,a.needsUpdate=!0,t&&t(a)}),n,i);return a}}class oh extends eh{constructor(e){super(e)}load(e,t,n,i){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=Ju.get(e);if(void 0!==o)return r.manager.itemStart(e),setTimeout((function(){t&&t(o),r.manager.itemEnd(e)}),0),o;const a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",l,!1),Ju.add(e,this),t&&t(this),r.manager.itemEnd(e)}function l(t){a.removeEventListener("load",s,!1),a.removeEventListener("error",l,!1),i&&i(t),r.manager.itemError(e),r.manager.itemEnd(e)}return a.addEventListener("load",s,!1),a.addEventListener("error",l,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),r.manager.itemStart(e),a.src=e,a}}class ah extends eh{constructor(e){super(e)}load(e,t,n,i){const r=new Jo,o=new oh(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function s(n){o.load(e[n],(function(e){r.images[n]=e,a++,6===a&&(r.needsUpdate=!0,t&&t(r))}),void 0,i)}for(let t=0;t<e.length;++t)s(t);return r}}class sh extends eh{constructor(e){super(e)}load(e,t,n,i){const r=this,o=new Zl,a=new nh(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(r.withCredentials),a.load(e,(function(e){const n=r.parse(e);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:ve,o.wrapT=void 0!==n.wrapT?n.wrapT:ve,o.magFilter=void 0!==n.magFilter?n.magFilter:Se,o.minFilter=void 0!==n.minFilter?n.minFilter:Se,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.encoding&&(o.encoding=n.encoding),void 0!==n.flipY&&(o.flipY=n.flipY),void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps,o.minFilter=Te),1===n.mipmapCount&&(o.minFilter=Se),void 0!==n.generateMipmaps&&(o.generateMipmaps=n.generateMipmaps),o.needsUpdate=!0,t&&t(o,n))}),n,i),o}}class lh extends eh{constructor(e){super(e)}load(e,t,n,i){const r=new vi,o=new oh(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,(function(n){r.image=n;const i=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);r.format=i?ze:He,r.needsUpdate=!0,void 0!==t&&t(r)}),n,i),r}}class ch{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),r=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),r+=n.distanceTo(i),t.push(r),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let i=0;const r=n.length;let o;o=t||e*n[r-1];let a,s=0,l=r-1;for(;s<=l;)if(i=Math.floor(s+(l-s)/2),a=n[i]-o,a<0)s=i+1;else{if(!(a>0)){l=i;break}l=i-1}if(i=l,n[i]===o)return i/(r-1);const c=n[i];return(i+(o-c)/(n[i+1]-c))/(r-1)}getTangent(e,t){const n=1e-4;let i=e-n,r=e+n;i<0&&(i=0),r>1&&(r=1);const o=this.getPoint(i),a=this.getPoint(r),s=t||(o.isVector2?new di:new Si);return s.copy(a).sub(o).normalize(),s}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new Si,i=[],r=[],o=[],a=new Si,s=new tr;for(let t=0;t<=e;t++){const n=t/e;i[t]=this.getTangentAt(n,new Si),i[t].normalize()}r[0]=new Si,o[0]=new Si;let l=Number.MAX_VALUE;const c=Math.abs(i[0].x),u=Math.abs(i[0].y),h=Math.abs(i[0].z);c<=l&&(l=c,n.set(1,0,0)),u<=l&&(l=u,n.set(0,1,0)),h<=l&&n.set(0,0,1),a.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],a),o[0].crossVectors(i[0],r[0]);for(let t=1;t<=e;t++){if(r[t]=r[t-1].clone(),o[t]=o[t-1].clone(),a.crossVectors(i[t-1],i[t]),a.length()>Number.EPSILON){a.normalize();const e=Math.acos(Xn(i[t-1].dot(i[t]),-1,1));r[t].applyMatrix4(s.makeRotationAxis(a,e))}o[t].crossVectors(i[t],r[t])}if(!0===t){let t=Math.acos(Xn(r[0].dot(r[e]),-1,1));t/=e,i[0].dot(a.crossVectors(r[0],r[e]))>0&&(t=-t);for(let n=1;n<=e;n++)r[n].applyMatrix4(s.makeRotationAxis(i[n],t*n)),o[n].crossVectors(i[n],r[n])}return{tangents:i,normals:r,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class uh extends ch{constructor(e=0,t=0,n=1,i=1,r=0,o=2*Math.PI,a=!1,s=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=a,this.aRotation=s}getPoint(e,t){const n=t||new di,i=2*Math.PI;let r=this.aEndAngle-this.aStartAngle;const o=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(r=o?0:i),!0!==this.aClockwise||o||(r===i?r=-i:r-=i);const a=this.aStartAngle+e*r;let s=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),n=s-this.aX,i=l-this.aY;s=n*e-i*t+this.aX,l=n*t+i*e+this.aY}return n.set(s,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}uh.prototype.isEllipseCurve=!0;class hh extends uh{constructor(e,t,n,i,r,o){super(e,t,n,n,i,r,o),this.type="ArcCurve"}}function dh(){let e=0,t=0,n=0,i=0;function r(r,o,a,s){e=r,t=a,n=-3*r+3*o-2*a-s,i=2*r-2*o+a+s}return{initCatmullRom:function(e,t,n,i,o){r(t,n,o*(n-e),o*(i-t))},initNonuniformCatmullRom:function(e,t,n,i,o,a,s){let l=(t-e)/o-(n-e)/(o+a)+(n-t)/a,c=(n-t)/a-(i-t)/(a+s)+(i-n)/s;l*=a,c*=a,r(t,n,l,c)},calc:function(r){const o=r*r;return e+t*r+n*o+i*(o*r)}}}hh.prototype.isArcCurve=!0;const ph=new Si,fh=new dh,mh=new dh,gh=new dh;class vh extends ch{constructor(e=[],t=!1,n="centripetal",i=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e,t=new Si){const n=t,i=this.points,r=i.length,o=(r-(this.closed?0:1))*e;let a,s,l=Math.floor(o),c=o-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/r)+1)*r:0===c&&l===r-1&&(l=r-2,c=1),this.closed||l>0?a=i[(l-1)%r]:(ph.subVectors(i[0],i[1]).add(i[0]),a=ph);const u=i[l%r],h=i[(l+1)%r];if(this.closed||l+2<r?s=i[(l+2)%r]:(ph.subVectors(i[r-1],i[r-2]).add(i[r-1]),s=ph),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(a.distanceToSquared(u),e),n=Math.pow(u.distanceToSquared(h),e),i=Math.pow(h.distanceToSquared(s),e);n<1e-4&&(n=1),t<1e-4&&(t=n),i<1e-4&&(i=n),fh.initNonuniformCatmullRom(a.x,u.x,h.x,s.x,t,n,i),mh.initNonuniformCatmullRom(a.y,u.y,h.y,s.y,t,n,i),gh.initNonuniformCatmullRom(a.z,u.z,h.z,s.z,t,n,i)}else"catmullrom"===this.curveType&&(fh.initCatmullRom(a.x,u.x,h.x,s.x,this.tension),mh.initCatmullRom(a.y,u.y,h.y,s.y,this.tension),gh.initCatmullRom(a.z,u.z,h.z,s.z,this.tension));return n.set(fh.calc(c),mh.calc(c),gh.calc(c)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new Si).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function yh(e,t,n,i,r){const o=.5*(i-t),a=.5*(r-n),s=e*e;return(2*n-2*i+o+a)*(e*s)+(-3*n+3*i-2*o-a)*s+o*e+n}function bh(e,t,n,i){return function(e,t){const n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,i)}function _h(e,t,n,i,r){return function(e,t){const n=1-e;return n*n*n*t}(e,t)+function(e,t){const n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,i)+function(e,t){return e*e*e*t}(e,r)}vh.prototype.isCatmullRomCurve3=!0;class xh extends ch{constructor(e=new di,t=new di,n=new di,i=new di){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new di){const n=t,i=this.v0,r=this.v1,o=this.v2,a=this.v3;return n.set(_h(e,i.x,r.x,o.x,a.x),_h(e,i.y,r.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}xh.prototype.isCubicBezierCurve=!0;class Eh extends ch{constructor(e=new Si,t=new Si,n=new Si,i=new Si){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new Si){const n=t,i=this.v0,r=this.v1,o=this.v2,a=this.v3;return n.set(_h(e,i.x,r.x,o.x,a.x),_h(e,i.y,r.y,o.y,a.y),_h(e,i.z,r.z,o.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}Eh.prototype.isCubicBezierCurve3=!0;class wh extends ch{constructor(e=new di,t=new di){super(),this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new di){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const n=t||new di;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}wh.prototype.isLineCurve=!0;class Sh extends ch{constructor(e=new Si,t=new Si){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new Si){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Ah extends ch{constructor(e=new di,t=new di,n=new di){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new di){const n=t,i=this.v0,r=this.v1,o=this.v2;return n.set(bh(e,i.x,r.x,o.x),bh(e,i.y,r.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Ah.prototype.isQuadraticBezierCurve=!0;class Mh extends ch{constructor(e=new Si,t=new Si,n=new Si){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Si){const n=t,i=this.v0,r=this.v1,o=this.v2;return n.set(bh(e,i.x,r.x,o.x),bh(e,i.y,r.y,o.y),bh(e,i.z,r.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Mh.prototype.isQuadraticBezierCurve3=!0;class Th extends ch{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,t=new di){const n=t,i=this.points,r=(i.length-1)*e,o=Math.floor(r),a=r-o,s=i[0===o?o:o-1],l=i[o],c=i[o>i.length-2?i.length-1:o+1],u=i[o>i.length-3?i.length-1:o+2];return n.set(yh(a,s.x,l.x,c.x,u.x),yh(a,s.y,l.y,c.y,u.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new di).fromArray(n))}return this}}Th.prototype.isSplineCurve=!0;class Ch extends ch{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new wh(t,e))}getPoint(e){const t=e*this.getLength(),n=this.getCurveLengths();let i=0;for(;i<n.length;){if(n[i]>=t){const e=n[i]-t,r=this.curves[i],o=r.getLength(),a=0===o?0:1-e/o;return r.getPointAt(a)}i++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let i=0,r=this.curves;i<r.length;i++){const o=r[i],a=o&&o.isEllipseCurve?2*e:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?e*o.points.length:e,s=o.getPoints(a);for(let e=0;e<s.length;e++){const i=s[e];n&&n.equals(i)||(t.push(i),n=i)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push((new a[n.type]).fromJSON(n))}return this}}class Ph extends Ch{constructor(e){super(),this.type="Path",this.currentPoint=new di,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new wh(this.currentPoint.clone(),new di(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){const r=new Ah(this.currentPoint.clone(),new di(e,t),new di(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,r,o){const a=new xh(this.currentPoint.clone(),new di(e,t),new di(n,i),new di(r,o));return this.curves.push(a),this.currentPoint.set(r,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new Th(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,r,o){const a=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+a,t+s,n,i,r,o),this}absarc(e,t,n,i,r,o){return this.absellipse(e,t,n,n,i,r,o),this}ellipse(e,t,n,i,r,o,a,s){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,n,i,r,o,a,s),this}absellipse(e,t,n,i,r,o,a,s){const l=new uh(e,t,n,i,r,o,a,s);if(this.curves.length>0){const e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Lh extends Ph{constructor(e){super(e),this.uuid=qn(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push((new Ph).fromJSON(n))}return this}}class Rh extends Mr{constructor(e,t=1){super(),this.type="Light",this.color=new Zr(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}Rh.prototype.isLight=!0;class Dh extends Rh{constructor(e,t,n){super(e,n),this.type="HemisphereLight",this.position.copy(Mr.DefaultUp),this.updateMatrix(),this.groundColor=new Zr(t)}copy(e){return Rh.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}Dh.prototype.isHemisphereLight=!0;const Ih=new tr,Oh=new Si,Nh=new Si;class kh{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new di(512,512),this.map=null,this.mapPass=null,this.matrix=new tr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ta,this._frameExtents=new di(1,1),this._viewportCount=1,this._viewports=[new bi(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Oh.setFromMatrixPosition(e.matrixWorld),t.position.copy(Oh),Nh.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Nh),t.updateMatrixWorld(),Ih.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Ih),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Fh extends kh{constructor(){super(new Yo(50,1,.5,500)),this.focus=1}updateMatrices(e){const t=this.camera,n=2*jn*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;n===t.fov&&i===t.aspect&&r===t.far||(t.fov=n,t.aspect=i,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}Fh.prototype.isSpotLightShadow=!0;class Uh extends Rh{constructor(e,t,n=0,i=Math.PI/3,r=0,o=1){super(e,t),this.type="SpotLight",this.position.copy(Mr.DefaultUp),this.updateMatrix(),this.target=new Mr,this.distance=n,this.angle=i,this.penumbra=r,this.decay=o,this.shadow=new Fh}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}Uh.prototype.isSpotLight=!0;const Bh=new tr,Vh=new Si,Gh=new Si;class zh extends kh{constructor(){super(new Yo(90,1,.5,500)),this._frameExtents=new di(4,2),this._viewportCount=6,this._viewports=[new bi(2,1,1,1),new bi(0,1,1,1),new bi(3,1,1,1),new bi(1,1,1,1),new bi(3,0,1,1),new bi(1,0,1,1)],this._cubeDirections=[new Si(1,0,0),new Si(-1,0,0),new Si(0,0,1),new Si(0,0,-1),new Si(0,1,0),new Si(0,-1,0)],this._cubeUps=[new Si(0,1,0),new Si(0,1,0),new Si(0,1,0),new Si(0,1,0),new Si(0,0,1),new Si(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,i=this.matrix,r=e.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),Vh.setFromMatrixPosition(e.matrixWorld),n.position.copy(Vh),Gh.copy(n.position),Gh.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Gh),n.updateMatrixWorld(),i.makeTranslation(-Vh.x,-Vh.y,-Vh.z),Bh.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Bh)}}zh.prototype.isPointLightShadow=!0;class Hh extends Rh{constructor(e,t,n=0,i=1){super(e,t),this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new zh}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}Hh.prototype.isPointLight=!0;class Wh extends Xo{constructor(e=-1,t=1,n=1,i=-1,r=.1,o=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=r,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,r,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-e,o=n+e,a=i+t,s=i-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=e*this.view.offsetX,o=r+e*this.view.width,a-=t*this.view.offsetY,s=a-t*this.view.height}this.projectionMatrix.makeOrthographic(r,o,a,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}Wh.prototype.isOrthographicCamera=!0;class jh extends kh{constructor(){super(new Wh(-5,5,5,-5,.5,500))}}jh.prototype.isDirectionalLightShadow=!0;class qh extends Rh{constructor(e,t){super(e,t),this.type="DirectionalLight",this.position.copy(Mr.DefaultUp),this.updateMatrix(),this.target=new Mr,this.shadow=new jh}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}qh.prototype.isDirectionalLight=!0;class Xh extends Rh{constructor(e,t){super(e,t),this.type="AmbientLight"}}Xh.prototype.isAmbientLight=!0;class Yh extends Rh{constructor(e,t,n=10,i=10){super(e,t),this.type="RectAreaLight",this.width=n,this.height=i}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}Yh.prototype.isRectAreaLight=!0;class Kh{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Si)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,i=e.y,r=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*i),t.addScaledVector(o[2],.488603*r),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],n*i*1.092548),t.addScaledVector(o[5],i*r*1.092548),t.addScaledVector(o[6],.315392*(3*r*r-1)),t.addScaledVector(o[7],n*r*1.092548),t.addScaledVector(o[8],.546274*(n*n-i*i)),t}getIrradianceAt(e,t){const n=e.x,i=e.y,r=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],1.023328*i),t.addScaledVector(o[2],1.023328*r),t.addScaledVector(o[3],1.023328*n),t.addScaledVector(o[4],.858086*n*i),t.addScaledVector(o[5],.858086*i*r),t.addScaledVector(o[6],.743125*r*r-.247708),t.addScaledVector(o[7],.858086*n*r),t.addScaledVector(o[8],.429043*(n*n-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+3*i);return this}toArray(e=[],t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+3*i);return e}static getBasisAt(e,t){const n=e.x,i=e.y,r=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*r,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*n*r,t[8]=.546274*(n*n-i*i)}}Kh.prototype.isSphericalHarmonics3=!0;class Zh extends Rh{constructor(e=new Kh,t=1){super(void 0,t),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}Zh.prototype.isLightProbe=!0;class Jh extends eh{constructor(e){super(e),this.textures={}}load(e,t,n,i){const r=this,o=new nh(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,(function(n){try{t(r.parse(JSON.parse(n)))}catch(t){i?i(t):console.error(t),r.manager.itemError(e)}}),n,i)}parse(e){const t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}const i=new o[e.type];if(void 0!==e.uuid&&(i.uuid=e.uuid),void 0!==e.name&&(i.name=e.name),void 0!==e.color&&void 0!==i.color&&i.color.setHex(e.color),void 0!==e.roughness&&(i.roughness=e.roughness),void 0!==e.metalness&&(i.metalness=e.metalness),void 0!==e.sheen&&(i.sheen=(new Zr).setHex(e.sheen)),void 0!==e.emissive&&void 0!==i.emissive&&i.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==i.specular&&i.specular.setHex(e.specular),void 0!==e.shininess&&(i.shininess=e.shininess),void 0!==e.clearcoat&&(i.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(i.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.transmission&&(i.transmission=e.transmission),void 0!==e.thickness&&(i.thickness=e.thickness),void 0!==e.attenuationDistance&&(i.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==i.attenuationColor&&i.attenuationColor.setHex(e.attenuationColor),void 0!==e.fog&&(i.fog=e.fog),void 0!==e.flatShading&&(i.flatShading=e.flatShading),void 0!==e.blending&&(i.blending=e.blending),void 0!==e.combine&&(i.combine=e.combine),void 0!==e.side&&(i.side=e.side),void 0!==e.shadowSide&&(i.shadowSide=e.shadowSide),void 0!==e.opacity&&(i.opacity=e.opacity),void 0!==e.transparent&&(i.transparent=e.transparent),void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest),void 0!==e.depthTest&&(i.depthTest=e.depthTest),void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(i.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(i.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(i.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(i.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(i.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(i.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(i.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(i.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(i.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(i.rotation=e.rotation),1!==e.linewidth&&(i.linewidth=e.linewidth),void 0!==e.dashSize&&(i.dashSize=e.dashSize),void 0!==e.gapSize&&(i.gapSize=e.gapSize),void 0!==e.scale&&(i.scale=e.scale),void 0!==e.polygonOffset&&(i.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(i.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(i.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.morphTargets&&(i.morphTargets=e.morphTargets),void 0!==e.morphNormals&&(i.morphNormals=e.morphNormals),void 0!==e.dithering&&(i.dithering=e.dithering),void 0!==e.alphaToCoverage&&(i.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(i.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.vertexTangents&&(i.vertexTangents=e.vertexTangents),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.toneMapped&&(i.toneMapped=e.toneMapped),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),void 0!==e.uniforms)for(const t in e.uniforms){const r=e.uniforms[t];switch(i.uniforms[t]={},r.type){case"t":i.uniforms[t].value=n(r.value);break;case"c":i.uniforms[t].value=(new Zr).setHex(r.value);break;case"v2":i.uniforms[t].value=(new di).fromArray(r.value);break;case"v3":i.uniforms[t].value=(new Si).fromArray(r.value);break;case"v4":i.uniforms[t].value=(new bi).fromArray(r.value);break;case"m3":i.uniforms[t].value=(new pi).fromArray(r.value);break;case"m4":i.uniforms[t].value=(new tr).fromArray(r.value);break;default:i.uniforms[t].value=r.value}}if(void 0!==e.defines&&(i.defines=e.defines),void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(const t in e.extensions)i.extensions[t]=e.extensions[t];if(void 0!==e.shading&&(i.flatShading=1===e.shading),void 0!==e.size&&(i.size=e.size),void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(i.map=n(e.map)),void 0!==e.matcap&&(i.matcap=n(e.matcap)),void 0!==e.alphaMap&&(i.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(i.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale),void 0!==e.normalMap&&(i.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(i.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),i.normalScale=(new di).fromArray(t)}return void 0!==e.displacementMap&&(i.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(i.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(i.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(i.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(i.specularMap=n(e.specularMap)),void 0!==e.envMap&&(i.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(i.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(i.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(i.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(i.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(i.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(i.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(i.clearcoatNormalScale=(new di).fromArray(e.clearcoatNormalScale)),void 0!==e.transmissionMap&&(i.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(i.thicknessMap=n(e.thicknessMap)),i}setTextures(e){return this.textures=e,this}}class Qh{static decodeText(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(e){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}}class $h extends Eo{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}$h.prototype.isInstancedBufferGeometry=!0;class ed extends eo{constructor(e,t,n,i){"number"==typeof n&&(i=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,n),this.meshPerAttribute=i||1}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}ed.prototype.isInstancedBufferAttribute=!0;class td extends eh{constructor(e){super(e)}load(e,t,n,i){const r=this,o=new nh(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,(function(n){try{t(r.parse(JSON.parse(n)))}catch(t){i?i(t):console.error(t),r.manager.itemError(e)}}),n,i)}parse(e){const t={},n={};function i(e,i){if(void 0!==t[i])return t[i];const r=e.interleavedBuffers[i],o=function(e,t){if(void 0!==n[t])return n[t];const i=e.arrayBuffers[t],r=new Uint32Array(i).buffer;return n[t]=r,r}(e,r.buffer),a=fo(r.type,o),s=new xl(a,r.stride);return s.uuid=r.uuid,t[i]=s,s}const r=e.isInstancedBufferGeometry?new $h:new Eo,o=e.data.index;if(void 0!==o){const e=fo(o.type,o.array);r.setIndex(new eo(e,1))}const a=e.data.attributes;for(const t in a){const n=a[t];let o;if(n.isInterleavedBufferAttribute){const t=i(e.data,n.data);o=new wl(t,n.itemSize,n.offset,n.normalized)}else{const e=fo(n.type,n.array);o=new(n.isInstancedBufferAttribute?ed:eo)(e,n.itemSize,n.normalized)}void 0!==n.name&&(o.name=n.name),void 0!==n.usage&&o.setUsage(n.usage),void 0!==n.updateRange&&(o.updateRange.offset=n.updateRange.offset,o.updateRange.count=n.updateRange.count),r.setAttribute(t,o)}const s=e.data.morphAttributes;if(s)for(const t in s){const n=s[t],o=[];for(let t=0,r=n.length;t<r;t++){const r=n[t];let a;if(r.isInterleavedBufferAttribute){const t=i(e.data,r.data);a=new wl(t,r.itemSize,r.offset,r.normalized)}else{const e=fo(r.type,r.array);a=new eo(e,r.itemSize,r.normalized)}void 0!==r.name&&(a.name=r.name),o.push(a)}r.morphAttributes[t]=o}e.data.morphTargetsRelative&&(r.morphTargetsRelative=!0);const l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let e=0,t=l.length;e!==t;++e){const t=l[e];r.addGroup(t.start,t.count,t.materialIndex)}const c=e.data.boundingSphere;if(void 0!==c){const e=new Si;void 0!==c.center&&e.fromArray(c.center),r.boundingSphere=new qi(e,c.radius)}return e.name&&(r.name=e.name),e.userData&&(r.userData=e.userData),r}}class nd extends eh{constructor(e){super(e)}load(e,t,n,i){const r=this,o=""===this.path?Qh.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new nh(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){let o=null;try{o=JSON.parse(n)}catch(t){return void 0!==i&&i(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}const a=o.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?r.parse(o,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,i)}parse(e,t){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),o=this.parseImages(e.images,(function(){void 0!==t&&t(l)})),a=this.parseTextures(e.textures,o),s=this.parseMaterials(e.materials,a),l=this.parseObject(e.object,r,s,n),c=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,c),void 0!==t){let e=!1;for(const t in o)if(o[t]instanceof HTMLImageElement){e=!0;break}!1===e&&t(l)}return l}parseShapes(e){const t={};if(void 0!==e)for(let n=0,i=e.length;n<i;n++){const i=(new Lh).fromJSON(e[n]);t[i.uuid]=i}return t}parseSkeletons(e,t){const n={},i={};if(t.traverse((function(e){e.isBone&&(i[e.uuid]=e)})),void 0!==e)for(let t=0,r=e.length;t<r;t++){const r=(new $l).fromJSON(e[t],i);n[r.uuid]=r}return n}parseGeometries(e,t){const n={};let i;if(void 0!==e){const o=new td;for(let s=0,l=e.length;s<l;s++){let l;const c=e[s];switch(c.type){case"PlaneGeometry":case"PlaneBufferGeometry":l=new r[c.type](c.width,c.height,c.widthSegments,c.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":l=new r[c.type](c.width,c.height,c.depth,c.widthSegments,c.heightSegments,c.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":l=new r[c.type](c.radius,c.segments,c.thetaStart,c.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":l=new r[c.type](c.radiusTop,c.radiusBottom,c.height,c.radialSegments,c.heightSegments,c.openEnded,c.thetaStart,c.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":l=new r[c.type](c.radius,c.height,c.radialSegments,c.heightSegments,c.openEnded,c.thetaStart,c.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":l=new r[c.type](c.radius,c.widthSegments,c.heightSegments,c.phiStart,c.phiLength,c.thetaStart,c.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":l=new r[c.type](c.radius,c.detail);break;case"RingGeometry":case"RingBufferGeometry":l=new r[c.type](c.innerRadius,c.outerRadius,c.thetaSegments,c.phiSegments,c.thetaStart,c.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":l=new r[c.type](c.radius,c.tube,c.radialSegments,c.tubularSegments,c.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":l=new r[c.type](c.radius,c.tube,c.tubularSegments,c.radialSegments,c.p,c.q);break;case"TubeGeometry":case"TubeBufferGeometry":l=new r[c.type]((new a[c.path.type]).fromJSON(c.path),c.tubularSegments,c.radius,c.radialSegments,c.closed);break;case"LatheGeometry":case"LatheBufferGeometry":l=new r[c.type](c.points,c.segments,c.phiStart,c.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":l=new r[c.type](c.vertices,c.indices,c.radius,c.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":i=[];for(let e=0,n=c.shapes.length;e<n;e++){const n=t[c.shapes[e]];i.push(n)}l=new r[c.type](i,c.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":i=[];for(let e=0,n=c.shapes.length;e<n;e++){const n=t[c.shapes[e]];i.push(n)}const e=c.options.extrudePath;void 0!==e&&(c.options.extrudePath=(new a[e.type]).fromJSON(e)),l=new r[c.type](i,c.options);break;case"BufferGeometry":case"InstancedBufferGeometry":l=o.parse(c);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+c.type+'"');continue}l.uuid=c.uuid,void 0!==c.name&&(l.name=c.name),!0===l.isBufferGeometry&&void 0!==c.userData&&(l.userData=c.userData),n[c.uuid]=l}}return n}parseMaterials(e,t){const n={},i={};if(void 0!==e){const r=new Jh;r.setTextures(t);for(let t=0,o=e.length;t<o;t++){const o=e[t];if("MultiMaterial"===o.type){const e=[];for(let t=0;t<o.materials.length;t++){const i=o.materials[t];void 0===n[i.uuid]&&(n[i.uuid]=r.parse(i)),e.push(n[i.uuid])}i[o.uuid]=e}else void 0===n[o.uuid]&&(n[o.uuid]=r.parse(o)),i[o.uuid]=n[o.uuid]}}return i}parseAnimations(e){const t={};if(void 0!==e)for(let n=0;n<e.length;n++){const i=e[n],r=Ku.parse(i);t[r.uuid]=r}return t}parseImages(e,t){const n=this,i={};let r;function o(e){if("string"==typeof e){const t=e;return function(e){return n.manager.itemStart(e),r.load(e,(function(){n.manager.itemEnd(e)}),void 0,(function(){n.manager.itemError(e),n.manager.itemEnd(e)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:n.resourcePath+t)}return e.data?{data:fo(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){const n=new Qu(t);r=new oh(n),r.setCrossOrigin(this.crossOrigin);for(let t=0,n=e.length;t<n;t++){const n=e[t],r=n.url;if(Array.isArray(r)){i[n.uuid]=[];for(let e=0,t=r.length;e<t;e++){const t=o(r[e]);null!==t&&(t instanceof HTMLImageElement?i[n.uuid].push(t):i[n.uuid].push(new Zl(t.data,t.width,t.height)))}}else{const e=o(n.url);null!==e&&(i[n.uuid]=e)}}}return i}parseTextures(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}const i={};if(void 0!==e)for(let r=0,o=e.length;r<o;r++){const o=e[r];let a;void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===t[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);const s=t[o.image];Array.isArray(s)?(a=new Jo(s),6===s.length&&(a.needsUpdate=!0)):(a=s&&s.data?new Zl(s.data,s.width,s.height):new vi(s),s&&(a.needsUpdate=!0)),a.uuid=o.uuid,void 0!==o.name&&(a.name=o.name),void 0!==o.mapping&&(a.mapping=n(o.mapping,id)),void 0!==o.offset&&a.offset.fromArray(o.offset),void 0!==o.repeat&&a.repeat.fromArray(o.repeat),void 0!==o.center&&a.center.fromArray(o.center),void 0!==o.rotation&&(a.rotation=o.rotation),void 0!==o.wrap&&(a.wrapS=n(o.wrap[0],rd),a.wrapT=n(o.wrap[1],rd)),void 0!==o.format&&(a.format=o.format),void 0!==o.type&&(a.type=o.type),void 0!==o.encoding&&(a.encoding=o.encoding),void 0!==o.minFilter&&(a.minFilter=n(o.minFilter,od)),void 0!==o.magFilter&&(a.magFilter=n(o.magFilter,od)),void 0!==o.anisotropy&&(a.anisotropy=o.anisotropy),void 0!==o.flipY&&(a.flipY=o.flipY),void 0!==o.premultiplyAlpha&&(a.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(a.unpackAlignment=o.unpackAlignment),i[o.uuid]=a}return i}parseObject(e,t,n,i){let r,o,a;function s(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function l(e){if(void 0!==e){if(Array.isArray(e)){const t=[];for(let i=0,r=e.length;i<r;i++){const r=e[i];void 0===n[r]&&console.warn("THREE.ObjectLoader: Undefined material",r),t.push(n[r])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}switch(e.type){case"Scene":r=new _l,void 0!==e.background&&Number.isInteger(e.background)&&(r.background=new Zr(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?r.fog=new bl(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(r.fog=new yl(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":r=new Yo(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(r.focus=e.focus),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.filmGauge&&(r.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(r.filmOffset=e.filmOffset),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"OrthographicCamera":r=new Wh(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"AmbientLight":r=new Xh(e.color,e.intensity);break;case"DirectionalLight":r=new qh(e.color,e.intensity);break;case"PointLight":r=new Hh(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":r=new Yh(e.color,e.intensity,e.width,e.height);break;case"SpotLight":r=new Uh(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":r=new Dh(e.color,e.groundColor,e.intensity);break;case"LightProbe":r=(new Zh).fromJSON(e);break;case"SkinnedMesh":o=s(e.geometry),a=l(e.material),r=new Yl(o,a),void 0!==e.bindMode&&(r.bindMode=e.bindMode),void 0!==e.bindMatrix&&r.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(r.skeleton=e.skeleton);break;case"Mesh":o=s(e.geometry),a=l(e.material),r=new Vo(o,a);break;case"InstancedMesh":o=s(e.geometry),a=l(e.material);const t=e.count,n=e.instanceMatrix,i=e.instanceColor;r=new rc(o,a,t),r.instanceMatrix=new eo(new Float32Array(n.array),16),void 0!==i&&(r.instanceColor=new eo(new Float32Array(i.array),i.itemSize));break;case"LOD":r=new zl;break;case"Line":r=new hc(s(e.geometry),l(e.material));break;case"LineLoop":r=new mc(s(e.geometry),l(e.material));break;case"LineSegments":r=new fc(s(e.geometry),l(e.material));break;case"PointCloud":case"Points":r=new xc(s(e.geometry),l(e.material));break;case"Sprite":r=new Ul(l(e.material));break;case"Group":r=new hl;break;case"Bone":r=new Kl;break;default:r=new Mr}if(r.uuid=e.uuid,void 0!==e.name&&(r.name=e.name),void 0!==e.matrix?(r.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(r.matrixAutoUpdate=e.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==e.position&&r.position.fromArray(e.position),void 0!==e.rotation&&r.rotation.fromArray(e.rotation),void 0!==e.quaternion&&r.quaternion.fromArray(e.quaternion),void 0!==e.scale&&r.scale.fromArray(e.scale)),void 0!==e.castShadow&&(r.castShadow=e.castShadow),void 0!==e.receiveShadow&&(r.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(r.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(r.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(r.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&r.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(r.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.frustumCulled&&(r.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(r.renderOrder=e.renderOrder),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.layers&&(r.layers.mask=e.layers),void 0!==e.children){const o=e.children;for(let e=0;e<o.length;e++)r.add(this.parseObject(o[e],t,n,i))}if(void 0!==e.animations){const t=e.animations;for(let e=0;e<t.length;e++){const n=t[e];r.animations.push(i[n])}}if("LOD"===e.type){void 0!==e.autoUpdate&&(r.autoUpdate=e.autoUpdate);const t=e.levels;for(let e=0;e<t.length;e++){const n=t[e],i=r.getObjectByProperty("uuid",n.object);void 0!==i&&r.addLevel(i,n.distance)}}return r}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse((function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){const n=t[e.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}}))}setTexturePath(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}const id={UVMapping:ce,CubeReflectionMapping:ue,CubeRefractionMapping:he,EquirectangularReflectionMapping:de,EquirectangularRefractionMapping:pe,CubeUVReflectionMapping:fe,CubeUVRefractionMapping:me},rd={RepeatWrapping:ge,ClampToEdgeWrapping:ve,MirroredRepeatWrapping:ye},od={NearestFilter:be,NearestMipmapNearestFilter:_e,NearestMipmapLinearFilter:Ee,LinearFilter:Se,LinearMipmapNearestFilter:Ae,LinearMipmapLinearFilter:Te};class ad extends eh{constructor(e){super(e),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=Ju.get(e);if(void 0!==o)return r.manager.itemStart(e),setTimeout((function(){t&&t(o),r.manager.itemEnd(e)}),0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(r.options,{colorSpaceConversion:"none"}))})).then((function(n){Ju.add(e,n),t&&t(n),r.manager.itemEnd(e)})).catch((function(t){i&&i(t),r.manager.itemError(e),r.manager.itemEnd(e)})),r.manager.itemStart(e)}}ad.prototype.isImageBitmapLoader=!0;class sd{constructor(){this.type="ShapePath",this.color=new Zr,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Ph,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,r,o){return this.currentPath.bezierCurveTo(e,t,n,i,r,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,t){function n(e){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n],r=new Lh;r.curves=i.curves,t.push(r)}return t}function i(e,t){const n=t.length;let i=!1;for(let r=n-1,o=0;o<n;r=o++){let n=t[r],a=t[o],s=a.x-n.x,l=a.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=t[o],s=-s,a=t[r],l=-l),e.y<n.y||e.y>a.y)continue;if(e.y===n.y){if(e.x===n.x)return!0}else{const t=l*(e.x-n.x)-s*(e.y-n.y);if(0===t)return!0;if(t<0)continue;i=!i}}else{if(e.y!==n.y)continue;if(a.x<=e.x&&e.x<=n.x||n.x<=e.x&&e.x<=a.x)return!0}}return i}const r=lu.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===t)return n(o);let a,s,l;const c=[];if(1===o.length)return s=o[0],l=new Lh,l.curves=s.curves,c.push(l),c;let u=!r(o[0].getPoints());u=e?!u:u;const h=[],d=[];let p,f,m=[],g=0;d[g]=void 0,m[g]=[];for(let t=0,n=o.length;t<n;t++)s=o[t],p=s.getPoints(),a=r(p),a=e?!a:a,a?(!u&&d[g]&&g++,d[g]={s:new Lh,p},d[g].s.curves=s.curves,u&&g++,m[g]=[]):m[g].push({h:s,p:p[0]});if(!d[0])return n(o);if(d.length>1){let e=!1;const t=[];for(let e=0,t=d.length;e<t;e++)h[e]=[];for(let n=0,r=d.length;n<r;n++){const r=m[n];for(let o=0;o<r.length;o++){const a=r[o];let s=!0;for(let r=0;r<d.length;r++)i(a.p,d[r].p)&&(n!==r&&t.push({froms:n,tos:r,hole:o}),s?(s=!1,h[r].push(a)):e=!0);s&&h[n].push(a)}}t.length>0&&(e||(m=h))}for(let e=0,t=d.length;e<t;e++){l=d[e].s,c.push(l),f=m[e];for(let e=0,t=f.length;e<t;e++)l.holes.push(f[e].h)}return c}}class ld{constructor(e){this.type="Font",this.data=e}generateShapes(e,t=100){const n=[],i=function(e,t,n){const i=Array.from(e),r=t/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*r,a=[];let s=0,l=0;for(let e=0;e<i.length;e++){const t=i[e];if("\n"===t)s=0,l-=o;else{const e=cd(t,r,s,l,n);s+=e.offsetX,a.push(e.path)}}return a}(e,t,this.data);for(let e=0,t=i.length;e<t;e++)Array.prototype.push.apply(n,i[e].toShapes());return n}}function cd(e,t,n,i,r){const o=r.glyphs[e]||r.glyphs["?"];if(!o)return void console.error('THREE.Font: character "'+e+'" does not exists in font family '+r.familyName+".");const a=new sd;let s,l,c,u,h,d,p,f;if(o.o){const e=o._cachedOutline||(o._cachedOutline=o.o.split(" "));for(let r=0,o=e.length;r<o;){switch(e[r++]){case"m":s=e[r++]*t+n,l=e[r++]*t+i,a.moveTo(s,l);break;case"l":s=e[r++]*t+n,l=e[r++]*t+i,a.lineTo(s,l);break;case"q":c=e[r++]*t+n,u=e[r++]*t+i,h=e[r++]*t+n,d=e[r++]*t+i,a.quadraticCurveTo(h,d,c,u);break;case"b":c=e[r++]*t+n,u=e[r++]*t+i,h=e[r++]*t+n,d=e[r++]*t+i,p=e[r++]*t+n,f=e[r++]*t+i,a.bezierCurveTo(h,d,p,f,c,u)}}}return{offsetX:o.ha*t,path:a}}ld.prototype.isFont=!0;class ud extends eh{constructor(e){super(e)}load(e,t,n,i){const r=this,o=new nh(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,(function(e){let n;try{n=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(e.substring(65,e.length-2))}const i=r.parse(n);t&&t(i)}),n,i)}parse(e){return new ld(e)}}let hd;const dd={getContext:function(){return void 0===hd&&(hd=new(window.AudioContext||window.webkitAudioContext)),hd},setContext:function(e){hd=e}};class pd extends eh{constructor(e){super(e)}load(e,t,n,i){const r=this,o=new nh(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){try{const e=n.slice(0);dd.getContext().decodeAudioData(e,(function(e){t(e)}))}catch(t){i?i(t):console.error(t),r.manager.itemError(e)}}),n,i)}}class fd extends Zh{constructor(e,t,n=1){super(void 0,n);const i=(new Zr).set(e),r=(new Zr).set(t),o=new Si(i.r,i.g,i.b),a=new Si(r.r,r.g,r.b),s=Math.sqrt(Math.PI),l=s*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(s),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(l)}}fd.prototype.isHemisphereLightProbe=!0;class md extends Zh{constructor(e,t=1){super(void 0,t);const n=(new Zr).set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}md.prototype.isAmbientLightProbe=!0;const gd=new tr,vd=new tr;class yd{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Yo,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Yo,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;const n=e.projectionMatrix.clone(),i=t.eyeSep/2,r=i*t.near/t.focus,o=t.near*Math.tan(Wn*t.fov*.5)/t.zoom;let a,s;vd.elements[12]=-i,gd.elements[12]=i,a=-o*t.aspect+r,s=o*t.aspect+r,n.elements[0]=2*t.near/(s-a),n.elements[8]=(s+a)/(s-a),this.cameraL.projectionMatrix.copy(n),a=-o*t.aspect-r,s=o*t.aspect-r,n.elements[0]=2*t.near/(s-a),n.elements[8]=(s+a)/(s-a),this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(vd),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(gd)}}class bd{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=_d(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=_d();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function _d(){return("undefined"==typeof performance?Date:performance).now()}const xd=new Si,Ed=new wi,wd=new Si,Sd=new Si;class Ad extends Mr{constructor(){super(),this.type="AudioListener",this.context=dd.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new bd}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(xd,Ed,wd),Sd.set(0,0,-1).applyQuaternion(Ed),t.positionX){const e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(xd.x,e),t.positionY.linearRampToValueAtTime(xd.y,e),t.positionZ.linearRampToValueAtTime(xd.z,e),t.forwardX.linearRampToValueAtTime(Sd.x,e),t.forwardY.linearRampToValueAtTime(Sd.y,e),t.forwardZ.linearRampToValueAtTime(Sd.z,e),t.upX.linearRampToValueAtTime(n.x,e),t.upY.linearRampToValueAtTime(n.y,e),t.upZ.linearRampToValueAtTime(n.z,e)}else t.setPosition(xd.x,xd.y,xd.z),t.setOrientation(Sd.x,Sd.y,Sd.z,n.x,n.y,n.z)}}class Md extends Mr{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Td=new Si,Cd=new wi,Pd=new Si,Ld=new Si;class Rd extends Md{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(Td,Cd,Pd),Ld.set(0,0,1).applyQuaternion(Cd);const t=this.panner;if(t.positionX){const e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Td.x,e),t.positionY.linearRampToValueAtTime(Td.y,e),t.positionZ.linearRampToValueAtTime(Td.z,e),t.orientationX.linearRampToValueAtTime(Ld.x,e),t.orientationY.linearRampToValueAtTime(Ld.y,e),t.orientationZ.linearRampToValueAtTime(Ld.z,e)}else t.setPosition(Td.x,Td.y,Td.z),t.setOrientation(Ld.x,Ld.y,Ld.z)}}class Dd{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class Id{constructor(e,t,n){let i,r,o;switch(this.binding=e,this.valueSize=n,t){case"quaternion":i=this._slerp,r=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":i=this._select,r=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:i=this._lerp,r=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,i=this.valueSize,r=e*i+i;let o=this.cumulativeWeight;if(0===o){for(let e=0;e!==i;++e)n[r+e]=n[e];o=t}else{o+=t;const e=t/o;this._mixBufferRegion(n,r,0,e,i)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,i=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,i=e*t+t,r=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const e=t*this._origIndex;this._mixBufferRegion(n,i,e,1-r,t)}o>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let e=t,r=t+t;e!==r;++e)if(n[e]!==n[e+t]){a.setValue(n,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let e=n,r=i;e!==r;++e)t[e]=t[i+e%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,r){if(i>=.5)for(let i=0;i!==r;++i)e[t+i]=e[n+i]}_slerp(e,t,n,i){wi.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,r){const o=this._workIndex*r;wi.multiplyQuaternionsFlat(e,o,e,t,e,n),wi.slerpFlat(e,t,e,t,e,o,i)}_lerp(e,t,n,i,r){const o=1-i;for(let a=0;a!==r;++a){const r=t+a;e[r]=e[r]*o+e[n+a]*i}}_lerpAdditive(e,t,n,i,r){for(let o=0;o!==r;++o){const r=t+o;e[r]=e[r]+e[n+o]*i}}}const Od="\\[\\]\\.:\\/",Nd=new RegExp("[\\[\\]\\.:\\/]","g"),kd="[^\\[\\]\\.:\\/]",Fd="[^"+Od.replace("\\.","")+"]",Ud=/((?:WC+[\/:])*)/.source.replace("WC",kd),Bd=/(WCOD+)?/.source.replace("WCOD",Fd),Vd=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",kd),Gd=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",kd),zd=new RegExp("^"+Ud+Bd+Vd+Gd+"$"),Hd=["material","materials","bones"];class Wd{constructor(e,t,n){this.path=t,this.parsedPath=n||Wd.parseTrackName(t),this.node=Wd.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Wd.Composite(e,t,n):new Wd(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Nd,"")}static parseTrackName(e){const t=zd.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const e=n.nodeName.substring(i+1);-1!==Hd.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let i=0;i<e.length;i++){const r=e[i];if(r.name===t||r.uuid===t)return r;const o=n(r.children);if(o)return o}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.node[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let r=t.propertyIndex;if(e||(e=Wd.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let i=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===i){i=t;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==i){if(void 0===e[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[i]}}const o=e[i];if(void 0===o){const n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+i+" but it wasn't found.",e)}let a=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?a=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(a=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[r]&&(r=e.morphTargetDictionary[r])}s=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=r}else void 0!==o.fromArray&&void 0!==o.toArray?(s=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(s=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Wd.Composite=class{constructor(e,t,n){const i=n||Wd.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},Wd.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Wd.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Wd.prototype.GetterByBindingType=[Wd.prototype._getValue_direct,Wd.prototype._getValue_array,Wd.prototype._getValue_arrayElement,Wd.prototype._getValue_toArray],Wd.prototype.SetterByBindingTypeAndVersioning=[[Wd.prototype._setValue_direct,Wd.prototype._setValue_direct_setNeedsUpdate,Wd.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Wd.prototype._setValue_array,Wd.prototype._setValue_array_setNeedsUpdate,Wd.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Wd.prototype._setValue_arrayElement,Wd.prototype._setValue_arrayElement_setNeedsUpdate,Wd.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Wd.prototype._setValue_fromArray,Wd.prototype._setValue_fromArray_setNeedsUpdate,Wd.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class jd{constructor(){this.uuid=qn(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,i=this._parsedPaths,r=this._bindings,o=r.length;let a,s=e.length,l=this.nCachedObjects_;for(let c=0,u=arguments.length;c!==u;++c){const u=arguments[c],h=u.uuid;let d=t[h];if(void 0===d){d=s++,t[h]=d,e.push(u);for(let e=0,t=o;e!==t;++e)r[e].push(new Wd(u,n[e],i[e]))}else if(d<l){a=e[d];const s=--l,c=e[s];t[c.uuid]=d,e[d]=c,t[h]=s,e[s]=u;for(let e=0,t=o;e!==t;++e){const t=r[e],o=t[s];let a=t[d];t[d]=o,void 0===a&&(a=new Wd(u,n[e],i[e])),t[s]=a}}else e[d]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const a=arguments[o],s=a.uuid,l=t[s];if(void 0!==l&&l>=r){const o=r++,c=e[o];t[c.uuid]=l,e[l]=c,t[s]=o,e[o]=a;for(let e=0,t=i;e!==t;++e){const t=n[e],i=t[o],r=t[l];t[l]=i,t[o]=r}}}this.nCachedObjects_=r}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_,o=e.length;for(let a=0,s=arguments.length;a!==s;++a){const s=arguments[a].uuid,l=t[s];if(void 0!==l)if(delete t[s],l<r){const a=--r,s=e[a],c=--o,u=e[c];t[s.uuid]=l,e[l]=s,t[u.uuid]=a,e[a]=u,e.pop();for(let e=0,t=i;e!==t;++e){const t=n[e],i=t[a],r=t[c];t[l]=i,t[a]=r,t.pop()}}else{const r=--o,a=e[r];r>0&&(t[a.uuid]=l),e[l]=a,e.pop();for(let e=0,t=i;e!==t;++e){const t=n[e];t[l]=t[r],t.pop()}}}this.nCachedObjects_=r}subscribe_(e,t){const n=this._bindingsIndicesByPath;let i=n[e];const r=this._bindings;if(void 0!==i)return r[i];const o=this._paths,a=this._parsedPaths,s=this._objects,l=s.length,c=this.nCachedObjects_,u=new Array(l);i=r.length,n[e]=i,o.push(e),a.push(t),r.push(u);for(let n=c,i=s.length;n!==i;++n){const i=s[n];u[n]=new Wd(i,e,t)}return u}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){const i=this._paths,r=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];t[e[a]]=n,o[n]=s,o.pop(),r[n]=r[a],r.pop(),i[n]=i[a],i.pop()}}}jd.prototype.isAnimationObjectGroup=!0;class qd{constructor(e,t,n=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;const r=t.tracks,o=r.length,a=new Array(o),s={endingStart:Xt,endingEnd:Xt};for(let e=0;e!==o;++e){const t=r[e].createInterpolant(null);a[e]=t,t.settings=s}this._interpolantSettings=s,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=zt,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const n=this._clip.duration,i=e._clip.duration,r=i/n,o=n/i;e.warp(1,r,t),this.warp(o,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const i=this._mixer,r=i.time,o=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);const s=a.parameterPositions,l=a.sampleValues;return s[0]=r,s[1]=r+n,l[0]=e/o,l[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled)return void this._updateWeight(e);const r=this._startTime;if(null!==r){const i=(e-r)*n;if(i<0||0===n)return;this._startTime=null,t=n*i}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const e=this._interpolants,t=this._propertyBindings;if(this.blendMode===Jt)for(let n=0,i=e.length;n!==i;++n)e[n].evaluate(o),t[n].accumulateAdditive(a);else for(let n=0,r=e.length;n!==r;++n)e[n].evaluate(o),t[n].accumulate(i,a)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let i=this.time+e,r=this._loopCount;const o=n===Ht;if(0===e)return-1===r?i:o&&1==(1&r)?t-i:i;if(n===Gt){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else{if(!(i<0)){this.time=i;break e}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===r&&(e>=0?(r=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),i>=t||i<0){const n=Math.floor(i/t);i-=t*n,r+=Math.abs(n);const a=this.repetitions-r;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===a){const t=e<0;this._setEndings(t,!t,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=i;if(o&&1==(1&r))return t-i}return i}_setEndings(e,t,n){const i=this._interpolantSettings;n?(i.endingStart=Yt,i.endingEnd=Yt):(i.endingStart=e?this.zeroSlopeAtStart?Yt:Xt:Kt,i.endingEnd=t?this.zeroSlopeAtEnd?Yt:Xt:Kt)}_scheduleFading(e,t,n){const i=this._mixer,r=i.time;let o=this._weightInterpolant;null===o&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,s=o.sampleValues;return a[0]=r,s[0]=t,a[1]=r+e,s[1]=n,this}}class Xd extends Gn{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,i=e._clip.tracks,r=i.length,o=e._propertyBindings,a=e._interpolants,s=n.uuid,l=this._bindingsByRootAndName;let c=l[s];void 0===c&&(c={},l[s]=c);for(let e=0;e!==r;++e){const r=i[e],l=r.name;let u=c[l];if(void 0!==u)o[e]=u;else{if(u=o[e],void 0!==u){null===u._cacheIndex&&(++u.referenceCount,this._addInactiveBinding(u,s,l));continue}const i=t&&t._propertyBindings[e].binding.parsedPath;u=new Id(Wd.create(n,l,i),r.ValueTypeName,r.getValueSize()),++u.referenceCount,this._addInactiveBinding(u,s,l),o[e]=u}a[e].resultBuffer=u.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const t=(e._localRoot||this._root).uuid,n=e._clip.uuid,i=this._actionsByClip[n];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,n,t)}const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0==n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){const i=this._actions,r=this._actionsByClip;let o=r[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=o;else{const t=o.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=i.length,i.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;const r=e._clip.uuid,o=this._actionsByClip,a=o[r],s=a.knownActions,l=s[s.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,s[c]=l,s.pop(),e._byClipCacheIndex=null;delete a.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete o[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0==--n.referenceCount&&this._removeInactiveBinding(n)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_addInactiveBinding(e,t,n){const i=this._bindingsByRootAndName,r=this._bindings;let o=i[t];void 0===o&&(o={},i[t]=o),o[n]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,i=n.rootNode.uuid,r=n.path,o=this._bindingsByRootAndName,a=o[i],s=t[t.length-1],l=e._cacheIndex;s._cacheIndex=l,t[l]=s,t.pop(),delete a[r],0===Object.keys(a).length&&delete o[i]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new Bu(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,r=t[i];e.__cacheIndex=i,t[i]=e,r.__cacheIndex=n,t[n]=r}clipAction(e,t,n){const i=t||this._root,r=i.uuid;let o="string"==typeof e?Ku.findByName(i,e):e;const a=null!==o?o.uuid:e,s=this._actionsByClip[a];let l=null;if(void 0===n&&(n=null!==o?o.blendMode:Zt),void 0!==s){const e=s.actionByRoot[r];if(void 0!==e&&e.blendMode===n)return e;l=s.knownActions[0],null===o&&(o=l._clip)}if(null===o)return null;const c=new qd(this,o,t,n);return this._bindAction(c,l),this._addInactiveAction(c,a,r),c}existingAction(e,t){const n=t||this._root,i=n.uuid,r="string"==typeof e?Ku.findByName(n,e):e,o=r?r.uuid:e,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[i]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,i=this.time+=e,r=Math.sign(e),o=this._accuIndex^=1;for(let a=0;a!==n;++a){t[a]._update(i,e,r,o)}const a=this._bindings,s=this._nActiveBindings;for(let e=0;e!==s;++e)a[e].apply(o);return this}setTime(e){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){const e=r.knownActions;for(let n=0,i=e.length;n!==i;++n){const i=e[n];this._deactivateAction(i);const r=i._cacheIndex,o=t[t.length-1];i._cacheIndex=null,i._byClipCacheIndex=null,o._cacheIndex=r,t[r]=o,t.pop(),this._removeInactiveBindingsForAction(i)}delete i[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const e in n){const i=n[e].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}const i=this._bindingsByRootAndName[t];if(void 0!==i)for(const e in i){const t=i[e];t.restoreOriginalState(),this._removeInactiveBinding(t)}}uncacheAction(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}Xd.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class Yd{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new Yd(void 0===this.value.clone?this.value:this.value.clone())}}class Kd extends xl{constructor(e,t,n=1){super(e,t),this.meshPerAttribute=n||1}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}Kd.prototype.isInstancedInterleavedBuffer=!0;class Zd{constructor(e,t,n,i,r){this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=i,this.count=r,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}Zd.prototype.isGLBufferAttribute=!0;class Jd{constructor(e,t,n=0,i=1/0){this.ray=new er(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new dr,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!1,n=[]){return $d(e,this,n,t),n.sort(Qd),n}intersectObjects(e,t=!1,n=[]){for(let i=0,r=e.length;i<r;i++)$d(e[i],this,n,t);return n.sort(Qd),n}}function Qd(e,t){return e.distance-t.distance}function $d(e,t,n,i){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===i){const i=e.children;for(let e=0,r=i.length;e<r;e++)$d(i[e],t,n,!0)}}class ep{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Xn(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class tp{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return(new this.constructor).copy(this)}}const np=new di;class ip{constructor(e=new di(1/0,1/0),t=new di(-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=np.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new di),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new di),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new di),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new di),t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return np.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}ip.prototype.isBox2=!0;const rp=new Si,op=new Si;class ap{constructor(e=new Si,t=new Si){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new Si),e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new Si),e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new Si),this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){rp.subVectors(e,this.start),op.subVectors(this.end,this.start);const n=op.dot(op);let i=op.dot(rp)/n;return t&&(i=Xn(i,0,1)),i}closestPointToPoint(e,t,n){const i=this.closestPointToPointParameter(e,t);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new Si),this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}class sp extends Mr{constructor(e){super(),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}}sp.prototype.isImmediateRenderObject=!0;const lp=new Si;class cp extends Mr{constructor(e,t){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;const n=new Eo,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let e=0,t=1,n=32;e<n;e++,t++){const r=e/n*Math.PI*2,o=t/n*Math.PI*2;i.push(Math.cos(r),Math.sin(r),1,Math.cos(o),Math.sin(o),1)}n.setAttribute("position",new co(i,3));const r=new oc({fog:!1,toneMapped:!1});this.cone=new fc(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),lp.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(lp),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const up=new Si,hp=new tr,dp=new tr;class pp extends fc{constructor(e){const t=fp(e),n=new Eo,i=[],r=[],o=new Zr(0,0,1),a=new Zr(0,1,0);for(let e=0;e<t.length;e++){const n=t[e];n.parent&&n.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(o.r,o.g,o.b),r.push(a.r,a.g,a.b))}n.setAttribute("position",new co(i,3)),n.setAttribute("color",new co(r,3));super(n,new oc({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,i=n.getAttribute("position");dp.copy(this.root.matrixWorld).invert();for(let e=0,n=0;e<t.length;e++){const r=t[e];r.parent&&r.parent.isBone&&(hp.multiplyMatrices(dp,r.matrixWorld),up.setFromMatrixPosition(hp),i.setXYZ(n,up.x,up.y,up.z),hp.multiplyMatrices(dp,r.parent.matrixWorld),up.setFromMatrixPosition(hp),i.setXYZ(n+1,up.x,up.y,up.z),n+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}function fp(e){const t=[];e&&e.isBone&&t.push(e);for(let n=0;n<e.children.length;n++)t.push.apply(t,fp(e.children[n]));return t}class mp extends Vo{constructor(e,t,n){super(new bu(t,4,2),new Jr({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.light.updateMatrixWorld(),this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const gp=new Si,vp=new Zr,yp=new Zr;class bp extends Mr{constructor(e,t,n){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;const i=new mu(t);i.rotateY(.5*Math.PI),this.material=new Jr({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const r=i.getAttribute("position"),o=new Float32Array(3*r.count);i.setAttribute("color",new eo(o,3)),this.add(new Vo(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");vp.copy(this.light.color),yp.copy(this.light.groundColor);for(let e=0,n=t.count;e<n;e++){const i=e<n/2?vp:yp;t.setXYZ(e,i.r,i.g,i.b)}t.needsUpdate=!0}e.lookAt(gp.setFromMatrixPosition(this.light.matrixWorld).negate())}}class _p extends fc{constructor(e=10,t=10,n=4473924,i=8947848){n=new Zr(n),i=new Zr(i);const r=t/2,o=e/t,a=e/2,s=[],l=[];for(let e=0,c=0,u=-a;e<=t;e++,u+=o){s.push(-a,0,u,a,0,u),s.push(u,0,-a,u,0,a);const t=e===r?n:i;t.toArray(l,c),c+=3,t.toArray(l,c),c+=3,t.toArray(l,c),c+=3,t.toArray(l,c),c+=3}const c=new Eo;c.setAttribute("position",new co(s,3)),c.setAttribute("color",new co(l,3));super(c,new oc({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class xp extends fc{constructor(e=10,t=16,n=8,i=64,r=4473924,o=8947848){r=new Zr(r),o=new Zr(o);const a=[],s=[];for(let n=0;n<=t;n++){const i=n/t*(2*Math.PI),l=Math.sin(i)*e,c=Math.cos(i)*e;a.push(0,0,0),a.push(l,0,c);const u=1&n?r:o;s.push(u.r,u.g,u.b),s.push(u.r,u.g,u.b)}for(let t=0;t<=n;t++){const l=1&t?r:o,c=e-e/n*t;for(let e=0;e<i;e++){let t=e/i*(2*Math.PI),n=Math.sin(t)*c,r=Math.cos(t)*c;a.push(n,0,r),s.push(l.r,l.g,l.b),t=(e+1)/i*(2*Math.PI),n=Math.sin(t)*c,r=Math.cos(t)*c,a.push(n,0,r),s.push(l.r,l.g,l.b)}}const l=new Eo;l.setAttribute("position",new co(a,3)),l.setAttribute("color",new co(s,3));super(l,new oc({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}const Ep=new Si,wp=new Si,Sp=new Si;class Ap extends Mr{constructor(e,t,n){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1);let i=new Eo;i.setAttribute("position",new co([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const r=new oc({fog:!1,toneMapped:!1});this.lightPlane=new hc(i,r),this.add(this.lightPlane),i=new Eo,i.setAttribute("position",new co([0,0,0,0,0,1],3)),this.targetLine=new hc(i,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){Ep.setFromMatrixPosition(this.light.matrixWorld),wp.setFromMatrixPosition(this.light.target.matrixWorld),Sp.subVectors(wp,Ep),this.lightPlane.lookAt(wp),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(wp),this.targetLine.scale.z=Sp.length()}}const Mp=new Si,Tp=new Xo;class Cp extends fc{constructor(e){const t=new Eo,n=new oc({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],o={},a=new Zr(16755200),s=new Zr(16711680),l=new Zr(43775),c=new Zr(16777215),u=new Zr(3355443);function h(e,t,n){d(e,n),d(t,n)}function d(e,t){i.push(0,0,0),r.push(t.r,t.g,t.b),void 0===o[e]&&(o[e]=[]),o[e].push(i.length/3-1)}h("n1","n2",a),h("n2","n4",a),h("n4","n3",a),h("n3","n1",a),h("f1","f2",a),h("f2","f4",a),h("f4","f3",a),h("f3","f1",a),h("n1","f1",a),h("n2","f2",a),h("n3","f3",a),h("n4","f4",a),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",l),h("u2","u3",l),h("u3","u1",l),h("c","t",c),h("p","c",u),h("cn1","cn2",u),h("cn3","cn4",u),h("cf1","cf2",u),h("cf3","cf4",u),t.setAttribute("position",new co(i,3)),t.setAttribute("color",new co(r,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}update(){const e=this.geometry,t=this.pointMap;Tp.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Pp("c",t,e,Tp,0,0,-1),Pp("t",t,e,Tp,0,0,1),Pp("n1",t,e,Tp,-1,-1,-1),Pp("n2",t,e,Tp,1,-1,-1),Pp("n3",t,e,Tp,-1,1,-1),Pp("n4",t,e,Tp,1,1,-1),Pp("f1",t,e,Tp,-1,-1,1),Pp("f2",t,e,Tp,1,-1,1),Pp("f3",t,e,Tp,-1,1,1),Pp("f4",t,e,Tp,1,1,1),Pp("u1",t,e,Tp,.7,1.1,-1),Pp("u2",t,e,Tp,-.7,1.1,-1),Pp("u3",t,e,Tp,0,2,-1),Pp("cf1",t,e,Tp,-1,0,1),Pp("cf2",t,e,Tp,1,0,1),Pp("cf3",t,e,Tp,0,-1,1),Pp("cf4",t,e,Tp,0,1,1),Pp("cn1",t,e,Tp,-1,0,-1),Pp("cn2",t,e,Tp,1,0,-1),Pp("cn3",t,e,Tp,0,-1,-1),Pp("cn4",t,e,Tp,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Pp(e,t,n,i,r,o,a){Mp.set(r,o,a).unproject(i);const s=t[e];if(void 0!==s){const e=n.getAttribute("position");for(let t=0,n=s.length;t<n;t++)e.setXYZ(s[t],Mp.x,Mp.y,Mp.z)}}const Lp=new Ti;class Rp extends fc{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),r=new Eo;r.setIndex(new eo(n,1)),r.setAttribute("position",new eo(i,3)),super(r,new oc({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Lp.setFromObject(this.object),Lp.isEmpty())return;const t=Lp.min,n=Lp.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=t.x,r[4]=n.y,r[5]=n.z,r[6]=t.x,r[7]=t.y,r[8]=n.z,r[9]=n.x,r[10]=t.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=t.z,r[15]=t.x,r[16]=n.y,r[17]=t.z,r[18]=t.x,r[19]=t.y,r[20]=t.z,r[21]=n.x,r[22]=t.y,r[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e){return fc.prototype.copy.call(this,e),this.object=e.object,this}}class Dp extends fc{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Eo;i.setIndex(new eo(n,1)),i.setAttribute("position",new co([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(i,new oc({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}}class Ip extends hc{constructor(e,t=1,n=16776960){const i=n,r=new Eo;r.setAttribute("position",new co([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),r.computeBoundingSphere(),super(r,new oc({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const o=new Eo;o.setAttribute("position",new co([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new Vo(o,new Jr({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){let t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?_:b,this.lookAt(this.plane.normal),super.updateMatrixWorld(e)}}const Op=new Si;let Np,kp;class Fp extends Mr{constructor(e=new Si(0,0,1),t=new Si(0,0,0),n=1,i=16776960,r=.2*n,o=.2*r){super(),this.type="ArrowHelper",void 0===Np&&(Np=new Eo,Np.setAttribute("position",new co([0,0,0,0,1,0],3)),kp=new Cc(0,.5,1,5,1),kp.translate(0,-.5,0)),this.position.copy(t),this.line=new hc(Np,new oc({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Vo(kp,new Jr({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Op.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Op,t)}}setLength(e,t=.2*e,n=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}class Up extends fc{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new Eo;n.setAttribute("position",new co(t,3)),n.setAttribute("color",new co([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(n,new oc({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const Bp=new Float32Array(1),Vp=new Int32Array(Bp.buffer);class Gp{static toHalfFloat(e){Bp[0]=e;const t=Vp[0];let n=t>>16&32768,i=t>>12&2047;const r=t>>23&255;return r<103?n:r>142?(n|=31744,n|=(255==r?0:1)&&8388607&t,n):r<113?(i|=2048,n|=(i>>114-r)+(i>>113-r&1),n):(n|=r-112<<10|i>>1,n+=1&i,n)}}const zp=Math.pow(2,8),Hp=[.125,.215,.35,.446,.526,.582],Wp=5+Hp.length,jp=20,qp={[tn]:0,[nn]:1,[on]:2,[sn]:3,[ln]:4,[cn]:5,[rn]:6},Xp=new Jr({side:_,depthWrite:!1,depthTest:!1}),Yp=new Vo(new zo,Xp),Kp=new Wh,{_lodPlanes:Zp,_sizeLods:Jp,_sigmas:Qp}=lf(),$p=new Zr;let ef=null;const tf=(1+Math.sqrt(5))/2,nf=1/tf,rf=[new Si(1,1,1),new Si(-1,1,1),new Si(1,1,-1),new Si(-1,1,-1),new Si(0,tf,nf),new Si(0,tf,-nf),new Si(nf,0,tf),new Si(-nf,0,tf),new Si(tf,nf,0),new Si(-tf,nf,0)];function of(e){const t=Math.max(e.r,e.g,e.b),n=Math.min(Math.max(Math.ceil(Math.log2(t)),-128),127);e.multiplyScalar(Math.pow(2,-n));return(n+128)/255}class af{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=function(e){const t=new Float32Array(e),n=new Si(0,1,0);return new Tu({name:"SphericalGaussianBlur",defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:t},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n},inputEncoding:{value:qp[tn]},outputEncoding:{value:qp[tn]}},vertexShader:pf(),fragmentShader:`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t${ff()}\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t`,blending:S,depthTest:!1,depthWrite:!1})}(jp),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,i=100){ef=this._renderer.getRenderTarget();const r=this._allocateTargets();return this._sceneToCubeUV(e,n,i,r),t>0&&this._blur(r,0,0,t),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(e){return this._fromTexture(e)}fromCubemap(e){return this._fromTexture(e)}compileCubemapShader(){null===this._cubemapShader&&(this._cubemapShader=df(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){null===this._equirectShader&&(this._equirectShader=hf(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let e=0;e<Zp.length;e++)Zp[e].dispose()}_cleanup(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(ef),e.scissorTest=!1,uf(e,0,0,e.width,e.height)}_fromTexture(e){ef=this._renderer.getRenderTarget();const t=this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t}_allocateTargets(e){const t={magFilter:be,minFilter:be,generateMipmaps:!1,type:Pe,format:qe,encoding:sf(e)?e.encoding:on,depthBuffer:!1},n=cf(t);return n.depthBuffer=!e,this._pingPongRenderTarget=cf(t),n}_compileMaterial(e){const t=new Vo(Zp[0],e);this._renderer.compile(t,Kp)}_sceneToCubeUV(e,t,n,i){const r=new Yo(90,1,t,n),o=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],s=this._renderer,l=s.autoClear,c=s.outputEncoding,u=s.toneMapping;s.getClearColor($p),s.toneMapping=ie,s.outputEncoding=tn,s.autoClear=!1;let h=!1;const d=e.background;if(d){if(d.isColor){Xp.color.copy(d).convertSRGBToLinear(),e.background=null;const t=of(Xp.color);Xp.opacity=t,h=!0}}else{Xp.color.copy($p).convertSRGBToLinear();const e=of(Xp.color);Xp.opacity=e,h=!0}for(let t=0;t<6;t++){const n=t%3;0==n?(r.up.set(0,o[t],0),r.lookAt(a[t],0,0)):1==n?(r.up.set(0,0,o[t]),r.lookAt(0,a[t],0)):(r.up.set(0,o[t],0),r.lookAt(0,0,a[t])),uf(i,n*zp,t>2?zp:0,zp,zp),s.setRenderTarget(i),h&&s.render(Yp,r),s.render(e,r)}s.toneMapping=u,s.outputEncoding=c,s.autoClear=l}_textureToCubeUV(e,t){const n=this._renderer;e.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=df()):null==this._equirectShader&&(this._equirectShader=hf());const i=e.isCubeTexture?this._cubemapShader:this._equirectShader,r=new Vo(Zp[0],i),o=i.uniforms;o.envMap.value=e,e.isCubeTexture||o.texelSize.value.set(1/e.image.width,1/e.image.height),o.inputEncoding.value=qp[e.encoding],o.outputEncoding.value=qp[t.texture.encoding],uf(t,0,0,3*zp,2*zp),n.setRenderTarget(t),n.render(r,Kp)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let t=1;t<Wp;t++){const n=Math.sqrt(Qp[t]*Qp[t]-Qp[t-1]*Qp[t-1]),i=rf[(t-1)%rf.length];this._blur(e,t-1,t,n,i)}t.autoClear=n}_blur(e,t,n,i,r){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,i,"latitudinal",r),this._halfBlur(o,e,n,n,i,"longitudinal",r)}_halfBlur(e,t,n,i,r,o,a){const s=this._renderer,l=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new Vo(Zp[i],l),u=l.uniforms,h=Jp[n]-1,d=isFinite(r)?Math.PI/(2*h):2*Math.PI/39,p=r/d,f=isFinite(r)?1+Math.floor(3*p):jp;f>jp&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${f} samples when the maximum is set to 20`);const m=[];let g=0;for(let e=0;e<jp;++e){const t=e/p,n=Math.exp(-t*t/2);m.push(n),0==e?g+=n:e<f&&(g+=2*n)}for(let e=0;e<m.length;e++)m[e]=m[e]/g;u.envMap.value=e.texture,u.samples.value=f,u.weights.value=m,u.latitudinal.value="latitudinal"===o,a&&(u.poleAxis.value=a),u.dTheta.value=d,u.mipInt.value=8-n,u.inputEncoding.value=qp[e.texture.encoding],u.outputEncoding.value=qp[e.texture.encoding];const v=Jp[i];uf(t,3*Math.max(0,zp-2*v),(0===i?0:2*zp)+2*v*(i>4?i-8+4:0),3*v,2*v),s.setRenderTarget(t),s.render(c,Kp)}}function sf(e){return void 0!==e&&e.type===Pe&&(e.encoding===tn||e.encoding===nn||e.encoding===rn)}function lf(){const e=[],t=[],n=[];let i=8;for(let r=0;r<Wp;r++){const o=Math.pow(2,i);t.push(o);let a=1/o;r>4?a=Hp[r-8+4-1]:0==r&&(a=0),n.push(a);const s=1/(o-1),l=-s/2,c=1+s/2,u=[l,l,c,l,c,c,l,l,c,c,l,c],h=6,d=6,p=3,f=2,m=1,g=new Float32Array(p*d*h),v=new Float32Array(f*d*h),y=new Float32Array(m*d*h);for(let e=0;e<h;e++){const t=e%3*2/3-1,n=e>2?0:-1,i=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];g.set(i,p*d*e),v.set(u,f*d*e);const r=[e,e,e,e,e,e];y.set(r,m*d*e)}const b=new Eo;b.setAttribute("position",new eo(g,p)),b.setAttribute("uv",new eo(v,f)),b.setAttribute("faceIndex",new eo(y,m)),e.push(b),i>4&&i--}return{_lodPlanes:e,_sizeLods:t,_sigmas:n}}function cf(e){const t=new _i(3*zp,3*zp,e);return t.texture.mapping=fe,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function uf(e,t,n,i,r){e.viewport.set(t,n,i,r),e.scissor.set(t,n,i,r)}function hf(){const e=new di(1,1);return new Tu({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:e},inputEncoding:{value:qp[tn]},outputEncoding:{value:qp[tn]}},vertexShader:pf(),fragmentShader:`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t${ff()}\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t`,blending:S,depthTest:!1,depthWrite:!1})}function df(){return new Tu({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:qp[tn]},outputEncoding:{value:qp[tn]}},vertexShader:pf(),fragmentShader:`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t${ff()}\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t`,blending:S,depthTest:!1,depthWrite:!1})}function pf(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function ff(){return"\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t"}const mf=0,gf=1,vf=0,yf=1,bf=2;function _f(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e}function xf(e=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e}function Ef(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new xc(e,t)}function wf(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Ul(e)}function Sf(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new xc(e,t)}function Af(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new gc(e)}function Mf(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new gc(e)}function Tf(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new gc(e)}function Cf(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Si(e,t,n)}function Pf(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new eo(e,t).setUsage(Rn)}function Lf(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new to(e,t)}function Rf(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new no(e,t)}function Df(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new io(e,t)}function If(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new ro(e,t)}function Of(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new oo(e,t)}function Nf(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new ao(e,t)}function kf(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new so(e,t)}function Ff(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new co(e,t)}function Uf(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new uo(e,t)}function Bf(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Up(e)}function Vf(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Rp(e,t)}function Gf(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new fc(new kc(e.geometry),new oc({color:void 0!==t?t:16777215}))}function zf(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new fc(new Au(e.geometry),new oc({color:void 0!==t?t:16777215}))}function Hf(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new nh(e)}function Wf(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new sh(e)}function jf(e,t,n){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Qo(e,n)}function qf(){console.error("THREE.CanvasRenderer has been removed")}function Xf(){console.error("THREE.JSONLoader has been removed.")}ch.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(ch.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Ph.prototype.fromPoints=function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)},_p.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},pp.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},eh.prototype.extractUrlBase=function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Qh.extractUrlBase(e)},eh.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},ip.prototype.center=function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},ip.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},ip.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},ip.prototype.size=function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)},Ti.prototype.center=function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Ti.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Ti.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},Ti.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},Ti.prototype.size=function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)},qi.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},ta.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},ap.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},pi.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},pi.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},pi.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},pi.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},pi.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},pi.prototype.getInverse=function(e){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},tr.prototype.extractPosition=function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},tr.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},tr.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Si).setFromMatrixColumn(this,3)},tr.prototype.setRotationFromQuaternion=function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},tr.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},tr.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},tr.prototype.multiplyVector4=function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},tr.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},tr.prototype.rotateAxis=function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},tr.prototype.crossVector=function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},tr.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},tr.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},tr.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},tr.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},tr.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},tr.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},tr.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},tr.prototype.makeFrustum=function(e,t,n,i,r,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,i,n,r,o)},tr.prototype.getInverse=function(e){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},Lr.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},wi.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},wi.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},er.prototype.isIntersectionBox=function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},er.prototype.isIntersectionPlane=function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},er.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},Gr.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Gr.prototype.barycoordFromPoint=function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},Gr.prototype.midpoint=function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},Gr.prototypenormal=function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},Gr.prototype.plane=function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)},Gr.barycoordFromPoint=function(e,t,n,i,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Gr.getBarycoord(e,t,n,i,r)},Gr.normal=function(e,t,n,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Gr.getNormal(e,t,n,i)},Lh.prototype.extractAllPoints=function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},Lh.prototype.extrude=function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new hu(this,e)},Lh.prototype.makeGeometry=function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new yu(this,e)},di.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},di.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},di.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Si.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},Si.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},Si.prototype.getPositionFromMatrix=function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},Si.prototype.getScaleFromMatrix=function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},Si.prototype.getColumnFromMatrix=function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},Si.prototype.applyProjection=function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},Si.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},Si.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},Si.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},bi.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},bi.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Mr.prototype.getChildByName=function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},Mr.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Mr.prototype.translate=function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},Mr.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Mr.prototype.applyMatrix=function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(Mr.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Vo.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Vo.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Qt},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Yl.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Yo.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Rh.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(eo.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Rn},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Rn)}}}),eo.prototype.setDynamic=function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?Rn:Ln),this},eo.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},eo.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Eo.prototype.addIndex=function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},Eo.prototype.addAttribute=function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new eo(arguments[1],arguments[2])))},Eo.prototype.addDrawCall=function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},Eo.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},Eo.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},Eo.prototype.removeAttribute=function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},Eo.prototype.applyMatrix=function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(Eo.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),xl.prototype.setDynamic=function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?Rn:Ln),this},xl.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},hu.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},hu.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},hu.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},_l.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Yd.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(Hr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Zr}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===E}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(qo.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),gl.prototype.clearTarget=function(e,t,n,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,i)},gl.prototype.animate=function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},gl.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},gl.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},gl.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},gl.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},gl.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},gl.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},gl.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},gl.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},gl.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},gl.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},gl.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},gl.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},gl.prototype.enableScissorTest=function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},gl.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},gl.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},gl.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},gl.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},gl.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},gl.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},gl.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},gl.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},gl.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},gl.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(gl.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?nn:tn}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(al.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(_i.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Md.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const t=this;return(new pd).load(e,(function(e){t.setBuffer(e)})),this},Dd.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Zo.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},Zo.prototype.clear=function(e,t,n,i){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(e,t,n,i)},mi.crossOrigin=void 0,mi.loadTexture=function(e,t,n,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const r=new lh;r.setCrossOrigin(this.crossOrigin);const o=r.load(e,n,void 0,i);return t&&(o.mapping=t),o},mi.loadTextureCube=function(e,t,n,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const r=new ah;r.setCrossOrigin(this.crossOrigin);const o=r.load(e,n,void 0,i);return t&&(o.mapping=t),o},mi.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},mi.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const Yf={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function Kf(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:l}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=l);const Zf=new tr,Jf=new Mr,Qf=new Si;class $f extends Gn{constructor(){super(),this.uuid=qn(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(e){const t=(new pi).getNormalMatrix(e);for(let t=0,n=this.vertices.length;t<n;t++){this.vertices[t].applyMatrix4(e)}for(let e=0,n=this.faces.length;e<n;e++){const n=this.faces[e];n.normal.applyMatrix3(t).normalize();for(let e=0,i=n.vertexNormals.length;e<i;e++)n.vertexNormals[e].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(e){return Zf.makeRotationX(e),this.applyMatrix4(Zf),this}rotateY(e){return Zf.makeRotationY(e),this.applyMatrix4(Zf),this}rotateZ(e){return Zf.makeRotationZ(e),this.applyMatrix4(Zf),this}translate(e,t,n){return Zf.makeTranslation(e,t,n),this.applyMatrix4(Zf),this}scale(e,t,n){return Zf.makeScale(e,t,n),this.applyMatrix4(Zf),this}lookAt(e){return Jf.lookAt(e),Jf.updateMatrix(),this.applyMatrix4(Jf.matrix),this}fromBufferGeometry(e){const t=this,n=null!==e.index?e.index:void 0,i=e.attributes;if(void 0===i.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;const r=i.position,o=i.normal,a=i.color,s=i.uv,l=i.uv2;void 0!==l&&(this.faceVertexUvs[1]=[]);for(let e=0;e<r.count;e++)t.vertices.push((new Si).fromBufferAttribute(r,e)),void 0!==a&&t.colors.push((new Zr).fromBufferAttribute(a,e));function c(e,n,i,r){const c=void 0===a?[]:[t.colors[e].clone(),t.colors[n].clone(),t.colors[i].clone()],u=void 0===o?[]:[(new Si).fromBufferAttribute(o,e),(new Si).fromBufferAttribute(o,n),(new Si).fromBufferAttribute(o,i)],h=new tm(e,n,i,u,c,r);t.faces.push(h),void 0!==s&&t.faceVertexUvs[0].push([(new di).fromBufferAttribute(s,e),(new di).fromBufferAttribute(s,n),(new di).fromBufferAttribute(s,i)]),void 0!==l&&t.faceVertexUvs[1].push([(new di).fromBufferAttribute(l,e),(new di).fromBufferAttribute(l,n),(new di).fromBufferAttribute(l,i)])}const u=e.groups;if(u.length>0)for(let e=0;e<u.length;e++){const t=u[e],i=t.start;for(let e=i,r=i+t.count;e<r;e+=3)void 0!==n?c(n.getX(e),n.getX(e+1),n.getX(e+2),t.materialIndex):c(e,e+1,e+2,t.materialIndex)}else if(void 0!==n)for(let e=0;e<n.count;e+=3)c(n.getX(e),n.getX(e+1),n.getX(e+2));else for(let e=0;e<r.count;e+=3)c(e,e+1,e+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Qf).negate(),this.translate(Qf.x,Qf.y,Qf.z),this}normalize(){this.computeBoundingSphere();const e=this.boundingSphere.center,t=this.boundingSphere.radius,n=0===t?1:1/t,i=new tr;return i.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix4(i),this}computeFaceNormals(){const e=new Si,t=new Si;for(let n=0,i=this.faces.length;n<i;n++){const i=this.faces[n],r=this.vertices[i.a],o=this.vertices[i.b],a=this.vertices[i.c];e.subVectors(a,o),t.subVectors(r,o),e.cross(t),e.normalize(),i.normal.copy(e)}}computeVertexNormals(e=!0){const t=new Array(this.vertices.length);for(let e=0,n=this.vertices.length;e<n;e++)t[e]=new Si;if(e){const e=new Si,n=new Si;for(let i=0,r=this.faces.length;i<r;i++){const r=this.faces[i],o=this.vertices[r.a],a=this.vertices[r.b],s=this.vertices[r.c];e.subVectors(s,a),n.subVectors(o,a),e.cross(n),t[r.a].add(e),t[r.b].add(e),t[r.c].add(e)}}else{this.computeFaceNormals();for(let e=0,n=this.faces.length;e<n;e++){const n=this.faces[e];t[n.a].add(n.normal),t[n.b].add(n.normal),t[n.c].add(n.normal)}}for(let e=0,n=this.vertices.length;e<n;e++)t[e].normalize();for(let e=0,n=this.faces.length;e<n;e++){const n=this.faces[e],i=n.vertexNormals;3===i.length?(i[0].copy(t[n.a]),i[1].copy(t[n.b]),i[2].copy(t[n.c])):(i[0]=t[n.a].clone(),i[1]=t[n.b].clone(),i[2]=t[n.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let e=0,t=this.faces.length;e<t;e++){const t=this.faces[e],n=t.vertexNormals;3===n.length?(n[0].copy(t.normal),n[1].copy(t.normal),n[2].copy(t.normal)):(n[0]=t.normal.clone(),n[1]=t.normal.clone(),n[2]=t.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let e=0,t=this.faces.length;e<t;e++){const t=this.faces[e];t.__originalFaceNormal?t.__originalFaceNormal.copy(t.normal):t.__originalFaceNormal=t.normal.clone(),t.__originalVertexNormals||(t.__originalVertexNormals=[]);for(let e=0,n=t.vertexNormals.length;e<n;e++)t.__originalVertexNormals[e]?t.__originalVertexNormals[e].copy(t.vertexNormals[e]):t.__originalVertexNormals[e]=t.vertexNormals[e].clone()}const e=new $f;e.faces=this.faces;for(let t=0,n=this.morphTargets.length;t<n;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];const e=this.morphNormals[t].faceNormals,n=this.morphNormals[t].vertexNormals;for(let t=0,i=this.faces.length;t<i;t++){const t=new Si,i={a:new Si,b:new Si,c:new Si};e.push(t),n.push(i)}}const n=this.morphNormals[t];e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals();for(let e=0,t=this.faces.length;e<t;e++){const t=this.faces[e],i=n.faceNormals[e],r=n.vertexNormals[e];i.copy(t.normal),r.a.copy(t.vertexNormals[0]),r.b.copy(t.vertexNormals[1]),r.c.copy(t.vertexNormals[2])}}for(let e=0,t=this.faces.length;e<t;e++){const t=this.faces[e];t.normal=t.__originalFaceNormal,t.vertexNormals=t.__originalVertexNormals}}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Ti),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new qi),this.boundingSphere.setFromPoints(this.vertices)}merge(e,t,n=0){if(!e||!e.isGeometry)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);let i;const r=this.vertices.length,o=this.vertices,a=e.vertices,s=this.faces,l=e.faces,c=this.colors,u=e.colors;void 0!==t&&(i=(new pi).getNormalMatrix(t));for(let e=0,n=a.length;e<n;e++){const n=a[e].clone();void 0!==t&&n.applyMatrix4(t),o.push(n)}for(let e=0,t=u.length;e<t;e++)c.push(u[e].clone());for(let e=0,t=l.length;e<t;e++){const t=l[e];let o,a;const c=t.vertexNormals,u=t.vertexColors,h=new tm(t.a+r,t.b+r,t.c+r);h.normal.copy(t.normal),void 0!==i&&h.normal.applyMatrix3(i).normalize();for(let e=0,t=c.length;e<t;e++)o=c[e].clone(),void 0!==i&&o.applyMatrix3(i).normalize(),h.vertexNormals.push(o);h.color.copy(t.color);for(let e=0,t=u.length;e<t;e++)a=u[e],h.vertexColors.push(a.clone());h.materialIndex=t.materialIndex+n,s.push(h)}for(let t=0,n=e.faceVertexUvs.length;t<n;t++){const n=e.faceVertexUvs[t];void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]);for(let e=0,i=n.length;e<i;e++){const i=n[e],r=[];for(let e=0,t=i.length;e<t;e++)r.push(i[e].clone());this.faceVertexUvs[t].push(r)}}}mergeMesh(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)}mergeVertices(e=4){const t={},n=[],i=[],r=Math.pow(10,e);for(let e=0,o=this.vertices.length;e<o;e++){const o=this.vertices[e],a=Math.round(o.x*r)+"_"+Math.round(o.y*r)+"_"+Math.round(o.z*r);void 0===t[a]?(t[a]=e,n.push(this.vertices[e]),i[e]=n.length-1):i[e]=i[t[a]]}const o=[];for(let e=0,t=this.faces.length;e<t;e++){const t=this.faces[e];t.a=i[t.a],t.b=i[t.b],t.c=i[t.c];const n=[t.a,t.b,t.c];for(let t=0;t<3;t++)if(n[t]===n[(t+1)%3]){o.push(e);break}}for(let e=o.length-1;e>=0;e--){const t=o[e];this.faces.splice(t,1);for(let e=0,n=this.faceVertexUvs.length;e<n;e++)this.faceVertexUvs[e].splice(t,1)}const a=this.vertices.length-n.length;return this.vertices=n,a}setFromPoints(e){this.vertices=[];for(let t=0,n=e.length;t<n;t++){const n=e[t];this.vertices.push(new Si(n.x,n.y,n.z||0))}return this}sortFacesByMaterialIndex(){const e=this.faces,t=e.length;for(let n=0;n<t;n++)e[n]._id=n;e.sort((function(e,t){return e.materialIndex-t.materialIndex}));const n=this.faceVertexUvs[0],i=this.faceVertexUvs[1];let r,o;n&&n.length===t&&(r=[]),i&&i.length===t&&(o=[]);for(let a=0;a<t;a++){const t=e[a]._id;r&&r.push(n[t]),o&&o.push(i[t])}r&&(this.faceVertexUvs[0]=r),o&&(this.faceVertexUvs[1]=o)}toJSON(){const e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}const t=[];for(let e=0;e<this.vertices.length;e++){const n=this.vertices[e];t.push(n.x,n.y,n.z)}const n=[],i=[],r={},o=[],a={},s=[],l={};for(let e=0;e<this.faces.length;e++){const t=this.faces[e],i=!0,r=!1,o=void 0!==this.faceVertexUvs[0][e],a=t.normal.length()>0,s=t.vertexNormals.length>0,l=1!==t.color.r||1!==t.color.g||1!==t.color.b,p=t.vertexColors.length>0;let f=0;if(f=c(f,0,0),f=c(f,1,i),f=c(f,2,r),f=c(f,3,o),f=c(f,4,a),f=c(f,5,s),f=c(f,6,l),f=c(f,7,p),n.push(f),n.push(t.a,t.b,t.c),n.push(t.materialIndex),o){const t=this.faceVertexUvs[0][e];n.push(d(t[0]),d(t[1]),d(t[2]))}if(a&&n.push(u(t.normal)),s){const e=t.vertexNormals;n.push(u(e[0]),u(e[1]),u(e[2]))}if(l&&n.push(h(t.color)),p){const e=t.vertexColors;n.push(h(e[0]),h(e[1]),h(e[2]))}}function c(e,t,n){return n?e|1<<t:e&~(1<<t)}function u(e){const t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==r[t]||(r[t]=i.length/3,i.push(e.x,e.y,e.z)),r[t]}function h(e){const t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==a[t]||(a[t]=o.length,o.push(e.getHex())),a[t]}function d(e){const t=e.x.toString()+e.y.toString();return void 0!==l[t]||(l[t]=s.length/2,s.push(e.x,e.y)),l[t]}return e.data={},e.data.vertices=t,e.data.normals=i,o.length>0&&(e.data.colors=o),s.length>0&&(e.data.uvs=[s]),e.data.faces=n,e}clone(){return(new $f).copy(this)}copy(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;const t=e.vertices;for(let e=0,n=t.length;e<n;e++)this.vertices.push(t[e].clone());const n=e.colors;for(let e=0,t=n.length;e<t;e++)this.colors.push(n[e].clone());const i=e.faces;for(let e=0,t=i.length;e<t;e++)this.faces.push(i[e].clone());for(let t=0,n=e.faceVertexUvs.length;t<n;t++){const n=e.faceVertexUvs[t];void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]);for(let e=0,i=n.length;e<i;e++){const i=n[e],r=[];for(let e=0,t=i.length;e<t;e++){const t=i[e];r.push(t.clone())}this.faceVertexUvs[t].push(r)}}const r=e.morphTargets;for(let e=0,t=r.length;e<t;e++){const t={};if(t.name=r[e].name,void 0!==r[e].vertices){t.vertices=[];for(let n=0,i=r[e].vertices.length;n<i;n++)t.vertices.push(r[e].vertices[n].clone())}if(void 0!==r[e].normals){t.normals=[];for(let n=0,i=r[e].normals.length;n<i;n++)t.normals.push(r[e].normals[n].clone())}this.morphTargets.push(t)}const o=e.morphNormals;for(let e=0,t=o.length;e<t;e++){const t={};if(void 0!==o[e].vertexNormals){t.vertexNormals=[];for(let n=0,i=o[e].vertexNormals.length;n<i;n++){const i=o[e].vertexNormals[n],r={};r.a=i.a.clone(),r.b=i.b.clone(),r.c=i.c.clone(),t.vertexNormals.push(r)}}if(void 0!==o[e].faceNormals){t.faceNormals=[];for(let n=0,i=o[e].faceNormals.length;n<i;n++)t.faceNormals.push(o[e].faceNormals[n].clone())}this.morphNormals.push(t)}const a=e.skinWeights;for(let e=0,t=a.length;e<t;e++)this.skinWeights.push(a[e].clone());const s=e.skinIndices;for(let e=0,t=s.length;e<t;e++)this.skinIndices.push(s[e].clone());const l=e.lineDistances;for(let e=0,t=l.length;e<t;e++)this.lineDistances.push(l[e]);const c=e.boundingBox;null!==c&&(this.boundingBox=c.clone());const u=e.boundingSphere;return null!==u&&(this.boundingSphere=u.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}toBufferGeometry(){const e=(new em).fromGeometry(this),t=new Eo,n=new Float32Array(3*e.vertices.length);if(t.setAttribute("position",new eo(n,3).copyVector3sArray(e.vertices)),e.normals.length>0){const n=new Float32Array(3*e.normals.length);t.setAttribute("normal",new eo(n,3).copyVector3sArray(e.normals))}if(e.colors.length>0){const n=new Float32Array(3*e.colors.length);t.setAttribute("color",new eo(n,3).copyColorsArray(e.colors))}if(e.uvs.length>0){const n=new Float32Array(2*e.uvs.length);t.setAttribute("uv",new eo(n,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){const n=new Float32Array(2*e.uvs2.length);t.setAttribute("uv2",new eo(n,2).copyVector2sArray(e.uvs2))}t.groups=e.groups;for(const n in e.morphTargets){const i=[],r=e.morphTargets[n];for(let e=0,t=r.length;e<t;e++){const t=r[e],n=new co(3*t.data.length,3);n.name=t.name,i.push(n.copyVector3sArray(t.data))}t.morphAttributes[n]=i}if(e.skinIndices.length>0){const n=new co(4*e.skinIndices.length,4);t.setAttribute("skinIndex",n.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){const n=new co(4*e.skinWeights.length,4);t.setAttribute("skinWeight",n.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(t.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(t.boundingBox=e.boundingBox.clone()),t}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(e){let t=new Eo;const n=e.geometry;if(e.isPoints||e.isLine){const e=new co(3*n.vertices.length,3),i=new co(3*n.colors.length,3);if(t.setAttribute("position",e.copyVector3sArray(n.vertices)),t.setAttribute("color",i.copyColorsArray(n.colors)),n.lineDistances&&n.lineDistances.length===n.vertices.length){const e=new co(n.lineDistances.length,1);t.setAttribute("lineDistance",e.copyArray(n.lineDistances))}null!==n.boundingSphere&&(t.boundingSphere=n.boundingSphere.clone()),null!==n.boundingBox&&(t.boundingBox=n.boundingBox.clone())}else e.isMesh&&(t=n.toBufferGeometry());return t}}$f.prototype.isGeometry=!0;class em{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(e){const t=[];let n,i,r;const o=e.faces;for(i=0;i<o.length;i++){const e=o[i];e.materialIndex!==r&&(r=e.materialIndex,void 0!==n&&(n.count=3*i-n.start,t.push(n)),n={start:3*i,materialIndex:r})}void 0!==n&&(n.count=3*i-n.start,t.push(n)),this.groups=t}fromGeometry(e){const t=e.faces,n=e.vertices,i=e.faceVertexUvs,r=i[0]&&i[0].length>0,o=i[1]&&i[1].length>0,a=e.morphTargets,s=a.length;let l;if(s>0){l=[];for(let e=0;e<s;e++)l[e]={name:a[e].name,data:[]};this.morphTargets.position=l}const c=e.morphNormals,u=c.length;let h;if(u>0){h=[];for(let e=0;e<u;e++)h[e]={name:c[e].name,data:[]};this.morphTargets.normal=h}const d=e.skinIndices,p=e.skinWeights,f=d.length===n.length,m=p.length===n.length;n.length>0&&0===t.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let e=0;e<t.length;e++){const g=t[e];this.vertices.push(n[g.a],n[g.b],n[g.c]);const v=g.vertexNormals;if(3===v.length)this.normals.push(v[0],v[1],v[2]);else{const e=g.normal;this.normals.push(e,e,e)}const y=g.vertexColors;if(3===y.length)this.colors.push(y[0],y[1],y[2]);else{const e=g.color;this.colors.push(e,e,e)}if(!0===r){const t=i[0][e];void 0!==t?this.uvs.push(t[0],t[1],t[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",e),this.uvs.push(new di,new di,new di))}if(!0===o){const t=i[1][e];void 0!==t?this.uvs2.push(t[0],t[1],t[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",e),this.uvs2.push(new di,new di,new di))}for(let e=0;e<s;e++){const t=a[e].vertices;l[e].data.push(t[g.a],t[g.b],t[g.c])}for(let t=0;t<u;t++){const n=c[t].vertexNormals[e];h[t].data.push(n.a,n.b,n.c)}f&&this.skinIndices.push(d[g.a],d[g.b],d[g.c]),m&&this.skinWeights.push(p[g.a],p[g.b],p[g.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this}}class tm{constructor(e,t,n,i,r,o=0){this.a=e,this.b=t,this.c=n,this.normal=i&&i.isVector3?i:new Si,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new Zr,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=o}clone(){return(new this.constructor).copy(this)}copy(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}}function nm(e){return nm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nm(e)}function im(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rm(e,t){return rm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},rm(e,t)}function om(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=lm(e);if(t){var r=lm(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return am(this,n)}}function am(e,t){return!t||"object"!==nm(t)&&"function"!=typeof t?sm(e):t}function sm(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lm(e){return lm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},lm(e)}s.MaterialIdCount=s.MaterialIdCount||0;var cm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rm(e,t)}(o,e);var t,n,i,r=om(o);function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this)).lmvInternal=!0,Object.defineProperty(sm(e),"id",{value:s.MaterialIdCount++}),e.uuid=qn(),e.name="",e.type="Material",e.side=b,e.opacity=1,e.transparent=!1,e.blending=A,e.blendSrc=B,e.blendDst=V,e.blendEquation=L,e.blendSrcAlpha=null,e.blendDstAlpha=null,e.blendEquationAlpha=null,e.depthTest=!0,e.depthWrite=!0,e.colorWrite=!0,e.polygonOffset=!1,e.polygonOffsetFactor=0,e.polygonOffsetUnits=0,e.alphaTest=0,e.overdraw=0,e.visible=!0,e._needsUpdate=!0,e}return t=o,(n=[{key:"onBuild",value:function(){}},{key:"onBeforeCompile",value:function(){}},{key:"customProgramCacheKey",value:function(){return this.onBeforeCompile.toString()}},{key:"setValues",value:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n){if(t in this){var i=this[t];i instanceof Zr?i.set(n):i instanceof Si&&n instanceof Si?i.copy(n):this[t]="overdraw"==t?Number(n):n}}else console.warn("Material: '"+t+"' parameter is undefined.")}}},{key:"toJSON",value:function(){var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type};return""!==this.name&&(e.name=this.name),this instanceof Jr?(e.color=this.color.getHex(),this.vertexColors!==vf&&(e.vertexColors=this.vertexColors),this.blending!==A&&(e.blending=this.blending),this.side!==b&&(e.side=this.side)):this instanceof Iu?(e.color=this.color.getHex(),e.emissive=this.emissive.getHex(),this.vertexColors!==vf&&(e.vertexColors=this.vertexColors),this.shading!==w&&(e.shading=this.shading),this.blending!==A&&(e.blending=this.blending),this.side!==b&&(e.side=this.side)):this instanceof Lu?(e.color=this.color.getHex(),e.emissive=this.emissive.getHex(),e.specular=this.specular.getHex(),e.shininess=this.shininess,this.vertexColors!==vf&&(e.vertexColors=this.vertexColors),this.shading!==w&&(e.shading=this.shading),this.blending!==A&&(e.blending=this.blending),this.side!==b&&(e.side=this.side)):this instanceof Du||this instanceof rl?(this.blending!==A&&(e.blending=this.blending),this.side!==b&&(e.side=this.side)):this instanceof Af||this instanceof gc?(e.size=this.size,e.sizeAttenuation=this.sizeAttenuation,e.color=this.color.getHex(),this.vertexColors!==vf&&(e.vertexColors=this.vertexColors),this.blending!==A&&(e.blending=this.blending)):this instanceof qo?(e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader):this instanceof Sl&&(e.color=this.color.getHex()),this.opacity<1&&(e.opacity=this.opacity),!1!==this.transparent&&(e.transparent=this.transparent),!1!==this.wireframe&&(e.wireframe=this.wireframe),e}},{key:"clone",value:function(e){return void 0===e&&(e=new o),e.name=this.name,e.side=this.side,e.opacity=this.opacity,e.transparent=this.transparent,e.blending=this.blending,e.blendSrc=this.blendSrc,e.blendDst=this.blendDst,e.blendEquation=this.blendEquation,e.blendSrcAlpha=this.blendSrcAlpha,e.blendDstAlpha=this.blendDstAlpha,e.blendEquationAlpha=this.blendEquationAlpha,e.depthTest=this.depthTest,e.depthWrite=this.depthWrite,e.polygonOffset=this.polygonOffset,e.polygonOffsetFactor=this.polygonOffsetFactor,e.polygonOffsetUnits=this.polygonOffsetUnits,e.alphaTest=this.alphaTest,e.overdraw=this.overdraw,e.visible=this.visible,e}},{key:"update",value:function(){this.dispatchEvent({type:"update"})}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"needsUpdate",get:function(){return this._needsUpdate},set:function(e){!0===e&&this.update(),this._needsUpdate=e}}])&&im(t.prototype,n),i&&im(t,i),o}(Gn);function um(e){return um="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},um(e)}function hm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function dm(e,t,n){return dm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=gm(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}},dm(e,t,n||e)}function pm(e,t){return pm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},pm(e,t)}function fm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=gm(e);if(t){var r=gm(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return mm(this,n)}}function mm(e,t){return!t||"object"!==um(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gm(e){return gm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},gm(e)}var vm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pm(e,t)}(o,e);var t,n,i,r=fm(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).type="MeshPhongMaterial",t.color=new Zr(16777215),t.emissive=new Zr(0),t.specular=new Zr(1118481),t.shininess=30,t.metal=!1,t.wrapAround=!1,t.wrapRGB=new Si(1,1,1),t.map=null,t.lightMap=null,t.bumpMap=null,t.bumpScale=1,t.normalMap=null,t.normalScale=new di(1,1),t.specularMap=null,t.alphaMap=null,t.envMap=null,t.combine=ee,t.reflectivity=1,t.refractionRatio=.98,t.fog=!0,t.shading=w,t.wireframe=!1,t.wireframeLinewidth=1,t.wireframeLinecap="round",t.wireframeLinejoin="round",t.vertexColors=vf,t.skinning=!1,t.morphTargets=!1,t.morphNormals=!1,t.setValues(e),t}return t=o,(n=[{key:"clone",value:function(){var e=new o;return dm(gm(o.prototype),"clone",this).call(this,e),e.color.copy(this.color),e.emissive.copy(this.emissive),e.specular.copy(this.specular),e.shininess=this.shininess,e.metal=this.metal,e.wrapAround=this.wrapAround,e.wrapRGB.copy(this.wrapRGB),e.map=this.map,e.lightMap=this.lightMap,e.bumpMap=this.bumpMap,e.bumpScale=this.bumpScale,e.normalMap=this.normalMap,e.normalScale.copy(this.normalScale),e.specularMap=this.specularMap,e.alphaMap=this.alphaMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e}}])&&hm(t.prototype,n),i&&hm(t,i),o}(cm);function ym(e){return ym="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ym(e)}function bm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _m(e,t,n){return _m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Sm(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}},_m(e,t,n||e)}function xm(e,t){return xm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},xm(e,t)}function Em(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Sm(e);if(t){var r=Sm(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return wm(this,n)}}function wm(e,t){return!t||"object"!==ym(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Sm(e){return Sm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Sm(e)}var Am=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xm(e,t)}(o,e);var t,n,i,r=Em(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).type="MeshBasicMaterial",t.color=new Zr(16777215),t.map=null,t.lightMap=null,t.specularMap=null,t.alphaMap=null,t.envMap=null,t.combine=ee,t.reflectivity=1,t.refractionRatio=.98,t.fog=!0,t.shading=w,t.wireframe=!1,t.wireframeLinewidth=1,t.wireframeLinecap="round",t.wireframeLinejoin="round",t.vertexColors=vf,t.skinning=!1,t.morphTargets=!1,t.setValues(e),t}return t=o,(n=[{key:"clone",value:function(){var e=new o;return _m(Sm(o.prototype),"clone",this).call(this,e),e.color.copy(this.color),e.map=this.map,e.lightMap=this.lightMap,e.specularMap=this.specularMap,e.alphaMap=this.alphaMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e}}])&&bm(t.prototype,n),i&&bm(t,i),o}(cm);function Mm(e){return Mm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mm(e)}function Tm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Cm(e,t,n){return Cm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Dm(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}},Cm(e,t,n||e)}function Pm(e,t){return Pm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Pm(e,t)}function Lm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Dm(e);if(t){var r=Dm(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Rm(this,n)}}function Rm(e,t){return!t||"object"!==Mm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Dm(e){return Dm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Dm(e)}var Im=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pm(e,t)}(o,e);var t,n,i,r=Lm(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).type="LineBasicMaterial",t.color=new Zr(16777215),t.linewidth=1,t.linecap="round",t.linejoin="round",t.vertexColors=vf,t.fog=!0,t.setValues(e),t}return t=o,(n=[{key:"clone",value:function(){var e=new o;return Cm(Dm(o.prototype),"clone",this).call(this,e),e.color.copy(this.color),e.linewidth=this.linewidth,e.linecap=this.linecap,e.linejoin=this.linejoin,e.vertexColors=this.vertexColors,e.fog=this.fog,e}}])&&Tm(t.prototype,n),i&&Tm(t,i),o}(cm);function Om(e){return Om="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Om(e)}function Nm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function km(e,t){return km=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},km(e,t)}function Fm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Bm(e);if(t){var r=Bm(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Um(this,n)}}function Um(e,t){return!t||"object"!==Om(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bm(e){return Bm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Bm(e)}var Vm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&km(e,t)}(o,e);var t,n,i,r=Fm(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this)).type="ShaderMaterial",t.defines={},t.uniforms={},t.attributes=null,t.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",t.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",t.shading=w,t.linewidth=1,t.wireframe=!1,t.wireframeLinewidth=1,t.fog=!1,t.lights=!1,t.vertexColors=vf,t.skinning=!1,t.morphTargets=!1,t.morphNormals=!1,t.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},t.index0AttributeName=void 0,t.setValues(e),t}return t=o,(n=[{key:"clone",value:function(){var e=new o;return cm.prototype.clone.call(this,e),e.fragmentShader=this.fragmentShader,e.vertexShader=this.vertexShader,e.uniforms=jo.clone(this.uniforms),e.attributes=this.attributes,e.defines=this.defines,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.fog=this.fog,e.lights=this.lights,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e}}])&&Nm(t.prototype,n),i&&Nm(t,i),o}(cm);function Gm(e){return Gm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gm(e)}function zm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Hm(e,t,n){return Hm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Xm(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}},Hm(e,t,n||e)}function Wm(e,t){return Wm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Wm(e,t)}function jm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Xm(e);if(t){var r=Xm(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return qm(this,n)}}function qm(e,t){return!t||"object"!==Gm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xm(e){return Xm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Xm(e)}Vm.prototype.isShaderMaterial=!0;var Ym=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wm(e,t)}(o,e);var t,n,i,r=jm(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e)).type="RawShaderMaterial",t}return t=o,(n=[{key:"clone",value:function(){var e=new o;return Hm(Xm(o.prototype),"clone",this).call(this,e),e}}])&&zm(t.prototype,n),i&&zm(t,i),o}(Vm),Km={common:{diffuse:{type:"c",value:new Zr(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new bi(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new di(1,1)}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new Zr(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},pointLightDecay:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]},spotLightDecay:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new Zr(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new bi(0,0,1,1)},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new Zr(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}},Zm={common:"#define PI 3.14159\n#define PI2 6.28318\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\nfloat square( in float a ) { return a*a; }\nvec2  square( in vec2 a )  { return vec2( a.x*a.x, a.y*a.y ); }\nvec3  square( in vec3 a )  { return vec3( a.x*a.x, a.y*a.y, a.z*a.z ); }\nvec4  square( in vec4 a )  { return vec4( a.x*a.x, a.y*a.y, a.z*a.z, a.w*a.w ); }\nfloat saturate( in float a ) { return clamp( a, 0.0, 1.0 ); }\nvec2  saturate( in vec2 a )  { return clamp( a, 0.0, 1.0 ); }\nvec3  saturate( in vec3 a )  { return clamp( a, 0.0, 1.0 ); }\nvec4  saturate( in vec4 a )  { return clamp( a, 0.0, 1.0 ); }\nfloat average( in float a ) { return a; }\nfloat average( in vec2 a )  { return ( a.x + a.y) * 0.5; }\nfloat average( in vec3 a )  { return ( a.x + a.y + a.z) / 3.0; }\nfloat average( in vec4 a )  { return ( a.x + a.y + a.z + a.w) * 0.25; }\nfloat whiteCompliment( in float a ) { return saturate( 1.0 - a ); }\nvec2  whiteCompliment( in vec2 a )  { return saturate( vec2(1.0) - a ); }\nvec3  whiteCompliment( in vec3 a )  { return saturate( vec3(1.0) - a ); }\nvec4  whiteCompliment( in vec4 a )  { return saturate( vec4(1.0) - a ); }\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\n}\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\n\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal) {\n\tfloat distance = dot( planeNormal, point-pointOnPlane );\n\treturn point - distance * planeNormal;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn pointOnLine + lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) );\n}\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\n\tif ( decayExponent > 0.0 ) {\n\t  return pow( saturate( 1.0 - lightDistance / cutoffDistance ), decayExponent );\n\t}\n\treturn 1.0;\n}\n\nvec3 inputToLinear( in vec3 a ) {\n#ifdef GAMMA_INPUT\n\treturn pow( a, vec3( float( GAMMA_FACTOR ) ) );\n#else\n\treturn a;\n#endif\n}\nvec3 linearToOutput( in vec3 a ) {\n#ifdef GAMMA_OUTPUT\n\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\n#else\n\treturn a;\n#endif\n}\n",alphatest_fragment:"#ifdef ALPHATEST\n\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n\n#endif\n",lights_lambert_vertex:"vLightFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\n\tvLightBack = vec3( 0.0 );\n\n#endif\n\ntransformedNormal = normalize( transformedNormal );\n\n#if MAX_DIR_LIGHTS > 0\n\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n\tvec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\n\n\tfloat dotProduct = dot( transformedNormal, dirVector );\n\tvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n\t\t#endif\n\n\t#endif\n\n\t#ifdef WRAP_AROUND\n\n\t\tvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n\t\tdirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tdirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n\n\t\t#endif\n\n\t#endif\n\n\tvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n\n\t#endif\n\n}\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n\t\tlVector = normalize( lVector );\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\n\n\t\tvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\tvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n\t\t\t#endif\n\n\t\t#endif\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n\t\t\tpointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tpointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n\n\t\t\t#endif\n\n\t\t#endif\n\n\t\tvLightFront += pointLightColor[ i ] * pointLightWeighting * attenuation;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += pointLightColor[ i ] * pointLightWeightingBack * attenuation;\n\n\t\t#endif\n\n\t}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\n\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\n\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n\t\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n\t\t\tlVector = normalize( lVector );\n\n\t\t\tfloat dotProduct = dot( transformedNormal, lVector );\n\t\t\tvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n\t\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\t\tvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\tvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n\t\t\t\tspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n\n\t\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\t\tspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\tvLightFront += spotLightColor[ i ] * spotLightWeighting * attenuation * spotEffect;\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tvLightBack += spotLightColor[ i ] * spotLightWeightingBack * attenuation * spotEffect;\n\n\t\t\t#endif\n\n\t\t}\n\n\t}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n\t\tvec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\n\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\n\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\t\tfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\n\n\t\tvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n\n\t\t#endif\n\n\t}\n\n#endif\n\nvLightFront += ambientLightColor;\n\n#ifdef DOUBLE_SIDED\n\n\tvLightBack += ambientLightColor;\n\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n\n#endif\n",default_vertex:"#ifdef USE_SKINNING\n\n\tvec4 mvPosition = modelViewMatrix * skinned;\n\n#elif defined( USE_MORPHTARGETS )\n\n\tvec4 mvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n\n#else\n\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\n#endif\n\ngl_Position = projectionMatrix * mvPosition;\n",map_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n\tvarying vec2 vUv;\n\n#endif\n\n#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n\t#ifdef USE_MORPHNORMALS\n\n\tvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n\n\t#else\n\n\tvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n\n\t#endif\n\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvarying float vFragDepth;\n\n\t#endif\n\n\tuniform float logDepthBufFC;\n\n#endif",lightmap_pars_vertex:"#ifdef USE_LIGHTMAP\n\n\tvarying vec2 vUv2;\n\n#endif",lights_phong_fragment:"#ifndef FLAT_SHADED\n\n\tvec3 normal = normalize( vNormal );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\n\t#endif\n\n#else\n\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n\n#endif\n\nvec3 viewPosition = normalize( vViewPosition );\n\n#ifdef USE_NORMALMAP\n\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\n#elif defined( USE_BUMPMAP )\n\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n\nvec3 totalDiffuseLight = vec3( 0.0 );\nvec3 totalSpecularLight = vec3( 0.0 );\n\n#if MAX_POINT_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n\t\tlVector = normalize( lVector );\n\n\t\t// diffuse\n\n\t\tfloat dotProduct = dot( normal, lVector );\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\n\t\t\tfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n\t\t\tvec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n\n\t\t#else\n\n\t\t\tfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n\n\t\t#endif\n\n\t\ttotalDiffuseLight += pointLightColor[ i ] * pointDiffuseWeight * attenuation;\n\n\t\t\t\t// specular\n\n\t\tvec3 pointHalfVector = normalize( lVector + viewPosition );\n\t\tfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\n\t\tfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, pointHalfVector ), 0.0 ), 5.0 );\n\t\ttotalSpecularLight += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * attenuation * specularNormalization;\n\n\t}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n\t\tlVector = normalize( lVector );\n\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\n\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\n\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n\t\t\t// diffuse\n\n\t\t\tfloat dotProduct = dot( normal, lVector );\n\n\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\tfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\n\t\t\t\tfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n\t\t\t\tvec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n\n\t\t\t#else\n\n\t\t\t\tfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n\n\t\t\t#endif\n\n\t\t\ttotalDiffuseLight += spotLightColor[ i ] * spotDiffuseWeight * attenuation * spotEffect;\n\n\t\t\t// specular\n\n\t\t\tvec3 spotHalfVector = normalize( lVector + viewPosition );\n\t\t\tfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\n\t\t\tfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n\n\t\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, spotHalfVector ), 0.0 ), 5.0 );\n\t\t\ttotalSpecularLight += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * attenuation * specularNormalization * spotEffect;\n\n\t\t}\n\n\t}\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n\t\tvec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\n\n\t\t// diffuse\n\n\t\tfloat dotProduct = dot( normal, dirVector );\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\n\t\t\tfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n\t\t\tvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n\n\t\t#else\n\n\t\t\tfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n\n\t\t#endif\n\n\t\ttotalDiffuseLight += directionalLightColor[ i ] * dirDiffuseWeight;\n\n\t\t// specular\n\n\t\tvec3 dirHalfVector = normalize( dirVector + viewPosition );\n\t\tfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\n\t\tfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n\n\t\t/*\n\t\t// fresnel term from skin shader\n\t\tconst float F0 = 0.128;\n\n\t\tfloat base = 1.0 - dot( viewPosition, dirHalfVector );\n\t\tfloat exponential = pow( base, 5.0 );\n\n\t\tfloat fresnel = exponential + F0 * ( 1.0 - exponential );\n\t\t*/\n\n\t\t/*\n\t\t// fresnel term from fresnel shader\n\t\tconst float mFresnelBias = 0.08;\n\t\tconst float mFresnelScale = 0.3;\n\t\tconst float mFresnelPower = 5.0;\n\n\t\tfloat fresnel = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( -viewPosition ), normal ), mFresnelPower );\n\t\t*/\n\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\t// \t\tdirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization * fresnel;\n\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );\n\t\ttotalSpecularLight += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n\n\n\t}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n\t\tvec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\n\n\t\t// diffuse\n\n\t\tfloat dotProduct = dot( normal, lVector );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n\t\tvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n\t\ttotalDiffuseLight += hemiColor;\n\n\t\t// specular (sky light)\n\n\t\tvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\n\t\tfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\n\t\tfloat hemiSpecularWeightSky = specularStrength * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );\n\n\t\t// specular (ground light)\n\n\t\tvec3 lVectorGround = -lVector;\n\n\t\tvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\n\t\tfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\n\t\tfloat hemiSpecularWeightGround = specularStrength * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );\n\n\t\tfloat dotProductGround = dot( normal, lVectorGround );\n\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\tvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );\n\t\tvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );\n\t\ttotalSpecularLight += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n\n\t}\n\n#endif\n\n#ifdef METAL\n\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) * specular + totalSpecularLight + emissive;\n\n#else\n\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) + totalSpecularLight + emissive;\n\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\n\tuniform vec3 fogColor;\n\n\t#ifdef FOG_EXP2\n\n\t\tuniform float fogDensity;\n\n\t#else\n\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\n\tvec3 morphedNormal = vec3( 0.0 );\n\n\tmorphedNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tmorphedNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tmorphedNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tmorphedNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n\tmorphedNormal += normal;\n\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\n\tuniform float reflectivity;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tuniform float refractionRatio;\n\n\t#else\n\n\t\tvarying vec3 vReflect;\n\n\t#endif\n\n#endif\n",logdepthbuf_fragment:"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\n\t// Per-Pixel Tangent Space Normal Mapping\n\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\n\t}\n\n#endif\n",lights_phong_pars_vertex:"#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n\tvarying vec3 vWorldPosition;\n\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\n\tvarying vec2 vUv2;\n\tuniform sampler2D lightMap;\n\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n\t\tvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n\n\t}\n\n#endif",lights_phong_vertex:"#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n\tvWorldPosition = worldPosition.xyz;\n\n#endif",map_fragment:"#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\n\ttexelColor.xyz = inputToLinear( texelColor.xyz );\n\n\tdiffuseColor *= texelColor;\n\n#endif",lightmap_vertex:"#ifdef USE_LIGHTMAP\n\n\tvUv2 = uv2;\n\n#endif",map_particle_fragment:"#ifdef USE_MAP\n\n\tdiffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\n#endif\n",color_pars_fragment:"#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif\n",color_vertex:"#ifdef USE_COLOR\n\n\tvColor.xyz = inputToLinear( color.xyz );\n\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\n\t#ifdef USE_MORPHTARGETS\n\n\tvec4 skinVertex = bindMatrix * vec4( morphed, 1.0 );\n\n\t#else\n\n\tvec4 skinVertex = bindMatrix * vec4( position, 1.0 );\n\n\t#endif\n\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n\n#endif\n",envmap_pars_vertex:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n\tvarying vec3 vReflect;\n\n\tuniform float refractionRatio;\n\n#endif\n",linear_to_gamma_fragment:"\n\toutgoingLight = linearToOutput( outgoingLight );\n",color_pars_vertex:"#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif",lights_lambert_pars_vertex:"uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#ifdef WRAP_AROUND\n\n\tuniform vec3 wrapRGB;\n\n#endif\n",map_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n\n#endif\n",envmap_fragment:"#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n\t\t// Transforming Normal Vectors with the Inverse Transformation\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\n\t\t#else\n\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#else\n\n\t\tvec3 reflectVec = vReflect;\n\n\t#endif\n\n\t#ifdef DOUBLE_SIDED\n\t\tfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\t#else\n\t\tfloat flipNormal = 1.0;\n\t#endif\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#endif\n\n\tenvColor.xyz = inputToLinear( envColor.xyz );\n\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\n\t#endif\n\n#endif\n",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\n\tuniform sampler2D specularMap;\n\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\n#else\n\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\n\t#endif\n\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\n\t#ifndef USE_MORPHNORMALS\n\n\tuniform float morphTargetInfluences[ 8 ];\n\n\t#else\n\n\tuniform float morphTargetInfluences[ 4 ];\n\n\t#endif\n\n#endif",specularmap_fragment:"float specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n\n#else\n\n\tspecularStrength = 1.0;\n\n#endif",fog_fragment:"#ifdef USE_FOG\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\n\t#else\n\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\n\t#endif\n\n\t#ifdef FOG_EXP2\n\n\t\tfloat fogFactor = exp2( - square( fogDensity ) * square( depth ) * LOG2 );\n\t\tfogFactor = whiteCompliment( fogFactor );\n\n\t#else\n\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\n\t#endif\n\t\n\toutgoingLight = mix( outgoingLight, fogColor, fogFactor );\n\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\n\t// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\n\t// http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\n\n\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n\tvec2 dHdxy_fwd() {\n\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n\t\treturn vec2( dBx, dBy );\n\n\t}\n\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\t\t// normalized\n\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\n\t}\n\n#endif\n",defaultnormal_vertex:"#ifdef USE_SKINNING\n\n\tvec3 objectNormal = skinnedNormal.xyz;\n\n#elif defined( USE_MORPHNORMALS )\n\n\tvec3 objectNormal = morphedNormal;\n\n#else\n\n\tvec3 objectNormal = normal;\n\n#endif\n\n#ifdef FLIP_SIDED\n\n\tobjectNormal = -objectNormal;\n\n#endif\n\nvec3 transformedNormal = normalMatrix * objectNormal;\n",lights_phong_pars_fragment:"uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n\tvarying vec3 vWorldPosition;\n\n#endif\n\n#ifdef WRAP_AROUND\n\n\tuniform vec3 wrapRGB;\n\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n",skinbase_vertex:"#ifdef USE_SKINNING\n\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif",map_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\n\toutgoingLight *= diffuseColor.xyz * texture2D( lightMap, vUv2 ).xyz;\n\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\n\tuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n\n#endif",color_fragment:"#ifdef USE_COLOR\n\n\tdiffuseColor.rgb *= vColor;\n\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\n\tvec3 morphed = vec3( 0.0 );\n\tmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\tmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\tmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\tmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n\t#ifndef USE_MORPHNORMALS\n\n\tmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\tmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\tmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\tmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n\t#endif\n\n\tmorphed += position;\n\n#endif",envmap_vertex:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n\tvec3 worldNormal = transformDirection( objectNormal, modelMatrix );\n\n\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\n\t#else\n\n\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t#endif\n\n#endif\n",shadowmap_fragment:"#ifdef USE_SHADOWMAP\n\n\t#ifdef SHADOWMAP_DEBUG\n\n\t\tvec3 frustumColors[3];\n\t\tfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\n\t\tfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\n\t\tfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n\n\t#endif\n\n\t#ifdef SHADOWMAP_CASCADE\n\n\t\tint inFrustumCount = 0;\n\n\t#endif\n\n\tfloat fDepth;\n\tvec3 shadowColor = vec3( 1.0 );\n\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n\t\tvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\n\n\t\t\t\t// if ( something && something ) breaks ATI OpenGL shader compiler\n\t\t\t\t// if ( all( something, something ) ) using this instead\n\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\n\t\t\t\t// don't shadow pixels outside of light frustum\n\t\t\t\t// use just first frustum (for cascades)\n\t\t\t\t// don't shadow pixels behind far plane of light frustum\n\n\t\t#ifdef SHADOWMAP_CASCADE\n\n\t\t\tinFrustumCount += int( inFrustum );\n\t\t\tbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n\n\t\t#else\n\n\t\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n\t\t#endif\n\n\t\tbool frustumTest = all( frustumTestVec );\n\n\t\tif ( frustumTest ) {\n\n\t\t\tshadowCoord.z += shadowBias[ i ];\n\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\n\t\t\t\t\t\t// Percentage-close filtering\n\t\t\t\t\t\t// (9 pixel kernel)\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\n\n\t\t\t\tfloat shadow = 0.0;\n\n\t\t/*\n\t\t\t\t\t\t// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\n\t\t\t\t\t\t// must enroll loop manually\n\n\t\t\t\tfor ( float y = -1.25; y <= 1.25; y += 1.25 )\n\t\t\t\t\tfor ( float x = -1.25; x <= 1.25; x += 1.25 ) {\n\n\t\t\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\n\n\t\t\t\t\t\t\t\t// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\n\t\t\t\t\t\t\t\t//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\n\n\t\t\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\n\n\t\t\t\t\t\tif ( fDepth < shadowCoord.z )\n\t\t\t\t\t\t\tshadow += 1.0;\n\n\t\t\t\t}\n\n\t\t\t\tshadow /= 9.0;\n\n\t\t*/\n\n\t\t\t\tconst float shadowDelta = 1.0 / 9.0;\n\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n\t\t\t\tfloat dx0 = -1.25 * xPixelOffset;\n\t\t\t\tfloat dy0 = -1.25 * yPixelOffset;\n\t\t\t\tfloat dx1 = 1.25 * xPixelOffset;\n\t\t\t\tfloat dy1 = 1.25 * yPixelOffset;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n\t\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\t\t\t\t\t\t// Percentage-close filtering\n\t\t\t\t\t\t// (9 pixel kernel)\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\n\n\t\t\t\tfloat shadow = 0.0;\n\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n\t\t\t\tfloat dx0 = -1.0 * xPixelOffset;\n\t\t\t\tfloat dy0 = -1.0 * yPixelOffset;\n\t\t\t\tfloat dx1 = 1.0 * xPixelOffset;\n\t\t\t\tfloat dy1 = 1.0 * yPixelOffset;\n\n\t\t\t\tmat3 shadowKernel;\n\t\t\t\tmat3 depthKernel;\n\n\t\t\t\tdepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n\t\t\t\tdepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n\t\t\t\tdepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n\t\t\t\tdepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n\t\t\t\tdepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n\t\t\t\tdepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n\t\t\t\tdepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n\t\t\t\tdepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n\t\t\t\tdepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\n\t\t\t\tvec3 shadowZ = vec3( shadowCoord.z );\n\t\t\t\tshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\n\t\t\t\tshadowKernel[0] *= vec3(0.25);\n\n\t\t\t\tshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\n\t\t\t\tshadowKernel[1] *= vec3(0.25);\n\n\t\t\t\tshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\n\t\t\t\tshadowKernel[2] *= vec3(0.25);\n\n\t\t\t\tvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\n\n\t\t\t\tshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\n\t\t\t\tshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\n\n\t\t\t\tvec4 shadowValues;\n\t\t\t\tshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\n\t\t\t\tshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\n\t\t\t\tshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\n\t\t\t\tshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\n\n\t\t\t\tshadow = dot( shadowValues, vec4( 1.0 ) );\n\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n\t\t\t#else\n\n\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\n\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\n\n\t\t\t\tif ( fDepth < shadowCoord.z )\n\n\t\t// spot with multiple shadows is darker\n\n\t\t\t\t\tshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n\n\t\t// spot with multiple shadows has the same color as single shadow spot\n\n\t\t// \t\t\t\t\tshadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\n\n\t\t\t#endif\n\n\t\t}\n\n\n\t\t#ifdef SHADOWMAP_DEBUG\n\n\t\t\t#ifdef SHADOWMAP_CASCADE\n\n\t\t\t\tif ( inFrustum && inFrustumCount == 1 ) outgoingLight *= frustumColors[ i ];\n\n\t\t\t#else\n\n\t\t\t\tif ( inFrustum ) outgoingLight *= frustumColors[ i ];\n\n\t\t\t#endif\n\n\t\t#endif\n\n\t}\n\n\t// NOTE: I am unsure if this is correct in linear space.  -bhouston, Dec 29, 2014\n\tshadowColor = inputToLinear( shadowColor );\n\n\toutgoingLight = outgoingLight * shadowColor;\n\n#endif\n",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\n\t#ifdef USE_SKINNING\n\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\n\t#elif defined( USE_MORPHTARGETS )\n\n\t\tvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n\n\t#else\n\n\t\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n\n\t#endif\n\n#endif\n",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\n\tuniform sampler2D shadowMap[ MAX_SHADOWS ];\n\tuniform vec2 shadowMapSize[ MAX_SHADOWS ];\n\n\tuniform float shadowDarkness[ MAX_SHADOWS ];\n\tuniform float shadowBias[ MAX_SHADOWS ];\n\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\n\n\tfloat unpackDepth( const in vec4 rgba_depth ) {\n\n\t\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\t\tfloat depth = dot( rgba_depth, bit_shift );\n\t\treturn depth;\n\n\t}\n\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\n\t#ifdef BONE_TEXTURE\n\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\n\t\t\ty = dy * ( y + 0.5 );\n\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\n\t\t\treturn bone;\n\n\t\t}\n\n\t#else\n\n\t\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tmat4 bone = boneGlobalMatrices[ int(i) ];\n\t\t\treturn bone;\n\n\t\t}\n\n\t#endif\n\n#endif\n",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\n\tuniform float logDepthBufFC;\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\t#extension GL_EXT_frag_depth : enable\n\t\tvarying float vFragDepth;\n\n\t#endif\n\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n"},Jm=Zm,Qm={basic:{uniforms:jo.merge([Km.common,Km.fog,Km.shadowmap]),vertexShader:[Jm.common,Jm.map_pars_vertex,Jm.lightmap_pars_vertex,Jm.envmap_pars_vertex,Jm.color_pars_vertex,Jm.morphtarget_pars_vertex,Jm.skinning_pars_vertex,Jm.shadowmap_pars_vertex,Jm.logdepthbuf_pars_vertex,"void main() {",Jm.map_vertex,Jm.lightmap_vertex,Jm.color_vertex,Jm.skinbase_vertex,"\t#ifdef USE_ENVMAP",Jm.morphnormal_vertex,Jm.skinnormal_vertex,Jm.defaultnormal_vertex,"\t#endif",Jm.morphtarget_vertex,Jm.skinning_vertex,Jm.default_vertex,Jm.logdepthbuf_vertex,Jm.worldpos_vertex,Jm.envmap_vertex,Jm.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;",Jm.common,Jm.color_pars_fragment,Jm.map_pars_fragment,Jm.alphamap_pars_fragment,Jm.lightmap_pars_fragment,Jm.envmap_pars_fragment,Jm.fog_pars_fragment,Jm.shadowmap_pars_fragment,Jm.specularmap_pars_fragment,Jm.logdepthbuf_pars_fragment,"void main() {","\tvec3 outgoingLight = vec3( 0.0 );","\tvec4 diffuseColor = vec4( diffuse, opacity );",Jm.logdepthbuf_fragment,Jm.map_fragment,Jm.color_fragment,Jm.alphamap_fragment,Jm.alphatest_fragment,Jm.specularmap_fragment,"\toutgoingLight = diffuseColor.rgb;",Jm.lightmap_fragment,Jm.envmap_fragment,Jm.shadowmap_fragment,Jm.linear_to_gamma_fragment,Jm.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},lambert:{uniforms:jo.merge([Km.common,Km.fog,Km.lights,Km.shadowmap,{emissive:{type:"c",value:new Zr(0)},wrapRGB:{type:"v3",value:new Si(1,1,1)}}]),vertexShader:["#define LAMBERT","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","\tvarying vec3 vLightBack;","#endif",Jm.common,Jm.map_pars_vertex,Jm.lightmap_pars_vertex,Jm.envmap_pars_vertex,Jm.lights_lambert_pars_vertex,Jm.color_pars_vertex,Jm.morphtarget_pars_vertex,Jm.skinning_pars_vertex,Jm.shadowmap_pars_vertex,Jm.logdepthbuf_pars_vertex,"void main() {",Jm.map_vertex,Jm.lightmap_vertex,Jm.color_vertex,Jm.morphnormal_vertex,Jm.skinbase_vertex,Jm.skinnormal_vertex,Jm.defaultnormal_vertex,Jm.morphtarget_vertex,Jm.skinning_vertex,Jm.default_vertex,Jm.logdepthbuf_vertex,Jm.worldpos_vertex,Jm.envmap_vertex,Jm.lights_lambert_vertex,Jm.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform vec3 emissive;","uniform float opacity;","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","\tvarying vec3 vLightBack;","#endif",Jm.common,Jm.color_pars_fragment,Jm.map_pars_fragment,Jm.alphamap_pars_fragment,Jm.lightmap_pars_fragment,Jm.envmap_pars_fragment,Jm.fog_pars_fragment,Jm.shadowmap_pars_fragment,Jm.specularmap_pars_fragment,Jm.logdepthbuf_pars_fragment,"void main() {","\tvec3 outgoingLight = vec3( 0.0 );","\tvec4 diffuseColor = vec4( diffuse, opacity );",Jm.logdepthbuf_fragment,Jm.map_fragment,Jm.color_fragment,Jm.alphamap_fragment,Jm.alphatest_fragment,Jm.specularmap_fragment,"\t#ifdef DOUBLE_SIDED","\t\tif ( gl_FrontFacing )","\t\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;","\t\telse","\t\t\toutgoingLight += diffuseColor.rgb * vLightBack + emissive;","\t#else","\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;","\t#endif",Jm.lightmap_fragment,Jm.envmap_fragment,Jm.shadowmap_fragment,Jm.linear_to_gamma_fragment,Jm.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},phong:{uniforms:jo.merge([Km.common,Km.bump,Km.normalmap,Km.fog,Km.lights,Km.shadowmap,{emissive:{type:"c",value:new Zr(0)},specular:{type:"c",value:new Zr(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new Si(1,1,1)}}]),vertexShader:["#define PHONG","varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif",Jm.common,Jm.map_pars_vertex,Jm.lightmap_pars_vertex,Jm.envmap_pars_vertex,Jm.lights_phong_pars_vertex,Jm.color_pars_vertex,Jm.morphtarget_pars_vertex,Jm.skinning_pars_vertex,Jm.shadowmap_pars_vertex,Jm.logdepthbuf_pars_vertex,"void main() {",Jm.map_vertex,Jm.lightmap_vertex,Jm.color_vertex,Jm.morphnormal_vertex,Jm.skinbase_vertex,Jm.skinnormal_vertex,Jm.defaultnormal_vertex,"#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif",Jm.morphtarget_vertex,Jm.skinning_vertex,Jm.default_vertex,Jm.logdepthbuf_vertex,"\tvViewPosition = -mvPosition.xyz;",Jm.worldpos_vertex,Jm.envmap_vertex,Jm.lights_phong_vertex,Jm.shadowmap_vertex,"}"].join("\n"),fragmentShader:["#define PHONG","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;","uniform float opacity;",Jm.common,Jm.color_pars_fragment,Jm.map_pars_fragment,Jm.alphamap_pars_fragment,Jm.lightmap_pars_fragment,Jm.envmap_pars_fragment,Jm.fog_pars_fragment,Jm.lights_phong_pars_fragment,Jm.shadowmap_pars_fragment,Jm.bumpmap_pars_fragment,Jm.normalmap_pars_fragment,Jm.specularmap_pars_fragment,Jm.logdepthbuf_pars_fragment,"void main() {","\tvec3 outgoingLight = vec3( 0.0 );","\tvec4 diffuseColor = vec4( diffuse, opacity );",Jm.logdepthbuf_fragment,Jm.map_fragment,Jm.color_fragment,Jm.alphamap_fragment,Jm.alphatest_fragment,Jm.specularmap_fragment,Jm.lights_phong_fragment,Jm.lightmap_fragment,Jm.envmap_fragment,Jm.shadowmap_fragment,Jm.linear_to_gamma_fragment,Jm.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},particle_basic:{uniforms:jo.merge([Km.particle,Km.shadowmap]),vertexShader:["uniform float size;","uniform float scale;",Jm.common,Jm.color_pars_vertex,Jm.shadowmap_pars_vertex,Jm.logdepthbuf_pars_vertex,"void main() {",Jm.color_vertex,"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\t#ifdef USE_SIZEATTENUATION","\t\tgl_PointSize = size * ( scale / length( mvPosition.xyz ) );","\t#else","\t\tgl_PointSize = size;","\t#endif","\tgl_Position = projectionMatrix * mvPosition;",Jm.logdepthbuf_vertex,Jm.worldpos_vertex,Jm.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;","uniform float opacity;",Jm.common,Jm.color_pars_fragment,Jm.map_particle_pars_fragment,Jm.fog_pars_fragment,Jm.shadowmap_pars_fragment,Jm.logdepthbuf_pars_fragment,"void main() {","\tvec3 outgoingLight = vec3( 0.0 );","\tvec4 diffuseColor = vec4( psColor, opacity );",Jm.logdepthbuf_fragment,Jm.map_particle_fragment,Jm.color_fragment,Jm.alphatest_fragment,"\toutgoingLight = diffuseColor.rgb;",Jm.shadowmap_fragment,Jm.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},dashed:{uniforms:jo.merge([Km.common,Km.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;","attribute float lineDistance;","varying float vLineDistance;",Jm.common,Jm.color_pars_vertex,Jm.logdepthbuf_pars_vertex,"void main() {",Jm.color_vertex,"\tvLineDistance = scale * lineDistance;","\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * mvPosition;",Jm.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform float dashSize;","uniform float totalSize;","varying float vLineDistance;",Jm.common,Jm.color_pars_fragment,Jm.fog_pars_fragment,Jm.logdepthbuf_pars_fragment,"void main() {","\tif ( mod( vLineDistance, totalSize ) > dashSize ) {","\t\tdiscard;","\t}","\tvec3 outgoingLight = vec3( 0.0 );","\tvec4 diffuseColor = vec4( diffuse, opacity );",Jm.logdepthbuf_fragment,Jm.color_fragment,"\toutgoingLight = diffuseColor.rgb;",Jm.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:[Jm.common,Jm.morphtarget_pars_vertex,Jm.logdepthbuf_pars_vertex,"void main() {",Jm.morphtarget_vertex,Jm.default_vertex,Jm.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","uniform float opacity;",Jm.common,Jm.logdepthbuf_pars_fragment,"void main() {",Jm.logdepthbuf_fragment,"\t#ifdef USE_LOGDEPTHBUF_EXT","\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;","\t#else","\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;","\t#endif","\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );","\tgl_FragColor = vec4( vec3( color ), opacity );","}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",Jm.common,Jm.morphtarget_pars_vertex,Jm.logdepthbuf_pars_vertex,"void main() {","\tvNormal = normalize( normalMatrix * normal );",Jm.morphtarget_vertex,Jm.default_vertex,Jm.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vNormal;",Jm.common,Jm.logdepthbuf_pars_fragment,"void main() {","\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );",Jm.logdepthbuf_fragment,"}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",Jm.common,Jm.logdepthbuf_pars_vertex,"void main() {","\tvWorldPosition = transformDirection( position, modelMatrix );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",Jm.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","uniform float tFlip;","varying vec3 vWorldPosition;",Jm.common,Jm.logdepthbuf_pars_fragment,"void main() {","\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );",Jm.logdepthbuf_fragment,"}"].join("\n")},equirect:{uniforms:{tEquirect:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",Jm.common,Jm.logdepthbuf_pars_vertex,"void main() {","\tvWorldPosition = transformDirection( position, modelMatrix );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",Jm.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","uniform float tFlip;","varying vec3 vWorldPosition;",Jm.common,Jm.logdepthbuf_pars_fragment,"void main() {","vec3 direction = normalize( vWorldPosition );","vec2 sampleUV;","sampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );","sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","gl_FragColor = texture2D( tEquirect, sampleUV );",Jm.logdepthbuf_fragment,"}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[Jm.common,Jm.morphtarget_pars_vertex,Jm.skinning_pars_vertex,Jm.logdepthbuf_pars_vertex,"void main() {",Jm.skinbase_vertex,Jm.morphtarget_vertex,Jm.skinning_vertex,Jm.default_vertex,Jm.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:[Jm.common,Jm.logdepthbuf_pars_fragment,"vec4 pack_depth( const in float depth ) {","\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );","\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );","\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );","\tres -= res.xxyz * bit_mask;","\treturn res;","}","void main() {",Jm.logdepthbuf_fragment,"\t#ifdef USE_LOGDEPTHBUF_EXT","\t\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );","\t#else","\t\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );","\t#endif","}"].join("\n")}},$m=305},94370:(e,t,n)=>{"use strict";n.d(t,{r:()=>i});var i=function(e,t){return e.applyMatrix4(t)}},62705:(e,t,n)=>{var i=n(55639).Symbol;e.exports=i},44239:(e,t,n)=>{var i=n(62705),r=n(89607),o=n(2333),a=i?i.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?r(e):o(e)}},27561:(e,t,n)=>{var i=n(67990),r=/^\s+/;e.exports=function(e){return e?e.slice(0,i(e)+1).replace(r,""):e}},31957:(e,t,n)=>{var i="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=i},89607:(e,t,n)=>{var i=n(62705),r=Object.prototype,o=r.hasOwnProperty,a=r.toString,s=i?i.toStringTag:void 0;e.exports=function(e){var t=o.call(e,s),n=e[s];try{e[s]=void 0;var i=!0}catch(e){}var r=a.call(e);return i&&(t?e[s]=n:delete e[s]),r}},2333:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},55639:(e,t,n)=>{var i=n(31957),r="object"==typeof self&&self&&self.Object===Object&&self,o=i||r||Function("return this")();e.exports=o},67990:e=>{var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},23279:(e,t,n)=>{var i=n(13218),r=n(7771),o=n(14841),a=Math.max,s=Math.min;e.exports=function(e,t,n){var l,c,u,h,d,p,f=0,m=!1,g=!1,v=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var n=l,i=c;return l=c=void 0,f=t,h=e.apply(i,n)}function b(e){return f=e,d=setTimeout(x,t),m?y(e):h}function _(e){var n=e-p;return void 0===p||n>=t||n<0||g&&e-f>=u}function x(){var e=r();if(_(e))return E(e);d=setTimeout(x,function(e){var n=t-(e-p);return g?s(n,u-(e-f)):n}(e))}function E(e){return d=void 0,v&&l?y(e):(l=c=void 0,h)}function w(){var e=r(),n=_(e);if(l=arguments,c=this,p=e,n){if(void 0===d)return b(p);if(g)return clearTimeout(d),d=setTimeout(x,t),y(p)}return void 0===d&&(d=setTimeout(x,t)),h}return t=o(t)||0,i(n)&&(m=!!n.leading,u=(g="maxWait"in n)?a(o(n.maxWait)||0,t):u,v="trailing"in n?!!n.trailing:v),w.cancel=function(){void 0!==d&&clearTimeout(d),f=0,l=p=c=d=void 0},w.flush=function(){return void 0===d?h:E(r())},w}},13218:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},37005:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},33448:(e,t,n)=>{var i=n(44239),r=n(37005);e.exports=function(e){return"symbol"==typeof e||r(e)&&"[object Symbol]"==i(e)}},7771:(e,t,n)=>{var i=n(55639);e.exports=function(){return i.Date.now()}},14841:(e,t,n)=>{var i=n(27561),r=n(13218),o=n(33448),a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=i(e);var n=s.test(e);return n||l.test(e)?c(e.slice(2),n?2:8):a.test(e)?NaN:+e}},99591:(e,t,n)=>{"use strict";var i={};(0,n(24236).assign)(i,n(24555),n(78843),n(71619)),e.exports=i},24555:(e,t,n)=>{"use strict";var i=n(30405),r=n(24236),o=n(29373),a=n(48898),s=n(62292),l=Object.prototype.toString;function c(e){if(!(this instanceof c))return new c(e);this.options=r.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=i.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==n)throw new Error(a[n]);if(t.header&&i.deflateSetHeader(this.strm,t.header),t.dictionary){var u;if(u="string"==typeof t.dictionary?o.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(n=i.deflateSetDictionary(this.strm,u)))throw new Error(a[n]);this._dict_set=!0}}function u(e,t){var n=new c(t);if(n.push(e,!0),n.err)throw n.msg||a[n.err];return n.result}c.prototype.push=function(e,t){var n,a,s=this.strm,c=this.options.chunkSize;if(this.ended)return!1;a=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=o.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new r.Buf8(c),s.next_out=0,s.avail_out=c),1!==(n=i.deflate(s,a))&&0!==n)return this.onEnd(n),this.ended=!0,!1;0!==s.avail_out&&(0!==s.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(o.buf2binstring(r.shrinkBuf(s.output,s.next_out))):this.onData(r.shrinkBuf(s.output,s.next_out)))}while((s.avail_in>0||0===s.avail_out)&&1!==n);return 4===a?(n=i.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==a||(this.onEnd(0),s.avail_out=0,!0)},c.prototype.onData=function(e){this.chunks.push(e)},c.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=c,t.deflate=u,t.deflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},t.gzip=function(e,t){return(t=t||{}).gzip=!0,u(e,t)}},78843:(e,t,n)=>{"use strict";var i=n(27948),r=n(24236),o=n(29373),a=n(71619),s=n(48898),l=n(62292),c=n(42401),u=Object.prototype.toString;function h(e){if(!(this instanceof h))return new h(e);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=i.inflateInit2(this.strm,t.windowBits);if(n!==a.Z_OK)throw new Error(s[n]);if(this.header=new c,i.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=o.string2buf(t.dictionary):"[object ArrayBuffer]"===u.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=i.inflateSetDictionary(this.strm,t.dictionary))!==a.Z_OK))throw new Error(s[n])}function d(e,t){var n=new h(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}h.prototype.push=function(e,t){var n,s,l,c,h,d=this.strm,p=this.options.chunkSize,f=this.options.dictionary,m=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof e?d.input=o.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?d.input=new Uint8Array(e):d.input=e,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new r.Buf8(p),d.next_out=0,d.avail_out=p),(n=i.inflate(d,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&f&&(n=i.inflateSetDictionary(this.strm,f)),n===a.Z_BUF_ERROR&&!0===m&&(n=a.Z_OK,m=!1),n!==a.Z_STREAM_END&&n!==a.Z_OK)return this.onEnd(n),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&n!==a.Z_STREAM_END&&(0!==d.avail_in||s!==a.Z_FINISH&&s!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(d.output,d.next_out),c=d.next_out-l,h=o.buf2string(d.output,l),d.next_out=c,d.avail_out=p-c,c&&r.arraySet(d.output,d.output,l,c,0),this.onData(h)):this.onData(r.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(m=!0)}while((d.avail_in>0||0===d.avail_out)&&n!==a.Z_STREAM_END);return n===a.Z_STREAM_END&&(s=a.Z_FINISH),s===a.Z_FINISH?(n=i.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===a.Z_OK):s!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),d.avail_out=0,!0)},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=h,t.inflate=d,t.inflateRaw=function(e,t){return(t=t||{}).raw=!0,d(e,t)},t.ungzip=d},24236:(e,t)=>{"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)i(n,r)&&(e[r]=n[r])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,n,i,r){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+i),r);else for(var o=0;o<i;o++)e[r+o]=t[n+o]},flattenChunks:function(e){var t,n,i,r,o,a;for(i=0,t=0,n=e.length;t<n;t++)i+=e[t].length;for(a=new Uint8Array(i),r=0,t=0,n=e.length;t<n;t++)o=e[t],a.set(o,r),r+=o.length;return a}},o={arraySet:function(e,t,n,i,r){for(var o=0;o<i;o++)e[r+o]=t[n+o]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,r)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,o))},t.setTyped(n)},29373:(e,t,n)=>{"use strict";var i=n(24236),r=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var a=new i.Buf8(256),s=0;s<256;s++)a[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function l(e,t){if(t<65534&&(e.subarray&&o||!e.subarray&&r))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var n="",a=0;a<t;a++)n+=String.fromCharCode(e[a]);return n}a[254]=a[254]=1,t.string2buf=function(e){var t,n,r,o,a,s=e.length,l=0;for(o=0;o<s;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new i.Buf8(l),a=0,o=0;a<l;o++)55296==(64512&(n=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|63&n):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t},t.buf2binstring=function(e){return l(e,e.length)},t.binstring2buf=function(e){for(var t=new i.Buf8(e.length),n=0,r=t.length;n<r;n++)t[n]=e.charCodeAt(n);return t},t.buf2string=function(e,t){var n,i,r,o,s=t||e.length,c=new Array(2*s);for(i=0,n=0;n<s;)if((r=e[n++])<128)c[i++]=r;else if((o=a[r])>4)c[i++]=65533,n+=o-1;else{for(r&=2===o?31:3===o?15:7;o>1&&n<s;)r=r<<6|63&e[n++],o--;o>1?c[i++]=65533:r<65536?c[i++]=r:(r-=65536,c[i++]=55296|r>>10&1023,c[i++]=56320|1023&r)}return l(c,i)},t.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+a[e[n]]>t?n:t}},66069:e=>{"use strict";e.exports=function(e,t,n,i){for(var r=65535&e|0,o=e>>>16&65535|0,a=0;0!==n;){n-=a=n>2e3?2e3:n;do{o=o+(r=r+t[i++]|0)|0}while(--a);r%=65521,o%=65521}return r|o<<16|0}},71619:e=>{"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},2869:e=>{"use strict";var t=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();e.exports=function(e,n,i,r){var o=t,a=r+i;e^=-1;for(var s=r;s<a;s++)e=e>>>8^o[255&(e^n[s])];return-1^e}},30405:(e,t,n)=>{"use strict";var i,r=n(24236),o=n(10342),a=n(66069),s=n(2869),l=n(48898),c=-2,u=258,h=262,d=103,p=113,f=666;function m(e,t){return e.msg=l[t],t}function g(e){return(e<<1)-(e>4?9:0)}function v(e){for(var t=e.length;--t>=0;)e[t]=0}function y(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(r.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function b(e,t){o._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,y(e.strm)}function _(e,t){e.pending_buf[e.pending++]=t}function x(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function E(e,t){var n,i,r=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-h?e.strstart-(e.w_size-h):0,c=e.window,d=e.w_mask,p=e.prev,f=e.strstart+u,m=c[o+a-1],g=c[o+a];e.prev_length>=e.good_match&&(r>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(n=t)+a]===g&&c[n+a-1]===m&&c[n]===c[o]&&c[++n]===c[o+1]){o+=2,n++;do{}while(c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&o<f);if(i=u-(f-o),o=f-u,i>a){if(e.match_start=t,a=i,i>=s)break;m=c[o+a-1],g=c[o+a]}}}while((t=p[t&d])>l&&0!=--r);return a<=e.lookahead?a:e.lookahead}function w(e){var t,n,i,o,l,c,u,d,p,f,m=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=m+(m-h)){r.arraySet(e.window,e.window,m,m,0),e.match_start-=m,e.strstart-=m,e.block_start-=m,t=n=e.hash_size;do{i=e.head[--t],e.head[t]=i>=m?i-m:0}while(--n);t=n=m;do{i=e.prev[--t],e.prev[t]=i>=m?i-m:0}while(--n);o+=m}if(0===e.strm.avail_in)break;if(c=e.strm,u=e.window,d=e.strstart+e.lookahead,p=o,f=void 0,(f=c.avail_in)>p&&(f=p),n=0===f?0:(c.avail_in-=f,r.arraySet(u,c.input,c.next_in,f,d),1===c.state.wrap?c.adler=a(c.adler,u,f,d):2===c.state.wrap&&(c.adler=s(c.adler,u,f,d)),c.next_in+=f,c.total_in+=f,f),e.lookahead+=n,e.lookahead+e.insert>=3)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+3-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<h&&0!==e.strm.avail_in)}function S(e,t){for(var n,i;;){if(e.lookahead<h){if(w(e),e.lookahead<h&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-h&&(e.match_length=E(e,n)),e.match_length>=3)if(i=o._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}function A(e,t){for(var n,i,r;;){if(e.lookahead<h){if(w(e),e.lookahead<h&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-h&&(e.match_length=E(e,n),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-3,i=o._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(b(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((i=o._tr_tally(e,0,e.window[e.strstart-1]))&&b(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=o._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}function M(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r}function T(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(1146),this.dyn_dtree=new r.Buf16(122),this.bl_tree=new r.Buf16(78),v(this.dyn_ltree),v(this.dyn_dtree),v(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(16),this.heap=new r.Buf16(573),v(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(573),v(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function C(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:p,e.adler=2===t.wrap?0:1,t.last_flush=0,o._tr_init(t),0):m(e,c)}function P(e){var t,n=C(e);return 0===n&&((t=e.state).window_size=2*t.w_size,v(t.head),t.max_lazy_match=i[t.level].max_lazy,t.good_match=i[t.level].good_length,t.nice_match=i[t.level].nice_length,t.max_chain_length=i[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),n}function L(e,t,n,i,o,a){if(!e)return c;var s=1;if(-1===t&&(t=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),o<1||o>9||8!==n||i<8||i>15||t<0||t>9||a<0||a>4)return m(e,c);8===i&&(i=9);var l=new T;return e.state=l,l.strm=e,l.wrap=s,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new r.Buf8(2*l.w_size),l.head=new r.Buf16(l.hash_size),l.prev=new r.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new r.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=a,l.method=n,P(e)}i=[new M(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(w(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,b(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-h&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(b(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(b(e,!1),e.strm.avail_out),1)})),new M(4,4,8,4,S),new M(4,5,16,8,S),new M(4,6,32,32,S),new M(4,4,16,16,A),new M(8,16,32,32,A),new M(8,16,128,128,A),new M(8,32,128,256,A),new M(32,128,258,1024,A),new M(32,258,258,4096,A)],t.deflateInit=function(e,t){return L(e,t,8,15,8,0)},t.deflateInit2=L,t.deflateReset=P,t.deflateResetKeep=C,t.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?c:(e.state.gzhead=t,0):c},t.deflate=function(e,t){var n,r,a,l;if(!e||!e.state||t>5||t<0)return e?m(e,c):c;if(r=e.state,!e.output||!e.input&&0!==e.avail_in||r.status===f&&4!==t)return m(e,0===e.avail_out?-5:c);if(r.strm=e,n=r.last_flush,r.last_flush=t,42===r.status)if(2===r.wrap)e.adler=0,_(r,31),_(r,139),_(r,8),r.gzhead?(_(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),_(r,255&r.gzhead.time),_(r,r.gzhead.time>>8&255),_(r,r.gzhead.time>>16&255),_(r,r.gzhead.time>>24&255),_(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),_(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(_(r,255&r.gzhead.extra.length),_(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=s(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(_(r,0),_(r,0),_(r,0),_(r,0),_(r,0),_(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),_(r,3),r.status=p);else{var h=8+(r.w_bits-8<<4)<<8;h|=(r.strategy>=2||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(h|=32),h+=31-h%31,r.status=p,x(r,h),0!==r.strstart&&(x(r,e.adler>>>16),x(r,65535&e.adler)),e.adler=1}if(69===r.status)if(r.gzhead.extra){for(a=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),y(e),a=r.pending,r.pending!==r.pending_buf_size));)_(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),y(e),a=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,_(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),0===l&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),y(e),a=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,_(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>a&&(e.adler=s(e.adler,r.pending_buf,r.pending-a,a)),0===l&&(r.status=d)}else r.status=d;if(r.status===d&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&y(e),r.pending+2<=r.pending_buf_size&&(_(r,255&e.adler),_(r,e.adler>>8&255),e.adler=0,r.status=p)):r.status=p),0!==r.pending){if(y(e),0===e.avail_out)return r.last_flush=-1,0}else if(0===e.avail_in&&g(t)<=g(n)&&4!==t)return m(e,-5);if(r.status===f&&0!==e.avail_in)return m(e,-5);if(0!==e.avail_in||0!==r.lookahead||0!==t&&r.status!==f){var E=2===r.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(w(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}(r,t):3===r.strategy?function(e,t){for(var n,i,r,a,s=e.window;;){if(e.lookahead<=u){if(w(e),e.lookahead<=u&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=s[r=e.strstart-1])===s[++r]&&i===s[++r]&&i===s[++r]){a=e.strstart+u;do{}while(i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&r<a);e.match_length=u-(a-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=o._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}(r,t):i[r.level].func(r,t);if(3!==E&&4!==E||(r.status=f),1===E||3===E)return 0===e.avail_out&&(r.last_flush=-1),0;if(2===E&&(1===t?o._tr_align(r):5!==t&&(o._tr_stored_block(r,0,0,!1),3===t&&(v(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),y(e),0===e.avail_out))return r.last_flush=-1,0}return 4!==t?0:r.wrap<=0?1:(2===r.wrap?(_(r,255&e.adler),_(r,e.adler>>8&255),_(r,e.adler>>16&255),_(r,e.adler>>24&255),_(r,255&e.total_in),_(r,e.total_in>>8&255),_(r,e.total_in>>16&255),_(r,e.total_in>>24&255)):(x(r,e.adler>>>16),x(r,65535&e.adler)),y(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?0:1)},t.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&t!==d&&t!==p&&t!==f?m(e,c):(e.state=null,t===p?m(e,-3):0):c},t.deflateSetDictionary=function(e,t){var n,i,o,s,l,u,h,d,p=t.length;if(!e||!e.state)return c;if(2===(s=(n=e.state).wrap)||1===s&&42!==n.status||n.lookahead)return c;for(1===s&&(e.adler=a(e.adler,t,p,0)),n.wrap=0,p>=n.w_size&&(0===s&&(v(n.head),n.strstart=0,n.block_start=0,n.insert=0),d=new r.Buf8(n.w_size),r.arraySet(d,t,p-n.w_size,n.w_size,0),t=d,p=n.w_size),l=e.avail_in,u=e.next_in,h=e.input,e.avail_in=p,e.next_in=0,e.input=t,w(n);n.lookahead>=3;){i=n.strstart,o=n.lookahead-2;do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+3-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++}while(--o);n.strstart=i,n.lookahead=2,w(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=u,e.input=h,e.avail_in=l,n.wrap=s,0},t.deflateInfo="pako deflate (from Nodeca project)"},42401:e=>{"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},94264:e=>{"use strict";e.exports=function(e,t){var n,i,r,o,a,s,l,c,u,h,d,p,f,m,g,v,y,b,_,x,E,w,S,A,M;n=e.state,i=e.next_in,A=e.input,r=i+(e.avail_in-5),o=e.next_out,M=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),l=n.dmax,c=n.wsize,u=n.whave,h=n.wnext,d=n.window,p=n.hold,f=n.bits,m=n.lencode,g=n.distcode,v=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;e:do{f<15&&(p+=A[i++]<<f,f+=8,p+=A[i++]<<f,f+=8),b=m[p&v];t:for(;;){if(p>>>=_=b>>>24,f-=_,0===(_=b>>>16&255))M[o++]=65535&b;else{if(!(16&_)){if(0==(64&_)){b=m[(65535&b)+(p&(1<<_)-1)];continue t}if(32&_){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}x=65535&b,(_&=15)&&(f<_&&(p+=A[i++]<<f,f+=8),x+=p&(1<<_)-1,p>>>=_,f-=_),f<15&&(p+=A[i++]<<f,f+=8,p+=A[i++]<<f,f+=8),b=g[p&y];n:for(;;){if(p>>>=_=b>>>24,f-=_,!(16&(_=b>>>16&255))){if(0==(64&_)){b=g[(65535&b)+(p&(1<<_)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(E=65535&b,f<(_&=15)&&(p+=A[i++]<<f,(f+=8)<_&&(p+=A[i++]<<f,f+=8)),(E+=p&(1<<_)-1)>l){e.msg="invalid distance too far back",n.mode=30;break e}if(p>>>=_,f-=_,E>(_=o-a)){if((_=E-_)>u&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(w=0,S=d,0===h){if(w+=c-_,_<x){x-=_;do{M[o++]=d[w++]}while(--_);w=o-E,S=M}}else if(h<_){if(w+=c+h-_,(_-=h)<x){x-=_;do{M[o++]=d[w++]}while(--_);if(w=0,h<x){x-=_=h;do{M[o++]=d[w++]}while(--_);w=o-E,S=M}}}else if(w+=h-_,_<x){x-=_;do{M[o++]=d[w++]}while(--_);w=o-E,S=M}for(;x>2;)M[o++]=S[w++],M[o++]=S[w++],M[o++]=S[w++],x-=3;x&&(M[o++]=S[w++],x>1&&(M[o++]=S[w++]))}else{w=o-E;do{M[o++]=M[w++],M[o++]=M[w++],M[o++]=M[w++],x-=3}while(x>2);x&&(M[o++]=M[w++],x>1&&(M[o++]=M[w++]))}break}}break}}while(i<r&&o<s);i-=x=f>>3,p&=(1<<(f-=x<<3))-1,e.next_in=i,e.next_out=o,e.avail_in=i<r?r-i+5:5-(i-r),e.avail_out=o<s?s-o+257:257-(o-s),n.hold=p,n.bits=f}},27948:(e,t,n)=>{"use strict";var i=n(24236),r=n(66069),o=n(2869),a=n(94264),s=n(9241),l=-2,c=12,u=30;function h(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function d(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function p(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new i.Buf32(852),t.distcode=t.distdyn=new i.Buf32(592),t.sane=1,t.back=-1,0):l}function f(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,p(e)):l}function m(e,t){var n,i;return e&&e.state?(i=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?l:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,f(e))):l}function g(e,t){var n,i;return e?(i=new d,e.state=i,i.window=null,0!==(n=m(e,t))&&(e.state=null),n):l}var v,y,b=!0;function _(e){if(b){var t;for(v=new i.Buf32(512),y=new i.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(1,e.lens,0,288,v,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(2,e.lens,0,32,y,0,e.work,{bits:5}),b=!1}e.lencode=v,e.lenbits=9,e.distcode=y,e.distbits=5}function x(e,t,n,r){var o,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new i.Buf8(a.wsize)),r>=a.wsize?(i.arraySet(a.window,t,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((o=a.wsize-a.wnext)>r&&(o=r),i.arraySet(a.window,t,n-r,o,a.wnext),(r-=o)?(i.arraySet(a.window,t,n-r,r,0),a.wnext=r,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}t.inflateReset=f,t.inflateReset2=m,t.inflateResetKeep=p,t.inflateInit=function(e){return g(e,15)},t.inflateInit2=g,t.inflate=function(e,t){var n,d,p,f,m,g,v,y,b,E,w,S,A,M,T,C,P,L,R,D,I,O,N,k,F=0,U=new i.Buf8(4),B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return l;(n=e.state).mode===c&&(n.mode=13),m=e.next_out,p=e.output,v=e.avail_out,f=e.next_in,d=e.input,g=e.avail_in,y=n.hold,b=n.bits,E=g,w=v,O=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;b<16;){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}if(2&n.wrap&&35615===y){n.check=0,U[0]=255&y,U[1]=y>>>8&255,n.check=o(n.check,U,2,0),y=0,b=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&y)<<8)+(y>>8))%31){e.msg="incorrect header check",n.mode=u;break}if(8!=(15&y)){e.msg="unknown compression method",n.mode=u;break}if(b-=4,I=8+(15&(y>>>=4)),0===n.wbits)n.wbits=I;else if(I>n.wbits){e.msg="invalid window size",n.mode=u;break}n.dmax=1<<I,e.adler=n.check=1,n.mode=512&y?10:c,y=0,b=0;break;case 2:for(;b<16;){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}if(n.flags=y,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=u;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=u;break}n.head&&(n.head.text=y>>8&1),512&n.flags&&(U[0]=255&y,U[1]=y>>>8&255,n.check=o(n.check,U,2,0)),y=0,b=0,n.mode=3;case 3:for(;b<32;){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}n.head&&(n.head.time=y),512&n.flags&&(U[0]=255&y,U[1]=y>>>8&255,U[2]=y>>>16&255,U[3]=y>>>24&255,n.check=o(n.check,U,4,0)),y=0,b=0,n.mode=4;case 4:for(;b<16;){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}n.head&&(n.head.xflags=255&y,n.head.os=y>>8),512&n.flags&&(U[0]=255&y,U[1]=y>>>8&255,n.check=o(n.check,U,2,0)),y=0,b=0,n.mode=5;case 5:if(1024&n.flags){for(;b<16;){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}n.length=y,n.head&&(n.head.extra_len=y),512&n.flags&&(U[0]=255&y,U[1]=y>>>8&255,n.check=o(n.check,U,2,0)),y=0,b=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((S=n.length)>g&&(S=g),S&&(n.head&&(I=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),i.arraySet(n.head.extra,d,f,S,I)),512&n.flags&&(n.check=o(n.check,d,S,f)),g-=S,f+=S,n.length-=S),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===g)break e;S=0;do{I=d[f+S++],n.head&&I&&n.length<65536&&(n.head.name+=String.fromCharCode(I))}while(I&&S<g);if(512&n.flags&&(n.check=o(n.check,d,S,f)),g-=S,f+=S,I)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===g)break e;S=0;do{I=d[f+S++],n.head&&I&&n.length<65536&&(n.head.comment+=String.fromCharCode(I))}while(I&&S<g);if(512&n.flags&&(n.check=o(n.check,d,S,f)),g-=S,f+=S,I)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;b<16;){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}if(y!==(65535&n.check)){e.msg="header crc mismatch",n.mode=u;break}y=0,b=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=c;break;case 10:for(;b<32;){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}e.adler=n.check=h(y),y=0,b=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=m,e.avail_out=v,e.next_in=f,e.avail_in=g,n.hold=y,n.bits=b,2;e.adler=n.check=1,n.mode=c;case c:if(5===t||6===t)break e;case 13:if(n.last){y>>>=7&b,b-=7&b,n.mode=27;break}for(;b<3;){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}switch(n.last=1&y,b-=1,3&(y>>>=1)){case 0:n.mode=14;break;case 1:if(_(n),n.mode=20,6===t){y>>>=2,b-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=u}y>>>=2,b-=2;break;case 14:for(y>>>=7&b,b-=7&b;b<32;){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}if((65535&y)!=(y>>>16^65535)){e.msg="invalid stored block lengths",n.mode=u;break}if(n.length=65535&y,y=0,b=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(S=n.length){if(S>g&&(S=g),S>v&&(S=v),0===S)break e;i.arraySet(p,d,f,S,m),g-=S,f+=S,v-=S,m+=S,n.length-=S;break}n.mode=c;break;case 17:for(;b<14;){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}if(n.nlen=257+(31&y),y>>>=5,b-=5,n.ndist=1+(31&y),y>>>=5,b-=5,n.ncode=4+(15&y),y>>>=4,b-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=u;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;b<3;){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}n.lens[B[n.have++]]=7&y,y>>>=3,b-=3}for(;n.have<19;)n.lens[B[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,N={bits:n.lenbits},O=s(0,n.lens,0,19,n.lencode,0,n.work,N),n.lenbits=N.bits,O){e.msg="invalid code lengths set",n.mode=u;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;C=(F=n.lencode[y&(1<<n.lenbits)-1])>>>16&255,P=65535&F,!((T=F>>>24)<=b);){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}if(P<16)y>>>=T,b-=T,n.lens[n.have++]=P;else{if(16===P){for(k=T+2;b<k;){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}if(y>>>=T,b-=T,0===n.have){e.msg="invalid bit length repeat",n.mode=u;break}I=n.lens[n.have-1],S=3+(3&y),y>>>=2,b-=2}else if(17===P){for(k=T+3;b<k;){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}b-=T,I=0,S=3+(7&(y>>>=T)),y>>>=3,b-=3}else{for(k=T+7;b<k;){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}b-=T,I=0,S=11+(127&(y>>>=T)),y>>>=7,b-=7}if(n.have+S>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=u;break}for(;S--;)n.lens[n.have++]=I}}if(n.mode===u)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=u;break}if(n.lenbits=9,N={bits:n.lenbits},O=s(1,n.lens,0,n.nlen,n.lencode,0,n.work,N),n.lenbits=N.bits,O){e.msg="invalid literal/lengths set",n.mode=u;break}if(n.distbits=6,n.distcode=n.distdyn,N={bits:n.distbits},O=s(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,N),n.distbits=N.bits,O){e.msg="invalid distances set",n.mode=u;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(g>=6&&v>=258){e.next_out=m,e.avail_out=v,e.next_in=f,e.avail_in=g,n.hold=y,n.bits=b,a(e,w),m=e.next_out,p=e.output,v=e.avail_out,f=e.next_in,d=e.input,g=e.avail_in,y=n.hold,b=n.bits,n.mode===c&&(n.back=-1);break}for(n.back=0;C=(F=n.lencode[y&(1<<n.lenbits)-1])>>>16&255,P=65535&F,!((T=F>>>24)<=b);){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}if(C&&0==(240&C)){for(L=T,R=C,D=P;C=(F=n.lencode[D+((y&(1<<L+R)-1)>>L)])>>>16&255,P=65535&F,!(L+(T=F>>>24)<=b);){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}y>>>=L,b-=L,n.back+=L}if(y>>>=T,b-=T,n.back+=T,n.length=P,0===C){n.mode=26;break}if(32&C){n.back=-1,n.mode=c;break}if(64&C){e.msg="invalid literal/length code",n.mode=u;break}n.extra=15&C,n.mode=22;case 22:if(n.extra){for(k=n.extra;b<k;){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}n.length+=y&(1<<n.extra)-1,y>>>=n.extra,b-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;C=(F=n.distcode[y&(1<<n.distbits)-1])>>>16&255,P=65535&F,!((T=F>>>24)<=b);){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}if(0==(240&C)){for(L=T,R=C,D=P;C=(F=n.distcode[D+((y&(1<<L+R)-1)>>L)])>>>16&255,P=65535&F,!(L+(T=F>>>24)<=b);){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}y>>>=L,b-=L,n.back+=L}if(y>>>=T,b-=T,n.back+=T,64&C){e.msg="invalid distance code",n.mode=u;break}n.offset=P,n.extra=15&C,n.mode=24;case 24:if(n.extra){for(k=n.extra;b<k;){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}n.offset+=y&(1<<n.extra)-1,y>>>=n.extra,b-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=u;break}n.mode=25;case 25:if(0===v)break e;if(S=w-v,n.offset>S){if((S=n.offset-S)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=u;break}S>n.wnext?(S-=n.wnext,A=n.wsize-S):A=n.wnext-S,S>n.length&&(S=n.length),M=n.window}else M=p,A=m-n.offset,S=n.length;S>v&&(S=v),v-=S,n.length-=S;do{p[m++]=M[A++]}while(--S);0===n.length&&(n.mode=21);break;case 26:if(0===v)break e;p[m++]=n.length,v--,n.mode=21;break;case 27:if(n.wrap){for(;b<32;){if(0===g)break e;g--,y|=d[f++]<<b,b+=8}if(w-=v,e.total_out+=w,n.total+=w,w&&(e.adler=n.check=n.flags?o(n.check,p,w,m-w):r(n.check,p,w,m-w)),w=v,(n.flags?y:h(y))!==n.check){e.msg="incorrect data check",n.mode=u;break}y=0,b=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;b<32;){if(0===g)break e;g--,y+=d[f++]<<b,b+=8}if(y!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=u;break}y=0,b=0}n.mode=29;case 29:O=1;break e;case u:O=-3;break e;case 31:return-4;default:return l}return e.next_out=m,e.avail_out=v,e.next_in=f,e.avail_in=g,n.hold=y,n.bits=b,(n.wsize||w!==e.avail_out&&n.mode<u&&(n.mode<27||4!==t))&&x(e,e.output,e.next_out,w-e.avail_out)?(n.mode=31,-4):(E-=e.avail_in,w-=e.avail_out,e.total_in+=E,e.total_out+=w,n.total+=w,n.wrap&&w&&(e.adler=n.check=n.flags?o(n.check,p,w,e.next_out-w):r(n.check,p,w,e.next_out-w)),e.data_type=n.bits+(n.last?64:0)+(n.mode===c?128:0)+(20===n.mode||15===n.mode?256:0),(0===E&&0===w||4===t)&&0===O&&(O=-5),O)},t.inflateEnd=function(e){if(!e||!e.state)return l;var t=e.state;return t.window&&(t.window=null),e.state=null,0},t.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?l:(n.head=t,t.done=!1,0):l},t.inflateSetDictionary=function(e,t){var n,i=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?l:11===n.mode&&r(1,t,i,0)!==n.check?-3:x(e,t,i,i)?(n.mode=31,-4):(n.havedict=1,0):l},t.inflateInfo="pako inflate (from Nodeca project)"},9241:(e,t,n)=>{"use strict";var i=n(24236),r=15,o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,n,c,u,h,d,p){var f,m,g,v,y,b,_,x,E,w=p.bits,S=0,A=0,M=0,T=0,C=0,P=0,L=0,R=0,D=0,I=0,O=null,N=0,k=new i.Buf16(16),F=new i.Buf16(16),U=null,B=0;for(S=0;S<=r;S++)k[S]=0;for(A=0;A<c;A++)k[t[n+A]]++;for(C=w,T=r;T>=1&&0===k[T];T--);if(C>T&&(C=T),0===T)return u[h++]=20971520,u[h++]=20971520,p.bits=1,0;for(M=1;M<T&&0===k[M];M++);for(C<M&&(C=M),R=1,S=1;S<=r;S++)if(R<<=1,(R-=k[S])<0)return-1;if(R>0&&(0===e||1!==T))return-1;for(F[1]=0,S=1;S<r;S++)F[S+1]=F[S]+k[S];for(A=0;A<c;A++)0!==t[n+A]&&(d[F[t[n+A]]++]=A);if(0===e?(O=U=d,b=19):1===e?(O=o,N-=257,U=a,B-=257,b=256):(O=s,U=l,b=-1),I=0,A=0,S=M,y=h,P=C,L=0,g=-1,v=(D=1<<C)-1,1===e&&D>852||2===e&&D>592)return 1;for(;;){_=S-L,d[A]<b?(x=0,E=d[A]):d[A]>b?(x=U[B+d[A]],E=O[N+d[A]]):(x=96,E=0),f=1<<S-L,M=m=1<<P;do{u[y+(I>>L)+(m-=f)]=_<<24|x<<16|E|0}while(0!==m);for(f=1<<S-1;I&f;)f>>=1;if(0!==f?(I&=f-1,I+=f):I=0,A++,0==--k[S]){if(S===T)break;S=t[n+d[A]]}if(S>C&&(I&v)!==g){for(0===L&&(L=C),y+=M,R=1<<(P=S-L);P+L<T&&!((R-=k[P+L])<=0);)P++,R<<=1;if(D+=1<<P,1===e&&D>852||2===e&&D>592)return 1;u[g=I&v]=C<<24|P<<16|y-h|0}}return 0!==I&&(u[y+I]=S-L<<24|64<<16|0),p.bits=C,0}},48898:e=>{"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},10342:(e,t,n)=>{"use strict";var i=n(24236);function r(e){for(var t=e.length;--t>=0;)e[t]=0}var o=256,a=286,s=30,l=15,c=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],u=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],d=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],p=new Array(576);r(p);var f=new Array(60);r(f);var m=new Array(512);r(m);var g=new Array(256);r(g);var v=new Array(29);r(v);var y,b,_,x=new Array(s);function E(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}function w(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function S(e){return e<256?m[e]:m[256+(e>>>7)]}function A(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function M(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,A(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function T(e,t,n){M(e,n[2*t],n[2*t+1])}function C(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function P(e,t,n){var i,r,o=new Array(16),a=0;for(i=1;i<=l;i++)o[i]=a=a+n[i-1]<<1;for(r=0;r<=t;r++){var s=e[2*r+1];0!==s&&(e[2*r]=C(o[s]++,s))}}function L(e){var t;for(t=0;t<a;t++)e.dyn_ltree[2*t]=0;for(t=0;t<s;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function R(e){e.bi_valid>8?A(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function D(e,t,n,i){var r=2*t,o=2*n;return e[r]<e[o]||e[r]===e[o]&&i[t]<=i[n]}function I(e,t,n){for(var i=e.heap[n],r=n<<1;r<=e.heap_len&&(r<e.heap_len&&D(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!D(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i}function O(e,t,n){var i,r,a,s,l=0;if(0!==e.last_lit)do{i=e.pending_buf[e.d_buf+2*l]<<8|e.pending_buf[e.d_buf+2*l+1],r=e.pending_buf[e.l_buf+l],l++,0===i?T(e,r,t):(T(e,(a=g[r])+o+1,t),0!==(s=c[a])&&M(e,r-=v[a],s),T(e,a=S(--i),n),0!==(s=u[a])&&M(e,i-=x[a],s))}while(l<e.last_lit);T(e,256,t)}function N(e,t){var n,i,r,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,c=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<c;n++)0!==o[2*n]?(e.heap[++e.heap_len]=u=n,e.depth[n]=0):o[2*n+1]=0;for(;e.heap_len<2;)o[2*(r=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[r]=0,e.opt_len--,s&&(e.static_len-=a[2*r+1]);for(t.max_code=u,n=e.heap_len>>1;n>=1;n--)I(e,o,n);r=c;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],I(e,o,1),i=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=i,o[2*r]=o[2*n]+o[2*i],e.depth[r]=(e.depth[n]>=e.depth[i]?e.depth[n]:e.depth[i])+1,o[2*n+1]=o[2*i+1]=r,e.heap[1]=r++,I(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,i,r,o,a,s,c=t.dyn_tree,u=t.max_code,h=t.stat_desc.static_tree,d=t.stat_desc.has_stree,p=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,m=t.stat_desc.max_length,g=0;for(o=0;o<=l;o++)e.bl_count[o]=0;for(c[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)(o=c[2*c[2*(i=e.heap[n])+1]+1]+1)>m&&(o=m,g++),c[2*i+1]=o,i>u||(e.bl_count[o]++,a=0,i>=f&&(a=p[i-f]),s=c[2*i],e.opt_len+=s*(o+a),d&&(e.static_len+=s*(h[2*i+1]+a)));if(0!==g){do{for(o=m-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[m]--,g-=2}while(g>0);for(o=m;0!==o;o--)for(i=e.bl_count[o];0!==i;)(r=e.heap[--n])>u||(c[2*r+1]!==o&&(e.opt_len+=(o-c[2*r+1])*c[2*r],c[2*r+1]=o),i--)}}(e,t),P(o,u,e.bl_count)}function k(e,t,n){var i,r,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)r=a,a=t[2*(i+1)+1],++s<l&&r===a||(s<c?e.bl_tree[2*r]+=s:0!==r?(r!==o&&e.bl_tree[2*r]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,o=r,0===a?(l=138,c=3):r===a?(l=6,c=3):(l=7,c=4))}function F(e,t,n){var i,r,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),i=0;i<=n;i++)if(r=a,a=t[2*(i+1)+1],!(++s<l&&r===a)){if(s<c)do{T(e,r,e.bl_tree)}while(0!=--s);else 0!==r?(r!==o&&(T(e,r,e.bl_tree),s--),T(e,16,e.bl_tree),M(e,s-3,2)):s<=10?(T(e,17,e.bl_tree),M(e,s-3,3)):(T(e,18,e.bl_tree),M(e,s-11,7));s=0,o=r,0===a?(l=138,c=3):r===a?(l=6,c=3):(l=7,c=4)}}r(x);var U=!1;function B(e,t,n,r){M(e,0+(r?1:0),3),function(e,t,n,r){R(e),r&&(A(e,n),A(e,~n)),i.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n,!0)}t._tr_init=function(e){U||(!function(){var e,t,n,i,r,o=new Array(16);for(n=0,i=0;i<28;i++)for(v[i]=n,e=0;e<1<<c[i];e++)g[n++]=i;for(g[n-1]=i,r=0,i=0;i<16;i++)for(x[i]=r,e=0;e<1<<u[i];e++)m[r++]=i;for(r>>=7;i<s;i++)for(x[i]=r<<7,e=0;e<1<<u[i]-7;e++)m[256+r++]=i;for(t=0;t<=l;t++)o[t]=0;for(e=0;e<=143;)p[2*e+1]=8,e++,o[8]++;for(;e<=255;)p[2*e+1]=9,e++,o[9]++;for(;e<=279;)p[2*e+1]=7,e++,o[7]++;for(;e<=287;)p[2*e+1]=8,e++,o[8]++;for(P(p,287,o),e=0;e<s;e++)f[2*e+1]=5,f[2*e]=C(e,5);y=new E(p,c,257,a,l),b=new E(f,u,0,s,l),_=new E(new Array(0),h,0,19,7)}(),U=!0),e.l_desc=new w(e.dyn_ltree,y),e.d_desc=new w(e.dyn_dtree,b),e.bl_desc=new w(e.bl_tree,_),e.bi_buf=0,e.bi_valid=0,L(e)},t._tr_stored_block=B,t._tr_flush_block=function(e,t,n,i){var r,a,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<o;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),N(e,e.l_desc),N(e,e.d_desc),s=function(e){var t;for(k(e,e.dyn_ltree,e.l_desc.max_code),k(e,e.dyn_dtree,e.d_desc.max_code),N(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*d[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),r=e.opt_len+3+7>>>3,(a=e.static_len+3+7>>>3)<=r&&(r=a)):r=a=n+5,n+4<=r&&-1!==t?B(e,t,n,i):4===e.strategy||a===r?(M(e,2+(i?1:0),3),O(e,p,f)):(M(e,4+(i?1:0),3),function(e,t,n,i){var r;for(M(e,t-257,5),M(e,n-1,5),M(e,i-4,4),r=0;r<i;r++)M(e,e.bl_tree[2*d[r]+1],3);F(e,e.dyn_ltree,t-1),F(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),O(e,e.dyn_ltree,e.dyn_dtree)),L(e),i&&R(e)},t._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(g[n]+o+1)]++,e.dyn_dtree[2*S(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){M(e,2,3),T(e,256,p),function(e){16===e.bi_valid?(A(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},62292:e=>{"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},79916:e=>{function t(){this.pending=0,this.max=1/0,this.listeners=[],this.waiting=[],this.error=null}function n(e){e.pending+=1;var t=!1;return function(r){if(t)throw new Error("callback called twice");if(t=!0,e.error=e.error||r,e.pending-=1,e.waiting.length>0&&e.pending<e.max)i(e,e.waiting.shift());else if(0===e.pending){var o=e.listeners;e.listeners=[],o.forEach(n)}};function n(t){t(e.error)}}function i(e,t){t(n(e))}e.exports=t,t.prototype.go=function(e){this.pending<this.max?i(this,e):this.waiting.push(e)},t.prototype.wait=function(e){0===this.pending?e(this.error):this.listeners.push(e)},t.prototype.hold=function(){return n(this)}},74971:function(e,t,n){var i;/*! https://mths.be/punycode v1.3.2 by @mathias */e=n.nmd(e),function(r){t&&t.nodeType,e&&e.nodeType;var o="object"==typeof n.g&&n.g;o.global!==o&&o.window!==o&&o.self;var a,s=2147483647,l=36,c=/^xn--/,u=/[^\x20-\x7E]/,h=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=Math.floor,f=String.fromCharCode;function m(e){throw RangeError(d[e])}function g(e,t){for(var n=e.length,i=[];n--;)i[n]=t(e[n]);return i}function v(e,t){var n=e.split("@"),i="";return n.length>1&&(i=n[0]+"@",e=n[1]),i+g((e=e.replace(h,".")).split("."),t).join(".")}function y(e){for(var t,n,i=[],r=0,o=e.length;r<o;)(t=e.charCodeAt(r++))>=55296&&t<=56319&&r<o?56320==(64512&(n=e.charCodeAt(r++)))?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),r--):i.push(t);return i}function b(e){return g(e,(function(e){var t="";return e>65535&&(t+=f((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=f(e)})).join("")}function _(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function x(e,t,n){var i=0;for(e=n?p(e/700):e>>1,e+=p(e/t);e>455;i+=l)e=p(e/35);return p(i+36*e/(e+38))}function E(e){var t,n,i,r,o,a,c,u,h,d,f,g=[],v=e.length,y=0,_=128,E=72;for((n=e.lastIndexOf("-"))<0&&(n=0),i=0;i<n;++i)e.charCodeAt(i)>=128&&m("not-basic"),g.push(e.charCodeAt(i));for(r=n>0?n+1:0;r<v;){for(o=y,a=1,c=l;r>=v&&m("invalid-input"),((u=(f=e.charCodeAt(r++))-48<10?f-22:f-65<26?f-65:f-97<26?f-97:l)>=l||u>p((s-y)/a))&&m("overflow"),y+=u*a,!(u<(h=c<=E?1:c>=E+26?26:c-E));c+=l)a>p(s/(d=l-h))&&m("overflow"),a*=d;E=x(y-o,t=g.length+1,0==o),p(y/t)>s-_&&m("overflow"),_+=p(y/t),y%=t,g.splice(y++,0,_)}return b(g)}function w(e){var t,n,i,r,o,a,c,u,h,d,g,v,b,E,w,S=[];for(v=(e=y(e)).length,t=128,n=0,o=72,a=0;a<v;++a)(g=e[a])<128&&S.push(f(g));for(i=r=S.length,r&&S.push("-");i<v;){for(c=s,a=0;a<v;++a)(g=e[a])>=t&&g<c&&(c=g);for(c-t>p((s-n)/(b=i+1))&&m("overflow"),n+=(c-t)*b,t=c,a=0;a<v;++a)if((g=e[a])<t&&++n>s&&m("overflow"),g==t){for(u=n,h=l;!(u<(d=h<=o?1:h>=o+26?26:h-o));h+=l)w=u-d,E=l-d,S.push(f(_(d+w%E,0))),u=p(w/E);S.push(f(_(u,0))),o=x(n,b,i==r),n=0,++i}++n,++t}return S.join("")}a={version:"1.3.2",ucs2:{decode:y,encode:b},decode:E,encode:w,toASCII:function(e){return v(e,(function(e){return u.test(e)?"xn--"+w(e):e}))},toUnicode:function(e){return v(e,(function(e){return c.test(e)?E(e.slice(4).toLowerCase()):e}))}},void 0===(i=function(){return a}.call(t,n,t,e))||(e.exports=i)}()},62587:e=>{"use strict";function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,n,i,r){n=n||"&",i=i||"=";var o={};if("string"!=typeof e||0===e.length)return o;var a=/\+/g;e=e.split(n);var s=1e3;r&&"number"==typeof r.maxKeys&&(s=r.maxKeys);var l=e.length;s>0&&l>s&&(l=s);for(var c=0;c<l;++c){var u,h,d,p,f=e[c].replace(a,"%20"),m=f.indexOf(i);m>=0?(u=f.substr(0,m),h=f.substr(m+1)):(u=f,h=""),d=decodeURIComponent(u),p=decodeURIComponent(h),t(o,d)?Array.isArray(o[d])?o[d].push(p):o[d]=[o[d],p]:o[d]=p}return o}},12361:e=>{"use strict";var t=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,n,i,r){return n=n||"&",i=i||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((function(r){var o=encodeURIComponent(t(r))+i;return Array.isArray(e[r])?e[r].map((function(e){return o+encodeURIComponent(t(e))})).join(n):o+encodeURIComponent(t(e[r]))})).join(n):r?encodeURIComponent(t(r))+i+encodeURIComponent(t(e)):""}},17673:(e,t,n)=>{"use strict";t.decode=t.parse=n(62587),t.encode=t.stringify=n(12361)},35666:e=>{var t=function(e){"use strict";var t,n=Object.prototype,i=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function l(e,t,n,i){var r=t&&t.prototype instanceof m?t:m,o=Object.create(r.prototype),a=new T(i||[]);return o._invoke=function(e,t,n){var i=u;return function(r,o){if(i===d)throw new Error("Generator is already running");if(i===p){if("throw"===r)throw o;return P()}for(n.method=r,n.arg=o;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===u)throw i=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=d;var l=c(e,t,n);if("normal"===l.type){if(i=n.done?p:h,l.arg===f)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=p,n.method="throw",n.arg=l.arg)}}}(e,n,a),o}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u="suspendedStart",h="suspendedYield",d="executing",p="completed",f={};function m(){}function g(){}function v(){}var y={};y[o]=function(){return this};var b=Object.getPrototypeOf,_=b&&b(b(C([])));_&&_!==n&&i.call(_,o)&&(y=_);var x=v.prototype=m.prototype=Object.create(y);function E(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function w(e,t){function n(r,o,a,s){var l=c(e[r],e,o);if("throw"!==l.type){var u=l.arg,h=u.value;return h&&"object"==typeof h&&i.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(h).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(l.arg)}var r;this._invoke=function(e,i){function o(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(o,o):o()}}function S(e,n){var i=e.iterator[n.method];if(i===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method))return f;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var r=c(i,e.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,f;var o=r.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,f):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function C(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:P}}function P(){return{value:t,done:!0}}return g.prototype=x.constructor=v,v.constructor=g,v[s]=g.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},E(w.prototype),w.prototype[a]=function(){return this},e.AsyncIterator=w,e.async=function(t,n,i,r,o){void 0===o&&(o=Promise);var a=new w(l(t,n,i,r),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},E(x),x[s]="Generator",x[o]=function(){return this},x.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},e.values=C,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(M),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return s.type="throw",s.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),M(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;M(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:C(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),f}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}},8575:(e,t,n)=>{var i=n(74971);function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=v,t.resolve=function(e,t){return v(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?v(e,!1,!0).resolveObject(t):t},t.format=function(e){y(e)&&(e=v(e));return e instanceof r?e.format():r.prototype.format.call(e)},t.Url=r;var o=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,s=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(s),c=["%","/","?",";","#"].concat(l),u=["/","?","#"],h=/^[a-z0-9A-Z_-]{0,63}$/,d=/^([a-z0-9A-Z_-]{0,63})(.*)$/,p={javascript:!0,"javascript:":!0},f={javascript:!0,"javascript:":!0},m={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},g=n(17673);function v(e,t,n){if(e&&b(e)&&e instanceof r)return e;var i=new r;return i.parse(e,t,n),i}function y(e){return"string"==typeof e}function b(e){return"object"==typeof e&&null!==e}function _(e){return null===e}r.prototype.parse=function(e,t,n){if(!y(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e;r=r.trim();var a=o.exec(r);if(a){var s=(a=a[0]).toLowerCase();this.protocol=s,r=r.substr(a.length)}if(n||a||r.match(/^\/\/[^@\/]+@[^@\/]+/)){var v="//"===r.substr(0,2);!v||a&&f[a]||(r=r.substr(2),this.slashes=!0)}if(!f[a]&&(v||a&&!m[a])){for(var b,_,x=-1,E=0;E<u.length;E++){-1!==(w=r.indexOf(u[E]))&&(-1===x||w<x)&&(x=w)}-1!==(_=-1===x?r.lastIndexOf("@"):r.lastIndexOf("@",x))&&(b=r.slice(0,_),r=r.slice(_+1),this.auth=decodeURIComponent(b)),x=-1;for(E=0;E<c.length;E++){var w;-1!==(w=r.indexOf(c[E]))&&(-1===x||w<x)&&(x=w)}-1===x&&(x=r.length),this.host=r.slice(0,x),r=r.slice(x),this.parseHost(),this.hostname=this.hostname||"";var S="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!S)for(var A=this.hostname.split(/\./),M=(E=0,A.length);E<M;E++){var T=A[E];if(T&&!T.match(h)){for(var C="",P=0,L=T.length;P<L;P++)T.charCodeAt(P)>127?C+="x":C+=T[P];if(!C.match(h)){var R=A.slice(0,E),D=A.slice(E+1),I=T.match(d);I&&(R.push(I[1]),D.unshift(I[2])),D.length&&(r="/"+D.join(".")+r),this.hostname=R.join(".");break}}}if(this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),!S){var O=this.hostname.split("."),N=[];for(E=0;E<O.length;++E){var k=O[E];N.push(k.match(/[^A-Za-z0-9_-]/)?"xn--"+i.encode(k):k)}this.hostname=N.join(".")}var F=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+F,this.href+=this.host,S&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==r[0]&&(r="/"+r))}if(!p[s])for(E=0,M=l.length;E<M;E++){var B=l[E],V=encodeURIComponent(B);V===B&&(V=escape(B)),r=r.split(B).join(V)}var G=r.indexOf("#");-1!==G&&(this.hash=r.substr(G),r=r.slice(0,G));var z=r.indexOf("?");if(-1!==z?(this.search=r.substr(z),this.query=r.substr(z+1),t&&(this.query=g.parse(this.query)),r=r.slice(0,z)):t&&(this.search="",this.query={}),r&&(this.pathname=r),m[s]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){F=this.pathname||"",k=this.search||"";this.path=F+k}return this.href=this.format(),this},r.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",i=this.hash||"",r=!1,o="";this.host?r=e+this.host:this.hostname&&(r=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&b(this.query)&&Object.keys(this.query).length&&(o=g.stringify(this.query));var a=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||m[t])&&!1!==r?(r="//"+(r||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):r||(r=""),i&&"#"!==i.charAt(0)&&(i="#"+i),a&&"?"!==a.charAt(0)&&(a="?"+a),t+r+(n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(a=a.replace("#","%23"))+i},r.prototype.resolve=function(e){return this.resolveObject(v(e,!1,!0)).format()},r.prototype.resolveObject=function(e){if(y(e)){var t=new r;t.parse(e,!1,!0),e=t}var n=new r;if(Object.keys(this).forEach((function(e){n[e]=this[e]}),this),n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol)return Object.keys(e).forEach((function(t){"protocol"!==t&&(n[t]=e[t])})),m[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n;if(e.protocol&&e.protocol!==n.protocol){if(!m[e.protocol])return Object.keys(e).forEach((function(t){n[t]=e[t]})),n.href=n.format(),n;if(n.protocol=e.protocol,e.host||f[e.protocol])n.pathname=e.pathname;else{for(var i=(e.pathname||"").split("/");i.length&&!(e.host=i.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==i[0]&&i.unshift(""),i.length<2&&i.unshift(""),n.pathname=i.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var o=n.pathname||"",a=n.search||"";n.path=o+a}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var s=n.pathname&&"/"===n.pathname.charAt(0),l=e.host||e.pathname&&"/"===e.pathname.charAt(0),c=l||s||n.host&&e.pathname,u=c,h=n.pathname&&n.pathname.split("/")||[],d=(i=e.pathname&&e.pathname.split("/")||[],n.protocol&&!m[n.protocol]);if(d&&(n.hostname="",n.port=null,n.host&&(""===h[0]?h[0]=n.host:h.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===i[0]?i[0]=e.host:i.unshift(e.host)),e.host=null),c=c&&(""===i[0]||""===h[0])),l)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,h=i;else if(i.length)h||(h=[]),h.pop(),h=h.concat(i),n.search=e.search,n.query=e.query;else if(null!=e.search){if(d)n.hostname=n.host=h.shift(),(x=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=x.shift(),n.host=n.hostname=x.shift());return n.search=e.search,n.query=e.query,_(n.pathname)&&_(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!h.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var p=h.slice(-1)[0],g=(n.host||e.host)&&("."===p||".."===p)||""===p,v=0,b=h.length;b>=0;b--)"."==(p=h[b])?h.splice(b,1):".."===p?(h.splice(b,1),v++):v&&(h.splice(b,1),v--);if(!c&&!u)for(;v--;v)h.unshift("..");!c||""===h[0]||h[0]&&"/"===h[0].charAt(0)||h.unshift(""),g&&"/"!==h.join("/").substr(-1)&&h.push("");var x,E=""===h[0]||h[0]&&"/"===h[0].charAt(0);d&&(n.hostname=n.host=E?"":h.length?h.shift():"",(x=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=x.shift(),n.host=n.hostname=x.shift()));return(c=c||n.host&&h.length)&&!E&&h.unshift(""),h.length?n.pathname=h.join("/"):(n.pathname=null,n.path=null),_(n.pathname)&&_(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},15523:e=>{"use strict";e.exports="DELETED_WORKERNODE"},74617:()=>{},75725:()=>{},80959:()=>{},78322:()=>{},83154:(e,t,n)=>{var i;if("function"==typeof fetch&&(void 0!==n.g&&n.g.fetch?i=n.g.fetch:"undefined"!=typeof window&&window.fetch&&(i=window.fetch)),"undefined"==typeof window||void 0===window.document){var r=i||n(68203);r.default&&(r=r.default),t.default=r,e.exports=t.default}},30325:e=>{"use strict";e.exports=JSON.parse('{"globals":{"dimension":{},"factor":{"factor":1},"factor.derived":{"parentFactors":{}},"quantity":{"units":[]},"symbol":{"doc":"http://docs.adskunits.apiary.io/#introduction/definitions/unit-symbols","unit":{"typeid":"unit","description":"Measurement unit this symbol applies to."}},"symbol.placement":{"Prefix":{"value":0},"Suffix":1},"symbol.prefixOrSuffix":{"text":{"typeid":"String","description":"Text to annotate the value."},"placement":{"typeid":"symbol.placement","description":"Placement of the annotation text."},"space":{"typeid":"Bool","description":"Specifies whether the annotation should be separated from the value by a space."}},"system":{"Metric":{"value":0,"description":"Metric system of measurement units."},"Imperial":1},"unit":{"doc":"http://docs.adskunits.apiary.io/#introduction/definitions/measurement-units","unitSystem":{"typeid":"system"}},"unit.absolute":{"parentUnit":{"typeid":"unit.relative","description":"Relative unit from which this absolute unit is derived."},"offset":{"typeid":"Float64","value":0,"description":"An offset used to position an absolute scale of measurement on the number line."}},"unit.derived":{"parentFactors":{},"parentUnits":{}},"unit.primitive":{},"unit.primitive.dimensional":{"dimension":{"typeid":"dimension"}},"unit.relative":{}},"factor":{"nineFifths":{"factor":1.8},"pi":{"factor":3.14159265358979},"atto":{"parentFactors":{"ten":-18}},"centi":{"parentFactors":{"ten":-2}},"deci":{"parentFactors":{"ten":-1}},"deka":{"parentFactors":{"ten":1}},"exa":{"parentFactors":{"ten":18}},"femto":{"parentFactors":{"ten":-15}},"giga":{"parentFactors":{"ten":9}},"hecto":{"parentFactors":{"ten":2}},"kilo":{"parentFactors":{"ten":3}},"mega":{"parentFactors":{"ten":6}},"micro":{"parentFactors":{"ten":-6}},"milli":{"parentFactors":{"ten":-3}},"nano":{"parentFactors":{"ten":-9}},"peta":{"parentFactors":{"ten":15}},"pico":{"parentFactors":{"ten":-12}},"tera":{"parentFactors":{"ten":12}},"yocto":{"parentFactors":{"ten":-24}},"yotta":{"parentFactors":{"ten":24}},"zepto":{"parentFactors":{"ten":-21}},"zetta":{"parentFactors":{"ten":21}},"ten":{"factor":10},"threeHundredSixty":{"factor":360},"threeThousandNineHundredThirtySeven":{"factor":3937},"twelve":{"factor":12}},"dimension":{"currency":{},"electricCurrent":{},"length":{},"luminousIntensity":{},"mass":{},"temperature":{},"time":{}},"unit":{"1ToRatio":{"unitSystem":"Metric","parentUnits":{"ratioTo1":-1},"symbols":{"1Colon":{"text":"1:","placement":"Prefix","space":false}}},"acres":{"unitSystem":"Imperial","factor":4840,"parentUnits":{"squareYards":1},"symbols":{"acres":{"text":"acres","placement":"Suffix","space":true}}},"ampereHours":{"unitSystem":"Metric","parentUnits":{"amperes":1,"hours":1},"symbols":{"aDashH":{"text":"A-h","placement":"Suffix","space":true}}},"ampereSeconds":{"unitSystem":"Metric","parentUnits":{"amperes":1,"seconds":1},"symbols":{"aDashS":{"text":"A-s","placement":"Suffix","space":true}}},"amperes":{"unitSystem":"Metric","dimension":"electricCurrent","symbols":{"ampere":{"text":"A","placement":"Suffix","space":true}}},"atmospheres":{"unitSystem":"Imperial","factor":101325,"parentUnits":{"pascals":1},"symbols":{"atm":{"text":"atm","placement":"Suffix","space":true}}},"bars":{"unitSystem":"Metric","factor":100,"parentUnits":{"kilopascals":1},"symbols":{"bar":{"text":"bar","placement":"Suffix","space":true}}},"britishThermalUnits":{"unitSystem":"Imperial","factor":1055.05585262,"parentUnits":{"joules":1},"symbols":{"btu":{"text":"Btu","placement":"Suffix","space":true}}},"britishThermalUnitsPerDegreeFahrenheit":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnits":1,"fahrenheitInterval":-1},"symbols":{"btuPerDegreeF":{"text":"BTU/F","placement":"Suffix","space":true}}},"britishThermalUnitsPerHour":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnits":1,"hours":-1},"symbols":{"btuPerH":{"text":"Btu/h","placement":"Suffix","space":true}}},"britishThermalUnitsPerHourCubicFoot":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnitsPerHour":1,"cubicFeet":-1},"symbols":{"btuPerHFtSup3":{"text":"Btu/(hft)","placement":"Suffix","space":true}}},"britishThermalUnitsPerHourFootDegreeFahrenheit":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnitsPerHour":1,"feet":-1,"fahrenheitInterval":-1},"symbols":{"btuPerHFtDegreeF":{"text":"BTU/(hftF)","placement":"Suffix","space":true}}},"britishThermalUnitsPerHourSquareFoot":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnitsPerHour":1,"squareFeet":-1},"symbols":{"btuPerHFtSup2":{"text":"Btu/(hft)","placement":"Suffix","space":true}}},"britishThermalUnitsPerHourSquareFootDegreeFahrenheit":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnitsPerHourSquareFoot":1,"fahrenheitInterval":-1},"symbols":{"btuPerHFtSup2DegreeF":{"text":"BTU/(hftF)","placement":"Suffix","space":true}}},"britishThermalUnitsPerPound":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnits":1,"poundsMass":-1},"symbols":{"btuPerLb":{"text":"BTU/lb","placement":"Suffix","space":true}}},"britishThermalUnitsPerPoundDegreeFahrenheit":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnitsPerPound":1,"fahrenheitInterval":-1},"symbols":{"btuPerLbDegreeF":{"text":"BTU/(lbF)","placement":"Suffix","space":true}}},"britishThermalUnitsPerSecond":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnits":1,"seconds":-1},"symbols":{"btuPerS":{"text":"Btu/s","placement":"Suffix","space":true}}},"britishThermalUnitsPerSquareFootDegreeFahrenheit":{"unitSystem":"Imperial","parentUnits":{"britishThermalUnits":1,"squareFeet":-1,"fahrenheitInterval":-1},"symbols":{"btuPerFtSup2DegreeF":{"text":"BTU/(ftF)","placement":"Suffix","space":true}}},"calories":{"unitSystem":"Metric","factor":4.1868,"parentUnits":{"joules":1},"symbols":{"cal":{"text":"cal","placement":"Suffix","space":true}}},"caloriesPerSecond":{"unitSystem":"Metric","parentUnits":{"calories":1,"seconds":-1},"symbols":{"calPerS":{"text":"cal/s","placement":"Suffix","space":true}}},"candelas":{"unitSystem":"Metric","dimension":"luminousIntensity","symbols":{"cd":{"text":"cd","placement":"Suffix","space":true}}},"candelasPerSquareFoot":{"unitSystem":"Imperial","parentUnits":{"candelas":1,"squareFeet":-1},"symbols":{"cdPerFtSup2":{"text":"cd/ft","placement":"Suffix","space":true}}},"candelasPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"candelas":1,"squareMeters":-1},"symbols":{"cdPerMSup2":{"text":"cd/m","placement":"Suffix","space":true}}},"celsius":{"unitSystem":"Metric","parentUnit":"celsiusInterval","offset":273.15,"symbols":{"degreeC":{"text":"C","placement":"Suffix","space":true}}},"celsiusInterval":{"unitSystem":"Metric","parentUnits":{"kelvinInterval":1},"symbols":{"degreeCInterval":{"text":"C","placement":"Suffix","space":true},"deltaDegreeC":{"text":"deltaC","placement":"Suffix","space":true}}},"centimeters":{"unitSystem":"Metric","parentFactors":{"centi":1},"parentUnits":{"meters":1},"symbols":{"cm":{"text":"cm","placement":"Suffix","space":true}}},"centimetersPerMinute":{"unitSystem":"Metric","parentUnits":{"centimeters":1,"minutes":-1},"symbols":{"cmPerMin":{"text":"cm/min","placement":"Suffix","space":true}}},"centimetersToTheFourthPower":{"unitSystem":"Metric","parentUnits":{"centimeters":4},"symbols":{"cmSup4":{"text":"cm","placement":"Suffix","space":true}}},"centimetersToTheSixthPower":{"unitSystem":"Metric","parentUnits":{"centimeters":6},"symbols":{"cmSup6":{"text":"cm","placement":"Suffix","space":true}}},"centipoises":{"unitSystem":"Metric","parentFactors":{"centi":1},"parentUnits":{"poises":1},"symbols":{"cP":{"text":"cP","placement":"Suffix","space":true}}},"circularMils":{"unitSystem":"Imperial","factor":0.25,"parentFactors":{"pi":1},"parentUnits":{"squareMils":1},"symbols":{"cMil":{"text":"cmil","placement":"Suffix","space":true}}},"coulombs":{"unitSystem":"Metric","parentUnits":{"ampereSeconds":1},"symbols":{"coulomb":{"text":"C","placement":"Suffix","space":true}}},"cubicCentimeters":{"defaultSymbol":"cmSup3","unitSystem":"Metric","parentUnits":{"centimeters":3},"symbols":{"cmCaret3":{"text":"cm^3","placement":"Suffix","space":true},"cmSup3":{"text":"cm","placement":"Suffix","space":true}}},"cubicFeet":{"defaultSymbol":"ftSup3","unitSystem":"Imperial","parentUnits":{"feet":3},"symbols":{"cf":{"text":"CF","placement":"Suffix","space":true},"ftCaret3":{"text":"ft^3","placement":"Suffix","space":true},"ftSup3":{"text":"ft","placement":"Suffix","space":true}}},"cubicFeetPerHour":{"defaultSymbol":"ftSup3PerHour","unitSystem":"Imperial","parentUnits":{"cubicFeet":1,"hours":-1},"symbols":{"cfh":{"text":"CFH","placement":"Suffix","space":true},"ftSup3PerH":{"text":"ft/h","placement":"Suffix","space":true}}},"cubicFeetPerKip":{"unitSystem":"Imperial","parentUnits":{"cubicFeet":1,"kips":-1},"symbols":{"ftSup3PerKip":{"text":"ft/kip","placement":"Suffix","space":true}}},"cubicFeetPerMinute":{"defaultSymbol":"ftSup3PerMin","unitSystem":"Imperial","parentUnits":{"cubicFeet":1,"minutes":-1},"symbols":{"cfm":{"text":"CFM","placement":"Suffix","space":true},"ftSup3PerMin":{"text":"ft/min","placement":"Suffix","space":true}}},"cubicFeetPerMinuteCubicFoot":{"defaultSymbol":"cfmPerFtSup3","unitSystem":"Imperial","parentUnits":{"cubicFeetPerMinute":1,"cubicFeet":-1},"symbols":{"cfmPerCf":{"text":"CFM/CF","placement":"Suffix","space":true},"cfmPerFtSup3":{"text":"CFM/ft","placement":"Suffix","space":true}}},"cubicFeetPerMinutePerBritishThermalUnitPerHour":{"unitSystem":"Imperial","parentUnits":{"cubicFeetPerMinute":1,"britishThermalUnitsPerHour":-1},"symbols":{"ftSup3HPerMinBtu":{"text":"fth/(minBtu)","placement":"Suffix","space":true}}},"cubicFeetPerMinuteSquareFoot":{"defaultSymbol":"cfmPerFtSup2","unitSystem":"Imperial","parentUnits":{"cubicFeetPerMinute":1,"squareFeet":-1},"symbols":{"cfmPerFtSup2":{"text":"CFM/ft","placement":"Suffix","space":true},"cfmPerSf":{"text":"CFM/SF","placement":"Suffix","space":true}}},"cubicFeetPerMinuteSquareMeter":{"unitSystem":"Metric","parentUnits":{"cubicFeetPerMinute":1,"squareMeters":-1}},"cubicFeetPerMinuteTonOfRefrigeration":{"unitSystem":"Imperial","parentUnits":{"cubicFeetPerMinute":1,"tonsOfRefrigeration":-1},"symbols":{"cfmPerTon":{"text":"CFM/ton","placement":"Suffix","space":true}}},"cubicFeetPerPoundMass":{"unitSystem":"Imperial","parentUnits":{"cubicFeet":1,"poundsMass":-1},"symbols":{"ftSup3PerLbMass":{"text":"ft/lb","placement":"Suffix","space":true}}},"cubicInches":{"defaultSymbol":"inSup3","unitSystem":"Imperial","parentUnits":{"inches":3},"symbols":{"inCaret3":{"text":"in^3","placement":"Suffix","space":true},"inSup3":{"text":"in","placement":"Suffix","space":true}}},"cubicMeters":{"defaultSymbol":"mSup3","unitSystem":"Metric","parentUnits":{"meters":3},"symbols":{"mCaret3":{"text":"m^3","placement":"Suffix","space":true},"mSup3":{"text":"m","placement":"Suffix","space":true}}},"cubicMetersPerHour":{"defaultSymbol":"mSup3PerH","unitSystem":"Metric","parentUnits":{"cubicMeters":1,"hours":-1},"symbols":{"cmh":{"text":"CMH","placement":"Suffix","space":true},"mSup3PerH":{"text":"m/h","placement":"Suffix","space":true}}},"cubicMetersPerHourCubicMeter":{"unitSystem":"Metric","parentUnits":{"cubicMetersPerHour":1,"cubicMeters":-1},"symbols":{"mSup3PerHMSup3":{"text":"m/(hm)","placement":"Suffix","space":true}}},"cubicMetersPerHourSquareMeter":{"unitSystem":"Metric","parentUnits":{"cubicMetersPerHour":1,"squareMeters":-1},"symbols":{"mSup3PerHMSup2":{"text":"m/(hm)","placement":"Suffix","space":true}}},"cubicMetersPerKilogram":{"unitSystem":"Metric","parentUnits":{"cubicMeters":1,"kilograms":-1},"symbols":{"mSup3PerKg":{"text":"m/kg","placement":"Suffix","space":true}}},"cubicMetersPerKilonewton":{"unitSystem":"Metric","parentUnits":{"cubicMeters":1,"kilonewtons":-1},"symbols":{"mSup3PerKN":{"text":"m/kN","placement":"Suffix","space":true}}},"cubicMetersPerSecond":{"defaultSymbol":"mSup3PerS","unitSystem":"Metric","parentUnits":{"cubicMeters":1,"seconds":-1},"symbols":{"cms":{"text":"CMS","placement":"Suffix","space":true},"mSup3PerS":{"text":"m/s","placement":"Suffix","space":true}}},"cubicMetersPerWattSecond":{"unitSystem":"Metric","parentUnits":{"cubicMeters":1,"watts":-1,"seconds":-1},"symbols":{"mSup3PerWS":{"text":"m/(Ws)","placement":"Suffix","space":true}}},"cubicMillimeters":{"defaultSymbol":"mmSup3","unitSystem":"Metric","parentUnits":{"millimeters":3},"symbols":{"mmCaret3":{"text":"mm^3","placement":"Suffix","space":true},"mmSup3":{"text":"mm","placement":"Suffix","space":true}}},"cubicYards":{"unitSystem":"Imperial","parentUnits":{"yards":3},"symbols":{"cy":{"text":"CY","placement":"Suffix","space":true}}},"currency":{"defaultSymbol":"usDollar","unitSystem":"Imperial","dimension":"currency","symbols":{"baht":{"description":"Baht is the official currency of Thailand.","text":"","placement":"Prefix","space":false},"chineseHongKongDollar":{"description":"Hong Kong Dollar is the official currency of Hong Kong..","text":"HK$","placement":"Prefix","space":false},"dong":{"description":"Dong is the official currency of Vietnam.","text":"","placement":"Suffix","space":false},"euroPrefix":{"text":"","placement":"Prefix","space":false},"euroSuffix":{"text":"","placement":"Suffix","space":false},"krone":{"description":"Krone is the official currency of Denmark, Greenland, and the Faroe Islands.","text":"kr","placement":"Suffix","space":true},"shekel":{"description":"Shekel is the official currency of Israel.","text":"","placement":"Prefix","space":false},"ukPound":{"text":"","placement":"Prefix","space":false},"usDollar":{"text":"$","placement":"Prefix","space":false},"won":{"description":"Won is the official currency of South Korea.","text":"","placement":"Prefix","space":false},"yen":{"text":"","placement":"Prefix","space":false}}},"currencyPerBritishThermalUnit":{"unitSystem":"Imperial","parentUnits":{"currency":1,"britishThermalUnits":-1},"symbols":{"dollarPerBtu":{"text":"$/Btu","placement":"Suffix","space":true}}},"currencyPerBritishThermalUnitPerHour":{"unitSystem":"Imperial","parentUnits":{"currency":1,"britishThermalUnitsPerHour":-1},"symbols":{"dollarHPerBtu":{"text":"$h/Btu","placement":"Suffix","space":true}}},"currencyPerSquareFoot":{"unitSystem":"Imperial","parentUnits":{"currency":1,"squareFeet":-1},"symbols":{"dollarPerFtSup2":{"text":"$/ft","placement":"Suffix","space":true}}},"currencyPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"currency":1,"squareMeters":-1},"symbols":{"dollarPerMSup2":{"text":"$/m","placement":"Suffix","space":true}}},"currencyPerWatt":{"unitSystem":"Metric","parentUnits":{"currency":1,"watts":-1},"symbols":{"dollarPerW":{"text":"$/W","placement":"Suffix","space":true}}},"currencyPerWattHour":{"unitSystem":"Metric","parentUnits":{"currency":1,"watts":-1,"hours":-1},"symbols":{"dollarPerWH":{"text":"$/(Wh)","placement":"Suffix","space":true}}},"cyclesPerSecond":{"unitSystem":"Metric","parentUnits":{"seconds":-1},"symbols":{"cps":{"text":"cps","placement":"Suffix","space":true}}},"decimeters":{"unitSystem":"Metric","parentFactors":{"deci":1},"parentUnits":{"meters":1},"symbols":{"dm":{"text":"dm","placement":"Suffix","space":true}}},"degrees":{"defaultSymbol":"degree","unitSystem":"Metric","parentFactors":{"threeHundredSixty":-1},"parentUnits":{"turns":1},"symbols":{"degree":{"text":"","placement":"Suffix","space":false},"degreesMinutesSeconds":{"inherits":"symbol"}}},"dekanewtonMeters":{"unitSystem":"Metric","parentUnits":{"dekanewtons":1,"meters":1},"symbols":{"daNDashM":{"text":"daN-m","placement":"Suffix","space":true}}},"dekanewtonMetersPerMeter":{"unitSystem":"Metric","parentUnits":{"dekanewtonMeters":1,"meters":-1},"symbols":{"daNDashMPerM":{"text":"daN-m/m","placement":"Suffix","space":true}}},"dekanewtons":{"unitSystem":"Metric","parentFactors":{"deka":1},"parentUnits":{"newtons":1},"symbols":{"daN":{"text":"daN","placement":"Suffix","space":true}}},"dekanewtonsPerMeter":{"unitSystem":"Metric","parentUnits":{"dekanewtons":1,"meters":-1},"symbols":{"daNPerM":{"text":"daN/m","placement":"Suffix","space":true}}},"dekanewtonsPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"dekanewtons":1,"squareMeters":-1},"symbols":{"daNPerMSup2":{"text":"daN/m","placement":"Suffix","space":true}}},"dynes":{"unitSystem":"Metric","factor":10,"parentFactors":{"micro":1},"parentUnits":{"newtons":1},"symbols":{"dyn":{"text":"dyn","placement":"Suffix","space":true}}},"ergs":{"unitSystem":"Metric","parentFactors":{"ten":-7},"parentUnits":{"joules":1},"symbols":{"erg":{"text":"erg","placement":"Suffix","space":true}}},"fahrenheit":{"unitSystem":"Imperial","parentUnit":"fahrenheitInterval","offset":459.67,"symbols":{"degreeF":{"text":"F","placement":"Suffix","space":true}}},"fahrenheitInterval":{"defaultSymbol":"degreeFInterval","unitSystem":"Imperial","parentUnits":{"rankineInterval":1},"symbols":{"degreeFInterval":{"text":"F","placement":"Suffix","space":true},"deltaDegreeF":{"text":"deltaF","placement":"Suffix","space":true}}},"farads":{"unitSystem":"Metric","parentUnits":{"coulombs":1,"volts":-1},"symbols":{"farad":{"text":"F","placement":"Suffix","space":true}}},"feet":{"defaultSymbol":"feetAndInches","unitSystem":"Imperial","factor":12,"parentUnits":{"inches":1},"symbols":{"feetAndInches":{"inherits":"symbol"},"footSingleQuote":{"text":"\'","placement":"Suffix","space":false},"ft":{"text":"ft","placement":"Suffix","space":true},"lf":{"text":"LF","placement":"Suffix","space":true}}},"feetOfWater39.2DegreesFahrenheit":{"defaultSymbol":"feetOfWater","unitSystem":"Imperial","factor":2988.98,"parentUnits":{"pascals":1},"symbols":{"feetOfWater":{"text":"Feet","placement":"Suffix","space":true},"ftH2O":{"text":"ftH2O","placement":"Suffix","space":true},"ftOfWater":{"text":"FT","placement":"Suffix","space":true}}},"feetOfWater39.2DegreesFahrenheitPer100Feet":{"defaultSymbol":"feetOfWaterPer100ft","unitSystem":"Imperial","factor":0.01,"parentUnits":{"feetOfWater39.2DegreesFahrenheit":1,"feet":-1},"symbols":{"feetOfWaterPer100ft":{"text":"Feet/100ft","placement":"Suffix","space":true},"ftH2OPer100ft":{"text":"ftH2O/100ft","placement":"Suffix","space":true},"ftOfWaterPer100ft":{"text":"FT/100ft","placement":"Suffix","space":true}}},"feetPerKip":{"unitSystem":"Imperial","parentUnits":{"feet":1,"kips":-1},"symbols":{"ftPerKip":{"text":"ft/kip","placement":"Suffix","space":true}}},"feetPerKipFoot":{"unitSystem":"Imperial","parentUnits":{"feet":1,"kipFeet":-1},"symbols":{"ftPerKipDashFt":{"text":"ft/kip-ft","placement":"Suffix","space":true}}},"feetPerMinute":{"defaultSymbol":"fpm","unitSystem":"Imperial","parentUnits":{"feet":1,"minutes":-1},"symbols":{"fpm":{"text":"FPM","placement":"Suffix","space":true},"ftPerMin":{"text":"ft/min","placement":"Suffix","space":true}}},"feetPerSecond":{"defaultSymbol":"fps","unitSystem":"Imperial","parentUnits":{"feet":1,"seconds":-1},"symbols":{"fps":{"text":"FPS","placement":"Suffix","space":true},"ftPerS":{"text":"ft/s","placement":"Suffix","space":true}}},"feetPerSecondSquared":{"unitSystem":"Imperial","parentUnits":{"feetPerSecond":1,"seconds":-1},"symbols":{"ftPerSSup2":{"text":"ft/s","placement":"Suffix","space":true}}},"feetToTheFourthPower":{"unitSystem":"Imperial","parentUnits":{"feet":4},"symbols":{"ftSup4":{"text":"ft","placement":"Suffix","space":true}}},"feetToTheSixthPower":{"unitSystem":"Imperial","parentUnits":{"feet":6},"symbols":{"ftSup6":{"text":"ft","placement":"Suffix","space":true}}},"fixed":{"unitSystem":"Metric","parentUnits":{"ratioTo1":1}},"footcandles":{"defaultSymbol":"fc","unitSystem":"Imperial","parentUnits":{"lumens":1,"squareFeet":-1},"symbols":{"fc":{"text":"fc","placement":"Suffix","space":true},"ftc":{"text":"Ftc","placement":"Suffix","space":true}}},"footlamberts":{"defaultSymbol":"fL","unitSystem":"Imperial","parentFactors":{"pi":-1},"parentUnits":{"candelas":1,"squareFeet":-1},"symbols":{"fL":{"text":"fL","placement":"Suffix","space":true},"flLowercase":{"text":"fl","placement":"Suffix","space":true},"ftL":{"text":"ftL","placement":"Suffix","space":true}}},"gammas":{"unitSystem":"Metric","parentFactors":{"nano":1},"parentUnits":{"teslas":1},"symbols":{"gamma":{"text":"gamma","placement":"Suffix","space":true}}},"gauss":{"unitSystem":"Metric","parentFactors":{"ten":-4},"parentUnits":{"teslas":1},"symbols":{"gs":{"text":"Gs","placement":"Suffix","space":true}}},"general":{"unitSystem":"Metric","parentUnits":{"ratioTo1":1}},"gigajoules":{"unitSystem":"Metric","parentFactors":{"giga":1},"parentUnits":{"joules":1}},"gradians":{"unitSystem":"Metric","factor":0.9,"parentUnits":{"degrees":1},"symbols":{"grad":{"text":"grad","placement":"Suffix","space":true}}},"grains":{"unitSystem":"Imperial","factor":64.79891,"parentUnits":{"milligrams":1},"symbols":{"gr":{"text":"gr","placement":"Suffix","space":true}}},"grainsPerHourSquareFootInchMercury":{"unitSystem":"Imperial","parentUnits":{"grains":1,"hours":-1,"squareFeet":-1,"inchesOfMercury32DegreesFahrenheit":-1},"symbols":{"grPerHFtSup2InHg":{"text":"gr/(hftinHg)","placement":"Suffix","space":true}}},"grams":{"unitSystem":"Metric","factor":0.001,"parentUnits":{"kilograms":1},"symbols":{"gram":{"text":"g","placement":"Suffix","space":true}}},"hectares":{"unitSystem":"Metric","parentUnits":{"squareHectometers":1},"symbols":{"hectare":{"text":"hectare","placement":"Suffix","space":true}}},"hectometers":{"unitSystem":"Metric","parentFactors":{"hecto":1},"parentUnits":{"meters":1},"symbols":{"hm":{"text":"hm","placement":"Suffix","space":true}}},"henries":{"unitSystem":"Metric","parentUnits":{"ohms":1,"seconds":1},"symbols":{"henry":{"text":"H","placement":"Suffix","space":true}}},"hertz":{"unitSystem":"Metric","parentUnits":{"cyclesPerSecond":1},"symbols":{"hz":{"text":"Hz","placement":"Suffix","space":true}}},"horsepower":{"unitSystem":"Imperial","factor":33000,"parentUnits":{"poundForceFeet":1,"minutes":-1},"symbols":{"hp":{"text":"hp","placement":"Suffix","space":true}}},"hourSquareFootDegreesFahrenheitPerBritishThermalUnit":{"unitSystem":"Imperial","parentUnits":{"hours":1,"squareFeet":1,"fahrenheitInterval":1,"britishThermalUnits":-1},"symbols":{"hFtSup2DegreeFPerBtu":{"text":"(hftF)/BTU","placement":"Suffix","space":true}}},"hours":{"unitSystem":"Metric","factor":60,"parentUnits":{"minutes":1},"symbols":{"hour":{"text":"h","placement":"Suffix","space":true}}},"inches":{"defaultSymbol":"in","unitSystem":"Imperial","factor":2.54,"parentUnits":{"centimeters":1},"symbols":{"in":{"text":"in","placement":"Suffix","space":true},"inchDoubleQuote":{"text":"\\"","placement":"Suffix","space":false}}},"inchesOfMercury32DegreesFahrenheit":{"unitSystem":"Imperial","factor":3386.389,"parentUnits":{"pascals":1},"symbols":{"inHg":{"text":"inHg","placement":"Suffix","space":true}}},"inchesOfWater60DegreesFahrenheit":{"unitSystem":"Imperial","factor":248.84,"parentUnits":{"pascals":1},"symbols":{"inDashWg":{"text":"in-wg","placement":"Suffix","space":true}}},"inchesOfWater60DegreesFahrenheitPer100Feet":{"unitSystem":"Imperial","factor":0.01,"parentUnits":{"inchesOfWater60DegreesFahrenheit":1,"feet":-1},"symbols":{"inDashWgPer100ft":{"text":"in-wg/100ft","placement":"Suffix","space":true}}},"inchesPerSecond":{"unitSystem":"Imperial","parentUnits":{"inches":1,"seconds":-1},"symbols":{"inPerS":{"text":"in/s","placement":"Suffix","space":true}}},"inchesPerSecondSquared":{"unitSystem":"Imperial","parentUnits":{"inchesPerSecond":1,"seconds":-1},"symbols":{"inPerSSup2":{"text":"in/s","placement":"Suffix","space":true}}},"inchesToTheFourthPower":{"unitSystem":"Imperial","parentUnits":{"inches":4},"symbols":{"inSup4":{"text":"in","placement":"Suffix","space":true}}},"inchesToTheSixthPower":{"unitSystem":"Imperial","parentUnits":{"inches":6},"symbols":{"inSup6":{"text":"in","placement":"Suffix","space":true}}},"inverseDegreesCelsius":{"unitSystem":"Metric","parentUnits":{"celsiusInterval":-1},"symbols":{"invDegreeC":{"text":"1/C","placement":"Suffix","space":true}}},"inverseDegreesFahrenheit":{"unitSystem":"Imperial","parentUnits":{"fahrenheitInterval":-1},"symbols":{"invDegreeF":{"text":"1/F","placement":"Suffix","space":true}}},"inverseKilonewtons":{"unitSystem":"Metric","parentUnits":{"kilonewtons":-1},"symbols":{"invKN":{"text":"1/kN","placement":"Suffix","space":true}}},"inverseKips":{"unitSystem":"Imperial","parentUnits":{"kips":-1},"symbols":{"invKip":{"text":"1/kip","placement":"Suffix","space":true}}},"joules":{"unitSystem":"Metric","parentUnits":{"newtonMeters":1},"symbols":{"joule":{"text":"J","placement":"Suffix","space":true}}},"joulesPerGram":{"unitSystem":"Metric","parentUnits":{"joules":1,"grams":-1},"symbols":{"jPerG":{"text":"J/g","placement":"Suffix","space":true}}},"joulesPerGramDegreeCelsius":{"unitSystem":"Metric","parentUnits":{"joulesPerGram":1,"celsiusInterval":-1},"symbols":{"jPerGDegreeC":{"text":"J/(gC)","placement":"Suffix","space":true}}},"joulesPerKelvin":{"unitSystem":"Metric","parentUnits":{"joules":1,"kelvinInterval":-1},"symbols":{"jPerK":{"text":"J/K","placement":"Suffix","space":true}}},"joulesPerKilogram":{"unitSystem":"Metric","parentUnits":{"joules":1,"kilograms":-1},"symbols":{"jPerKg":{"text":"J/kg","placement":"Suffix","space":true}}},"joulesPerKilogramDegreeCelsius":{"unitSystem":"Metric","parentUnits":{"joulesPerKilogram":1,"celsiusInterval":-1},"symbols":{"jPerKgDegreeC":{"text":"J/(kgC)","placement":"Suffix","space":true}}},"joulesPerSquareMeterKelvin":{"unitSystem":"Metric","parentUnits":{"joules":1,"squareMeters":-1,"kelvinInterval":-1},"symbols":{"jPerMSup2K":{"text":"J/(mK)","placement":"Suffix","space":true}}},"kelvin":{"unitSystem":"Metric","parentUnit":"kelvinInterval","symbols":{"kelvin":{"text":"K","placement":"Suffix","space":true}}},"kelvinInterval":{"defaultSymbol":"deltaK","unitSystem":"Metric","dimension":"temperature","symbols":{"deltaK":{"text":"deltaK","placement":"Suffix","space":true},"kelvinInterval":{"text":"K","placement":"Suffix","space":true}}},"kiloamperes":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"amperes":1},"symbols":{"kA":{"text":"kA","placement":"Suffix","space":true}}},"kilocalories":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"calories":1},"symbols":{"kcal":{"text":"kcal","placement":"Suffix","space":true}}},"kilocaloriesPerSecond":{"unitSystem":"Metric","parentUnits":{"kilocalories":1,"seconds":-1},"symbols":{"kcalPerS":{"text":"kcal/s","placement":"Suffix","space":true}}},"kilogramForceMeters":{"unitSystem":"Metric","parentUnits":{"kilogramsForce":1,"meters":1},"symbols":{"kgfDashM":{"text":"kgf-m","placement":"Suffix","space":true}}},"kilogramForceMetersPerMeter":{"unitSystem":"Metric","parentUnits":{"kilogramForceMeters":1,"meters":-1},"symbols":{"kgfDashMPerM":{"text":"kgf-m/m","placement":"Suffix","space":true}}},"kilogramKelvins":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"kelvinInterval":1},"symbols":{"kgK":{"text":"kgK","placement":"Suffix","space":true}}},"kilograms":{"unitSystem":"Metric","dimension":"mass","symbols":{"kg":{"text":"kg","placement":"Suffix","space":true}}},"kilogramsForce":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"standardGravity":1},"symbols":{"kgf":{"text":"kgf","placement":"Suffix","space":true}}},"kilogramsForcePerMeter":{"unitSystem":"Metric","parentUnits":{"kilogramsForce":1,"meters":-1},"symbols":{"kgfPerM":{"text":"kgf/m","placement":"Suffix","space":true}}},"kilogramsForcePerSquareMeter":{"unitSystem":"Metric","parentUnits":{"kilogramsForce":1,"squareMeters":-1},"symbols":{"kgfPerMSup2":{"text":"kgf/m","placement":"Suffix","space":true}}},"kilogramsPerCubicCentimeter":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"cubicCentimeters":-1}},"kilogramsPerCubicMeter":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"cubicMeters":-1},"symbols":{"kgPerMSup3":{"text":"kg/m","placement":"Suffix","space":true}}},"kilogramsPerHour":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"hours":-1},"symbols":{"kgPerH":{"text":"kg/h","placement":"Suffix","space":true}}},"kilogramsPerKilogramKelvin":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"kilogramKelvins":-1},"symbols":{"kgPerKgK":{"text":"kg/(kgK)","placement":"Suffix","space":true}}},"kilogramsPerMeter":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"meters":-1},"symbols":{"kgPerM":{"text":"kg/m","placement":"Suffix","space":true}}},"kilogramsPerMeterHour":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"meters":-1,"hours":-1},"symbols":{"kgPerMH":{"text":"kg/(mh)","placement":"Suffix","space":true}}},"kilogramsPerMeterSecond":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"meters":-1,"seconds":-1},"symbols":{"kgPerMS":{"text":"kg/(ms)","placement":"Suffix","space":true}}},"kilogramsPerMinute":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"minutes":-1},"symbols":{"kgPerMin":{"text":"kg/min","placement":"Suffix","space":true}}},"kilogramsPerSecond":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"seconds":-1},"symbols":{"kgPerS":{"text":"kg/s","placement":"Suffix","space":true}}},"kilogramsPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"squareMeters":-1},"symbols":{"kgPerMSup2":{"text":"kg/m","placement":"Suffix","space":true}}},"kilojoules":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"joules":1},"symbols":{"kJ":{"text":"kJ","placement":"Suffix","space":true}}},"kilojoulesPerKelvin":{"unitSystem":"Metric","parentUnits":{"kilojoules":1,"kelvinInterval":-1},"symbols":{"kJPerK":{"text":"kJ/K","placement":"Suffix","space":true}}},"kilojoulesPerSquareMeterKelvin":{"unitSystem":"Metric","parentUnits":{"kilojoules":1,"squareMeters":-1,"kelvinInterval":-1},"symbols":{"kJPerMSup2K":{"text":"kJ/(mK)","placement":"Suffix","space":true}}},"kilometers":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"meters":1},"symbols":{"km":{"text":"km","placement":"Suffix","space":true}}},"kilometersPerHour":{"unitSystem":"Metric","parentUnits":{"kilometers":1,"hours":-1},"symbols":{"kmPerH":{"text":"km/h","placement":"Suffix","space":true}}},"kilometersPerSecond":{"unitSystem":"Metric","parentUnits":{"kilometers":1,"seconds":-1},"symbols":{"kmPerS":{"text":"km/s","placement":"Suffix","space":true}}},"kilometersPerSecondSquared":{"unitSystem":"Metric","parentUnits":{"kilometersPerSecond":1,"seconds":-1},"symbols":{"kmPerSSup2":{"text":"km/s","placement":"Suffix","space":true}}},"kilonewtonMeters":{"unitSystem":"Metric","parentUnits":{"kilonewtons":1,"meters":1},"symbols":{"kNDashM":{"text":"kN-m","placement":"Suffix","space":true}}},"kilonewtonMetersPerDegree":{"unitSystem":"Metric","parentUnits":{"kilonewtonMeters":1,"degrees":-1},"symbols":{"kNDashMPerDegree":{"text":"kN-m/","placement":"Suffix","space":true}}},"kilonewtonMetersPerDegreePerMeter":{"unitSystem":"Metric","parentUnits":{"kilonewtonMetersPerDegree":1,"meters":-1},"symbols":{"kNDashMPerDegreePerM":{"text":"kN-m//m","placement":"Suffix","space":true}}},"kilonewtonMetersPerMeter":{"unitSystem":"Metric","parentUnits":{"kilonewtonMeters":1,"meters":-1},"symbols":{"kNDashMPerM":{"text":"kN-m/m","placement":"Suffix","space":true}}},"kilonewtons":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"newtons":1},"symbols":{"kN":{"text":"kN","placement":"Suffix","space":true}}},"kilonewtonsPerCubicMeter":{"unitSystem":"Metric","parentUnits":{"kilonewtons":1,"cubicMeters":-1},"symbols":{"kNPerMSup3":{"text":"kN/m","placement":"Suffix","space":true}}},"kilonewtonsPerMeter":{"unitSystem":"Metric","parentUnits":{"kilonewtons":1,"meters":-1},"symbols":{"kNPerM":{"text":"kN/m","placement":"Suffix","space":true}}},"kilonewtonsPerSquareCentimeter":{"unitSystem":"Metric","parentUnits":{"kilonewtons":1,"squareCentimeters":-1},"symbols":{"kNPerCmSup2":{"text":"kN/cm","placement":"Suffix","space":true}}},"kilonewtonsPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"kilonewtons":1,"squareMeters":-1},"symbols":{"kNPerMSup2":{"text":"kN/m","placement":"Suffix","space":true}}},"kilonewtonsPerSquareMillimeter":{"unitSystem":"Metric","parentUnits":{"kilonewtons":1,"squareMillimeters":-1},"symbols":{"kNPerMmSup2":{"text":"kN/mm","placement":"Suffix","space":true}}},"kilopascals":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"pascals":1},"symbols":{"kPa":{"text":"kPa","placement":"Suffix","space":true}}},"kilovoltAmperes":{"unitSystem":"Metric","parentUnits":{"kilovolts":1,"amperes":1},"symbols":{"kVA":{"text":"kVA","placement":"Suffix","space":true}}},"kilovolts":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"volts":1},"symbols":{"kV":{"text":"kV","placement":"Suffix","space":true}}},"kilowattHours":{"unitSystem":"Metric","parentUnits":{"kilowatts":1,"hours":1},"symbols":{"kWh":{"text":"kWh","placement":"Suffix","space":true}}},"kilowattHoursPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"kilowattHours":1,"squareMeters":-1},"symbols":{"kWhPerMSup2":{"text":"kWh/m","placement":"Suffix","space":true}}},"kilowatts":{"unitSystem":"Metric","parentFactors":{"kilo":1},"parentUnits":{"watts":1},"symbols":{"kW":{"text":"kW","placement":"Suffix","space":true}}},"kipFeet":{"unitSystem":"Imperial","parentUnits":{"kips":1,"feet":1},"symbols":{"kipDashFt":{"text":"kip-ft","placement":"Suffix","space":true}}},"kipFeetPerDegree":{"unitSystem":"Imperial","parentUnits":{"kipFeet":1,"degrees":-1},"symbols":{"kipDashFtPerDegree":{"text":"kip-ft/","placement":"Suffix","space":true}}},"kipFeetPerDegreePerFoot":{"unitSystem":"Imperial","parentUnits":{"kipFeetPerDegree":1,"feet":-1},"symbols":{"kipDashFtPerDegreePerFt":{"text":"kip-ft//ft","placement":"Suffix","space":true}}},"kipFeetPerFoot":{"unitSystem":"Imperial","parentUnits":{"kipFeet":1,"feet":-1},"symbols":{"kipDashFtPerFt":{"text":"kip-ft/ft","placement":"Suffix","space":true}}},"kips":{"unitSystem":"Imperial","parentFactors":{"kilo":1},"parentUnits":{"poundsForce":1},"symbols":{"kip":{"text":"kip","placement":"Suffix","space":true}}},"kipsPerCubicFoot":{"unitSystem":"Imperial","parentUnits":{"kips":1,"cubicFeet":-1},"symbols":{"kipPerFtSup3":{"text":"kip/ft","placement":"Suffix","space":true}}},"kipsPerCubicInch":{"unitSystem":"Imperial","parentUnits":{"kips":1,"cubicInches":-1},"symbols":{"kipPerInSup3":{"text":"kip/in","placement":"Suffix","space":true}}},"kipsPerFoot":{"unitSystem":"Imperial","parentUnits":{"kips":1,"feet":-1},"symbols":{"kipPerFt":{"text":"kip/ft","placement":"Suffix","space":true}}},"kipsPerInch":{"unitSystem":"Imperial","parentUnits":{"kips":1,"inches":-1},"symbols":{"kipPerIn":{"text":"kip/in","placement":"Suffix","space":true}}},"kipsPerSquareFoot":{"defaultSymbol":"kipPerFtSup2","unitSystem":"Imperial","parentUnits":{"kips":1,"squareFeet":-1},"symbols":{"kipPerFtSup2":{"text":"kip/ft","placement":"Suffix","space":true},"ksf":{"text":"ksf","placement":"Suffix","space":true}}},"kipsPerSquareInch":{"defaultSymbol":"kipPerInSup2","unitSystem":"Imperial","parentUnits":{"kips":1,"squareInches":-1},"symbols":{"kipPerInSup2":{"text":"kip/in","placement":"Suffix","space":true},"ksi":{"text":"ksi","placement":"Suffix","space":true}}},"liters":{"unitSystem":"Metric","parentUnits":{"decimeters":3},"symbols":{"liter":{"text":"L","placement":"Suffix","space":true}}},"litersPerHour":{"unitSystem":"Metric","parentUnits":{"liters":1,"hours":-1},"symbols":{"lPerH":{"text":"L/h","placement":"Suffix","space":true}}},"litersPerMinute":{"defaultSymbol":"lPerMin","unitSystem":"Metric","parentUnits":{"liters":1,"minutes":-1},"symbols":{"lPerMin":{"text":"L/min","placement":"Suffix","space":true},"lpm":{"text":"LPM","placement":"Suffix","space":true}}},"litersPerSecond":{"defaultSymbol":"lPerS","unitSystem":"Metric","parentUnits":{"liters":1,"seconds":-1},"symbols":{"lPerS":{"text":"L/s","placement":"Suffix","space":true},"lps":{"text":"LPS","placement":"Suffix","space":true}}},"litersPerSecondCubicMeter":{"unitSystem":"Metric","parentUnits":{"litersPerSecond":1,"cubicMeters":-1},"symbols":{"lPerSMSup3":{"text":"L/(sm)","placement":"Suffix","space":true}}},"litersPerSecondKilowatt":{"unitSystem":"Metric","parentUnits":{"litersPerSecond":1,"kilowatts":-1},"symbols":{"lPerSKw":{"text":"L/(skW)","placement":"Suffix","space":true}}},"litersPerSecondSquareMeter":{"defaultSymbol":"lPerSMSup2","unitSystem":"Metric","parentUnits":{"litersPerSecond":1,"squareMeters":-1},"symbols":{"lPerSMSup2":{"text":"L/(sm)","placement":"Suffix","space":true},"lpsPerMSup2":{"text":"LPS/m","placement":"Suffix","space":true}}},"lumens":{"unitSystem":"Metric","parentUnits":{"candelas":1,"steradians":1},"symbols":{"lm":{"text":"lm","placement":"Suffix","space":true}}},"lumensPerWatt":{"unitSystem":"Metric","parentUnits":{"lumens":1,"watts":-1},"symbols":{"lmPerW":{"text":"lm/W","placement":"Suffix","space":true}}},"lux":{"unitSystem":"Metric","parentUnits":{"lumens":1,"squareMeters":-1},"symbols":{"lx":{"text":"lx","placement":"Suffix","space":true}}},"maxwells":{"unitSystem":"Metric","parentFactors":{"ten":-8},"parentUnits":{"webers":1},"symbols":{"mx":{"text":"Mx","placement":"Suffix","space":true}}},"megajoules":{"unitSystem":"Metric","parentFactors":{"mega":1},"parentUnits":{"joules":1}},"megajoulesPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"megajoules":1,"squareMeters":-1}},"meganewtonMeters":{"unitSystem":"Metric","parentUnits":{"meganewtons":1,"meters":1},"symbols":{"mNDashM":{"text":"MN-m","placement":"Suffix","space":true}}},"meganewtonMetersPerMeter":{"unitSystem":"Metric","parentUnits":{"meganewtonMeters":1,"meters":-1},"symbols":{"mNDashMPerM":{"text":"MN-m/m","placement":"Suffix","space":true}}},"meganewtons":{"unitSystem":"Metric","parentFactors":{"mega":1},"parentUnits":{"newtons":1},"symbols":{"mN":{"text":"MN","placement":"Suffix","space":true}}},"meganewtonsPerMeter":{"unitSystem":"Metric","parentUnits":{"meganewtons":1,"meters":-1},"symbols":{"mNPerM":{"text":"MN/m","placement":"Suffix","space":true}}},"meganewtonsPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"meganewtons":1,"squareMeters":-1},"symbols":{"mNPerMSup2":{"text":"MN/m","placement":"Suffix","space":true}}},"megapascals":{"unitSystem":"Metric","parentFactors":{"mega":1},"parentUnits":{"pascals":1},"symbols":{"mPa":{"text":"MPa","placement":"Suffix","space":true}}},"megawattHours":{"unitSystem":"Metric","parentUnits":{"megawatts":1,"hours":1},"symbols":{"mWh":{"text":"mWh","placement":"Suffix","space":true}}},"megawatts":{"unitSystem":"Metric","parentFactors":{"mega":1},"parentUnits":{"watts":1}},"meters":{"defaultSymbol":"meter","unitSystem":"Metric","dimension":"length","symbols":{"meter":{"text":"m","placement":"Suffix","space":true},"metersAndCentimeters":{"inherits":"symbol"}}},"metersOfWaterColumn":{"unitSystem":"Metric","parentUnits":{"meters":1,"standardGravity":1,"waterDensity4DegreesCelsius":1},"symbols":{"mH2O":{"text":"mH2O","placement":"Suffix","space":true}}},"metersOfWaterColumnPerMeter":{"unitSystem":"Metric","parentUnits":{"metersOfWaterColumn":1,"meters":-1},"symbols":{"mH2OPerM":{"text":"mH2O/m","placement":"Suffix","space":true}}},"metersPerKilonewton":{"unitSystem":"Metric","parentUnits":{"meters":1,"kilonewtons":-1},"symbols":{"mPerKN":{"text":"m/kN","placement":"Suffix","space":true}}},"metersPerKilonewtonMeter":{"unitSystem":"Metric","parentUnits":{"meters":1,"kilonewtonMeters":-1},"symbols":{"mPerKNDashM":{"text":"m/kN-m","placement":"Suffix","space":true}}},"metersPerSecond":{"unitSystem":"Metric","parentUnits":{"meters":1,"seconds":-1},"symbols":{"mPerS":{"text":"m/s","placement":"Suffix","space":true}}},"metersPerSecondSquared":{"unitSystem":"Metric","parentUnits":{"metersPerSecond":1,"seconds":-1},"symbols":{"mPerSSup2":{"text":"m/s","placement":"Suffix","space":true}}},"metersToTheFourthPower":{"unitSystem":"Metric","parentUnits":{"meters":4},"symbols":{"mSup4":{"text":"m","placement":"Suffix","space":true}}},"metersToTheSixthPower":{"unitSystem":"Metric","parentUnits":{"meters":6},"symbols":{"mSup6":{"text":"m","placement":"Suffix","space":true}}},"mhos":{"unitSystem":"Metric","parentUnits":{"ohms":-1},"symbols":{"mho":{"text":"mho","placement":"Suffix","space":true}}},"microinches":{"unitSystem":"Imperial","parentFactors":{"micro":1},"parentUnits":{"inches":1},"symbols":{"uin":{"text":"in","placement":"Suffix","space":true}}},"microinchesPerInchDegreeFahrenheit":{"unitSystem":"Imperial","parentFactors":{"micro":1},"parentUnits":{"inverseDegreesFahrenheit":1},"symbols":{"uinPerInDegreeF":{"text":"in/(inF)","placement":"Suffix","space":true}}},"micrometersPerMeterDegreeCelsius":{"unitSystem":"Metric","parentFactors":{"micro":1},"parentUnits":{"inverseDegreesCelsius":1},"symbols":{"umPerMDegreeC":{"text":"m/(mC)","placement":"Suffix","space":true}}},"microns":{"unitSystem":"Metric","parentFactors":{"micro":1},"parentUnits":{"meters":1},"symbols":{"micron":{"text":"micron","placement":"Suffix","space":true}}},"miles":{"unitSystem":"Imperial","factor":1760,"parentUnits":{"yards":1},"symbols":{"mi":{"text":"mi","placement":"Suffix","space":true}}},"milesPerHour":{"unitSystem":"Imperial","parentUnits":{"miles":1,"hours":-1},"symbols":{"mph":{"text":"mph","placement":"Suffix","space":true}}},"milesPerSecond":{"unitSystem":"Imperial","parentUnits":{"miles":1,"seconds":-1},"symbols":{"miPerS":{"text":"mi/s","placement":"Suffix","space":true}}},"milesPerSecondSquared":{"unitSystem":"Imperial","parentUnits":{"milesPerSecond":1,"seconds":-1},"symbols":{"miPerSSup2":{"text":"mi/s","placement":"Suffix","space":true}}},"milliamperes":{"unitSystem":"Metric","parentFactors":{"milli":1},"parentUnits":{"amperes":1},"symbols":{"mA":{"text":"mA","placement":"Suffix","space":true}}},"milligrams":{"unitSystem":"Metric","parentFactors":{"milli":1},"parentUnits":{"grams":1},"symbols":{"mg":{"text":"mg","placement":"Suffix","space":true}}},"millimeters":{"unitSystem":"Metric","parentFactors":{"milli":1},"parentUnits":{"meters":1},"symbols":{"mm":{"text":"mm","placement":"Suffix","space":true}}},"millimetersOfMercury":{"unitSystem":"Metric","factor":133.3224,"parentUnits":{"pascals":1},"symbols":{"mmHg":{"text":"mmHg","placement":"Suffix","space":true}}},"millimetersOfWaterColumn":{"unitSystem":"Metric","parentFactors":{"milli":1},"parentUnits":{"metersOfWaterColumn":1},"symbols":{"mmH2O":{"text":"mmH2O","placement":"Suffix","space":true}}},"millimetersOfWaterColumnPerMeter":{"unitSystem":"Metric","parentUnits":{"millimetersOfWaterColumn":1,"meters":-1},"symbols":{"mmH2OPerM":{"text":"mmH2O/m","placement":"Suffix","space":true}}},"millimetersToTheFourthPower":{"unitSystem":"Metric","parentUnits":{"millimeters":4},"symbols":{"mmSup4":{"text":"mm","placement":"Suffix","space":true}}},"millimetersToTheSixthPower":{"unitSystem":"Metric","parentUnits":{"millimeters":6},"symbols":{"mmSup6":{"text":"mm","placement":"Suffix","space":true}}},"milliseconds":{"unitSystem":"Metric","parentFactors":{"milli":1},"parentUnits":{"seconds":1},"symbols":{"ms":{"text":"ms","placement":"Suffix","space":true}}},"millivolts":{"unitSystem":"Metric","parentFactors":{"milli":1},"parentUnits":{"volts":1},"symbols":{"mV":{"text":"mV","placement":"Suffix","space":true}}},"mils":{"unitSystem":"Imperial","parentFactors":{"milli":1},"parentUnits":{"inches":1},"symbols":{"mil":{"text":"mil","placement":"Suffix","space":true}}},"minutes":{"unitSystem":"Metric","factor":60,"parentUnits":{"seconds":1},"symbols":{"min":{"text":"min","placement":"Suffix","space":true}}},"nanograms":{"unitSystem":"Metric","parentFactors":{"nano":1},"parentUnits":{"grams":1},"symbols":{"ng":{"text":"ng","placement":"Suffix","space":true}}},"nanogramsPerPascalSecondSquareMeter":{"unitSystem":"Metric","parentUnits":{"nanograms":1,"seconds":-1,"squareMeters":-1,"pascals":-1},"symbols":{"ngPerPaSMSup2":{"text":"ng/(Pasm)","placement":"Suffix","space":true}}},"nanometers":{"unitSystem":"Metric","parentFactors":{"nano":1},"parentUnits":{"meters":1},"symbols":{"nm":{"text":"nm","placement":"Suffix","space":true}}},"nauticalMiles":{"unitSystem":"Imperial","factor":1852,"parentUnits":{"meters":1},"symbols":{"nauticalMile":{"text":"M","placement":"Suffix","space":true}}},"newtonMeters":{"unitSystem":"Metric","parentUnits":{"newtons":1,"meters":1},"symbols":{"nDashM":{"text":"N-m","placement":"Suffix","space":true}}},"newtonMetersPerMeter":{"unitSystem":"Metric","parentUnits":{"newtonMeters":1,"meters":-1},"symbols":{"nDashMPerM":{"text":"N-m/m","placement":"Suffix","space":true}}},"newtonSecondsPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"newtons":1,"seconds":1,"squareMeters":-1},"symbols":{"nSPerMSup2":{"text":"Ns/m","placement":"Suffix","space":true}}},"newtons":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"metersPerSecondSquared":1},"symbols":{"newton":{"text":"N","placement":"Suffix","space":true}}},"newtonsPerMeter":{"unitSystem":"Metric","parentUnits":{"newtons":1,"meters":-1},"symbols":{"nPerM":{"text":"N/m","placement":"Suffix","space":true}}},"newtonsPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"newtons":1,"squareMeters":-1},"symbols":{"nPerMSup2":{"text":"N/m","placement":"Suffix","space":true}}},"newtonsPerSquareMillimeter":{"unitSystem":"Metric","parentUnits":{"newtons":1,"squareMillimeters":-1},"symbols":{"nPerMmSup2":{"text":"N/mm","placement":"Suffix","space":true}}},"oersteds":{"unitSystem":"Metric","factor":250,"parentFactors":{"pi":-1},"parentUnits":{"amperes":1,"meters":-1},"symbols":{"oe":{"text":"Oe","placement":"Suffix","space":true}}},"ohmMeters":{"unitSystem":"Metric","parentUnits":{"ohms":1,"meters":1},"symbols":{"ohmM":{"text":"ohmm","placement":"Suffix","space":true}}},"ohms":{"defaultSymbol":"omega","unitSystem":"Metric","parentUnits":{"volts":1,"amperes":-1},"symbols":{"ohm":{"text":"ohm","placement":"Suffix","space":true},"omega":{"text":"","placement":"Suffix","space":true}}},"ouncesForce":{"unitSystem":"Imperial","factor":0.0625,"parentUnits":{"poundsForce":1},"symbols":{"ozf":{"text":"ozf","placement":"Suffix","space":true}}},"ouncesMass":{"unitSystem":"Imperial","factor":0.0625,"parentUnits":{"poundsMass":1},"symbols":{"oz":{"text":"oz","placement":"Suffix","space":true}}},"pascalSeconds":{"unitSystem":"Metric","parentUnits":{"pascals":1,"seconds":1},"symbols":{"paDashS":{"text":"Pa-s","placement":"Suffix","space":true}}},"pascals":{"unitSystem":"Metric","parentUnits":{"newtonsPerSquareMeter":1},"symbols":{"pa":{"text":"Pa","placement":"Suffix","space":true}}},"pascalsPerMeter":{"unitSystem":"Metric","parentUnits":{"pascals":1,"meters":-1},"symbols":{"paPerM":{"text":"Pa/m","placement":"Suffix","space":true}}},"perMille":{"unitSystem":"Metric","parentFactors":{"milli":1},"parentUnits":{"ratioTo1":1},"symbols":{"perMille":{"text":"","placement":"Suffix","space":false}}},"percentage":{"unitSystem":"Metric","parentFactors":{"centi":1},"parentUnits":{"ratioTo1":1},"symbols":{"percent":{"text":"%","placement":"Suffix","space":false}}},"pi":{"unitSystem":"Imperial","parentFactors":{"pi":1},"parentUnits":{"radians":1},"symbols":{"pi":{"text":"","placement":"Suffix","space":true}}},"poises":{"unitSystem":"Metric","parentUnits":{"grams":1,"centimeters":-1,"seconds":-1},"symbols":{"poise":{"text":"P","placement":"Suffix","space":true}}},"poundForceFeet":{"defaultSymbol":"lbForceDashFt","unitSystem":"Imperial","parentUnits":{"poundsForce":1,"feet":1},"symbols":{"lbForceDashFt":{"text":"lb-ft","placement":"Suffix","space":true},"lbfDashFt":{"text":"lbf-ft","placement":"Suffix","space":true}}},"poundForceFeetPerFoot":{"defaultSymbol":"lbForceDashFtPerFt","unitSystem":"Imperial","parentUnits":{"poundForceFeet":1,"feet":-1},"symbols":{"lbForceDashFtPerFt":{"text":"lb-ft/ft","placement":"Suffix","space":true},"lbfDashFtPerFt":{"text":"lbf-ft/ft","placement":"Suffix","space":true}}},"poundForceSecondsPerSquareFoot":{"unitSystem":"Imperial","parentUnits":{"poundsForce":1,"seconds":1,"squareFeet":-1},"symbols":{"lbForceSPerFtSup2":{"text":"lbs/ft","placement":"Suffix","space":true}}},"poundMassDegreesFahrenheit":{"unitSystem":"Imperial","parentUnits":{"poundsMass":1,"fahrenheitInterval":1},"symbols":{"lbMassDegreeF":{"text":"lbF","placement":"Suffix","space":true}}},"poundsForce":{"defaultSymbol":"lbForce","unitSystem":"Imperial","parentUnits":{"poundsMass":1,"standardGravity":1},"symbols":{"lbForce":{"text":"lb","placement":"Suffix","space":true},"lbf":{"text":"lbf","placement":"Suffix","space":true}}},"poundsForcePerCubicFoot":{"defaultSymbol":"lbForcePerFtSup3","unitSystem":"Imperial","parentUnits":{"poundsForce":1,"cubicFeet":-1},"symbols":{"lbForcePerFtSup3":{"text":"lb/ft","placement":"Suffix","space":true},"lbfPerFtSup3":{"text":"lbf/ft","placement":"Suffix","space":true}}},"poundsForcePerFoot":{"defaultSymbol":"lbForcePerFt","unitSystem":"Imperial","parentUnits":{"poundsForce":1,"feet":-1},"symbols":{"lbForcePerFt":{"text":"lb/ft","placement":"Suffix","space":true},"lbfPerFt":{"text":"lbf/ft","placement":"Suffix","space":true}}},"poundsForcePerSquareFoot":{"defaultSymbol":"lbForcePerFtSup2","unitSystem":"Imperial","parentUnits":{"poundsForce":1,"squareFeet":-1},"symbols":{"lbForcePerFtSup2":{"text":"lb/ft","placement":"Suffix","space":true},"lbfPerFtSup2":{"text":"lbf/ft","placement":"Suffix","space":true},"psf":{"text":"psf","placement":"Suffix","space":true}}},"poundsForcePerSquareInch":{"defaultSymbol":"lbForcePerInSup2","unitSystem":"Imperial","parentUnits":{"poundsForce":1,"squareInches":-1},"symbols":{"lbForcePerInSup2":{"text":"lb/in","placement":"Suffix","space":true},"lbfPerInSup2":{"text":"lbf/in","placement":"Suffix","space":true},"psi":{"text":"psi","placement":"Suffix","space":true},"psia":{"text":"psia","placement":"Suffix","space":true},"psig":{"text":"psig","placement":"Suffix","space":true}}},"poundsMass":{"defaultSymbol":"lbMass","unitSystem":"Imperial","factor":0.45359237,"parentUnits":{"kilograms":1},"symbols":{"lbMass":{"text":"lb","placement":"Suffix","space":true},"lbm":{"text":"lbm","placement":"Suffix","space":true}}},"poundsMassPerCubicFoot":{"defaultSymbol":"lbMassPerFtSup3","unitSystem":"Imperial","parentUnits":{"poundsMass":1,"cubicFeet":-1},"symbols":{"lbMassPerFtSup3":{"text":"lb/ft","placement":"Suffix","space":true},"lbmPerFtSup3":{"text":"lbm/ft","placement":"Suffix","space":true}}},"poundsMassPerCubicInch":{"defaultSymbol":"lbMassPerInSup3","unitSystem":"Imperial","parentUnits":{"poundsMass":1,"cubicInches":-1},"symbols":{"lbMassPerInSup3":{"text":"lb/in","placement":"Suffix","space":true},"lbmPerInSup3":{"text":"lbm/in","placement":"Suffix","space":true}}},"poundsMassPerFoot":{"defaultSymbol":"lbMassPerFt","unitSystem":"Imperial","parentUnits":{"poundsMass":1,"feet":-1},"symbols":{"lbMassPerFt":{"text":"lb/ft","placement":"Suffix","space":true},"lbmPerFt":{"text":"lbm/ft","placement":"Suffix","space":true}}},"poundsMassPerFootHour":{"defaultSymbol":"lbMassPerFtDashH","unitSystem":"Imperial","parentUnits":{"poundsMassPerFoot":1,"hours":-1},"symbols":{"lbMassPerFtDashH":{"text":"lb/ft-h","placement":"Suffix","space":true},"lbmPerFtDashH":{"text":"lbm/ft-h","placement":"Suffix","space":true}}},"poundsMassPerFootSecond":{"defaultSymbol":"lbMassPerFtDashS","unitSystem":"Imperial","parentUnits":{"poundsMassPerFoot":1,"seconds":-1},"symbols":{"lbMassPerFtDashS":{"text":"lb/ft-s","placement":"Suffix","space":true},"lbmPerFtDashS":{"text":"lbm/ft-s","placement":"Suffix","space":true}}},"poundsMassPerHour":{"unitSystem":"Imperial","parentUnits":{"poundsMass":1,"hours":-1},"symbols":{"lbMassPerH":{"text":"lb/h","placement":"Suffix","space":true}}},"poundsMassPerMinute":{"unitSystem":"Imperial","parentUnits":{"poundsMass":1,"minutes":-1},"symbols":{"lbMassPerMin":{"text":"lb/min","placement":"Suffix","space":true}}},"poundsMassPerPoundDegreeFahrenheit":{"unitSystem":"Imperial","parentUnits":{"poundsMass":1,"poundMassDegreesFahrenheit":-1},"symbols":{"lbMassPerLbDegreeF":{"text":"lb/(lbF)","placement":"Suffix","space":true}}},"poundsMassPerSecond":{"unitSystem":"Imperial","parentUnits":{"poundsMass":1,"seconds":-1},"symbols":{"lbMassPerS":{"text":"lb/s","placement":"Suffix","space":true}}},"poundsMassPerSquareFoot":{"unitSystem":"Imperial","parentUnits":{"poundsMass":1,"squareFeet":-1},"symbols":{"lbMassPerFtSup2":{"text":"lb/ft","placement":"Suffix","space":true}}},"radians":{"unitSystem":"Metric","symbols":{"rad":{"text":"rad","placement":"Suffix","space":true}}},"radiansPerSecond":{"unitSystem":"Metric","parentUnits":{"radians":1,"seconds":-1},"symbols":{"radPerS":{"text":"rad/s","placement":"Suffix","space":true}}},"rankine":{"unitSystem":"Imperial","parentUnit":"rankineInterval","symbols":{"degreeR":{"text":"R","placement":"Suffix","space":true}}},"rankineInterval":{"defaultSymbol":"degreeRInterval","unitSystem":"Imperial","parentFactors":{"nineFifths":-1},"parentUnits":{"kelvinInterval":1},"symbols":{"degreeRInterval":{"text":"R","placement":"Suffix","space":true},"deltaDegreeR":{"text":"deltaR","placement":"Suffix","space":true}}},"ratioTo1":{"unitSystem":"Metric","symbols":{"colon1":{"text":":1","placement":"Suffix","space":false}}},"ratioTo10":{"unitSystem":"Metric","parentFactors":{"ten":-1},"parentUnits":{"ratioTo1":1},"symbols":{"colon10":{"text":":10","placement":"Suffix","space":false}}},"ratioTo12":{"unitSystem":"Imperial","parentFactors":{"twelve":-1},"parentUnits":{"ratioTo1":1},"symbols":{"colon12":{"text":":12","placement":"Suffix","space":false}}},"revolutionsPerMinute":{"unitSystem":"Imperial","parentUnits":{"turns":1,"minutes":-1},"symbols":{"rpm":{"text":"RPM","placement":"Suffix","space":true}}},"revolutionsPerSecond":{"unitSystem":"Metric","parentUnits":{"turns":1,"seconds":-1},"symbols":{"rps":{"text":"RPS","placement":"Suffix","space":true}}},"riseDividedBy1000Millimeters":{"unitSystem":"Metric","parentUnits":{"perMille":1}},"riseDividedBy10Feet":{"unitSystem":"Imperial","parentUnits":{"ratioTo10":1}},"riseDividedBy120Inches":{"unitSystem":"Imperial","parentFactors":{"ten":-1},"parentUnits":{"riseDividedBy12Inches":1}},"riseDividedBy12Inches":{"unitSystem":"Imperial","parentUnits":{"ratioTo12":1}},"riseDividedBy1Foot":{"unitSystem":"Imperial","parentUnits":{"ratioTo1":1}},"seconds":{"unitSystem":"Metric","dimension":"time","symbols":{"second":{"text":"s","placement":"Suffix","space":true}}},"siemens":{"unitSystem":"Metric","parentUnits":{"mhos":1},"symbols":{"siemens":{"text":"S","placement":"Suffix","space":true}}},"slugs":{"unitSystem":"Imperial","parentUnits":{"poundsForce":1,"seconds":2,"feet":-1},"symbols":{"slug":{"text":"slug","placement":"Suffix","space":true}}},"squareCentimeters":{"defaultSymbol":"cmSup2","unitSystem":"Metric","parentUnits":{"centimeters":2},"symbols":{"cmCaret2":{"text":"cm^2","placement":"Suffix","space":true},"cmSup2":{"text":"cm","placement":"Suffix","space":true}}},"squareCentimetersPerMeter":{"unitSystem":"Metric","parentUnits":{"squareCentimeters":1,"meters":-1},"symbols":{"cmSup2PerM":{"text":"cm/m","placement":"Suffix","space":true}}},"squareFeet":{"defaultSymbol":"ftSup2","unitSystem":"Imperial","parentUnits":{"feet":2},"symbols":{"ftCaret2":{"text":"ft^2","placement":"Suffix","space":true},"ftSup2":{"text":"ft","placement":"Suffix","space":true},"sf":{"text":"SF","placement":"Suffix","space":true}}},"squareFeetPer1000BritishThermalUnitsPerHour":{"defaultSymbol":"ftSup2HPerKbtu","unitSystem":"Imperial","factor":0.001,"parentUnits":{"squareFeet":1,"britishThermalUnitsPerHour":-1},"symbols":{"ftSup2HPerKbtu":{"text":"fth/kBtu","placement":"Suffix","space":true},"ftSup2PerMbh":{"text":"ft/MBh","placement":"Suffix","space":true},"sfHPerKbtu":{"text":"SFh/kBtu","placement":"Suffix","space":true},"sfPerMbh":{"text":"SF/MBh","placement":"Suffix","space":true}}},"squareFeetPerFoot":{"unitSystem":"Imperial","parentUnits":{"squareFeet":1,"feet":-1},"symbols":{"ftSup2PerFt":{"text":"ft/ft","placement":"Suffix","space":true}}},"squareFeetPerKip":{"unitSystem":"Imperial","parentUnits":{"squareFeet":1,"kips":-1},"symbols":{"ftSup2PerKip":{"text":"ft/kip","placement":"Suffix","space":true}}},"squareFeetPerKipFoot":{"unitSystem":"Imperial","parentUnits":{"squareFeet":1,"kipFeet":-1},"symbols":{"ftSup2PerKipDashFt":{"text":"ft/kip-ft","placement":"Suffix","space":true}}},"squareFeetPerSecond":{"unitSystem":"Imperial","parentUnits":{"squareFeet":1,"seconds":-1},"symbols":{"ftSup2PerS":{"text":"ft/s","placement":"Suffix","space":true}}},"squareFeetPerTonOfRefrigeration":{"defaultSymbol":"ftSup2PerTon","unitSystem":"Imperial","parentUnits":{"squareFeet":1,"tonsOfRefrigeration":-1},"symbols":{"ftSup2PerTon":{"text":"ft/ton","placement":"Suffix","space":true},"sfPerTon":{"text":"SF/ton","placement":"Suffix","space":true}}},"squareHectometers":{"unitSystem":"Metric","parentUnits":{"hectometers":2},"symbols":{"hmSup2":{"text":"hm","placement":"Suffix","space":true}}},"squareInches":{"defaultSymbol":"inSup2","unitSystem":"Imperial","parentUnits":{"inches":2},"symbols":{"inCaret2":{"text":"in^2","placement":"Suffix","space":true},"inSup2":{"text":"in","placement":"Suffix","space":true}}},"squareInchesPerFoot":{"unitSystem":"Imperial","parentUnits":{"squareInches":1,"feet":-1},"symbols":{"inSup2PerFt":{"text":"in/ft","placement":"Suffix","space":true}}},"squareMeterKelvinsPerWatt":{"unitSystem":"Metric","parentUnits":{"squareMeters":1,"kelvinInterval":1,"watts":-1},"symbols":{"mSup2KPerW":{"text":"(mK)/W","placement":"Suffix","space":true}}},"squareMeters":{"defaultSymbol":"mSup2","unitSystem":"Metric","parentUnits":{"meters":2},"symbols":{"mCaret2":{"text":"m^2","placement":"Suffix","space":true},"mSup2":{"text":"m","placement":"Suffix","space":true}}},"squareMetersPerKilonewton":{"unitSystem":"Metric","parentUnits":{"squareMeters":1,"kilonewtons":-1},"symbols":{"mSup2PerKN":{"text":"m/kN","placement":"Suffix","space":true}}},"squareMetersPerKilonewtonMeter":{"unitSystem":"Metric","parentUnits":{"squareMeters":1,"kilonewtonMeters":-1},"symbols":{"mSup2PerKNDashM":{"text":"m/kN-m","placement":"Suffix","space":true}}},"squareMetersPerKilowatt":{"unitSystem":"Metric","parentUnits":{"squareMeters":1,"kilowatts":-1},"symbols":{"mSup2PerKw":{"text":"m/kW","placement":"Suffix","space":true}}},"squareMetersPerMeter":{"unitSystem":"Metric","parentUnits":{"squareMeters":1,"meters":-1},"symbols":{"mSup2PerM":{"text":"m/m","placement":"Suffix","space":true}}},"squareMetersPerSecond":{"unitSystem":"Metric","parentUnits":{"squareMeters":1,"seconds":-1},"symbols":{"mSup2PerS":{"text":"m/s","placement":"Suffix","space":true}}},"squareMillimeters":{"defaultSymbol":"mmSup2","unitSystem":"Metric","parentUnits":{"millimeters":2},"symbols":{"mmCaret2":{"text":"mm^2","placement":"Suffix","space":true},"mmSup2":{"text":"mm","placement":"Suffix","space":true}}},"squareMillimetersPerMeter":{"unitSystem":"Metric","parentUnits":{"squareMillimeters":1,"meters":-1},"symbols":{"mmSup2PerM":{"text":"mm/m","placement":"Suffix","space":true}}},"squareMils":{"defaultSymbol":"milSup2","unitSystem":"Imperial","parentUnits":{"mils":2},"symbols":{"milCaret2":{"text":"mil^2","placement":"Suffix","space":true},"milSup2":{"text":"mil","placement":"Suffix","space":true}}},"squareYards":{"unitSystem":"Imperial","parentUnits":{"yards":2},"symbols":{"ydSup2":{"text":"yd","placement":"Suffix","space":true}}},"standardGravity":{"unitSystem":"Metric","factor":9.80665,"parentUnits":{"metersPerSecondSquared":1},"symbols":{"gravity":{"text":"","placement":"Suffix","space":true}}},"steradians":{"unitSystem":"Metric","symbols":{"sr":{"text":"sr","placement":"Suffix","space":true}}},"teslas":{"unitSystem":"Metric","parentUnits":{"webers":1,"meters":-2},"symbols":{"tesla":{"text":"T","placement":"Suffix","space":true}}},"therms":{"unitSystem":"Imperial","factor":100000,"parentUnits":{"britishThermalUnits":1},"symbols":{"therm":{"text":"therm","placement":"Suffix","space":true}}},"thousandBritishThermalUnits":{"unitSystem":"Imperial","parentFactors":{"kilo":1},"parentUnits":{"britishThermalUnits":1},"symbols":{"kBtu":{"text":"kBtu","placement":"Suffix","space":true}}},"thousandBritishThermalUnitsPerHour":{"unitSystem":"Imperial","factor":1000,"parentUnits":{"britishThermalUnitsPerHour":1},"symbols":{"mbh":{"text":"MBH","placement":"Suffix","space":true}}},"thousandBritishThermalUnitsPerSquareFoot":{"unitSystem":"Imperial","parentUnits":{"thousandBritishThermalUnits":1,"squareFeet":-1},"symbols":{"kBtuPerFtSup2":{"text":"kBtu/ft","placement":"Suffix","space":true}}},"tonneForceMeters":{"unitSystem":"Metric","parentUnits":{"tonnesForce":1,"meters":1},"symbols":{"tfDashM":{"text":"Tf-m","placement":"Suffix","space":true}}},"tonneForceMetersPerMeter":{"unitSystem":"Metric","parentUnits":{"tonneForceMeters":1,"meters":-1},"symbols":{"tfDashMPerM":{"text":"Tf-m/m","placement":"Suffix","space":true}}},"tonnes":{"unitSystem":"Metric","factor":1000,"parentUnits":{"kilograms":1},"symbols":{"tonne":{"text":"t","placement":"Suffix","space":true}}},"tonnesForce":{"unitSystem":"Metric","parentUnits":{"tonnes":1,"standardGravity":1},"symbols":{"tf":{"text":"Tf","placement":"Suffix","space":true}}},"tonnesForcePerMeter":{"unitSystem":"Metric","parentUnits":{"tonnesForce":1,"meters":-1},"symbols":{"tfPerM":{"text":"Tf/m","placement":"Suffix","space":true}}},"tonnesForcePerSquareMeter":{"unitSystem":"Metric","parentUnits":{"tonnesForce":1,"squareMeters":-1},"symbols":{"tfPerMSup2":{"text":"Tf/m","placement":"Suffix","space":true}}},"tonsOfRefrigeration":{"defaultSymbol":"ton","unitSystem":"Imperial","factor":12000,"parentUnits":{"britishThermalUnitsPerHour":1},"symbols":{"ton":{"text":"ton","placement":"Suffix","space":true},"tonOfRefrigeration":{"text":"ton of refrigeration","placement":"Suffix","space":true}}},"turns":{"unitSystem":"Metric","factor":2,"parentFactors":{"pi":1},"parentUnits":{"radians":1},"symbols":{"tr":{"text":"tr","placement":"Suffix","space":true}}},"usGallons":{"unitSystem":"Imperial","factor":231,"parentUnits":{"cubicInches":1},"symbols":{"gal":{"text":"gal","placement":"Suffix","space":true}}},"usGallonsPerHour":{"defaultSymbol":"galPerH","unitSystem":"Imperial","parentUnits":{"usGallons":1,"hours":-1},"symbols":{"galPerH":{"text":"gal/h","placement":"Suffix","space":true},"gph":{"text":"GPH","placement":"Suffix","space":true},"usgph":{"text":"usgph","placement":"Suffix","space":true}}},"usGallonsPerMinute":{"defaultSymbol":"galPerMin","unitSystem":"Imperial","parentUnits":{"usGallons":1,"minutes":-1},"symbols":{"galPerMin":{"text":"gal/min","placement":"Suffix","space":true},"gpm":{"text":"GPM","placement":"Suffix","space":true},"usgpm":{"text":"usgpm","placement":"Suffix","space":true}}},"usSurveyFeet":{"unitSystem":"Imperial","factor":1200,"parentFactors":{"threeThousandNineHundredThirtySeven":-1},"parentUnits":{"meters":1},"symbols":{"usft":{"text":"USft","placement":"Suffix","space":true}}},"usTonnesForce":{"defaultSymbol":"stf","unitSystem":"Imperial","parentUnits":{"usTonnesMass":1,"standardGravity":1},"symbols":{"stf":{"text":"STf","placement":"Suffix","space":true},"tonsf":{"text":"Tonsf","placement":"Suffix","space":true},"usTonnesForceSt":{"text":"ST","placement":"Suffix","space":true},"usTonnesForceT":{"text":"T","placement":"Suffix","space":true},"usTonnesForceTons":{"text":"Tons","placement":"Suffix","space":true}}},"usTonnesMass":{"defaultSymbol":"usTonnesMassSt","unitSystem":"Imperial","factor":2000,"parentUnits":{"poundsMass":1},"symbols":{"usTonnesMassSt":{"text":"ST","placement":"Suffix","space":true},"usTonnesMassT":{"text":"T","placement":"Suffix","space":true},"usTonnesMassTons":{"text":"Tons","placement":"Suffix","space":true}}},"voltAmperes":{"unitSystem":"Metric","parentUnits":{"volts":1,"amperes":1},"symbols":{"vA":{"text":"VA","placement":"Suffix","space":true}}},"voltAmperesPerSquareFoot":{"unitSystem":"Imperial","parentUnits":{"voltAmperes":1,"squareFeet":-1},"symbols":{"vAPerFtSup2":{"text":"VA/ft","placement":"Suffix","space":true}}},"voltAmperesPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"voltAmperes":1,"squareMeters":-1},"symbols":{"vAPerMSup2":{"text":"VA/m","placement":"Suffix","space":true}}},"volts":{"unitSystem":"Metric","parentUnits":{"watts":1,"amperes":-1},"symbols":{"volt":{"text":"V","placement":"Suffix","space":true}}},"waterDensity4DegreesCelsius":{"unitSystem":"Metric","parentUnits":{"kilograms":1,"liters":-1}},"watts":{"unitSystem":"Metric","parentUnits":{"joules":1,"seconds":-1},"symbols":{"watt":{"text":"W","placement":"Suffix","space":true}}},"wattsPerCubicFoot":{"unitSystem":"Imperial","parentUnits":{"watts":1,"cubicFeet":-1},"symbols":{"wPerFtSup3":{"text":"W/ft","placement":"Suffix","space":true}}},"wattsPerCubicFootPerMinute":{"unitSystem":"Imperial","parentUnits":{"watts":1,"cubicFeetPerMinute":-1},"symbols":{"wMinPerFtSup3":{"text":"Wmin/ft","placement":"Suffix","space":true}}},"wattsPerCubicMeter":{"unitSystem":"Metric","parentUnits":{"watts":1,"cubicMeters":-1},"symbols":{"wPerMSup3":{"text":"W/m","placement":"Suffix","space":true}}},"wattsPerCubicMeterPerSecond":{"unitSystem":"Metric","parentUnits":{"watts":1,"cubicMetersPerSecond":-1},"symbols":{"wSPerMSup3":{"text":"Ws/m","placement":"Suffix","space":true}}},"wattsPerFoot":{"unitSystem":"Imperial","parentUnits":{"watts":1,"feet":-1},"symbols":{"wPerFt":{"text":"W/ft","placement":"Suffix","space":true}}},"wattsPerMeter":{"unitSystem":"Metric","parentUnits":{"watts":1,"meters":-1},"symbols":{"wPerM":{"text":"W/m","placement":"Suffix","space":true}}},"wattsPerMeterKelvin":{"unitSystem":"Metric","parentUnits":{"watts":1,"meters":-1,"kelvinInterval":-1},"symbols":{"wPerMK":{"text":"W/(mK)","placement":"Suffix","space":true}}},"wattsPerSquareFoot":{"unitSystem":"Imperial","parentUnits":{"watts":1,"squareFeet":-1},"symbols":{"wPerFtSup2":{"text":"W/ft","placement":"Suffix","space":true}}},"wattsPerSquareMeter":{"unitSystem":"Metric","parentUnits":{"watts":1,"squareMeters":-1},"symbols":{"wPerMSup2":{"text":"W/m","placement":"Suffix","space":true}}},"wattsPerSquareMeterKelvin":{"unitSystem":"Metric","parentUnits":{"wattsPerSquareMeter":1,"kelvinInterval":-1},"symbols":{"wPerMSup2K":{"text":"W/(mK)","placement":"Suffix","space":true}}},"webers":{"unitSystem":"Metric","parentUnits":{"volts":1,"seconds":1},"symbols":{"wb":{"text":"Wb","placement":"Suffix","space":true}}},"yards":{"unitSystem":"Imperial","factor":3,"parentUnits":{"feet":1},"symbols":{"yd":{"text":"yd","placement":"Suffix","space":true}}},"feetFractionalInches":{"defaultSymbol":"feetAndInches","unitSystem":"Imperial","factor":12,"parentUnits":{"inches":1},"symbols":{"feetAndInches":{"inherits":"symbol"},"footSingleQuote":{"text":"\'","placement":"Suffix","space":false},"ft":{"text":"ft","placement":"Suffix","space":true},"lf":{"text":"LF","placement":"Suffix","space":true}}},"fractionalInches":{"defaultSymbol":"in","unitSystem":"Imperial","factor":2.54,"parentUnits":{"centimeters":1},"symbols":{"in":{"text":"in","placement":"Suffix","space":true},"inchDoubleQuote":{"text":"\\"","placement":"Suffix","space":false}}},"metersCentimeters":{"defaultSymbol":"meter","unitSystem":"Metric","dimension":"length","symbols":{"meter":{"text":"m","placement":"Suffix","space":true},"metersAndCentimeters":{"inherits":"symbol"}}},"degreesMinutes":{"defaultSymbol":"degree","unitSystem":"Metric","parentFactors":{"threeHundredSixty":-1},"parentUnits":{"turns":1},"symbols":{"degree":{"text":"","placement":"Suffix","space":false},"degreesMinutesSeconds":{"inherits":"symbol"}}},"slopeDegrees":{"defaultSymbol":"slopeDegree","unitSystem":"Metric","parentFactors":{"threeHundredSixty":-1},"parentUnits":{"turns":1},"symbols":{"slopeDegree":{"text":"","placement":"Suffix","space":false}}},"stationingFeet":{"defaultSymbol":"feetAndInches","unitSystem":"Imperial","factor":12,"parentUnits":{"inches":1},"symbols":{"feetAndInches":{"inherits":"symbol"},"footSingleQuote":{"text":"\'","placement":"Suffix","space":false},"ft":{"text":"ft","placement":"Suffix","space":true},"lf":{"text":"LF","placement":"Suffix","space":true}}},"stationingMeters":{"defaultSymbol":"meter","unitSystem":"Metric","dimension":"length","symbols":{"meter":{"text":"m","placement":"Suffix","space":true},"metersAndCentimeters":{"inherits":"symbol"}}},"stationingSurveyFeet":{"unitSystem":"Imperial","factor":1200,"parentFactors":{"threeThousandNineHundredThirtySeven":-1},"parentUnits":{"meters":1},"symbols":{"usft":{"text":"USft","placement":"Suffix","space":true}}},"dateTime":{"symbols":{"date":{"text":"Date"},"dateTime":{"text":"ISODate","description":"default"},"dateAndTime":{"text":"Date, Time"}}}},"quantity":{"acceleration":{"units":["metersPerSecondSquared","kilometersPerSecondSquared","inchesPerSecondSquared","feetPerSecondSquared","milesPerSecondSquared","standardGravity"]},"angle":{"units":["degrees","radians","gradians","turns"]},"angularLineSpringCoefficient":{"units":["kipFeetPerDegreePerFoot","kilonewtonMetersPerDegreePerMeter"]},"angularPointSpringCoefficient":{"units":["kipFeetPerDegree","kilonewtonMetersPerDegree"]},"angularSpeed":{"units":["radiansPerSecond","revolutionsPerMinute"]},"area":{"units":["squareFeet","squareInches","squareMeters","squareCentimeters","squareHectometers","squareMillimeters","acres","hectares","squareYards","circularMils","squareMils"]},"areaPerLength":{"units":["squareFeetPerFoot","squareCentimetersPerMeter","squareMillimetersPerMeter","squareInchesPerFoot","squareMetersPerMeter"]},"areaPerPower":{"units":["squareFeetPerTonOfRefrigeration","squareMetersPerKilowatt","squareFeetPer1000BritishThermalUnitsPerHour"]},"areaPerTorque":{"units":["squareFeetPerKipFoot","squareMetersPerKilonewtonMeter"]},"colorTemperature":{"units":["kelvin"]},"costPerArea":{"units":["currencyPerSquareFoot","currencyPerSquareMeter"]},"currency":{"units":["currency"]},"density":{"units":["kilogramsPerCubicMeter","poundsMassPerCubicInch","poundsMassPerCubicFoot"]},"diffusivity":{"units":["squareFeetPerSecond","squareMetersPerSecond"]},"dynamicViscosity":{"units":["centipoises","kilogramsPerMeterHour","kilogramsPerMeterSecond","newtonSecondsPerSquareMeter","pascalSeconds","poises","poundForceSecondsPerSquareFoot","poundsMassPerFootHour","poundsMassPerFootSecond"]},"electricCapacitance":{"units":["farads"]},"electricCharge":{"units":["coulombs","ampereHours","ampereSeconds"]},"electricConductance":{"units":["mhos","siemens"]},"electricCurrent":{"units":["amperes","kiloamperes","milliamperes"]},"electricInductance":{"units":["henries"]},"electricPotential":{"units":["volts","kilovolts","millivolts"]},"electricResistance":{"units":["ohms"]},"electricResistivity":{"units":["ohmMeters"]},"energy":{"units":["joules","newtonMeters","kilogramForceMeters","poundForceFeet","kilojoules","britishThermalUnits","calories","kilocalories","kilowattHours","therms","ergs"]},"flow":{"units":["cubicFeetPerMinute","cubicFeetPerHour","cubicMetersPerSecond","cubicMetersPerHour","litersPerHour","litersPerMinute","litersPerSecond","usGallonsPerMinute","usGallonsPerHour"]},"flowPerArea":{"units":["cubicFeetPerMinuteSquareFoot","litersPerSecondSquareMeter"]},"flowPerPower":{"units":["cubicFeetPerMinutePerBritishThermalUnitPerHour","cubicFeetPerMinuteTonOfRefrigeration","cubicMetersPerWattSecond","litersPerSecondKilowatt","squareFeetPerKip","squareMetersPerKilonewton"]},"flowPerVolume":{"units":["cubicFeetPerMinuteCubicFoot","litersPerSecondCubicMeter"]},"force":{"units":["newtons","dekanewtons","kilonewtons","meganewtons","kips","kilogramsForce","tonnesForce","usTonnesForce","poundsForce","dynes","ouncesForce"]},"forceDensity":{"units":["kilonewtonsPerCubicMeter","poundsForcePerCubicFoot","kipsPerCubicInch","kipsPerCubicFoot"]},"forcePerLength":{"units":["newtonsPerMeter","dekanewtonsPerMeter","kilonewtonsPerMeter","meganewtonsPerMeter","kipsPerFoot","kilogramsForcePerMeter","tonnesForcePerMeter","poundsForcePerFoot","kipsPerInch"]},"frequency":{"units":["hertz","cyclesPerSecond"]},"friction":{"units":["pascalsPerMeter","feetOfWater39.2DegreesFahrenheitPer100Feet","inchesOfWater60DegreesFahrenheitPer100Feet"]},"heatCapacity":{"units":["britishThermalUnitsPerDegreeFahrenheit","joulesPerKelvin","kilojoulesPerKelvin"]},"heatTransferCoefficient":{"units":["wattsPerSquareMeterKelvin","britishThermalUnitsPerHourSquareFootDegreeFahrenheit"]},"illuminance":{"units":["lux","footcandles"]},"length":{"units":["centimeters","decimeters","feet","hectometers","inches","kilometers","meters","microinches","microns","miles","millimeters","mils","nanometers","nauticalMiles","usSurveyFeet","yards"]},"lengthPerTorque":{"units":["metersPerKilonewtonMeter","feetPerKipFoot"]},"lightingEfficacy":{"units":["lumensPerWatt"]},"luminance":{"units":["footlamberts","candelasPerSquareFoot","candelasPerSquareMeter"]},"luminousFlux":{"units":["lumens"]},"luminousIntensity":{"units":["candelas"]},"magneticFieldStrength":{"units":["oersteds"]},"magneticFlux":{"units":["webers","maxwells"]},"magneticFluxDensity":{"units":["teslas","gauss","gammas"]},"mass":{"units":["kilograms","tonnes","poundsMass","grams","milligrams","nanograms","grains","usTonnesMass","slugs","ouncesMass"]},"massPerArea":{"units":["kilogramsPerSquareMeter","poundsMassPerSquareFoot"]},"massPerLength":{"units":["kilogramsPerMeter","poundsMassPerFoot"]},"massPerTime":{"units":["poundsMassPerHour","poundsMassPerMinute","poundsMassPerSecond","kilogramsPerHour","kilogramsPerMinute","kilogramsPerSecond"]},"number":{"units":["general","fixed","percentage"]},"permeability":{"units":["nanogramsPerPascalSecondSquareMeter","grainsPerHourSquareFootInchMercury"]},"power":{"units":["watts","kilowatts","britishThermalUnitsPerSecond","britishThermalUnitsPerHour","caloriesPerSecond","kilocaloriesPerSecond","voltAmperes","kilovoltAmperes","horsepower","thousandBritishThermalUnitsPerHour","tonsOfRefrigeration"]},"powerDensity":{"units":["wattsPerCubicFoot","wattsPerCubicMeter","britishThermalUnitsPerHourCubicFoot"]},"powerPerArea":{"units":["wattsPerSquareFoot","wattsPerSquareMeter","britishThermalUnitsPerHourSquareFoot"]},"powerPerFlow":{"units":["wattsPerCubicFootPerMinute","wattsPerCubicMeterPerSecond"]},"powerPerLength":{"units":["wattsPerFoot","wattsPerMeter"]},"pressure":{"units":["pascals","kilopascals","megapascals","poundsForcePerSquareInch","inchesOfMercury32DegreesFahrenheit","millimetersOfMercury","atmospheres","bars","feetOfWater39.2DegreesFahrenheit","inchesOfWater60DegreesFahrenheit"]},"ratio":{"units":["fixed","percentage","perMille","ratioTo1","ratioTo10","ratioTo12","1ToRatio"]},"secondMomentOfArea":{"units":["feetToTheFourthPower","inchesToTheFourthPower","millimetersToTheFourthPower","centimetersToTheFourthPower","metersToTheFourthPower"]},"slope":{"units":["percentage","ratioTo1","ratioTo10","ratioTo12","riseDividedBy12Inches","riseDividedBy1Foot","riseDividedBy1000Millimeters","riseDividedBy120Inches","1ToRatio","riseDividedBy10Feet","perMille"]},"solidAngle":{"units":["steradians"]},"specificEnergy":{"units":["joulesPerGram","joulesPerKilogram","britishThermalUnitsPerPound"]},"specificHeatCapacity":{"units":["joulesPerGramDegreeCelsius","britishThermalUnitsPerPoundDegreeFahrenheit","joulesPerKilogramDegreeCelsius"]},"stress":{"units":["pascals","kilopascals","megapascals","poundsForcePerSquareInch","bars","newtonsPerSquareMeter","dekanewtonsPerSquareMeter","kilonewtonsPerSquareMeter","meganewtonsPerSquareMeter","kipsPerSquareFoot","kilogramsForcePerSquareMeter","tonnesForcePerSquareMeter","poundsForcePerSquareFoot","kipsPerSquareInch","kilonewtonsPerSquareCentimeter","newtonsPerSquareMillimeter","kilonewtonsPerSquareMillimeter"]},"temperature":{"units":["fahrenheit","celsius","kelvin","rankine"]},"temperatureInterval":{"units":["fahrenheitInterval","celsiusInterval","kelvinInterval","rankineInterval"]},"thermalConductivity":{"units":["wattsPerMeterKelvin","britishThermalUnitsPerHourFootDegreeFahrenheit"]},"thermalExpansionCoefficient":{"units":["inverseDegreesFahrenheit","inverseDegreesCelsius","micrometersPerMeterDegreeCelsius","microinchesPerInchDegreeFahrenheit"]},"thermalInsulance":{"units":["hourSquareFootDegreesFahrenheitPerBritishThermalUnit","squareMeterKelvinsPerWatt"]},"time":{"units":["milliseconds","seconds","minutes","hours"]},"torque":{"units":["newtonMeters","dekanewtonMeters","kilonewtonMeters","meganewtonMeters","kipFeet","kilogramForceMeters","tonneForceMeters","poundForceFeet"]},"torquePerLength":{"units":["newtonMetersPerMeter","dekanewtonMetersPerMeter","kilonewtonMetersPerMeter","meganewtonMetersPerMeter","kipFeetPerFoot","kilogramForceMetersPerMeter","tonneForceMetersPerMeter","poundForceFeetPerFoot"]},"velocity":{"units":["feetPerMinute","centimetersPerMinute","inchesPerSecond","metersPerSecond","feetPerSecond","kilometersPerSecond","milesPerSecond","kilometersPerHour","milesPerHour"]},"volume":{"units":["cubicYards","cubicFeet","cubicInches","cubicMeters","cubicCentimeters","cubicMillimeters","liters","usGallons"]},"volumePerForce":{"units":["cubicFeetPerKip","cubicMetersPerKilonewton"]},"warpingCoefficient":{"units":["feetToTheSixthPower","inchesToTheSixthPower","millimetersToTheSixthPower","centimetersToTheSixthPower","metersToTheSixthPower"]}}}')}},i={};function r(e){var t=i[e];if(void 0!==t)return t.exports;var o=i[e]={id:e,loaded:!1,exports:{}};return n[e].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,r.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"==typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"==typeof n.then)return n}var o=Object.create(null);r.r(o);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&i&&n;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>a[e]=()=>n[e]));return a.default=()=>n,r.d(o,a),o},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var o=r(78808);LMV=o})();
//# sourceMappingURL=viewer3D.min.js.map