/*!
 * LMV v7.58.0
 *
 * Copyright 2021 Autodesk, Inc.
 * All rights reserved.
 *
 * This computer source code and related instructions and comments are the
 * unpublished confidential and proprietary information of Autodesk, Inc.
 * and are protected under Federal copyright and state trade secret law.
 * They may not be disclosed to, copied or used by any third party without
 * the prior written consent of Autodesk, Inc.
 *
 * Autodesk Forge Viewer Usage Limitations:
 *
 * The Autodesk Forge Viewer JavaScript must be delivered from an
 * Autodesk-hosted URL.
 */(()=>{var e={8901:(e,t,r)=>{"use strict";r.r(t),r.d(t,{nearestPointOnCircularArc:()=>i,intersectLines:()=>n});var i=function(e,t,r,i,n,a){var o=(a=a||new THREE.Vector2).copy(e).sub(t).normalize(),s=Math.atan2(o.y,o.x);if(Autodesk.Extensions.CompGeom.angleInsideArc(s,i,n))return o.multiplyScalar(r).add(t);var c=Autodesk.Extensions.CompGeom.getEllipsePoint(i,t.x,t.y,r,r),l=Autodesk.Extensions.CompGeom.getEllipsePoint(n,t.x,t.y,r,r),u=c.distanceToSquared(e)<=l.distanceToSquared(e);return a.copy(u?c:l),a},n=function(e,t,r,i,n,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1e-5,s=(i.y-r.y)*(t.x-e.x)-(i.x-r.x)*(t.y-e.y);if(Math.abs(s)<o)return null;var c=(i.x-r.x)*(e.y-r.y)-(i.y-r.y)*(e.x-r.x);if(c/=s,n){var l=(t.x-e.x)*(e.y-r.y)-(t.y-e.y)*(e.x-r.x);if(l/=s,c<0||c>1||l<0||l>1)return null}return(a=a||new THREE.Vector2).x=e.x+c*(t.x-e.x),a.y=e.y+c*(t.y-e.y),a}},59860:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Snapper:()=>T});var i=r(31779),n=r(8901);function a(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function s(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var c=Autodesk.Viewing.MeasureCommon,l=c.EPSILON,u=c.SnapType,d=c.SnapResult,v=.001,p=Autodesk.Viewing,h=p.Private.VertexBufferReader;function f(e,t){return Math.abs(e-t)<=v}function g(e,t){return Math.abs(e.x-t.x)<=v&&Math.abs(e.y-t.y)<=v&&Math.abs(e.z-t.z)<=v}function y(e,t,r){if(t.equals(r))return e.distanceTo(t);var i,n,a=new THREE.Vector3,o=new THREE.Vector3;return a.subVectors(t,e),o.subVectors(r,t),n=a.dot(o),a.subVectors(r,t),(n=-n/a.dot(a))<0?i=e.distanceTo(t):n>1?i=e.distanceTo(r):(a.subVectors(e,t),o.subVectors(e,r),a.cross(o),o.subVectors(r,t),i=Math.sqrt(a.dot(a))/Math.sqrt(o.dot(o))),i}var m={Unknown:0,Line:1,CircularArc:2,EllipticalArc:3},E=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=m.Unknown,this.viewportId=t,this.distance=0,this.lineStart=null,this.lineEnd=null,this.radius=0,this.radiusX=0,this.radiusY=0,this.center=null,this.startAngle=0,this.endAngle=0}var t,r,i;return t=e,(r=[{key:"fromLine",value:function(e,t){return this.type=m.Line,this.lineStart=e.clone(),this.lineEnd=t.clone(),this}},{key:"fromCircularArc",value:function(e,t,r,i){return this.type=m.CircularArc,this.center=e.clone(),this.radius=t,this.start=r,this.end=i,this}},{key:"fromEllipticalArc",value:function(e,t,r,i,n){return this.type=m.EllipticalArc,this.center=e.clone(),this.radiusX=t,this.radiusY=r,this.start=i,this.end=n,this}},{key:"isLine",value:function(){return this.type===m.Line}},{key:"isCircularArc",value:function(){return this.type===m.CirularArc}},{key:"isEllipticalArc",value:function(){return this.type===m.EllipticalArc}},{key:"getIntersection",value:function(e,t){if(this.isLine()&&e.isLine())return(0,n.intersectLines)(this.lineStart,this.lineEnd,e.lineStart,e.lineEnd,!1,t)}}])&&s(t.prototype,r),i&&s(t,i),e}();function T(e,t){var r=new d,o=e;this.setGlobalManager(e.globalManager);var s,m=t||{};s=m.markupMode?["snapper-markup"]:m.toolName?[m.toolName]:["snapper"];var T=!1,w=Number.MAX_VALUE,R=null,S=!1,V=!1,x=!1,b=null,A=!1,P=null;this.indicator=new i.SnapperIndicator(e,this),this.markupMode=m.markupMode,this.renderSnappedGeometry=m.renderSnappedGeometry,this.renderSnappedTopology=m.renderSnappedTopology,this.detectRadiusInPixels=p.isMobileDevice()?50:10,this.isActive=function(){return T},this.getNames=function(){return s},this.getName=function(){return s[0]},this.getPriority=function(){return 60},this.activate=function(){T=!0,this.indicator.isNull()&&(this.indicator=new i.SnapperIndicator(e,this))},this.deactivate=function(){T=!1,this.indicator.isNull()||(this.indicator.destroy(),this.indicator=new i.NullSnapperIndicator)},this.copyResults=function(e){r.copyTo(e)},this.getEdge=function(){return r.geomEdge},this.getVertex=function(){return r.geomVertex},this.getGeometry=function(){return r.getGeometry()},this.getGeometryType=function(){return r.geomType},this.getIntersectPoint=function(){return r.intersectPoint},this.getSnapResult=function(){return r},this.isSnapped=function(){return x},this.clearSnapped=function(){r.clear(),x=!1},this.setViewportId=function(e){b=e},this.setSnapToPixel=function(e){A=e},this.getSnapToPixel=function(){return A},this.setSnapToArc=function(e){r.snapToArc=e},this.getSnapToArc=function(){return r.snapToArc},this.setArc=function(e){r.isArc=e},this.getArc=function(){return r.isArc},this.setSnapFilter=function(e){P=e},this.snapping3D=function(e){r.snapNode=e.dbId,r.intersectPoint=e.intersectPoint,r.modelId=e.model?e.model.id:null;var t,i=e.face;e.model?(t=e.fragId&&void 0!==e.fragId.length?e.fragId:[e.fragId],r.hasTopology=e.model.hasTopology(),r.hasTopology?this.snapping3DwithTopology(i,t,e.model):this.snapping3DtoMesh(i,t,e.model)):e.object instanceof THREE.Mesh&&this.meshSnapping(i,e.object)},this.makeReadVertexFunc=function(e){var t,r=e.attributes,i=e.vb?e.vb:r.position.array,n=e.vb?e.vbstride:3;if(e.vblayout){if(!e.vblayout.position)return function(){};t=e.vblayout.position.offset}else{if(!r.position)return function(){};t=r.position.itemOffset||0}return function(e,r){var a=e*n+t;return(r=r||new THREE.Vector3).set(i[a],i[a+1],i[a+2]),r}},this.snapping3DwithTopology=function(e,t,i){r.snapNode&&(t=[],i.getData().instanceTree.enumNodeFragments(r.snapNode,(function(e){t.push(e)}),!0)),r.geomFace=r.geomEdge=r.geomVertex=null,w=Number.MAX_VALUE;for(var n=0;n<t.length;++n){var a=t[n],s=o.impl.getRenderProxy(i,a),c=s.geometry,l=i.getTopoIndex(a),d=i.getTopology(l),v=d.faces,p=d.edges;if(!r.geomFace){r.geomFace=this.faceSnappingWithTopology(e,c,v,s),r.geomFace&&(r.geomFace.fragId=a);var h=(new THREE.Matrix3).getNormalMatrix(s.matrixWorld);r.faceNormal=e.normal.applyMatrix3(h).normalize()}this.edgeSnappingWithTopology(r.intersectPoint,c,p,s)}if(r.geomVertex=this.vertexSnappingWithTopology(r.geomEdge,r.intersectPoint),r.geomFace){if(r.radius=this.setDetectRadius(r.intersectPoint),(m.forceSnapVertices||R<r.radius)&&r.geomVertex)r.geomType=u.SNAP_VERTEX;else if((m.forceSnapEdges||w<r.radius)&&r.geomEdge){var f=this.edgeIsCircle(r.geomEdge);f?(r.circularArcCenter=f,r.circularArcRadius=f.distanceTo(r.geomEdge.vertices[0]),r.geomEdge.center=r.circularArcCenter,r.geomEdge.radius=r.circularArcRadius,r.geomType=u.SNAP_CIRCULARARC):this.edgeIsCurved(r.geomEdge)?r.geomType=u.SNAP_CURVEDEDGE:r.geomType=u.SNAP_EDGE}else this.faceIsCurved(r.geomFace)?r.geomType=u.SNAP_CURVEDFACE:r.geomType=u.SNAP_FACE;x=!0}},this.meshSnapping=function(e,t){var i=t.geometry;if((t.isLine||t.isWideLine)&&e)return r.geomEdge=this.extractLineGeometry(e,i),r.geomEdge.applyMatrix4(t.matrixWorld),r.geomVertex=this.vertexSnapping(r.geomEdge,r.intersectPoint),r.radius=this.setDetectRadius(r.intersectPoint),m.forceSnapVertices||R<r.radius?r.geomType=u.SNAP_VERTEX:r.geomType=u.SNAP_EDGE,x=!0,!0;if(e instanceof THREE.Face3&&(r.geomFace=this.faceSnapping(e,i)),!r.geomFace)return!1;r.geomFace.applyMatrix4(t.matrixWorld),r.geomEdge=this.edgeSnapping(r.geomFace,r.intersectPoint),r.geomVertex=this.vertexSnapping(r.geomEdge,r.intersectPoint);var n=(new THREE.Matrix3).getNormalMatrix(t.matrixWorld);return r.faceNormal=e.normal.applyMatrix3(n).normalize(),r.radius=this.setDetectRadius(r.intersectPoint),m.forceSnapVertices||R<r.radius?r.geomType=u.SNAP_VERTEX:m.forceSnapEdges||w<r.radius?r.geomType=u.SNAP_EDGE:r.geomType=u.SNAP_FACE,x=!0,!0},this.snapping3DtoMesh=function(e,t,r){for(var i=0;i<t.length;++i){var n=t[i],a=o.impl.getRenderProxy(r,n);if(this.meshSnapping(e,a))break}},this.faceSnappingWithTopology=function(e,t,r,i){var n=new THREE.Vector3,a=new THREE.Vector3,o=new THREE.Vector3,s=new THREE.Geometry;if(void 0!==t.index){for(var c=0;c<r.length;c++){for(var l=r[c].indexList,u=r[c].id,d=0;d<l.length;d+=3)if(e.a===l[d]){if(e.b===l[d+1]&&e.c===l[d+2]||e.b===l[d+2]&&e.c===l[d+1])break}else if(e.a===l[d+1]){if(e.b===l[d]&&e.c===l[d+2]||e.b===l[d+2]&&e.c===l[d])break}else if(e.a===l[d+2]&&(e.b===l[d]&&e.c===l[d+1]||e.b===l[d+1]&&e.c===l[d]))break;if(d<l.length)break}if(c<r.length)for(var v=this.makeReadVertexFunc(t),p=0;p<l.length;p+=3){v(l[p],n),v(l[p+1],a),v(l[p+2],o);var h=s.vertices.length;s.vertices.push(n.clone()),s.vertices.push(a.clone()),s.vertices.push(o.clone()),s.faces.push(new THREE.Face3(h,h+1,h+2))}}return s.vertices.length>0?(s.faceId=u,s.applyMatrix4(i.matrixWorld),s):null},this.faceSnapping=function(e,t){var r=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Geometry,o=t.index&&(t.index.array||t.ib),s=t.groups;if(!s||0===s.length){var c=t.vb?t.vb:t.attributes.position.array;s=[{start:0,count:o?o.length:c.length,index:0}]}for(var l=this.makeReadVertexFunc(t),u=l(e.a),d=0;d<s.length;++d)for(var v=s[d].start,p=s[d].count,h=s[d].index,y=v;y<v+p;y+=3){var m=h+(o?o[y]:y),E=h+(o?o[y+1]:y+1),T=h+(o?o[y+2]:y+2);l(m,r),l(E,i),l(T,n);var w=new THREE.Vector3;if(THREE.Triangle.getNormal(r,i,n,w),g(w,e.normal)&&f(w.dot(r),e.normal.dot(u))){var R=a.vertices.length;a.vertices.push(r.clone()),a.vertices.push(i.clone()),a.vertices.push(n.clone()),a.faces.push(new THREE.Face3(R,R+1,R+2))}}return a.vertices.length>0?this.getTrianglesOnSameFace(a,e,l):null},this.getTrianglesOnSameFace=function(e,t,r){var i=!1,n=e.vertices.slice(),a=r(t.a),o=r(t.b),s=r(t.c),c=new THREE.Geometry;c.vertices.push(a),c.vertices.push(o),c.vertices.push(s),c.faces.push(new THREE.Face3(0,1,2));var l=[];do{l=[];for(var u=0;u<n.length;u+=3)if(n[u].equals(a)&&n[u+1].equals(o)&&n[u+2].equals(s))i=!0,l.push(u);else for(var d=0;d<c.vertices.length;d+=3)if(this.trianglesSharedEdge(n[u],n[u+1],n[u+2],c.vertices[d],c.vertices[d+1],c.vertices[d+2])){var v=c.vertices.length;c.vertices.push(n[u].clone()),c.vertices.push(n[u+1].clone()),c.vertices.push(n[u+2].clone()),c.faces.push(new THREE.Face3(v,v+1,v+2)),l.push(u);break}for(var p=l.length-1;p>=0;--p)n.splice(l[p],3)}while(l.length>0);return i?c:null},this.trianglesSharedEdge=function(e,t,r,i,n,a){var o=!1,s=!1,c=!1;return(e.equals(i)||e.equals(n)||e.equals(a))&&(o=!0),(t.equals(i)||t.equals(n)||t.equals(a))&&(s=!0),(r.equals(i)||r.equals(n)||r.equals(a))&&(c=!0),!!(o&s||o&c||s&c)},this.edgeSnappingWithTopology=function(e,t,i,n){var a,o=new THREE.Geometry,s=Number.MAX_VALUE,c=new THREE.Vector3,l=new THREE.Vector3;if(void 0!==t.index&&null!=i){for(var u=this.makeReadVertexFunc(t),d=0;d<i.length;d++)for(var v=i[d].indexList,p=0;p<v.length-1;p++){u(v[p],c),u(v[p+1],l),c.applyMatrix4(n.matrixWorld),l.applyMatrix4(n.matrixWorld);var h=y(e,c,l);h<s&&(s=h,a=d)}if(a){v=i[a].indexList;for(var f=0;f<v.length-1;f++){var g=u(v[f]),m=u(v[f+1]);o.vertices.push(g),o.vertices.push(m)}}}w>=s&&o.vertices.length>0&&(w=s,o.applyMatrix4(n.matrixWorld),r.geomEdge=o)},this.extractLineGeometry=function(e,t){var r=this.makeReadVertexFunc(t),i=r(e.a),n=r(e.b),a=new THREE.Geometry;return a.vertices.push(i,n),a},this.edgeSnapping=function(e,t){for(var r=new THREE.Geometry,i=!0,n=!0,a=!0,o=0;o<e.vertices.length;o+=3){for(var s=0;s<e.vertices.length;s+=3)o!==s&&((e.vertices[o].equals(e.vertices[s])||e.vertices[o].equals(e.vertices[s+1])||e.vertices[o].equals(e.vertices[s+2]))&&(e.vertices[o+1].equals(e.vertices[s])||e.vertices[o+1].equals(e.vertices[s+1])||e.vertices[o+1].equals(e.vertices[s+2]))&&(i=!1),(e.vertices[o].equals(e.vertices[s])||e.vertices[o].equals(e.vertices[s+1])||e.vertices[o].equals(e.vertices[s+2]))&&(e.vertices[o+2].equals(e.vertices[s])||e.vertices[o+2].equals(e.vertices[s+1])||e.vertices[o+2].equals(e.vertices[s+2]))&&(n=!1),(e.vertices[o+1].equals(e.vertices[s])||e.vertices[o+1].equals(e.vertices[s+1])||e.vertices[o+1].equals(e.vertices[s+2]))&&(e.vertices[o+2].equals(e.vertices[s])||e.vertices[o+2].equals(e.vertices[s+1])||e.vertices[o+2].equals(e.vertices[s+2]))&&(a=!1));i&&(r.vertices.push(e.vertices[o].clone()),r.vertices.push(e.vertices[o+1].clone())),n&&(r.vertices.push(e.vertices[o].clone()),r.vertices.push(e.vertices[o+2].clone())),a&&(r.vertices.push(e.vertices[o+1].clone()),r.vertices.push(e.vertices[o+2].clone())),i=!0,n=!0,a=!0}for(var c,l=new THREE.Geometry,u=Number.MAX_VALUE,d=0;d<r.vertices.length;d+=2){var v=y(t,r.vertices[d],r.vertices[d+1]);v<u&&(u=v,c=d)}return l.vertices.push(r.vertices[c].clone()),l.vertices.push(r.vertices[c+1].clone()),l.vertices=this.getConnectedLineSegmentsOnSameLine(r,l.vertices),w=u,l},this.getConnectedLineSegmentsOnSameLine=function(e,t){var r,i,n=e.vertices.slice(),a=t[0],o=t[1],s=[];do{s=[];for(var c=0;c<n.length;c+=2)if(!n[c].equals(a)||!n[c+1].equals(o))for(var l=0;l<t.length;l+=2)if(n[c].equals(t[l])||n[c+1].equals(t[l])||n[c].equals(t[l+1])||n[c+1].equals(t[l+1])){var u=new THREE.Vector3,d=new THREE.Vector3;if(u.subVectors(t[l],t[l+1]),u.normalize(),d.subVectors(n[c],n[c+1]),d.normalize(),g(u,d)||(r=u,i=d,Math.abs(r.x+i.x)<=v&&Math.abs(r.y+i.y)<=v&&Math.abs(r.z+i.z)<=v)){s.push(c);break}}for(var p=s.length-1;p>=0;--p)t.push(n[s[p]]),t.push(n[s[p]+1]),n.splice(s[p],2)}while(s.length>0);return t},this.vertexSnappingWithTopology=function(e,t){var r=Number.MAX_VALUE,i=new THREE.Vector3;if(e&&e.vertices.length>1){var n=t.distanceTo(e.vertices[0]),a=t.distanceTo(e.vertices[e.vertices.length-1]);n<=a?(r=n,i=e.vertices[0].clone()):(r=a,i=e.vertices[e.vertices.length-1].clone())}return R=r,i},this.vertexSnapping=function(e,t){for(var r=Number.MAX_VALUE,i=new THREE.Vector3,n=0;n<e.vertices.length;++n){var a=t.distanceTo(e.vertices[n]);a<r-v&&(r=a,i=e.vertices[n].clone())}return R=r,i},this.edgeIsCircle=function(e){var t=e.vertices;if(t.length<8)return!1;if(t[0].equals(t[t.length-1])){for(var r=new THREE.Vector3(0,0,0),i=0;i<t.length;i+=2)r.add(t[i]);r.divideScalar(t.length/2);for(var n=r.distanceTo(t[0]),a=0;a<t.length;a+=2)if(!(Math.abs(r.distanceTo(t[a])-n)<=v))return!1;return r}return!1},this.edgeIsCurved=function(e){var t=e.vertices;if(t.length<=2)return!1;if(t[0].equals(t[t.length-1]))return!0;var r=new THREE.Vector3;r.subVectors(t[0],t[1]);for(var i=new THREE.Vector3,n=2;n<t.length;n+=2)if(i.subVectors(t[n],t[n+1]),!g(r,i))return!0;return!1},this.faceIsCurved=function(e){var t=e.vertices,r=e.faces;if(r.length<=1)return!1;var i=new THREE.Vector3;THREE.Triangle.getNormal(t[r[0].a],t[r[0].b],t[r[0].c],i);for(var n=t[r[0].a],a=new THREE.Vector3,o=1;o<r.length;o++){THREE.Triangle.getNormal(t[r[o].a],t[r[o].b],t[r[o].c],a);var s=t[r[o].a];if(!g(i,a)||!f(i.dot(n),a.dot(s)))return!0}return!1},this.angleVector2=function(e){return e.x>0&&e.y>=0?Math.atan(e.y/e.x):e.x>=0&&e.y<0?Math.atan(e.y/e.x)+2*Math.PI:e.x<0&&e.y<=0||e.x<=0&&e.y>0?Math.atan(e.y/e.x)+Math.PI:null};function M(e,t,r){this.viewer=e,this.snapper=t,this.lineGeom=new THREE.Geometry,this.circularArc=null,this.circularArcCenter,this.circularArcRadius,this.ellipticalArc=null,this.ellipticalArcCenter,this.minDist=Number.MAX_VALUE,this.matrix=new THREE.Matrix4,this.vpIdLine=null,this.vpIdCircular=null,this.vpIdElliptical=null,this.detectRadius=r,this.snapCandidates=[]}M.prototype.onLineSegment=function(e,t,r,i,n){var a=this.snapper.getIntersectPoint(),o=this.lineGeom.vertices,s=new THREE.Vector3(e,t,a.z),c=new THREE.Vector3(r,i,a.z);this.matrix&&(s.applyMatrix4(this.matrix),c.applyMatrix4(this.matrix));var l=y(a,s,c);l>this.detectRadius||(this.snapCandidates.push(new E(n,l).fromLine(s,c)),l<this.minDist&&(o.splice(0,2,s,c),this.minDist=l,this.vpIdLine=n))},M.prototype.onCircularArc=function(e,t,r,i,a,o){var s=this.snapper.getIntersectPoint(),c=new THREE.Vector2(s.x,s.y),l=new THREE.Vector2(e,t);c.sub(l);var u=(0,n.nearestPointOnCircularArc)(s,l,a,r,i),d=u.distanceTo(s);if(this.snapCandidates.push(new E(o,d).fromCircularArc(l,a,r,i)),!(d>this.detectRadius)){var v,p=this.snapper.angleVector2(c);if(i>r&&p>=r&&p<=i)v=new THREE.CircleGeometry(a,100,r,i-r);else{if(!(i<r&&(p>=r||p<=i)))return;v=new THREE.CircleGeometry(a,100,r,2*Math.PI-r+i)}(v=(new THREE.Geometry).fromBufferGeometry(v)).vertices.splice(0,1),v.applyMatrix4((new THREE.Matrix4).makeTranslation(e,t,s.z)),this.circularArc=v,this.circularArcCenter=new THREE.Vector3(e,t,s.z),this.circularArcRadius=a,this.snapPoint=new THREE.Vector3(u.x,u.y,s.z),this.vpIdCircular=o}},M.prototype.onEllipticalArc=function(e,t,r,i,n,a,o,s){var l=this.snapper.getIntersectPoint(),u=new THREE.Vector2(l.x,l.y),d=n-this.detectRadius,v=a-this.detectRadius,p=n+this.detectRadius,h=a+this.detectRadius,g=(u.x-e)*(u.x-e)/(d*d)+(u.y-t)*(u.y-t)/(v*v),y=(u.x-e)*(u.x-e)/(p*p)+(u.y-t)*(u.y-t)/(h*h),m=new THREE.Vector2(e,t);u.sub(m),u.x*=a,u.y*=n;var T=this.snapper.angleVector2(u);if(i>2*Math.PI&&(i=2*Math.PI),g>=1&&y<=1&&(i>r&&T>=r&&T<=i||i<r&&(T>=r||T<=i))){var w=function(e,t,r,i,n,a,o){for(var s=new THREE.Geometry,c=0;c<o;c++){var l=new THREE.Vector3(0,0,0),u=c/(o-1);Autodesk.Extensions.CompGeom.getEllipseArcPoint(u,e,t,r,i,n,a,0,l),s.vertices.push(l)}return s}(e,t,n,a,r,i,50);f(i-r,2*Math.PI)||w.vertices.pop(),w.applyMatrix4((new THREE.Matrix4).makeTranslation(0,0,l.z));var R=c.nearestVertexInVertexToEdge(l,w),S=THREE.Vector2.prototype.distanceTo.call(R,l),V=new THREE.Vector2(e,t);this.snapCandidates.push(new E(s,S).makeEllipticalArc(V,n,a,r,i)),this.ellipticalArc=w,this.ellipticalArcCenter=new THREE.Vector3(e,t,l.z),this.vpIdElliptical=s}},M.prototype.setMatrix=function(e){this.matrix=e||new THREE.Matrix4},this.snapping2D=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e){var i=e.dbId,n=e.fragId,s=e.intersectPoint,c=e.model,l=void 0===c?o.model:c;if(!l.is3d()){r.modelId=e.model?e.model.id:null,r.hasTopology=!1,r.intersectPoint=s;var d,v=1;o.impl.is2d||(d=l.getModelToViewerTransform())&&(v=d.getMaxScaleOnAxis(),r.intersectPoint=s.clone(),r.intersectPoint.applyMatrix4(l.getInverseModelToViewerTransform())),r.radius=this.setDetectRadius(s)/v;var p=null!=l.getFragmentList();if(!p)return x=!0,r.geomType=u.SNAP_VERTEX,r.geomVertex=s,void(d&&r.intersectPoint.applyMatrix4(d));var f=new M(o,this,r.radius);if(t.enumSegments){var g=r.intersectPoint.x-r.radius,y=r.intersectPoint.y-r.radius,m=r.intersectPoint.x+r.radius,E=r.intersectPoint.y+r.radius;t.enumSegments(g,y,m,E,f)}else{var T=n;if(void 0===T){if(!A)return;T=[]}else Array.isArray(T)||(T=[T]);for(var w=0;w<T.length;++w){var R=o.impl.getRenderProxy(l,T[w]);if(R&&R.geometry){f.setMatrix(R.matrix);var S=new h(R.geometry);S.enumGeomsForObject(l.reverseMapDbIdFor2D(i),f),f.setMatrix()}}}if(this.finishSnapping2D(f,r.intersectPoint),!x&&A&&(x=!0,r.geomType=u.RASTER_PIXEL,r.geomVertex=r.intersectPoint),d){var V,b,P=[r.snapPoint,r.geomVertex,r.intersectPoint,r.circularArcCenter,null===(V=r.geomEdge)||void 0===V?void 0:V.vertices[0],null===(b=r.geomEdge)||void 0===b?void 0:b.vertices[1]];(P=a(new Set(P.filter((function(e){return e}))))).forEach((function(e){return e.applyMatrix4(d)})),r.circularArcRadius&&(r.circularArcRadius*=v),r.radius*=v}}}},this.snapping2DOverlay=function(e,t,i,n){r.hasTopology=!1,r.intersectPoint=e,r.radius=n||this.setDetectRadius(e);for(var a=new M(o,this,r.radius),s=0;s<t.length;s++){var c=t[s];new h(c.geometry).enumGeoms(i,a)}this.finishSnapping2D(a,e)},this.finishSnapping2D=function(e,t){if(null!==b){e.snapCandidates=e.snapCandidates.filter((function(e){return e.viewportId===b}))}var i=function(e,t,r){if(e.sort((function(e,t){return e.distance-t.distance})),e.length<2)return null;for(var i={viewportId:e[0].viewportId,snapPoint:new THREE.Vector3(0,0,t.z)},n=e[0],a=1;a<e.length;a++){var o=e[a];if(n.getIntersection(o,i.snapPoint)&&THREE.Vector2.prototype.distanceTo.call(i.snapPoint,t)<r)return i}return null}(e.snapCandidates,t,e.detectRadius);if(i)return r.viewportIndex2d=i.viewportId,r.snapPoint=i.snapPoint,r.geomType=u.SNAP_INTERSECTION,r.geomVertex=i.snapPoint,void(x=!0);if(e.circularArc){if(r.viewportIndex2d=e.vpIdCircular,r.snapPoint=e.snapPoint,null!==b&&b!==r.viewportIndex2d)return;t.distanceTo(e.circularArc.vertices[0])<r.radius?(r.geomVertex=e.circularArc.vertices[0],r.geomType=u.SNAP_VERTEX):t.distanceTo(e.circularArc.vertices[e.circularArc.vertices.length-1])<r.radius?(r.geomVertex=e.circularArc.vertices[e.circularArc.vertices.length-1],r.geomType=u.SNAP_VERTEX):(this.lineStripToPieces(e.circularArc),r.geomEdge=e.circularArc,r.circularArcCenter=e.circularArcCenter,r.circularArcRadius=e.circularArcRadius,r.geomType=u.SNAP_CIRCULARARC),x=!0}else if(e.ellipticalArc){if(r.viewportIndex2d=e.vpIdElliptical,null!==b&&b!==r.viewportIndex2d)return;t.distanceTo(e.ellipticalArc.vertices[0])<r.radius?(r.geomVertex=e.ellipticalArc.vertices[0],r.geomType=u.SNAP_VERTEX):t.distanceTo(e.ellipticalArc.vertices[e.ellipticalArc.vertices.length-1])<r.radius?(r.geomVertex=e.ellipticalArc.vertices[e.ellipticalArc.vertices.length-1],r.geomType=u.SNAP_VERTEX):(this.lineStripToPieces(e.ellipticalArc),r.geomEdge=e.ellipticalArc,r.circularArcCenter=e.ellipticalArcCenter,r.circularArcRadius=null,r.geomType=u.SNAP_CIRCULARARC),x=!0}else if(e.lineGeom.vertices.length){if(r.viewportIndex2d=e.vpIdLine,null!==b&&b!==r.viewportIndex2d)return;if(r.geomEdge=e.lineGeom,this.markupMode){var n=e.lineGeom.vertices[0],a=e.lineGeom.vertices[1],o=new THREE.Vector3;o.addVectors(n,a),o.divideScalar(2);var s=t.distanceTo(o),c=t.distanceTo(n),d=t.distanceTo(a);r.geomEdge=e.lineGeom,s<r.radius?(r.geomVertex=o,r.geomType=u.SNAP_VERTEX):c<r.radius?(r.geomVertex=n,r.geomType=u.SNAP_VERTEX):d<r.radius?(r.geomVertex=a,r.geomType=u.SNAP_VERTEX):r.geomType=u.SNAP_EDGE,e.lineGeom.vertices[0].distanceTo(e.lineGeom.vertices[1])<l&&(r.geomType=u.SNAP_CIRCLE_CENTER)}else t.distanceTo(e.lineGeom.vertices[0])<r.radius?(e.lineGeom.vertices[0].distanceTo(e.lineGeom.vertices[1])<l?r.geomType=u.SNAP_CIRCLE_CENTER:r.geomType=u.SNAP_VERTEX,r.geomVertex=e.lineGeom.vertices[0]):m.forceSnapVertices||t.distanceTo(e.lineGeom.vertices[1])<r.radius?(r.geomVertex=e.lineGeom.vertices[1],r.geomType=u.SNAP_VERTEX):r.geomType=u.SNAP_EDGE;x=!0}},this.snappingRasterPixel=function(e){if(e){var t=e.intersectPoint;r.intersectPoint=t,r.hasTopology=!1,r.radius=this.setDetectRadius(t),r.geomType=u.RASTER_PIXEL,r.geomVertex=t,x=!0}},this.snapMidpoint=function(){if(r.isMidpoint=!1,x&&r.geomType===u.SNAP_EDGE){var e=r.geomEdge,t=e.vertices[0],i=e.vertices[1],n=new THREE.Vector3((t.x+i.x)/2,(t.y+i.y)/2,(t.z+i.z)/2),a=o.impl.getAllCutPlanes();if(null==a?void 0:a.length)for(var s=0;s<a.length;++s){var c=a[s];if(n.x*c.x+n.y*c.y+n.z*c.z+c.w>1e-5)return}r.intersectPoint.distanceTo(n)<2*r.radius&&(r.geomVertex=n,r.geomType=u.SNAP_MIDPOINT)}},this.setPerpendicular=function(e){r.isPerpendicular=e},this.lineStripToPieces=function(e){for(var t=e.vertices,r=t.length-2;r>0;r--)t.splice(r,0,t[r])},this.setDetectRadius=function(e){var t=o.navigation,r=t.getCamera(),i=t.getPosition(),n=e.clone(),a=r.isPerspective?n.sub(i).length():t.getEyeVector().length(),s=t.getVerticalFov(),c=2*a*Math.tan(THREE.Math.degToRad(.5*s)),l=t.getScreenViewport(),u=this.getWindow().devicePixelRatio||1;return this.detectRadiusInPixels*c/(l.height*u)},this.handleButtonDown=function(){return S=!0,!1},this.handleButtonUp=function(){return S=!1,!1},this.handleMouseMove=function(e){return S||this.onMouseMove({x:e.canvasX,y:e.canvasY}),!1},this.handleSingleTap=function(e){return this.handleMouseMove(e)},this.handlePressHold=function(e){if(p.isMobileDevice())switch(e.type){case"press":V=!0,this.onMouseMove({x:e.canvasX,y:e.canvasY});break;case"pressup":this.onMouseMove({x:e.canvasX,y:e.canvasY}),V=!1}return!1},this.handleGesture=function(e){if(p.isMobileDevice()&&V)switch(e.type){case"dragstart":case"dragmove":this.onMouseMove({x:e.canvasX,y:e.canvasY});break;case"dragend":this.onMouseMove({x:e.canvasX,y:e.canvasY}),V=!1}return!1},this.onMouseDown=function(e){return this.onMouseMove(e)},this.onMouseMove=function(e){var t,i;this.clearSnapped();var n=o.impl.snappingHitTest(e.x,e.y,!1);if(!n&&A){var a=o.impl.clientToViewport(e.x,e.y);n={intersectPoint:o.impl.intersectGroundViewport(a)}}if(!n||!n.intersectPoint)return!1;var s=(null===(t=n.model)||void 0===t?void 0:t.isLeaflet())||o.impl.is2d&&(null===(i=o.model)||void 0===i?void 0:i.isLeaflet());if(n.face)this.snapping3D(n);else if(!n.dbId&&0!==n.dbId||s){(A||s)&&this.snappingRasterPixel(n)}else this.snapping2D(n);return this.snapMidpoint(),!(P&&!P(r))||(this.clearSnapped(),!1)}}p.GlobalManagerMixin.call(T.prototype)},31779:(e,t,r)=>{"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function n(e,t){return n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=s(e);if(t){var n=s(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return o(this,r)}}function o(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function u(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e}r.r(t),r.d(t,{NullSnapperIndicator:()=>w,SnapperIndicator:()=>R});var d=Autodesk.Viewing.MeasureCommon,v=d.isEqualVectors,p=d.EPSILON,h=d.SnapType,f="MeasureTool-snapper-geometries",g="MeasureTool-snapper-indicator",y=.2,m=1.2,E=16742144,T=null,w=function(){function e(){c(this,e)}return u(e,[{key:"isNull",value:function(){return!0}},{key:"render",value:function(){}},{key:"removeOverlay",value:function(e){}},{key:"clearOverlay",value:function(e){}},{key:"clearOverlays",value:function(){}},{key:"addOverlay",value:function(e,t){}},{key:"drawFace",value:function(e,t,r){}},{key:"cylinderMesh",value:function(e,t,r,i){return new THREE.Mesh}},{key:"renderGeometry",value:function(e){}},{key:"renderVertexIndicator",value:function(e){}},{key:"renderMidpointIndicator",value:function(e){}},{key:"renderEdgeIndicator",value:function(e){}},{key:"renderCircleIndicator",value:function(e){}},{key:"renderPerpendicular",value:function(e){}},{key:"renderPixelIndicator",value:function(e){}},{key:"renderIndicator",value:function(e){}},{key:"drawLine",value:function(e,t,r,i){}},{key:"drawPoint",value:function(e,t,r){}},{key:"drawCircle",value:function(e,t,r){}},{key:"setScale",value:function(e){return 1}},{key:"setPointScale",value:function(e){}},{key:"setCircleScale",value:function(e){}},{key:"setEdgeScale",value:function(e){}},{key:"updatePointScale",value:function(e){}},{key:"updateEdgeScale",value:function(e){}},{key:"onCameraChange",value:function(){}},{key:"destroy",value:function(){}}]),e}(),R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}(r,e);var t=a(r);function r(e,i){var n;return c(this,r),(n=t.call(this)).viewer=e,n.snapper=i,n.overlayType=0,n.previewsIntersectPoint=null,n.viewer.impl.createOverlayScene(f),n.viewer.impl.createOverlayScene(g),n.geometryMaterial=new THREE.MeshPhongMaterial({color:52224,ambient:52224,opacity:.5,transparent:!0,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide}),n.indicatorMaterial=new THREE.MeshBasicMaterial({color:E,ambient:E,opacity:1,transparent:!1,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide}),n}return u(r,[{key:"isNull",value:function(){return!1}},{key:"render",value:function(){var e=this.snapper.getSnapResult();v(this.previewsIntersectPoint,e.intersectPoint,p)||this.clearOverlay(f),this.clearOverlay(g),e.isEmpty()||((this.snapper.renderSnappedGeometry||e.hasTopology&&this.snapper.renderSnappedTopology)&&this.renderGeometry(e),this.renderIndicator(e),this.previewsIntersectPoint=e.intersectPoint.clone())}},{key:"removeOverlay",value:function(e){this.viewer.impl.clearOverlay(e),this.viewer.impl.removeOverlayScene(e)}},{key:"clearOverlay",value:function(e){this.removeOverlay(e),this.viewer.impl.createOverlayScene(e)}},{key:"clearOverlays",value:function(){this.removeOverlay(f),this.viewer.impl.createOverlayScene(f),this.removeOverlay(g),this.viewer.impl.createOverlayScene(g),this.previewsIntersectPoint=null}},{key:"addOverlay",value:function(e,t){this.viewer.impl.addOverlay(e,t)}},{key:"drawFace",value:function(e,t,r){var i=new THREE.Mesh(e,t,!0);r===f&&(this.overlayType=1),this.addOverlay(r,i)}},{key:"cylinderMesh",value:function(e,t,r,i){var n=(new THREE.Vector3).subVectors(t,e),a=new THREE.Matrix4;a.lookAt(e,t,(new THREE.Object3D).up),a.multiply((new THREE.Matrix4).set(1,0,0,0,0,0,1,0,0,-n.length(),0,0,0,0,0,1)),i=i||.5;var o=new THREE.CylinderGeometry(i,i,1,8,1,!0),s=new THREE.Mesh(o,r);return o=null,s.applyMatrix4(a),s.position.x=(t.x+e.x)/2,s.position.y=(t.y+e.y)/2,s.position.z=(t.z+e.z)/2,s}},{key:"renderGeometry",value:function(e){if(!v(this.previewsIntersectPoint,e.intersectPoint,p))switch(e.geomType){case h.SNAP_VERTEX:h.RASTER_PIXEL,this.drawPoint(e.geomVertex,this.geometryMaterial,f);break;case h.SNAP_EDGE:case h.SNAP_CURVEDEDGE:case h.SNAP_CIRCULARARC:case h.SNAP_MIDPOINT:this.drawLine(e.geomEdge,this.geometryMaterial,.3,f);break;case h.SNAP_FACE:case h.SNAP_CURVEDFACE:this.drawFace(e.geomFace,this.geometryMaterial,f)}}},{key:"renderVertexIndicator",value:function(e){var t=d.getSnapResultPosition(e,this.viewer),r=this.setScale(t),i=m*r,n=this.viewer.navigation.getCameraRightVector().multiplyScalar(i),a=this.viewer.navigation.getCameraUpVector().multiplyScalar(i),o=new THREE.Geometry,s=new THREE.Vector3;s.addVectors(t,n),s.addVectors(s,a),o.vertices[0]=s.clone(),s.subVectors(t,n),s.addVectors(s,a),o.vertices[1]=s.clone(),this.drawLine(o,this.indicatorMaterial,y,g),s.addVectors(t,n),s.subVectors(s,a),o.vertices[0]=s.clone(),s.subVectors(t,n),s.subVectors(s,a),o.vertices[1]=s.clone(),this.drawLine(o,this.indicatorMaterial,y,g),s.subVectors(t,n),s.subVectors(s,a),o.vertices[0]=s.clone(),s.subVectors(t,n),s.addVectors(s,a),o.vertices[1]=s.clone(),this.drawLine(o,this.indicatorMaterial,y,g),s.addVectors(t,n),s.subVectors(s,a),o.vertices[0]=s.clone(),s.addVectors(t,n),s.addVectors(s,a),o.vertices[1]=s.clone(),this.drawLine(o,this.indicatorMaterial,y,g)}},{key:"renderMidpointIndicator",value:function(e){var t=e.geomVertex,r=this.setScale(t),i=m*r,n=this.viewer.navigation.getCameraRightVector().multiplyScalar(i),a=this.viewer.navigation.getCameraUpVector().multiplyScalar(i),o=new THREE.Geometry,s=new THREE.Vector3;s.addVectors(t,n),s.subVectors(s,a),o.vertices[0]=s.clone(),s.subVectors(t,n),s.subVectors(s,a),o.vertices[1]=s.clone(),this.drawLine(o,this.indicatorMaterial,y,g),s.subVectors(t,n),s.subVectors(s,a),o.vertices[0]=s.clone(),s.addVectors(t,a),o.vertices[1]=s.clone(),this.drawLine(o,this.indicatorMaterial,y,g),s.addVectors(t,n),s.subVectors(s,a),o.vertices[0]=s.clone(),s.addVectors(t,a),o.vertices[1]=s.clone(),this.drawLine(o,this.indicatorMaterial,y,g)}},{key:"renderEdgeIndicator",value:function(e){var t=d.getSnapResultPosition(e,this.viewer),r=this.setScale(t),i=m*r,n=this.viewer.navigation.getCameraRightVector().multiplyScalar(i),a=this.viewer.navigation.getCameraUpVector().multiplyScalar(i),o=new THREE.Geometry,s=new THREE.Vector3;s.addVectors(t,n),s.subVectors(s,a),o.vertices[0]=s.clone(),o.vertices[1]=t.clone(),this.drawLine(o,this.indicatorMaterial,y,g),s.subVectors(t,n),s.subVectors(s,a),o.vertices[0]=s.clone(),o.vertices[1]=t.clone(),this.drawLine(o,this.indicatorMaterial,y,g),s.addVectors(t,a),o.vertices[0]=s.clone(),o.vertices[1]=t.clone(),this.drawLine(o,this.indicatorMaterial,y,g)}},{key:"renderCircleIndicator",value:function(e){var t=d.getSnapResultPosition(e,this.viewer);this.drawCircle(t,this.indicatorMaterial,g)}},{key:"renderPerpendicular",value:function(e){var t=d.getSnapResultPosition(e,this.viewer),r=this.setScale(t),i=m*r,n=this.viewer.navigation.getCameraRightVector().multiplyScalar(i),a=this.viewer.navigation.getCameraUpVector().multiplyScalar(i),o=new THREE.Geometry,s=new THREE.Vector3;o.vertices[0]=t.clone(),s.subVectors(t,n),o.vertices[1]=s.clone(),this.drawLine(o,this.indicatorMaterial,y,g),s.addVectors(t,n),s.subVectors(s,a),o.vertices[0]=s.clone(),s.subVectors(t,n),s.subVectors(s,a),o.vertices[1]=s.clone(),this.drawLine(o,this.indicatorMaterial,y,g),s.subVectors(t,n),s.subVectors(s,a),o.vertices[0]=s.clone(),s.subVectors(t,n),s.addVectors(s,a),o.vertices[1]=s.clone(),this.drawLine(o,this.indicatorMaterial,y,g),o.vertices[0]=t.clone(),s.subVectors(t,a),o.vertices[1]=s.clone(),this.drawLine(o,this.indicatorMaterial,y,g)}},{key:"renderPixelIndicator",value:function(e){var t=d.getSnapResultPosition(e,this.viewer),r=this.setScale(t),i=m*r,n=this.viewer.navigation.getCameraRightVector().multiplyScalar(i),a=this.viewer.navigation.getCameraUpVector().multiplyScalar(i),o=new THREE.Geometry,s=new THREE.Vector3;s.subVectors(t,n),s.addVectors(s,a),o.vertices[0]=s.clone(),o.vertices[1]=t.clone(),this.drawLine(o,this.indicatorMaterial,y,g),s.addVectors(t,n),s.addVectors(s,a),o.vertices[0]=s.clone(),o.vertices[1]=t.clone(),this.drawLine(o,this.indicatorMaterial,y,g),s.addVectors(t,n),s.subVectors(s,a),o.vertices[0]=s.clone(),o.vertices[1]=t.clone(),this.drawLine(o,this.indicatorMaterial,y,g),s.subVectors(t,n),s.subVectors(s,a),o.vertices[0]=s.clone(),o.vertices[1]=t.clone(),this.drawLine(o,this.indicatorMaterial,y,g)}},{key:"renderIndicator",value:function(e){if(e.isPerpendicular)this.renderPerpendicular(e);else if(e.snapToArc)e.isArc&&e.geomType===h.SNAP_CIRCULARARC&&this.viewer.model.is2d()&&!this.viewer.model.isPdf()&&this.renderVertexIndicator(e);else switch(e.geomType){case h.SNAP_VERTEX:case h.SNAP_INTERSECTION:this.renderVertexIndicator(e);break;case h.SNAP_MIDPOINT:this.renderMidpointIndicator(e);break;case h.SNAP_CIRCLE_CENTER:this.renderCircleIndicator(e);break;case h.SNAP_EDGE:case h.SNAP_CURVEDEDGE:this.renderEdgeIndicator(e);break;case h.SNAP_CIRCULARARC:this.viewer.model.is2d()?this.renderVertexIndicator(e):this.renderCircleIndicator(e);break;case h.SNAP_FACE:case h.SNAP_CURVEDFACE:this.renderVertexIndicator(e);break;case h.RASTER_PIXEL:this.renderPixelIndicator(e)}}},{key:"drawLine",value:function(e,t,r,i){i===f&&(this.overlayType=2);for(var n=0;n<e.vertices.length;n+=2){var a=this.cylinderMesh(e.vertices[n],e.vertices[n+1],t,r);this.setEdgeScale(a),this.addOverlay(i,a)}}},{key:"drawPoint",value:function(e,t,r){if(!this.viewer.model.isLeaflet()){T||(T=new THREE.SphereGeometry(1));var i=new THREE.Mesh(T,t);i.position.set(e.x,e.y,e.z),this.setPointScale(i),r===f&&(this.overlayType=3),this.addOverlay(r,i)}}},{key:"drawCircle",value:function(e,t,r){var i=new THREE.TorusGeometry(m,y,2,20),n=new THREE.Mesh(i,t);n.lookAt(this.viewer.navigation.getEyeVector().normalize()),i=null,n.position.set(e.x,e.y,e.z),this.setCircleScale(n),this.addOverlay(r,n)}},{key:"setScale",value:function(e){var t=this.viewer.navigation,r=t.getCamera(),i=t.getPosition(),n=e.clone(),a=r.isPerspective?n.sub(i).length():t.getEyeVector().length(),o=t.getVerticalFov();return 5*(2*a*Math.tan(THREE.Math.degToRad(.5*o)))/t.getScreenViewport().height}},{key:"setPointScale",value:function(e){var t=this.setScale(e.position);e.scale.x=t,e.scale.y=t,e.scale.z=t}},{key:"setCircleScale",value:function(e){var t=this.setScale(e.position);e.scale.x=t,e.scale.y=t}},{key:"setEdgeScale",value:function(e){var t=this.setScale(e.position);e.scale.x=t,e.scale.z=t}},{key:"updatePointScale",value:function(e){if(3===this.overlayType){var t=this.viewer.impl.overlayScenes[e];if(t)for(var r=t.scene,i=0;i<r.children.length;i++){var n=r.children[i];n&&this.setPointScale(n)}}}},{key:"updateEdgeScale",value:function(e){if(2===this.overlayType){var t=this.viewer.impl.overlayScenes[e];if(t)for(var r=t.scene,i=0;i<r.children.length;i++){var n=r.children[i];n&&this.setEdgeScale(n)}}}},{key:"onCameraChange",value:function(){this.updatePointScale(f),this.updateEdgeScale(f),this.render()}},{key:"destroy",value:function(){this.removeOverlay(f),this.removeOverlay(g),T&&(T.dispose(),T=null)}}]),r}(w)},20727:(e,t,r)=>{function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function n(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=c(e);if(t){var n=c(this).constructor;r=Reflect.construct(i,arguments,n)}else r=i.apply(this,arguments);return s(this,r)}}function s(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}var l=Autodesk.Viewing,u=AutodeskNamespace("Autodesk.Viewing.Extensions.Snapping");function d(t,r){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e.exports[i]=t[i],r[i]=t[i])}d(r(8901),u),d(r(59860),u),d(r(31779),u);var v=function(e){"use strict";!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(c,e);var t,r,i,s=o(c);function c(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),s.call(this,e,t)}return t=c,(r=[{key:"load",value:function(){return this.viewer.loadExtension("Autodesk.CompGeom")}},{key:"unload",value:function(){return!0}},{key:"activate",value:function(){return!0}},{key:"deactivate",value:function(){return!1}}])&&n(t.prototype,r),i&&n(t,i),c}(l.Extension);l.theExtensionManager.registerExtension("Autodesk.Snapping",v)}},t={};function r(i){var n=t[i];if(void 0!==n)return n.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,r),a.exports}r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i=r(20727);Autodesk.Extensions.Snapping=i})();
//# sourceMappingURL=Snapping.min.js.map